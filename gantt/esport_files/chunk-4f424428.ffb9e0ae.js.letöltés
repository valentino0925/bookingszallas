(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4f424428"],{"0a49":function(e,t,i){var n=i("9b43"),r=i("626a"),s=i("4bf8"),a=i("9def"),o=i("cd1c");e.exports=function(e,t){var i=1==e,l=2==e,d=3==e,c=4==e,h=6==e,p=5==e||h,u=t||o;return function(t,o,m){for(var g,f,b=s(t),v=r(b),y=n(o,m,3),C=a(v.length),w=0,O=i?u(t,C):l?u(t,0):void 0;C>w;w++)if((p||w in v)&&(g=v[w],f=y(g,w,b),e))if(i)O[w]=f;else if(f)switch(e){case 3:return!0;case 5:return g;case 6:return w;case 2:O.push(g)}else if(c)return!1;return h?-1:d||c?c:O}}},1623:function(e,t,i){"use strict";i.d(t,"a",function(){return n});i("cadf"),i("551c"),i("097d");var n={UserPoolId:"us-west-2_EPhfZF0GZ",ClientId:"6uck8t06vthc9f68or3vbna33n"}},"20d6":function(e,t,i){"use strict";var n=i("5ca1"),r=i("0a49")(6),s="findIndex",a=!0;s in[]&&Array(1)[s](function(){a=!1}),n(n.P+n.F*a,"Array",{findIndex:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}}),i("9c6c")(s)},2366:function(e,t){for(var i=[],n=0;n<256;++n)i[n]=(n+256).toString(16).substr(1);function r(e,t){var n=t||0,r=i;return[r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]]].join("")}e.exports=r},"5e88":function(e,t,i){"use strict";var n=i("afb1"),r=i.n(n);r.a},"8a4a":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"animated fadeIn"},[!e.$route.params.hasOwnProperty("cloud")&&e.isMobileApp()?i("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[e._m(0)]):e._e(),e.$route.params.hasOwnProperty("cloud")||e.isMobileApp()?e._e():i("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[e._m(1),e._m(2)]),e.$route.params.hasOwnProperty("cloud")?e._e():i("br"),i("b-alert",{staticStyle:{position:"fixed",left:"0px",top:"0px",width:"100%","z-index":"5000"},attrs:{id:"alertMessage",dismissible:"",variant:this.alertMessage.variant,show:this.alertMessage.show},on:{dismissed:function(t){e.alertMessage.show=0}}},[i("span",{domProps:{innerHTML:e._s(this.alertMessage.message)}})]),e.$route.params.hasOwnProperty("cloud")?i("b-input-group",[i("b-form-select",{staticClass:"m-1 col-3",attrs:{id:"projectSelection",plain:!0,options:e.projectSelectionOptions},on:{change:function(t){e.projectChanged(e.projectSelected,t)}},model:{value:e.projectSelected,callback:function(t){e.projectSelected=t},expression:"projectSelected"}}),i("b-form-input",{staticClass:"m-1 col-3",attrs:{id:"projectNameInput",type:"text",placeholder:"Enter Project Name"},model:{value:e.projectName,callback:function(t){e.projectName=t},expression:"projectName"}}),i("b-form-input",{staticClass:"m-1",attrs:{id:"revisionNotesInput",type:"text",placeholder:"Enter Revision Notes (optional)"},model:{value:e.revisionNotes,callback:function(t){e.revisionNotes=t},expression:"revisionNotes"}})],1):e._e(),i("b-button-toolbar",[e.$route.params.hasOwnProperty("cloud")?e._e():i("b-button",{staticClass:"m-1",attrs:{variant:"dark"},on:{click:e.newClicked}},[e._v("New")]),e.$route.params.hasOwnProperty("cloud")?e._e():i("b-button",{staticClass:"m-1",attrs:{variant:"dark"},on:{click:e.openClicked}},[e._v("Open (.gantt file)")]),e.$route.params.hasOwnProperty("cloud")?e._e():i("b-button",{staticClass:"m-1",attrs:{variant:"dark"},on:{click:e.saveClicked}},[e._v("Save As (.gantt file)")]),e.$route.params.hasOwnProperty("cloud")?i("b-button",{staticClass:"m-1",attrs:{id:"saveButton",variant:"dark"},on:{click:e.saveCloudClicked}},[e._v("Save to Cloud")]):e._e(),e.$route.params.hasOwnProperty("cloud")?i("b-button",{staticClass:"m-1",attrs:{id:"cancelButton",variant:"dark"},on:{click:e.cancelCloudClicked}},[e._v("Cancel")]):e._e(),i("b-dropdown",{staticClass:"m-1",attrs:{variant:"dark",id:"export",text:"Import / Export",disabled:!("Gantt"==e.currentView&&e.showGantt&&!e.allDisabled)}},[e.$route.params.hasOwnProperty("cloud")?i("b-dropdown-item",{attrs:{id:"importDropdownItem"},on:{click:e.openClicked}},[e._v("Import from .gantt File")]):e._e(),i("b-dropdown-item",{attrs:{id:"importExcelDropdownItem"},on:{click:e.importExcelClicked}},[e._v("Import from Excel File")]),e.$route.params.hasOwnProperty("cloud")?i("b-dropdown-item",{on:{click:e.saveClicked}},[e._v("Export to .gantt File")]):e._e(),i("b-dropdown-item",{on:{click:e.excelClicked}},[e._v("Export to Excel File")]),i("b-dropdown-item",{on:{click:e.pdfClicked}},[e._v("Export to PDF File")]),i("b-dropdown-item",{on:{click:e.imageClicked}},[e._v("Export to Image File")])],1),e.$route.params.hasOwnProperty("cloud")?i("b-dropdown",{staticClass:"m-1",attrs:{variant:"dark",id:"more",text:"More",disabled:e.moreDisabled}},[i("b-dropdown-item",{on:{click:e.duplicateCloudClicked}},[e._v("Duplicate Project")]),i("b-dropdown-item",{on:{click:e.deleteCloudClicked}},[e._v("Delete Project")])],1):e._e(),i("div",{staticClass:"notranslate",staticStyle:{color:"hsl(211, 100%, 35%)","margin-top":"auto","margin-bottom":"auto",width:"85px"}},[e._v(" "+e._s(e.exportPdf||e.exportImage?"Exporting...":e.importExcel?"Importing...":"")+" ")]),i("input",{ref:"fileInput",staticStyle:{display:"none"},attrs:{type:"file",accept:".gantt"},on:{change:function(t){e.fileChanged(t)}}}),i("input",{ref:"excelFileInput",staticStyle:{display:"none"},attrs:{type:"file",accept:".csv"},on:{change:function(t){e.excelFileChanged(t)}}}),i("button",{ref:"resourceUpdate",staticStyle:{display:"none"},on:{click:e.resourceUpdated}},[e._v(".")]),i("div",{staticClass:"mx-auto"}),i("b-input-group",[i("b-input-group",{staticClass:"m-1"},[i("b-form-checkbox",{attrs:{plain:!0,disabled:!("Gantt"==e.currentView&&e.showGantt&&!e.allDisabled)},on:{change:e.todayChanged}},[e._v("Today")])],1),i("b-input-group",{staticClass:"m-1"},[i("b-form-select",{attrs:{id:"presetFilter",plain:!0,options:e.presetFilterOptions,disabled:!("Gantt"==e.currentView&&"ProjectView"==e.viewType&&e.showGantt&&!e.allDisabled)},on:{change:e.presetFilterChanged},model:{value:e.presetFilterSelected,callback:function(t){e.presetFilterSelected=t},expression:"presetFilterSelected"}})],1),i("b-input-group",{staticClass:"m-1"},[i("b-form-select",{attrs:{id:"view",plain:!0,options:e.viewOptions,disabled:e.allDisabled},on:{change:e.viewChanged},model:{value:e.viewSelected,callback:function(t){e.viewSelected=t},expression:"viewSelected"}})],1)],1)],1),i("br"),"Gantt"==e.currentView&&e.showGantt?i("div",{staticClass:"control-section"},[i("div",{staticClass:"content-wrapper",attrs:{"div-disabled":e.allDisabled}},[i("ejs-gantt",{ref:"gantt",attrs:{id:"GanttContainer",dataSource:e.data,resources:e.resources,projectStartDate:e.projectStartDate,projectEndDate:e.projectEndDate,viewType:e.viewType,dateFormat:e.dateFormat,taskFields:e.taskFields,allowRowDragAndDrop:!0,editSettings:e.editSettings,toolbar:e.toolbar,allowSelection:!0,gridLines:e.gridLines,height:e.ganttHeight,treeColumnIndex:e.treeColumnIndex,resourceFields:e.resourceFields,enableContextMenu:!0,contextMenuItems:e.contextMenuItems,contextMenuOpen:e.contextMenuOpen,contextMenuClick:e.contextMenuClick,allowResizing:!0,highlightWeekends:e.highlightWeekends,timelineSettings:e.timelineSettings,columns:e.columns,labelSettings:e.labelSettings,addDialogFields:e.addDialogFields,editDialogFields:e.editDialogFields,selectionSettings:e.selectionSettings,splitterSettings:e.splitterSettings,actionBegin:e.ganttActionBegin,actionComplete:e.ganttActionComplete,allowReordering:!0,showColumnMenu:!0,allowFiltering:!0,allowSorting:!0,filterSettings:e.filterSettings,searchSettings:e.searchSettings,workWeek:e.advanced.workWeek,dayWorkingTime:e.advanced.workTime,holidays:e.advanced.holidays,created:e.ganttCreated,destroyed:e.ganttDestroyed,taskType:"fixedDuration",readOnly:e.ganttReadOnly||"ResourceView"==e.viewType,enableVirtualization:!1,cellEdit:e.ganttCellEdit,taskbarEditing:e.ganttTaskbarEditing,queryTaskbarInfo:e.queryTaskbarInfo,rowSelecting:e.ganttRowSelecting,rowSelected:e.ganttRowSelected,rowDeselecting:e.ganttRowDeselecting,rowDeselected:e.ganttRowDeselected,eventMarkers:e.eventMarkers},model:{value:e.data,callback:function(t){e.data=t},expression:"data"}})],1)]):e._e(),"Resource List"==e.currentView&&e.showGrid?i("div",{staticClass:"control-section"},[i("div",{staticClass:"control-section",attrs:{"div-disabled":e.sectionDisabled}},[i("div",[i("b-table",{attrs:{hover:"true",striped:"true",bordered:"true",small:"true",responsive:"md",items:e.resourceListItems,fields:e.resourceListFields,"current-page":"1","per-page":"500"},scopedSlots:e._u([{key:"resourceName",fn:function(t){return[i("b-input-group",[i("b-form-input",{staticClass:"mx-1",attrs:{size:"sm"},model:{value:t.item.resourceName,callback:function(i){e.$set(t.item,"resourceName",i)},expression:"data.item.resourceName"}}),e.$route.params.hasOwnProperty("cloud")?i("b-button",{staticClass:"mx-1",attrs:{variant:"secondary",size:"sm"},on:{click:function(i){i.stopPropagation(),e.selectUserClicked(i,t.index)}}},[i("svg",{staticClass:"bi bi-person",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",fill:"currentColor",viewBox:"0 0 16 16"}},[i("path",{attrs:{d:"M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0zm4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4zm-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10c-2.29 0-3.516.68-4.168 1.332-.678.678-.83 1.418-.832 1.664h10z"}})])]):e._e(),i("b-button",{staticClass:"mx-1",attrs:{variant:"secondary",size:"sm",disabled:t.index==e.resourceListItems.length-1},on:{click:function(i){i.stopPropagation(),e.resourceListDeleteClicked(i,t.index)}}},[i("svg",{staticClass:"bi bi-trash",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",fill:"currentColor",viewBox:"0 0 16 16"}},[i("path",{attrs:{d:"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"}}),i("path",{attrs:{"fill-rule":"evenodd",d:"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"}})])])],1)]}}])})],1)])]):e._e(),"Advanced"==e.currentView?i("div",{staticClass:"control-section"},[i("div",{staticClass:"control-section",attrs:{"div-disabled":e.sectionDisabled}},[i("b-form-group",{attrs:{label:"Default Column Settings","label-for":"columnTable","label-cols":2,horizontal:!0}},[i("b-row",[i("b-col",{attrs:{md:"8",xl:"6"}},[i("b-table",{attrs:{id:"columnTable",hover:"true",striped:"true",bordered:"true",small:"true",responsive:"md",items:e.advanced.columns,fields:e.columnTableFields,"current-page":"1","per-page":"10"},scopedSlots:e._u([{key:"width",fn:function(t){return[i("b-form-input",{attrs:{type:"number",min:"50",max:"1000",size:"sm"},nativeOn:{blur:function(i){e.columnWidthMinMax(i,t.index)}},model:{value:t.item.width,callback:function(i){e.$set(t.item,"width",i)},expression:"data.item.width"}})]}},{key:"show",fn:function(t){return[i("b-form-checkbox",{attrs:{plain:!0},model:{value:t.item.show,callback:function(i){e.$set(t.item,"show",i)},expression:"data.item.show"}})]}}])})],1)],1)],1),i("b-form-group",{attrs:{label:"Default Timeline Zoom Level","label-for":"zoomLevelInput","label-cols":2,horizontal:!0}},[i("b-row",[i("b-col",{attrs:{md:"6",xl:"4"}},[i("b-form-select",{attrs:{id:"zoomLevelInput",name:"zoomLevelInput",plain:!0,options:[{value:-9,text:"-9 (1 Hour)"},{value:-8,text:"-8 (2 Hours)"},{value:-7,text:"-7 (2 Hours)"},{value:-6,text:"-6 (6 Hours)"},{value:-5,text:"-5 (6 Hours)"},{value:-4,text:"-4 (12 Hours)"},{value:-3,text:"-3 (12 Hours)"},{value:-2,text:"-2 (1 Day)"},{value:-1,text:"-1 (1 Day)"},{value:0,text:"0 (1 Day)"},{value:1,text:"1 (1 Week)"},{value:2,text:"2 (1 Week)"},{value:3,text:"3 (1 Week)"},{value:4,text:"4 (1 Month)"},{value:5,text:"5 (3 Months)"},{value:6,text:"6 (3 Months)"},{value:7,text:"7 (6 Months)"},{value:8,text:"8 (6 Months)"},{value:9,text:"9 (1 Year)"}]},model:{value:e.advanced.zoomLevel,callback:function(t){e.$set(e.advanced,"zoomLevel",t)},expression:"advanced.zoomLevel"}})],1)],1)],1),i("br"),i("b-form-group",{attrs:{label:"Reset Task IDs","label-for":"resetTaskIDs","label-cols":2,horizontal:!0}},[i("b-button",{attrs:{id:"resetTaskIDs",name:"resetTaskIDs",variant:"primary"},on:{click:e.resetClicked}},[e._v("Reset")])],1),i("br"),i("b-form-group",{attrs:{label:"Dependency Conflict","label-for":"dependencyConflictInput","label-cols":2,horizontal:!0}},[i("b-row",[i("b-col",{attrs:{md:"6",xl:"4"}},[i("b-form-select",{attrs:{id:"dependencyConflictInput",name:"dependencyConflictInput",plain:!0,options:["Cancel Move","Remove Dependency","Add Offset to Dependency"]},model:{value:e.advanced.dependencyConflict,callback:function(t){e.$set(e.advanced,"dependencyConflict",t)},expression:"advanced.dependencyConflict"}}),i("b-form-text",[e._v("when moving a task causes a dependency conflict")])],1)],1)],1),i("br"),i("b-form-group",{attrs:{label:"Date Format","label-for":"dateFormatInput","label-cols":2,horizontal:!0}},[i("b-row",[i("b-col",{attrs:{md:"6",xl:"4"}},[i("b-form-select",{staticClass:"notranslate",attrs:{id:"dateFormatInput",name:"dateFormatInput",plain:!0,options:[{value:"yyyy-MM-dd",text:"2024-01-30"},{value:"yyyy/MM/dd",text:"2024/01/30"},{value:"yyyy.MM.dd",text:"2024.01.30"},{value:"yyyy MMM dd",text:"2024 Jan 30"},{value:"dd-MM-yyyy",text:"30-01-2024"},{value:"dd/MM/yyyy",text:"30/01/2024"},{value:"dd.MM.yyyy",text:"30.01.2024"},{value:"dd MMM yyyy",text:"30 Jan 2024"},{value:"MM-dd-yyyy",text:"01-30-2024"},{value:"MM/dd/yyyy",text:"01/30/2024"},{value:"MM.dd.yyyy",text:"01.30.2024"},{value:"MMM dd, yyyy",text:"Jan 30, 2024"}]},model:{value:e.advanced.dateFormat,callback:function(t){e.$set(e.advanced,"dateFormat",t)},expression:"advanced.dateFormat"}})],1)],1)],1),i("br"),i("b-form-group",{attrs:{label:"Time Format","label-for":"timeFormatInput","label-cols":2,horizontal:!0}},[i("b-row",[i("b-col",{attrs:{md:"6",xl:"4"}},[i("b-form-select",{attrs:{id:"timeFormatInput",name:"timeFormatInput",plain:!0,options:[{value:"h a",text:"12 Hour"},{value:"HH:mm",text:"24 Hour"}]},on:{change:e.timeFormatChanged},model:{value:e.advanced.timeFormat,callback:function(t){e.$set(e.advanced,"timeFormat",t)},expression:"advanced.timeFormat"}})],1)],1)],1),i("br"),i("b-form-group",{attrs:{label:"First Day of Week","label-for":"firstDayofWeekInput","label-cols":2,horizontal:!0}},[i("b-row",[i("b-col",{attrs:{md:"6",xl:"4"}},[i("b-form-select",{attrs:{id:"firstDayofWeekInput",name:"firstDayofWeekInput",plain:!0,options:[{value:1,text:"Monday"},{value:2,text:"Tuesday"},{value:3,text:"Wednesday"},{value:4,text:"Thursday"},{value:5,text:"Friday"},{value:6,text:"Saturday"},{value:0,text:"Sunday"}]},model:{value:e.advanced.firstDayOfWeek,callback:function(t){e.$set(e.advanced,"firstDayOfWeek",t)},expression:"advanced.firstDayOfWeek"}})],1)],1)],1),i("br"),i("b-form-group",{attrs:{label:"Work Week","label-for":"workWeekCheckboxes","label-cols":2,horizontal:!0}},[i("b-form-checkbox-group",{staticStyle:{"padding-top":"calc(0.375rem + 1px)"},attrs:{id:"workWeekCheckboxes",name:"workWeekCheckboxes",plain:!0},model:{value:e.advanced.workWeek,callback:function(t){e.$set(e.advanced,"workWeek",t)},expression:"advanced.workWeek"}},[i("b-form-checkbox",{attrs:{plain:!0,value:"Monday"}},[e._v("Monday")]),i("b-form-checkbox",{attrs:{plain:!0,value:"Tuesday"}},[e._v("Tuesday")]),i("b-form-checkbox",{attrs:{plain:!0,value:"Wednesday"}},[e._v("Wednesday")]),i("b-form-checkbox",{attrs:{plain:!0,value:"Thursday"}},[e._v("Thursday")]),i("b-form-checkbox",{attrs:{plain:!0,value:"Friday"}},[e._v("Friday")]),i("b-form-checkbox",{attrs:{plain:!0,value:"Saturday"}},[e._v("Saturday")]),i("b-form-checkbox",{attrs:{plain:!0,value:"Sunday"}},[e._v("Sunday")])],1)],1),i("br"),i("b-form-group",{attrs:{label:"Work Time","label-for":"workTimeTable","label-cols":2,horizontal:!0}},[i("b-row",[i("b-col",{attrs:{md:"8",xl:"6"}},[i("b-table",{attrs:{id:"workTimeTable",hover:"true",striped:"true",bordered:"true",small:"true",responsive:"md",items:e.workTimeItems,fields:e.workTimeFields,"current-page":"1","per-page":"500"},scopedSlots:e._u([{key:"from",fn:function(t){return[i("b-form-select",{staticClass:"notranslate",attrs:{plain:!0,size:"sm",options:e.workTimeOptions},model:{value:t.item.from,callback:function(i){e.$set(t.item,"from",i)},expression:"data.item.from"}})]}},{key:"to",fn:function(t){return[i("b-form-select",{staticClass:"notranslate",attrs:{plain:!0,size:"sm",options:e.workTimeOptions},model:{value:t.item.to,callback:function(i){e.$set(t.item,"to",i)},expression:"data.item.to"}})]}}])})],1)],1)],1),i("b-form-group",{attrs:{label:"Holidays","label-for":"holidayTable","label-cols":2,horizontal:!0}},[i("b-row",[i("b-col",{attrs:{md:"8",xl:"6"}},[i("b-table",{attrs:{id:"holidayTable",hover:"true",striped:"true",bordered:"true",small:"true",responsive:"md",items:e.holidayItems,fields:e.holidayFields,"current-page":"1","per-page":"500"},scopedSlots:e._u([{key:"from",fn:function(t){return[i("ejs-datepicker",{attrs:{format:e.advanced.dateFormat},model:{value:t.item.from,callback:function(i){e.$set(t.item,"from",i)},expression:"data.item.from"}})]}},{key:"to",fn:function(t){return[i("ejs-datepicker",{attrs:{format:e.advanced.dateFormat},model:{value:t.item.to,callback:function(i){e.$set(t.item,"to",i)},expression:"data.item.to"}})]}}])})],1)],1)],1)],1)]):e._e(),"Permission"==e.currentView?i("div",{staticClass:"control-section"},[e.$route.params.hasOwnProperty("cloud")?e._e():i("b-alert",{attrs:{variant:"info",show:""}},[e._v("Sharing is available in our "),i("a",{attrs:{href:"#/signup",target:"_blank"}},[e._v("cloud tool")])]),i("br"),i("div",{staticClass:"control-section",attrs:{"div-disabled":e.sectionDisabled||!e.$route.params.hasOwnProperty("cloud")}},[i("b-button-toolbar",{staticClass:"mt-2 mb-2"},[i("div",{staticClass:"mt-1 mb-1 mr-5"},[e._v("Share this project with a public link")]),i("div",[i("b-form-select",{attrs:{id:"publicLinkSelect",name:"publicLinkSelect",plain:!0,options:[{value:1,text:"Yes"},{value:0,text:"No"}]},model:{value:e.publicLinkSelect,callback:function(t){e.publicLinkSelect=t},expression:"publicLinkSelect"}})],1)]),i("div",[i("b-form-input",{attrs:{id:"publicLinkAddress",type:"text",value:e.publicLinkSelect?"https://www.onlinegantt.com/#/public/"+e.projectSelected:"<no public link>",readonly:""}}),i("b-form-text",[e._v('New public link will not go live until after you click "Save to Cloud"')])],1),i("br"),i("br"),e._m(3),i("b-table",{attrs:{id:"permissionTable",hover:"true",striped:"true",bordered:"true",small:"true",responsive:"md",items:e.permissionItems,fields:e.permissionFields,"tbody-tr-class":"notranslate","current-page":"1","per-page":"500"},scopedSlots:e._u([{key:"email",fn:function(t){return[e.adminAdvancedUserList.includes(t.item.email)?i("div",[i("b-form-input",{attrs:{plaintext:"",size:"sm",value:e.getUserName(t.item.email)}})],1):i("div",[i("b-form-select",{attrs:{size:"sm",plain:!0,options:e.permissionUserList},model:{value:t.item.email,callback:function(i){e.$set(t.item,"email",i)},expression:"data.item.email"}})],1)]}},{key:"access",fn:function(t){return[e.adminAdvancedUserList.includes(t.item.email)?i("div",[i("b-form-input",{attrs:{plaintext:"",size:"sm",value:"read/write"}})],1):e.guestUserList.includes(t.item.email)?i("div",[i("b-form-input",{attrs:{plaintext:"",size:"sm",value:"read"}})],1):i("div",[i("b-form-select",{attrs:{size:"sm",plain:!0,options:["read","read/write"]},model:{value:t.item.access,callback:function(i){e.$set(t.item,"access",i)},expression:"data.item.access"}})],1)]}},{key:"id",fn:function(t){return[e.adminAdvancedUserList.includes(t.item.email)?e._e():i("div",[i("b-button",{attrs:{variant:"secondary",size:"sm",disabled:t.index==e.permissionItems.length-1},on:{click:function(i){i.stopPropagation(),e.permissionDeleteClicked(i,t.index)}}},[i("svg",{staticClass:"bi bi-trash",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",fill:"currentColor",viewBox:"0 0 16 16"}},[i("path",{attrs:{d:"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"}}),i("path",{attrs:{"fill-rule":"evenodd",d:"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"}})])])],1)]}}])})],1)],1):e._e(),"Revision"==e.currentView?i("div",{staticClass:"control-section"},[e.$route.params.hasOwnProperty("cloud")?e._e():i("b-alert",{attrs:{variant:"info",show:""}},[e._v("Revisions are available in our "),i("a",{attrs:{href:"#/signup",target:"_blank"}},[e._v("cloud tool")])]),i("br"),i("div",{staticClass:"control-section",attrs:{"div-disabled":e.sectionDisabled||!e.$route.params.hasOwnProperty("cloud")}},[i("b-pagination",{attrs:{"total-rows":e.revisionItems.length,"per-page":e.revisionPerPage,"aria-controls":"revisionTable"},model:{value:e.revisionCurrentPage,callback:function(t){e.revisionCurrentPage=t},expression:"revisionCurrentPage"}}),i("b-table",{attrs:{id:"revisionTable",hover:"true",striped:"true",bordered:"true",small:"true",responsive:"md",items:e.revisionItems,fields:e.revisionFields,"tbody-tr-class":"notranslate","current-page":e.revisionCurrentPage,"per-page":e.revisionPerPage},scopedSlots:e._u([{key:"timestamp",fn:function(t){return[e._v(e._s(new Date(t.item.timestamp).toLocaleString()))]}},{key:"author",fn:function(t){return[e._v(e._s(e.getUserName(t.item.author)))]}},{key:"revision_note",fn:function(t){return[e._v(e._s(t.item.revision_note))]}},{key:"id",fn:function(t){return[i("b-input-group",[i("b-button",{staticClass:"mx-1",attrs:{variant:"secondary",size:"sm"},on:{click:function(i){i.stopPropagation(),e.revisionDownloadClicked(i,t.index)}}},[i("svg",{staticClass:"bi bi-download",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",fill:"currentColor",viewBox:"0 0 16 16"}},[i("path",{attrs:{d:"M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"}}),i("path",{attrs:{d:"M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"}})])]),i("b-button",{staticClass:"mx-1",attrs:{variant:"secondary",size:"sm",disabled:0==t.index},on:{click:function(i){i.stopPropagation(),e.revisionDeleteClicked(i,t.index)}}},[i("svg",{staticClass:"bi bi-trash",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",fill:"currentColor",viewBox:"0 0 16 16"}},[i("path",{attrs:{d:"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"}}),i("path",{attrs:{"fill-rule":"evenodd",d:"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"}})])])],1)]}}])})],1)],1):e._e(),e.$route.params.hasOwnProperty("cloud")||e.isMobileApp()?e._e():i("div",[e._m(4)]),e.$route.params.hasOwnProperty("cloud")&&!e.isMobileApp()?i("div",[e._m(5)]):e._e(),e.isMobileApp()?e._e():i("div",[i("small",[i("br"),i("svg",{staticClass:"bi bi-globe",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",viewBox:"0 0 16 16"}},[i("path",{attrs:{d:"M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8m7.5-6.923c-.67.204-1.335.82-1.887 1.855A8 8 0 0 0 5.145 4H7.5zM4.09 4a9.3 9.3 0 0 1 .64-1.539 7 7 0 0 1 .597-.933A7.03 7.03 0 0 0 2.255 4zm-.582 3.5c.03-.877.138-1.718.312-2.5H1.674a7 7 0 0 0-.656 2.5zM4.847 5a12.5 12.5 0 0 0-.338 2.5H7.5V5zM8.5 5v2.5h2.99a12.5 12.5 0 0 0-.337-2.5zM4.51 8.5a12.5 12.5 0 0 0 .337 2.5H7.5V8.5zm3.99 0V11h2.653c.187-.765.306-1.608.338-2.5zM5.145 12q.208.58.468 1.068c.552 1.035 1.218 1.65 1.887 1.855V12zm.182 2.472a7 7 0 0 1-.597-.933A9.3 9.3 0 0 1 4.09 12H2.255a7 7 0 0 0 3.072 2.472M3.82 11a13.7 13.7 0 0 1-.312-2.5h-2.49c.062.89.291 1.733.656 2.5zm6.853 3.472A7 7 0 0 0 13.745 12H11.91a9.3 9.3 0 0 1-.64 1.539 7 7 0 0 1-.597.933M8.5 12v2.923c.67-.204 1.335-.82 1.887-1.855q.26-.487.468-1.068zm3.68-1h2.146c.365-.767.594-1.61.656-2.5h-2.49a13.7 13.7 0 0 1-.312 2.5m2.802-3.5a7 7 0 0 0-.656-2.5H12.18c.174.782.282 1.623.312 2.5zM11.27 2.461c.247.464.462.98.64 1.539h1.835a7 7 0 0 0-3.072-2.472c.218.284.418.598.597.933M10.855 4a8 8 0 0 0-.468-1.068C9.835 1.897 9.17 1.282 8.5 1.077V4z"}})]),i("b-button",{attrs:{size:"sm",variant:"link"},on:{click:function(t){e.translateURL="https://player.vimeo.com/video/1016038787?badge=0&autopause=0&player_id=0&app_id=58479",e.$root.$emit("bv::show::modal","translateModal")}}},[e._v("Translate this page")])],1)]),e.isMobileApp()?e._e():i("br"),i("b-modal",{attrs:{id:"exportModal",title:"Export","hide-footer":"true"}},[e._v("\n\t\t\tExporting large files may take several minutes..."),i("br"),i("br"),e.$route.params.hasOwnProperty("cloud")?e.subscribed||e.trial?e._e():i("b-alert",{attrs:{variant:"info",show:""}},[e._v("Using default export settings"),i("br"),e._v("Custom export settings are available with an active subscription. "),i("a",{attrs:{href:"#/subscriptions/cloud",target:"_blank"}},[e._v("Subscribe Now")])]):i("b-alert",{attrs:{variant:"info",show:""}},[e._v("Using default export settings"),i("br"),e._v("Custom export settings are available in our "),i("a",{attrs:{href:"#/signup",target:"_blank"}},[e._v("cloud tool")])]),i("b-form-group",{attrs:{label:"Header","label-size":"sm","label-cols":3,horizontal:!0}},[i("b-row",[i("b-col",[i("b-form-select",{attrs:{disabled:!e.$route.params.hasOwnProperty("cloud")||!e.subscribed&&!e.trial,size:"sm",plain:!0,options:["None","Project Name","Project Name and Task Filter"]},model:{value:e.exportOption.header,callback:function(t){e.$set(e.exportOption,"header",t)},expression:"exportOption.header"}})],1)],1)],1),i("b-form-group",{attrs:{label:"Footer","label-size":"sm","label-cols":3,horizontal:!0}},[i("b-row",[i("b-col",[i("b-form-select",{attrs:{disabled:!e.$route.params.hasOwnProperty("cloud")||!e.subscribed&&!e.trial,size:"sm",plain:!0,options:["None","Today's Date","Powered by: onlinegantt.com"]},model:{value:e.exportOption.footer,callback:function(t){e.$set(e.exportOption,"footer",t)},expression:"exportOption.footer"}})],1)],1)],1),i("b-form-group",{attrs:{label:"Columns","label-size":"sm","label-cols":3,horizontal:!0}},[i("b-row",[i("b-col",[i("b-form-select",{attrs:{disabled:!e.$route.params.hasOwnProperty("cloud")||!e.subscribed&&!e.trial,size:"sm",plain:!0,options:["Task ID and Task Name","Use 'Default Column Settings'"]},model:{value:e.exportOption.columns,callback:function(t){e.$set(e.exportOption,"columns",t)},expression:"exportOption.columns"}}),"Use 'Default Column Settings'"==e.exportOption.columns?i("b-form-text",{staticStyle:{"line-height":"0.5"}},[i("small",[e._v("Set 'Default Column Settings' in the 'Edit Settings' page")])]):e._e()],1)],1)],1),i("b-form-group",{attrs:{label:"Timeline","label-size":"sm","label-cols":3,horizontal:!0}},[i("b-row",[i("b-col",[i("b-form-select",{attrs:{disabled:!e.$route.params.hasOwnProperty("cloud")||!e.subscribed&&!e.trial,size:"sm",plain:!0,options:["Zoom to fit","Use 'Default Timeline Zoom Level'"]},model:{value:e.exportOption.timeline,callback:function(t){e.$set(e.exportOption,"timeline",t)},expression:"exportOption.timeline"}}),"Use 'Default Timeline Zoom Level'"==e.exportOption.timeline?i("b-form-text",{staticStyle:{"line-height":"0.5"}},[i("small",[e._v("Set 'Default Timeline Zoom Level' in the 'Edit Settings' page")])]):e._e()],1)],1)],1),i("b-form-group",{attrs:{label:"Expand/Collapse","label-size":"sm","label-cols":3,horizontal:!0}},[i("b-row",[i("b-col",[i("b-form-select",{attrs:{disabled:!e.$route.params.hasOwnProperty("cloud")||!e.subscribed&&!e.trial,size:"sm",plain:!0,options:["Expand All","Use Current Expanded/Collapsed States"]},model:{value:e.exportOption.expandCollapse,callback:function(t){e.$set(e.exportOption,"expandCollapse",t)},expression:"exportOption.expandCollapse"}})],1)],1)],1),i("b-form-group",{attrs:{label:"Sorting","label-size":"sm","label-cols":3,horizontal:!0}},[i("b-row",[i("b-col",[i("b-form-select",{attrs:{disabled:!e.$route.params.hasOwnProperty("cloud")||!e.subscribed&&!e.trial,size:"sm",plain:!0,options:["None","Use Current Sorting"]},model:{value:e.exportOption.sort,callback:function(t){e.$set(e.exportOption,"sort",t)},expression:"exportOption.sort"}})],1)],1)],1),i("b-form-group",{attrs:{label:"Image Resolution","label-size":"sm","label-cols":3,horizontal:!0}},[i("b-row",[i("b-col",[i("b-form-select",{attrs:{disabled:!e.$route.params.hasOwnProperty("cloud")||!e.subscribed&&!e.trial,size:"sm",plain:!0,options:[{value:1,text:"1x"},{value:2,text:"2x"},{value:3,text:"3x"}]},model:{value:e.exportOption.resolution,callback:function(t){e.$set(e.exportOption,"resolution",t)},expression:"exportOption.resolution"}})],1)],1)],1),i("div",{staticClass:"text-right"},[i("b-button",{staticClass:"m-2",attrs:{variant:"primary"},on:{click:function(t){e.exportOption.pdf?e.exportPdf=!0:e.exportImage=!0,e.$root.$emit("bv::hide::modal","exportModal")}}},[e._v("Export")]),i("b-button",{attrs:{variant:"secondary"},on:{click:function(t){e.$root.$emit("bv::hide::modal","exportModal")}}},[e._v("Cancel")])],1)],1),i("b-modal",{staticClass:"high-z-index",attrs:{id:"dialogResourceEditModal",title:"Edit Resources","ok-only":"",centered:"","no-fade":""}},[i("p",[e._v("To edit the list of available resources:")]),i("p",[e._v('1. Click "Cancel" to go back to the gantt chart')]),i("p",[e._v('2. Click "Project View" above the gantt chart')]),i("p",[e._v('3. Select "Edit Resources"')]),i("p",[e._v("4. Edit the list")])]),i("b-modal",{attrs:{id:"selectUserModal",title:"Select User","hide-footer":"true"}},[i("b-form-select",{staticClass:"notranslate",attrs:{size:"sm",plain:!0,options:e.userList},model:{value:e.userSelected,callback:function(t){e.userSelected=t},expression:"userSelected"}}),i("br"),i("div",{staticClass:"text-right"},[i("b-button",{staticClass:"m-2",attrs:{variant:"primary"},on:{click:function(t){e.selectUserSaveClicked()}}},[e._v("Select")]),i("b-button",{attrs:{variant:"secondary"},on:{click:function(t){e.selectUserCancelClicked()}}},[e._v("Cancel")])],1)],1),i("b-modal",{attrs:{id:"alertModalElement","hide-header":"","hide-footer":"",size:e.alertModalSize}},[i("div",{domProps:{innerHTML:e._s(e.alertModalMessage)}}),i("br"),i("div",{staticClass:"text-right"},[i("b-button",{attrs:{variant:"primary"},on:{click:function(t){e.$root.$emit("bv::hide::modal","alertModalElement")}}},[e._v("OK")])],1)]),i("b-modal",{attrs:{id:"confirmModalElement","hide-header":"","hide-footer":"",size:e.confirmModalSize}},[i("div",{domProps:{innerHTML:e._s(e.confirmModalMessage)}}),i("br"),i("div",{staticClass:"text-right"},[i("b-button",{staticClass:"mx-2",attrs:{variant:"primary"},on:{click:e.confirmModalOKClicked}},[e._v("OK")]),i("b-button",{attrs:{variant:"secondary"},on:{click:e.confirmModalCancelClicked}},[e._v("Cancel")])],1)]),i("b-modal",{attrs:{id:"promptModalElement","hide-header":"","hide-footer":"",size:e.promptModalSize}},[i("div",{domProps:{innerHTML:e._s(e.promptModalMessage)}}),i("br"),i("b-form-input",{attrs:{type:"text"},model:{value:e.promptModalParam1,callback:function(t){e.promptModalParam1=t},expression:"promptModalParam1"}}),i("br"),i("div",{staticClass:"text-right"},[i("b-button",{staticClass:"mx-2",attrs:{variant:"primary"},on:{click:function(t){e.promptModalFunction(),e.$root.$emit("bv::hide::modal","promptModalElement")}}},[e._v("OK")]),i("b-button",{attrs:{variant:"secondary"},on:{click:function(t){e.$root.$emit("bv::hide::modal","promptModalElement")}}},[e._v("Cancel")])],1)],1),i("b-modal",{attrs:{id:"translateModal",size:"lg",title:"Translate this page with your browser","ok-only":""}},[i("div",{staticStyle:{padding:"56.25% 0 0 0",position:"relative"}},[i("iframe",{staticStyle:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%"},attrs:{src:e.translateURL,frameborder:"0",allow:"autoplay; fullscreen; picture-in-picture; clipboard-write",title:"How to translate Online Gantt to a different language"}})])]),i("b-modal",{attrs:{id:"welcomeModal",title:"Welcome","ok-only":""}},[i("p",[e._v("Welcome to Online Gantt with Cloud Storage. You will love our simple and affordable gantt chart software.")]),i("p",[e._v("Your 7 day free trial starts now. Subscribe at any time by clicking on \n\t\t\t\t"),i("svg",{staticClass:"bi bi-person-circle",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",viewBox:"0 0 16 16"}},[i("path",{attrs:{d:"M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0z"}}),i("path",{attrs:{"fill-rule":"evenodd",d:"M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1z"}})]),e._v("\n\t\t\t\t and selecting "),i("i",[e._v("Manage Subscriptions")]),e._v(".")]),i("p",[e._v("Subscribe in the next "),i("strong",[e._v("24 hours")]),e._v(" to get a "),i("strong",[e._v("20% discount")]),e._v(" for your first subscription period (1 month or 1 year).")]),i("p",[e._v("To get started with our software, simply add tasks by clicking on the "),i("i",[e._v("Add")]),e._v(" button on the gantt chart's toolbar. You can save your project by clicking on the "),i("i",[e._v("Save to Cloud")]),e._v(" button, and load your project by selecting it on the pulldown menu to the upper left of the page.")]),i("p",[e._v("Email us at "),i("a",{attrs:{href:"mailto:support@onlinegantt.com"}},[e._v("support@onlinegantt.com")]),e._v(" for technical assistance. Expect our response within 24 hours.")])]),e.isMobileApp()?e._e():i("br"),e.exportPdf||e.exportImage?i("div",{staticStyle:{overflow:"hidden",height:"0"},attrs:{id:"exportGanttContainerHiddenDiv"}},[i("div",{attrs:{id:"exportGanttContainerDiv"}},["Project Name"==e.exportOption.header&&""!=e.projectName?i("div",{staticStyle:{width:"100%","background-color":"#F8F9FA","text-align":"center"}},[i("div",{staticStyle:{"font-weight":"500","font-size":"1.75rem"}},[e._v(e._s(this.projectName))])]):e._e(),"Project Name and Task Filter"==e.exportOption.header&&""!=e.projectName?i("div",{staticStyle:{width:"100%","background-color":"#F8F9FA","text-align":"center"}},[i("div",{staticStyle:{"font-weight":"500","font-size":"1.75rem"}},[e._v(e._s(this.projectName+" ("+this.presetFilterSelected+")"))])]):e._e(),i("ejs-gantt",{ref:"exportGantt",attrs:{id:"exportGanttContainer",dataSource:e.data,resources:e.resources,projectStartDate:e.projectStartDate,projectEndDate:e.projectEndDate,viewType:e.viewType,dateFormat:e.dateFormat,taskFields:e.taskFields,gridLines:e.gridLines,height:e.auto,treeColumnIndex:"Task ID and Task Name"==e.exportOption.columns?1:e.treeColumnIndex,resourceFields:e.resourceFields,highlightWeekends:e.highlightWeekends,timelineSettings:e.timelineSettings,columns:"Task ID and Task Name"==e.exportOption.columns?e.IDNameColumns:e.columns,labelSettings:e.labelSettings,splitterSettings:"Task ID and Task Name"==e.exportOption.columns?{columnIndex:2}:e.splitterSettings,actionBegin:e.ganttActionBegin,showColumnMenu:!0,allowFiltering:!0,allowSorting:!0,filterSettings:e.filterSettings,searchSettings:e.searchSettings,workWeek:e.advanced.workWeek,dayWorkingTime:e.advanced.workTime,holidays:e.advanced.holidays,taskType:"fixedDuration",readOnly:!0,enableVirtualization:!1,dataBound:e.exportGanttDataBound,queryTaskbarInfo:e.queryTaskbarInfo,eventMarkers:e.exportEventMarkers},model:{value:e.data,callback:function(t){e.data=t},expression:"data"}}),"Today's Date"==e.exportOption.footer?i("div",{staticStyle:{width:"100%","background-color":"#F8F9FA","text-align":"center"}},[e._v(e._s(this.todayDateString()))]):e._e(),"Powered by: onlinegantt.com"==e.exportOption.footer?i("div",{staticStyle:{width:"100%","background-color":"#F8F9FA","text-align":"center"}},[e._v("Powered by: onlinegantt.com")]):e._e()],1)]):e._e(),i("div",{staticStyle:{display:"none"}},[e._v(e._s(this.resourceListItems)),i("br"),i("br")]),i("div",{staticStyle:{display:"none"}},[e._v(e._s(this.holidayItems)),i("br"),i("br")]),i("div",{staticStyle:{display:"none"}},[e._v(e._s(this.permissionItems)),i("br"),i("br")]),i("div",{staticStyle:{display:"none"}},[e._v(e._s(this.undoProjectChanged)),i("br"),i("br")])],1)},r=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticStyle:{order:"1"}},[e._v("* Visit us at "),i("a",{attrs:{href:"/"}},[e._v("onlinegantt.com")]),e._v(" and save your gantt charts on our "),i("a",{attrs:{href:"#/signup"}},[e._v("cloud")]),e._v(".")])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticStyle:{order:"1"}},[e._v("* This 100% free tool allows you to save your gantt charts on your computer as .gantt files. Try our "),i("a",{attrs:{href:"#/signup"}},[e._v("cloud tool")]),e._v(" to save your gantt charts on our cloud and share with your team.")])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticStyle:{order:"2",color:"#fc0","margin-left":"15px"}},[e._v("★★★★★ "),i("a",{attrs:{href:"testimonials.html",target:"_blank"}},[e._v("Reviews")])])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[e._v("Share this project with your "),i("a",{attrs:{href:"#/users/cloud"}},[e._v("team")]),e._v(". Note administrators and advanced users have read/write access for all projects, guest users have no write access for any project."),i("br"),i("br")])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("small",[i("div",{staticStyle:{"line-height":"1"}},[i("br"),e._v("[Sponsored] Need a project management tool beyond gantt charts? Check out "),i("a",{attrs:{href:"https://try.monday.com/g1q6uhwl5s6n",rel:"nofollow",target:"_blank"}},[e._v("this tool")]),e._v(" for FREE."),i("br")]),i("br"),e._v("We would love to hear from you! Contact us at "),i("a",{attrs:{href:"mailto:contact@onlinegantt.com"}},[e._v("contact@onlinegantt.com")]),e._v(" to share feedbacks, report bugs, or suggest new features."),i("br"),e._v("\n          Help support our work by leaving us a 5-star review on "),i("a",{attrs:{href:"https://reviews.capterra.com/new/232201/",target:"_blank"}},[e._v("Capterra")]),e._v(" or "),i("a",{attrs:{href:"https://www.g2.com/products/online-gantt/take_survey",target:"_blank"}},[e._v("G2")]),e._v("."),i("br"),e._v("\n\t\t  Made with "),i("span",{staticStyle:{color:"#e25555"}},[e._v("♥")]),e._v(" in the USA | "),i("a",{attrs:{href:"testimonials.html",target:"_blank"}},[e._v("Testimonials")]),e._v(" | "),i("a",{attrs:{href:"gantt-chart-template.html",target:"_blank"}},[e._v("Templates")]),e._v(" | "),i("a",{attrs:{href:"terms.html",target:"_blank"}},[e._v("Terms")]),e._v(" | "),i("a",{attrs:{href:"privacy.html",target:"_blank"}},[e._v("Privacy")])])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("small",[i("br"),e._v("Email us at "),i("a",{attrs:{href:"mailto:support@onlinegantt.com"}},[e._v("support@onlinegantt.com")]),e._v(" for technical assistance. Expect our response within 24 hours.\n\t\t")])}];i("f576");function s(e){return s="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function a(e){return a="function"===typeof Symbol&&"symbol"===s(Symbol.iterator)?function(e){return s(e)}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":s(e)},a(e)}i("20d6"),i("4917");function o(e){if(Array.isArray(e)){for(var t=0,i=new Array(e.length);t<e.length;t++)i[t]=e[t];return i}}function l(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function d(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function c(e){return o(e)||l(e)||d()}i("c5f6"),i("6b54"),i("55dd"),i("386d"),i("a481"),i("7f7f"),i("6762"),i("2fdb"),i("ac4d"),i("8a81"),i("ac6a"),i("28a5"),i("cadf"),i("551c"),i("097d");var h,p=i("1623"),u=i("bc3a"),m=i.n(u),g=i("c64e"),f=i.n(g),b=i("a026"),v=i("f7fe"),y=i.n(v),C=i("de53"),w=i("7de8"),O=i("4f3e"),T=i("2d85"),k=i("0f5f"),S=i("d77f"),j=i("d769"),R=i("75b0"),D=i("73ba"),E=i("9c37"),I=i("ccf4"),x=i("3530"),M=function(){function e(e){this.parent=e}return e.prototype.addNew=function(e,t){var i;this.isEdit=!1;var n=Object(j["L"])(this.parent),r=Object(j["I"])(this.parent),s=this.parent.isFrozenGrid(),a=s&&this.parent.enableColumnVirtualization&&t.isScroll;if(i=this.parent.frozenRows&&"Top"===this.parent.editSettings.newRowPosition?a?this.parent.getMovableHeaderTbody():this.parent.getHeaderTable().querySelector(x["D"]):a?this.parent.getMovableContentTbody():this.parent.getContentTable().querySelector(x["D"]),t.row=this.parent.createElement("tr",{className:"e-row e-addedrow",attrs:{role:"row"}}),i.querySelector(".e-emptyrow")){var o=i.querySelector(".e-emptyrow");if(o.parentNode.removeChild(o),s&&!a){var l=this.parent.getContent().querySelector("."+x["x"]).querySelector(x["D"]);if(l.firstElementChild.parentNode.removeChild(l.firstElementChild),this.parent.getFrozenMode()===x["w"]){var d=this.parent.getContent().querySelector(".e-frozen-right-content").querySelector(x["D"]);d.firstElementChild.parentNode.removeChild(d.firstElementChild)}}}if("Top"===this.parent.editSettings.newRowPosition?i.insertBefore(t.row,i.firstChild):i.appendChild(t.row),t.row.appendChild(this.getEditElement(e,!1,void 0,t,!0)),this.parent.editModule.checkLastRow(t.row,t),s&&!a){var c=this.renderMovableform(t.row,t);if("Top"===this.parent.editSettings.newRowPosition?n.insertBefore(c,n.firstChild):n.appendChild(c),t.row.querySelector(".e-normaledit").setAttribute("colspan",this.parent.getVisibleFrozenColumns()+""),c.querySelector(".e-normaledit").setAttribute("colspan",""+(this.parent.getVisibleColumns().length-this.parent.getVisibleFrozenColumns())),r){var h=this.renderFrozenRightForm(t.row,t);"Top"===this.parent.editSettings.newRowPosition?r.insertBefore(h,r.firstChild):r.appendChild(h);var p=this.parent.getVisibleFrozenColumns()-this.parent.getFrozenRightColumnsCount();t.row.querySelector(".e-normaledit").setAttribute("colspan",p+""),h.querySelector(".e-normaledit").setAttribute("colspan",""+this.parent.getFrozenRightColumnsCount())}"auto"===this.parent.height&&this.parent.notify(I["oc"],{})}},e.prototype.renderFrozenRightForm=function(e,t){var i=e.cloneNode(!0),n=t.frozenRightForm=i.querySelector("form");return this.parent.editSettings.template?(n.innerHTML="",this.appendChildren(n,t.rowData,!1),i):(this.renderRightFrozen(e,i),i.querySelector(x["h"]).innerHTML=this.parent.getHeaderContent().querySelector(".e-frozen-right-header").querySelector(x["h"]).innerHTML,i)},e.prototype.renderMovableform=function(e,t){var i=e.cloneNode(!0),n=t.movableForm=i.querySelector("form");return this.parent.editSettings.template?(n.innerHTML="",this.appendChildren(n,t.rowData,!1),i):(this.renderMovable(e,i),i.querySelector(x["h"]).innerHTML=this.parent.getHeaderContent().querySelector("."+x["y"]).querySelector(x["h"]).innerHTML,i)},e.prototype.updateFreezeEdit=function(e,t){return t=t.concat([].slice.call(this.getFreezeRow(e).querySelectorAll("td.e-rowcell"))),this.parent.getFrozenMode()===x["w"]&&(t=t.concat([].slice.call(this.getFreezeRightRow(e).querySelectorAll("td.e-rowcell")))),t},e.prototype.getFreezeRightRow=function(e){var t=parseInt(e.getAttribute(x["d"]),10),i=this.parent.getFrozenLeftContentTbody(),n=this.parent.getFrozenHeaderTbody(),r=this.parent.getFrozenRightHeaderTbody(),s=this.parent.getFrozenRightContentTbody();return i.contains(e)||n.contains(e)?this.parent.getFrozenRightRowByIndex(t):s.contains(e)||r.contains(e)?this.parent.getRowByIndex(t):e},e.prototype.getFreezeRow=function(e){if(this.parent.isFrozenGrid()){var t=parseInt(e.getAttribute(x["d"]),10),i=this.parent.getFrozenLeftContentTbody(),n=this.parent.getMovableContentTbody(),r=this.parent.getFrozenHeaderTbody(),s=this.parent.getMovableHeaderTbody();if(i.contains(e)||r.contains(e))return this.parent.getMovableRowByIndex(t);if(n.contains(e)||s.contains(e))return this.parent.getRowByIndex(t)}return e},e.prototype.update=function(e,t){this.isEdit=!0;var i=t.isCustomFormValidation,n=t.isScroll;n||!Object(w["A"])(t.row,"."+x["x"])&&!Object(w["A"])(t.row,"."+x["y"])||(t.row=this.getFreezeRow(t.row)),(Object(w["A"])(t.row,".e-frozen-right-content")||Object(w["A"])(t.row,".e-frozen-right-header"))&&(t.row=this.getFreezeRightRow(t.row));var r=this.parent.isFrozenGrid()&&this.parent.enableColumnVirtualization&&n,s=[].slice.call(t.row.querySelectorAll("td.e-rowcell"));t.row.innerHTML="",r||i||(s=this.updateFreezeEdit(t.row,s)),t.row.appendChild(this.getEditElement(e,!0,s,t,!0)),t.row.classList.add(x["l"]),this.parent.editModule.checkLastRow(t.row,t),r||i||this.refreshFreezeEdit(t.row,t)},e.prototype.refreshFreezeEdit=function(e,t){var i,n,r=e.firstChild;this.parent.getVisibleFrozenColumns()&&this.parent.editSettings.template&&(r.querySelector(x["h"]).innerHTML=this.parent.getHeaderContent().querySelector("."+x["o"]).querySelector(x["h"]).innerHTML);var s=parseInt(e.getAttribute(x["d"]),10);if(this.parent.isFrozenGrid()){s<this.parent.frozenRows?(n=this.parent.getHeaderContent(),i="."+x["o"]):(n=this.parent.getContent(),i="."+x["n"]);var a=r.cloneNode(!0),o=r.cloneNode(!0),l=t.movableForm=a.querySelector("form");this.parent.editSettings.template&&this.refreshEditForm(l,t.rowData);var d=void 0,c=void 0;n.querySelector(i).contains(e)?(d=this.parent.getMovableRowByIndex(s),this.updateFrozenCont(d,r,a),this.parent.getFrozenMode()===x["w"]&&(t.frozenRightForm=o.querySelector("form"),this.refreshEditForm(t.frozenRightForm,t.rowData),c=this.parent.getFrozenRightRowByIndex(s),this.updateFrozenRightCont(c,r,o))):(d=this.parent.getRowByIndex(s),this.updateFrozenCont(d,a,r),this.parent.getFrozenMode()===x["w"]&&(t.frozenRightForm=o.querySelector("form"),this.refreshEditForm(t.frozenRightForm,t.rowData),c=this.parent.getFrozenRightRowByIndex(s),this.updateFrozenRightCont(c,o,r))),d.appendChild(a),d.classList.add(x["l"]),this.parent.getFrozenMode()===x["w"]&&(c.appendChild(o),c.classList.add(x["l"]),Object(j["e"])(t.frozenRightForm.querySelector("td:not(.e-hide)"),t.form.querySelector("td:not(.e-hide)"))),Object(j["e"])(t.movableForm.querySelector("td:not(.e-hide)"),t.form.querySelector("td:not(.e-hide)"))}},e.prototype.refreshEditForm=function(e,t){this.parent.editSettings.template&&(e.innerHTML="",this.appendChildren(e,t,!1))},e.prototype.updateFrozenRightCont=function(e,t,i){e.innerHTML="",this.renderRightFrozen(t,i),i.querySelector(x["h"]).innerHTML=this.parent.getHeaderContent().querySelector(".e-frozen-right-header").querySelector(x["h"]).innerHTML,t.setAttribute("colspan",this.parent.getVisibleFrozenColumns()-this.parent.getFrozenRightColumnsCount()+""),i.setAttribute("colspan",this.parent.getFrozenRightColumnsCount()+"")},e.prototype.updateFrozenCont=function(e,t,i){e.innerHTML="",this.renderMovable(t,i),i.querySelector(x["h"]).innerHTML=this.parent.getHeaderContent().querySelector("."+x["y"]).querySelector(x["h"]).innerHTML,t.setAttribute("colspan",this.parent.getVisibleFrozenColumns()+""),i.setAttribute("colspan",this.parent.getCurrentVisibleColumns(this.parent.enableColumnVirtualization).length-this.parent.getVisibleFrozenColumns()+"")},e.prototype.renderRightFrozen=function(e,t){t.querySelector("tr").innerHTML="";for(var i=this.parent.getColumns(),n=0,r=0;r<i.length;r++,n++)if(i[r].getFreezeTableName()===x["q"]){var s=n-this.parent.getMovableColumnsCount();t.querySelector("tr").appendChild(e.querySelector("tr").removeChild(e.querySelector("tr").children[s])),n--}},e.prototype.renderMovable=function(e,t){t.querySelector("tr").innerHTML="";for(var i=this.parent.getColumns(),n=this.parent.isRowDragable()?1:0,r=0;r<i.length;r++,n++)"movable"===i[r].getFreezeTableName()&&(t.querySelector("tr").appendChild(e.querySelector("tr").removeChild(e.querySelector("tr").children[n])),n--)},e.prototype.getEditElement=function(e,t,i,n,r){var s=this.parent,a=0,o=Object(w["T"])(s.detailTemplate)&&Object(w["T"])(s.childGrid)?0:1;s.allowGrouping&&(a=s.groupSettings.columns.length);var l=this.parent.createElement("td",{className:"e-editcell e-normaledit",attrs:{colspan:(s.getCurrentVisibleColumns(this.parent.enableColumnVirtualization).length-s.getVisibleFrozenColumns()+this.parent.getIndentCount()).toString()}}),d=n.form=this.parent.createElement("form",{id:s.element.id+"EditForm",className:"e-gridform"});if(this.parent.editSettings.template)return this.appendChildren(d,n.rowData,r),l.appendChild(d),l;var c=this.parent.createElement("table",{className:"e-table e-inline-edit",attrs:{cellspacing:"0.25",role:"grid"}});c.appendChild(s.getContentTable().querySelector(x["h"]).cloneNode(!0));var h=this.parent.createElement(x["D"],{attrs:{role:"rowgroup"}}),p=this.parent.createElement("tr",{attrs:{role:"row"}}),u=0;o&&p.insertBefore(this.parent.createElement("td",{className:"e-detailrowcollapse"}),p.firstChild),s.isRowDragable()&&p.appendChild(this.parent.createElement("td",{className:"e-dragindentcell"}));while(u<a)p.appendChild(this.parent.createElement("td",{className:"e-indentcell"})),u++;var m=0;u=0;var g=s.isFrozenGrid()&&s.enableColumnVirtualization&&n.isScroll,f=n.isCustomFormValidation?this.parent.columnModel:s.getColumns();while(t&&m<i.length&&u<f.length||u<f.length){var b=t?i[m].getAttribute("colspan"):null,v=f[u];if(g&&"movable"!==v.getFreezeTableName()||n.isCustomFormValidation&&(v.commands||v.commandsTemplate||!v.field))u++;else{var y=this.parent.createElement("td",{className:x["B"],attrs:{style:"text-align:"+(v.textAlign?v.textAlign:""),colspan:b||""}});v.visible?(y.appendChild(e[v.uid]),"Vertical"===this.parent.rowRenderingMode&&(Object(j["Ab"])(y,{"data-cell":v.headerText}),0===u&&y.classList.add("e-responsive-editcell")),"booleanedit"===v.editType?y.classList.add("e-boolcell"):(v.commands||v.commandsTemplate)&&Object(w["u"])([y],"e-unboundcell")):y.classList.add("e-hide"),p.appendChild(y),u=b?u+parseInt(b,10):u+1,m++}}return h.appendChild(p),c.appendChild(h),d.appendChild(c),l.appendChild(d),l},e.prototype.removeEventListener=function(){},e.prototype.appendChildren=function(e,t,i){var n=Object(w["G"])({},t,{isAdd:!this.isEdit,isFrozen:i},!0),r=this.parent.element.id+"editSettingsTemplate";this.parent.isReact&&"string"!==typeof this.parent.editSettings.template?(this.parent.getEditTemplate()(n,this.parent,"editSettingsTemplate",r,null,null,e),this.parent.renderTemplates()):Object(j["f"])(e,this.parent.getEditTemplate()(n,this.parent,"editSettingsTemplate",r))},e}(),P=function(){function e(e){this.parent=e}return e.prototype.update=function(e,t){if(this.parent.isReact&&t.columnObject&&t.columnObject.template){var i=t.cell.parentElement,n=t.cell.cloneNode(!0);i.insertBefore(n,t.cell),n.focus(),t.cell.remove(),t.cell=n}t.cell.innerHTML="",t.cell.appendChild(this.getEditElement(e,t)),t.cell.classList.remove("e-ellipsistooltip"),t.cell.classList.add("e-editedbatchcell"),Object(w["y"])(t.row,[x["l"],"e-batchrow"],[])},e.prototype.getEditElement=function(e,t){var i=this.parent,n=this.parent.createElement("form",{id:i.element.id+"EditForm",className:"e-gridform"});return n.appendChild(e[t.columnObject.uid]),"booleanedit"===t.columnObject.editType&&t.cell.classList.add("e-boolcell"),t.columnObject.editType||t.cell.classList.add("e-inputbox"),n},e.prototype.removeEventListener=function(){},e}(),L=i("d61a"),N=i("af0a"),A=i("949c"),B=function(){function e(e,t){this.parent=e,this.serviceLocator=t,this.parent.isDestroyed||(this.parent.on(I["Mb"],this.destroy,this),this.parent.on(I["Hb"],this.destroy,this))}return e.prototype.setLocaleObj=function(){this.l10n=this.serviceLocator.getService("localization")},e.prototype.addNew=function(e,t){this.isEdit=!1,this.createDialog(e,t)},e.prototype.update=function(e,t){this.isEdit=!0,this.createDialog(e,t)},e.prototype.createDialogHeader=function(e){var t,i=this.parent;if(this.parent.enableAdaptiveUI){var n=new N["a"](this.parent,this.serviceLocator);return n.action=this.isEdit?A["c"].isEdit:A["c"].isAdd,n.renderResponsiveHeader(void 0,e)}return t=i.editSettings.headerTemplate?this.getDialogEditTemplateElement("HeaderTemplate",e):this.isEdit?this.l10n.getConstant("EditFormTitle")+e.primaryKeyValue[0]:this.l10n.getConstant("AddFormTitle"),t},e.prototype.createDialog=function(e,t){var i=this.parent;this.dialog=this.parent.createElement("div",{id:i.element.id+"_dialogEdit_wrapper",styles:"width: auto"}),i.enableAdaptiveUI&&this.dialog.classList.add("e-responsive-dialog"),this.dialog.setAttribute("aria-label","Dialog edit"),i.element.appendChild(this.dialog),this.setLocaleObj(),this.dialogObj=new L["a"](Object(w["G"])({header:this.createDialogHeader(t),isModal:!0,visible:!0,cssClass:this.parent.cssClass?"e-edit-dialog "+this.parent.cssClass:"e-edit-dialog",content:this.getEditElement(e,t),showCloseIcon:!0,allowDragging:!0,close:this.dialogClose.bind(this),created:this.dialogCreated.bind(this),closeOnEscape:!0,width:i.editSettings.template?"auto":"330px",target:t.target?t.target:document.body,animationSettings:{effect:"None"},footerTemplate:i.editSettings.footerTemplate?this.getDialogEditTemplateElement("FooterTemplate",t):null,buttons:[{click:this.btnClick.bind(this),buttonModel:{content:this.l10n.getConstant("SaveButton"),cssClass:this.parent.cssClass?"e-primary "+this.parent.cssClass:"e-primary",isPrimary:!0}},{click:this.btnClick.bind(this),buttonModel:{cssClass:this.parent.cssClass?"e-flat "+this.parent.cssClass:"e-flat",content:this.l10n.getConstant("CancelButton")}}]},i.editSettings.dialog&&i.editSettings.dialog.params||{})),t.dialog=this.dialogObj;var n="isStringTemplate";this.dialogObj[n]=!0,this.renderResponsiveDialog(),this.dialogObj.appendTo(this.dialog),Object(j["g"])(this.parent.element,this.dialogObj.element.parentElement),i.enableAdaptiveUI&&this.dialogObj.show(!0)},e.prototype.dialogCreated=function(){Object(j["b"])(this.parent)},e.prototype.renderResponsiveDialog=function(){var e=this;this.parent.enableAdaptiveUI&&(this.parent.adaptiveDlgTarget&&(this.dialogObj.target=this.parent.adaptiveDlgTarget),this.dialogObj.buttons=[{}],this.dialogObj.showCloseIcon=!0,this.dialogObj.visible=!1,this.dialogObj.width="100%",this.dialogObj.open=function(){e.dialogObj.element.style.maxHeight="100%"})},e.prototype.btnClick=function(e){this.l10n.getConstant("CancelButton").toLowerCase()===e.target.innerText.trim().toLowerCase()?this.dialogClose():this.parent.endEdit()},e.prototype.dialogClose=function(){this.parent.closeEdit()},e.prototype.destroy=function(e){for(var t=["template","headerTemplate","footerTemplate"],i=0;i<t.length;i++)if(this.parent.editSettings[t[i]]){var n=t[i].charAt(0).toUpperCase()+t[i].slice(1),r=this.parent.element.id+"editSettings"+n;Object(w["qb"])(r,n,this.parent.editSettings)}this.parent.notify(I["Jb"],{}),this.parent.isEdit=!1,this.parent.notify(I["oe"],{}),this.dialog&&!this.dialogObj.isDestroyed&&(this.dialogObj.destroy(),Object(w["fb"])(this.dialog))},e.prototype.getDialogEditTemplateElement=function(e,t){var i=this.parent.createElement("div",{className:"e-dialog"+e}),n=Object(w["G"])({},t.rowData,{isAdd:!this.isEdit},!0),r=this.parent.element.id+"editSettings"+e;return Object(j["f"])(i,("HeaderTemplate"===e?this.parent.getEditHeaderTemplate():this.parent.getEditFooterTemplate())(n,this.parent,"editSettings"+e,r)),Object(w["qb"])(r,e,this.parent.editSettings),i},e.prototype.getEditElement=function(e,t){var i=this,n=this.parent,r=this.parent.createElement("div",{className:this.isEdit?x["l"]:"e-insertedrow"}),s=t.form=this.parent.createElement("form",{id:n.element.id+"EditForm",className:"e-gridform"});if(this.parent.editSettings.template){var a=this.parent.element.id+"editSettingsTemplate",o=Object(w["G"])({},t.rowData,{isAdd:!this.isEdit},!0),l=this.parent.isReact&&"string"!==typeof this.parent.editSettings.template;l?(this.parent.getEditTemplate()(o,this.parent,"editSettingsTemplate",a,null,null,s),this.parent.renderTemplates()):Object(j["f"])(s,this.parent.getEditTemplate()(o,this.parent,"editSettingsTemplate",a));var d=function(){for(var e=i.parent.getColumns(),t=0;t<e.length;t++)e[t].validationRules&&(i.parent.editModule.formObj.rules[e[t].field]=e[t].validationRules)};return Object(w["qb"])(a,"Template",this.parent.editSettings,!0,d),r.appendChild(s),r}for(var c=this.parent.createElement("table",{className:x["C"],attrs:{cellspacing:"6px",role:"grid"}}),h=this.parent.createElement(x["D"],{attrs:{role:"rowgroup"}}),p=n.getColumns(),u=0;u<p.length;u++)if(!(this.parent.editModule.checkColumnIsGrouped(p[u])||p[u].commands||p[u].commandsTemplate||"checkbox"===p[u].type)){var m=this.parent.createElement("tr",{attrs:{role:"row"}}),g=this.parent.createElement("td",{className:x["B"],attrs:{style:"text-align:"+(this.parent.enableRtl?"right":"left")+";width:190px"}});e[p[u].uid].classList.remove("e-input"),g.appendChild(e[p[u].uid]),m.appendChild(g),h.appendChild(m)}return c.appendChild(h),s.appendChild(c),r.appendChild(s),r},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(I["Mb"],this.destroy),this.parent.off(I["Hb"],this.destroy))},e}(),F=i("8d33"),H=function(){function e(e,t){this.editType={Inline:M,Normal:M,Batch:P,Dialog:B},this.parent=e,this.serviceLocator=t,this.renderer=new this.editType[this.parent.editSettings.mode](e,t),this.focus=t.getService("focus")}return e.prototype.addNew=function(e){this.renderer.addNew(this.getEditElements(e),e),this.convertWidget(e)},e.prototype.update=function(e){this.renderer.update(this.getEditElements(e),e);var t=e.isCustomFormValidation;t||(this.parent.notify(I["G"],e),this.convertWidget(e))},e.prototype.convertWidget=function(e){var t,i,n,r,s=this.parent,a=s.isFrozenGrid(),o="Right"===s.getFrozenMode()&&"Normal"===s.editSettings.mode?1:0,l="Dialog"===s.editSettings.mode?Object(w["jb"])("#"+s.element.id+"_dialogEdit_wrapper .e-gridform",document):s.element.getElementsByClassName("e-gridform")[o],d=a&&this.parent.enableColumnVirtualization&&e.isScroll;if(a&&"Normal"===s.editSettings.mode){var c=parseInt(e.row.getAttribute(x["d"]),10);s.frozenRows&&("add"===e.requestType&&"Top"===s.editSettings.newRowPosition||c<s.frozenRows)?(n=s.element.querySelector("."+x["y"]).querySelector(".e-gridform"),this.parent.getFrozenMode()===x["w"]&&(r=e.frozenRightForm)):(n=s.element.querySelector("."+x["x"]).querySelector(".e-gridform"),this.parent.getFrozenMode()===x["w"]&&(r=e.frozenRightForm))}for(var h="Batch"!==s.editSettings.mode?s.getColumns():[s.getColumnByField(e.columnName)],p=0,u=h;p<u.length;p++){var m=u[p];if(!d||"movable"===m.getFreezeTableName())if(!this.parent.editSettings.template||Object(w["T"])(m.field)){if(!this.parent.editModule.checkColumnIsGrouped(m)&&!m.commands){m.valueAccessor(m.field,e.rowData,m),i="movable"===m.getFreezeTableName()&&"Normal"===s.editSettings.mode?n.querySelector("[e-mappinguid="+m.uid+"]"):r&&m.getFreezeTableName()===x["q"]&&"Normal"===s.editSettings.mode?r.querySelector("[e-mappinguid="+m.uid+"]"):l.querySelector("[e-mappinguid="+m.uid+"]");var g=m.edit.write;Object(w["T"])(i)||("string"===typeof g?(g=Object(j["N"])(g,window),g({rowData:e.rowData,element:i,column:m,requestType:e.requestType,row:e.row,foreignKeyData:m.isForeignColumn()&&Object(j["N"])(m.field,e.foreignKeyData)})):m.edit.write({rowData:e.rowData,element:i,column:m,requestType:e.requestType,row:e.row,foreignKeyData:m.isForeignColumn()&&Object(j["N"])(m.field,e.foreignKeyData)}),t||i.getAttribute("disabled")||Object(j["hb"])(i,"e-checkbox-disabled")||(this.focusElement(i,e.type),t=!0))}}else{var f=Object(w["G"])({},e);f.element=l.querySelector("[name="+Object(j["B"])(m.field)+"]"),Object(w["T"])(f.element)&&a&&(f.element=n.querySelector("[name="+Object(j["B"])(m.field)+"]")),"string"===typeof m.edit.write?Object(j["N"])(m.edit.write,window)(f):m.edit.write(f)}}if(a&&!this.parent.allowTextWrap&&("add"===e.requestType||"beginEdit"===e.requestType)&&"Dialog"!==this.parent.editSettings.mode&&!Object(w["T"])(l)&&!Object(w["T"])(n)){var b=n.querySelector("tr").children[0],v=l.querySelector("tr").children[0];if(v.offsetHeight>b.offsetHeight){if(b.style.height=v.offsetHeight+"px",r){var y=n.querySelector("tr").children[0];y.style.height=v.offsetHeight+"px"}}else if(v.style.height=b.offsetHeight+"px",r){y=n.querySelector("tr").children[0];y.style.height=b.offsetHeight+"px"}}},e.prototype.focusElement=function(e,t){var i=this.parent.element.querySelector(".e-edit-checkselect");if(!Object(w["T"])(i)&&i.nextElementSibling&&i.nextElementSibling.classList.add("e-focus"),"Batch"===this.parent.editSettings.mode)this.focus.onClick({target:Object(w["A"])(e,"td")},!0);else{var n=!this.parent.enableVirtualization||"Normal"!==this.parent.editSettings.mode;n||this.parent.enableVirtualization&&"Bottom"===this.parent.editSettings.newRowPosition&&Object(j["hb"])(e,x["b"])?e.focus():e.focus({preventScroll:!0})}e.classList.contains("e-defaultcell")&&e.setSelectionRange(e.value.length,e.value.length)},e.prototype.getEditElements=function(e){var t=this.parent,i={},n="Batch"!==t.editSettings.mode?t.getColumns():[t.getColumnByField(e.columnName)];if(e.isCustomFormValidation&&(n=this.parent.columnModel),this.parent.editSettings.template)return{};for(var r=t.isFrozenGrid()&&t.enableColumnVirtualization&&e.isScroll,s=0,a=n.length;s<a;s++){var o=n[s];if(!(this.parent.editModule.checkColumnIsGrouped(o)||r&&"movable"!==n[s].getFreezeTableName()||e.isCustomFormValidation&&(o.commands||o.commandsTemplate||!o.field)))if(o.commands||o.commandsTemplate){var l=this.serviceLocator.getService("cellRendererFactory"),d=new F["a"](this.parent),c=l.getCellRenderer(A["a"].CommandColumn),h=d.generateRows(e.rowData)[0].cells,p=h.filter(function(e){return e.rowID}),u=c.render(p[s],e.rowData,{index:e.row?e.row.getAttribute(x["d"]):0},this.parent.enableVirtualization),m=u.firstElementChild;m.setAttribute("textAlign",u.getAttribute("textAlign")),i[o.uid]=m}else{var g=o.valueAccessor(o.field,e.rowData,o),f={column:o,value:g,type:e.requestType,data:e.rowData},b=o.edit.create,v=void 0;if(o.editTemplate){v=this.parent.createElement("span",{attrs:{"e-mappinguid":o.uid}});var y=this.parent.element.id+o.uid+"editTemplate",C=Object(j["s"])({},e.rowData,{column:o}),O=this.parent.isReact&&"string"!==typeof o.editTemplate;if(O)o.getEditTemplate()(Object(w["G"])({index:e.rowIndex},C),this.parent,"editTemplate",y,null,null,v),this.parent.renderTemplates();else{var T=o.getEditTemplate()(Object(w["G"])({index:e.rowIndex},C),this.parent,"editTemplate",y);Object(j["f"])(v,T)}}else{if("string"===typeof b?(b=Object(j["N"])(b,window),v=b(f)):v=o.edit.create(f),"string"===typeof v){m=this.parent.createElement("div");m.innerHTML=v,v=m.firstChild}var k="input"!==v.tagName&&v.querySelectorAll("input").length,S=Object(j["B"])(o.field);Object(w["w"])(k?v.querySelector("input"):v,{name:S,"e-mappinguid":o.uid,id:t.element.id+S}),Object(w["y"])(v,["e-input","e-field"],[]),"Right"===o.textAlign&&v.classList.add("e-ralign"),((o.isPrimaryKey||o.isIdentity)&&"beginEdit"===e.requestType||o.isIdentity&&"add"===e.requestType)&&v.setAttribute("disabled","")}i[o.uid]=v}}return i},e.prototype.destroy=function(){this.renderer.removeEventListener()},e}(),V=i("9db8"),q=function(){function e(e){this.parent=e}return e.prototype.create=function(e){return Object(j["l"])(this.parent,e.column,"e-field",{type:"text"})},e.prototype.read=function(e){return e.ej2_instances[0].value},e.prototype.destroy=function(){this.obj&&!this.obj.isDestroyed&&(this.removeEventHandler&&this.removeEventHandler(),this.obj.destroy())},e}(),z=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.activeClasses=["e-selectionbackground","e-active"],t}return z(t,e),t.prototype.create=function(e){var t=e.column,i="e-field e-boolcell";return"checkbox"===t.type&&(i="e-field e-boolcell e-edit-checkselect"),this.removeEventHandler=this.removeEventListener,Object(j["l"])(this.parent,e.column,i,{type:"checkbox",value:e.value})},t.prototype.read=function(e){return e.checked},t.prototype.write=function(e){var t,i;if(Object(w["T"])(e.row)||(t=e.row.querySelector(".e-edit-checkselect")),Object(j["N"])(e.column.field,e.rowData)&&(i=JSON.parse(Object(j["N"])(e.column.field,e.rowData).toString().toLowerCase())),!Object(w["T"])(t)&&"checkbox"===e.column.type){if(this.editType=this.parent.editSettings.mode,this.editRow=e.row,"add"!==e.requestType){var n=this.parent.getRowObjectFromUID(e.row.getAttribute("data-uid"));i=!!n&&n.isSelected}j["c"].apply(void 0,[[].slice.call(e.row.getElementsByClassName(x["B"])),i].concat(this.activeClasses))}this.obj=new V["a"](Object(w["G"])({label:"Dialog"!==this.parent.editSettings.mode?" ":e.column.headerText,checked:i,disabled:!Object(j["ab"])(e.column,e.requestType,e.element),enableRtl:this.parent.enableRtl,cssClass:this.parent.cssClass?this.parent.cssClass:""},e.column.edit.params)),this.addEventListener(),this.obj.appendTo(e.element)},t.prototype.addEventListener=function(){this.cbChange=this.checkBoxChange.bind(this),this.obj.addEventListener(x["f"],this.cbChange)},t.prototype.removeEventListener=function(){this.obj.isDestroyed||this.obj.removeEventListener(x["f"],this.cbChange)},t.prototype.checkBoxChange=function(e){if(this.editRow&&"Dialog"!==this.editType){var t=!1;e.checked?(t=!0,this.editRow.setAttribute("aria-selected",t.toString())):this.editRow.removeAttribute("aria-selected"),j["c"].apply(void 0,[[].slice.call(this.editRow.getElementsByClassName(x["B"])),t].concat(this.activeClasses))}},t}(q),U=i("4f9e"),G=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),W=function(e){function t(t){var i=e.call(this)||this;return i.parent=t,i.flag=!1,i.removeEventHandler=i.removeEventListener,i}return G(t,e),t.prototype.write=function(e){var t="Dialog"!==this.parent.editSettings.mode;this.column=e.column;var i=new T["a"](e.column.field,"notequal",null,!0,!1),n={};if(e.column.edit.params)for(var r=Object.keys(e.column.edit.params),s=0;s<r.length;s++)n[r[s]]="query"===r[s]?e.column.edit.params[r[s]].clone():e.column.edit.params[r[s]];this.obj=new U["a"](Object(w["G"])({dataSource:this.parent.dataSource instanceof O["a"]?this.parent.dataSource:new O["a"](this.parent.dataSource),query:(new T["b"]).where(i).select(e.column.field),enabled:Object(j["ab"])(e.column,e.requestType,e.element),fields:{value:e.column.field},value:Object(j["N"])(e.column.field,e.rowData),enableRtl:this.parent.enableRtl,placeholder:t?"":e.column.headerText,popupHeight:"200px",floatLabelType:t?"Never":"Always",sortOrder:"Ascending",cssClass:this.parent.cssClass?this.parent.cssClass:null,close:this.dropDownClose.bind(this)},n)),this.parent.enableVirtualization&&(this.obj.dataSource=e.column.isForeignColumn()?[e.foreignKeyData[0]]:[e.rowData]),this.addEventListener(),this.obj.query.params=this.parent.query.params,this.obj.appendTo(e.element),e.element.setAttribute("name",Object(j["B"])(e.column.field))},t.prototype.dropDownClose=function(e){},t.prototype.addEventListener=function(){this.ddCreated=this.dropdownCreated.bind(this),this.ddOpen=this.dropDownOpen.bind(this),this.ddBeforeOpen=this.dropdownBeforeOpen.bind(this),this.ddComplete=this.ddActionComplete.bind(this),this.obj.addEventListener(x["j"],this.ddCreated),this.obj.addEventListener(x["z"],this.ddOpen),this.obj.addEventListener(x["e"],this.ddBeforeOpen),this.obj.addEventListener(I["b"],this.ddComplete)},t.prototype.removeEventListener=function(){this.obj.isDestroyed||(this.obj.removeEventListener(x["j"],this.ddCreated),this.obj.removeEventListener(x["z"],this.ddOpen),this.obj.removeEventListener(x["e"],this.ddBeforeOpen),this.obj.removeEventListener(I["b"],this.ddComplete))},t.prototype.dropdownCreated=function(e){this.flag=!0},t.prototype.dropdownBeforeOpen=function(){this.parent.enableVirtualization&&(this.obj.dataSource=this.column.isForeignColumn()?this.column.dataSource instanceof O["a"]?this.column.dataSource:new O["a"](this.column.dataSource):this.parent.dataSource instanceof O["a"]?this.parent.dataSource:new O["a"](this.parent.dataSource))},t.prototype.ddActionComplete=function(e){e.result=S["a"].distinct(e.result,this.obj.fields.value,!0),!this.flag||!this.column.dataSource||this.column.edit.params&&this.column.edit.params.ddEditedData||("result"in this.column.dataSource?this.column.dataSource.result=e.result:this.column.dataSource instanceof O["a"]&&(this.column.dataSource.dataSource.json=e.result)),this.flag=!1},t.prototype.dropDownOpen=function(e){var t=Object(j["hb"])(this.obj.element,"e-dialog");if("Dialog"===this.parent.editSettings.mode&&!Object(w["T"])(t)){var i=Object(w["jb"])("#"+t.id,document).ej2_instances[0];e.popup.element.style.zIndex=(i.zIndex+1).toString()}},t}(q),K=i("a613"),$=function(){function e(e){this.parent=e}return e.prototype.keyEventHandler=function(e){if(13===e.keyCode||9===e.keyCode){var t=document.createEvent("HTMLEvents");t.initEvent("change",!1,!0),this.dispatchEvent(t)}},e.prototype.create=function(e){return this.instances=new w["m"](this.parent.locale),Object(j["l"])(this.parent,e.column,"e-field",{})},e.prototype.read=function(e){return this.obj.value},e.prototype.write=function(e){var t=e.column,i="Dialog"!==this.parent.editSettings.mode;this.obj=new K["a"](Object(w["G"])({value:parseFloat(Object(j["N"])(e.column.field,e.rowData)),enableRtl:this.parent.enableRtl,placeholder:i?"":e.column.headerText,enabled:Object(j["ab"])(e.column,e.requestType,e.element),floatLabelType:"Dialog"!==this.parent.editSettings.mode?"Never":"Always",locale:this.parent.locale,cssClass:this.parent.cssClass?this.parent.cssClass:null},t.edit.params)),e.element.setAttribute("name",Object(j["B"])(e.column.field)),this.obj.appendTo(e.element),this.obj.element.addEventListener("keydown",this.keyEventHandler)},e.prototype.destroy=function(){this.obj&&!this.obj.isDestroyed&&(this.obj.element.removeEventListener("keydown",this.keyEventHandler),this.obj.destroy())},e}(),X=i("f01c"),J=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Q=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return J(t,e),t.prototype.create=function(e){var t={type:"text",value:Object(w["T"])(e.value)?"":e.value,style:"text-align:"+e.column.textAlign};return Object(j["l"])(this.parent,e.column,"e-field e-input e-defaultcell",t)},t.prototype.read=function(e){return e.value},t.prototype.write=function(e){var t=e.column,i="Dialog"!==this.parent.editSettings.mode;this.obj=new X["a"](Object(w["G"])({element:e.element,floatLabelType:"Dialog"!==this.parent.editSettings.mode?"Never":"Always",enableRtl:this.parent.enableRtl,enabled:Object(j["ab"])(e.column,e.requestType,e.element),placeholder:i?"":e.column.headerText,cssClass:this.parent.cssClass?this.parent.cssClass:""},t.edit.params)),this.obj.appendTo(e.element)},t}(q),Y=i("8708"),Z=function(){function e(e,t,i){this.args={},this.currentVirtualData={},this.parent=e,this.renderer=i,this.serviceLocator=t,this.addEventListener()}return e.prototype.clickHandler=function(e){var t=e.target,i=this.parent;(Object(j["hb"])(t,x["s"])&&Object(j["hb"])(Object(j["hb"])(t,x["s"]),"e-grid").id===i.element.id||i.frozenRows&&Object(j["hb"])(t,x["v"]))&&!Object(j["hb"])(t,"e-unboundcelldiv")&&(this.rowIndex=Object(j["hb"])(t,x["B"])?parseInt(t.parentElement.getAttribute(x["d"]),10):-1,i.isEdit&&i.editModule.endEdit())},e.prototype.dblClickHandler=function(e){Object(j["hb"])(e.target,x["B"])&&this.parent.editSettings.allowEditOnDblClick&&this.parent.editModule.startEdit(Object(j["hb"])(e.target,x["A"]))},e.prototype.editComplete=function(e){this.parent.isEdit=!1;var t="action";switch(e.requestType){case"save":(this.parent.isCheckBoxSelection||"Multiple"===this.parent.selectionSettings.type)&&this.parent.isPersistSelection||"edit"!==e[t]&&this.parent.selectRow(0),this.parent.trigger(I["b"],Object(w["G"])(e,{requestType:"save",type:I["b"]}));break;case"delete":this.parent.trigger(I["b"],Object(w["G"])(e,{requestType:"delete",type:I["b"]})),this.parent.isCheckBoxSelection||this.parent.selectRow(this.editRowIndex);break}},e.prototype.getEditArgs=function(e,t,i){for(var n=this.parent.getPrimaryKeyFieldNames(),r=[],s=0;s<n.length;s++)r.push(Object(j["N"])(n[s],e));var a={primaryKey:n,primaryKeyValue:r,requestType:"beginEdit",rowData:e,rowIndex:this.rowIndex,type:"edit",cancel:!1,foreignKeyData:t&&t.foreignKeyData,target:void 0,isScroll:i};return a},e.prototype.startEdit=function(e){var t=this,i=this.parent;if(this.rowIndex=this.editRowIndex=parseInt(e.getAttribute(x["d"]),10),i.enableVirtualization||i.enableInfiniteScrolling){var n='.e-row[aria-rowindex="'+this.rowIndex+'"]',r=this.parent.element.querySelector(n);if(!r)return}var s={data:void 0,index:this.rowIndex,isScroll:!1};if(this.parent.notify(I["ye"],s),Object(j["cb"])(i)){var a=i.getRowObjectFromUID(e.getAttribute("data-uid"));this.previousData=a.data}else this.previousData||!this.parent.enableVirtualization&&!this.parent.enableInfiniteScrolling?this.parent.enableVirtualization||(this.previousData=Object(w["G"])({},{},i.getCurrentViewRecords()[this.rowIndex],!0)):this.previousData=s.data;var o=Object(w["G"])({},{},s.data||this.previousData,!0);this.uid=e.getAttribute("data-uid");var l=i.getRowObjectFromUID(this.uid),d=this.getEditArgs(o,l,s.isScroll);d.row=e,d.isScroll?this.inlineEditHandler(d,e):(this.parent.notify(I["xb"],{uid:this.uid,prevData:this.previousData,argsCreator:this.getEditArgs.bind(this),renderer:this.renderer}),i.trigger(I["H"],d,function(n){n.type="actionBegin",i.trigger(I["a"],n,function(i){i.cancel||t.inlineEditHandler(i,e)})}))},e.prototype.inlineEditHandler=function(e,t){var i=this.parent;i.isEdit=!0,e.row=e.row?e.row:t,"Dialog"!==i.editSettings.mode&&i.clearSelection(),"Dialog"===i.editSettings.mode&&i.selectionModule&&(i.selectionModule.preventFocus=!0,e.row.classList.add("e-dlgeditrow")),this.renderer.update(e),this.uid=t.getAttribute("data-uid"),i.editModule.applyFormValidation(),e.type="actionComplete",i.trigger(I["b"],e),this.args=e,this.parent.allowTextWrap&&this.parent.notify(I["nc"],{case:"textwrap"})},e.prototype.updateRow=function(e,t){var i=this,n=this.parent;this.editRowIndex=e;var r={requestType:"save",action:"edit",type:I["a"],data:t,cancel:!1,previousData:n.getCurrentViewRecords()[e],row:n.getRowByIndex(e)};if(n.showSpinner(),n.enableInfiniteScrolling){this.uid=r.row.getAttribute("data-uid");var s=parseInt(r.row.getAttribute("aria-rowindex"),10);this.parent.notify(I["pd"],{index:s})}n.notify(I["se"],r),r.promise?r.promise.then(function(){return n.refresh()}).catch(function(e){return i.edFail(e)}):n.enableInfiniteScrolling||n.refresh()},e.prototype.editFormValidate=function(){var e=this.parent,t=e.editModule.editFormValidate(),i={prevData:this.previousData,isValid:!0,editIdx:this.editRowIndex,addIdx:this.addedRowIndex};return e.notify(I["ue"],i),t&&i.isValid},e.prototype.endEdit=function(){var e=this.parent;if(this.parent.isEdit&&this.editFormValidate()){var t=Object(w["G"])({},{},this.previousData,!0),i=Object(w["G"])(this.args,{requestType:"save",type:I["a"],data:t,cancel:!1,previousData:this.previousData,selectedRow:e.selectedRowIndex,foreignKeyData:{}}),n="Right"===e.getFrozenMode()?1:0,r="Dialog"===e.editSettings.mode,s=Object(w["jb"])("#"+e.element.id+"_dialogEdit_wrapper",document),a=r?s.querySelector(".e-gridform"):e.element.getElementsByClassName("e-gridform")[n],o={virtualData:Object(w["G"])({},{},this.previousData,!0),isAdd:!1,isScroll:!1,endEdit:!0};if(this.parent.notify(I["sc"],o),(this.parent.enableVirtualization||this.parent.enableInfiniteScrolling)&&"Normal"===this.parent.editSettings.mode&&Object.keys(o.virtualData).length?this.parent.isEdit&&(this.currentVirtualData=t=i.data=o.virtualData):t=e.editModule.getCurrentEditedData(a,t),e.isFrozenGrid()&&"Normal"===e.editSettings.mode){var l=e.getMovableVirtualHeader().querySelector(".e-gridform"),d=e.getMovableVirtualContent().querySelector(".e-gridform"),c=[l||d],h=void 0,p=void 0,u=[];e.getFrozenMode()===x["w"]&&(h=e.getFrozenRightHeader().querySelector(".e-gridform"),p=e.getFrozenRightContent().querySelector(".e-gridform"),u=[h||p]),Object(j["W"])(this.parent,function(i,n){for(var r=0,s=n;r<s.length;r++){var a=s[r];a&&(t=e.editModule.getCurrentEditedData(a,t))}},[[],c,u])}var m=[].slice.call(e.element.getElementsByClassName(x["l"])).length;if(o.isAdd||!Object.keys(this.currentVirtualData).length||m||(m=1),r?s.getElementsByClassName(x["l"]).length:m)i.action="edit",e.trigger(I["a"],i,function(t){t.cancel||(e.showSpinner(),e.notify(I["se"],t))});else if(i.action="add",i.selectedRow=0,i.index=this.addedRowIndex,e.notify(I["Ae"],{}),e.notify(I["Nc"],i),this.addedRowIndex=null,i.cancel)return}},e.prototype.destroyElements=function(){var e=this.parent;e.editModule.destroyWidgets(),e.editModule.destroyForm(),this.parent.notify(I["Mb"],{})},e.prototype.editHandler=function(e){var t=this;e.promise?e.promise.then(function(i){return t.edSucc(i,e)}).catch(function(e){return t.edFail(e)}):this.editSuccess(e.data,e)},e.prototype.edSucc=function(e,t){this.editSuccess(e,t)},e.prototype.edFail=function(e){this.editFailure(e)},e.prototype.updateCurrentViewData=function(e){this.parent.enableVirtualization||this.parent.enableInfiniteScrolling||(this.parent.getCurrentViewRecords()[this.editRowIndex]=e)},e.prototype.requestSuccess=function(e){this.parent.editModule.formObj&&!this.parent.editModule.formObj.isDestroyed&&(this.destroyElements(),this.stopEditStatus(),"Dialog"===this.parent.editSettings.mode&&"add"!==e.action&&this.parent.selectionModule&&this.parent.element.querySelector(".e-dlgeditrow").classList.remove("e-dlgeditrow"))},e.prototype.editSuccess=function(e,t){if(!Object(w["T"])(e)&&!(e instanceof Array)){var i="rowData";t.data=Object(w["G"])({},Object(w["G"])({},t[i],t.data),e)}this.requestSuccess(t),this.parent.trigger(I["x"],t),t.type=I["b"],this.parent.isEdit=!1,this.refreshRow(t.data),this.parent.notify(I["Ae"],t),this.parent.editModule.checkLastRow(t.row),this.parent.editModule.isLastRow=!1,this.updateCurrentViewData(t.data),this.blazorTemplate(),this.editRowIndex=null,this.parent.trigger(I["b"],t),(!this.parent.isCheckBoxSelection&&"Multiple"!==this.parent.selectionSettings.type||!this.parent.isPersistSelection&&!this.parent.selectionSettings.checkboxOnly)&&"Dialog"!==this.parent.editSettings.mode&&this.parent.selectRow(this.rowIndex>-1?this.rowIndex:this.editRowIndex),this.parent.hideSpinner()},e.prototype.closeForm=function(){!this.cloneRow&&this.parent.isEdit&&this.stopEditStatus(),this.cloneRow&&(this.cloneRow.remove(),this.cloneRow=null,this.originalRow.classList.remove("e-hiddenrow")),this.parent.isFrozenGrid()&&this.cloneFrozen&&(this.cloneFrozen.remove(),this.frozen.classList.remove("e-hiddenrow"))},e.prototype.blazorTemplate=function(){var e=this.parent.getColumns();this.parent.editSettings.template&&"Normal"===this.parent.editSettings.mode&&Object(w["qb"])(this.parent.element.id+"editSettingsTemplate","Template",this.parent.editSettings);for(var t=0;t<e.length;t++){var i=e[t];i.template&&Object(w["qb"])(this.parent.element.id+i.uid,"Template",i,!1),i.editTemplate&&Object(w["qb"])(this.parent.element.id+i.uid+"editTemplate","EditTemplate",i)}},e.prototype.editFailure=function(e){this.parent.trigger(I["c"],{error:e}),this.parent.hideSpinner(),this.parent.log("actionfailure",{error:e})},e.prototype.needRefresh=function(){var e=!0,t=this.parent.element.querySelector(".e-gridform");return!this.parent.enableVirtualization&&!this.parent.infiniteScrollSettings.enableCache||"Normal"!==this.parent.editSettings.mode||t||(e=!1),e},e.prototype.refreshRow=function(e){var t=this.parent.isFrozenGrid(),i=new Y["a"](this.serviceLocator,null,this.parent),n=this.parent.getRowObjectFromUID(this.uid);if(n){n.changes=e,this.parent.notify(I["td"],{data:e}),Object(j["lb"])(n,this.parent.getForeignKeyColumns(),n.changes),this.needRefresh()&&i.refresh(n,this.parent.getColumns(),!0);var r=[].slice.call(this.parent.element.querySelectorAll('[aria-rowindex="'+n.index+'"]'));if(t&&r.length)for(var s=0;s<r.length;s++){var a=r[s].getAttribute("data-uid");a!==this.uid&&(n=this.parent.getRowObjectFromUID(a),n.changes=e,i.refresh(n,this.parent.getColumns(),!0),this.parent.editModule.checkLastRow(r[s]))}}},e.prototype.closeEdit=function(){var e=this;if(this.parent.isEdit){var t=this.parent,i=Object(w["G"])(this.args,{requestType:"cancel",type:I["a"],cancel:!1,data:this.previousData,selectedRow:t.selectedRowIndex});t.notify(I["ze"],i),this.blazorTemplate(),t.trigger(I["a"],i,function(i){if(!i.cancel){"Dialog"===e.parent.editSettings.mode&&e.parent.notify(I["Mb"],{}),t.isEdit=!1,e.stopEditStatus(),i.type=I["b"],"Dialog"!==t.editSettings.mode&&e.refreshRow(i.data);var n=t.groupSettings.enableLazyLoading&&t.groupSettings.columns.length&&!t.getContentTable().querySelector("tr.e-emptyrow");t.getContentTable().querySelector("tr.e-emptyrow")||t.getContentTable().querySelector("tr.e-row")||n||t.renderModule.emptyRow(),"Dialog"!==t.editSettings.mode&&t.selectRow(e.rowIndex),t.trigger(I["b"],i)}})}},e.prototype.addRecord=function(e,t){var i=this,n=this.parent;if(this.addedRowIndex=t=Object(w["T"])(t)?0:t,e)n.notify(I["Nc"],{requestType:"save",type:I["a"],data:e,selectedRow:0,action:"add",index:t});else if(!n.isEdit){this.previousData={},this.uid="";var r=n.getColumns(),s={virtualData:{},isScroll:!1};this.parent.notify(I["sc"],s);for(var a=0;a<r.length;a++)s.isScroll&&"movable"!==r[a].getFreezeTableName()||r[a].field&&S["a"].setValue(r[a].field,r[a].defaultValue,this.previousData);var o={cancel:!1,foreignKeyData:{},requestType:"add",data:this.previousData,type:I["a"],index:t,rowData:this.previousData,target:void 0,isScroll:s.isScroll};(this.parent.enableVirtualization||this.parent.infiniteScrollSettings.enableCache)&&Object.keys(s.virtualData).length&&(o.data=o.rowData=s.virtualData),o.isScroll?this.inlineAddHandler(o):(this.parent.notify(I["xb"],{uid:this.uid,prevData:this.previousData,argsCreator:this.getEditArgs.bind(this),renderer:this.renderer}),n.trigger(I["a"],o,function(e){e.cancel||i.inlineAddHandler(e)}))}},e.prototype.inlineAddHandler=function(e){var t=this.parent;t.isEdit=!0,"Dialog"!==t.editSettings.mode&&t.clearSelection(),this.renderer.addNew(e),t.editModule.applyFormValidation(),e.type=I["b"],e.row=t.element.querySelector("."+x["b"]),t.trigger(I["b"],e),this.args=e},e.prototype.deleteRecord=function(e,t){if(this.editRowIndex=this.parent.selectedRowIndex,t){t=t instanceof Array?t:[t];var i=this.parent,n=Object.keys(t).length;e=e||this.parent.getPrimaryKeyFieldNames()[0];for(var r=function(n){var r,s,a=i.currentViewData.some(function(i){return s=i,t[n]===Object(j["N"])(e,i)||t[n]===i});t[n]=a?s:t[n][e]?t[n]:(r={},r[e]=t[n],r)},s=0;s<n;s++)r(s)}var a={requestType:"delete",type:I["a"],foreignKeyData:{},data:t||this.parent.getSelectedRecords(),tr:this.parent.getSelectedRows(),cancel:!1};if(Object(w["T"])(this.parent.commandDelIndex)||(a.data[0]=this.parent.getRowObjectFromUID(this.parent.getRowByIndex(this.parent.commandDelIndex).getAttribute("data-uid")).data),this.parent.enableVirtualization&&a.data.length>1){var o=this.parent.getSelectedRows()[0].getAttribute("data-uid");a.data=[this.parent.getRowObjectFromUID(o).data]}this.parent.notify(I["Nc"],a)},e.prototype.stopEditStatus=function(){for(var e=this.parent,t=[].slice.call(e.element.getElementsByClassName(x["b"])),i=[].slice.call(e.element.getElementsByClassName(x["l"])),n=0;n<t.length;n++)Object(w["fb"])(t[n]);for(n=0;n<i.length;n++)i[n].classList.remove(x["l"])},e.prototype.addEventListener=function(){this.parent.isDestroyed||(this.evtHandlers=[{event:I["yb"],handler:this.editHandler},{event:I["Nb"],handler:this.dblClickHandler},{event:I["Y"],handler:this.clickHandler},{event:I["dd"],handler:this.requestSuccess},{event:I["Fb"],handler:this.dblClickHandler},{event:I["Gb"],handler:this.editComplete},{event:I["Xd"],handler:this.editComplete},{event:I["Pd"],handler:this.closeEdit},{event:I["cb"],handler:this.closeForm}],Object(j["d"])(this.parent,this.evtHandlers,!0,this))},e.prototype.removeEventListener=function(){this.parent.isDestroyed||Object(j["d"])(this.parent,this.evtHandlers,!1)},e.prototype.destroy=function(){this.removeEventListener(),this.renderer.destroy()},e}(),ee=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),te=function(e){function t(t,i,n){var r=e.call(this,t,i)||this;return r.parent=t,r.serviceLocator=i,r.renderer=n,r}return ee(t,e),t.prototype.closeEdit=function(){e.prototype.closeEdit.call(this)},t.prototype.addRecord=function(t,i){e.prototype.addRecord.call(this,t,i)},t.prototype.endEdit=function(){e.prototype.endEdit.call(this)},t.prototype.updateRow=function(t,i){e.prototype.updateRow.call(this,t,i)},t.prototype.deleteRecord=function(t,i){e.prototype.deleteRecord.call(this,t,i)},t.prototype.startEdit=function(t){e.prototype.startEdit.call(this,t)},t}(Z),ie=i("a956"),ne=i("e9ec"),re=i("ef97"),se=function(){function e(e,t,i){this.cellDetails={},this.originalCell={},this.cloneCell={},this.editNext=!1,this.preventSaveCell=!1,this.initialRender=!0,this.validationColObj=[],this.parent=e,this.serviceLocator=t,this.renderer=i,this.focus=t.getService("focus"),this.addEventListener()}return e.prototype.addEventListener=function(){this.parent.isDestroyed||(this.evtHandlers=[{event:I["Y"],handler:this.clickHandler},{event:I["Fb"],handler:this.dblClickHandler},{event:I["r"],handler:this.onBeforeCellFocused},{event:I["Q"],handler:this.onCellFocused},{event:I["Nb"],handler:this.dblClickHandler},{event:I["Kc"],handler:this.keyDownHandler},{event:I["Ob"],handler:this.editNextValCell},{event:I["Z"],handler:this.closeForm},{event:I["Hb"],handler:this.destroy}],Object(j["d"])(this.parent,this.evtHandlers,!0,this),this.dataBoundFunction=this.dataBound.bind(this),this.batchCancelFunction=this.batchCancel.bind(this),this.parent.addEventListener(I["Ab"],this.dataBoundFunction),this.parent.addEventListener(I["i"],this.batchCancelFunction))},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(Object(j["d"])(this.parent,this.evtHandlers,!1),this.parent.removeEventListener(I["Ab"],this.dataBoundFunction),this.parent.removeEventListener(I["i"],this.batchCancelFunction))},e.prototype.batchCancel=function(){this.parent.focusModule.restoreFocus()},e.prototype.dataBound=function(){this.parent.notify(I["oe"],{})},e.prototype.destroy=function(){this.removeEventListener()},e.prototype.clickHandler=function(e){Object(j["hb"])(e.target,this.parent.element.id+"_add",!0)||(this.parent.isEdit&&Object(w["A"])(this.form,"td")!==Object(w["A"])(e.target,"td")&&(this.saveCell(),this.editNextValCell()),Object(j["hb"])(e.target,x["B"])&&!this.parent.isEdit&&this.setCellIdx(e.target))},e.prototype.dblClickHandler=function(e){var t=Object(j["hb"])(e.target,x["B"]),i=Object(j["hb"])(e.target,x["A"]),n=i&&parseInt(i.getAttribute(x["d"]),10),r=t&&parseInt(t.getAttribute(x["c"]),10);Object(w["T"])(t)||Object(w["T"])(n)||isNaN(r)||t.parentElement.classList.contains(x["l"])||this.editCell(n,this.parent.getColumns()[r].field,this.isAddRow(n))},e.prototype.onBeforeCellFocused=function(e){this.parent.isEdit&&this.validateFormObj()&&(e.byClick||["tab","shiftTab","enter","shiftEnter"].indexOf(e.keyArgs.action)>-1)&&(e.cancel=!0,e.byClick?e.clickArgs.preventDefault():e.keyArgs.preventDefault())},e.prototype.onCellFocused=function(e){var t=this.parent.getFrozenLeftCount(),i=this.parent.getFrozenRightColumnsCount(),n=this.parent.getContent().querySelector("."+x["x"]),r=this.parent.getHeaderContent().querySelector("."+x["y"]),s=(!e.container.isContent||!e.container.isDataCell)&&!(this.parent.frozenRows&&e.container.isHeader);if(e.byKey&&!s){var a=e.container.indexes,o=a[0],l=a[1];if(t&&(n.contains(e.element)||this.parent.frozenRows&&r.contains(e.element))&&(l+=t),i){var d=this.parent.getHeaderContent().querySelector(".e-frozen-right-header"),c=this.parent.getContent().querySelector(".e-frozen-right-content");(c.contains(e.element)||this.parent.frozenRows&&d.contains(e.element))&&(l+=t+this.parent.getMovableColumnsCount())}this.parent.frozenRows&&e.container.isContent&&(o+=this.parent.frozenRows);var h=this.parent.isEdit;if(!this.parent.element.getElementsByClassName("e-popup-open").length)switch(h=h&&!this.validateFormObj(),e.keyArgs.action){case"tab":case"shiftTab":var p=this.parent.isRowDragable()&&this.parent.isDetail()?2:this.parent.isRowDragable()||this.parent.isDetail()?1:0,u=this.parent.getColumns()[e.indexes[1]-p];u&&!this.parent.isEdit&&this.editCell(e.indexes[0],u.field),(h||this.parent.isLastCellPrimaryKey)&&this.editCellFromIndex(o,l);break;case"enter":case"shiftEnter":e.keyArgs.preventDefault();var m={cancel:!1,keyArgs:e.keyArgs};this.parent.notify("beforeFocusCellEdit",m),!m.cancel&&h&&this.editCell(o,this.cellDetails.column.field);break;case"f2":this.editCellFromIndex(o,l),this.focus.focus();break}}else this.parent.isEdit&&s&&this.saveCell()},e.prototype.isAddRow=function(e){return this.parent.getDataRows()[e].classList.contains("e-insertedrow")},e.prototype.editCellFromIndex=function(e,t){this.cellDetails.rowIndex=e,this.cellDetails.cellIndex=t,this.editCell(e,this.parent.getColumns()[t].field,this.isAddRow(e))},e.prototype.closeEdit=function(){var e=this,t=this.parent,i=this.parent.getRowsObject(),n={cancel:!1,batchChanges:this.getBatchChanges()};if(t.notify(I["o"],n),!n.cancel){t.isEdit&&this.saveCell(!0),this.isAdded=!1,t.clearSelection();for(var r,s=Object(j["K"])(this.parent),a=function(t){var n=!1,a=i[t].isDirty;Object(j["W"])(o.parent,function(i,r){n=e.removeBatchElementChanges(r[t],a),n&&r.splice(t,1)},s),n&&t--,r=t},o=this,l=0;l<i.length;l++)a(l),l=r;t.getContentTable().querySelector("tr.e-row")||t.renderModule.renderEmptyRow();var d={requestType:"batchCancel",rows:this.parent.getRowsObject()};this.parent.isFrozenGrid()?(this.parent.getRowsObject().length&&t.notify(I["i"],{rows:this.parent.getRowsObject(),args:{isFrozen:!0}}),this.parent.getMovableRowsObject().length&&t.notify(I["i"],{rows:this.parent.getMovableRowsObject()}),this.parent.getFrozenRightRowsObject().length&&t.notify(I["i"],{rows:this.parent.getFrozenRightRowsObject(),args:{renderFrozenRightContent:!0}})):t.notify(I["i"],{rows:this.parent.getRowsObject().length?this.parent.getRowsObject():[new ne["a"]({isDataRow:!0,cells:[new re["a"]({isDataCell:!0,visible:!0})]})]}),t.selectRow(this.cellDetails.rowIndex),this.refreshRowIdx(),t.notify(I["oe"],{}),this.parent.notify(I["pe"],{}),d={requestType:"batchCancel",rows:this.parent.getRowsObject()},t.trigger(I["i"],d)}},e.prototype.removeBatchElementChanges=function(e,t){var i=this.parent,n=new Y["a"](this.serviceLocator,null,this.parent),r=!1;if(t){e.isDirty=t;var s=i.getRowElementByUID(e.uid);if(s&&(s.classList.contains("e-insertedrow")?(Object(w["fb"])(s),r=!0):(Object(j["lb"])(e,this.parent.getForeignKeyColumns(),e.data),delete e.changes,delete e.edit,e.isDirty=!1,Object(w["y"])(s,[],["e-hiddenrow","e-updatedtd"]),n.refresh(e,i.getColumns(),!1)),this.parent.aggregates.length>0)){var a="type",o=[];o[a]="cancel",this.parent.notify(I["ld"],o),this.parent.groupSettings.columns.length>0&&this.parent.notify(I["tc"],o)}}return r},e.prototype.removeHideAndSelection=function(e){if(e.classList.contains("e-hiddenrow")){e.removeAttribute("aria-selected");for(var t=[].slice.call(e.getElementsByClassName("e-selectionbackground")),i=0;i<t.length;i++)Object(w["gb"])([t[i]],["e-selectionbackground","e-active"])}Object(w["y"])(e,[],["e-hiddenrow","e-updatedtd"])},e.prototype.deleteRecord=function(e,t){this.saveCell(),this.validateFormObj()&&this.saveCell(!0),this.isAdded=!1,this.bulkDelete(e,t),this.parent.aggregates.length>0&&(this.parent.notify(I["ld"],{}),this.parent.groupSettings.columns.length>0&&this.parent.notify(I["tc"],{}))},e.prototype.addRecord=function(e){this.bulkAddRow(e)},e.prototype.endEdit=function(){this.parent.isEdit&&this.validateFormObj()||this.batchSave()},e.prototype.closeForm=function(){for(var e=0;e<Object.keys(this.originalCell).length;e++)for(var t=0;t<Object.keys(this.cloneCell).length;t++)Object.keys(this.originalCell)[e]===Object.keys(this.cloneCell)[t]&&(this.cloneCell[Object.keys(this.cloneCell)[t]].replaceWith(this.originalCell[Object.keys(this.originalCell)[e]]),this.originalCell[Object.keys(this.originalCell)[e]].classList.contains("e-selectionbackground")&&this.originalCell[Object.keys(this.originalCell)[e]].classList.remove("e-selectionbackground","e-cellselectionbackground","e-active"));this.cloneCell={},this.originalCell={}},e.prototype.validateFormObj=function(){return this.parent.editModule.formObj&&!this.parent.editModule.formObj.validate()},e.prototype.batchSave=function(){var e=this.parent,t="deletedRecords";if(e.isCheckBoxSelection){var i=e.element.querySelector(".e-checkselectall").parentElement;i.classList.contains("e-checkbox-disabled")&&e.pageSettings.totalRecordsCount>e.currentViewData.length&&Object(w["gb"])([i],["e-checkbox-disabled"])}if(this.saveCell(),!(e.isEdit||this.editNextValCell()||e.isEdit)){var n=this.getBatchChanges();"Multiple"===this.parent.selectionSettings.type&&n[t].length&&this.parent.selectionSettings.persistSelection&&(n[t]=this.removeSelectedData,this.removeSelectedData=[]);var r={changedRecords:this.parent.getRowsObject().filter(function(e){return e.isDirty&&-1===["add","delete"].indexOf(e.edit)}).map(function(e){return e.data})},s={batchChanges:n,cancel:!1};e.trigger(I["q"],s,function(t){t.cancel||(e.showSpinner(),e.notify(I["I"],{changes:n,original:r}))})}},e.prototype.getBatchChanges=function(){for(var e={addedRecords:[],deletedRecords:[],changedRecords:[]},t=this.parent.getRowsObject(),i=0,n=t;i<n.length;i++){var r=n[i];if(r.isDirty)switch(r.edit){case"add":e.addedRecords.push(r.changes);break;case"delete":e.deletedRecords.push(r.data);break;default:e.changedRecords.push(r.changes)}}return e},e.prototype.removeRowObjectFromUID=function(e){for(var t=this.parent.getRowsObject(),i=0,n=t.length;i<n;i++)if(t[i].uid===e)break;Object(j["W"])(this.parent,function(e,t){t.splice(i,1)},Object(j["K"])(this.parent))},e.prototype.addRowObject=function(e,t){var i=this.parent,n="Top"===i.editSettings.newRowPosition;Object(j["W"])(this.parent,function(r,s){var a=e.clone();i.isFrozenGrid()?t===r&&(n?s.unshift(a):s.push(a)):n?s.unshift(a):s.push(a)},Object(j["K"])(this.parent),!0)},e.prototype.bulkDelete=function(e,t){var i=this;this.removeSelectedData=[];var n=this.parent,r=n.selectedRowIndex,s=n.getSelectedRows(),a={primaryKey:this.parent.getPrimaryKeyFieldNames(),rowIndex:r,rowData:t||n.getSelectedRecords()[0],cancel:!1};a.row=t?n.editModule.deleteRowUid?n.getRowElementByUID(n.editModule.deleteRowUid):n.getRows()[n.getCurrentViewRecords().indexOf(t)]:t?n.getRows()[r]:s[0],a.row&&n.trigger(I["p"],a,function(e){if(!e.cancel){if(i.removeSelectedData=n.getSelectedRecords(),n.clearSelection(),e.row=e.row?e.row:t?n.getRows()[r]:s[0],i.parent.isFrozenGrid()){t&&(r=parseInt(e.row.getAttribute(x["d"]),10),s=[],s.push(n.getRowByIndex(r)),s.push(n.getMovableRowByIndex(r)),n.getFrozenMode()===x["w"]&&s.push(n.getFrozenRightRowByIndex(r)));for(var a=0;a<s.length;a++){var o=s[a].getAttribute("data-uid");if(s[a].classList.contains("e-insertedrow"))i.removeRowObjectFromUID(o),Object(w["fb"])(s[a]);else{var l=n.getRowObjectFromUID(o);l.isDirty=!0,l.edit="delete",Object(w["y"])(s[a],["e-hiddenrow","e-updatedtd"],[]),n.frozenRows&&r<n.frozenRows&&n.getMovableDataRows().length>=n.frozenRows&&(n.getMovableHeaderTbody().appendChild(n.getMovableRowByIndex(n.frozenRows-1)),n.getFrozenHeaderTbody().appendChild(n.getRowByIndex(n.frozenRows-1)),n.getFrozenMode()===x["w"]&&n.getFrozenRightHeaderTbody().appendChild(n.getFrozenRightRowByIndex(n.frozenRows-1))),n.frozenRows&&r<n.frozenRows&&n.getDataRows().length>=n.frozenRows&&n.getHeaderTable().querySelector(x["D"]).appendChild(n.getRowByIndex(n.frozenRows-1))}delete s[a]}}else if(i.parent.isFrozenGrid()||1!==s.length&&!t)for(a=0;a<s.length;a++){var d=s[a].getAttribute("data-uid");if(s[a].classList.contains("e-insertedrow"))i.removeRowObjectFromUID(d),Object(w["fb"])(s[a]);else{Object(w["y"])(s[a],["e-hiddenrow","e-updatedtd"],[]);var c=n.getRowObjectFromUID(d);c.isDirty=!0,c.edit="delete",delete s[a]}}else{o=e.row.getAttribute("data-uid");if(o=t&&i.parent.editModule.deleteRowUid?o=i.parent.editModule.deleteRowUid:o,e.row.classList.contains("e-insertedrow"))i.removeRowObjectFromUID(o),Object(w["fb"])(e.row);else{l=n.getRowObjectFromUID(o);l.isDirty=!0,l.edit="delete",Object(w["y"])(e.row,["e-hiddenrow","e-updatedtd"],[])}delete e.row}i.refreshRowIdx(),t&&(n.editModule.deleteRowUid=void 0,n.getSelectedRows().length&&(r=parseInt(n.getSelectedRows()[0].getAttribute(x["d"]),10))),n.isCheckBoxSelection||n.selectRow(r),n.trigger(I["j"],e),n.notify(I["j"],{rows:i.parent.getRowsObject()}),n.notify(I["oe"],{})}})},e.prototype.refreshRowIdx=function(){for(var e,t=this.parent,i=t.getAllDataRows(!0),n=Object(j["J"])(this.parent),r=Object(j["K"])(this.parent),s=function(t,s,o){i[t].classList.contains(x["A"])&&!i[t].classList.contains("e-hiddenrow")?(Object(j["W"])(a.parent,function(e,i,n){i[t].setAttribute(x["d"],s.toString()),n[t].index=s},n,null,r),s++):Object(j["W"])(a.parent,function(e,i,n){i[t].removeAttribute(x["d"]),n[t].index=-1},n,null,r),e=s},a=this,o=0,l=0,d=i.length;o<d;o++)s(o,l,d),l=e},e.prototype.getIndexFromData=function(e){return Object(j["X"])(e,this.parent.getCurrentViewRecords())},e.prototype.bulkAddRow=function(e){var t=this,i=this.parent;if(i.editSettings.allowAdding&&(i.isEdit&&(this.saveCell(),this.parent.notify(I["Ob"],{})),!i.isEdit)){if(this.initialRender){for(var n=i.getVisibleColumns(),r=0;r<n.length;r++)if(n[r].validationRules&&n[r].validationRules["required"]){var s={field:n[r]["field"].slice(),cellIdx:r};this.validationColObj.push(s)}this.initialRender=!1}this.parent.element.classList.add("e-editing");var a=e||this.getDefaultData(),o={defaultData:a,primaryKey:i.getPrimaryKeyFieldNames(),cancel:!1};i.trigger(I["n"],o,function(n){if(!n.cancel)if(t.isAdded=!0,i.clearSelection(),i.isFrozenGrid()){for(var r=t.parent.getMovableColumnsCount(),s=t.parent.getFrozenLeftCount(),a=t.parent.getFrozenRightColumnsCount(),o=i.getContentTable().querySelector(x["D"]),l=r+s+a,d=void 0,c=[],h=[],p=void 0,u=void 0,m=void 0,g=void 0,f=void 0,b=0;b<l;){var v=new Y["a"](t.serviceLocator,null,t.parent),y=new F["a"](t.parent),C=y.generateRows([n.defaultData]);s>0?(s=0,d="frozen-left",l=s+a+r):r>0?(r=0,d="movable",l=s+a+r):(a=0,d="frozen-right",l=s+a+r);for(var O=0;O<C.length;O++)C[O].cells=Object(j["Db"])(t.parent,C[O].cells,d);"frozen-left"===d?(m=v.render(C[0],i.getColumns()),m.classList.add("e-insertedrow")):"movable"===d?(g=v.render(C[0],i.getColumns()),g.classList.add("e-insertedrow")):(f=v.render(C[0],i.getColumns()),f.classList.add("e-insertedrow"));for(var T=0;T<t.parent.groupSettings.columns.length;T++)m.insertBefore(t.parent.createElement("td",{className:"e-indentcell"}),m.firstChild),C[0].cells.unshift(new re["a"]({cellType:A["a"].Indent}));if(o.querySelector(".e-emptyrow")){var k=o.querySelector(".e-emptyrow");k.parentNode.removeChild(k),t.removeFrozenTbody()}"frozen-left"===d&&(o=i.frozenRows&&"Top"===i.editSettings.newRowPosition?i.getHeaderTable().querySelector(x["D"]):i.getContentTable().querySelector(x["D"]),"Top"===t.parent.editSettings.newRowPosition?(o.insertBefore(m,o.firstChild),Object(w["u"])([].slice.call(m.getElementsByClassName(x["B"])),["e-updatedtd"])):(o.appendChild(m),Object(w["u"])([].slice.call(m.getElementsByClassName(x["B"])),["e-updatedtd"]))),"movable"!==d&&"frozen-right"!==d||t.renderFrozenAddRow(g,f,d),C[0].isDirty=!0,C[0].changes=Object(w["G"])({},{},C[0].data,!0),C[0].edit="add",t.addRowObject(C[0],d)}t.refreshRowIdx(),t.focus.forgetPrevious(),i.notify(I["h"],{rows:t.parent.getRowsObject(),args:{isFrozen:t.parent.isFrozenGrid()}});var S=t.getBatchChanges(),R=t.getBottomIndex();"Top"===t.parent.editSettings.newRowPosition?i.selectRow(0):i.selectRow(R),e||(u=t.findNextEditableCell(0,!0),p=i.getColumns()[u],"Top"===t.parent.editSettings.newRowPosition?t.editCell(0,p.field,!0):t.editCell(R,p.field,!0)),t.parent.aggregates.length>0&&(e||S[x["a"]].length)&&t.parent.notify(I["ld"],{}),m&&(Object(j["e"])(g.querySelector("td:not(.e-hide)"),m.querySelector("td:not(.e-hide)")),c.push(m),h.push(m.cells)),c.push(g),h.push(g.cells),f&&(c.push(f),h.push(f.cells));var D={defaultData:n.defaultData,row:c,columnObject:p,columnIndex:u,primaryKey:n.primaryKey,cell:h};i.trigger(I["h"],D)}else{for(v=new Y["a"](t.serviceLocator,null,t.parent),y=new F["a"](t.parent),C=y.generateRows([n.defaultData]),m=v.render(C[0],i.getColumns()),p=void 0,u=void 0,b=0;b<t.parent.groupSettings.columns.length;b++)m.insertBefore(t.parent.createElement("td",{className:"e-indentcell"}),m.firstChild),C[0].cells.unshift(new re["a"]({cellType:A["a"].Indent}));var E=i.getContentTable().querySelector(x["D"]);if(m.classList.add("e-insertedrow"),E.querySelector(".e-emptyrow")){k=E.querySelector(".e-emptyrow");k.parentNode.removeChild(k),t.removeFrozenTbody()}E=i.frozenRows&&"Top"===i.editSettings.newRowPosition?i.getHeaderTable().querySelector(x["D"]):i.getContentTable().querySelector(x["D"]),"Top"===t.parent.editSettings.newRowPosition?E.insertBefore(m,E.firstChild):E.appendChild(m),Object(w["u"])([].slice.call(m.getElementsByClassName(x["B"])),["e-updatedtd"]),C[0].isDirty=!0,C[0].changes=Object(w["G"])({},{},C[0].data,!0),C[0].edit="add",t.addRowObject(C[0]),t.refreshRowIdx(),t.focus.forgetPrevious(),i.notify(I["h"],{rows:t.parent.getRowsObject(),args:{isFrozen:t.parent.isFrozenGrid()}});S=t.getBatchChanges(),R=t.getBottomIndex();"Top"===t.parent.editSettings.newRowPosition?i.selectRow(0):i.selectRow(R),e||(u=t.findNextEditableCell(0,!0),p=i.getColumns()[u],"Top"===t.parent.editSettings.newRowPosition?t.editCell(0,p.field,!0):t.editCell(R,p.field,!0)),t.parent.aggregates.length>0&&(e||S[x["a"]].length)&&t.parent.notify(I["ld"],{});D={defaultData:n.defaultData,row:m,columnObject:p,columnIndex:u,primaryKey:n.primaryKey,cell:m.cells[u]};i.trigger(I["h"],D)}})}},e.prototype.renderFrozenAddRow=function(e,t,i){var n,r,s=this.parent;"movable"===i&&(n=s.frozenRows&&"Top"===s.editSettings.newRowPosition?this.parent.getMovableHeaderTbody():this.parent.getContent().querySelector(".e-movablecontent").querySelector(x["D"]),"Top"===s.editSettings.newRowPosition?n.insertBefore(e,n.firstChild):n.appendChild(e),Object(w["u"])([].slice.call(e.getElementsByClassName(x["B"])),["e-updatedtd"])),"frozen-right"===i&&(r=s.frozenRows&&"Top"===s.editSettings.newRowPosition?this.parent.getFrozenRightHeaderTbody():this.parent.getContent().querySelector(".e-frozen-right-content").querySelector(x["D"]),"Top"===s.editSettings.newRowPosition?r.insertBefore(t,r.firstChild):r.appendChild(t),Object(w["u"])([].slice.call(t.getElementsByClassName(x["B"])),["e-updatedtd"]),Object(j["e"])(t.querySelector("td:not(.e-hide)"),e.querySelector("td:not(.e-hide)"))),"auto"===s.height&&s.notify(I["oc"],{})},e.prototype.removeFrozenTbody=function(){var e=this.parent;if(e.isFrozenGrid()){var t=e.getContent().querySelector("."+x["x"]).querySelector(x["D"]);if(t.firstElementChild.parentNode.removeChild(t.firstElementChild),e.getFrozenMode()===x["w"]){var i=e.getContent().querySelector(".e-frozen-right-content").querySelector(x["D"]);i.firstElementChild.parentNode.removeChild(i.firstElementChild)}}},e.prototype.renderMovable=function(e,t){var i=e.cloneNode(!0),n=this.parent.getMovableColumnsCount(),r=this.parent.getFrozenLeftCount(),s=this.parent.getFrozenRightColumnsCount();return Object(j["Cb"])(e,0,r),Object(j["Cb"])(i,r,s?i.children.length-s:i.children.length),Object(j["Cb"])(t,r+n,t.children.length),i},e.prototype.findNextEditableCell=function(e,t,i){for(var n,r=this.parent.getColumns(),s=r.length,a=e;a<s;a++){if(n=!!i&&Object(w["T"])(r[a].validationRules),!t&&this.checkNPCell(r[a]))return a;if(t&&!r[a].template&&r[a].visible&&r[a].allowEditing&&(!r[a].isIdentity||!r[a].isPrimaryKey)&&!n)return a}return-1},e.prototype.checkNPCell=function(e){return!e.template&&e.visible&&!e.isPrimaryKey&&!e.isIdentity&&e.allowEditing},e.prototype.getDefaultData=function(){for(var e=this.parent,t={},i={number:0,string:null,boolean:!1,date:null,datetime:null},n=0,r=e.columnModel;n<r.length;n++){var s=r[n];s.field&&Object(w["ob"])(s.field,Object.keys(s).indexOf("defaultValue")>=0?s.defaultValue:i[s.type],t)}return t},e.prototype.setCellIdx=function(e){var t=0;this.parent.allowGrouping&&(t=this.parent.groupSettings.columns.length),this.cellDetails.cellIndex=e.cellIndex-t,this.cellDetails.rowIndex=parseInt(e.getAttribute("index"),10)},e.prototype.editCell=function(e,t,i){var n=this.parent,r=n.getColumnByField(t);this.index=e,this.field=t,this.isAdd=i;var s=n.isEdit&&!(this.cellDetails.column.field===t&&this.cellDetails.rowIndex===e&&this.parent.getDataRows().length-1!==e);n.editSettings.allowEditing&&(!s&&r.allowEditing?this.editCellExtend(e,t,i):s&&(this.editNext=!0,this.saveCell()))},e.prototype.editCellExtend=function(e,t,i){var n=this,r=this.parent,s=r.getColumnByField(t),a=r.getPrimaryKeyFieldNames();if(!r.isEdit){var o,l,d=Object(w["G"])({},{},this.getDataByIndex(e),!0);if("movable"===s.getFreezeTableName()||s.getFreezeTableName()===x["q"]?(o="movable"===s.getFreezeTableName()?r.getMovableDataRows()[e]:r.getFrozenRightDataRows()[e],l=this.parent.getRowObjectFromUID(o.getAttribute("data-uid")),d=l.changes?Object(w["G"])({},{},l.changes,!0):d):(o=r.getDataRows()[e],d=Object(w["G"])({},{},this.getDataByIndex(e),!0)),a[0]===s.field&&!o.classList.contains("e-insertedrow")||s.columns||s.isPrimaryKey&&s.isIdentity)this.parent.isLastCellPrimaryKey=!0;else{this.parent.isLastCellPrimaryKey=!1,this.parent.element.classList.add("e-editing");var c=r.getRowObjectFromUID(o.getAttribute("data-uid")),h=[].slice.apply(o.cells),p={columnName:s.field,isForeignKey:!Object(w["T"])(s.foreignKeyValue),primaryKey:a,rowData:d,validationRules:Object(w["G"])({},s.validationRules?s.validationRules:{}),value:Object(j["N"])(s.field,d),type:i?"add":"edit",cancel:!1,foreignKeyData:c&&c.foreignKeyData};p.cell=h[this.getColIndex(h,this.getCellIdx(s.uid))],p.row=o,p.columnObject=s,p.cell&&r.trigger(I["P"],p,function(t){t.cancel||(t.cell=t.cell?t.cell:h[n.getColIndex(h,n.getCellIdx(s.uid))],t.row=t.row?t.row:o,t.columnObject=t.columnObject?t.columnObject:s,t.columnObject.index=Object(w["T"])(t.columnObject.index)?0:t.columnObject.index,n.cellDetails={rowData:d,column:s,value:t.value,isForeignKey:t.isForeignKey,rowIndex:e,cellIndex:parseInt(t.cell.getAttribute(x["c"]),10),foreignKeyData:t.foreignKeyData},t.cell.classList.contains("e-updatedtd")&&(n.isColored=!0,t.cell.classList.remove("e-updatedtd")),r.isEdit=!0,r.clearSelection(),r.isCheckBoxSelection&&r.isPersistSelection||r.selectRow(n.cellDetails.rowIndex,!0),n.renderer.update(t),n.parent.notify(I["k"],t),n.form=Object(w["jb"])("#"+r.element.id+"EditForm",r.element),r.editModule.applyFormValidation([s]),n.parent.element.querySelector(".e-gridpopup").style.display="none")})}}},e.prototype.updateCell=function(e,t,i){var n=this.parent,r=n.getColumnByField(t),s=n.getColumnIndexByField(t);if(r&&!r.isPrimaryKey&&r.allowEditing){var a=Object(j["w"])(this.parent,r,e,s),o="movable"===r.getFreezeTableName()?this.parent.getMovableRowsObject()[e]:r.getFreezeTableName()===x["q"]?n.getFrozenRightRowsObject()[e]:n.getRowObjectFromUID(a.parentElement.getAttribute("data-uid"));this.refreshTD(a,r,o,i),this.parent.trigger(I["cd"],{cell:this.newReactTd||a,column:r,data:o.changes})}},e.prototype.setChanges=function(e,t,i){var n;if(this.parent.isFrozenGrid()){var r=this.parent.getRowElementByUID(e.uid),s=parseInt(r.getAttribute(x["d"]),10);n=this.parent.getRowsObject()[s],n.changes||(n.changes=Object(w["G"])({},{},e.data,!0)),Object(w["T"])(t)||Object(w["ob"])(t,i,n.changes);var a=this.parent.getMovableRowsObject()[s];if(a.changes=Object(w["G"])({},{},n.changes,!0),e.data[t]!==i&&(a.isDirty=!0,n.isDirty=!0),this.parent.getFrozenMode()===x["w"]){var o=this.parent.getFrozenRightRowsObject()[s];o.changes=Object(w["G"])({},{},n.changes,!0),e.data[t]!==i&&(o.isDirty=!0)}}else if(e.changes||(e.changes=Object(w["G"])({},{},e.data,!0)),Object(w["T"])(t)||S["a"].setValue(t,i,e.changes),e.data[t]!==i){var l=this.parent.getColumnByField(t).type;"date"===l||"datetime"===l?new Date(e.data[t]).toString()!==new Date(i).toString()&&(e.isDirty=!0):e.isDirty=!0}},e.prototype.updateRow=function(e,t){for(var i=Object.keys(t),n=0,r=i;n<r.length;n++){var s=r[n];this.updateCell(e,s,t[s])}},e.prototype.getCellIdx=function(e){var t=this.parent.getColumnIndexByUid(e)+this.parent.groupSettings.columns.length;return Object(w["T"])(this.parent.detailTemplate)&&Object(w["T"])(this.parent.childGrid)||t++,this.parent.isRowDragable()&&t++,t},e.prototype.refreshTD=function(e,t,i,n){var r,s=new ie["a"](this.parent,this.serviceLocator);n="number"!==t.type||Object(w["T"])(n)?n:parseFloat(n),this.setChanges(i,t.field,n);var a,o,l=this.parent.getFrozenColumns()||this.parent.getFrozenLeftColumnsCount()||this.parent.getFrozenRightColumnsCount();l=l&&this.parent.isRowDragable()?l+1:l,Object(j["lb"])(i,this.parent.getForeignKeyColumns(),i.changes),r=l&&"movable"===t.getFreezeTableName()&&this.parent.getColumns().length===i.cells.length?i.cells.slice(l,i.cells.length):i.cells,this.parent.isReact&&(a=e.parentElement,o=e.cellIndex);var d=0;l&&(d="movable"===t.getFreezeTableName()&&"Right"!==this.parent.getFrozenMode()?l:t.getFreezeTableName()===x["q"]?this.parent.getFrozenLeftColumnsCount()+this.parent.getMovableColumnsCount():d),s.refreshTD(e,r[this.getCellIdx(t.uid)-d],i.changes,{index:this.getCellIdx(t.uid)}),this.parent.isReact?(this.newReactTd=a.cells[o],a.cells[o].classList.add("e-updatedtd")):e.classList.add("e-updatedtd"),e.classList.add("e-updatedtd"),this.parent.notify(I["oe"],{})},e.prototype.getColIndex=function(e,t){var i=0;this.parent.allowGrouping&&this.parent.groupSettings.columns&&(i=this.parent.groupSettings.columns.length),Object(w["T"])(this.parent.detailTemplate)&&Object(w["T"])(this.parent.childGrid)||i++,this.parent.isRowDragable()&&i++;for(var n=0;n<e.length;n++){var r=parseInt(e[n].getAttribute(x["c"]),10);if(r===t-i)return n}return-1},e.prototype.editNextValCell=function(){var e=this.parent,t=e.element.querySelectorAll(".e-insertedrow"),i=1===t.length||(e.getFrozenColumns()>0||e.getFrozenRightColumnsCount()>0||e.getFrozenLeftColumnsCount()>0)&&(2===t.length||3===t.length);if(i&&this.isAdded&&!e.isEdit){for(var n=this.getBottomIndex(),r=this.cellDetails.cellIndex;r<e.getColumns().length;r++){if(e.isEdit)return;var s=this.findNextEditableCell(this.cellDetails.cellIndex+1,!0,!0),a=e.getColumns()[s];if(a){if("Bottom"===this.parent.editSettings.newRowPosition)this.editCell(n,a.field,!0);else{var o={index:0,column:a};this.parent.notify(I["Oc"],o),this.editCell(o.index,a.field,!0)}this.saveCell()}}e.isEdit||(this.isAdded=!1)}else if(i||!this.isAdded||e.isEdit||e.isFrozenGrid()){if(!i&&this.isAdded&&!e.isEdit&&e.isFrozenGrid()){var l=e.getFrozenLeftContentTbody()?e.getFrozenLeftContentTbody().querySelectorAll(".e-insertedrow"):void 0,d=e.getFrozenRightContentTbody()?e.getFrozenRightContentTbody().querySelectorAll(".e-insertedrow"):void 0,c=e.getMovableContentTbody().querySelectorAll(".e-insertedrow"),h=(m=0,e.getVisibleFrozenLeftCount()?e.getVisibleFrozenLeftCount():e.getFrozenColumns()),p=e.getVisibleFrozenRightCount(),u=e.getVisibleMovableCount();if("Bottom"===e.editSettings.newRowPosition){g=this.getBatchChanges();m=e.getCurrentViewRecords().length-g[x["k"]].length}else"Top"===e.editSettings.newRowPosition&&e.frozenRows&&(l=e.getFrozenHeaderTbody()?e.getFrozenHeaderTbody().querySelectorAll(".e-insertedrow"):void 0,d=e.getFrozenRightHeader()?e.getFrozenRightHeader().querySelectorAll(".e-insertedrow"):void 0,c=e.getMovableHeaderTbody().querySelectorAll(".e-insertedrow"));for(r=0;r<c.length;r++,m++){if(e.isEdit)break;for(f=0;f<this.validationColObj.length;f++){if(e.isEdit)break;h&&this.validationColObj[f].cellIdx<h?""===l[r].querySelectorAll("td")[this.validationColObj[f].cellIdx].innerText&&(this.editCell(m,this.validationColObj[f].field),e.editModule.formObj.validate()&&this.saveCell()):p&&u<=this.validationColObj[f].cellIdx?""===d[r].querySelectorAll("td")[this.validationColObj[f].cellIdx-(u+h)].innerText&&(this.editCell(m,this.validationColObj[f].field),e.editModule.formObj.validate()&&this.saveCell()):""===c[r].querySelectorAll("td")[this.validationColObj[f].cellIdx-h].innerText&&(this.editCell(m,this.validationColObj[f].field),e.editModule.formObj.validate()&&this.saveCell())}}e.isEdit||(this.isAdded=!1)}}else{var m=0;if("Bottom"===e.editSettings.newRowPosition){var g=this.getBatchChanges();m=e.getCurrentViewRecords().length-g[x["k"]].length}for(var r=0;r<t.length;r++,m++){if(e.isEdit)break;for(var f=0;f<this.validationColObj.length;f++){if(e.isEdit)break;""===t[r].querySelectorAll("td")[this.validationColObj[f].cellIdx].innerText&&(this.editCell(m,this.validationColObj[f].field),this.validateFormObj()&&this.saveCell())}}e.isEdit||(this.isAdded=!1)}},e.prototype.escapeCellEdit=function(){var e=this.generateCellArgs();e.value=e.previousValue,!e.value&&this.cellDetails.column.validationRules||this.successCallBack(e,e.cell.parentElement,e.column,!0)(e)},e.prototype.generateCellArgs=function(){var e=this.parent;this.parent.element.classList.remove("e-editing");var t=this.cellDetails.column,i={};i[t.field]=Object(j["N"])(t.field,this.cellDetails.rowData);var n=e.editModule.getCurrentEditedData(this.form,i),r=Object(w["G"])({},n);n=Object(w["G"])({},n,this.cellDetails.rowData);var s=Object(j["N"])(t.field,r);Object(w["T"])(t.field)||Object(w["X"])(s)||Object(w["ob"])(t.field,s,n);var a={columnName:t.field,value:Object(j["N"])(t.field,n),rowData:this.cellDetails.rowData,column:t,previousValue:this.cellDetails.value,isForeignKey:this.cellDetails.isForeignKey,cancel:!1};return a.cell=this.form.parentElement,a.columnObject=t,a},e.prototype.saveCell=function(e){if(!this.preventSaveCell&&this.form){var t=this.parent;if(e||t.isEdit&&!this.validateFormObj()){this.preventSaveCell=!0;var i=this.generateCellArgs(),n=i.cell.parentElement,r=i.column;e?this.successCallBack(i,n,r)(i):(t.trigger(I["R"],i,this.successCallBack(i,n,r)),t.notify(I["l"],{formObj:this.form}))}}},e.prototype.successCallBack=function(e,t,i,n){var r=this;return function(e){var s=r.parent;if(e.cell=e.cell?e.cell:r.form.parentElement,e.columnObject=e.columnObject?e.columnObject:i,e.columnObject.index=Object(w["T"])(e.columnObject.index)?0:e.columnObject.index,e.cancel){if(r.preventSaveCell=!1,r.editNext){if(r.editNext=!1,r.cellDetails.rowIndex===r.index&&r.cellDetails.column.field===r.field)return;r.editCellExtend(r.index,r.field,r.isAdd)}}else{s.editModule.destroyWidgets([i]),s.isEdit=!1,s.editModule.destroyForm(),r.parent.notify(I["pe"],{});var a=Object(j["hb"])(e.cell,x["x"])||Object(j["hb"])(e.cell,x["y"])?s.getRowObjectFromUID(t.getAttribute("data-uid"),!0):s.getRowObjectFromUID(t.getAttribute("data-uid"));if(s.getFrozenMode()===x["w"]&&(Object(j["hb"])(e.cell,"e-frozen-right-header")||Object(j["hb"])(e.cell,"e-frozen-right-content"))&&(a=s.getRowObjectFromUID(t.getAttribute("data-uid"),!1,!0)),r.refreshTD(e.cell,i,a,e.value),r.parent.isReact&&(e.cell=r.newReactTd),Object(w["gb"])([t],[x["l"],"e-batchrow"]),Object(w["gb"])([e.cell],["e-editedbatchcell","e-boolcell"]),(!Object(w["T"])(e.value)&&e.value.toString()===(Object(w["T"])(r.cellDetails.value)?"":r.cellDetails.value).toString()&&!r.isColored||Object(w["T"])(e.value)&&Object(w["T"])(a.data[i.field])&&Object(w["T"])(r.cellDetails.value)&&!e.cell.parentElement.classList.contains("e-insertedrow"))&&e.cell.classList.remove("e-updatedtd"),Object(w["T"])(n)&&s.trigger(I["S"],e),s.notify(I["oe"],{}),r.isColored=!1,r.parent.aggregates.length>0&&(r.parent.notify(I["ld"],{}),r.parent.groupSettings.columns.length>0&&!r.isAddRow(r.cellDetails.rowIndex)&&r.parent.notify(I["tc"],{})),r.preventSaveCell=!1,r.editNext){if(r.editNext=!1,r.cellDetails.rowIndex===r.index&&r.cellDetails.column.field===r.field)return;var o=s.getColumnByField(r.field);o&&o.allowEditing&&r.editCellExtend(r.index,r.field,r.isAdd)}n&&s.notify(I["Gd"],{})}}},e.prototype.getDataByIndex=function(e){var t=this.parent.getRowObjectFromUID(this.parent.getDataRows()[e].getAttribute("data-uid"));return t.changes?t.changes:t.data},e.prototype.keyDownHandler=function(e){if(("tab"===e.action||"shiftTab"===e.action)&&this.parent.isEdit){var t=this.parent,i=this.getBottomIndex(),n=Object(j["hb"])(e.target,x["B"]);if(n){var r=n.querySelector(".e-field");if(r){var s=this.parent.getVisibleColumns(),a="tab"===e.action?s.length-1:0;s[a].field===r.getAttribute("id").slice(this.parent.element.id.length)&&(this.cellDetails.rowIndex===i&&"tab"===e.action?"Top"===t.editSettings.newRowPosition?(t.editSettings.newRowPosition="Bottom",this.addRecord(),t.editSettings.newRowPosition="Top"):this.addRecord():this.saveCell())}}}},e.prototype.addCancelWhilePaging=function(){this.validateFormObj()&&(this.parent.notify(I["Jb"],{}),this.parent.isEdit=!1,this.isColored=!1)},e.prototype.getBottomIndex=function(){var e=this.getBatchChanges();return this.parent.getCurrentViewRecords().length+e[x["a"]].length-e[x["k"]].length-1},e}(),ae=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),oe=function(e){function t(t,i,n){var r=e.call(this,t,i)||this;return r.parent=t,r.serviceLocator=i,r.renderer=n,r}return ae(t,e),t.prototype.closeEdit=function(){e.prototype.closeEdit.call(this)},t.prototype.addRecord=function(t,i){e.prototype.addRecord.call(this,t,i)},t.prototype.endEdit=function(){e.prototype.endEdit.call(this)},t.prototype.updateRow=function(t,i){e.prototype.updateRow.call(this,t,i)},t.prototype.deleteRecord=function(t,i){e.prototype.deleteRecord.call(this,t,i)},t.prototype.startEdit=function(t){e.prototype.startEdit.call(this,t)},t}(Z),le=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),de=function(e,t,i,n){var r,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var o=e.length-1;o>=0;o--)(r=e[o])&&(a=(s<3?r(a):s>3?r(t,i,a):r(t,i))||a);return s>3&&a&&Object.defineProperty(t,i,a),a},ce={EMAIL:new RegExp("^[A-Za-z0-9._%+-]{1,}@[A-Za-z0-9._%+-]{1,}([.]{1}[a-zA-Z0-9]{2,}|[.]{1}[a-zA-Z0-9]{2,4}[.]{1}[a-zA-Z0-9]{2,4})$"),URL:/^(?:http(s)?:\/\/)?[\w.-]+(?:\.[\w\.-]+)+[\w\-\._~:/?#[\]@!\$&'\(\)\*\+,;=.]+$/m,DATE_ISO:new RegExp("^([0-9]{4})-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])$"),DIGITS:new RegExp("^[0-9]*$"),PHONE:new RegExp("^[+]?[0-9]{9,13}$"),CREDITCARD:new RegExp("^\\d{13,16}$")};(function(e){e[e["Message"]=0]="Message",e[e["Label"]=1]="Label"})(h||(h={}));var he=function(e){function t(t,i){var n=e.call(this,i,t)||this;if(n.validated=[],n.errorRules=[],n.allowSubmit=!1,n.required="required",n.infoElement=null,n.inputElement=null,n.selectQuery="input:not([type=reset]):not([type=button]), select, textarea",n.localyMessage={},n.defaultMessages={required:"This field is required.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",date:"Please enter a valid date.",dateIso:"Please enter a valid date ( ISO ).",creditcard:"Please enter valid card number",number:"Please enter a valid number.",digits:"Please enter only digits.",maxLength:"Please enter no more than {0} characters.",minLength:"Please enter at least {0} characters.",rangeLength:"Please enter a value between {0} and {1} characters long.",range:"Please enter a value between {0} and {1}.",max:"Please enter a value less than or equal to {0}.",min:"Please enter a value greater than or equal to {0}.",regex:"Please enter a correct value.",tel:"Please enter a valid phone number.",pattern:"Please enter a correct pattern value.",equalTo:"Please enter the valid match text"},"undefined"===typeof n.rules&&(n.rules={}),n.l10n=new w["o"]("formValidator",n.defaultMessages,n.locale),n.locale&&n.localeFunc(),w["bb"].on("notifyExternalChange",n.afterLocalization,n),t="string"===typeof t?Object(w["jb"])(t,document):t,null!=n.element)return n.element.setAttribute("novalidate",""),n.inputElements=Object(w["kb"])(n.selectQuery,n.element),n.createHTML5Rules(),n.wireEvents(),n}var i;return le(t,e),i=t,t.prototype.addRules=function(e,t){e&&(this.rules.hasOwnProperty(e)?Object(w["G"])(this.rules[e],t,{}):this.rules[e]=t)},t.prototype.removeRules=function(e,t){if(e||t)if(this.rules[e]&&!t)delete this.rules[e];else{if(Object(w["T"])(this.rules[e]&&t))return;for(var i=0;i<t.length;i++)delete this.rules[e][t[i]]}else this.rules={}},t.prototype.validate=function(e){var t=Object.keys(this.rules);if(e&&t.length)return this.validateRules(e),-1!==t.indexOf(e)&&0===this.errorRules.filter(function(t){return t.name===e}).length;this.errorRules=[];for(var i=0,n=t;i<n.length;i++){var r=n[i];this.validateRules(r)}return 0===this.errorRules.length},t.prototype.reset=function(){this.element.reset(),this.clearForm()},t.prototype.getInputElement=function(e){return this.inputElement=Object(w["jb"])('[name="'+e+'"]',this.element),this.inputElement},t.prototype.destroy=function(){this.reset(),this.unwireEvents(),this.rules={};for(var t=Object(w["kb"])("."+this.errorClass+", ."+this.validClass,this.element),i=0,n=t;i<n.length;i++){var r=n[i];Object(w["F"])(r)}e.prototype.destroy.call(this),w["bb"].off("notifyExternalChange",this.afterLocalization)},t.prototype.onPropertyChanged=function(e,t){for(var i=0,n=Object.keys(e);i<n.length;i++){var r=n[i];switch(r){case"locale":this.localeFunc();break}}},t.prototype.localeFunc=function(){for(var e=0,t=Object.keys(this.defaultMessages);e<t.length;e++){var i=t[e];this.l10n.setLocale(this.locale);var n=this.l10n.getConstant(i);this.localyMessage[i]=n}},t.prototype.getModuleName=function(){return"formValidator"},t.prototype.afterLocalization=function(e){this.locale=e.locale,this.localeFunc()},t.prototype.refresh=function(){this.unwireEvents(),this.inputElements=Object(w["kb"])(this.selectQuery,this.element),this.wireEvents()},t.prototype.clearForm=function(){this.errorRules=[],this.validated=[];for(var e=Object(w["kb"])(this.selectQuery,this.element),t=0,i=e;t<i.length;t++){var n=i[t],r=n;r.removeAttribute("aria-invalid"),r.classList.remove(this.errorClass),r.name.length>0&&(this.getInputElement(r.name),this.getErrorElement(r.name),this.hideMessage(r.name)),r.classList.remove(this.validClass)}},t.prototype.createHTML5Rules=function(){for(var e=["required","validateHidden","regex","rangeLength","maxLength","minLength","dateIso","digits","pattern","data-val-required","type","data-validation","min","max","range","equalTo","data-val-minlength-min","data-val-equalto-other","data-val-maxlength-max","data-val-range-min","data-val-regex-pattern","data-val-length-max","data-val-creditcard","data-val-phone"],t=["hidden","email","url","date","number","tel"],i=0,n=this.inputElements;i<n.length;i++){for(var r=n[i],s={},a=0,o=e;a<o.length;a++){var l=o[a];if(null!==r.getAttribute(l))switch(l){case"required":this.defRule(r,s,l,r.required);break;case"data-validation":l=r.getAttribute(l),this.defRule(r,s,l,!0);break;case"type":-1!==t.indexOf(r.type)&&this.defRule(r,s,r.type,!0);break;case"rangeLength":case"range":this.defRule(r,s,l,JSON.parse(r.getAttribute(l)));break;case"equalTo":var d=r.getAttribute(l);this.defRule(r,s,l,d);break;default:"true"===r.getAttribute("data-val")?this.annotationRule(r,s,l,r.getAttribute(l)):this.defRule(r,s,l,r.getAttribute(l))}}0!==Object.keys(s).length&&this.addRules(r.name,s)}},t.prototype.annotationRule=function(e,t,i,n){var r=i.split("-"),s=["required","creditcard","phone","maxlength","minlength","range","regex","equalto"],a=r[r.length-1],o=r[r.length-2];if(-1!==s.indexOf(a))switch(a){case"required":this.defRule(e,t,"required",n);break;case"creditcard":this.defRule(e,t,"creditcard",n);break;case"phone":this.defRule(e,t,"tel",n);break}else if(-1!==s.indexOf(o))switch(o){case"maxlength":this.defRule(e,t,"maxLength",n);break;case"minlength":this.defRule(e,t,"minLength",n);break;case"range":var l=e.getAttribute("data-val-range-min"),d=e.getAttribute("data-val-range-max");this.defRule(e,t,"range",[l,d]);break;case"equalto":var c=e.getAttribute(i).split(".");this.defRule(e,t,"equalTo",c[c.length-1]);break;case"regex":this.defRule(e,t,"regex",n);break}},t.prototype.defRule=function(e,t,i,n){var r,s=e.getAttribute("data-"+i+"-message"),a=e.getAttribute("data-val-"+i);this.rules[e.name]&&"validateHidden"!==i&&"hidden"!==i&&(this.getInputElement(e.name),r=this.getErrorMessage(this.rules[e.name][i],i)),s?n=[n,s]:a?n=[n,a]:r&&(n=[n,r]),t[i]=n},t.prototype.wireEvents=function(){for(var e=0,t=this.inputElements;e<t.length;e++){var n=t[e];i.isCheckable(n)?w["l"].add(n,"click",this.clickHandler,this):"SELECT"===n.tagName?w["l"].add(n,"change",this.changeHandler,this):(w["l"].add(n,"focusout",this.focusOutHandler,this),w["l"].add(n,"keyup",this.keyUpHandler,this))}w["l"].add(this.element,"submit",this.submitHandler,this),w["l"].add(this.element,"reset",this.resetHandler,this)},t.prototype.unwireEvents=function(){for(var e=0,t=this.inputElements;e<t.length;e++){var i=t[e];w["l"].clearEvents(i)}w["l"].remove(this.element,"submit",this.submitHandler),w["l"].remove(this.element,"reset",this.resetHandler)},t.prototype.focusOutHandler=function(e){this.trigger("focusout",e);var t=e.target;this.rules[t.name]&&(this.rules[t.name][this.required]||t.value.length>0?this.validate(t.name):-1===this.validated.indexOf(t.name)&&this.validated.push(t.name))},t.prototype.keyUpHandler=function(e){this.trigger("keyup",e);var t=e.target,i=[16,17,18,20,35,36,37,38,39,40,45,144,225];(9!==e.which||this.rules[t.name]&&(!this.rules[t.name]||this.rules[t.name][this.required]))&&-1!==this.validated.indexOf(t.name)&&this.rules[t.name]&&-1===i.indexOf(e.which)&&this.validate(t.name)},t.prototype.clickHandler=function(e){this.trigger("click",e);var t=e.target;"submit"!==t.type?this.validate(t.name):null!==t.getAttribute("formnovalidate")&&(this.allowSubmit=!0)},t.prototype.changeHandler=function(e){this.trigger("change",e);var t=e.target;this.validate(t.name)},t.prototype.submitHandler=function(e){this.trigger("submit",e),this.allowSubmit||this.validate()?this.allowSubmit=!1:e.preventDefault()},t.prototype.resetHandler=function(){this.clearForm()},t.prototype.validateRules=function(e){if(this.rules[e]){var t=Object.keys(this.rules[e]),i=!1,n=!1,r=t.indexOf("validateHidden"),s=t.indexOf("hidden");if(this.getInputElement(e),-1!==s&&(i=!0),-1!==r&&(n=!0),!i||i&&n){-1!==r&&t.splice(r,1),-1!==s&&t.splice(s-1,1),this.getErrorElement(e);for(var a=0,o=t;a<o.length;a++){var l=o[a],d=this.getErrorMessage(this.rules[e][l],l),c={name:e,message:d},h={inputName:e,element:this.inputElement,message:d};if(!this.isValid(e,l)&&!this.inputElement.classList.contains(this.ignore)){this.removeErrorRules(e),this.errorRules.push(c),this.inputElement.setAttribute("aria-invalid","true"),this.inputElement.setAttribute("aria-describedby",this.inputElement.id+"-info"),this.inputElement.classList.add(this.errorClass),this.inputElement.classList.remove(this.validClass),this.infoElement?this.showMessage(c):this.createErrorElement(e,c.message,this.inputElement),h.errorElement=this.infoElement,h.status="failure",this.inputElement.classList.add(this.errorClass),this.inputElement.classList.remove(this.validClass),this.optionalValidationStatus(e,h),this.trigger("validationComplete",h),"required"===l&&this.inputElement.setAttribute("aria-required","true");break}this.hideMessage(e),h.status="success",this.trigger("validationComplete",h)}}}},t.prototype.optionalValidationStatus=function(e,t){this.rules[e][this.required]||this.inputElement.value.length||Object(w["T"])(this.infoElement)||(this.infoElement.innerHTML=this.inputElement.value,this.infoElement.setAttribute("aria-invalid","false"),t.status="",this.hideMessage(e))},t.prototype.isValid=function(e,t){var n=this.rules[e][t],r=n instanceof Array&&"string"===typeof n[1]?n[0]:n,s=this.rules[e][t],a={value:this.inputElement.value,param:r,element:this.inputElement,formElement:this.element};if(this.trigger("validationBegin",a),!a.param&&"required"===t)return!0;if(s&&"function"===typeof s[0]){var o=s[0];return o.call(this,{element:this.inputElement,value:this.inputElement.value})}return i.isCheckable(this.inputElement)?"required"!==t||Object(w["kb"])('input[name="'+e+'"]:checked',this.element).length>0:i.checkValidator[t](a)},t.prototype.getErrorMessage=function(e,t){var i=this.inputElement.getAttribute("data-"+t+"-message")?this.inputElement.getAttribute("data-"+t+"-message"):e instanceof Array&&"string"===typeof e[1]?e[1]:0!==Object.keys(this.localyMessage).length?this.localyMessage[t]:this.defaultMessages[t],n=i.match(/{(\d)}/g);if(!Object(w["T"])(n))for(var r=0;r<n.length;r++){var s=e instanceof Array?e[r]:e;i=i.replace(n[r],s)}return i},t.prototype.createErrorElement=function(e,t,i){var n=Object(w["C"])(this.errorElement,{className:this.errorClass,innerHTML:t,attrs:{for:e}});if(this.errorOption===h.Message&&(n.classList.remove(this.errorClass),n.classList.add("e-message"),n=Object(w["C"])(this.errorContainer,{className:this.errorClass,innerHTML:n.outerHTML})),n.id=this.inputElement.name+"-info",this.element.querySelector('[data-valmsg-for="'+i.id+'"]'))this.element.querySelector('[data-valmsg-for="'+i.id+'"]').appendChild(n);else if(!0===i.hasAttribute("data-msg-containerid")){var r=i.getAttribute("data-msg-containerid"),s=Object(w["jb"])("#"+r,this.element);s.appendChild(n)}else null!=this.customPlacement?this.customPlacement.call(this,this.inputElement,n):this.inputElement.parentNode.insertBefore(n,this.inputElement.nextSibling);n.style.display="block",this.getErrorElement(e),this.validated.push(e),this.checkRequired(e)},t.prototype.getErrorElement=function(e){return this.infoElement=Object(w["jb"])(this.errorElement+"."+this.errorClass,this.inputElement.parentElement),this.infoElement||(this.infoElement=Object(w["jb"])(this.errorElement+"."+this.errorClass+'[for="'+e+'"]',this.element)),this.infoElement},t.prototype.removeErrorRules=function(e){for(var t=0;t<this.errorRules.length;t++){var i=this.errorRules[t];i.name===e&&this.errorRules.splice(t,1)}},t.prototype.showMessage=function(e){this.infoElement.style.display="block",this.infoElement.innerHTML=e.message,this.checkRequired(e.name)},t.prototype.hideMessage=function(e){this.infoElement&&(this.infoElement.style.display="none",this.removeErrorRules(e),this.inputElement.classList.add(this.validClass),this.inputElement.classList.remove(this.errorClass),this.inputElement.setAttribute("aria-invalid","false"))},t.prototype.checkRequired=function(e){this.rules[e][this.required]||this.inputElement.value.length||Object(w["T"])(this.infoElement)||(this.infoElement.innerHTML=this.inputElement.value,this.infoElement.setAttribute("aria-invalid","false"),this.hideMessage(e))},t.isCheckable=function(e){var t=e.getAttribute("type");return t&&("checkbox"===t||"radio"===t||"submit"===t)},t.checkValidator={required:function(e){return isNaN(Date.parse(e.value))?e.value.toString().length>0:!isNaN(new Date(e.value).getTime())},email:function(e){return ce.EMAIL.test(e.value)},url:function(e){return ce.URL.test(e.value)},dateIso:function(e){return ce.DATE_ISO.test(e.value)},tel:function(e){return ce.PHONE.test(e.value)},creditcard:function(e){return ce.CREDITCARD.test(e.value)},number:function(e){return!isNaN(Number(e.value))&&-1===e.value.indexOf(" ")},digits:function(e){return ce.DIGITS.test(e.value)},maxLength:function(e){return e.value.length<=e.param},minLength:function(e){return e.value.length>=e.param},rangeLength:function(e){var t=e.param;return e.value.length>=t[0]&&e.value.length<=t[1]},range:function(e){var t=e.param;return!isNaN(Number(e.value))&&Number(e.value)>=t[0]&&Number(e.value)<=t[1]},date:function(e){return!isNaN(new Date(e.value).getTime())},max:function(e){return isNaN(Number(e.value))?new Date(e.value).getTime()<=new Date(JSON.parse(JSON.stringify(e.param))).getTime():+e.value<=e.param},min:function(e){if(isNaN(Number(e.value))){if(-1!==e.value.indexOf(",")){var t=e.value.replace(/,/g,"");return parseFloat(t)>=e.param}return new Date(e.value).getTime()>=new Date(JSON.parse(JSON.stringify(e.param))).getTime()}return+e.value>=e.param},regex:function(e){return new RegExp(e.param).test(e.value)},equalTo:function(e){var t=e.formElement.querySelector("#"+e.param);return e.param=t.value,e.param===e.value}},de([Object(w["r"])("")],t.prototype,"locale",void 0),de([Object(w["r"])("e-hidden")],t.prototype,"ignore",void 0),de([Object(w["r"])()],t.prototype,"rules",void 0),de([Object(w["r"])("e-error")],t.prototype,"errorClass",void 0),de([Object(w["r"])("e-valid")],t.prototype,"validClass",void 0),de([Object(w["r"])("label")],t.prototype,"errorElement",void 0),de([Object(w["r"])("div")],t.prototype,"errorContainer",void 0),de([Object(w["r"])(h.Label)],t.prototype,"errorOption",void 0),de([Object(w["k"])()],t.prototype,"focusout",void 0),de([Object(w["k"])()],t.prototype,"keyup",void 0),de([Object(w["k"])()],t.prototype,"click",void 0),de([Object(w["k"])()],t.prototype,"change",void 0),de([Object(w["k"])()],t.prototype,"submit",void 0),de([Object(w["k"])()],t.prototype,"validationBegin",void 0),de([Object(w["k"])()],t.prototype,"validationComplete",void 0),de([Object(w["k"])()],t.prototype,"customPlacement",void 0),t=i=de([w["p"]],t),t}(w["c"]),pe=i("0a060"),ue=i("7338"),me=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ge=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return me(t,e),t.prototype.write=function(e){this.edit=this.parent.editModule,"datepickeredit"===e.column.editType?this.obj=new pe["a"](Object(w["G"])(fe(e,this.parent.editSettings.mode,this.parent.enableRtl,this.parent.cssClass,this),e.column.edit.params)):"datetimepickeredit"===e.column.editType&&(this.obj=new ue["a"](Object(w["G"])(fe(e,this.parent.editSettings.mode,this.parent.enableRtl,this.parent.cssClass,this),e.column.edit.params))),this.obj.appendTo(e.element)},t}(q);function fe(e,t,i,n,r){var s="Dialog"!==t,a=Object(j["C"])(e.column.format,e.column.type),o=Object(j["N"])(e.column.field,e.rowData);return o=o?new Date(o):null,{floatLabelType:s?"Never":"Always",value:o,format:a,placeholder:s?"":e.column.headerText,enableRtl:i,enabled:Object(j["ab"])(e.column,e.requestType,e.element),cssClass:n||null,close:be.bind(r)}}function be(e){"escape"===e.event.action&&(this.edit.editCellDialogClose=!0)}var ve,ye,Ce,we=i("6bba"),Oe=function(){function e(e){this.parent=e}return e.prototype.read=function(e,t){return t},e.prototype.write=function(){},e.prototype.destroy=function(){},e}(),Te=function(){function e(e,t){this.editType={Inline:te,Normal:te,Batch:se,Dialog:oe},this.editCellDialogClose=!1,this.parent=e,this.serviceLocator=t,this.l10n=this.serviceLocator.getService("localization"),this.addEventListener(),this.updateEditObj(),this.createAlertDlg(),this.createConfirmDlg()}return e.prototype.updateColTypeObj=function(){for(var t=this.parent.columnModel,i=0;i<t.length;i++)if(this.parent.editSettings.template||t[i].editTemplate){var n="templateedit";t[i].edit=Object(w["G"])(new e.editCellType[n](this.parent),t[i].edit||{})}else t[i].edit=Object(w["G"])(new e.editCellType[t[i].editType&&e.editCellType[t[i].editType]?t[i].editType:"defaultedit"](this.parent,this.serviceLocator),t[i].edit||{});this.parent.log("primary_column_missing")},e.prototype.getModuleName=function(){return"edit"},e.prototype.onPropertyChanged=function(e){if(e.module===this.getModuleName())for(var t=this.parent,i=0,n=Object.keys(e.properties);i<n.length;i++){var r=n[i];switch(r){case"allowAdding":case"allowDeleting":case"allowEditing":(t.editSettings.allowAdding||t.editSettings.allowEditing||t.editSettings.allowDeleting)&&this.initialEnd();break;case"mode":this.updateEditObj(),t.isEdit=!1,t.refresh();break}}},e.prototype.updateEditObj=function(){this.editModule&&this.editModule.destroy(),this.renderer=new H(this.parent,this.serviceLocator),this.editModule=new this.editType[this.parent.editSettings.mode](this.parent,this.serviceLocator,this.renderer)},e.prototype.initialEnd=function(){this.updateColTypeObj()},e.prototype.startEdit=function(e){var t=this.parent;if(t.editSettings.allowEditing&&!t.isEdit&&"Batch"!==t.editSettings.mode){if(this.parent.element.classList.add("e-editing"),t.getSelectedRows().length)e||(e=t.getSelectedRows()[0]);else if(!e)return void this.showDialog("EditOperationAlert",this.alertDObj);this.isLastRow=e.rowIndex===this.parent.getContent().querySelector("tr:last-child").rowIndex,"none"!==e.style.display&&(this.editModule.startEdit(e),this.refreshToolbar(),t.element.querySelector(".e-gridpopup").style.display="none",this.parent.notify("start-edit",{}))}},e.prototype.checkLastRow=function(e,t){var i=this.isLastRow;"auto"!==this.parent.height&&"Bottom"===this.parent.editSettings.newRowPosition&&t&&"add"===t.requestType&&this.parent.getContent().firstElementChild.offsetHeight>this.parent.getContentTable().scrollHeight?Object(w["u"])([].slice.call(e.getElementsByClassName(x["B"])),"e-lastrowadded"):i&&e&&e.classList&&Object(w["u"])([].slice.call(e.getElementsByClassName(x["B"])),"e-lastrowcell")},e.prototype.closeEdit=function(){"Batch"===this.parent.editSettings.mode&&this.parent.editSettings.showConfirmDialog&&this.parent.element.getElementsByClassName("e-updatedtd").length?this.showDialog("CancelEdit",this.dialogObj):(this.parent.element.classList.remove("e-editing"),this.editModule.closeEdit(),this.refreshToolbar(),this.parent.notify(I["ab"],{}))},e.prototype.refreshToolbar=function(){this.parent.notify(I["oe"],{})},e.prototype.addRecord=function(e,t){if(this.parent.editSettings.allowAdding){var i={startEdit:!0};e||this.parent.notify(I["we"],i),i.startEdit&&(this.parent.element.classList.add("e-editing"),this.editModule.addRecord(e,t),this.refreshToolbar(),this.parent.notify("start-add",{}))}},e.prototype.deleteRecord=function(e,t){var i=this.parent;i.editSettings.allowDeleting&&(t||i.getSelectedRecords().length||!Object(w["T"])(i.commandDelIndex)?i.editSettings.showDeleteConfirmDialog?this.showDialog("ConfirmDelete",this.dialogObj):this.editModule.deleteRecord(e,t):this.showDialog("DeleteOperationAlert",this.alertDObj))},e.prototype.deleteRow=function(e){this.deleteRowUid=e.getAttribute("data-uid");var t=this.parent.getRowObjectFromUID(this.deleteRowUid);Object(w["T"])(t)||this.deleteRecord(null,t.data)},e.prototype.endEdit=function(){"Batch"===this.parent.editSettings.mode&&this.parent.editSettings.showConfirmDialog&&(Object(w["T"])(this.formObj)||this.formObj.validate())&&(this.parent.editModule.saveCell(),this.parent.notify(I["Ob"],{}),Object(w["T"])(this.formObj)||this.formObj.validate())?this.showDialog("BatchSaveConfirm",this.dialogObj):this.endEditing()},e.prototype.updateCell=function(e,t,i){this.editModule.updateCell(e,t,i)},e.prototype.updateRow=function(e,t){this.editModule.updateRow(e,t)},e.prototype.batchCancel=function(){this.closeEdit()},e.prototype.batchSave=function(){this.endEdit()},e.prototype.editCell=function(e,t){this.editModule.editCell(e,t)},e.prototype.editFormValidate=function(){var e=!this.formObj||this.formObj.validate(),t=!this.mFormObj||this.mFormObj.validate(),i=!this.frFormObj||this.frFormObj.validate();return e&&t&&i},e.prototype.getBatchChanges=function(){return this.editModule.getBatchChanges?this.editModule.getBatchChanges():{}},e.prototype.getCurrentEditCellData=function(){var e=this.getCurrentEditedData(this.formObj.element,{});return e[Object.keys(e)[0]]},e.prototype.saveCell=function(){this.editModule.saveCell()},e.prototype.endEditing=function(){this.parent.element.classList.remove("e-editing"),this.editModule.endEdit(),this.refreshToolbar()},e.prototype.showDialog=function(e,t){t.content="<div>"+this.l10n.getConstant(e)+"</div>",t.dataBind(),t.show()},e.prototype.getValueFromType=function(e,t){var i=t;switch(e.type){case"number":i=isNaN(parseFloat(t))?null:parseFloat(t);break;case"boolean":"booleanedit"!==e.editType&&(i=t===this.l10n.getConstant("True")||!0===t);break;case"date":case"datetime":"datepickeredit"!==e.editType&&"datetimepickeredit"!==e.editType&&t&&t.length?i=new Date(t):""===t&&(i=null);break}return i},e.prototype.destroyToolTip=function(){for(var e=[].slice.call(this.parent.element.getElementsByClassName("e-griderror")),t=0,i=e;t<i.length;t++){var n=i[t];Object(w["fb"])(n)}this.parent.getContent().firstElementChild.style.position="relative"},e.prototype.createConfirmDlg=function(){this.dialogObj=this.dlgWidget([{click:this.dlgOk.bind(this),buttonModel:{content:this.l10n.getConstant("OKButton"),cssClass:this.parent.cssClass?"e-primary "+this.parent.cssClass:"e-primary",isPrimary:!0}},{click:this.dlgCancel.bind(this),buttonModel:{cssClass:this.parent.cssClass?"e-flat "+this.parent.cssClass:"e-flat",content:this.l10n.getConstant("CancelButton")}}],"EditConfirm")},e.prototype.createAlertDlg=function(){this.alertDObj=this.dlgWidget([{click:this.alertClick.bind(this),buttonModel:{content:this.l10n.getConstant("OKButton"),cssClass:this.parent.cssClass?"e-flat "+this.parent.cssClass:"e-flat",isPrimary:!0}}],"EditAlert")},e.prototype.alertClick=function(){this.alertDObj.hide()},e.prototype.dlgWidget=function(e,t){var i=this.parent.createElement("div",{id:this.parent.element.id+t});this.parent.element.appendChild(i);var n={showCloseIcon:!1,isModal:!0,visible:!1,closeOnEscape:!0,target:this.parent.element,width:"320px",animationSettings:{effect:"None"},cssClass:this.parent.cssClass?this.parent.cssClass:""};n.buttons=e;var r=new L["a"](n),s="isStringTemplate";return r[s]=!0,r.appendTo(i),r},e.prototype.dlgCancel=function(){this.parent.focusModule.clearIndicator(),this.parent.focusModule.restoreFocus(),this.dialogObj.hide()},e.prototype.dlgOk=function(){switch(this.dialogObj.element.querySelector(".e-dlg-content").firstElementChild.innerText){case this.l10n.getConstant("ConfirmDelete"):this.editModule.deleteRecord();break;case this.l10n.getConstant("CancelEdit"):this.editModule.closeEdit();break;case this.l10n.getConstant("BatchSaveConfirm"):this.endEditing();break;case this.l10n.getConstant("BatchSaveLostChanges"):"Batch"===this.parent.editSettings.mode&&this.editModule.addCancelWhilePaging(),this.executeAction();break}this.dlgCancel()},e.prototype.destroyEditComponents=function(){this.parent.isEdit&&(this.destroyWidgets(),this.destroyForm()),this.destroy()},e.prototype.addEventListener=function(){this.parent.isDestroyed||(this.eventDetails=[{event:I["Bc"],handler:this.onPropertyChanged},{event:I["Ic"],handler:this.initialEnd},{event:I["Kc"],handler:this.keyPressHandler},{event:I["g"],handler:this.updateColTypeObj},{event:I["pe"],handler:this.destroyToolTip},{event:I["Yc"],handler:this.preventBatch},{event:I["Jb"],handler:this.destroyForm},{event:I["Hb"],handler:this.destroyEditComponents}],Object(j["d"])(this.parent,this.eventDetails,!0,this),this.actionBeginFunction=this.onActionBegin.bind(this),this.actionCompleteFunction=this.actionComplete.bind(this),this.parent.addEventListener(I["a"],this.actionBeginFunction),this.parent.addEventListener(I["b"],this.actionCompleteFunction))},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(Object(j["d"])(this.parent,this.eventDetails,!1),this.parent.removeEventListener(I["b"],this.actionCompleteFunction),this.parent.removeEventListener(I["a"],this.actionBeginFunction))},e.prototype.actionComplete=function(e){var t=["add","beginEdit","save","delete","cancel"];t.indexOf(e.requestType)<0&&(this.parent.isEdit=!1),"batchsave"===e.requestType&&this.parent.focusModule.restoreFocus(),this.refreshToolbar()},e.prototype.getCurrentEditedData=function(e,t){var i=this.parent;if(i.editSettings.template){for(var n=[].slice.call(e.elements),r=0;r<n.length;r++)if((n[r].hasAttribute("name")&&"e-multi-hidden"!==n[r].className||n[r].classList.contains("e-multiselect"))&&("hidden"!==n[r].type||!Object(j["hb"])(n[r],"e-switch-wrapper")&&!Object(j["hb"])(n[r],"e-checkbox-wrapper"))){var s=n[r].hasAttribute("name")?Object(j["ub"])(n[r].getAttribute("name")):Object(j["ub"])(n[r].getAttribute("id")),a=i.getColumnByField(s)||{field:s,type:n[r].getAttribute("type")},o=void 0;"checkbox"===a.type||"boolean"===a.type?o=n[r].checked:n[r].value?(o=n[r].value,n[r].ej2_instances&&n[r].ej2_instances.length&&!Object(w["T"])(n[r].ej2_instances[0].value)&&(n[r].blur(),o=n[r].ej2_instances[0].value)):n[r].ej2_instances&&(o=n[r].ej2_instances[0].value),a.edit&&"string"===typeof a.edit.read?o=Object(w["R"])(a.edit.read,window)(n[r],o):a.edit&&a.edit.read&&(o=a.edit.read(n[r],o)),o=i.editModule.getValueFromType(a,o),"radio"===n[r].type?n[r].checked&&S["a"].setValue(a.field,o,t):S["a"].setValue(a.field,o,t)}return t}for(var l=i.columnModel.filter(function(e){return e.editTemplate}),d=0;d<l.length;d++)if(e[Object(j["B"])(l[d].field)]){var c=[].slice.call(e[Object(j["B"])(l[d].field)]);c=c.length?c:[e[Object(j["B"])(l[d].field)]];var h=c.filter(function(e){return!Object(w["T"])(e.ej2_instances)});0===h.length&&(h=c.filter(function(e){return e.hasAttribute("name")}));for(r=0;r<h.length;r++){o=this.getValue(l[d],h[r],t);S["a"].setValue(l[d].field,o,t)}}for(var p=[].slice.call(e.getElementsByClassName("e-field")),u=0,m=p.length;u<m;u++){var g=i.getColumnByUid(p[u].getAttribute("e-mappinguid"));if(g&&g.field){o=this.getValue(g,p[u],t);S["a"].setValue(g.field,o,t)}}return t},e.prototype.getValue=function(e,t,i){var n=t.ej2_instances?t.ej2_instances[0].value:t.value,r=this.parent,s=e.edit.read;return"checkbox"!==e.type&&"boolean"!==e.type||(n=t.checked),"string"===typeof s?(s=Object(w["R"])(s,window),n=r.editModule.getValueFromType(e,s(t,n))):n=r.editModule.getValueFromType(e,e.edit.read(t,n)),Object(w["T"])(i[e.field])&&""===n&&(n=i[e.field]),n},e.prototype.onActionBegin=function(e){if("columnstate"===e.requestType&&this.parent.isEdit&&"Batch"!==this.parent.editSettings.mode)this.closeEdit();else{var t=this.parent.element.querySelector("."+x["l"]),i=this.parent.element.querySelector("."+x["b"]);if(t&&this.parent.frozenRows&&"virtualscroll"===e.requestType&&parseInt(Object(j["hb"])(t,x["A"]).getAttribute(x["d"]),10)<this.parent.frozenRows)return;var n=["filterafteropen","filterbeforeopen","filterchoicerequest","save","infiniteScroll","virtualscroll"],r=-1===n.indexOf(e.requestType),s=this.parent.enableVirtualization&&this.formObj&&!this.formObj.isDestroyed&&(t||i||"cancel"===e.requestType)&&r;(!this.parent.enableVirtualization&&"Batch"!==this.parent.editSettings.mode&&this.formObj&&!this.formObj.isDestroyed&&r&&!e.cancel||s)&&(this.destroyWidgets(),this.destroyForm())}},e.prototype.destroyWidgets=function(e){var t=this.parent;t.editSettings.template&&(this.parent.destroyTemplate(["editSettingsTemplate"]),this.parent.isReact&&this.parent.renderTemplates()),e=e||this.parent.getCurrentVisibleColumns(this.parent.enableColumnVirtualization),e.some(function(e){return!Object(w["T"])(e.editTemplate)})&&(this.parent.destroyTemplate(["editTemplate"]),this.parent.isReact&&this.parent.renderTemplates());for(var i=0,n=e;i<n.length;i++){var r=n[i],s=r.edit.destroy;r.edit.destroy&&("string"===typeof s?(s=Object(w["R"])(s,window),s()):r.edit.destroy())}for(var a=[].slice.call(this.formObj.element.elements),o=0;o<a.length;o++)a[o].hasAttribute("name")&&a[o].ej2_instances&&a[o].ej2_instances.length&&!a[o].ej2_instances[0].isDestroyed&&a[o].ej2_instances[0].destroy()},e.prototype.destroyForm=function(){this.destroyToolTip();for(var e=[this.formObj,this.mFormObj,this.frFormObj,this.virtualFormObj],t=0;t<e.length;t++)e[t]&&e[t].element&&!e[t].isDestroyed&&e[t].destroy();this.destroyToolTip()},e.prototype.destroy=function(){var e=this.parent.element;if(e){var t=!(!e.querySelector("."+x["u"])||!e.querySelector("."+x["s"]));t&&this.destroyForm(),this.removeEventListener();var i=this.dialogObj.element;i.childElementCount>0&&(this.dialogObj.destroy(),Object(w["fb"])(i)),i=this.alertDObj.element,i.childElementCount>0&&(this.alertDObj.destroy(),Object(w["fb"])(i)),t&&this.editModule&&this.editModule.destroy()}},e.prototype.keyPressHandler=function(e){switch(e.action){case"insert":this.addRecord();break;case"delete":"INPUT"===e.target.tagName&&!e.target.classList.contains("e-checkselect")||document.querySelector(".e-popup-open.e-edit-dialog")||this.deleteRecord();break;case"f2":this.startEdit();break;case"enter":Object(j["hb"])(e.target,"e-unboundcelldiv")||"Batch"===this.parent.editSettings.mode||!(Object(j["hb"])(e.target,x["s"])||this.parent.frozenRows&&Object(j["hb"])(e.target,x["v"]))||document.getElementsByClassName("e-popup-open").length||(e.preventDefault(),this.endEdit());break;case"escape":this.parent.isEdit&&!this.editCellDialogClose&&("Batch"===this.parent.editSettings.mode?this.editModule.escapeCellEdit():this.curretRowFocus(e)),this.editCellDialogClose&&(this.editCellDialogClose=!1);break;case"tab":case"shiftTab":this.curretRowFocus(e);break}},e.prototype.curretRowFocus=function(e){if(this.parent.isEdit&&"Batch"!==this.parent.editSettings.mode){var t=Object(j["hb"])(e.target,"e-editedrow")||Object(j["hb"])(e.target,"e-addedrow");if(t){var i=t.classList.contains("e-addedrow")?"e-addedrow":"e-editedrow",n=[].slice.call(t.querySelectorAll(".e-input:not(.e-disabled)")),r=[].slice.call(t.querySelectorAll(".e-unboundcell"));if(r)for(var s=0;s<r.length;s++)n=n.concat([].slice.call(r[s].querySelectorAll(".e-btn:not(.e-hide)")));if(this.parent.isFrozenGrid())if(Object(w["T"])(this.parent.frozenRows)||Object(w["T"])(Object(j["hb"])(e.target,"e-frozenheader"))&&Object(w["T"])(Object(j["hb"])(e.target,"e-movableheader"))){var a=this.parent.getContent().querySelector(".e-movablecontent ."+i);if(n.push.apply(n,[].slice.call(a.querySelectorAll(".e-input:not(.e-disabled)"))),"Left-Right"===this.parent.getFrozenMode()||"Right"===this.parent.getFrozenMode()){var o=this.parent.getContent().querySelector(".e-frozen-right-content ."+i);n.push.apply(n,[].slice.call(o.querySelectorAll(".e-input:not(.e-disabled)")))}}else{var l=this.parent.getHeaderContent().querySelector(".e-movableheader ."+i);if(n.push.apply(n,[].slice.call(l.querySelectorAll(".e-input:not(.e-disabled)"))),"Left-Right"===this.parent.getFrozenMode()||"Right"===this.parent.getFrozenMode()){var d=this.parent.getHeaderContent().querySelector(".e-frozen-right-header ."+i);n.push.apply(n,[].slice.call(d.querySelectorAll(".e-input:not(.e-disabled)")))}}var c=Object(j["hb"])(e.target,"e-rowcell");if(c===Object(j["hb"])(n[n.length-1],"e-rowcell")&&"tab"===e.action&&!c.classList.contains("e-unboundcell")||c===Object(j["hb"])(n[0],"e-rowcell")&&"shiftTab"===e.action||"escape"===e.action){var h=t.getAttribute("data-uid"),p=this.parent.getRows();"Left-Right"!==this.parent.getFrozenMode()&&"Right"!==this.parent.getFrozenMode()||(p=this.parent.getFrozenRightRows()),(this.parent.getFrozenColumns()||"Left"===this.parent.getFrozenMode())&&(p=this.parent.getMovableRows());var u=p.map(function(e){return e.getAttribute("data-uid")}).indexOf(h);this.parent.frozenRows&&Object(j["hb"])(t,"e-content")&&(u-=this.parent.frozenRows),t.classList.contains("e-addedrow")&&(u=0),"escape"===e.action?this.closeEdit():this.endEdit(),this.parent.focusModule.active&&(this.parent.focusModule.active.matrix.current=[u,0])}}}},e.prototype.preventBatch=function(e){this.preventObj=e,this.showDialog("BatchSaveLostChanges",this.dialogObj)},e.prototype.executeAction=function(){this.preventObj.handler.call(this.preventObj.instance,this.preventObj.arg1,this.preventObj.arg2,this.preventObj.arg3,this.preventObj.arg4,this.preventObj.arg5,this.preventObj.arg6,this.preventObj.arg7,this.preventObj.arg8)},e.prototype.applyFormValidation=function(e){var t=this.parent,i=t.isFrozenGrid(),n="Normal"===this.parent.editSettings.mode,r="Right"===this.parent.getFrozenMode()&&n?1:0,s="Dialog"!==this.parent.editSettings.mode?t.element.getElementsByClassName("e-gridform")[r]:Object(w["jb"])("#"+t.element.id+"_dialogEdit_wrapper .e-gridform",document),a="Right"===this.parent.getFrozenMode()&&n?0:1,o=t.element.getElementsByClassName("e-gridform")[a],l={},d={},c={};e=e||t.getColumns();for(var h=0;h<e.length;h++)(e[h].visible||"Dialog"===t.editSettings.mode&&(-1!==t.groupSettings.columns.indexOf(e[h].field)||"Dialog"!==t.editSettings.mode))&&e[h].validationRules&&Object(j["Bb"])(e[h],a,l,d,c,e.length);if(i&&"Dialog"!==this.parent.editSettings.mode){if(this.parent.editModule.mFormObj=this.createFormObj(o,d),this.parent.getFrozenMode()===x["w"]){var p=t.element.getElementsByClassName("e-gridform")[2];this.parent.editModule.frFormObj=this.createFormObj(p,c)}}else l=Object(w["G"])(l,d,c);this.parent.editModule.formObj=this.createFormObj(s,l)},e.prototype.createFormObj=function(e,t){var i=this;return new he(e,{rules:t,locale:this.parent.locale,validationComplete:function(e){i.validationComplete(e)},customPlacement:function(e,t){var n=e.getAttribute("e-mappinguid"),r={column:i.parent.getColumnByUid(n),error:t,inputElement:e,value:e.value};i.valErrorPlacement(e,t),i.parent.notify(I["te"],r)}})},e.prototype.valErrorPlacement=function(e,t){if(this.parent.isEdit){var i=t.getAttribute("for"),n=this.getElemTable(e).querySelector("#"+i+"_Error");n?n.querySelector(".e-tip-content").innerHTML=t.outerHTML:this.createTooltip(e,t,i,"")}},e.prototype.getElemTable=function(e){var t,i,n=this.parent;if("Dialog"!==n.editSettings.mode){t=n.frozenRows&&n.frozenRows>(parseInt(Object(w["A"])(e,"."+x["A"]).getAttribute(x["d"]),10)||0);var r=e.name,s=void 0;r&&(s=Object(j["z"])(this.parent,Object(j["ub"])(r))),s&&n.isFrozenGrid()?"frozen-left"===s.getFreezeTableName()?i=t?n.getFrozenVirtualHeader().querySelector("table"):n.getFrozenVirtualContent().querySelector("table"):"frozen-right"===s.getFreezeTableName()?i=t?n.getFrozenRightHeader().querySelector("table"):n.getFrozenRightContent().querySelector("table"):"movable"===s.getFreezeTableName()&&(i=t?n.getMovableVirtualHeader().querySelector("table"):n.getMovableVirtualContent().querySelector("table")):i=t?n.getHeaderTable():n.getContentTable()}else i=Object(w["jb"])("#"+n.element.id+"_dialogEdit_wrapper",document);return i},e.prototype.resetElemPosition=function(e,t){var i=Object(j["hb"])(t.element,x["B"]);if(i){var n=i.getBoundingClientRect().right,r=e.getBoundingClientRect().right;if(r>n){var s=r-n;e.style.left=e.offsetLeft-s+"px"}}},e.prototype.validationComplete=function(e){if(this.parent.isEdit){var t=this.getElemTable(e.element).querySelector("#"+e.inputName+"_Error");t&&("failure"===e.status?(t.style.display="",this.resetElemPosition(t,e)):t.style.display="none")}},e.prototype.createTooltip=function(e,t,i,n){var r=this.parent.getColumnByField(i),s=this.parent.getFrozenMode()===x["w"]&&"Normal"===this.parent.editSettings.mode&&r.getFreezeTableName()===x["q"]?this.frFormObj.element:this.formObj.element,a=Object(j["hb"])(e,"e-virtual-validation");a&&(s=this.virtualFormObj.element);var o=this.parent.getContent().firstElementChild,l=this.parent.getFrozenColumns()||this.parent.getFrozenLeftColumnsCount()||this.parent.getFrozenRightColumnsCount();l&&(o=this.parent.getMovableVirtualContent());var d,c,h=o.scrollHeight>o.clientHeight||o.scrollWidth>o.clientWidth,p="Dialog"!==this.parent.editSettings.mode,u=Object(w["A"])(e,"."+x["B"]),m=Object(w["A"])(e,"."+x["A"]),g=this.parent.getContent().querySelector("."+x["n"]),f=!1,b=!1,v=Math.round(this.parent.getContent().clientHeight/this.parent.getRowHeight())-1,y=g?[].slice.call(this.parent.getFrozenVirtualContent().getElementsByClassName(x["A"])):[].slice.call(this.parent.getContent().getElementsByClassName(x["A"]));if("Batch"===this.parent.editSettings.mode&&v>1&&y.length>=v&&y[y.length-1].getAttribute(x["d"])===m.getAttribute(x["d"])&&(b=!0),p){if(this.parent.frozenRows){var C=l?this.parent.getFrozenVirtualHeader().querySelector(x["D"]).children:this.parent.getHeaderTable().querySelector(x["D"]).children;d=C.length>(parseInt(m.getAttribute(x["d"]),10)||0),f=d&&parseInt(m.getAttribute(x["d"]),10)===C.length-1}(f||v>1&&y.length>=v&&("Bottom"===this.parent.editSettings.newRowPosition&&this.editModule.args&&"add"===this.editModule.args.requestType||u.classList.contains("e-lastrowcell")&&!m.classList.contains(x["b"]))||b)&&(c=!0)}var O=p?d?this.parent.getHeaderTable():this.parent.getContentTable():Object(w["jb"])("#"+this.parent.element.id+"_dialogEdit_wrapper .e-dlg-content",document),T=O.getBoundingClientRect(),k=p?this.parent.element.getBoundingClientRect().left:T.left,S=Object(w["A"])(e,"td"),R=S?S.getBoundingClientRect():e.parentElement.getBoundingClientRect(),D=this.parent.createElement("div",{className:"e-tooltip-wrap e-lib e-control e-popup e-griderror",id:i+"_Error",styles:"display:"+n+";top:"+((d?R.top+R.height:R.bottom-T.top-(l?g.scrollTop:0))+O.scrollTop+9)+"px;left:"+(R.left-k+O.scrollLeft+R.width/2)+"px;max-width:"+R.width+"px;text-align:center;"});this.parent.cssClass&&D.classList.add(this.parent.cssClass),p&&T.left<k&&(D.style.left=parseInt(D.style.left,10)-T.left+k+"px");var E,I=this.parent.createElement("div",{className:"e-tip-content"});if(I.appendChild(t),c?(E=this.parent.createElement("div",{className:"e-arrow-tip e-tip-bottom"}),E.appendChild(this.parent.createElement("div",{className:"e-arrow-tip-outer e-tip-bottom"})),E.appendChild(this.parent.createElement("div",{className:"e-arrow-tip-inner e-tip-bottom"}))):(E=this.parent.createElement("div",{className:"e-arrow-tip e-tip-top"}),E.appendChild(this.parent.createElement("div",{className:"e-arrow-tip-outer e-tip-top"})),E.appendChild(this.parent.createElement("div",{className:"e-arrow-tip-inner e-tip-top"}))),D.appendChild(I),D.appendChild(E),a||!l&&!this.parent.frozenRows||"Dialog"===this.parent.editSettings.mode)a?this.virtualFormObj.element.appendChild(D):this.formObj.element.appendChild(D);else{var M="Normal"===this.parent.editSettings.mode?Object(w["A"])(e,".e-editcell"):Object(w["A"])(e,"."+x["C"]);M.style.position="relative",D.style.position="absolute","Batch"===this.parent.editSettings.mode||Object(w["A"])(e,"."+x["n"])||Object(w["A"])(e,"."+x["o"])||this.parent.frozenRows&&!l?s.appendChild(D):this.mFormObj.element.appendChild(D)}!c&&p&&o.getBoundingClientRect().bottom<R.bottom+R.height&&(o.scrollTop=o.scrollTop+D.offsetHeight+E.scrollHeight);var P=parseInt(document.defaultView.getComputedStyle(D,null).getPropertyValue("font-size"),10);if(D.getBoundingClientRect().width<R.width&&D.querySelector("label").getBoundingClientRect().height/(1.2*P)>=2&&(D.style.width=D.style.maxWidth),(l||this.parent.frozenRows)&&"Dialog"!==this.parent.editSettings.mode?D.style.left=S.offsetLeft+(S.offsetWidth/2-D.offsetWidth/2)+"px":D.style.left=parseInt(D.style.left,10)-D.offsetWidth/2+"px",p&&!h&&!this.parent.allowPaging||l||this.parent.frozenRows){o.style.position="static";var L=Object(we["b"])(S,D);D.style.top=L.top+R.height+9+"px"}if(c){if(!h||l||"auto"===this.parent.height||this.parent.frozenRows||this.parent.enableVirtualization)D.style.bottom=R.height+9+"px";else{var N=o.scrollWidth>o.offsetWidth?Object(j["R"])():0;D.style.bottom=this.parent.height-o.querySelector("table").offsetHeight-N+R.height+9+"px"}if(y.length<v&&"Bottom"===this.parent.editSettings.newRowPosition&&this.editModule.args&&"add"===this.editModule.args.requestType){var A=this.parent.frozenRows?this.parent.frozenRows+(y.length-1):y.length-1,B=A*this.parent.getRowHeight(),F=this.parent.getContent().clientHeight-B;D.style.bottom=F+9+"px"}D.style.top=null}},e.prototype.checkColumnIsGrouped=function(e){return!e.visible&&!(this.parent.groupSettings.columns.indexOf(e.field)>-1)},e.AddEditors=function(t){e.editCellType=Object(w["G"])(e.editCellType,t)},e.editCellType={dropdownedit:W,numericedit:$,datepickeredit:ge,datetimepickeredit:ge,booleanedit:_,defaultedit:Q,templateedit:Oe},e}(),ke=i("3c91"),Se=i("4d58"),je=i("3bec"),Re=function(){function e(e){this.batchChildCount=0,this.addedRecords="addedRecords",this.deletedRecords="deletedRecords",this.batchAddedRecords=[],this.batchDeletedRecords=[],this.batchAddRowRecord=[],this.parent=e,this.isSelfReference=!Object(w["T"])(e.parentIdMapping),this.batchRecords=[],this.currentViewRecords=[],this.isAdd=!1,this.addEventListener()}return e.prototype.addEventListener=function(){this.parent.on(ke["t"],this.cellSaved,this),this.parent.on(ke["d"],this.batchAdd,this),this.parent.on(ke["h"],this.beforeBatchAdd,this),this.parent.on(ke["g"],this.batchSave,this),this.parent.on(ke["j"],this.beforeBatchDelete,this),this.parent.on(ke["k"],this.beforeBatchSave,this),this.parent.on("batchPageAction",this.batchPageAction,this),this.parent.on("batchCancelAction",this.batchCancelAction,this),this.parent.grid.on("immutable-batch-cancel",this.immutableBatchAction,this),this.parent.grid.on("next-cell-index",this.nextCellIndex,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(ke["t"],this.cellSaved),this.parent.off(ke["d"],this.batchAdd),this.parent.off(ke["g"],this.batchSave),this.parent.off(ke["h"],this.beforeBatchAdd),this.parent.off(ke["j"],this.beforeBatchDelete),this.parent.off(ke["k"],this.beforeBatchSave),this.parent.off("batchPageAction",this.batchPageAction),this.parent.off("batchCancelAction",this.batchCancelAction),this.parent.grid.off("immutable-batch-cancel",this.immutableBatchAction),this.parent.grid.off("next-cell-index",this.nextCellIndex))},e.prototype.destroy=function(){this.removeEventListener()},e.prototype.getBatchRecords=function(){return this.batchRecords},e.prototype.getAddRowIndex=function(){return this.addRowIndex},e.prototype.getSelectedIndex=function(){return this.selectedIndex},e.prototype.getBatchChildCount=function(){return this.batchChildCount},e.prototype.batchPageAction=function(){var e,t=this.parent.grid.dataSource instanceof O["a"]?this.parent.grid.dataSource.dataSource.json:this.parent.grid.dataSource,i=this.parent.grid.getPrimaryKeyFieldNames()[0];if(!Object(w["T"])(this.batchAddedRecords)&&this.batchAddedRecords.length)for(var n=0;n<this.batchAddedRecords.length;n++)e=t.map(function(e){return e[i]}).indexOf(this.batchAddedRecords[n][i]),t.splice(e,1);this.batchAddedRecords=this.batchRecords=this.batchAddRowRecord=this.batchDeletedRecords=this.currentViewRecords=[]},e.prototype.cellSaved=function(e){var t=e.cell.cellIndex,i=this.parent.frozenColumns||this.parent.getFrozenColumns();i&&e.columnObject.index>i&&(t+=i);var n=this.parent.getFrozenLeftColumnsCount()>0||this.parent.getFrozenRightColumnsCount()>0;if(n){var r=this.parent.getFrozenLeftColumnsCount()+t;r===this.parent.treeColumnIndex&&this.parent.renderModule.cellRender({data:e.rowData,cell:e.cell,column:this.parent.grid.getColumnByIndex(e.cell.cellIndex)})}else t===this.parent.treeColumnIndex&&this.parent.renderModule.cellRender({data:e.rowData,cell:e.cell,column:this.parent.grid.getColumnByIndex(e.cell.cellIndex)});if(this.isAdd&&"Batch"===this.parent.editSettings.mode&&"Bottom"!==this.parent.editSettings.newRowPosition){var s=this.parent.grid.dataSource instanceof O["a"]?this.parent.grid.dataSource.dataSource.json:this.parent.grid.dataSource,a=void 0,o="level",l=this.parent.grid.getPrimaryKeyFieldNames()[0],d=void 0,c=void 0,h="parentItem",p="uniqueID",u=this.selectedIndex>-1?this.batchRecords[this.addRowIndex][h]:null,m=void 0,g=void 0,f=void 0,b="Top"===this.parent.editSettings.newRowPosition||-1===this.selectedIndex?0:"Above"===this.parent.editSettings.newRowPosition?this.addRowIndex:this.addRowIndex+1;if(b=this.getActualRowObjectIndex(b),this.newBatchRowAdded){if(this.batchRecords.length&&(m=this.batchRecords[this.addRowIndex][this.parent.idMapping],f=this.batchRecords[this.addRowIndex][this.parent.parentIdMapping],this.batchRecords[this.addRowIndex][h]&&(g=this.batchRecords[this.addRowIndex][h][p])),this.batchAddedRecords=Object(Se["a"])(this.batchAddedRecords),this.batchAddRowRecord=Object(Se["a"])(this.batchAddRowRecord),this.batchAddRowRecord.push(this.batchRecords[this.addRowIndex]),a=this.parent.grid.getRowsObject()[b].changes,a.uniqueID=Object(j["T"])(this.parent.element.id+"_data_"),Object(w["ob"])("uniqueIDCollection."+a.uniqueID,a,this.parent),!Object.prototype.hasOwnProperty.call(a,"level")){if(this.batchIndex=-1===this.selectedIndex?0:this.batchIndex,"Child"===this.parent.editSettings.newRowPosition){if(a.primaryParent=u,this.selectedIndex>-1){a.parentItem=Object(w["G"])({},this.batchRecords[this.addRowIndex]),a.parentUniqueID=a.parentItem.uniqueID,delete a.parentItem.childRecords,delete a.parentItem[this.parent.childMapping],a.level=a.parentItem.level+1,a.index=this.batchIndex;var v=Object(Se["b"])(this.batchRecords[this.addRowIndex]).length,y=Object(Se["b"])(this.batchRecords[this.addRowIndex])[v-1];y=Object(w["T"])(y)?this.batchRecords[this.addRowIndex]:y,d=s.map(function(e){return e[l]}).indexOf(y[l]),this.isSelfReference&&(a[this.parent.parentIdMapping]=m),Object(je["b"])(l,a.parentItem,"add",this.parent,this.isSelfReference,a)}}else if(("Above"===this.parent.editSettings.newRowPosition||"Below"===this.parent.editSettings.newRowPosition)&&!Object(w["T"])(this.batchRecords[this.addRowIndex])){if(a.level=this.batchRecords[this.addRowIndex][o],a.level&&this.selectedIndex>-1&&(a.parentItem=u,a.parentUniqueID=g,delete a.parentItem.childRecords,delete a.parentItem[this.parent.childMapping]),a.index="Below"===this.parent.editSettings.newRowPosition?this.batchIndex:this.batchIndex-1,"Below"===this.parent.editSettings.newRowPosition&&this.selectedIndex>-1){v=Object(Se["b"])(this.batchRecords[this.addRowIndex]).length,y=Object(Se["b"])(this.batchRecords[this.addRowIndex])[v-1];y=Object(w["T"])(y)?this.batchRecords[this.addRowIndex]:y,d=s.map(function(e){return e[l]}).indexOf(y[l])}if("Above"===this.parent.editSettings.newRowPosition&&this.selectedIndex>-1){y=this.batchRecords[this.addRowIndex];d=s.map(function(e){return e[l]}).indexOf(y[l])}this.isSelfReference&&(a[this.parent.parentIdMapping]=f)}a.index=-1===a.index?0:a.index,a.hasChildRecords=!1,a.childRecords=[],this.batchRecords.splice(a.index,0,a),this.currentViewRecords.splice(a.index,0,a),c=d||a.index,"Above"!==this.parent.editSettings.newRowPosition&&(c=0===a.index?c:c+1),s.splice(c,0,a),this.batchAddedRecords.push(a)}this.parent.grid.getRowsObject()[b].data=a,this.newBatchRowAdded=!1}(this.parent.frozenColumns||this.parent.getFrozenColumns()&&"add"===this.parent.grid.getRowsObject()[b].edit)&&Object(w["ab"])(this.currentViewRecords[b],this.parent.grid.getRowsObject()[b].changes)}},e.prototype.beforeBatchAdd=function(e){var t="isTabLastRow";if("Cell"===this.parent.editSettings.mode&&this.parent.editModule[t])return e.cancel=!0,void(this.parent.editModule[t]=!1);this.parent.editModule["isAddedRowByMethod"]&&!Object(w["T"])(this.parent.editModule["addRowIndex"])&&-1===this.parent.grid.selectedRowIndex?(this.selectedIndex=this.parent.editModule["selectedIndex"],this.addRowIndex=this.parent.editModule["addRowIndex"],this.addRowRecord=this.parent.getCurrentViewRecords()[this.selectedIndex]):(this.selectedIndex=this.parent.grid.selectedRowIndex,this.addRowIndex=this.parent.grid.selectedRowIndex>-1?this.parent.grid.selectedRowIndex:0,this.parent.editModule["addRowIndex"]=this.parent.grid.selectedRowIndex>-1?this.parent.grid.selectedRowIndex:0,this.addRowRecord=this.parent.getSelectedRecords()[0])},e.prototype.batchAdd=function(e){if("Bottom"!==this.parent.editSettings.newRowPosition){this.isAdd=!0,this.newBatchRowAdded=!0;var t=0;if(this.batchRecords.length||(this.batchAddedRecords=[],this.batchRecords=Object(Se["a"])(this.parent.grid.getCurrentViewRecords()),this.currentViewRecords=Object(Se["a"])(this.parent.grid.getCurrentViewRecords())),this.parent.editModule["isAddedRowByMethod"]&&!Object(w["T"])(this.parent.editModule["addRowIndex"])&&Object(w["y"])(this.parent.grid.getDataRows()[0],["e-batchrow"],[]),"Top"!==this.parent.editSettings.newRowPosition){var i=this.parent.grid.getCurrentViewRecords();"Batch"===this.parent.editSettings.mode&&(this.parent.getBatchChanges()[this.addedRecords].length>1||this.parent.getBatchChanges()[this.deletedRecords].length)&&(i=this.batchRecords),this.updateChildCount(i),this.parent.notify(ke["p"],{}),this.batchChildCount=0}this.updateRowIndex();var n=Object(w["R"])("focusModule",this.parent.grid),r=this.parent.getContentTable();this.parent.getBatchChanges()[this.deletedRecords].length&&"Above"===this.parent.editSettings.newRowPosition?(t=e.row.rowIndex,n.getContent().matrix.matrix=this.matrix):t=r.getElementsByClassName("e-batchrow")[0].rowIndex,n.getContent().matrix.current=[t,n.getContent().matrix.current[1]]}},e.prototype.beforeBatchDelete=function(e){this.batchRecords.length||(this.batchRecords=Object(Se["a"])(this.parent.grid.getCurrentViewRecords()),this.currentViewRecords=Object(Se["a"])(this.parent.grid.getCurrentViewRecords()));var t=Object(w["R"])("focusModule",this.parent.grid);this.matrix=t.getContent().matrix.matrix;var i,n,r,s=[],a=[],o=this.parent.grid.getPrimaryKeyFieldNames()[0];Object(w["T"])(e.row)||-1!==this.parent.getSelectedRows().indexOf(e.row)?(i=this.parent.grid.getSelectedRecords()[this.parent.grid.getSelectedRecords().length-1],n=Object(Se["b"])(i),r=this.parent.getSelectedRows()[0].getAttribute("data-uid")):(i=e.rowData,n=Object(Se["b"])(i),r=e.row.getAttribute("data-uid"));var l=parseInt(this.parent.grid.getRowElementByUID(r).getAttribute("aria-rowindex"),10);if(n.length)for(var d=l+n.length,c=l+1,h=c;h<=d;h++)s.push(this.parent.grid.getDataRows()[h]),(this.parent.frozenRows||this.parent.frozenColumns||this.parent.getFrozenColumns())&&s.push(this.parent.grid.getMovableRows()[h]);if(!Object(w["T"])(i.parentItem)){var p=Object(Se["d"])(this.parent,i.parentItem.uniqueID);if(!Object(w["T"])(p)&&p.hasChildRecords){var u=p.childRecords.indexOf(i);p.childRecords.splice(u,1)}this.batchDeletedRecords=Object(Se["a"])(this.batchDeletedRecords),this.batchDeletedRecords.push(i)}n.push(i),a=n;for(h=0;h<a.length;h++){var m=this.batchRecords.map(function(e){return e[o]}).indexOf(a[h][o]);-1!==m&&this.batchRecords.splice(m,1)}for(h=0;h<s.length;h++)Object(w["T"])(s[h])||this.parent.grid.selectionModule.selectedRecords.push(s[h])},e.prototype.updateRowIndex=function(){for(var e=this.parent.grid.getDataRows(),t=0;t<e.length;t++)e[t].setAttribute("aria-rowindex",t.toString());var i=this.parent.getFrozenLeftColumnsCount()>0||this.parent.getFrozenRightColumnsCount()>0;if(this.parent.frozenRows||this.parent.getFrozenColumns()||this.parent.frozenColumns||i){var n=this.parent.grid.getMovableDataRows(),r=this.parent.grid.getFrozenRightDataRows();for(t=0;t<n.length;t++)n[t].setAttribute("aria-rowindex",t.toString()),i&&r[t].setAttribute("aria-rowindex",t.toString())}},e.prototype.updateChildCount=function(e){for(var t=this.parent.grid.getPrimaryKeyFieldNames()[0],i="addedRecords",n="Child"===this.parent.editSettings.newRowPosition?"primaryParent":"parentItem",r=0;r<this.parent.getBatchChanges()[i].length;r++)Object(w["T"])(this.parent.getBatchChanges()[i][r][n])||this.parent.getBatchChanges()[i][r][n][t]===e[this.addRowIndex][t]&&(this.batchChildCount=this.batchChildCount+1)},e.prototype.beforeBatchSave=function(e){var t="changedRecords",i="deletedRecords",n=e.batchChanges[t];if(e.batchChanges[t].length)for(var r=void 0,s=0;s<n.length;s++)Object(je["a"])({value:n[s],action:"edit"},this.parent,this.isSelfReference,this.addRowIndex,this.selectedIndex,r);if(e.batchChanges[i].length){var a=e.batchChanges[i],o=a;for(s=0;s<o.length;s++){this.deleteUniqueID(o[s].uniqueID);for(var l=Object(Se["b"])(o[s]),d=0;d<l.length;d++)this.deleteUniqueID(l[d].uniqueID);e.batchChanges[i]=e.batchChanges[i].concat(l)}}this.isAdd=!1},e.prototype.deleteUniqueID=function(e){var t="uniqueIDFilterCollection";delete this.parent[t][e];var i="uniqueIDCollection";delete this.parent[i][e]},e.prototype.batchCancelAction=function(){var e,t="targetElement",i="parentItem",n="index",r=this.parent.grid.getCurrentViewRecords(),s="childRecords",a=this.parent.grid.dataSource instanceof O["a"]?this.parent.grid.dataSource.dataSource.json:this.parent.grid.dataSource,o=this.parent.grid.getPrimaryKeyFieldNames()[0];if(!Object(w["T"])(this.batchAddedRecords))for(var l=0;l<this.batchAddedRecords.length;l++)if(e=a.map(function(e){return e[o]}).indexOf(this.batchAddedRecords[l][o]),a.splice(e,1),"Child"===this.parent.editSettings.newRowPosition&&(e=r.map(function(e){return e[o]}).indexOf(this.batchAddedRecords[l][i]?this.batchAddedRecords[l][i][o]:this.batchAddedRecords[l][o]),!Object(w["T"])(r[e])))for(var d=r[e][s],c=0;d&&c<d.length;c++)d[c][o]===this.batchAddedRecords[l][o]&&r[e][s].splice(c,1);if(!Object(w["T"])(this.parent[t])){var h=this.parent[t].closest("tr");this.parent.collapseRow(h),this.parent[t]=null}if(!Object(w["T"])(this.batchDeletedRecords))for(l=0;l<this.batchDeletedRecords.length;l++)if(!Object(w["T"])(this.batchDeletedRecords[l][i])){e=r.map(function(e){return e[o]}).indexOf(this.batchDeletedRecords[l][i][o]);var p=0===this.batchDeletedRecords[l][n]?this.batchDeletedRecords[l][n]:this.batchDeletedRecords[l][n]-1;Object(w["T"])(r[e])||r[e][s].splice(p,0,this.batchDeletedRecords[l])}this.batchAddedRecords=this.batchRecords=this.batchAddRowRecord=this.currentViewRecords=[],this.batchRecords=Object(Se["a"])(this.parent.grid.getCurrentViewRecords()),this.batchIndex=0,this.currentViewRecords=Object(Se["a"])(this.parent.grid.getCurrentViewRecords()),this.batchDeletedRecords=[],this.parent.grid.renderModule.refresh()},e.prototype.batchSave=function(e){if("Batch"===this.parent.editSettings.mode){var t=void 0,i=Object.hasOwnProperty.call(e,"updatedRecords")?e.updatedRecords:this.parent.getBatchChanges(),n="deletedRecords",r="addedRecords",s="index",a="uniqueID",o=this.parent.grid.dataSource instanceof O["a"]?this.parent.grid.dataSource.dataSource.json:this.parent.grid.dataSource,l=this.parent.grid.getCurrentViewRecords(),d=this.parent.grid.getPrimaryKeyFieldNames()[0],c="level",h=i[r],p="parentItem",u=void 0,m=void 0,g=void 0,f=void 0,b="childRecords";if(h.length>1&&"Bottom"!==this.parent.editSettings.newRowPosition&&h.reverse(),"Bottom"!==this.parent.editSettings.newRowPosition&&!Object.hasOwnProperty.call(e,"updatedRecords")){if(o.splice(o.length-h.length,h.length),this.parent.editModule["isAddedRowByMethod"]&&h.length&&!Object(w["T"])(this.parent.editModule["addRowIndex"])){var v=parseInt(this.parent.getContentTable().getElementsByClassName("e-insertedrow")[0].getAttribute("aria-rowindex"),10);o.splice(v,0,h[0])}if(this.parent.allowPaging||o.length===l.length){var y=Object(Se["a"])(o);if(y.length){var C=y.map(function(e){return e[d]}).indexOf(l[0][d]),T=C+this.parent.grid.pageSettings.pageSize;l=y.splice(C,T)}}else l.length>h.length&&l.splice(l.length-h.length,h.length)}for(0===this.batchAddRowRecord.length&&this.batchAddRowRecord.push(this.parent.flatData[e.index]),t=0;t<h.length;t++){var k=Object(w["G"])({},h[t]);if(delete k.parentItem,delete k.uniqueID,delete k.index,delete k.level,delete k.hasChildRecords,delete k.childRecords,delete k.parentUniqueID,Object(w["T"])(k.primaryParent)||delete k.primaryParent,h[t].taskData=k,f=this.batchAddRowRecord[t],Object(w["T"])(f)&&(f=this.batchAddRowRecord[t-1]),this.isSelfReference&&(Object(w["T"])(h[t].parentItem)||Object(je["b"])(d,h[t].parentItem,"add",this.parent,this.isSelfReference,h[t])),Object(w["T"])(f)||(m=f.index),"Top"!==this.parent.editSettings.newRowPosition&&"Bottom"!==this.parent.editSettings.newRowPosition&&Object(w["T"])(h[t].parentItem)&&-1===this.selectedIndex&&(u=-1,f=null),Object(je["a"])({value:h[t],action:"add"},this.parent,this.isSelfReference,m,u,g,f),u=null,"Child"===this.parent.editSettings.newRowPosition&&!Object(w["T"])(h[t][p])&&(Object(w["T"])(this.parent.editModule["addRowIndex"])||this.isSelfReference))for(var S=l.map(function(e){return e[d]}).indexOf(h[t][p][d]),j=l[S][b],R=0;R<j.length;R++)j[R][d]===h[t][d]&&l[S][b].splice(R,1)}if(i[n].length)for(t=0;t<i[n].length;t++)Object(je["a"])({value:i[n][t],action:"delete"},this.parent,this.isSelfReference,m,u,g,f);this.parent.parentData=[];for(var D=0;D<o.length;D++)o[D][s]=D,Object(w["ob"])("uniqueIDCollection."+o[D][a]+".index",D,this.parent),o[D][c]||this.parent.parentData.push(o[D])}this.batchAddRowRecord=this.batchAddedRecords=this.batchRecords=this.batchDeletedRecords=this.currentViewRecords=[]},e.prototype.getActualRowObjectIndex=function(e){var t=this.parent.grid.getDataRows();if(("Below"===this.parent.editSettings.newRowPosition||"Child"===this.parent.editSettings.newRowPosition)&&this.selectedIndex>-1){if(!Object(w["T"])(this.batchRecords[this.addRowIndex])&&this.batchRecords[this.addRowIndex].expanded)if(this.parent.getBatchChanges()[this.addedRecords].length>1||this.parent.getBatchChanges()[this.deletedRecords].length){if(e+=Object(Se["b"])(this.batchRecords[this.addRowIndex]).length,"Child"!==this.parent.editSettings.newRowPosition){var i=this.getBatchChildCount();e+=i}}else e+=Object(Se["b"])(this.batchRecords[this.addRowIndex]).length;e>=t.length&&(e=t.length-1),this.updateChildCount(this.parent.grid.getCurrentViewRecords()),this.batchChildCount&&(e+=this.batchChildCount),this.batchChildCount=0}return e},e.prototype.immutableBatchAction=function(e){e.args.cancel=!0;var t=this.parent.grid.getBatchChanges(),i=[],n="index";Object.keys(t).length&&(i=t.addedRecords);for(var r=0;r<i.length;r++)e.rows.splice(i[r][n],1)},e.prototype.nextCellIndex=function(e){var t="index",i="rowIndex";this.parent.getSelectedRows().length?e[t]=this.parent.getSelectedRows()[0][i]:e[t]=this.batchIndex},e}(),De=function(){function e(e){this.addedRecords="addedRecords",this.deletedRecords="deletedRecords",this.prevAriaRowIndex="-1",this.isAddedRowByMethod=!1,E["a"].Inject(Te),this.parent=e,this.isSelfReference=!Object(w["T"])(e.parentIdMapping),this.previousNewRowPosition=null,this.internalProperties={},this.batchEditModule=new Re(this.parent),this.addEventListener()}return e.prototype.getModuleName=function(){return"edit"},e.prototype.addEventListener=function(){this.parent.on(ke["z"],this.crudAction,this),this.parent.on(ke["q"],this.beginEdit,this),this.parent.on(ke["p"],this.beginAdd,this),this.parent.on(ke["P"],this.recordDoubleClick,this),this.parent.on(ke["s"],this.cellSave,this),this.parent.on(ke["e"],this.batchCancel,this),this.parent.grid.on(ke["J"],this.keyPressed,this),this.parent.grid.on("batchedit-form",this.lastCellTab,this),this.parent.grid.on("content-ready",this.contentready,this),this.parent.on(ke["r"],this.cellEdit,this),this.parent.on("actionBegin",this.editActionEvents,this),this.parent.on("actionComplete",this.editActionEvents,this),this.parent.grid.on(ke["F"],this.recordDoubleClick,this),this.parent.grid.on("dblclick",this.gridDblClick,this),this.parent.grid.on("recordAdded",this.customCellSave,this),this.parent.on("savePreviousRowPosition",this.savePreviousRowPosition,this),this.parent.grid.on(ke["o"],this.beforeStartEdit,this),this.parent.grid.on(ke["i"],this.beforeBatchCancel,this),this.parent.grid.on("reset-edit-props",this.resetIsOnBatch,this),this.parent.grid.on("get-row-position",this.getRowPosition,this)},e.prototype.gridDblClick=function(e){this.doubleClickTarget=e.target},e.prototype.getRowPosition=function(e){e.newRowPosition=this.parent.editSettings.newRowPosition,e.addRowIndex=this.addRowIndex,e.ariaRowIndex=+this.prevAriaRowIndex},e.prototype.beforeStartEdit=function(e){this.parent.trigger(ke["a"],e)},e.prototype.beforeBatchCancel=function(e){"Cell"===this.parent.editSettings.mode&&this.parent.trigger(ke["b"],e)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(ke["z"],this.crudAction),this.parent.off(ke["q"],this.beginEdit),this.parent.off(ke["p"],this.beginAdd),this.parent.off(ke["P"],this.recordDoubleClick),this.parent.off(ke["e"],this.batchCancel),this.parent.grid.off(ke["J"],this.keyPressed),this.parent.grid.off("batchedit-form",this.lastCellTab),this.parent.grid.off("content-ready",this.contentready),this.parent.off(ke["r"],this.cellEdit),this.parent.off("actionBegin",this.editActionEvents),this.parent.off("actionComplete",this.editActionEvents),this.parent.grid.off("recordAdded",this.customCellSave),this.parent.grid.off(ke["F"],this.recordDoubleClick),this.parent.off("savePreviousRowPosition",this.savePreviousRowPosition),this.parent.grid.off(ke["o"],this.beforeStartEdit),this.parent.grid.off(ke["i"],this.beforeBatchCancel),this.parent.grid.off("dblclick",this.gridDblClick),this.parent.grid.off("reset-edit-props",this.resetIsOnBatch),this.parent.grid.off("get-row-position",this.getRowPosition))},e.prototype.destroy=function(){this.removeEventListener()},e.prototype.applyFormValidation=function(e){this.parent.grid.editModule.applyFormValidation(e)},e.prototype.editActionEvents=function(e){var t=Object(j["N"])("editAction",e),i=Object(j["N"])("name",t),n=this.parent,r=n.dataSource.adaptor;if((Object(Se["k"])(n)||r instanceof k["f"])&&"save"===t.requestType&&"add"===t.action&&("Child"===n.editSettings.newRowPosition||"Below"===n.editSettings.newRowPosition||"Above"===n.editSettings.newRowPosition))if("actionBegin"===i){var s=Object(w["T"])(t.row)||!Object.keys(t.row).length?this.selectedIndex:t.row.rowIndex-1,a=Object(w["T"])(s)||-1===s?-1:n.getCurrentViewRecords()[s][n.getPrimaryKeyFieldNames()[0]];n.grid.query.addParams("relationalKey",a)}else if("actionComplete"===i)for(var o=n.grid.query.params.length,l=0;l<o;l++)"relationalKey"===n.grid.query.params[l].key&&n.grid.query.params.splice(l);this.parent.enableInfiniteScrolling&&"actionComplete"===i&&this.infiniteAddAction(t),"Batch"===this.parent.editSettings.mode&&"paging"===t.requestType&&this.parent.notify("batchPageAction",{})},e.prototype.infiniteAddAction=function(e){if("save"===e.requestType&&"add"===e.action||"delete"===e.requestType){if("Top"!==this.parent.editSettings.newRowPosition&&-1!==this.selectedIndex&&"save"===e.requestType&&"add"===e.action){var t=this.parent.grid.getRowsObject(),i=t.splice(0,1)[0],n=this.addRowIndex,r=this.parent.getCurrentViewRecords();"Below"!==this.parent.editSettings.newRowPosition&&"Child"!==this.parent.editSettings.newRowPosition||(n+=Object(Se["b"])(r[n+1]).length),n="Below"===this.parent.editSettings.newRowPosition?n+1:n,t.splice(n,0,i);var s=r.splice(0,1)[0];r.splice(n,0,s),this.updateInfiniteCurrentViewData(s,this.addRowIndex)}var a=this.parent.grid.getMovableRows(),o=this.parent.grid.getMovableRowsObject(),l=this.parent.infiniteScrollSettings.enableCache;l||(Object(j["rb"])(this.parent.grid,this.parent.grid.getRowsObject(),this.parent.grid.getRows(),0),this.updateIndex(this.parent.grid.dataSource,this.parent.getRows(),this.parent.getCurrentViewRecords())),!l&&this.parent.getFrozenColumns()>0&&(Object(j["rb"])(this.parent.grid,o,a,0),this.updateIndex(this.parent.grid.dataSource,a,this.parent.getCurrentViewRecords()))}},e.prototype.updateInfiniteCurrentViewData=function(e,t){var i=this,n="infiniteCurrentViewData",r="updateCurrentViewData",s=Math.ceil(t/this.parent.grid.pageSettings.pageSize),a=s>0?s:1,o=t-(a-1)*this.parent.pageSettings.pageSize,l=this.parent.grid.infiniteScrollModule[n];l[1].splice(0,1);var d=l[a];Object(w["T"])(this.addRowRecord)||(d.filter(function(e,t){e.uniqueID===i.addRowRecord.uniqueID&&(o=t)}),(this.addRowRecord.hasChildRecords&&this.addRowRecord.childRecords.length&&"Below"===this.parent.editSettings.newRowPosition||"Child"===this.parent.editSettings.newRowPosition)&&(o+=Object(Se["b"])(this.addRowRecord).length)),o>=this.parent.pageSettings.pageSize&&(a+=1,d=l[a],o=o-this.parent.pageSettings.pageSize>=0?o-this.parent.pageSettings.pageSize:0),o="Below"===this.parent.editSettings.newRowPosition?o+1:o,d.splice(o,0,e),this.parent.grid.infiniteScrollModule[r]()},e.prototype.recordDoubleClick=function(e){var t=e.target;if(!Object(w["T"])(t.closest("td.e-rowcell"))&&this.parent.grid.editSettings.allowEditing&&!this.parent.grid.isEdit){var i=this.parent.grid.getColumnByIndex(+t.closest("td.e-rowcell").getAttribute("aria-colindex"));if("Cell"===this.parent.editSettings.mode&&!this.isOnBatch&&i&&!i.isPrimaryKey&&this.parent.editSettings.allowEditing&&i.allowEditing&&!t.classList.contains("e-treegridexpand")&&!t.classList.contains("e-treegridcollapse")&&this.parent.editSettings.allowEditOnDblClick){if(this.isOnBatch=!0,this.parent.grid.setProperties({selectedRowIndex:e.rowIndex},!0),this.parent.enableVirtualization){var n=Object(j["hb"])(e.target,"e-row");this.prevAriaRowIndex=n.getAttribute("aria-rowindex"),n.setAttribute("aria-rowindex",n.rowIndex+"")}this.updateGridEditMode("Batch")}}},e.prototype.updateGridEditMode=function(e){this.parent.grid.setProperties({editSettings:{mode:e}},!0);var t=Object(j["N"])("updateEditObj",this.parent.grid.editModule);t.apply(this.parent.grid.editModule),this.parent.grid.isEdit=!1},e.prototype.resetIsOnBatch=function(){this.parent.enableVirtualization&&"Cell"===this.parent.editSettings.mode&&(this.isOnBatch=!1,this.updateGridEditMode("Normal"))},e.prototype.keyPressed=function(e){this.isOnBatch&&(this.keyPress=e.action),"f2"===e.action&&this.recordDoubleClick(e),"escape"===e.action&&this.parent.closeEdit()},e.prototype.deleteUniqueID=function(e){var t="uniqueIDFilterCollection";delete this.parent[t][e];var i="uniqueIDCollection";delete this.parent[i][e]},e.prototype.cellEdit=function(e){var t=this,i="promise",n=e[i];if(delete e[i],this.parent.enableVirtualization&&!Object(w["T"])(this.prevAriaRowIndex)&&"-1"!==this.prevAriaRowIndex&&(e.row.setAttribute("aria-rowindex",this.prevAriaRowIndex),this.prevAriaRowIndex=void 0),"enter"!==this.keyPress&&this.parent.trigger(ke["r"],e,function(e){e.cancel||"Cell"!==t.parent.editSettings.mode?e.cancel&&"Cell"===t.parent.editSettings.mode&&(t.isOnBatch=!1,t.updateGridEditMode("Normal")):t.enableToolbarItems("edit"),Object(w["T"])(n)||n.resolve(e)}),this.doubleClickTarget&&(this.doubleClickTarget.classList.contains("e-treegridexpand")||this.doubleClickTarget.classList.contains("e-treegridcollapse")||this.doubleClickTarget.classList.contains("e-summarycell")))return e.cancel=!0,void(this.doubleClickTarget=null);"Cell"===this.parent.editSettings.mode&&("tab"===this.keyPress||"shiftTab"===this.keyPress?this.keyPress=null:"enter"===this.keyPress&&(e.cancel=!0,this.keyPress=null,Object(w["ob"])("isEditCollapse",!1,this.parent)),e.columnObject.allowEditing||(e.cancel=!0))},e.prototype.enableToolbarItems=function(e){if(!Object(w["T"])(this.parent.grid.toolbarModule)){var t=this.parent.element.id+"_gridcontrol_";this.parent.grid.toolbarModule.enableItems([t+"add",t+"edit",t+"delete"],"save"===e),this.parent.grid.toolbarModule.enableItems([t+"update",t+"cancel"],"edit"===e)}},e.prototype.batchCancel=function(){if("Cell"===this.parent.editSettings.mode){var e=Object(w["R"])("editModule.cellDetails",this.parent.grid.editModule),t=this.parent.getCellFromIndex(e.rowIndex,this.parent.treeColumnIndex);this.parent.renderModule.cellRender({data:e.rowData,cell:t,column:this.parent.grid.getColumns()[this.parent.treeColumnIndex]}),this.updateGridEditMode("Normal"),this.isOnBatch=!1}"Batch"===this.parent.editSettings.mode&&this.parent.notify("batchCancelAction",{})},e.prototype.customCellSave=function(e){Object(Se["g"])(this.parent)&&"Cell"===this.parent.editSettings.mode&&"edit"===e.action&&(this.updateCell(e,e.rowIndex),this.afterCellSave(e,e.row,e.rowIndex))},e.prototype.cellSave=function(e){var t=this;if("Cell"===this.parent.editSettings.mode&&this.parent.element.querySelector("form")){e.cancel=!0;var i,n,r="editModule";Object(w["ob"])("isEdit",!1,this.parent.grid),Object(w["ob"])("isEditCollapse",!0,this.parent),e.rowData[e.columnName]=e.value,i=Object(w["T"])(e.cell)?this.parent.grid.editModule[r].form.parentElement.parentNode:e.cell.parentNode;var s=this.parent.getPrimaryKeyFieldNames();if(Object(w["T"])(i))this.parent.grid.getCurrentViewRecords().filter(function(t,i){t[s[0]]!==e.rowData[s[0]]||(n=i)});else{var a=this.parent.getFrozenLeftColumnsCount()>0||this.parent.getFrozenRightColumnsCount()>0;n=a?-1!==this.parent.getRows().indexOf(i)?this.parent.getRows().indexOf(i):-1!==this.parent.getFrozenRightRows().indexOf(i)?this.parent.getFrozenRightRows().indexOf(i):this.parent.getMovableRows().indexOf(i):-1===this.parent.getRows().indexOf(i)&&this.parent.getFrozenColumns()>0?this.parent.grid.getMovableRows().indexOf(i):this.parent.getRows().indexOf(i)}var o={};if(Object(w["G"])(o,e),o.cancel=!1,o.type="save",i=this.parent.grid.getRows()[i.rowIndex],this.parent.trigger(ke["a"],o),o.cancel)this.parent.grid.isEdit=!0;else if(i.rowIndex===this.parent.getCurrentViewRecords().length-1&&"tab"===this.keyPress&&(this.isTabLastRow=!0),Object(Se["k"])(this.parent)||this.parent.dataSource instanceof O["a"]&&this.parent.dataSource.adaptor instanceof k["f"]){if(Object(Se["k"])(this.parent)||this.parent.dataSource instanceof O["a"]&&this.parent.dataSource.adaptor instanceof k["f"]){var l=this.parent.grid.query,d=null;d=this.parent.grid.dataSource.update(s[0],e.rowData,l.fromTable,l,e.previousValue),d.then(function(r){Object(w["T"])(r)||(e.rowData[e.columnName]=r[e.columnName]),t.updateCell(e,n),t.afterCellSave(e,i,n)})}}else if(Object(Se["g"])(this.parent)){var c="eventPromise",h={requestType:"save",data:e.rowData,action:"edit",row:i,rowIndex:n,rowData:e.rowData,columnName:e.columnName,filterChoiceCount:null,excelSearchOperator:null};this.parent.grid.getDataModule()[c](h,this.parent.grid.query)}else this.updateCell(e,n),this.afterCellSave(e,i,n)}},e.prototype.afterCellSave=function(e,t,i){var n;this.parent.grid.aggregateModule&&this.parent.grid.aggregateModule.refresh(e.rowData),this.parent.grid.editModule.destroyWidgets([this.parent.grid.getColumnByField(e.columnName)]),this.parent.grid.editModule.formObj.destroy(),"tab"!==this.keyPress&&"shiftTab"!==this.keyPress&&(this.updateGridEditMode("Normal"),this.isOnBatch=!1),this.enableToolbarItems("save");var r=this.parent.getFrozenLeftColumnsCount()>0||this.parent.getFrozenRightColumnsCount()>0;r?(n=e.cell.closest(".e-frozen-left-header")||e.cell.closest(".e-frozen-left-content")?this.parent.grid.getRows()[i]:e.cell.closest(".e-movableheader")||e.cell.closest(".e-movablecontent")?this.parent.grid.getMovableRows()[i]:this.parent.grid.getFrozenRightRows()[i],Object(w["gb"])([n],["e-editedrow","e-batchrow"]),Object(w["gb"])(n.querySelectorAll(".e-rowcell"),["e-editedbatchcell","e-updatedtd"])):this.parent.getFrozenColumns()>0&&(n=e.cell.closest(".e-frozenheader")||e.cell.closest(".e-frozencontent")?this.parent.grid.getRows()[i]:this.parent.grid.getMovableRows()[i],Object(w["gb"])([n],["e-editedrow","e-batchrow"]),Object(w["gb"])(n.querySelectorAll(".e-rowcell"),["e-editedbatchcell","e-updatedtd"])),Object(w["gb"])([t],["e-editedrow","e-batchrow"]),Object(w["gb"])(t.querySelectorAll(".e-rowcell"),["e-editedbatchcell","e-updatedtd"]),!1!==this.parent["isCellSaveFocus"]&&this.parent.grid.focusModule.restoreFocus(),Object(je["a"])({value:e.rowData,action:"edit"},this.parent,this.isSelfReference,this.addRowIndex,this.selectedIndex,e.columnName),t.rowIndex===this.parent.getCurrentViewRecords().length-1&&"enter"===this.keyPress&&(this.keyPress=null);var s={type:"save",column:this.parent.getColumnByField(e.columnName),data:e.rowData,previousData:e.previousValue,row:t,target:e.cell};this.parent.aggregates.map(function(e){return!0===e.showChildSummary}).length&&this.parent.grid.refresh(),this.parent.trigger(ke["b"],s)},e.prototype.lastCellTab=function(){!this.parent.grid.isEdit&&this.isOnBatch&&"tab"===this.keyPress&&"Cell"===this.parent.editSettings.mode&&(this.parent.editSettings.allowNextRowEdit?this.enableToolbarItems("edit"):(this.updateGridEditMode("Normal"),this.isOnBatch=!1,this.keyPress=null))},e.prototype.updateCell=function(e,t){this.parent.grid.editModule.updateCell(t,e.columnName,e.rowData[e.columnName]),this.parent.grid.getRowsObject()[t].data=e.rowData},e.prototype.crudAction=function(e,t){Object(je["a"])(e,this.parent,this.isSelfReference,this.addRowIndex,this.selectedIndex,t,this.addRowRecord),this.parent.parentData=[];for(var i=this.parent.grid.dataSource instanceof O["a"]?this.parent.grid.dataSource.dataSource.json:this.parent.grid.dataSource,n=0;n<i.length;n++){i[n].index=n;var r=this.parent.grid.getPrimaryKeyFieldNames()[0];e.value[r]===i[n][r]&&"add"===e.action&&(i[n].level=this.internalProperties.level,i[n].taskData=this.internalProperties.taskData,i[n].uniqueID=this.internalProperties.uniqueID,Object(w["T"])(this.internalProperties.parentItem)||(i[n].parentItem=this.internalProperties.parentItem,i[n].parentUniqueID=this.internalProperties.parentUniqueID),i[n].childRecords=this.internalProperties.childRecords),Object(w["ob"])("uniqueIDCollection."+i[n].uniqueID+".index",n,this.parent);var s=this.parent.dataSource.adaptor;(Object(Se["k"])(this.parent)||s instanceof k["f"])&&Object(w["ob"])("uniqueIDCollection."+i[n].uniqueID,i[n],this.parent),i[n].level||this.parent.parentData.push(i[n])}this.parent.enableInfiniteScrolling||"add"===e.action&&null!=this.previousNewRowPosition&&(this.parent.setProperties({editSettings:{newRowPosition:this.previousNewRowPosition}},!0),this.previousNewRowPosition=null)},e.prototype.updateIndex=function(e,t,i){for(var n=0;n<this.parent.getDataRows().length;n++){var r=i[n];if(!Object(w["T"])(r)){var s=Object(w["R"])("uniqueIDCollection."+r.uniqueID+".index",this.parent);if(r.index=s,!Object(w["T"])(r.parentItem)){var a=Object(w["R"])("uniqueIDCollection."+r.parentItem.uniqueID+".index",this.parent);r.parentItem.index=a}}}var o=-1,l=this.parent.treeColumnIndex;if(this.parent.getFrozenColumns()>0)for(var d=t[0].querySelectorAll(".e-rowcell"),c=0;c<d.length;c++)if(d[c].classList.contains("e-gridrowindex0level0")){l=c;break}for(var h=0;h<this.parent.getRows().length;h++){t[h].classList.contains("e-detailrow")||o++;var p=i[o];if(!Object(w["T"])(p)){s=p.index;var u=p.level,m=t[h];Object(w["T"])(p.parentItem)||(s=Object(w["R"])("uniqueIDCollection."+p.parentItem.uniqueID+".index",this.parent));var g=m.cells[l];if(!Object(w["T"])(g)){for(c=0;c<g.classList.length;c++){var f=g.classList[c],b=/e-gridrowindex/i,v=/e-griddetailrowindex/i,y=f.match(b),C=f.match(v);null!=y&&Object(w["gb"])([g],f),null!=C&&Object(w["gb"])([g],f)}t[h].classList.contains("e-detailrow")?Object(w["u"])([g],"e-griddetailrowindex"+s+"level"+u):Object(w["u"])([g],"e-gridrowindex"+s+"level"+u)}}}},e.prototype.beginAdd=function(){var e,t=this.addRowIndex,i=this.parent.grid.getCurrentViewRecords();"Batch"===this.parent.editSettings.mode&&(t=this.batchEditModule.getAddRowIndex(),this.selectedIndex=this.batchEditModule.getSelectedIndex(),(this.parent.getBatchChanges()[this.addedRecords].length>1||this.parent.getBatchChanges()[this.deletedRecords].length)&&(i=this.batchEditModule.getBatchRecords()));var n=this.parent.grid.getDataRows(),r=n.length?+n[0].getAttribute("aria-rowindex"):0,s=n.length?+n[n.length-1].getAttribute("aria-rowindex"):0,a=this.selectedIndex>=r&&this.selectedIndex<=s,o=this.parent.enableVirtualization&&this.addRowIndex>-1&&"-1"!==this.prevAriaRowIndex;if("Dialog"!==this.parent.editSettings.mode){if("Above"===this.parent.editSettings.newRowPosition)e="before";else if(("Below"===this.parent.editSettings.newRowPosition||"Child"===this.parent.editSettings.newRowPosition)&&(this.selectedIndex>-1||o)&&a&&(e="after",!Object(w["T"])(i[t])&&i[t].expanded))if("Batch"===this.parent.editSettings.mode&&(this.parent.getBatchChanges()[this.addedRecords].length>1||this.parent.getBatchChanges()[this.deletedRecords].length)){if(t+=Object(Se["b"])(i[t]).length,"Child"!==this.parent.editSettings.newRowPosition){var l=this.batchEditModule.getBatchChildCount();t+=l}}else t+=Object(Se["b"])(i[t]).length;if((this.selectedIndex>-1||o)&&a&&(t||"Child"===this.parent.editSettings.newRowPosition||"Below"===this.parent.editSettings.newRowPosition)){t>=n.length-1&&(t=n.length-2);var d="rows",c=this.parent.grid.contentModule[d][0],h=document.activeElement;n[t+1][e](n[0]),Object(w["ob"])("batchIndex",t+1,this.batchEditModule);var p="Above"===this.parent.editSettings.newRowPosition?t:t+1;"Batch"===this.parent.editSettings.mode&&(this.parent.grid.contentModule[d].splice(0,1),this.parent.grid.contentModule[d].splice(p,0,c));var u=this.parent.getFrozenLeftColumnsCount()>0||this.parent.getFrozenRightColumnsCount()>0;if(this.parent.frozenRows||this.parent.getFrozenColumns()||this.parent.frozenColumns||u){var m=this.parent.getMovableDataRows(),g="freezeRows",f=this.parent.grid.getRowsObject()[0];if(m[t+1][e](m[0]),u){var b=this.parent.getFrozenRightDataRows();b[t+1][e](b[0])}"Batch"===this.parent.editSettings.mode&&(this.parent.grid.contentModule[g].splice(0,1),this.parent.grid.contentModule[g].splice(p,0,f)),Object(w["ob"])("batchIndex",t+1,this.batchEditModule)}if("Row"===this.parent.editSettings.mode||"Cell"===this.parent.editSettings.mode){for(var v=this.parent.grid.getContentTable().querySelectorAll(".e-griderror"),y=0;y<v.length;y++)v[y].remove();Object(w["ob"])("errorRules",[],this.parent.grid.editModule.formObj)}o&&(this.prevAriaRowIndex="-1"),h.focus()}}if("Batch"===this.parent.editSettings.mode&&!Object(w["T"])(this.addRowIndex)&&-1!==this.addRowIndex&&(t=this.batchEditModule.getAddRowIndex(),this.selectedIndex=this.batchEditModule.getSelectedIndex(),this.parent.editModule["isAddedRowByMethod"])){var C={action:"add",data:this.parent.getBatchChanges()["addedRecords"][0],index:t,seletedRow:0};this.parent.editModule.beginAddEdit(C),this.parent.editModule.batchEditModule["batchAddRowRecord"].push(this.parent.editModule.batchEditModule["addRowRecord"]),this.parent.editModule.batchEditModule["batchAddedRecords"].push(C["data"])}},e.prototype.beginEdit=function(e){if("refresh"===e.requestType&&this.isOnBatch)e.cancel=!0;else if("Cell"!==this.parent.editSettings.mode||"beginEdit"!==e.requestType){if(this.doubleClickTarget&&(this.doubleClickTarget.classList.contains("e-treegridexpand")||this.doubleClickTarget.classList.contains("e-treegridcollapse")||this.doubleClickTarget.classList.contains("e-frame")))return e.cancel=!0,void(this.doubleClickTarget=null);if("delete"===e.requestType){var t=e.data;if(Object(w["T"])(e.data[0].uniqueID))for(var i=this.parent.getPrimaryKeyFieldNames(),n=function(n){r.parent.flatData.filter(function(r){r[i[0]]===e.data[n][i[0]]&&(t[n]=r)})},r=this,s=0;s<t.length;s++)n(s);for(s=0;s<t.length;s++){this.deleteUniqueID(t[s].uniqueID);for(var a=Object(Se["b"])(t[s]),o=0;o<a.length;o++)this.deleteUniqueID(a[o].uniqueID);e.data=e.data.concat(a)}}if("add"===e.requestType||this.isAddedRowByMethod&&(this.parent.enableVirtualization||this.parent.enableInfiniteScrolling)){if((-1===this.parent.grid.selectedRowIndex&&this.isAddedRowByMethod||e.index!==this.parent.grid.selectedRowIndex)&&0!==e.index||(this.selectedIndex=this.parent.grid.selectedRowIndex),this.parent.enableVirtualization){var l='.e-row[aria-rowindex="'+this.selectedIndex+'"]',d=void 0;this.selectedIndex>-1&&"Top"!==this.parent.editSettings.newRowPosition&&"Bottom"!==this.parent.editSettings.newRowPosition?(this.prevAriaRowIndex=this.selectedIndex.toString(),d=this.parent.getContent().querySelector(l),this.addRowIndex=d?d.rowIndex:0):this.prevAriaRowIndex&&"-1"!==this.prevAriaRowIndex?(l='.e-row[aria-rowindex="'+this.prevAriaRowIndex+'"]',d=this.parent.getContent().querySelector(l),this.addRowIndex=d?d.rowIndex:0):this.addRowIndex=0}else this.isAddedRowByMethod&&(this.parent.enableVirtualization||this.parent.enableInfiniteScrolling)?0!==e.index?this.addRowIndex=e.index:this.addRowIndex=this.parent.grid.selectedRowIndex:this.addRowIndex=this.parent.grid.selectedRowIndex>-1?this.parent.grid.selectedRowIndex:0;this.isAddedRowByMethod&&(this.parent.enableVirtualization||this.parent.enableInfiniteScrolling)?this.addRowRecord=this.parent.flatData[this.parent.grid.selectedRowIndex]:this.addRowRecord=this.parent.getSelectedRecords()[0]}this.isAddedRowByMethod&&0!==e.index&&(this.addRowRecord=this.parent.flatData[e.index],this.addRowIndex=e.index),"Child"===this.parent.editSettings.newRowPosition&&Object(w["T"])(this.addRowRecord)&&!Object(w["T"])(this.parent.getSelectedRecords()[0])&&(this.addRowRecord=this.parent.getSelectedRecords()[0]),this.isAddedRowByMethod=!1,e=this.beginAddEdit(e)}else e.cancel=!0},e.prototype.savePreviousRowPosition=function(){null===this.previousNewRowPosition&&(this.previousNewRowPosition=this.parent.editSettings.newRowPosition)},e.prototype.beginAddEdit=function(e){var t=e.data;if("add"===e.action){var i=this.parent.grid.getPrimaryKeyFieldNames()[0],n=null;t.taskData=Object(w["T"])(t.taskData)?Object(w["G"])({},e.data):t.taskData;var r=this.parent.grid.getCurrentViewRecords();this.parent.enableVirtualization&&0!==e.index&&(this.addRowIndex=this.parent.grid.getCurrentViewRecords().indexOf(this.addRowRecord),this.selectedIndex=parseInt(this.parent.getRows()[this.addRowIndex].getAttribute("aria-rowindex"),10));var s=this.addRowIndex;t.uniqueID=Object(j["T"])(this.parent.element.id+"_data_"),Object(w["ob"])("uniqueIDCollection."+t.uniqueID,t,this.parent);var a=0,o=void 0,l=void 0,d=void 0,c=void 0,h=this.parent.enableVirtualization&&this.addRowIndex>-1&&"-1"!==this.prevAriaRowIndex,p=this.parent.getRows(),u=p.length?r.indexOf(r[0]):0,m=p.length?+p[p.length-1].getAttribute("aria-rowindex"):0,g=this.selectedIndex>=u&&this.selectedIndex<=m;if(r.length&&(o=r[this.addRowIndex][this.parent.idMapping],c=r[this.addRowIndex][this.parent.parentIdMapping],r[this.addRowIndex].parentItem&&(l=r[this.addRowIndex].parentItem.uniqueID),d=r[this.addRowIndex].parentItem),"Top"!==this.parent.editSettings.newRowPosition&&r.length){if(a=r[this.addRowIndex].level,"Above"===this.parent.editSettings.newRowPosition)n="before",s=r[this.addRowIndex].index;else if("Below"===this.parent.editSettings.newRowPosition){n="after";var f=Object(Se["b"])(r[this.addRowIndex]).length,b=r[this.addRowIndex].index;s=f>0?b+f:b}else if("Child"===this.parent.editSettings.newRowPosition){n="after",(this.selectedIndex>-1||h)&&g&&(t.parentItem=Object(w["G"])({},r[this.addRowIndex]),t.parentUniqueID=t.parentItem.uniqueID,delete t.parentItem.childRecords,delete t.parentItem[this.parent.childMapping]);var v=Object(Se["b"])(r[this.addRowIndex]).length,y=r[this.addRowIndex].index;this.selectedIndex>=0&&(t.level=a+1),s=v>0?y+v:y,this.isSelfReference&&(t.taskData[this.parent.parentIdMapping]=t[this.parent.parentIdMapping]=o,Object(w["T"])(t.parentItem)||Object(je["b"])(i,t.parentItem,"add",this.parent,this.isSelfReference,t))}if("Above"!==this.parent.editSettings.newRowPosition&&"Below"!==this.parent.editSettings.newRowPosition||((this.selectedIndex>-1||h)&&a&&g&&(t.parentUniqueID=l,t.parentItem=Object(w["G"])({},d),delete t.parentItem.childRecords,delete t.parentItem[this.parent.childMapping]),t.level=a,this.isSelfReference&&(t.taskData[this.parent.parentIdMapping]=t[this.parent.parentIdMapping]=c,Object(w["T"])(t.parentItem)||Object(je["b"])(i,t.parentItem,"add",this.parent,this.isSelfReference,t))),null!=n&&(this.selectedIndex>-1||h)&&g&&(e.index="before"===n?s:s+1),"Bottom"===this.parent.editSettings.newRowPosition){var C=this.parent.grid.dataSource instanceof O["a"]?this.parent.grid.dataSource.dataSource.json:this.parent.grid.dataSource;e.index=C.length}}Object(w["T"])(t.level)&&(t.level=a),t.hasChildRecords=!1,t.childRecords=[],t.index=0}if("add"===e.action&&(this.internalProperties={level:t.level,parentItem:t.parentItem,uniqueID:t.uniqueID,taskData:t.taskData,parentUniqueID:Object(w["T"])(t.parentItem)?void 0:t.parentItem.uniqueID,childRecords:t.childRecords}),"delete"===e.requestType)for(var T=e.data,k=0;k<T.length;k++)if(T[k].parentItem){d=Object(Se["d"])(this.parent,T[k].parentItem.uniqueID);if(!Object(w["T"])(d)&&d.hasChildRecords){var S=d.childRecords.indexOf(T[k]);d.childRecords.splice(S,1)}}return e},e.prototype.addRecord=function(e,t,i){if(this.parent.editSettings.newRowPosition!==this.previousNewRowPosition&&null!==this.previousNewRowPosition||(this.previousNewRowPosition=this.parent.editSettings.newRowPosition),this.isSelfReference||Object(w["T"])(e)||!Object.hasOwnProperty.call(e,this.parent.childMapping))e?(t>-1?(this.selectedIndex=t,this.addRowIndex=t):(this.selectedIndex=this.parent.selectedRowIndex,this.addRowIndex=this.parent.selectedRowIndex),i&&this.parent.setProperties({editSettings:{newRowPosition:i}},!0),this.parent.grid.editModule.addRecord(e,t)):this.parent.grid.editModule.addRecord(e,t);else{var n=[],r=this.parent.editSettings.mode,s=this.parent.grid.editSettings.mode;n.push(e),this.parent.setProperties({editSettings:{mode:"Batch"}},!0),this.parent.grid.setProperties({editSettings:{mode:"Batch"}},!0),Object(w["T"])(i)||this.parent.setProperties({editSettings:{newRowPosition:i}},!0);var a={addedRecords:n,changedRecords:[],deletedRecords:[]};this.parent.notify(ke["g"],{updatedRecords:a,index:t}),this.parent.setProperties({editSettings:{mode:r}},!0),this.parent.grid.setProperties({editSettings:{mode:s}},!0),this.parent.refresh()}},e.prototype.editFormValidate=function(){return this.parent.grid.editModule.editFormValidate()},e.prototype.destroyForm=function(){this.parent.grid.editModule.destroyForm()},e.prototype.contentready=function(e){Object(w["T"])(e.args.requestType)||"delete"!==e.args.requestType.toString()&&"save"!==e.args.requestType.toString()&&("Batch"!==this.parent.editSettings.mode||"batchsave"!==e.args.requestType.toString())||(this.updateIndex(this.parent.grid.dataSource,this.parent.getRows(),this.parent.getCurrentViewRecords()),(this.parent.frozenRows||this.parent.getFrozenColumns()||this.parent.frozenColumns)&&this.parent.grid.dataSource.length===this.parent.getMovableDataRows().length&&this.updateIndex(this.parent.grid.dataSource,this.parent.getMovableDataRows(),this.parent.getCurrentViewRecords()))},e.prototype.editCell=function(e,t){"Cell"!==this.parent.editSettings.mode&&"Batch"!==this.parent.editSettings.mode||("Batch"!==this.parent.editSettings.mode&&(this.isOnBatch=!0,this.updateGridEditMode("Batch")),this.parent.grid.editModule.editCell(e,t))},e}(),Ee=function(){function e(e){this.isCellEdit=!1,this.isResourceCellEdited=!1,this.parent=e,this.bindTreeGridProperties()}return e.prototype.bindTreeGridProperties=function(){this.parent.treeGrid.editSettings.allowEditing=this.parent.editSettings.allowEditing,this.parent.treeGrid.editSettings.allowNextRowEdit=this.parent.editSettings.allowNextRowEdit,this.parent.treeGrid.editSettings.mode="Cell",this.parent.treeGrid.cellEdit=this.ensureEditCell.bind(this),this.parent.editSettings.allowEditing&&D["a"].Inject(De)},e.prototype.ensureEditCell=function(e){var t=this,i=e.rowData,n=e.columnName;this.editedColumn=this.parent.getColumnByField(n,this.parent.ganttColumns);var r=this.parent.taskFields;if(this.parent.readOnly)e.cancel=!0;else if("Dialog"!==this.parent.editSettings.mode){if(!i.hasChildRecords||(n!==r.endDate||(Object(w["T"])(i["isManual"])||!1!==i["isManual"])&&"Auto"!==this.parent.taskMode)&&n!==r.duration&&n!==r.dependency&&n!==r.progress&&n!==r.work&&"taskType"!==n){var s=new O["b"];return this.parent.trigger("cellEdit",e,function(e){0===i.level&&"ResourceView"===t.parent.viewType&&(e.cancel=!0),s.resolve(e),e.cancel||(e.columnName===t.parent.taskFields.notes?t.openNotesEditor(e):(t.isCellEdit=!0,Object(w["T"])(t.parent.toolbarModule)||t.parent.toolbarModule.refreshToolbarItems()))}),s}e.cancel=!0}else e.cancel=!0},e.prototype.openNotesEditor=function(e){var t=this.parent.taskFields,i=e.rowData,n=e.columnName;if(n===t.notes&&!this.parent.showInlineNotes){e.cancel=!0;var r=this.parent.editModule.dialogModule.updatedEditFields.map(function(e){return e.type}),s=r.indexOf("Notes");if(-1!==s){this.parent.editModule.dialogModule.openEditDialog(i.ganttProperties.rowUniqueID);var a=document.getElementById(this.parent.element.id+"_Tab").ej2_instances[0];a.selectedItem=s}}n===t.notes&&!0===this.parent.showInlineNotes&&(this.isCellEdit=!0)},e.prototype.isValueChange=function(e,t){var i=Object(w["R"])("data",e),n=i[t],r=Object(w["R"])("previousData",e);if(Object(w["T"])(n)&&!Object(w["T"])(r)||!Object(w["T"])(n)&&Object(w["T"])(r))return!0;if(!Object(w["T"])(n)&&!Object(w["T"])(r)){if(n instanceof Date)return n.getTime()!==i.taskData[t].getTime();if(t===this.parent.taskFields.resourceInfo)return n!==r;if(n!==i.taskData[t])return!0}return!1},e.prototype.initiateCellEdit=function(e,t){var i=Object(w["R"])("column",e),n=Object(w["R"])("data",e),r={action:"CellEditing"};r.data=this.parent.getTaskByUniqueID(n.uniqueID);var s=Object(w["R"])("previousData",e),a=this.parent.allowUnscheduledTasks?n[i.field]:!Object(w["T"])(n[i.field])&&""!==n[i.field]||this.parent.taskFields.duration!==i.field&&this.parent.taskFields.startDate!==i.field&&this.parent.taskFields.endDate!==i.field?n[i.field]:s;Object(w["T"])(n)?this.parent.editModule.endEditAction(e):(n[i.field]=s,r.data[i.field]=s,this.parent.initiateEditAction(!0),this.parent.setRecordValue(i.field,a,r.data),i.field===this.parent.taskFields.name?this.taskNameEdited(r):i.field===this.parent.taskFields.startDate?this.startDateEdited(r):i.field===this.parent.taskFields.endDate?this.endDateEdited(r):i.field===this.parent.taskFields.duration?this.durationEdited(r):i.field===this.parent.taskFields.resourceInfo?this.resourceEdited(r,t,n):i.field===this.parent.taskFields.progress?this.progressEdited(r):i.field===this.parent.taskFields.baselineStartDate||i.field===this.parent.taskFields.baselineEndDate?this.baselineEdited(r):i.field===this.parent.taskFields.dependency?this.dependencyEdited(r,s):i.field===this.parent.taskFields.notes?this.notedEdited(r):i.field===this.parent.taskFields.work?this.workEdited(r):"taskType"!==i.field||Object(w["T"])(this.parent.taskFields.work)?i.field===this.parent.taskFields.manual?this.taskmodeEdited(r):(this.parent.setRecordValue("taskData."+i.field,r.data[i.field],r.data),this.parent.editModule.initiateSaveAction(r)):this.typeEdited(r,t)),this.isCellEdit=!1,Object(w["T"])(this.parent.toolbarModule)||this.parent.toolbarModule.refreshToolbarItems()},e.prototype.taskNameEdited=function(e){this.parent.setRecordValue("taskData."+this.parent.taskFields.name,e.data[this.parent.taskFields.name],e.data),this.parent.setRecordValue("taskName",e.data[this.parent.taskFields.name],e.data.ganttProperties,!0),this.updateEditedRecord(e)},e.prototype.notedEdited=function(e){this.parent.setRecordValue("taskData."+this.parent.taskFields.notes,e.data[this.parent.taskFields.notes],e.data),this.parent.setRecordValue("notes",e.data[this.parent.taskFields.notes],e.data.ganttProperties,!0),this.updateEditedRecord(e)},e.prototype.taskmodeEdited=function(e){this.parent.setRecordValue("isAutoSchedule",!e.data[this.parent.taskFields.manual],e.data.ganttProperties,!0),this.parent.editModule.updateTaskScheduleModes(e.data),this.updateEditedRecord(e)},e.prototype.startDateEdited=function(e){var t=e.data,i=e.data.ganttProperties,n=e.data[this.parent.taskFields.startDate];n=n?new Date(n.getTime()):null,n=this.parent.dateValidationModule.checkStartDate(n,t.ganttProperties,t.ganttProperties.isMilestone),Object(w["T"])(n)?t.hasChildRecords||(this.parent.setRecordValue("startDate",null,i,!0),this.parent.setRecordValue("duration",null,i,!0),this.parent.setRecordValue("isMilestone",!1,i,!0),this.parent.allowUnscheduledTasks&&Object(w["T"])(this.parent.taskFields.endDate)&&this.parent.setRecordValue("endDate",null,i,!0)):i.endDate||!Object(w["T"])(i.duration)?(this.parent.setRecordValue("startDate",new Date(n.getTime()),i,!0),this.parent.dateValidationModule.calculateEndDate(t)):Object(w["T"])(i.endDate)&&Object(w["T"])(i.duration)&&this.parent.setRecordValue("startDate",new Date(n.getTime()),i,!0),this.parent.setRecordValue("isMilestone",0===i.duration,i,!0),this.parent.dataOperation.updateWidthLeft(e.data),this.parent.dataOperation.updateMappingData(t,"startDate"),this.parent.dataOperation.updateMappingData(t,"endDate"),this.parent.dataOperation.updateMappingData(t,"duration"),this.updateEditedRecord(e)},e.prototype.validateEndDateWithSegments=function(e){for(var t=[],i=e.segments,n=0;n<i.length;n++){var r=i[n],s=r.endDate;s=!Object(w["T"])(e.endDate)&&s.getTime()<e.endDate.getTime()&&n!==i.length-1?s:e.endDate,r.duration=this.parent.dataOperation.getDuration(r.startDate,s,e.durationUnit,e.isAutoSchedule,e.isMilestone),i.length>0&&s.getTime()<r.startDate.getTime()&&s.getTime()<=e.endDate.getTime()?i[n-1].duration=this.parent.dataOperation.getDuration(i[n-1].startDate,e.endDate,e.durationUnit,e.isAutoSchedule,e.isMilestone):t.push(r)}return t},e.prototype.endDateEdited=function(e){var t=e.data.ganttProperties,i=e.data[this.parent.taskFields.endDate];i=i?new Date(i.getTime()):null,Object(w["T"])(i)?(this.parent.setRecordValue("endDate",i,t,!0),this.parent.setRecordValue("duration",null,t,!0),this.parent.setRecordValue("isMilestone",!1,t,!0)):(0===i.getHours()&&86400!==this.parent.defaultEndTime&&this.parent.dateValidationModule.setTime(this.parent.defaultEndTime,i),i=this.parent.dateValidationModule.checkEndDate(i,t),this.parent.setRecordValue("endDate",i,t,!0),!Object(w["T"])(t.startDate)&&Object(w["T"])(t.duration)?-1===this.parent.dateValidationModule.compareDates(t.endDate,t.startDate)&&(this.parent.setRecordValue("endDate",new Date(t.startDate.getTime()),t,!0),this.parent.dateValidationModule.setTime(this.parent.defaultEndTime,t.endDate)):!Object(w["T"])(t.duration)&&Object(w["T"])(t.startDate)&&this.parent.setRecordValue("startDate",this.parent.dateValidationModule.getStartDate(t.endDate,t.duration,t.durationUnit,t),t,!0),Object(w["T"])(t.segments)||(t.segments=this.validateEndDateWithSegments(t)),-1===this.compareDatesFromRecord(t)?this.parent.dateValidationModule.calculateDuration(e.data):this.parent.editModule.revertCellEdit(e),this.parent.setRecordValue("isMilestone",0===t.duration,t,!0),t.isMilestone&&this.parent.setRecordValue("startDate",this.parent.dateValidationModule.checkStartDate(t.startDate,t),t,!0)),!Object(w["T"])(e.data.ganttProperties.segments)&&e.data.ganttProperties.segments.length>0&&(this.parent.setRecordValue("segments",this.parent.dataOperation.setSegmentsInfo(e.data,!1),e.data.ganttProperties,!0),this.parent.dataOperation.updateMappingData(e.data,"segments")),this.parent.dataOperation.updateWidthLeft(e.data),this.parent.dataOperation.updateMappingData(e.data,"startDate"),this.parent.dataOperation.updateMappingData(e.data,"endDate"),this.parent.dataOperation.updateMappingData(e.data,"duration"),this.parent.editModule.updateResourceRelatedFields(e.data,"endDate"),this.updateEditedRecord(e)},e.prototype.durationEdited=function(e){var t=e.data.ganttProperties,i=e.data[this.parent.taskFields.duration];this.parent.dataOperation.updateDurationValue(i,t),this.updateDates(e),this.parent.editModule.updateResourceRelatedFields(e.data,"duration"),this.updateEditedRecord(e)},e.prototype.updateDates=function(e){var t=e.data.ganttProperties,i=this.parent.dateValidationModule.getDateFromFormat(t.endDate),n=this.parent.dateValidationModule.getDateFromFormat(t.startDate),r=t.duration;Object(w["T"])(r)?(this.parent.setRecordValue("isMilestone",!1,t,!0),null!=e.data[this.parent.taskFields.duration]&&this.parent.setRecordValue("endDate",null,t,!0)):(Object(w["T"])(n)&&!Object(w["T"])(i)&&this.parent.setRecordValue("startDate",this.parent.dateValidationModule.getStartDate(i,r,t.durationUnit,t),t,!0),0!==r&&t.isMilestone&&(this.parent.setRecordValue("isMilestone",!1,t,!0),this.parent.setRecordValue("startDate",this.parent.dateValidationModule.checkStartDate(t.startDate,t),t,!0)),!Object(w["T"])(t.segments)&&t.segments.length>0&&(this.parent.setRecordValue("segments",this.parent.dataOperation.setSegmentsInfo(e.data,!1),t,!0),this.parent.dataOperation.updateMappingData(e.data,"segments")),this.parent.setRecordValue("isMilestone",0===t.duration,t,!0),this.parent.dateValidationModule.calculateEndDate(e.data)),this.parent.dataOperation.updateWidthLeft(e.data),this.parent.dataOperation.updateMappingData(e.data,"endDate"),this.parent.dataOperation.updateMappingData(e.data,"startDate"),this.parent.dataOperation.updateMappingData(e.data,"duration")},e.prototype.progressEdited=function(e){var t=e.data;if(this.parent.setRecordValue("progress",t[this.parent.taskFields.progress]>100?100:t[this.parent.taskFields.progress],t.ganttProperties,!0),this.parent.setRecordValue("taskData."+this.parent.taskFields.progress,t[this.parent.taskFields.progress]>100?100:t[this.parent.taskFields.progress],e.data),t.ganttProperties.isAutoSchedule||this.parent.setRecordValue("autoWidth",this.parent.dataOperation.calculateWidth(t,!1),t.ganttProperties,!0),!Object(w["T"])(e.data.ganttProperties.segments)&&e.data.ganttProperties.segments.length>0&&!Object(w["T"])(this.parent.editModule.taskbarEditModule)&&this.parent.editModule.taskbarEditModule.updateSegmentProgress(e.data.ganttProperties),!e.data.hasChildRecords){var i=t.ganttProperties.isAutoSchedule?t.ganttProperties.width:t.ganttProperties.autoWidth;this.parent.setRecordValue("progressWidth",this.parent.dataOperation.getProgressWidth(i,t.ganttProperties.progress),t.ganttProperties,!0)}this.updateEditedRecord(e)},e.prototype.baselineEdited=function(e){var t=e.data.ganttProperties,i=e.data[this.parent.taskFields.baselineStartDate],n=e.data[this.parent.taskFields.baselineEndDate];n&&0===n.getHours()&&86400!==this.parent.defaultEndTime&&this.parent.dateValidationModule.setTime(this.parent.defaultEndTime,n),this.parent.setRecordValue("baselineStartDate",this.parent.dateValidationModule.checkBaselineStartDate(i),t,!0),this.parent.setRecordValue("baselineEndDate",this.parent.dateValidationModule.checkBaselineEndDate(n),t,!0),t.baselineStartDate&&t.baselineEndDate&&(this.parent.setRecordValue("baselineLeft",this.parent.dataOperation.calculateBaselineLeft(t),t,!0),this.parent.setRecordValue("baselineWidth",this.parent.dataOperation.calculateBaselineWidth(t),t,!0)),this.updateEditedRecord(e)},e.prototype.resourceEdited=function(e,t,i){var n=this.parent.resourceFields,r=t[this.parent.taskFields.resourceInfo];if(r){this.isResourceCellEdited=!0;for(var s=this.parent.dataOperation.setResourceInfo(t),a=s.length,o=i.ganttProperties.resourceInfo,l=void 0,d=[],c=this.parent.resources,h=void 0,p=function(e){if(o){var t=o.length;for(h=0;h<t;h++){if(o[h][n.id]===r[e]){l=h;break}l=-1}}if(Object(w["T"])(l)||-1===l){var i=c.filter(function(t){return r[e]===t[n.id]}),s=Object(w["G"])({},i[0]);s[n.unit]=100,d.push(s)}else d.push(o[l])},u=0;u<a;u++)p(u);e.data.ganttProperties.resourceInfo=d,this.parent.dataOperation.updateMappingData(e.data,"resourceInfo"),this.parent.editModule.updateResourceRelatedFields(e.data,"resource"),"ResourceView"===this.parent.viewType&&(this.parent.editModule.dialogModule.isResourceUpdate=!0,this.parent.editModule.dialogModule.previousResource=o),this.updateDates(e),this.updateEditedRecord(e)}},e.prototype.dependencyEdited=function(e,t){this.parent.predecessorModule.updateUnscheduledDependency(e.data),this.parent.connectorLineEditModule.updatePredecessor(e.data,e.data[this.parent.taskFields.dependency],e)||this.parent.editModule.revertCellEdit(t)},e.prototype.workEdited=function(e){var t=e.data.ganttProperties,i=e.data[this.parent.taskFields.work];this.parent.setRecordValue("work",i,t,!0),this.parent.editModule.updateResourceRelatedFields(e.data,"work"),this.updateDates(e),this.updateEditedRecord(e)},e.prototype.typeEdited=function(e,t){var i="taskType",n=e.data.ganttProperties,r=t[i];this.parent.setRecordValue("taskType",r,n,!0),this.updateEditedRecord(e)},e.prototype.compareDatesFromRecord=function(e){var t=this.parent.dateValidationModule.getValidStartDate(e),i=this.parent.dateValidationModule.getValidEndDate(e);return this.parent.dateValidationModule.compareDates(t,i)},e.prototype.updateEditedRecord=function(e){this.parent.editModule.initiateUpdateAction(e)},e.prototype.destroy=function(){this.parent.editModule.cellEditModule=void 0},e}(),Ie=i("fe79"),xe=i("cc2f"),Me=i("08bc"),Pe=function(){function e(e,t){this.parent=e,this.taskbarEdit=t}return e.prototype.createTooltip=function(e,t,i){var n=this;this.toolTipObj=new Me["a"]({opensOn:e,position:"TopRight",mouseTrail:t,cssClass:xe["Z"],target:i||null,animation:{open:{effect:"None"},close:{effect:"None"}}}),this.toolTipObj.beforeRender=function(e){var t={data:n.taskbarEdit.taskBarEditRecord,args:e,content:n.toolTipObj.content};n.parent.trigger("beforeTooltipRender",t)},this.toolTipObj.afterOpen=function(e){n.updateTooltipPosition(e)},this.toolTipObj.isStringTemplate=!0,this.toolTipObj.appendTo(this.parent.chartPane)},e.prototype.updateTooltipPosition=function(e){var t=this.parent.getOffsetRect(this.parent.chartPane),i=t.left+this.parent.chartPane.offsetWidth,n=e.element.offsetLeft;i<n+e.element.offsetWidth&&(n+=i-(n+e.element.offsetWidth)),e.element.style.left=n+"px",e.element.style.visibility="visible"},e.prototype.showHideTaskbarEditTooltip=function(e,t){e&&this.parent.tooltipSettings.showTooltip?(this.createTooltip("Custom",!1),this.parent.tooltipModule.toolTipObj.close(),this.updateTooltip(t),"ConnectorPointLeftDrag"===this.taskbarEdit.connectorSecondAction?this.toolTipObj.open(this.taskbarEdit.connectorSecondElement.querySelector("."+xe["G"])):"ConnectorPointRightDrag"===this.taskbarEdit.connectorSecondAction?this.toolTipObj.open(this.taskbarEdit.connectorSecondElement.querySelector("."+xe["I"])):this.toolTipObj.open(this.taskbarEdit.taskBarEditElement)):Object(w["T"])(this.toolTipObj)||(this.toolTipObj.destroy(),this.toolTipObj=null)},e.prototype.updateTooltip=function(e){var t=this.taskbarEdit.taskBarEditRecord.ganttProperties,i=-1===e?t.width:t.segments[e].width,n=-1===e?t.progressWidth:t.segments[e].progressWidth,r=-1===e?t.left:t.left+t.segments[e].left;Object(w["T"])(this.toolTipObj)||("ConnectorPointLeftDrag"===this.taskbarEdit.taskBarEditAction||"ConnectorPointRightDrag"===this.taskbarEdit.taskBarEditAction?(this.toolTipObj.content=this.getTooltipText(e),this.toolTipObj.offsetY=-3):(this.toolTipObj.content=this.getTooltipText(e),this.toolTipObj.refresh(this.taskbarEdit.taskBarEditElement),"LeftResizing"===this.taskbarEdit.taskBarEditAction?this.toolTipObj.offsetX=-i:"RightResizing"===this.taskbarEdit.taskBarEditAction||"ParentResizing"===this.taskbarEdit.taskBarEditAction?this.toolTipObj.offsetX=0:"ProgressResizing"===this.taskbarEdit.taskBarEditAction?this.toolTipObj.offsetX=-(i-n):"MilestoneDrag"===this.taskbarEdit.taskBarEditAction?this.toolTipObj.offsetX=-this.parent.chartRowsModule.milestoneHeight/2:i>5&&(this.toolTipObj.offsetX=-(i+r-this.taskbarEdit.tooltipPositionX))))},e.prototype.getTooltipText=function(e){var t="",i=this.parent.globalize,n=this.taskbarEdit.taskBarEditRecord.ganttProperties;if(!Object(w["T"])(n.segments)&&n.segments.length>0&&-1!==e&&"ProgressResizing"!==this.taskbarEdit.taskBarEditAction&&(n=n.segments[e]),this.parent.tooltipSettings.editing){var r=this.parent.tooltipModule.templateCompiler(this.parent.tooltipSettings.editing,this.parent,this.taskbarEdit.taskBarEditRecord,"TooltipEditingTemplate");Object(w["R"])("tooltipEle",this.toolTipObj)&&this.parent.renderTemplates(),t=r[0]}else{var s=void 0,a=void 0,o=void 0;switch(Object(w["T"])(n.startDate)||(s='<tr><td class = "e-gantt-tooltip-label">'+this.parent.localeObj.getConstant("startDate")+'</td><td>:</td><td class = "e-gantt-tooltip-value">'+i.formatDate(n.startDate,{format:this.parent.getDateFormat()})+"</td></tr>"),Object(w["T"])(n.endDate)||(a='<tr><td class = "e-gantt-tooltip-label">'+this.parent.localeObj.getConstant("endDate")+'</td><td>:</td><td class = "e-gantt-tooltip-value">'+i.formatDate(n.endDate,{format:this.parent.getDateFormat()})+"</td></tr>"),Object(w["T"])(n.duration)||(o='<tr><td class = "e-gantt-tooltip-label">'+this.parent.localeObj.getConstant("duration")+'</td><td>:</td><td class = "e-gantt-tooltip-value">'+this.parent.getDurationString(n.duration,n.durationUnit)+"</td></tr>"),this.taskbarEdit.taskBarEditAction){case"ProgressResizing":var l='<tr><td class = "e-gantt-tooltip-label">'+this.parent.localeObj.getConstant("progress")+'</td><td>:</td><td class = "e-gantt-tooltip-value">'+n.progress+"</td></tr>";t='<table class = "e-gantt-tooltiptable"><tbody>'+l+"</tbody></table>";break;case"LeftResizing":t='<table class = "e-gantt-tooltiptable"><tbody>'+s+o+"</tbody></table>";break;case"RightResizing":case"ParentResizing":t='<table class = "e-gantt-tooltiptable"><tbody>'+a+o+"</tbody></table>";break;case"ChildDrag":case"ParentDrag":case"MilestoneDrag":case"ManualParentDrag":var d="",c="";Object(w["T"])(this.taskbarEdit.taskBarEditRecord.ganttProperties.startDate)||(d=s),Object(w["T"])(this.taskbarEdit.taskBarEditRecord.ganttProperties.endDate)||(c=a),t='<table class = "e-gantt-tooltiptable"><tbody>'+d+c+"</tbody></table>";break;case"ConnectorPointLeftDrag":case"ConnectorPointRightDrag":t=this.parent.connectorLineModule.tooltipTable,Object(w["T"])(this.toolTipObj)&&(this.parent.connectorLineModule.tooltipTable.innerHTML=this.parent.connectorLineModule.getConnectorLineTooltipInnerTd(this.parent.editModule.taskbarEditModule.taskBarEditRecord.ganttProperties.taskName,this.parent.editModule.taskbarEditModule.fromPredecessorText,"",""));break}}return t},e}(),Le=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Ne=function(){return Ne=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i],t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},Ne.apply(this,arguments)},Ae=function(e){function t(t){var i=e.call(this,t)||this;return i.isMouseDragged=!1,i.dependencyCancel=!1,i.editElement=null,i.elementOffsetLeft=0,i.elementOffsetTop=0,i.elementOffsetWidth=0,i.elementOffsetHeight=0,i.segmentIndex=-1,i.parent=t,i.initPublicProp(),i.wireEvents(),i.editTooltip=new Pe(i.parent,i),i}return Le(t,e),t.prototype.wireEvents=function(){this.parent.on("chartMouseDown",this.mouseDownHandler,this),this.parent.on("chartMouseUp",this.mouseUpHandler,this),this.parent.on("chartMouseLeave",this.mouseLeaveHandler,this),this.parent.on("chartMouseMove",this.mouseMoveAction,this),this.parent.on("chartMouseClick",this.mouseClickHandler,this)},t.prototype.initPublicProp=function(){this.taskBarEditElement=null,this.taskBarEditRecord=null,this.taskBarEditAction=null,this.connectorSecondElement=null,this.connectorSecondRecord=null,this.connectorSecondAction=null,this.highlightedSecondElement=null,this.fromPredecessorText=null,this.toPredecessorText=null,this.finalPredecessor=null,this.drawPredecessor=!1,this.roundOffDuration=!0,this.dragMouseLeave=!1,this.isMouseDragged=!1,this.previousItemProperty=["left","progress","duration","isMilestone","startDate","endDate","width","progressWidth","autoLeft","autoDuration","autoStartDate","autoEndDate","autoWidth","segments"],this.tapPointOnFocus=!1,this.touchEdit=!1},t.prototype.mouseDownHandler=function(e){if(this.parent.editSettings.allowTaskbarEditing&&!this.parent.readOnly)if(this.canDrag=!1,this.parent.isAdaptive&&this.taskBarEditElement){var t=this.getElementByPosition(e),i=Object(R["i"])(t,xe["Vb"]);!i||i.innerHTML!==this.taskBarEditElement.innerHTML||t.classList.contains(xe["G"])||t.classList.contains(xe["I"])||this.tapPointOnFocus||(this.updateTaskBarEditElement(e),this.canDrag=!0,e.preventDefault())}else this.parent.isAdaptive||this.updateTaskBarEditElement(e)},t.prototype.mouseClickHandler=function(e){var t=this.getElementByPosition(e),i=Object(R["i"])(t,xe["Vb"]);this.parent.selectionModule&&this.parent.selectionModule.enableSelectMultiTouch?this.tapPointOnFocus&&this.updateTaskBarEditElement(e):this.tapPointOnFocus&&i&&i.innerHTML!==this.taskBarEditElement.innerHTML?(this.connectorSecondRecord=this.parent.ganttChartModule.getRecordByTaskBar(i),this.connectorSecondAction="ConnectorPointLeftDrag",this.connectorSecondElement=i,this.fromPredecessorText="Finish",this.validateConnectorPoint()&&this.taskBarEditingAction(e,!0),this.showHideActivePredecessors(!1),this.initPublicProp()):t.classList.contains(xe["H"])||t.classList.contains(xe["J"])?(this.canDrag=!1,this.multipleSelectionEnabled(),this.showHideTaskBarEditingElements(t,this.taskBarEditElement),this.tapPointOnFocus=!0,this.taskBarEditAction="ConnectorPointRightDrag",this.connectorSecondRecord=this.taskBarEditRecord,this.taskBarEditingAction(e,!1)):(this.tapPointOnFocus&&(this.showHideActivePredecessors(!1),this.showHideTaskBarEditingElements(i,this.taskBarEditElement)),this.updateTaskBarEditElement(e))},t.prototype.showHideActivePredecessors=function(e){var t=this.taskBarEditRecord.ganttProperties,i=t.predecessor,n="ResourceView"===this.parent.viewType?t.taskId:t.rowUniqueID;if(i)for(var r=0;r<i.length;r++){var s=i[r];n.toString()!==s.from&&n.toString()!==s.to||this.applyActiveColor(s.from,s.to,e)}var a=this.parent.ganttChartModule.chartBodyContainer;e?(Object(w["u"])([this.taskBarEditElement],[xe["a"]]),Object(w["u"])([a],[xe["ic"]])):(Object(w["gb"])([this.taskBarEditElement],[xe["a"]]),Object(w["gb"])([a],[xe["ic"]])),this.touchEdit=e,Object(w["T"])(this.parent.toolbarModule)||this.parent.toolbarModule.refreshToolbarItems()},t.prototype.applyActiveColor=function(e,t,i){var n="ProjectView"===this.parent.viewType?this.taskBarEditRecord.ganttProperties.taskId.toString():this.taskBarEditRecord.ganttProperties.rowUniqueID.toString(),r=n===e?this.parent.connectorLineModule.getRecordByID(t):this.parent.connectorLineModule.getRecordByID(e),s=this.parent.ganttChartModule.getChartRows()[this.parent.currentViewData.indexOf(r)];if(!Object(w["T"])(s)){var a=s.querySelector("."+xe["Vb"]),o=this.parent.element.querySelector("#ConnectorLineparent"+e+"child"+t);i?(Object(w["u"])([a],[xe["b"]]),o&&Object(w["u"])([o],[xe["b"]])):(Object(w["gb"])([a],[xe["b"]]),o&&Object(w["gb"])([o],[xe["b"]]))}},t.prototype.validateConnectorPoint=function(){var e=this.taskBarEditRecord.ganttProperties,t=this.connectorSecondRecord.ganttProperties,i=!0,n="ResourceView"===this.parent.viewType?e.taskId:e.rowUniqueID,r="ResourceView"===this.parent.viewType?t.taskId:t.rowUniqueID;if(this.connectorSecondRecord.hasChildRecords)i=!1;else if(t.predecessor)for(var s=0;s<t.predecessor.length;s++){var a=t.predecessor[s];if(a.from===n.toString()&&a.to===r.toString()){this.parent.connectorLineEditModule.childRecord=this.connectorSecondRecord,this.parent.connectorLineEditModule.predecessorIndex=s,this.parent.connectorLineEditModule.renderPredecessorDeleteConfirmDialog(),i=!1;break}if(a.from===r.toString()&&a.to===n.toString()){this.parent.connectorLineEditModule.childRecord=this.taskBarEditRecord,this.parent.connectorLineEditModule.predecessorIndex=s,this.parent.connectorLineEditModule.renderPredecessorDeleteConfirmDialog(),i=!1;break}}return i},t.prototype.mouseLeaveHandler=function(e){this.dragMouseLeave=!0},t.prototype.updateTaskBarEditElement=function(e){var t,i=this.getElementByPosition(e);if(i.classList.contains(xe["sb"])||i.classList.contains(xe["ob"])||i.classList.contains(xe["tb"]))t=Object(R["i"])(i,xe["ob"]);else if(i.classList.contains(xe["rb"])||i.classList.contains(xe["qb"])||i.classList.contains(xe["pb"]))t=Object(R["i"])(i,xe["pb"]);else if(t=Object(R["i"])(i,xe["Vb"]),!Object(w["T"])(t)&&!i.classList.contains("e-connectorpoint-left")&&!i.classList.contains("e-connectorpoint-right")){var n=this.parent.ganttChartModule.getRecordByTaskBar(t);!Object(w["T"])(n.ganttProperties.segments)&&n.ganttProperties.segments.length>0&&(t=Object(R["i"])(i,xe["u"]))}if(this.parent.editSettings.allowTaskbarEditing&&t){this.showHideTaskBarEditingElements(t,this.taskBarEditElement),this.editElement=t,this.taskBarEditElement=t;var r=this.taskBarEditElement.getAttribute("data-segment-index");if(Object(w["T"])(r)?this.segmentIndex=-1:this.segmentIndex=Number(r),this.taskBarEditRecord=this.parent.ganttChartModule.getRecordByTaskBar(this.taskBarEditElement),("mousedown"===e.type||"touchstart"===e.type||"click"===e.type)&&(this.roundOffDuration=!0,this.taskBarEditAction=this.getTaskBarAction(e),"ConnectorPointLeftDrag"!==this.taskBarEditAction&&"ConnectorPointRightDrag"!==this.taskBarEditAction||!Object(w["T"])(this.parent.taskFields.dependency)||(this.taskBarEditAction=null),this.updateMouseDownProperties(e),"ResourceView"===this.parent.viewType)){if(0===this.taskBarEditRecord.level)return;if(this.parent.enableMultiTaskbar){var s=this.parent.getTaskByUniqueID(this.taskBarEditRecord.parentItem.uniqueID);Object(w["T"])(s)||s.expanded||(this.prevZIndex=this.taskBarEditElement.style.zIndex,this.taskBarEditElement.style.zIndex="1000",Object(w["u"])([this.taskBarEditElement.querySelector(".e-gantt-child-taskbar")],"e-collapsed-taskbar-drag"))}}}else this.parent.isAdaptive?(this.taskBarEditElement&&this.showHideTaskBarEditingElements(t,this.taskBarEditElement),this.initPublicProp()):this.showHideTaskBarEditingElements(t,this.taskBarEditElement)},t.prototype.showHideTaskBarEditingElements=function(e,t,i){t=t||this.editElement;var n=!!this.parent.taskFields.progress,r=!0;if(!this.parent.readOnly){if("ResourceView"===this.parent.viewType&&this.parent.enableMultiTaskbar&&e){var s=this.parent.ganttChartModule.getRecordByTaskBar(e),a=this.parent.getParentTask(s.parentItem);Object(w["T"])(a)||a.expanded||(n=!1,r=!1)}if(e){if(e.querySelector("."+xe["Ub"])){if(Object(w["u"])([e.querySelector("."+xe["Ub"])],[xe["kb"]]),Object(w["u"])([e.querySelector("."+xe["Wb"])],[xe["Nb"]]),n){var o=!Object(w["T"])(e.querySelector("."+xe["t"]));o&&Object(w["u"])([e.querySelector("."+xe["t"])],[xe["Gb"]])}}else if(this.parent.isAdaptive&&n){s=this.parent.ganttChartModule.getRecordByTaskBar(e);s.hasChildRecords&&Object(w["u"])([e],[xe["c"]])}if(Object(w["u"])(this.parent.ganttChartModule.scrollElement.querySelectorAll("."+xe["x"]),[xe["E"]]),!Object(w["T"])(this.parent.taskFields.dependency)&&(e.querySelector("."+xe["G"])||e.parentElement.querySelector("."+xe["G"]))&&r){var l=Object(w["T"])(e.querySelector("."+xe["G"]))?e.parentElement:e;Object(w["u"])([l.querySelector("."+xe["G"])],[xe["H"]]),Object(w["u"])([l.querySelector("."+xe["I"])],[xe["J"]])}}else i||Object(w["gb"])(this.parent.ganttChartModule.scrollElement.querySelectorAll("."+xe["x"]),[xe["E"]]);if(t&&e!==t){if(t.querySelector("."+xe["Ub"])&&(Object(w["gb"])([t.querySelector("."+xe["Ub"])],[xe["kb"]]),Object(w["gb"])([t.querySelector("."+xe["Wb"])],[xe["Nb"]]),t.querySelector("."+xe["t"])&&Object(w["gb"])([t.querySelector("."+xe["t"])],[xe["Gb"]])),Object(w["T"])(this.parent.taskFields.dependency)||!t.querySelector("."+xe["G"])&&!t.parentElement.querySelector("."+xe["G"])){if(this.parent.isAdaptive){s=this.parent.ganttChartModule.getRecordByTaskBar(t);s&&s.hasChildRecords&&Object(w["gb"])([t],[xe["c"]])}}else{l=Object(w["T"])(t.querySelector("."+xe["G"]))?t.parentElement:t;Object(w["gb"])([l.querySelector("."+xe["G"])],[xe["H"]]),Object(w["gb"])([l.querySelector("."+xe["I"])],[xe["J"]])}this.editElement=null}}},t.prototype.getTaskBarAction=function(e){var t=this.getElementByPosition(e),i=this.taskBarEditRecord,n="";return t.classList.contains(xe["Ub"])?n="LeftResizing":t.classList.contains(xe["Wb"])?n="RightResizing":(t.classList.contains(xe["t"])||Object(w["A"])(t,"."+xe["t"]))&&this.parent.taskFields.progress?n="ProgressResizing":t.classList.contains(xe["G"])?n="ConnectorPointLeftDrag":t.classList.contains(xe["I"])?n="ConnectorPointRightDrag":t.classList.contains(xe["sb"])?n="ParentResizing":t.classList.contains(xe["tb"])||t.classList.contains(xe["ob"])||t.classList.contains(xe["pb"])||t.classList.contains(xe["rb"])||t.classList.contains(xe["qb"])||t.classList.contains(xe["pb"])?n="ManualParentDrag":i&&(n=i.hasChildRecords?"Auto"===this.parent.taskMode?"ParentDrag":"":i.ganttProperties.isMilestone?"MilestoneDrag":"ChildDrag"),n},t.prototype.updateMouseDownProperties=function(e){var t=this.getCoordinate(e);if(t.pageX||t.pageY){var i=this.parent.getOffsetRect(this.parent.ganttChartModule.chartBodyContainer);this.mouseDownX=t.pageX-i.left+this.parent.ganttChartModule.scrollObject.previousScroll.left,this.tooltipPositionX=this.mouseDownX,this.mouseDownY=t.pageY-i.top+this.parent.ganttChartModule.scrollObject.previousScroll.top}"ConnectorPointLeftDrag"!==this.taskBarEditAction&&"ConnectorPointRightDrag"!==this.taskBarEditAction||(this.fromPredecessorText="ConnectorPointLeftDrag"===this.taskBarEditAction?"start":"finish",this.parent.connectorLineModule.tooltipTable.innerHTML=this.parent.connectorLineModule.getConnectorLineTooltipInnerTd(this.taskBarEditRecord.ganttProperties.taskName,this.fromPredecessorText,"",""))},t.prototype.isMouseDragCheck=function(){if(!this.isMouseDragged&&this.taskBarEditAction&&(this.mouseDownX!==this.mouseMoveX&&(this.mouseDownX+3<this.mouseMoveX||this.mouseDownX-3>this.mouseMoveX)||this.mouseDownY!==this.mouseMoveY&&(this.mouseDownY+3<this.mouseMoveY||this.mouseDownY-3>this.mouseMoveY))){this.isMouseDragged=!0,this.parent.initiateEditAction(!0);var e=this.taskBarEditRecord.ganttProperties;this.previousItem=this.parent.timelineModule.extendFunction(e,this.previousItemProperty),"ConnectorPointLeftDrag"!==this.taskBarEditAction&&"ConnectorPointRightDrag"!==this.taskBarEditAction&&this.editTooltip.showHideTaskbarEditTooltip(!0,this.segmentIndex),this.taskBarEditElement.setAttribute("aria-grabbed","true")}},t.prototype.mouseMoveAction=function(e){var t=this;if(this.parent.isAdaptive){if(!this.canDrag)return;this.multipleSelectionEnabled()}var i=this.parent.getOffsetRect(this.parent.ganttChartModule.chartBodyContainer),n=this.getCoordinate(e);if(this.mouseMoveX=n.pageX-i.left+this.parent.ganttChartModule.scrollObject.previousScroll.left,this.mouseMoveY=n.pageY-i.top+this.parent.ganttChartModule.scrollObject.previousScroll.top,this.dragMouseLeave=!1,this.isMouseDragCheck(),this.isMouseDragged&&this.taskBarEditAction){var r={cancel:!1,requestType:"taskbarediting",taskBarEditAction:this.taskBarEditAction,data:this.taskBarEditRecord};-1!==this.segmentIndex&&(r.requestType="mergeSegment"),this.parent.trigger("actionBegin",r,function(i){!1===i.cancel&&t.taskBarEditingAction(e,!1)})}else this.parent.isAdaptive||this.taskBarEditAction||this.updateTaskBarEditElement(e)},t.prototype.taskBarEditingAction=function(e,t){var i=this,n={},r=this.parent.ganttChartModule.getIndexByTaskBar(this.taskBarEditElement);if(null!==this.taskBarEditRecord){if(n.editingFields=this.taskBarEditRecord.ganttProperties,n.data=this.taskBarEditRecord,"ResourceView"===this.parent.viewType&&0===n.data.level)return;n.recordIndex=r,n.taskBarEditAction=this.taskBarEditAction,n.roundOffDuration=this.roundOffDuration,n.cancel=!1,n.previousData=this.previousItem,n.segmentIndex=this.segmentIndex,this.roundOffDuration=n.roundOffDuration,this.targetElement=n.target=Object(w["A"])(e.target,".e-gantt-child-taskbar"),this.updateMouseMoveProperties(e),"ProgressResizing"===this.taskBarEditAction?this.performProgressResize(e):"LeftResizing"===this.taskBarEditAction?this.enableLeftResizing(e):"RightResizing"===this.taskBarEditAction||"ParentResizing"===this.taskBarEditAction?this.enableRightResizing(e):"ParentDrag"===this.taskBarEditAction||"ChildDrag"===this.taskBarEditAction||"MilestoneDrag"===this.taskBarEditAction||"ManualParentDrag"===this.taskBarEditAction?this.enableDragging(e):"ConnectorPointLeftDrag"!==this.taskBarEditAction&&"ConnectorPointRightDrag"!==this.taskBarEditAction||(this.updateConnectorLineSecondProperties(e),this.triggerDependencyEvent(e),this.parent.isAdaptive||this.drawFalseLine()),this.setItemPosition(),this.updateEditedItem(),this.editTooltip.updateTooltip(this.segmentIndex),t&&this.taskBarEditedAction(e),this.parent.trigger("taskbarEditing",n,function(e){e.cancel&&null!==i.taskBarEditRecord&&(i.tapPointOnFocus=!1,Object(w["ab"])(i.taskBarEditRecord.ganttProperties,e.previousData))})}},t.prototype.updateMouseMoveProperties=function(e){var t=this.parent.getOffsetRect(this.parent.ganttChartModule.chartBodyContainer),i=this.getCoordinate(e);(i.pageX||i.pageY)&&(this.mouseMoveX=i.pageX-t.left+this.parent.ganttChartModule.scrollObject.previousScroll.left,this.tooltipPositionX=this.mouseMoveX,this.mouseMoveY=i.pageY-t.top+this.parent.ganttChartModule.scrollObject.previousScroll.top);var n="ConnectorPointLeftDrag"===this.taskBarEditAction||"ConnectorPointRightDrag"===this.taskBarEditAction;if(this.taskBarEditRecord.ganttProperties.width>3&&("ProgressResizing"!==this.taskBarEditAction||0!==this.taskBarEditRecord.ganttProperties.progress&&100!==this.taskBarEditRecord.ganttProperties.progress)||n){var r=this.mouseMoveX-this.parent.ganttChartModule.scrollObject.previousScroll.left+t.left,s=this.mouseMoveY-this.parent.ganttChartModule.scrollObject.previousScroll.top+t.top;r+20>t.left+this.parent.ganttChartModule.chartBodyContainer.offsetWidth?(this.timerCount=this.parent.ganttChartModule.scrollObject.previousScroll.left,this.startScrollTimer("right")):r-20<t.left?(this.timerCount=this.parent.ganttChartModule.scrollObject.previousScroll.left,this.startScrollTimer("left")):n&&s+80>t.top+this.parent.ganttChartModule.chartBodyContainer.offsetHeight?(this.timerCount=this.parent.ganttChartModule.scrollObject.previousScroll.top,this.startScrollTimer("bottom")):n&&s-20<t.top?(this.timerCount=this.parent.ganttChartModule.scrollObject.previousScroll.top,this.startScrollTimer("top")):this.stopScrollTimer()}else this.stopScrollTimer()},t.prototype.startScrollTimer=function(e){var t=this;this.stopScrollTimer(),this.scrollTimer=window.setInterval(function(){t.timerCount="right"===e||"bottom"===e?t.timerCount+1>=t.parent.timelineModule.totalTimelineWidth?t.parent.timelineModule.totalTimelineWidth:t.timerCount+1:t.timerCount-1<0?0:t.timerCount-1,"bottom"===e||"top"===e?t.parent.ganttChartModule.scrollObject.setScrollTop(t.timerCount):t.parent.ganttChartModule.scrollObject.setScrollLeft(t.timerCount),"ConnectorPointLeftDrag"!==t.taskBarEditAction&&"ConnectorPointRightDrag"!==t.taskBarEditAction||t.drawFalseLine()},0)},t.prototype.stopScrollTimer=function(){window.clearInterval(this.scrollTimer),this.scrollTimer=null},t.prototype.enableDragging=function(e){var t=this.taskBarEditRecord.ganttProperties,i=0;if(this.taskBarEditElement.classList.contains("e-segmented-taskbar")&&!this.taskBarEditElement.classList.contains("e-segment-first")){var n=this.taskBarEditRecord.ganttProperties.segments.map(function(e){return Ne({},e)}),r=n[this.segmentIndex];this.mouseDownX>this.mouseMoveX?(i=Object(w["T"])(this.previousMouseMove)?this.mouseDownX-this.mouseMoveX:this.previousMouseMove-this.mouseMoveX,this.previousMouseMove=this.mouseMoveX,r.left=r.left-i):(i=Object(w["T"])(this.previousMouseMove)?this.mouseMoveX-this.mouseDownX:this.mouseMoveX-this.previousMouseMove,this.previousMouseMove=this.mouseMoveX,r.left=r.left+i);var s=n[this.segmentIndex-1],a=n[this.segmentIndex+1],o=void 0;o=this.taskBarEditElement.classList.contains("e-segment-inprogress")?r.left<s.left+s.width?s.left+s.width:r.width+r.left>a.left?a.left-r.width:r.left:r.left<s.left+s.width?s.left+s.width:t.left+r.width+r.left>=this.parent.timelineModule.totalTimelineWidth?this.parent.timelineModule.totalTimelineWidth-r.width:r.left,r.left=o,this.parent.setRecordValue("segments",n,t,!0),this.parent.dataOperation.updateMappingData(this.taskBarEditRecord,"segments")}else{this.mouseDownX>this.mouseMoveX?(i=this.mouseDownX-this.mouseMoveX,i>0&&this.parent.setRecordValue("left",this.previousItem.left-i,t,!0)):(i=this.mouseMoveX-this.mouseDownX,this.parent.setRecordValue("left",this.previousItem.left+i,t,!0));o=t.left<0?0:t.left+t.width>=this.parent.timelineModule.totalTimelineWidth?this.parent.timelineModule.totalTimelineWidth-t.width:t.left;this.parent.setRecordValue("left",o,t,!0)}},t.prototype.performProgressResize=function(e){var t=this.taskBarEditRecord.ganttProperties,i=0;this.mouseDownX>this.mouseMoveX?this.mouseMoveX>t.left&&this.mouseMoveX<t.left+t.width&&t.left>0?(i=this.mouseMoveX-t.left,this.parent.setRecordValue("progressWidth",i,t,!0)):this.mouseMoveX>=t.left+t.width?this.parent.setRecordValue("progressWidth",t.width,t,!0):this.parent.setRecordValue("progressWidth",0,t,!0):this.mouseMoveX>t.left&&this.mouseMoveX<t.left+t.width?(i=this.mouseMoveX-t.left,this.parent.setRecordValue("progressWidth",i,t,!0)):this.mouseMoveX<=t.left?this.parent.setRecordValue("progressWidth",0,t,!0):this.parent.setRecordValue("progressWidth",t.width,t,!0);var n=t.progressWidth>t.width?t.width:t.progressWidth;n=t.progressWidth<0?0:t.progressWidth,this.parent.setRecordValue("progressWidth",n,t,!0);var r=t.width-t.progressWidth;this.progressBorderRadius=r<=4?4-r:0},t.prototype.enableLeftResizing=function(e){var t=this.taskBarEditRecord.ganttProperties,i=0;this.taskBarEditElement.classList.contains("e-segmented-taskbar")?this.enableSplitTaskLeftResize(t):(this.mouseDownX>this.mouseMoveX?this.mouseMoveX<t.left+t.width?(i=this.mouseDownX-this.mouseMoveX,t.left>0&&(this.parent.setRecordValue("left",this.previousItem.left-i,t,!0),this.parent.setRecordValue("width",this.previousItem.width+i,t,!0))):this.mouseMoveX>t.left+t.width&&(i=this.mouseDownX-this.mouseMoveX,this.parent.setRecordValue("left",this.previousItem.left-i,t,!0),this.parent.setRecordValue("width",3,t,!0)):this.mouseMoveX<t.left+t.width?(i=this.mouseMoveX-this.mouseDownX,t.left<t.left+t.width&&this.previousItem.left+i<=this.previousItem.left+this.previousItem.width&&(this.parent.setRecordValue("left",this.previousItem.left+i,t,!0),this.parent.setRecordValue("width",this.previousItem.width-i,t,!0))):(i=this.mouseMoveX-this.mouseDownX,this.parent.setRecordValue("left",this.previousItem.left+i,t,!0),this.parent.setRecordValue("width",3,t,!0)),this.updateEditPosition(e,t),this.parent.setRecordValue("left",this.previousItem.left+this.previousItem.width-t.width,t,!0))},t.prototype.enableSplitTaskLeftResize=function(e){var t=this.taskBarEditRecord.ganttProperties.segments.map(function(e){return Ne({},e)}),i=t[this.segmentIndex],n=0;if(this.mouseDownX>this.mouseMoveX)if(this.mouseMoveX<e.left+i.width+i.left){if(n=Object(w["T"])(this.previousMouseMove)?this.mouseDownX-this.mouseMoveX:this.previousMouseMove-this.mouseMoveX,this.previousMouseMove=this.mouseMoveX,i.left>0){if(i.left=i.left-n,i.width=i.width+n,0!==this.segmentIndex){var r=t[this.segmentIndex-1];if(e.left+i.left<e.left+r.left+r.width){var s=e.left+r.left+r.width-(e.left+i.left);i.width-=s,i.left=i.left+s}}}else if(i.left<=0&&0===this.segmentIndex){this.parent.setRecordValue("left",e.left-n,e,!0),this.parent.setRecordValue("width",e.width+n,e,!0),i.width=i.width+n;for(var a=1;a<e.segments.length;a++){var o=t[a];o.left=o.left+n}}}else this.mouseMoveX>e.left+i.width+i.left&&(n=Object(w["T"])(this.previousMouseMove)?this.mouseDownX-this.mouseMoveX:this.previousMouseMove-this.mouseMoveX,this.previousMouseMove=this.mouseMoveX,i.left=i.left-n,i.width=this.parent.perDayWidth);else if(this.mouseMoveX<e.left+i.width+i.left-this.parent.perDayWidth)if(n=Object(w["T"])(this.previousMouseMove)?this.mouseMoveX-this.mouseDownX:this.mouseMoveX-this.previousMouseMove,this.previousMouseMove=this.mouseMoveX,0===this.segmentIndex&&i.left<=0){this.parent.setRecordValue("left",e.left+n,e,!0),this.parent.setRecordValue("width",e.width-n,e,!0),i.width=i.width-n;for(a=1;a<e.segments.length;a++){var l=t[a];l.left=l.left-n}}else i.left<i.left+i.width&&i.left+n<=i.left+i.width&&(i.left=i.left+n,i.width=i.width-n);else if(this.mouseMoveX<e.left+i.left+i.width&&i.width>this.parent.perDayWidth){n=Object(w["T"])(this.previousMouseMove)?this.mouseMoveX-this.mouseDownX:this.mouseMoveX-this.previousMouseMove,this.previousMouseMove=this.mouseMoveX;var d=i.width-n<this.parent.perDayWidth?this.parent.perDayWidth>i.width?this.parent.perDayWidth-i.width:i.width-this.parent.perDayWidth:0;if(n-=d,0===this.segmentIndex){this.parent.setRecordValue("width",e.width-n,e,!0),this.parent.setRecordValue("left",e.left+n,e,!0);for(a=1;a<e.segments.length;a++){var c=t[a];c.left=c.left-n}}else i.left=i.left+n,i.width=i.width-n}this.parent.setRecordValue("segments",t,e,!0),this.parent.dataOperation.updateMappingData(this.taskBarEditRecord,"segments")},t.prototype.updateEditPosition=function(e,t){this.updateIsMilestone(t),this.parent.setRecordValue("progressWidth",this.parent.dataOperation.getProgressWidth(t.width,t.progress),t,!0)},t.prototype.updateIsMilestone=function(e){e.width<=3?(this.parent.setRecordValue("width",3,e,!0),this.parent.setRecordValue("isMilestone",!0,e,!0)):(this.parent.setRecordValue("width",e.width,e,!0),this.parent.setRecordValue("isMilestone",!1,e,!0))},t.prototype.enableRightResizing=function(e){var t=this.taskBarEditRecord.ganttProperties,i=0;if(this.taskBarEditElement.classList.contains("e-segmented-taskbar")){var n=this.taskBarEditRecord.ganttProperties.segments.map(function(e){return Ne({},e)}),r=n[this.segmentIndex];this.mouseDownX>this.mouseMoveX?this.mouseMoveX>t.left+r.left&&this.mouseDownX-this.mouseMoveX>3?(i=Object(w["T"])(this.previousMouseMove)?this.mouseDownX-this.mouseMoveX:this.previousMouseMove-this.mouseMoveX,this.previousMouseMove=this.mouseMoveX,r.width=r.width-i):this.mouseMoveX<t.left+r.left&&(r.width=this.parent.perDayWidth):this.mouseMoveX>r.left&&(i=Object(w["T"])(this.previousMouseMove)?this.mouseMoveX-this.mouseDownX:this.mouseMoveX-this.previousMouseMove,this.previousMouseMove=this.mouseMoveX,r.width=r.width+i);var s=void 0,a=this.segmentIndex!==n.length-1?n[this.segmentIndex+1]:null;Object(w["T"])(a)||(this.taskBarEditElement.classList.contains("e-segment-last")||(s=r.left+r.width>a.left?a.left-r.left:r.width),r.width=s),this.segmentIndex===t.segments.length-1&&0===this.segmentIndex&&this.parent.setRecordValue("width",r.width,t,!0),this.parent.setRecordValue("segments",n,t,!0),this.parent.dataOperation.updateMappingData(this.taskBarEditRecord,"segments")}else this.mouseDownX>this.mouseMoveX?this.mouseMoveX>t.left&&this.mouseDownX-this.mouseMoveX>3?(i=this.mouseDownX-this.mouseMoveX,this.parent.setRecordValue("width",this.previousItem.width-i,t,!0)):this.mouseMoveX<t.left&&this.parent.setRecordValue("width",3,t,!0):this.mouseMoveX>t.left&&(i=this.mouseMoveX-this.mouseDownX,this.parent.setRecordValue("width",this.previousItem.width+i,t,!0)),this.updateEditPosition(e,t)},t.prototype.updateEditedItem=function(){var e,t,i,n,r=this.taskBarEditRecord.ganttProperties;switch(this.taskBarEditAction){case"ProgressResizing":this.parent.setRecordValue("progress",this.getProgressPercent(r.width,r.progressWidth),r,!0);break;case"LeftResizing":-1===this.segmentIndex?(e=this.getRoundOffStartLeft(r,this.roundOffDuration),t=this.getDateByLeft(e),Object(w["T"])(r.endDate)&&(i=this.parent.dateValidationModule.getValidEndDate(r),this.parent.setRecordValue("endDate",i,r,!0)),n=this.parent.dateValidationModule.checkStartDate(t,r,null),this.parent.setRecordValue("startDate",new Date(n.getTime()),r,!0),0===this.parent.dateValidationModule.compareDates(r.startDate,r.endDate)&&Object(w["T"])(r.isMilestone)&&!1===r.isMilestone&&0===r.duration&&this.parent.setRecordValue("duration",1,r,!0),r.isMilestone&&this.parent.setRecordValue("endDate",new Date(n.getTime()),r,!0),this.parent.dateValidationModule.calculateDuration(this.taskBarEditRecord),this.parent.editModule.updateResourceRelatedFields(this.taskBarEditRecord,"duration")):this.updateSplitLeftResize(r);break;case"RightResizing":case"ParentResizing":if(-1===this.segmentIndex){e=this.getRoundOffEndLeft(r,this.roundOffDuration);var s=this.getDateByLeft(e);Object(w["T"])(r.startDate)&&(n=this.parent.dateValidationModule.getValidStartDate(r),this.parent.setRecordValue("startDate",n,r,!0));var a=Object(w["T"])(r.startDate)?n:r.startDate;i=r.isMilestone?a:this.parent.dateValidationModule.checkEndDate(s,this.taskBarEditRecord.ganttProperties),this.parent.setRecordValue("endDate",new Date(i.getTime()),r,!0),this.parent.dateValidationModule.calculateDuration(this.taskBarEditRecord),this.parent.editModule.updateResourceRelatedFields(this.taskBarEditRecord,"duration")}else this.updateSplitRightResizing(r);break;case"ParentDrag":case"ChildDrag":case"MilestoneDrag":case"ManualParentDrag":-1===this.segmentIndex||0===this.segmentIndex?this.updateChildDrag(r):this.setSplitTaskDrag(r);break}},t.prototype.updateChildDrag=function(e){var t,i=this.getRoundOffStartLeft(e,this.roundOffDuration),n=this.getDateByLeft(i);0===this.segmentIndex?(this.parent.setRecordValue("startDate",this.parent.dateValidationModule.checkStartDate(n,e,null),e,!0),e.segments[0].startDate=n,e.segments[0].endDate=this.parent.dataOperation.getEndDate(e.segments[0].startDate,e.segments[0].duration,e.durationUnit,e,!1),this.parent.setRecordValue("segments",e.segments,e,!0),this.parent.dataOperation.updateMappingData(this.taskBarEditRecord,"segments"),this.parent.chartRowsModule.incrementSegments(e.segments,0,this.taskBarEditRecord),this.parent.setRecordValue("endDate",e.segments[e.segments.length-1].endDate,e,!0)):!Object(w["T"])(e.endDate)&&Object(w["T"])(e.startDate)?(t=this.parent.dateValidationModule.checkStartDate(n,e,null),t=this.parent.dateValidationModule.checkEndDate(t,this.taskBarEditRecord.ganttProperties),this.parent.setRecordValue("endDate",t,e,!0)):(this.parent.setRecordValue("startDate",this.parent.dateValidationModule.checkStartDate(n,e,null),e,!0),Object(w["T"])(e.duration)||this.parent.dateValidationModule.calculateEndDate(this.taskBarEditRecord))},t.prototype.updateSplitLeftResize=function(e){var t=e.segments[this.segmentIndex],i=0===this.segmentIndex?this.getRoundOffStartLeft(e,this.roundOffDuration):this.getRoundOffStartLeft(t,this.roundOffDuration),n=0===this.segmentIndex?this.getDateByLeft(i):this.getDateByLeft(e.left+i),r=this.parent.dataOperation.checkStartDate(n,e,!1),s=this.parent.dataOperation.getDuration(r,t.endDate,e.durationUnit,e.isAutoSchedule,e.isMilestone);if(t.startDate=new Date(r.getTime()),t.duration=s,this.parent.setRecordValue("duration",this.sumOfDuration(e.segments),e,!0),0===this.segmentIndex&&this.parent.setRecordValue("startDate",t.startDate,e,!0),this.parent.editModule.updateResourceRelatedFields(this.taskBarEditRecord,"duration"),!Object(w["T"])(e.segments[this.segmentIndex-1])){var a=this.parent.dataOperation.getDuration(e.segments[this.segmentIndex-1].endDate,e.segments[this.segmentIndex].startDate,e.durationUnit,e.isAutoSchedule,e.isMilestone);t.offsetDuration=a}this.parent.setRecordValue("segments",e.segments,e,!0),this.parent.dataOperation.updateMappingData(this.taskBarEditRecord,"segments")},t.prototype.updateSplitRightResizing=function(e){var t=e.segments[this.segmentIndex],i=this.getRoundOffEndLeft(e,this.roundOffDuration),n=this.getDateByLeft(i),r=this.parent.dataOperation.checkEndDate(n,e,!1),s=this.parent.dataOperation.getDuration(t.startDate,r,e.durationUnit,e.isAutoSchedule,e.isMilestone);if(t.endDate=new Date(r.getTime()),t.duration=s,!Object(w["T"])(e.segments[this.segmentIndex+1])){var a=e.segments[this.segmentIndex+1],o=this.parent.dataOperation.getDuration(e.segments[this.segmentIndex].endDate,a.startDate,e.durationUnit,e.isAutoSchedule,e.isMilestone);t.offsetDuration=o}this.parent.setRecordValue("segments",e.segments,e,!0),this.parent.dataOperation.updateMappingData(this.taskBarEditRecord,"segments"),this.parent.setRecordValue("duration",this.sumOfDuration(e.segments),e,!0),this.parent.setRecordValue("endDate",e.segments[e.segments.length-1].endDate,e,!0),this.parent.editModule.updateResourceRelatedFields(this.taskBarEditRecord,"duration")},t.prototype.sumOfDuration=function(e){for(var t=0,i=0;i<e.length;i++){var n=e[i];t+=n.duration}return t},t.prototype.setSplitTaskDrag=function(e){var t=e.segments[this.segmentIndex],i=this.getRoundOffStartLeft(t,this.roundOffDuration),n=this.getDateByLeft(e.left+i);if(n=this.parent.dateValidationModule.checkStartDate(n,e,null),t.startDate=n,t.endDate=this.parent.dataOperation.getEndDate(t.startDate,t.duration,e.durationUnit,e,!1),t.duration=this.parent.dataOperation.getDuration(t.startDate,t.endDate,e.durationUnit,e.isAutoSchedule,e.isMilestone),this.parent.setRecordValue("duration",this.sumOfDuration(e.segments),e,!0),this.parent.setRecordValue("endDate",e.segments[e.segments.length-1].endDate,e,!0),Object(w["T"])(this.parent.taskFields.endDate)||this.parent.dataOperation.updateMappingData(this.taskBarEditRecord,"endDate"),!Object(w["T"])(e.segments[this.segmentIndex-1])){var r=this.parent.dataOperation.getDuration(e.segments[this.segmentIndex-1].endDate,e.segments[this.segmentIndex].startDate,e.durationUnit,e.isAutoSchedule,e.isMilestone);1!==t.startDate.getDay()||0!==r||this.parent.includeWeekend||(r=1),t.offsetDuration=r}if(!Object(w["T"])(e.segments[this.segmentIndex+1])){var s=e.segments[this.segmentIndex+1];r=this.parent.dataOperation.getDuration(e.segments[this.segmentIndex].endDate,s.startDate,e.durationUnit,e.isAutoSchedule,e.isMilestone);1!==s.startDate.getDay()||0!==r||this.parent.includeWeekend||(r=1),s.offsetDuration=r}this.parent.setRecordValue("segments",e.segments,e,!0),this.parent.dataOperation.updateMappingData(this.taskBarEditRecord,"segments")},t.prototype.getRoundOffEndLeft=function(e,t){var i="None"!==this.parent.timelineModule.bottomTier?this.parent.timelineModule.bottomTier:this.parent.timelineModule.topTier,n=e.width+e.left;if(-1!==this.segmentIndex){var r=e.segments[this.segmentIndex];n=n-e.width+r.width+r.left}var s=1/(this.parent.timelineModule.getIncrement(this.getDateByLeft(n),1,"Day")/864e5),a=this.parent.perDayWidth-this.parent.perDayWidth/s,o=a/this.parent.perDayWidth;if(void 0===t&&(t=!1),t){if(t)if("Hour"===i){var l=this.parent.perDayWidth/24;s=1/(this.parent.timelineModule.getIncrement(this.getDateByLeft(n),1,"Hour")/36e5),a=this.parent.perDayWidth/24-this.parent.perDayWidth/24/s,0!==a&&(n=n-a+l)}else if("Minutes"===i){var d=this.parent.perDayWidth/1440;s=1/(this.parent.timelineModule.getIncrement(this.getDateByLeft(n),1,"Minutes")/6e4),a=this.parent.perDayWidth/1440-this.parent.perDayWidth/1440/s,0!==a&&(n=n-a+d)}else 0!==a&&(n=n-a+this.parent.perDayWidth)}else"Hour"!==i&&"Minutes"!==i&&(o>.5?n=n-a+this.parent.perDayWidth:o<.5&&(n=n-a+this.parent.perDayWidth/2));return n},t.prototype.getRoundOffStartLeft=function(e,t){var i=(Object(w["T"])(e),e.left),n="None"!==this.parent.timelineModule.bottomTier?this.parent.timelineModule.bottomTier:this.parent.timelineModule.topTier,r=1/(this.parent.timelineModule.getIncrement(this.getDateByLeft(i),1,"Day")/864e5),s=this.parent.perDayWidth-this.parent.perDayWidth/r,a=s/this.parent.perDayWidth;return void 0===t&&(t=!1),t?t&&("Hour"===n?(r=1/(this.parent.timelineModule.getIncrement(this.getDateByLeft(i),1,"Hour")/36e5),s=this.parent.perDayWidth/24-this.parent.perDayWidth/24/r,i-=s):"Minutes"===n?(r=1/(this.parent.timelineModule.getIncrement(this.getDateByLeft(i),1,"Minutes")/6e4),s=this.parent.perDayWidth/1440-this.parent.perDayWidth/1440/r,i-=s):i-=s):"Hour"!==n&&"Minutes"!==n&&(a<=.5?i-=s:a>.5&&(i=i-s+this.parent.perDayWidth/2)),i},t.prototype.getDateByLeft=function(e){var t=new Date(this.parent.timelineModule.timelineStartDate.toString()),i=864e5/this.parent.perDayWidth;t.setTime(t.getTime()+e*i);var n="None"!==this.parent.timelineModule.bottomTier?this.parent.timelineModule.topTier:this.parent.timelineModule.bottomTier;return"Hour"!==n&&"Minutes"!==n&&(this.parent.isInDst(new Date(this.parent.timelineModule.timelineStartDate.toString()))&&!this.parent.isInDst(t)?t.setTime(t.getTime()+36e5):!this.parent.isInDst(new Date(this.parent.timelineModule.timelineStartDate.toString()))&&this.parent.isInDst(t)&&t.setTime(t.getTime()-36e5)),t},t.prototype.setItemPosition=function(){var e=this.taskBarEditRecord.ganttProperties,t=Object(w["T"])(e.segments)?null:e.segments[this.segmentIndex],i="MilestoneDrag"===this.taskBarEditAction||e.isMilestone?this.parent.chartRowsModule.milestoneHeight:e.width,n=this.parent.isAdaptive?i-2:i-10;Object(w["T"])(t)||(n=this.parent.isAdaptive?t.width-2:t.width-10);var r=this.taskBarEditElement.classList.contains(xe["Vb"])?this.taskBarEditElement:Object(w["A"])(this.taskBarEditElement,"tr."+xe["p"]).querySelector("."+xe["Vb"]),s=this.taskBarEditElement.classList.contains("e-segmented-taskbar"),a=Object(w["A"])(this.taskBarEditElement,"tr."+xe["p"]).querySelector("."+xe["hb"]),o=Object(w["A"])(this.taskBarEditElement,"tr."+xe["p"]).querySelector("."+xe["Kb"]),l=this.taskBarEditElement.querySelector("."+xe["jc"]),d=this.taskBarEditElement.querySelector("."+xe["kc"]),c=this.taskBarEditElement.querySelector("."+xe["t"]),h=this.taskBarEditElement.querySelector("."+xe["Wb"]),p=this.taskBarEditElement.querySelector("."+xe["oc"]),u=this.taskBarEditElement.querySelector("."+xe["nc"]),m=this.taskBarEditElement.querySelector("."+xe["Jb"]),g=this.taskBarEditElement,f=this.taskBarEditElement.querySelector("."+xe["tb"]),b=this.taskBarEditElement.querySelector("."+xe["sb"]),v=this.taskBarEditElement.querySelector("."+xe["nb"]);if("ConnectorPointRightDrag"!==this.taskBarEditAction&&"ConnectorPointLeftDrag"!==this.taskBarEditAction){if("ParentResizing"!==this.taskBarEditAction&&"ManualParentDrag"!==this.taskBarEditAction){if(!s||Object(w["T"])(e.segments)||"RightResizing"!==this.taskBarEditAction&&0===this.segmentIndex||(this.taskBarEditElement.style.width=t.width+"px",this.taskBarEditElement.style.left=t.left+"px"),r.style.width=i+"px",r.style.left=e.left+"px",a.style.width=e.left+"px","LeftResizing"===this.taskBarEditAction&&0===this.segmentIndex)for(var y=this.taskBarEditElement.parentElement,C=y.getElementsByClassName("e-segmented-taskbar"),O=0;O<e.segments.length;O++){var T=e.segments[O],k=C[O];k.style.width=T.width+"px",k.style.left=T.left+"px"}Object(w["T"])(o)||(o.style.left=e.left+i+"px")}m&&(m.style.left=(this.parent.isAdaptive?i+10:i+2)+"px"),"MilestoneDrag"===this.taskBarEditAction||e.isMilestone?(r.style.left=e.left-i/2+"px",a.style.width=e.left-i/2+"px",Object(w["T"])(o)||(o.style.left=e.left+i/2+"px")):"ProgressResizing"===this.taskBarEditAction?-1===this.segmentIndex?(d.style.left=e.left+e.progressWidth-10+"px",Object(w["T"])(l)||(l.style.width=e.progressWidth+"px",l.style.borderBottomRightRadius=this.progressBorderRadius+"px",l.style.borderTopRightRadius=this.progressBorderRadius+"px",c.style.left=e.progressWidth-8+"px")):(this.updateSegmentProgress(this.taskBarEditRecord.ganttProperties),l.style.width=e.segments[this.segmentIndex].progressWidth+"px",l.style.borderBottomRightRadius=this.progressBorderRadius+"px",l.style.borderTopRightRadius=this.progressBorderRadius+"px",c.style.left=e.segments[this.segmentIndex].progressWidth-8+"px"):"RightResizing"!==this.taskBarEditAction||Object(w["T"])(d)?"ParentDrag"===this.taskBarEditAction?(Object(w["T"])(p)||(p.style.width=i+"px"),Object(w["T"])(l)||(u.style.width=e.progressWidth+"px")):"ParentResizing"===this.taskBarEditAction?(g.style.width=f.style.width=e.width+"px",b.style.left=e.width-v.offsetLeft+"px"):"ManualParentDrag"===this.taskBarEditAction?g.style.left=e.left-e.autoLeft+"px":(Object(w["T"])(d)||s||(d.style.width=i+"px"),Object(w["T"])(l)||(h.style.left=n+"px",l.style.width=e.progressWidth+"px",Object(w["T"])(c)||(c.style.left=e.progressWidth-10+"px")),s&&(h.style.left=n+"px",l.style.width=t.progressWidth+"px",Object(w["T"])(c)||(c.style.left=t.progressWidth-10+"px"))):(d.style.width=i+"px",Object(w["T"])(l)||(l.style.width=e.progressWidth+"px",h.style.left=n+"px",Object(w["T"])(c)||(c.style.left=e.progressWidth-10+"px")))}},t.prototype.mouseUpHandler=function(e){var t=this.isMouseDragged;if(this.previousMouseMove=null,this.editTooltip.showHideTaskbarEditTooltip(!1,this.segmentIndex),this.taskBarEditAction&&this.isMouseDragged)if(!this.dragMouseLeave&&this.taskBarEditedAction)this.taskBarEditedAction(e),this.isMouseDragged=!1;else if(this.parent.isOnEdit=!1,this.cancelTaskbarEditActionInMouseLeave(),this.parent.enableCriticalPath&&this.parent.criticalPathModule){var i=this.parent.criticalPathModule;i.criticalConnectorLine(i.criticalPathCollection,i.detailPredecessorCollection,!0,i.predecessorCollectionTaskIds)}"ResourceView"===this.parent.viewType&&this.parent.enableMultiTaskbar&&!Object(w["T"])(this.taskBarEditElement)&&(Object(w["T"])(this.taskBarEditElement.querySelector(".e-gantt-child-taskbar"))||this.taskBarEditElement.querySelector(".e-gantt-child-taskbar").classList.contains("e-collapsed-taskbar-drag")&&(Object(w["gb"])([this.taskBarEditElement.querySelector(".e-gantt-child-taskbar")],"e-collapsed-taskbar-drag"),this.taskBarEditElement.style.zIndex=this.prevZIndex,this.prevZIndex="")),this.parent.isAdaptive&&!t||this.initPublicProp(),this.stopScrollTimer()},t.prototype.taskBarEditedAction=function(e){var t={},i=this.mouseDownX,n=this.mouseDownY,r=this.taskBarEditRecord,s=this.parent.ganttChartModule.getIndexByTaskBar(this.taskBarEditElement),a=this.mouseMoveX,o=this.getCoordinate(e),l=o.pageY-this.parent.ganttChartModule.chartBodyContainer.offsetTop;"ConnectorPointLeftDrag"!==this.taskBarEditAction&&"ConnectorPointRightDrag"!==this.taskBarEditAction||this.drawPredecessor||(this.dependencyCancel=!0),"ConnectorPointLeftDrag"!==this.taskBarEditAction&&"ConnectorPointRightDrag"!==this.taskBarEditAction||!this.drawPredecessor?(i!==a||Math.abs(n-l)>=(this.parent.rowHeight-this.parent.taskbarHeight)/2)&&null!==r&&(t.editingFields=r.ganttProperties,t.data=r,t.recordIndex=s,t.previousData=this.previousItem,t.taskBarEditAction=this.taskBarEditAction,t.action="TaskbarEditing",t.roundOffDuration=this.roundOffDuration,t.target=this.targetElement,this.taskbarEditedArgs=t,this.taskbarEdited(t)):this.parent.connectorLineEditModule.updatePredecessor(this.connectorSecondRecord,this.finalPredecessor)},t.prototype.cancelTaskbarEditActionInMouseLeave=function(){this.parent.editModule.reUpdatePreviousRecords(!0)},t.prototype.updateSegmentProgress=function(e){for(var t=e.segments,i=!0,n=this.splitTasksDuration(t)*this.parent.perDayWidth,r=this.parent.dataOperation.getProgressWidth(n,e.progress),s=0;s<t.length;s++){var a=t[s];delete a.progressWidth,r>0&&r>a.width?(r-=a.width,a.progressWidth=a.width,a.showProgress=!1):i&&(a.progressWidth=r,a.showProgress=!0,r-=a.width,i=!1)}},t.prototype.taskbarEdited=function(e){var t=Object(w["G"])({},e),i=t.data,n=i.ganttProperties;if("ProgressResizing"===t.taskBarEditAction)t.previousData.progress!==n.progress&&(this.parent.setRecordValue("progress",this.getProgressPercent(n.width,n.progressWidth),n,!0),i.parentItem&&this.parent.editModule.updateParentProgress(i.parentItem),Object(w["T"])(n.segments)||this.updateSegmentProgress(n));else{var r=t.data.ganttProperties.segments;if(!Object(w["T"])(r)&&r.length>0&&("LeftResizing"===this.taskBarEditAction&&0!==this.segmentIndex||"ChildDrag"===this.taskBarEditAction&&0!==this.segmentIndex||"RightResizing"===this.taskBarEditAction)){var s=r[this.segmentIndex],a=this.taskBarEditRecord.ganttProperties,o=0===this.segmentIndex?null:r[this.segmentIndex-1],l=this.segmentIndex===r.length-1?null:r[this.segmentIndex+1],d=Object(w["T"])(l)?this.parent.cloneProjectEndDate:new Date(l.startDate.getTime()),c=Object(w["T"])(o)?this.parent.cloneProjectStartDate:new Date(o.endDate.getTime());d.setHours(0,0,0,0),c.setHours(0,0,0,0);var h=new Date(s.startDate.getTime()),p=new Date(s.endDate.getTime());if(h.setDate(h.getDate()-1),p.setDate(p.getDate()+1),h.setHours(0,0,0,0),p.setHours(0,0,0,0),h.getTime()<=c.getTime()&&!Object(w["T"])(o)&&!Object(w["T"])(s)){var u=[{firstSegmentIndex:o.segmentIndex,secondSegmentIndex:s.segmentIndex}];this.parent.chartRowsModule.mergeTask(a.taskId,u)}else if(p.getTime()>=d.getTime()&&this.segmentIndex!==r.length-1){u=[{firstSegmentIndex:s.segmentIndex,secondSegmentIndex:l.segmentIndex}];this.parent.chartRowsModule.mergeTask(a.taskId,u)}else if(p.getTime()>=d.getTime()){s.endDate.setDate(this.parent.cloneProjectEndDate.getDate()-1),s.startDate=this.parent.dataOperation.getStartDate(s.endDate,s.duration,a.durationUnit,a);for(var m=r.length-2;m>=0;m++){var g=r[m],f=g.endDate;f.setDate(f.getDate()-g.offsetDuration),g.endDate=f,g.startDate=this.parent.dataOperation.getStartDate(g.endDate,g.duration,a.durationUnit,a)}}}this.parent.dataOperation.updateWidthLeft(t.data)}this.parent.dataOperation.updateTaskData(i),this.parent.editModule.initiateUpdateAction(t)},t.prototype.getProgressPercent=function(e,t){return Math.ceil(t/e*100)},t.prototype.drawFalseLine=function(){var e,t=this.mouseDownX,i=this.mouseDownY,n=this.mouseMoveX,r=this.mouseMoveY,s=Math.sqrt((t-n)*(t-n)+(i-r)*(i-r)),a=180*Math.atan2(r-i,n-t)/Math.PI,o="rotate("+a+"deg)";"ConnectorPointLeftDrag"===this.taskBarEditAction&&(e=this.elementOffsetLeft-this.parent.chartRowsModule.connectorPointWidth/2-this.parent.ganttChartModule.scrollObject.previousScroll.left),"ConnectorPointRightDrag"===this.taskBarEditAction&&(e=this.elementOffsetLeft+this.elementOffsetWidth+this.parent.chartRowsModule.connectorPointWidth/2-this.parent.ganttChartModule.scrollObject.previousScroll.left);var l=this.elementOffsetTop+this.elementOffsetHeight/2+this.parent.ganttChartModule.chartBodyContainer.offsetTop-this.parent.ganttChartModule.scrollObject.previousScroll.top;this.removeFalseLine(!1),this.falseLine=Object(w["C"])("div",{className:xe["V"],id:"ganttfalseline"+this.parent.element.id,styles:"transform-origin: 0% 100%;right: auto;position: absolute;transform:"+o+";border-top-width: 1px;border-top-style: dashed;z-index: 5;width:"+(s-3)+"px;left:"+e+"px;top:"+l+"px;"}),this.parent.ganttChartModule.chartBodyContainer.appendChild(this.falseLine)},t.prototype.removeFalseLine=function(e){this.falseLine&&(Object(w["fb"])(this.falseLine),this.falseLine=null,e&&(this.elementOffsetLeft=0,this.elementOffsetTop=0,this.elementOffsetWidth=0,this.elementOffsetHeight=0,Object(w["gb"])(this.parent.ganttChartModule.scrollElement.querySelectorAll("."+xe["x"]),[xe["E"]])))},t.prototype.updateConnectorLineSecondProperties=function(e){var t=this.getElementByPosition(e),i=Object(R["i"])(t,xe["Vb"]);this.connectorSecondAction=null;var n=0;if(Object(R["i"])(t,xe["G"])?(this.connectorSecondAction="ConnectorPointLeftDrag",this.toPredecessorText="Start"):Object(R["i"])(t,xe["I"])?(this.connectorSecondAction="ConnectorPointRightDrag",this.toPredecessorText="Finish"):(this.connectorSecondAction=null,this.toPredecessorText=null),this.taskBarEditElement!==i&&this.taskBarEditElement!==this.highlightedSecondElement){if(this.parent.virtualScrollModule&&this.parent.enableVirtualization){var r=this.parent.virtualScrollModule.getTopPosition();n=r}(this.parent.virtualScrollModule&&this.parent.enableVirtualization&&!this.elementOffsetLeft||!this.parent.enableVirtualization)&&(this.elementOffsetLeft=this.taskBarEditElement.offsetLeft,this.elementOffsetTop=this.taskBarEditElement.offsetTop+n,this.elementOffsetWidth=this.taskBarEditElement.offsetWidth,this.elementOffsetHeight=this.taskBarEditElement.offsetHeight),this.showHideTaskBarEditingElements(i,this.highlightedSecondElement,!0)}Object(w["T"])(this.connectorSecondAction)&&!Object(w["T"])(this.connectorSecondElement)&&(this.editTooltip.showHideTaskbarEditTooltip(!1,this.segmentIndex),Object(w["gb"])([this.connectorSecondElement.querySelector("."+xe["G"])],[xe["F"]]),Object(w["gb"])([this.connectorSecondElement.querySelector("."+xe["I"])],[xe["F"]])),this.connectorSecondElement=this.connectorSecondAction?i:null,this.highlightedSecondElement=i,this.connectorSecondRecord=Object(w["T"])(this.connectorSecondElement)?null:this.parent.ganttChartModule.getRecordByTaskBar(this.connectorSecondElement)},t.prototype.triggerDependencyEvent=function(e,t){var i,n,r=this.taskBarEditRecord.ganttProperties,s=this.connectorSecondRecord?this.connectorSecondRecord.ganttProperties:null,a=this.getElementByPosition(e),o=a,l="ResourceView"===this.parent.viewType?r.taskId:r.rowUniqueID;if("ConnectorPointLeftDrag"===this.taskBarEditAction?i=l+"S":"ConnectorPointRightDrag"===this.taskBarEditAction&&(i=l+"F"),this.connectorSecondAction&&("ConnectorPointLeftDrag"===this.connectorSecondAction?(i+="S",n="start"):"ConnectorPointRightDrag"===this.connectorSecondAction&&(i+="F",n="finish")),Object(w["T"])(s))this.drawPredecessor=!1;else{s.predecessorsName?this.finalPredecessor=s.predecessorsName+","+i:this.finalPredecessor=i;var d=this.parent.connectorLineEditModule.validatePredecessorRelation(this.connectorSecondRecord,this.finalPredecessor),c=this.parent.predecessorModule.calculatePredecessor(i,this.connectorSecondRecord),h={};if(h.fromItem=r,h.toItem=s,h.newPredecessorString=this.finalPredecessor,h.predecessor=c&&c[0],h.isValidLink=d,h.requestType="ValidateDependency",this.parent.trigger("actionBegin",h),h.isValidLink=!(!d&&h.isValidLink)&&h.isValidLink,h.isValidLink){if(this.editTooltip.toolTipObj||this.parent.isAdaptive||this.editTooltip.showHideTaskbarEditTooltip(!0,this.segmentIndex),this.editTooltip.toolTipObj){this.parent.connectorLineModule.tooltipTable.innerHTML=this.parent.connectorLineModule.getConnectorLineTooltipInnerTd(this.parent.editModule.taskbarEditModule.taskBarEditRecord.ganttProperties.taskName,this.parent.editModule.taskbarEditModule.fromPredecessorText,"","");var p=this.parent.connectorLineModule.tooltipTable.querySelector("#toPredecessor").querySelectorAll("td");p[1].innerText=s.taskName,p[2].innerText=this.parent.localeObj.getConstant(n);var u=this.parent.connectorLineModule.tooltipTable.parentElement.parentElement;u.offsetTop+u.offsetHeight>e.pageY&&(u.style.top=e.pageY-u.offsetHeight-20+"px")}this.drawPredecessor=!0}else this.parent.isAdaptive?(a.classList.contains(xe["G"])||a.classList.contains(xe["I"]))&&this.showHideActivePredecessors(!0):Object(w["u"])([o],[xe["F"]]),this.drawPredecessor=!1}},t.prototype.getCoordinate=function(e){var t={};if(this.parent.isAdaptive&&e&&"click"!==e.type){var i=e;"touchmove"!==i.type&&"touchstart"!==i.type&&"touchend"!==i.type||(t.pageX=i.changedTouches[0].pageX,t.pageY=i.changedTouches[0].pageY)}else if(e){i=e;t.pageX=i.pageX,t.pageY=i.pageY}return t},t.prototype.getElementByPosition=function(e){if(this.parent.isAdaptive){var t=this.getCoordinate(e);return document.elementFromPoint(t.pageX-window.pageXOffset,t.pageY-window.pageYOffset)}return e.target},t.prototype.multipleSelectionEnabled=function(){this.parent.selectionModule&&"Cell"!==this.parent.selectionSettings.mode&&"Multiple"===this.parent.selectionSettings.type&&this.parent.selectionModule.hidePopUp()},t.prototype.unWireEvents=function(){this.parent.isDestroyed||(this.parent.off("chartMouseDown",this.mouseDownHandler),this.parent.off("chartMouseUp",this.mouseUpHandler),this.parent.off("chartMouseLeave",this.mouseLeaveHandler),this.parent.off("chartMouseMove",this.mouseMoveAction),this.parent.off("chartMouseClick",this.mouseClickHandler))},t.prototype.destroy=function(){this.unWireEvents(),this.stopScrollTimer(),this.parent.editModule.taskbarEditModule=void 0},t}(Ie["a"]),Be=i("453f"),Fe=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),He=function(e,t,i,n){var r,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var o=e.length-1;o>=0;o--)(r=e[o])&&(a=(s<3?r(a):s>3?r(t,i,a):r(t,i))||a);return s>3&&a&&Object.defineProperty(t,i,a),a},Ve="e-tab",qe="e-tab-header",ze="blazor-template",_e="e-content",Ue="e-nested",Ge="e-items",We="e-item",Ke="e-template",$e="e-rtl",Xe="e-active",Je="e-disable",Qe="e-hidden",Ye="e-focused",Ze="e-icons",et="e-icon",tt="e-icon-tab",it="e-close-icon",nt="e-close-show",rt="e-tab-text",st="e-indicator",at="e-tab-wrap",ot="e-text-wrap",lt="e-tab-icon",dt="e-toolbar-items",ct="e-toolbar-item",ht="e-toolbar-pop",pt="e-toolbar-popup",ut="e-hor-nav",mt="e-popup-open",gt="e-popup-close",ft="e-progress",bt="e-ignore",vt="e-overlay",yt="e-hscroll-content",Ct="e-vscroll-content",wt="e-vertical-tab",Ot="e-vertical",Tt="e-vertical-left",kt="e-vertical-right",St="e-horizontal-bottom",jt="e-fill-mode",Rt="tabitem_",Dt="e-reorder-active-item",Et=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Fe(t,e),He([Object(w["r"])("SlideLeftIn")],t.prototype,"effect",void 0),He([Object(w["r"])(600)],t.prototype,"duration",void 0),He([Object(w["r"])("ease")],t.prototype,"easing",void 0),t}(w["e"]),It=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Fe(t,e),He([Object(w["g"])({effect:"SlideLeftIn",duration:600,easing:"ease"},Et)],t.prototype,"previous",void 0),He([Object(w["g"])({effect:"SlideRightIn",duration:600,easing:"ease"},Et)],t.prototype,"next",void 0),t}(w["e"]),xt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Fe(t,e),He([Object(w["r"])("")],t.prototype,"text",void 0),He([Object(w["r"])("")],t.prototype,"iconCss",void 0),He([Object(w["r"])("left")],t.prototype,"iconPosition",void 0),t}(w["e"]),Mt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Fe(t,e),He([Object(w["g"])({},xt)],t.prototype,"header",void 0),He([Object(w["r"])(null)],t.prototype,"headerTemplate",void 0),He([Object(w["r"])("")],t.prototype,"content",void 0),He([Object(w["r"])("")],t.prototype,"cssClass",void 0),He([Object(w["r"])(!1)],t.prototype,"disabled",void 0),He([Object(w["r"])(!0)],t.prototype,"visible",void 0),He([Object(w["r"])()],t.prototype,"id",void 0),t}(w["e"]),Pt=function(e){function t(t,i){var n=e.call(this,t,i)||this;return n.show={},n.hide={},n.maxHeight=0,n.title="Close",n.isInteracted=!1,n.lastIndex=0,n.isAdd=!1,n.isIconAlone=!1,n.draggableItems=[],n.resizeContext=n.refreshActiveTabBorder.bind(n),n.keyConfigs={tab:"tab",home:"home",end:"end",enter:"enter",space:"space",delete:"delete",moveLeft:"leftarrow",moveRight:"rightarrow",moveUp:"uparrow",moveDown:"downarrow"},n}return Fe(t,e),t.prototype.destroy=function(){var t=this;if((this.isReact||this.isAngular)&&this.clearTemplate(),Object(w["T"])(this.tbObj)||(this.tbObj.destroy(),this.tbObj=null),this.unWireEvents(),["role","aria-disabled","aria-activedescendant","tabindex","aria-orientation","aria-owns"].forEach(function(e){t.element.removeAttribute(e)}),this.expTemplateContent(),this.isTemplate){var i=Object(w["jb"])("."+Ve+" > ."+_e,this.element);this.element.classList.remove(Ke),Object(w["T"])(i)||(i.innerHTML=this.cnt)}else while(this.element.firstElementChild)Object(w["fb"])(this.element.firstElementChild);if(this.btnCls&&(this.btnCls=null),this.hdrEle=null,this.cntEle=null,this.tbItems=null,this.tbItem=null,this.tbPop=null,this.prevItem=null,this.popEle=null,this.bdrLine=null,this.content=null,this.dragItem=null,this.cloneElement=null,this.draggingItems=[],this.draggableItems&&this.draggableItems.length>0){for(var n=0;n<this.draggableItems.length;n++)this.draggableItems[n].destroy(),this.draggableItems[n]=null;this.draggableItems=[]}e.prototype.destroy.call(this),this.trigger("destroyed")},t.prototype.refresh=function(){this.isReact&&this.clearTemplate(),e.prototype.refresh.call(this),this.isReact&&this.renderReactTemplates()},t.prototype.preRender=function(){var e=Object(w["A"])(this.element,"."+_e);this.prevIndex=0,this.isNested=!1,this.isPopup=!1,this.initRender=!0,this.isSwipeed=!1,this.itemIndexArray=[],this.templateEle=[],this.allowDragAndDrop&&(this.dragArea=Object(w["T"])(this.dragArea)?"#"+this.element.id+" ."+qe:this.dragArea),Object(w["T"])(e)||(e.parentElement.classList.add(Ue),this.isNested=!0);var t=w["d"].info.name,i="msie"===t?"e-ie":"edge"===t?"e-edge":"safari"===t?"e-safari":"";Object(w["mb"])(this.element,{width:Object(w["H"])(this.width),height:Object(w["H"])(this.height)}),this.setCssClass(this.element,this.cssClass,!0),Object(w["w"])(this.element,{role:"tablist","aria-disabled":"false","aria-activedescendant":"","aria-owns":this.element.id+"_tab_header_items"}),this.setCssClass(this.element,i,!0),this.updatePopAnimationConfig()},t.prototype.render=function(){this.btnCls=this.createElement("span",{className:Ze+" "+it,attrs:{title:this.title}}),this.tabId=this.element.id.length>0?"-"+this.element.id:Object(w["O"])(),this.renderContainer(),this.wireEvents(),this.initRender=!1},t.prototype.renderContainer=function(){var e=this.element;if(this.items.forEach(function(e,t){Object(w["T"])(e.id)&&!Object(w["T"])(e.setProperties)&&e.setProperties({id:Rt+t.toString()},!0)}),this.items.length>0&&0===e.children.length)e.appendChild(this.createElement("div",{className:_e})),this.setOrientation(this.headerPlacement,this.createElement("div",{className:qe})),this.isTemplate=!1;else if(this.element.children.length>0){this.isTemplate=!0,e.classList.add(Ke);var t=e.querySelector("."+qe);t&&"Bottom"===this.headerPlacement&&this.setOrientation(this.headerPlacement,t)}if(!Object(w["T"])(Object(w["jb"])("."+qe,this.element))&&!Object(w["T"])(Object(w["jb"])("."+_e,this.element))){if(this.renderHeader(),this.tbItems=Object(w["jb"])("."+qe+" ."+dt,this.element),Object(w["T"])(this.tbItems)||Object(w["ib"])(this.tbItems,{selector:".e-tab-wrap"}),this.renderContent(),Object(w["kb"])("."+ct,this.element).length>0){this.tbItems=Object(w["jb"])("."+qe+" ."+dt,this.element),this.bdrLine=this.createElement("div",{className:st+" "+Qe+" "+bt});var i=Object(w["jb"])("."+this.scrCntClass,this.tbItems);Object(w["T"])(i)?this.tbItems.insertBefore(this.bdrLine,this.tbItems.firstChild):i.insertBefore(this.bdrLine,i.firstChild),this.setContentHeight(!0),this.select(this.selectedItem)}if(!Object(w["T"])(this.tbItem))for(var n=0;n<this.items.length;n++)if(this.items[n]){var r=this.items[n].id;this.tbItem[n].setAttribute("data-id",r)}this.setRTL(this.enableRtl)}},t.prototype.renderHeader=function(){var e=this,t=this.headerPlacement,i=[];if(this.hdrEle=this.getTabHeader(),this.addVerticalClass(),this.isTemplate){this.element.children.length>1&&this.element.children[1].classList.contains(qe)&&this.setProperties({headerPlacement:"Bottom"},!0);for(var n=this.hdrEle.children.length,r=[],s=0;s<n;s++)r.push(this.hdrEle.children.item(s).innerHTML);if(n>0){while(this.hdrEle.firstElementChild)Object(w["F"])(this.hdrEle.firstElementChild);var a=this.createElement("div",{className:Ge});this.hdrEle.appendChild(a),r.forEach(function(t,i){e.lastIndex=i;var n={className:We,id:We+e.tabId+"_"+i,attrs:{role:"tab","aria-controls":_e+e.tabId+"_"+i,"aria-selected":"false"}},r=e.createElement("span",{className:rt,innerHTML:t,attrs:{role:"presentation"}}).outerHTML,s=e.createElement("div",{className:ot,innerHTML:r+e.btnCls.outerHTML}).outerHTML,o=e.createElement("div",{className:at,innerHTML:s,attrs:{tabIndex:"-1"}});a.appendChild(e.createElement("div",n)),Object(w["kb"])("."+We,a)[i].appendChild(o)})}}else i=this.parseObject(this.items,0);this.tbObj=new Be["a"]({width:"Left"===t||"Right"===t?"auto":"100%",height:"Left"===t||"Right"===t?"100%":"auto",overflowMode:this.overflowMode,items:0!==i.length?i:[],clicked:this.clickHandler.bind(this),scrollStep:this.scrollStep,enableHtmlSanitizer:this.enableHtmlSanitizer,cssClass:this.cssClass}),this.tbObj.isStringTemplate=!0,this.tbObj.createElement=this.createElement,this.tbObj.appendTo(this.hdrEle),Object(w["w"])(this.hdrEle,{"aria-label":"tab-header"}),this.updateOrientationAttribute(),this.setCloseButton(this.showCloseButton);var o=this.tbObj.element.querySelector("."+dt);Object(w["T"])(o)||((Object(w["T"])(o.id)||""===o.id)&&(o.id=this.element.id+"_tab_header_items"),this.element.setAttribute("aria-owns",o.id))},t.prototype.renderContent=function(){this.cntEle=Object(w["jb"])("."+_e,this.element);var e=Object(w["kb"])("."+ct,this.element);if(this.isTemplate){this.cnt=this.cntEle.children.length>0?this.cntEle.innerHTML:"";for(var t=this.cntEle.children,i=0;i<e.length;i++)t.length-1>=i&&(Object(w["u"])([t.item(i)],We),Object(w["w"])(t.item(i),{role:"tabpanel","aria-labelledby":We+this.tabId+"_"+i}),t.item(i).id=_e+this.tabId+"_"+i)}},t.prototype.reRenderItems=function(){this.renderContainer(),Object(w["T"])(this.cntEle)||(this.touchModule=new w["t"](this.cntEle,{swipe:this.swipeHandler.bind(this)}))},t.prototype.parseObject=function(e,t){var i=this,n=Object(w["kb"])(".e-tab-header ."+ct,this.element),r=this.lastIndex;if(!this.isReplace&&n.length>0){var s=[];n.forEach(function(e){s.push(parseInt(e.id.slice(e.id.indexOf("_")+1),10))}),r=Math.max.apply(Math,s)}var a,o=[],l=[];return e.forEach(function(e,s){var d=Object(w["T"])(e.header)||Object(w["T"])(e.header.iconPosition)?"":e.header.iconPosition,c=Object(w["T"])(e.header)||Object(w["T"])(e.header.iconCss)?"":e.header.iconCss;if(Object(w["T"])(e.headerTemplate)&&(Object(w["T"])(e.header)||Object(w["T"])(e.header.text)||0===e.header.text.length&&""===c))l.push(s);else{var h,p=e.headerTemplate||e.header.text;if("string"===typeof p&&i.enableHtmlSanitizer&&(p=w["s"].sanitize(p)),i.isReplace&&!Object(w["T"])(i.tbId)&&""!==i.tbId){var u=i.tbId.indexOf("_");h=parseInt(i.tbId.substring(u+1),10),i.tbId=""}else h=t+s;i.lastIndex=0===n.length?s:i.isReplace?h:r+1+s;var m=e.disabled?" "+Je+" "+vt:"",g=!1===e.visible?" "+Qe:"";a=i.createElement("div",{className:rt,attrs:{role:"presentation"}});var f,b=p instanceof Object?p.outerHTML:p,v=!Object(w["T"])(b)&&""!==b;Object(w["T"])(p.tagName)?i.headerTextCompile(a,p,s):a.appendChild(p);var y=i.createElement("span",{className:Ze+" "+lt+" "+et+"-"+d+" "+c}),C=i.createElement("div",{className:ot});C.appendChild(a),""!==p&&void 0!==p&&""!==c?("left"===d||"top"===d?C.insertBefore(y,C.firstElementChild):C.appendChild(y),f=a,i.isIconAlone=!1):(f=""===c?a:y,f===y&&(Object(w["F"])(a),C.appendChild(y),i.isIconAlone=!0));var O=e.disabled?{}:{tabIndex:"-1"};C.appendChild(i.btnCls.cloneNode(!0));var T=i.createElement("div",{className:at,attrs:O});T.appendChild(C),i.itemIndexArray===[]?i.itemIndexArray.push(We+i.tabId+"_"+i.lastIndex):i.itemIndexArray.splice(t+s,0,We+i.tabId+"_"+i.lastIndex);var k={id:We+i.tabId+"_"+i.lastIndex,role:"tab","aria-selected":"false"},S={htmlAttributes:k,template:T};S.cssClass=(void 0!==e.cssClass?e.cssClass:" ")+" "+m+" "+g+" "+(""!==c?"e-i"+d:"")+" "+(v?"":et),"top"!==d&&"bottom"!==d||i.element.classList.add("e-vertical-icon"),o.push(S),s++}}),this.isAdd||l.forEach(function(e){i.items.splice(e,1)}),this.isIconAlone?this.element.classList.add(tt):this.element.classList.remove(tt),o},t.prototype.removeActiveClass=function(){var e=this.getTabHeader();if(e){var t=Object(w["kb"])("."+ct+"."+Xe,e);[].slice.call(t).forEach(function(e){return e.classList.remove(Xe)})}},t.prototype.checkPopupOverflow=function(e){this.tbPop=Object(w["jb"])("."+ht,this.element);var t=Object(w["jb"])(".e-hor-nav",this.element),i=Object(w["jb"])("."+dt,this.element),n=i.lastChild,r=!1;return!this.isVertical()&&(this.enableRtl&&t.offsetLeft+t.offsetWidth>i.offsetLeft||!this.enableRtl&&t.offsetLeft<i.offsetWidth)?r=!0:this.isVertical()&&t.offsetTop<n.offsetTop+n.offsetHeight&&(r=!0),r&&(e.classList.add(pt),this.tbPop.insertBefore(e,Object(w["kb"])("."+pt,this.tbPop)[0])),!0},t.prototype.popupHandler=function(e){var t=e.querySelector(".e-ripple-element");Object(w["T"])(t)||(t.outerHTML="",e.querySelector("."+at).classList.remove("e-ripple")),this.tbItem=Object(w["kb"])("."+dt+" ."+ct,this.hdrEle);var i=this.tbItem[this.tbItem.length-1];if(0!==this.tbItem.length){if(e.classList.remove(pt),e.removeAttribute("style"),this.tbItems.appendChild(e),this.actEleId=e.id,this.checkPopupOverflow(i)){var n=this.tbItems.lastChild.previousElementSibling;this.checkPopupOverflow(n)}this.isPopup=!0}return Object(w["kb"])("."+ct,this.tbItems).length-1},t.prototype.updateOrientationAttribute=function(){Object(w["w"])(this.element,{"aria-orientation":this.isVertical()?"vertical":"horizontal"})},t.prototype.setCloseButton=function(e){var t=Object(w["jb"])("."+qe,this.element);!0===e?t.classList.add(nt):t.classList.remove(nt),this.tbObj.refreshOverflow(),this.refreshActiveTabBorder()},t.prototype.prevCtnAnimation=function(e,t){var i;this.enableRtl||this.element.classList.contains($e);return i=this.isPopup||e<=t?"SlideLeftIn"===this.animation.previous.effect?{name:"SlideLeftOut",duration:this.animation.previous.duration,timingFunction:this.animation.previous.easing}:null:"SlideRightIn"===this.animation.next.effect?{name:"SlideRightOut",duration:this.animation.next.duration,timingFunction:this.animation.next.easing}:null,i},t.prototype.triggerPrevAnimation=function(e,t){var i=this,n=this.prevCtnAnimation(t,this.selectedItem);Object(w["T"])(n)?e.classList.remove(Xe):(n.begin=function(){Object(w["mb"])(e,{position:"absolute"}),e.classList.add(ft),e.classList.add("e-view")},n.end=function(){e.style.display="none",e.classList.remove(Xe),e.classList.remove(ft),e.classList.remove("e-view"),Object(w["mb"])(e,{display:"",position:""}),0!==e.childNodes.length||i.isTemplate||Object(w["F"])(e)},new w["b"](n).animate(e))},t.prototype.triggerAnimation=function(e,t){var i,n=this,r=this.prevIndex,s=[].slice.call(this.element.querySelector("."+_e).children);s.forEach(function(e){e.id===n.prevActiveEle&&(i=e)});var a=this.tbItem[r],o=this.getTrgContent(this.cntEle,this.extIndex(e));if(Object(w["T"])(i)&&!Object(w["T"])(a)){var l=this.extIndex(a.id);i=this.getTrgContent(this.cntEle,l)}if(Object(w["T"])(o)||(this.prevActiveEle=o.id),this.initRender||!1===t||this.animation==={}||Object(w["T"])(this.animation))i&&i!==o&&i.classList.remove(Xe);else{var d,c=Object(w["jb"])("."+_e,this.element);if(this.prevIndex>this.selectedItem&&!this.isPopup){var h=this.animation.previous.effect;d={name:"None"===h?"":"SlideLeftIn"!==h?h:"SlideLeftIn",duration:this.animation.previous.duration,timingFunction:this.animation.previous.easing}}else if(this.isPopup||this.prevIndex<this.selectedItem||this.prevIndex===this.selectedItem){var p=this.animation.next.effect;d={name:"None"===p?"":"SlideRightIn"!==p?p:"SlideRightIn",duration:this.animation.next.duration,timingFunction:this.animation.next.easing}}d.progress=function(){c.classList.add(ft),n.setActiveBorder()},d.end=function(){c.classList.remove(ft),o.classList.add(Xe)},this.initRender||Object(w["T"])(i)||this.triggerPrevAnimation(i,r),this.isPopup=!1,""===d.name?o.classList.add(Xe):new w["b"](d).animate(o)}},t.prototype.keyPressed=function(e){var t=Object(w["A"])(e,"."+qe+" ."+ct),i=this.getEleIndex(t);!Object(w["T"])(this.popEle)&&e.classList.contains("e-hor-nav")?this.popEle.classList.contains(mt)?this.popObj.hide(this.hide):this.popObj.show(this.show):e.classList.contains("e-scroll-nav")?e.click():Object(w["T"])(t)||!1!==t.classList.contains(Xe)||(this.selectTab(i,null,!0),Object(w["T"])(this.popEle)||this.popObj.hide(this.hide))},t.prototype.getTabHeader=function(){if(!Object(w["T"])(this.element)){var e=[].slice.call(this.element.children).filter(function(e){return e.classList.contains(qe)});if(e.length>0)return e[0];var t=[].slice.call(this.element.children).filter(function(e){return!e.classList.contains(ze)})[0];if(t)return[].slice.call(t.children).filter(function(e){return e.classList.contains(qe)})[0]}},t.prototype.getEleIndex=function(e){return Array.prototype.indexOf.call(Object(w["kb"])("."+ct,this.getTabHeader()),e)},t.prototype.extIndex=function(e){return e.replace(We+this.tabId+"_","")},t.prototype.expTemplateContent=function(){var e=this;this.templateEle.forEach(function(t){Object(w["T"])(e.element.querySelector(t))||(document.body.appendChild(e.element.querySelector(t)).style.display="none")})},t.prototype.templateCompile=function(e,t,i){var n=this.createElement("div");this.compileElement(n,t,"content",i),0!==n.childNodes.length&&e.appendChild(n),this.isReact&&this.renderReactTemplates()},t.prototype.compileElement=function(e,t,i,n){var r,s;"string"===typeof t?(t=t.trim(),this.isVue?r=Object(w["B"])(w["s"].sanitize(t)):e.innerHTML=w["s"].sanitize(t)):r=Object(w["B"])(t),Object(w["T"])(r)||(s=r({},this,i)),!Object(w["T"])(r)&&s.length>0&&[].slice.call(s).forEach(function(t){e.appendChild(t)})},t.prototype.headerTextCompile=function(e,t,i){this.compileElement(e,t,"headerTemplate",i)},t.prototype.getContent=function(e,t,i,n){var r;if(t=Object(w["T"])(t)?"":t,"string"===typeof t||Object(w["T"])(t.innerHTML))if("string"===typeof t&&this.enableHtmlSanitizer&&(t=w["s"].sanitize(t)),"."===t[0]||"#"===t[0])if(document.querySelectorAll(t).length){var s=document.querySelector(t);r=s.outerHTML.trim(),"clone"===i?e.appendChild(s.cloneNode(!0)):(e.appendChild(s),s.style.display="")}else this.templateCompile(e,t,n);else this.templateCompile(e,t,n);else e.appendChild(t);Object(w["T"])(r)||-1===this.templateEle.indexOf(t.toString())&&this.templateEle.push(t.toString())},t.prototype.getTrgContent=function(e,t){var i;return i=this.element.classList.contains(Ue)?Object(w["jb"])("."+Ue+"> ."+_e+" > #"+_e+this.tabId+"_"+t,this.element):this.findEle(e.children,_e+this.tabId+"_"+t),i},t.prototype.findEle=function(e,t){for(var i,n=0;n<e.length;n++)if(e[n].id===t){i=e[n];break}return i},t.prototype.isVertical=function(){var e="Left"===this.headerPlacement||"Right"===this.headerPlacement;return this.scrCntClass=e?Ct:yt,e},t.prototype.addVerticalClass=function(){if(this.isVertical()){var e="Left"===this.headerPlacement?Tt:kt;Object(w["u"])([this.hdrEle],[Ot,e]),this.element.classList.contains(Ue)?Object(w["u"])([this.hdrEle],[wt,e]):Object(w["u"])([this.element],[wt,e])}"Bottom"===this.headerPlacement&&Object(w["u"])([this.hdrEle],[St])},t.prototype.updatePopAnimationConfig=function(){this.show={name:this.isVertical()?"FadeIn":"SlideDown",duration:100},this.hide={name:this.isVertical()?"FadeOut":"SlideUp",duration:100}},t.prototype.changeOrientation=function(e){this.setOrientation(e,this.hdrEle);var t=this.hdrEle.querySelector("."+Xe),i=!!this.hdrEle.classList.contains(Ot);Object(w["gb"])([this.element],[wt]),Object(w["gb"])([this.hdrEle],[Ot,Tt,kt]),i!==this.isVertical()&&(this.changeToolbarOrientation(),!Object(w["T"])(t)&&t.classList.contains(pt)&&this.popupHandler(t)),this.addVerticalClass(),this.updateOrientationAttribute(),this.setActiveBorder(),this.focusItem()},t.prototype.focusItem=function(){var e=Object(w["jb"])(" #"+We+this.tabId+"_"+this.selectedItem,this.hdrEle);Object(w["T"])(e)||e.firstElementChild.focus()},t.prototype.changeToolbarOrientation=function(){this.tbObj.setProperties({height:this.isVertical()?"100%":"auto",width:this.isVertical()?"auto":"100%"},!0),this.tbObj.changeOrientation(),this.updatePopAnimationConfig()},t.prototype.setOrientation=function(e,t){var i=Array.prototype.indexOf.call(this.element.children,t),n=Array.prototype.indexOf.call(this.element.children,this.element.querySelector("."+_e));"Bottom"===e&&n>i?this.element.appendChild(t):(Object(w["gb"])([t],[St]),this.element.insertBefore(t,Object(w["jb"])("."+_e,this.element)))},t.prototype.setCssClass=function(e,t,i){if(""!==t)for(var n=t.split(" "),r=0;r<n.length;r++)i?e.classList.add(n[r]):e.classList.remove(n[r])},t.prototype.setContentHeight=function(e){if(this.element.classList.contains(jt)&&Object(w["gb"])([this.element],[jt]),!Object(w["T"])(this.cntEle)){var t=this.getTabHeader();if("None"===this.heightAdjustMode){if("auto"===this.height)return;this.isVertical()||Object(w["mb"])(this.cntEle,{height:this.element.offsetHeight-t.offsetHeight+"px"})}else if("Fill"===this.heightAdjustMode)Object(w["u"])([this.element],[jt]),Object(w["mb"])(this.element,{height:"100%"}),Object(w["mb"])(this.cntEle,{height:this.element.offsetHeight-t.offsetHeight+"px"});else if("Auto"===this.heightAdjustMode){if(!0===this.isTemplate)for(var i=Object(w["kb"])("."+_e+" > ."+We,this.element),n=0;n<i.length;n++)i[n].setAttribute("style","display:block; visibility: visible"),this.maxHeight=Math.max(this.maxHeight,this.getHeight(i[n])),i[n].style.removeProperty("display"),i[n].style.removeProperty("visibility");else{this.cntEle=Object(w["jb"])("."+_e,this.element),!0===e&&this.cntEle.appendChild(this.createElement("div",{id:_e+this.tabId+"_0",className:We+" "+Xe,attrs:{role:"tabpanel","aria-labelledby":We+this.tabId+"_0"}}));var r=this.cntEle.children.item(0);for(n=0;n<this.items.length;n++){this.getContent(r,this.items[n].content,"clone",n),this.maxHeight=Math.max(this.maxHeight,this.getHeight(r));while(r.firstChild)r.removeChild(r.firstChild)}this.isReact&&this.clearTemplate(["content"]),this.templateEle=[],this.getContent(r,this.items[0].content,"render",0),this.prevIndex!==this.selectedItem&&r.classList.remove(Xe)}Object(w["mb"])(this.cntEle,{height:this.maxHeight+"px"})}else Object(w["mb"])(this.cntEle,{height:"auto"})}},t.prototype.getHeight=function(e){var t=window.getComputedStyle(e);return e.offsetHeight+parseFloat(t.getPropertyValue("padding-top"))+parseFloat(t.getPropertyValue("padding-bottom"))+parseFloat(t.getPropertyValue("margin-top"))+parseFloat(t.getPropertyValue("margin-bottom"))},t.prototype.setActiveBorder=function(){var e=this.getTabHeader(),t=Object(w["jb"])("."+ct+"."+Xe,e);if(!Object(w["T"])(t)){this.reorderActiveTab?e&&e.classList.remove(Dt):(t.classList.contains(pt)&&!this.bdrLine.classList.contains(Qe)&&this.bdrLine.classList.add(Qe),e&&!e.classList.contains(Dt)&&e.classList.add(Dt));var i=Object(w["A"])(t,"."+Ve);if(this.element===i){this.tbItems=Object(w["jb"])("."+dt,e);var n=Object(w["jb"])("."+st,e),r=Object(w["jb"])("."+dt+" ."+this.scrCntClass,e);if(this.isVertical()){Object(w["mb"])(n,{left:"",right:""});var s=Object(w["T"])(r)?this.tbItems.offsetHeight:r.offsetHeight;0!==s?Object(w["mb"])(n,{top:t.offsetTop+"px",height:t.offsetHeight+"px"}):Object(w["mb"])(n,{top:0,height:0})}else{if("MultiRow"===this.overflowMode){var a=Object(w["jb"])("."+st,this.element);Object(w["mb"])(a,{top:t.offsetHeight+t.offsetTop+"px",height:""})}else Object(w["mb"])(n,{top:"",height:""});var o=Object(w["T"])(r)?this.tbItems.offsetWidth:r.offsetWidth;0!==o?Object(w["mb"])(n,{left:t.offsetLeft+"px",right:o-(t.offsetLeft+t.offsetWidth)+"px"}):Object(w["mb"])(n,{left:"auto",right:"auto"})}Object(w["T"])(this.bdrLine)||t.classList.contains(pt)||this.bdrLine.classList.remove(Qe)}}},t.prototype.setActive=function(e,t,i){void 0===t&&(t=!1),void 0===i&&(i=!1),this.tbItem=Object(w["kb"])("."+ct,this.getTabHeader());var n=this.tbItem[e];if(!(e<0||isNaN(e)||0===this.tbItem.length))if(e>=0&&!t&&(this.allowServerDataBinding=!1,this.setProperties({selectedItem:e},!0),this.allowServerDataBinding=!0,this.initRender||this.serverDataBind()),n.classList.contains(Xe))this.setActiveBorder();else{if(!this.isTemplate){var r=this.tbItem[this.prevIndex];Object(w["T"])(r)||r.removeAttribute("aria-controls"),Object(w["w"])(n,{"aria-controls":_e+this.tabId+"_"+e})}var s=n.id;this.removeActiveClass(),n.classList.add(Xe),this.tbItem[this.prevIndex].setAttribute("aria-selected","false"),n.setAttribute("aria-selected","true");var a=Number(this.extIndex(s));if(Object(w["T"])(this.prevActiveEle)&&(this.prevActiveEle=_e+this.tabId+"_"+a),Object(w["w"])(this.element,{"aria-activedescendant":s}),this.isTemplate){if(Object(w["jb"])("."+_e,this.element).children.length>0){var o=this.findEle(Object(w["jb"])("."+_e,this.element).children,_e+this.tabId+"_"+a);Object(w["T"])(o)||o.classList.add(Xe),this.triggerAnimation(s,this.enableAnimation)}}else{this.cntEle=Object(w["jb"])("."+Ve+" > ."+_e,this.element);var l=this.getTrgContent(this.cntEle,this.extIndex(s));if(Object(w["T"])(l)){this.cntEle.appendChild(this.createElement("div",{id:_e+this.tabId+"_"+this.extIndex(s),className:We+" "+Xe,attrs:{role:"tabpanel","aria-labelledby":We+this.tabId+"_"+this.extIndex(s)}}));var d=this.getTrgContent(this.cntEle,this.extIndex(s)),c=Array.prototype.indexOf.call(this.itemIndexArray,s);this.getContent(d,this.items[c].content,"render",c)}else l.classList.add(Xe);this.triggerAnimation(s,this.enableAnimation)}if(this.setActiveBorder(),this.refreshItemVisibility(n),!this.initRender&&!t){n.firstElementChild.focus();var h={previousItem:this.prevItem,previousIndex:this.prevIndex,selectedItem:n,selectedIndex:e,selectedContent:Object(w["jb"])("#"+_e+this.tabId+"_"+this.selectingID,this.content),isSwiped:this.isSwipeed,isInteracted:i};this.trigger("selected",h)}}},t.prototype.setItems=function(e){this.isReplace=!0,this.tbItems=Object(w["jb"])("."+dt,this.getTabHeader()),this.tbObj.items=this.parseObject(e,0),this.tbObj.dataBind(),this.isReplace=!1},t.prototype.setRTL=function(e){this.tbObj.enableRtl=e,this.tbObj.dataBind(),this.setCssClass(this.element,$e,e),this.refreshActiveBorder()},t.prototype.refreshActiveBorder=function(){Object(w["T"])(this.bdrLine)||this.bdrLine.classList.add(Qe),this.setActiveBorder()},t.prototype.showPopup=function(e){var t=Object(w["jb"])(".e-popup.e-toolbar-pop",this.hdrEle);if(t.classList.contains("e-popup-close")){var i=t&&t.ej2_instances[0];i.position.X="Left"===this.headerPlacement?"left":"right",i.dataBind(),i.show(e)}},t.prototype.bindDraggable=function(){var e=this;if(this.allowDragAndDrop){var t=this.element.querySelector("."+qe);if(t){var i=t.querySelectorAll("."+ct);i.forEach(function(t){e.initializeDrag(t)})}}},t.prototype.wireEvents=function(){this.bindDraggable(),window.addEventListener("resize",this.resizeContext),w["l"].add(this.element,"mouseover",this.hoverHandler,this),w["l"].add(this.element,"keydown",this.spaceKeyDown,this),Object(w["T"])(this.cntEle)||(this.touchModule=new w["t"](this.cntEle,{swipe:this.swipeHandler.bind(this)})),this.keyModule=new w["n"](this.element,{keyAction:this.keyHandler.bind(this),keyConfigs:this.keyConfigs}),this.tabKeyModule=new w["n"](this.element,{keyAction:this.keyHandler.bind(this),keyConfigs:{openPopup:"shift+f10",tab:"tab",shiftTab:"shift+tab"},eventName:"keydown"})},t.prototype.unWireEvents=function(){Object(w["T"])(this.keyModule)||this.keyModule.destroy(),Object(w["T"])(this.tabKeyModule)||this.tabKeyModule.destroy(),Object(w["T"])(this.cntEle)||Object(w["T"])(this.touchModule)||(this.touchModule.destroy(),this.touchModule=null),window.removeEventListener("resize",this.resizeContext),w["l"].remove(this.element,"mouseover",this.hoverHandler),w["l"].remove(this.element,"keydown",this.spaceKeyDown),this.element.classList.remove($e),this.element.classList.remove(Ye)},t.prototype.clickHandler=function(e){this.element.classList.remove(Ye);var t=e.originalEvent.target,i=Object(w["A"])(t,"."+ct),n=this.getEleIndex(i);t.classList.contains(it)?this.removeTab(n):this.isVertical()&&Object(w["A"])(t,"."+ut)?this.showPopup(this.show):(this.isPopup=!1,Object(w["T"])(i)||n===this.selectedItem&&n===this.prevIndex||this.selectTab(n,e.originalEvent,!0))},t.prototype.swipeHandler=function(e){if(!(e.velocity<3&&Object(w["T"])(e.originalEvent.changedTouches))){this.isNested&&this.element.setAttribute("data-swipe","true");var t=this.element.querySelector('[data-swipe="true"]');if(t)t.removeAttribute("data-swipe");else{if(this.isSwipeed=!0,"Right"===e.swipeDirection&&0!==this.selectedItem){for(var i=this.selectedItem-1;i>=0;i--)if(!this.tbItem[i].classList.contains(Qe)){this.selectTab(i,null,!0);break}}else if("Left"===e.swipeDirection&&this.selectedItem!==Object(w["kb"])("."+ct,this.element).length-1)for(var n=this.selectedItem+1;n<this.tbItem.length;n++)if(!this.tbItem[n].classList.contains(Qe)){this.selectTab(n,null,!0);break}this.isSwipeed=!1}}},t.prototype.spaceKeyDown=function(e){if(32===e.keyCode&&32===e.which||35===e.keyCode&&35===e.which){var t=Object(w["A"])(e.target,"."+qe);Object(w["T"])(t)||e.preventDefault()}},t.prototype.keyHandler=function(e){if(!this.element.classList.contains(Je)){this.element.classList.add(Ye);var t=e.target,i=this.getTabHeader(),n=Object(w["jb"])("."+Xe,i);this.popEle=Object(w["jb"])("."+ht,i),Object(w["T"])(this.popEle)||(this.popObj=this.popEle.ej2_instances[0]);var r=Object(w["A"])(document.activeElement,"."+ct),s=Object(w["A"])(t,"."+ct);switch(e.action){case"space":case"enter":if(t.parentElement.classList.contains(Je))return;if("enter"===e.action&&t.classList.contains("e-hor-nav")){this.showPopup(this.show);break}this.keyPressed(t);break;case"tab":case"shiftTab":t.classList.contains(at)&&!1===Object(w["A"])(t,"."+ct).classList.contains(Xe)&&t.setAttribute("tabindex","-1"),this.popObj&&Object(w["Y"])(this.popObj.element)&&this.popObj.hide(this.hide),n.children.item(0).setAttribute("tabindex","0");break;case"moveLeft":case"moveRight":Object(w["T"])(r)||this.refreshItemVisibility(r);break;case"openPopup":e.preventDefault(),!Object(w["T"])(this.popEle)&&this.popEle.classList.contains(gt)&&this.popObj.show(this.show);break;case"delete":if(!0===this.showCloseButton&&!Object(w["T"])(s)){var a=s.nextSibling;!Object(w["T"])(a)&&a.classList.contains(ct)&&a.firstElementChild.focus(),this.removeTab(this.getEleIndex(s))}this.setActiveBorder();break}}},t.prototype.refreshActiveTabBorder=function(){var e=Object(w["jb"])("."+ct+"."+pt+"."+Xe,this.element);!Object(w["T"])(e)&&this.reorderActiveTab&&this.select(this.getEleIndex(e)),this.refreshActiveBorder()},t.prototype.refreshItemVisibility=function(e){var t=Object(w["jb"])("."+this.scrCntClass,this.tbItems);if(!this.isVertical()&&!Object(w["T"])(t)){var i=Object(w["jb"])(".e-hscroll-bar",this.tbItems),n=i.scrollLeft,r=n+i.offsetWidth,s=e.offsetLeft,a=e.offsetWidth,o=e.offsetLeft+e.offsetWidth;if(n<s&&r<o){var l=r-s;i.scrollLeft=n+(a-l)}else if(n>s&&r>o){l=o-n;i.scrollLeft=n-(a-l)}}},t.prototype.hoverHandler=function(e){var t=e.target;!Object(w["T"])(t.classList)&&t.classList.contains(it)&&t.setAttribute("title",new w["o"]("tab",{closeButtonTitle:this.title},this.locale).getConstant("closeButtonTitle"))},t.prototype.evalOnPropertyChangeItems=function(e,t){if(e.items instanceof Array&&t.items instanceof Array)if(this.lastIndex=0,Object(w["T"])(this.tbObj))this.reRenderItems();else{(this.isReact||this.isAngular)&&this.clearTemplate(),this.setItems(e.items),this.templateEle.length>0&&this.expTemplateContent(),this.templateEle=[];var i=Object(w["jb"])("."+Ve+" > ."+_e,this.element);while(i.firstElementChild)Object(w["F"])(i.firstElementChild);this.select(this.selectedItem),this.draggableItems=[],this.bindDraggable()}else for(var n=Object.keys(e.items),r=0;r<n.length;r++)for(var s=parseInt(Object.keys(e.items)[r],10),a=Object.keys(e.items[s]),o=0;o<a.length;o++){var l=Object(t.items[s])[a[o]],d=Object(e.items[s])[a[o]],c=this.element.querySelectorAll("."+ct)[s],h=void 0;if(c&&!Object(w["T"])(c.id)&&""!==c.id){var p=c.id.lastIndexOf("_");h=parseInt(c.id.substring(p+1),10)}else h=s;var u=Object(w["jb"])("."+dt+" #"+We+this.tabId+"_"+h,this.element),m=Object(w["jb"])("."+_e+" #"+_e+this.tabId+"_"+h,this.element);if("header"===a[o]||"headerTemplate"===a[o]){var g=Object(w["T"])(this.items[s].header)||Object(w["T"])(this.items[s].header.iconCss)?"":this.items[s].header.iconCss,f=this.items[s].headerTemplate||this.items[s].header.text;if(""===f&&""===g)this.removeTab(s);else{this.tbId=c.id;var b=[];b.push(this.items[s]),this.items.splice(s,1),this.itemIndexArray.splice(s,1),this.tbObj.items.splice(s,1);var v=u.classList.contains(Qe);Object(w["F"])(u),this.isReplace=!0,this.addTab(b,s),v&&this.hideTab(s),this.isReplace=!1}}if("content"===a[o]&&!Object(w["T"])(m)){var y="string"===typeof d||Object(w["T"])(d.innerHTML);if(y&&("."===d[0]||"#"===d[0])&&d.length){var C=document.querySelector(d);m.appendChild(C),C.style.display=""}else""===d&&"#"===l[0]?(document.body.appendChild(this.element.querySelector(l)).style.display="none",m.innerHTML=d):this.isReact?(m.innerHTML="",this.templateCompile(m,d,s)):"function"!==typeof d&&(m.innerHTML=d)}"cssClass"===a[o]&&(Object(w["T"])(u)||(u.classList.remove(l),u.classList.add(d)),Object(w["T"])(m)||(m.classList.remove(l),m.classList.add(d))),"disabled"===a[o]&&this.enableTab(s,!0!==d),"visible"===a[o]&&this.hideTab(s,!0!==d)}},t.prototype.initializeDrag=function(e){var t=this,i=new w["i"](e,{dragArea:this.dragArea,dragTarget:"."+ct,clone:!0,helper:this.helper.bind(this),dragStart:this.itemDragStart.bind(this),drag:function(e){var i,n,r=t.getEleIndex(t.dragItem),s={draggedItem:t.dragItem,event:e.event,target:e.target,droppedItem:e.target.closest("."+ct),clonedElement:t.cloneElement,index:r};if(Object(w["T"])(e.target.closest("."+Ve))||e.target.closest("."+Ve).isEqualNode(t.element)||t.dragArea==="."+qe){if(e.target.closest(t.dragArea)||"Popup"===t.overflowMode?(document.body.style.cursor="",t.dragItem.querySelector("."+at).style.visibility="hidden",t.cloneElement.classList.contains(Qe)&&Object(w["gb"])([t.cloneElement],Qe)):(document.body.style.cursor="not-allowed",Object(w["u"])([t.cloneElement],Qe),t.dragItem.classList.contains(Qe)&&Object(w["gb"])([t.dragItem],Qe),t.dragItem.querySelector("."+at).style.visibility="visible"),"Scrollable"===t.overflowMode&&!Object(w["T"])(t.element.querySelector(".e-hscroll"))){var a=t.element.querySelector(".e-scroll-right-nav"),o=t.element.querySelector(".e-scroll-left-nav"),l=t.element.querySelector(".e-hscroll-bar");!Object(w["T"])(a)&&Math.abs(a.offsetWidth/2+a.offsetLeft)>t.cloneElement.offsetLeft+t.cloneElement.offsetWidth&&(l.scrollLeft-=10),!Object(w["T"])(o)&&Math.abs(o.offsetLeft+o.offsetWidth-t.cloneElement.offsetLeft)>o.offsetWidth/2&&(l.scrollLeft+=10)}t.cloneElement.style.pointerEvents="none",n=Object(w["A"])(e.target,"."+ct+".e-draggable");var d=0;"Scrollable"!==t.overflowMode||Object(w["T"])(t.element.querySelector(".e-hscroll"))||(d=t.element.querySelector(".e-hscroll-content").offsetWidth),null!=n&&!n.isSameNode(t.dragItem)&&n.closest("."+Ve).isSameNode(t.dragItem.closest("."+Ve))&&(i=t.getEleIndex(n),i<r&&Math.abs(n.offsetLeft+n.offsetWidth-t.cloneElement.offsetLeft)>n.offsetWidth/2&&t.dragAction(n,r,i),i>r&&Math.abs(n.offsetWidth/2)+n.offsetLeft-d<t.cloneElement.offsetLeft+t.cloneElement.offsetWidth&&t.dragAction(n,r,i)),t.droppedIndex=t.getEleIndex(t.dragItem),t.trigger("dragging",s)}else t.trigger("dragging",s)},dragStop:this.itemDragStop.bind(this)});this.draggableItems.push(i)},t.prototype.helper=function(e){return this.cloneElement=this.createElement("div"),e.element&&(this.cloneElement=e.element.cloneNode(!0),Object(w["u"])([this.cloneElement],"e-tab-clone-element"),this.element.querySelector("."+qe).classList.contains(nt)&&Object(w["u"])([this.cloneElement],nt),Object(w["gb"])([this.cloneElement.querySelector("."+at)],"e-ripple"),Object(w["T"])(this.cloneElement.querySelector(".e-ripple-element"))||Object(w["fb"])(this.cloneElement.querySelector(".e-ripple-element")),document.body.appendChild(this.cloneElement)),this.cloneElement},t.prototype.itemDragStart=function(e){var t=this;this.draggingItems=this.items.map(function(e){return e}),this.dragItem=e.element;var i={draggedItem:e.element,event:e.event,target:e.target,droppedItem:null,index:this.getEleIndex(this.dragItem),clonedElement:this.cloneElement,cancel:!1};this.trigger("onDragStart",i,function(e){e.cancel?Object(w["F"])(t.cloneElement):(t.removeActiveClass(),Object(w["u"])([t.tbItems.querySelector("."+st)],Qe),t.dragItem.querySelector("."+at).style.visibility="hidden")})},t.prototype.dragAction=function(e,t,i){if(this.items.length>0){var n=this.draggingItems[t];this.draggingItems.splice(t,1),this.draggingItems.splice(i,0,n)}if("MultiRow"===this.overflowMode&&e.parentNode.insertBefore(this.dragItem,e.nextElementSibling),t>i)if(this.dragItem.parentElement.isSameNode(e.parentElement))this.dragItem.parentNode.insertBefore(this.dragItem,e);else if("Extended"===this.overflowMode)if(e.isSameNode(e.parentElement.lastChild)){var r=this.dragItem.parentNode;e.parentNode.insertBefore(this.dragItem,e),r.insertBefore(e.parentElement.lastChild,r.childNodes[0])}else this.dragItem.parentNode.insertBefore(e.parentElement.lastChild,this.dragItem.parentElement.childNodes[0]),e.parentNode.insertBefore(this.dragItem,e);else{var s=e.parentElement.lastChild;if(e.isSameNode(s)){r=this.dragItem.parentNode;e.parentNode.insertBefore(this.dragItem,e),r.insertBefore(s,r.childNodes[0])}else this.dragItem.parentNode.insertBefore(e.parentElement.lastChild,this.dragItem.parentElement.childNodes[0]),e.parentNode.insertBefore(this.dragItem,e)}t<i&&(this.dragItem.parentElement.isSameNode(e.parentElement)?this.dragItem.parentNode.insertBefore(this.dragItem,e.nextElementSibling):"Extended"===this.overflowMode?(this.dragItem.parentElement.appendChild(e.parentElement.firstElementChild),e.parentNode.insertBefore(this.dragItem,e.nextSibling)):(this.dragItem.parentNode.insertBefore(e.parentElement.lastChild,this.dragItem.parentElement.childNodes[0]),e.parentNode.insertBefore(this.dragItem,e)))},t.prototype.itemDragStop=function(e){var t=this;Object(w["F"])(this.cloneElement),this.cloneElement=null,this.dragItem.querySelector("."+at).style.visibility="visible",document.body.style.cursor="";var i={draggedItem:this.dragItem,event:e.event,target:e.target,droppedItem:this.tbItem[this.droppedIndex],clonedElement:null,index:this.droppedIndex,cancel:!1};this.trigger("dragged",i,function(e){e.cancel?t.refresh():t.items.length>0&&t.draggingItems.length>0?(t.items=t.draggingItems,t.selectedItem=t.droppedIndex,t.refresh()):(t.dragItem.querySelector("."+at).style.visibility="",Object(w["gb"])([t.tbItems.querySelector("."+st)],Qe),t.selectTab(t.droppedIndex,null,!0))}),this.dragItem=null},t.prototype.enableTab=function(e,t){var i=Object(w["kb"])("."+ct,this.element)[e];Object(w["T"])(i)||(!0===t?(i.classList.remove(Je,vt),i.firstElementChild.setAttribute("tabindex","-1")):(i.classList.add(Je,vt),i.firstElementChild.removeAttribute("tabindex"),i.classList.contains(Xe)&&this.select(e+1)),Object(w["T"])(this.items[e])||(this.items[e].disabled=!t,this.dataBind()),i.setAttribute("aria-disabled",!0===t?"false":"true"))},t.prototype.addTab=function(e,t){var i=this,n={addedItems:e,cancel:!1};this.isReplace?this.addingTabContent(e,t):this.trigger("adding",n,function(n){n.cancel||i.addingTabContent(e,t)}),this.isReact&&this.renderReactTemplates()},t.prototype.addingTabContent=function(e,t){var i=this,n=0;if(this.hdrEle=Object(w["jb"])("."+qe,this.element),Object(w["T"])(this.hdrEle))this.items=e,this.reRenderItems(),this.bindDraggable();else{var r=Object(w["kb"])(".e-tab-header ."+ct,this.element).length;if(0!==r&&(n=this.lastIndex+1),Object(w["T"])(t)&&(t=r-1),r<t||t<0||isNaN(t))return;0!==r||Object(w["T"])(this.hdrEle)||(this.hdrEle.style.display=""),Object(w["T"])(this.bdrLine)||this.bdrLine.classList.add(Qe),this.tbItems=Object(w["jb"])("."+dt,this.getTabHeader()),this.isAdd=!0;var s=this.parseObject(e,t);this.isAdd=!1;var a,o=0;e.forEach(function(e,r){if(a=e.headerTemplate||e.header.text,Object(w["T"])(e.headerTemplate||e.header)||Object(w["T"])(a)||0===a.length&&!Object(w["T"])(e.header)&&Object(w["T"])(e.header.iconCss)||(s[r]&&(Object(w["T"])(e.id)&&(e.id=Rt+(n+r).toString()),s[r].htmlAttributes["data-id"]=e.id),i.items.splice(t+o,0,e),o++),i.isTemplate&&!Object(w["T"])(e.header)&&!Object(w["T"])(e.header.text)){var l=n+r,d=i.createElement("div",{id:_e+i.tabId+"_"+l,className:We,attrs:{role:"tabpanel","aria-labelledby":We+"_"+l}});i.cntEle.insertBefore(d,i.cntEle.children[t+r]);var c=i.getTrgContent(i.cntEle,l.toString());i.getContent(c,e.content,"render",t)}}),this.tbObj.addItems(s,t),this.isReplace||this.trigger("added",{addedItems:e}),this.selectedItem===t?this.select(t):(this.setActiveBorder(),this.tbItem=Object(w["kb"])("."+ct,this.getTabHeader())),this.bindDraggable()}},t.prototype.removeTab=function(e){var t=this,i=Object(w["kb"])("."+ct,this.element)[e];if(!Object(w["T"])(i)){var n={removedItem:i,removedIndex:e,cancel:!1};this.trigger("removing",n,function(n){if(!n.cancel){t.tbObj.removeItems(e),t.allowDragAndDrop&&e!==Array.prototype.indexOf.call(t.itemIndexArray,i.id)&&(e=Array.prototype.indexOf.call(t.itemIndexArray,i.id));var r=t.itemIndexArray.indexOf(i.id);t.items.splice(r,1),t.itemIndexArray.splice(r,1),t.refreshActiveBorder();var s=Object(w["jb"])("#"+_e+t.tabId+"_"+t.extIndex(i.id),Object(w["jb"])("."+_e,t.element));Object(w["T"])(s)||Object(w["F"])(s),t.trigger("removed",n),t.draggableItems&&t.draggableItems.length>0&&(t.draggableItems[e].destroy(),t.draggableItems[e]=null,t.draggableItems.splice(e,1)),i.classList.contains(Xe)?(e=e>Object(w["kb"])("."+ct+":not(."+pt+")",t.element).length-1?e-1:e,t.enableAnimation=!1,t.selectedItem=e,t.select(e)):e!==t.selectedItem&&(e<t.selectedItem&&(e=t.itemIndexArray.indexOf(t.tbItem[t.selectedItem].id),t.setProperties({selectedItem:e>-1?e:t.selectedItem},!0),t.prevIndex=t.selectedItem),t.tbItem=Object(w["kb"])("."+ct,t.getTabHeader())),0===Object(w["kb"])("."+ct,t.element).length&&(t.hdrEle.style.display="none"),t.enableAnimation=!0}})}},t.prototype.hideTab=function(e,t){var i,n=Object(w["kb"])("."+ct,this.element)[e];if(!Object(w["T"])(n)){if(Object(w["T"])(t)&&(t=!0),this.bdrLine.classList.add(Qe),!0===t)if(n.classList.add(Qe),i=Object(w["kb"])("."+ct+":not(."+Qe+")",this.tbItems),0!==i.length&&n.classList.contains(Xe)){if(0!==e)for(var r=e-1;r>=0;r--){if(!this.tbItem[r].classList.contains(Qe)){this.select(r);break}if(0===r)for(var s=e+1;s<this.tbItem.length;s++)if(!this.tbItem[s].classList.contains(Qe)){this.select(s);break}}else for(s=e+1;s<this.tbItem.length;s++)if(!this.tbItem[s].classList.contains(Qe)){this.select(s);break}}else 0===i.length&&this.element.classList.add(Qe);else this.element.classList.remove(Qe),i=Object(w["kb"])("."+ct+":not(."+Qe+")",this.tbItems),n.classList.remove(Qe),0===i.length&&this.select(e);this.setActiveBorder(),n.setAttribute("aria-hidden",""+t),"Popup"===this.overflowMode&&this.tbObj&&this.tbObj.refreshOverflow()}},t.prototype.selectTab=function(e,t,i){void 0===t&&(t=null),void 0===i&&(i=!1),this.isInteracted=i,this.select(e,t)},t.prototype.select=function(e,t){var i=this,n=this.getTabHeader();this.tbItems=Object(w["jb"])("."+dt,n),this.tbItem=Object(w["kb"])("."+ct,n),this.content=Object(w["jb"])("."+_e,this.element),this.prevItem=this.tbItem[this.prevIndex],Object(w["T"])(this.selectedItem)||this.selectedItem<0||this.tbItem.length<=this.selectedItem||isNaN(this.selectedItem)?this.selectedItem=0:this.selectedID=this.extIndex(this.tbItem[this.selectedItem].id);var r=this.tbItem[e];Object(w["T"])(r)?this.selectedID="0":this.selectingID=this.extIndex(r.id),Object(w["T"])(this.prevItem)||this.prevItem.classList.contains(Je)||this.prevItem.children.item(0).setAttribute("tabindex","-1");var s={event:t,previousItem:this.prevItem,previousIndex:this.prevIndex,selectedItem:this.tbItem[this.selectedItem],selectedIndex:this.selectedItem,selectedContent:Object(w["T"])(this.content)?null:Object(w["jb"])("#"+_e+this.tabId+"_"+this.selectedID,this.content),selectingItem:r,selectingIndex:e,selectingContent:Object(w["T"])(this.content)?null:Object(w["jb"])("#"+_e+this.tabId+"_"+this.selectingID,this.content),isSwiped:this.isSwipeed,isInteracted:this.isInteracted,cancel:!1};this.initRender?this.selectingContent(e,this.isInteracted):this.trigger("selecting",s,function(t){t.cancel||i.selectingContent(e,i.isInteracted)}),this.isInteracted=!1},t.prototype.selectingContent=function(e,t){if("number"===typeof e){if(!Object(w["T"])(this.tbItem[e])&&(this.tbItem[e].classList.contains(Je)||this.tbItem[e].classList.contains(Qe)))for(var i=e+1;i<this.items.length;i++){if(!1===this.items[i].disabled&&!0===this.items[i].visible){e=i;break}e=0}if(this.tbItem.length>e&&e>=0&&!isNaN(e))if(this.prevIndex=this.selectedItem,this.prevItem=this.tbItem[this.prevIndex],this.tbItem[e].classList.contains(pt)&&this.reorderActiveTab){if(this.setActive(this.popupHandler(this.tbItem[e]),null,t),!Object(w["T"])(this.items)&&this.items.length>0&&this.allowDragAndDrop){this.tbItem=Object(w["kb"])("."+dt+" ."+ct,this.hdrEle);var n=this.items[e];this.items.splice(e,1),this.items.splice(this.tbItem.length-1,0,n);var r=this.itemIndexArray[e];this.itemIndexArray.splice(e,1),this.itemIndexArray.splice(this.tbItem.length-1,0,r)}}else this.setActive(e,null,t);else this.setActive(0,null,t)}else e instanceof HTMLElement&&this.setActive(this.getEleIndex(e),null,t)},t.prototype.getItemIndex=function(e){for(var t,i=0;i<this.tbItem.length;i++){var n=this.tbItem[i].getAttribute("data-id");if(e===n){t=i;break}}return t},t.prototype.disable=function(e){this.setCssClass(this.element,Je,e),this.element.setAttribute("aria-disabled",""+e)},t.prototype.getPersistData=function(){return this.addOnPersist(["selectedItem","actEleId"])},t.prototype.getModuleName=function(){return"tab"},t.prototype.onPropertyChanged=function(e,t){for(var i=this,n=0,r=Object.keys(e);n<r.length;n++){var s=r[n];switch(s){case"width":Object(w["mb"])(this.element,{width:Object(w["H"])(e.width)});break;case"height":Object(w["mb"])(this.element,{height:Object(w["H"])(e.height)}),this.setContentHeight(!1);break;case"cssClass":var a=this.element.querySelector("."+qe);""===t.cssClass||Object(w["T"])(t.cssClass)?(this.setCssClass(this.element,e.cssClass,!0),Object(w["T"])(a)||this.setCssClass(a,e.cssClass,!0)):(this.setCssClass(this.element,t.cssClass,!1),this.setCssClass(this.element,e.cssClass,!0),Object(w["T"])(a)||(this.setCssClass(a,t.cssClass,!1),this.setCssClass(a,e.cssClass,!0)));break;case"items":this.evalOnPropertyChangeItems(e,t);break;case"showCloseButton":this.setCloseButton(e.showCloseButton);break;case"reorderActiveTab":this.refreshActiveTabBorder();break;case"selectedItem":this.selectedItem=t.selectedItem,this.select(e.selectedItem);break;case"headerPlacement":this.changeOrientation(e.headerPlacement);break;case"enableRtl":this.setRTL(e.enableRtl);break;case"overflowMode":this.tbObj.overflowMode=e.overflowMode,this.tbObj.dataBind(),this.refreshActiveTabBorder();break;case"heightAdjustMode":this.setContentHeight(!1),this.select(this.selectedItem);break;case"scrollStep":this.tbObj&&(this.tbObj.scrollStep=this.scrollStep);break;case"allowDragAndDrop":this.bindDraggable();break;case"dragArea":this.allowDragAndDrop&&(this.draggableItems.forEach(function(e){e.dragArea=i.dragArea}),this.refresh());break}}},t.prototype.refreshActiveTab=function(){if(this.isReact&&this.clearTemplate(),this.isTemplate){var e=this.element.querySelector("."+dt),t=this.element.querySelector("."+ct+"."+Xe),i=t.id,n=i.indexOf("_"),r=parseInt(i.substring(n+1),10),s=t.innerText,a=this.element.querySelector("."+_e).querySelector("."+Xe).children[0],o=a.innerHTML;Object(w["F"])(t),Object(w["F"])(a);var l={className:ct+" "+Ke+" "+Xe,id:We+this.tabId+"_"+r,attrs:{role:"tab","aria-controls":_e+this.tabId+"_"+r,"aria-disabled":"false","aria-selected":"true"}},d=this.createElement("span",{className:rt,innerHTML:s,attrs:{role:"presentation"}}).outerHTML,c=this.createElement("div",{className:ot,innerHTML:d+this.btnCls.outerHTML}).outerHTML,h=this.createElement("div",{className:at,innerHTML:c,attrs:{tabIndex:"-1"}});e.insertBefore(this.createElement("div",l),e.children[r+1]),this.element.querySelector("."+ct+"."+Xe).appendChild(h);T=this.createElement("div",{innerHTML:o});this.element.querySelector("."+_e).querySelector("."+Xe).appendChild(T)}else if(this.element.querySelector("."+ct+"."+Xe)){Object(w["F"])(this.element.querySelector("."+ct+"."+Xe).children[0]),Object(w["F"])(this.element.querySelector("."+_e).querySelector("."+Xe).children[0]);var p=this.items[this.selectedItem],u=Object(w["T"])(p.header)||Object(w["T"])(p.header.iconPosition)?"":p.header.iconPosition,m=Object(w["T"])(p.header)||Object(w["T"])(p.header.iconCss)?"":p.header.iconCss,g=p.headerTemplate||p.header.text,f=this.createElement("div",{className:rt,attrs:{role:"presentation"}});Object(w["T"])(g.tagName)?this.headerTextCompile(f,g,this.selectedItem):f.appendChild(g);var b=void 0,v=this.createElement("span",{className:Ze+" "+lt+" "+et+"-"+u+" "+m}),y=this.createElement("div",{className:ot});y.appendChild(f),""!==g&&void 0!==g&&""!==m?("left"===u||"top"===u?y.insertBefore(v,y.firstElementChild):y.appendChild(v),b=f,this.isIconAlone=!1):(b=""===m?f:v,b===v&&(Object(w["F"])(f),y.appendChild(v),this.isIconAlone=!0));var C=p.disabled?{}:{tabIndex:"-1"};y.appendChild(this.btnCls.cloneNode(!0));var O=this.createElement("div",{className:at,attrs:C});O.appendChild(y),"top"!==u&&"bottom"!==u||this.element.classList.add("e-vertical-icon"),this.element.querySelector("."+ct+"."+Xe).appendChild(O);var T=this.createElement("div"),k=p.content,S=void 0;if("string"===typeof k||Object(w["T"])(k.innerHTML))if("string"===typeof k&&this.enableHtmlSanitizer&&(k=w["s"].sanitize(k)),"."===k[0]||"#"===k[0])if(document.querySelectorAll(k).length){var j=document.querySelector(k);S=j.outerHTML.trim(),T.appendChild(j),j.style.display=""}else this.compileElement(T,k,"content",this.selectedItem);else this.compileElement(T,k,"content",this.selectedItem);else T.appendChild(k);Object(w["T"])(S)||-1===this.templateEle.indexOf(k.toString())&&this.templateEle.push(k.toString()),this.element.querySelector("."+We+"."+Xe).appendChild(T)}this.isReact&&this.renderReactTemplates()},He([Object(w["f"])([],Mt)],t.prototype,"items",void 0),He([Object(w["r"])("100%")],t.prototype,"width",void 0),He([Object(w["r"])("auto")],t.prototype,"height",void 0),He([Object(w["r"])("")],t.prototype,"cssClass",void 0),He([Object(w["r"])(0)],t.prototype,"selectedItem",void 0),He([Object(w["r"])("Top")],t.prototype,"headerPlacement",void 0),He([Object(w["r"])("Content")],t.prototype,"heightAdjustMode",void 0),He([Object(w["r"])("Scrollable")],t.prototype,"overflowMode",void 0),He([Object(w["r"])("Dynamic")],t.prototype,"loadOn",void 0),He([Object(w["r"])(!1)],t.prototype,"enablePersistence",void 0),He([Object(w["r"])(!1)],t.prototype,"enableHtmlSanitizer",void 0),He([Object(w["r"])(!1)],t.prototype,"showCloseButton",void 0),He([Object(w["r"])(!0)],t.prototype,"reorderActiveTab",void 0),He([Object(w["r"])()],t.prototype,"scrollStep",void 0),He([Object(w["r"])()],t.prototype,"dragArea",void 0),He([Object(w["r"])(!1)],t.prototype,"allowDragAndDrop",void 0),He([Object(w["g"])({},It)],t.prototype,"animation",void 0),He([Object(w["k"])()],t.prototype,"created",void 0),He([Object(w["k"])()],t.prototype,"adding",void 0),He([Object(w["k"])()],t.prototype,"added",void 0),He([Object(w["k"])()],t.prototype,"selecting",void 0),He([Object(w["k"])()],t.prototype,"selected",void 0),He([Object(w["k"])()],t.prototype,"removing",void 0),He([Object(w["k"])()],t.prototype,"removed",void 0),He([Object(w["k"])()],t.prototype,"onDragStart",void 0),He([Object(w["k"])()],t.prototype,"dragging",void 0),He([Object(w["k"])()],t.prototype,"dragged",void 0),He([Object(w["k"])()],t.prototype,"destroyed",void 0),t=He([w["p"]],t),t}(w["h"]),Lt=i("af93"),Nt=i("c4df"),At=function(){function e(e,t){this.predefinedItems={},this.isSearched=!1,this.items=["Add","Edit","Update","Delete","Cancel","Print","Search","ColumnChooser","PdfExport","ExcelExport","CsvExport","WordExport"],this.parent=e,this.gridID=e.element.id,this.serviceLocator=t,this.addEventListener()}return e.prototype.render=function(){this.l10n=this.serviceLocator.getService("localization");for(var e=["Add","Edit","Update","Delete","Cancel","Print","PdfExport","ExcelExport","WordExport","CsvExport"],t=this.parent.enableAdaptiveUI,i=["Edit","Delete","Update","Cancel"],n=0,r=e;n<r.length;n++){var s=r[n],a=s.toLowerCase(),o=a[0].toUpperCase()+a.slice(1);this.predefinedItems[s]={id:this.gridID+"_"+a,prefixIcon:"e-"+a,text:this.l10n.getConstant(o),tooltipText:this.l10n.getConstant(o)},t&&(this.predefinedItems[s].text="",this.predefinedItems[s].visible=-1===i.indexOf(s))}this.predefinedItems.Search={id:this.gridID+"_search",tooltipText:this.l10n.getConstant("Search"),align:"Right",cssClass:"e-search-wrapper",type:"Input"},this.predefinedItems.ColumnChooser={id:this.gridID+"_columnchooser",cssClass:"e-cc e-ccdiv e-cc-toolbar",suffixIcon:"e-columnchooser-btn",text:t?"":this.l10n.getConstant("Columnchooser"),tooltipText:this.l10n.getConstant("Columnchooser"),align:"Right"},"Vertical"===this.parent.rowRenderingMode&&(this.parent.allowFiltering&&"FilterBar"!==this.parent.filterSettings.type&&(this.predefinedItems.responsiveFilter={id:this.gridID+"_responsivefilter",cssClass:"e-gridresponsiveicons e-icons",suffixIcon:"e-resfilter-icon",tooltipText:this.l10n.getConstant("FilterButton")}),this.parent.allowSorting&&(this.predefinedItems.responsiveSort={id:this.gridID+"_responsivesort",cssClass:"e-gridresponsiveicons e-icons",suffixIcon:"e-ressort-icon",tooltipText:this.l10n.getConstant("Sort")})),this.parent.enableAdaptiveUI&&this.parent.toolbar.indexOf("Search")>-1&&(this.predefinedItems.responsiveBack={id:this.gridID+"_responsiveback",cssClass:"e-gridresponsiveicons e-icons",suffixIcon:"e-resback-icon",visible:!1}),this.createToolbar()},e.prototype.getToolbar=function(){return this.toolbar.element},e.prototype.destroy=function(){this.toolbar&&!this.toolbar.isDestroyed&&(this.toolbar.element?(this.toolbar.off("render-react-toolbar-template",this.addReactToolbarPortals),this.toolbar.destroy()):(this.parent.destroyTemplate(["toolbarTemplate"]),this.parent.isReact&&this.parent.renderTemplates()),this.unWireEvent(),this.removeEventListener(),this.element.parentNode&&Object(w["fb"])(this.element))},e.prototype.bindSearchEvents=function(){this.searchElement=Object(w["jb"])("#"+this.gridID+"_searchbar",this.element),this.wireEvent(),this.refreshToolbarItems(),this.parent.searchSettings&&this.updateSearchBox()},e.prototype.toolbarCreated=function(e){if(this.element.querySelector(".e-search-wrapper"))if(!this.parent.enableAdaptiveUI||e){var t=this.parent.cssClass?"e-input-group e-search "+this.parent.cssClass:"e-input-group e-search";this.element.querySelector(".e-search-wrapper").innerHTML='<div class="'+t+'" role="search">                    <input id="'+this.gridID+'_searchbar" class="e-input e-search" name="input" type="search"                     placeholder= "'+this.l10n.getConstant("Search")+'"/>                    <span id="'+this.gridID+'_clearbutton" class="e-input-group-icon e-icons e-sicon e-clear-icon e-clear-icon-hide"                     tabindex="-1" title="'+this.l10n.getConstant("Clear")+'" aria-label= "clear" role= "clear"></span>                    <span id="'+this.gridID+'_searchbutton" class="e-input-group-icon e-search-icon e-icons"                     tabindex="-1" title="'+this.l10n.getConstant("Search")+'" aria-label= "search" role= "search"></span>                     </div>'}else this.element.querySelector(".e-search-wrapper").innerHTML='<span id="'+this.gridID+'_clearbutton" class="e-input-group-icon e-icons e-sicon e-clear-icon e-clear-icon-hide"                     tabindex="-1" title="'+this.l10n.getConstant("Clear")+'" aria-label= "clear"></span>                    <span id="'+this.gridID+'_searchbutton" class="e-input-group-icon e-search-icon e-icons"                     tabindex="-1" title="'+this.l10n.getConstant("Search")+'" aria-label= "search"></span>                     </div>';this.bindSearchEvents()},e.prototype.createToolbar=function(){var e=this.getItems();this.toolbar=new Be["a"]({items:e,clicked:this.toolbarClickHandler.bind(this),enablePersistence:this.parent.enablePersistence,enableRtl:this.parent.enableRtl,created:this.toolbarCreated.bind(this),cssClass:this.parent.cssClass?this.parent.cssClass:""}),this.toolbar.isReact=this.parent.isReact,this.toolbar.on("render-react-toolbar-template",this.addReactToolbarPortals,this);var t="isStringTemplate";this.toolbar[t]=!0;var i="viewContainerRef",n="registeredTemplate";if(this.parent[i]&&(this.toolbar[n]={},this.toolbar[i]=this.parent[i]),this.element=this.parent.createElement("div",{id:this.gridID+"_toolbarItems"}),this.parent.enableAdaptiveUI&&this.element.classList.add("e-res-toolbar"),this.parent.toolbarTemplate)if("string"===typeof this.parent.toolbarTemplate)this.toolbar.appendTo(this.parent.toolbarTemplate),this.element=this.toolbar.element;else{var r=this.parent.isReact&&"string"!==typeof this.parent.toolbarTemplate,s=this.parent.element.id+"toolbarTemplate";r?(Object(j["Eb"])(this.parent.toolbarTemplate)({},this.parent,"toolbarTemplate",s,null,null,this.element),this.parent.renderTemplates()):Object(j["f"])(this.element,Object(j["Eb"])(this.parent.toolbarTemplate)({},this.parent,"toolbarTemplate"))}else this.toolbar.appendTo(this.element);this.parent.element.insertBefore(this.element,this.parent.getHeaderContent())},e.prototype.addReactToolbarPortals=function(e){this.parent.isReact&&e&&(this.parent.portals=this.parent.portals.concat(e),this.parent.renderTemplates())},e.prototype.renderResponsiveSearch=function(e){if(e){this.toolbarCreated(!0),this.refreshResponsiveToolbarItems(A["d"].isSearch),this.searchElement=Object(w["jb"])("#"+this.gridID+"_searchbar",this.element);var t=Object(j["hb"])(this.searchElement,"e-toolbar-right");t.classList.add("e-responsive-right"),this.parent.searchSettings&&this.updateSearchBox(),this.searchBoxObj.searchFocus({target:this.searchElement}),this.searchElement.focus()}else this.refreshResponsiveToolbarItems(A["d"].isInitial)},e.prototype.refreshResponsiveToolbarItems=function(e){if(e===A["d"].isInitial){for(var t=this.parent.element.id,i=[t+"_edit",t+"_delete"],n=this.parent.getSelectedRowIndexes(),r=[t+"_responsiveback",t+"_update",t+"_cancel"],s=0,a=this.toolbar.items;s<a.length;s++){var o=a[s],l=this.toolbar.element.querySelector("#"+o.id);l&&(i.indexOf(o.id)>-1?n.length?l.parentElement.classList.remove("e-hidden"):l.parentElement.classList.add("e-hidden"):-1===r.indexOf(o.id)?l.parentElement.classList.remove("e-hidden"):l.parentElement.classList.add("e-hidden"))}if(this.searchElement){var d=Object(j["hb"])(this.searchElement,"e-toolbar-right");d.classList.remove("e-responsive-right"),this.toolbarCreated(!1),this.unWireEvent(),this.searchElement=void 0}}if(e===A["d"].isSearch){i=[this.parent.element.id+"_responsiveback",this.parent.element.id+"_search"];for(var c=0,h=this.toolbar.items;c<h.length;c++){o=h[c],l=this.toolbar.element.querySelector("#"+o.id);l&&(i.indexOf(o.id)>-1?l.parentElement.classList.remove("e-hidden"):l.parentElement.classList.add("e-hidden"))}}},e.prototype.refreshToolbarItems=function(e){var t=this.parent,i=[],n=[],r=t.editSettings,s=t.currentViewData&&t.currentViewData.length;r.allowAdding?i.push(this.gridID+"_add"):n.push(this.gridID+"_add"),r.allowEditing&&s?i.push(this.gridID+"_edit"):n.push(this.gridID+"_edit"),r.allowDeleting&&s?i.push(this.gridID+"_delete"):n.push(this.gridID+"_delete"),"Batch"===t.editSettings.mode?t.element.getElementsByClassName("e-updatedtd").length&&(r.allowAdding||r.allowEditing)?(i.push(this.gridID+"_update"),i.push(this.gridID+"_cancel")):(n.push(this.gridID+"_update"),n.push(this.gridID+"_cancel")):t.isEdit&&(r.allowAdding||r.allowEditing)?(i=[this.gridID+"_update",this.gridID+"_cancel"],n=[this.gridID+"_add",this.gridID+"_edit",this.gridID+"_delete"]):(n.push(this.gridID+"_update"),n.push(this.gridID+"_cancel")),this.enableItems(i,!0),this.enableItems(n,!1)},e.prototype.getItems=function(){var e=[],t=this.parent.toolbar||[];if("string"===typeof this.parent.toolbar)return[];"Vertical"===this.parent.rowRenderingMode&&(this.parent.allowFiltering&&"FilterBar"!==this.parent.filterSettings.type&&e.push(this.getItemObject("responsiveFilter")),this.parent.allowSorting&&e.push(this.getItemObject("responsiveSort")));for(var i=0,n=t;i<n.length;i++){var r=n[i];switch(typeof r){case"number":e.push(this.getItemObject(this.items[r]));break;case"string":e.push(this.getItemObject(r));break;default:e.push(this.getItem(r))}}return this.parent.enableAdaptiveUI&&this.parent.toolbar.indexOf("Search")>-1&&e.push(this.getItemObject("responsiveBack")),e},e.prototype.getItem=function(e){var t=this.predefinedItems[e.text];return t?Object(w["G"])(t,t,e):e},e.prototype.getItemObject=function(e){return this.predefinedItems[e]||{text:e,id:this.gridID+"_"+e}},e.prototype.enableItems=function(e,t){for(var i=0,n=e;i<n.length;i++){var r=n[i],s=Object(w["jb"])("#"+r,this.element);s&&this.toolbar.enableItems(s.parentElement,t)}},e.prototype.toolbarClickHandler=function(e){var t=this,i=this.parent,n=this.gridID;Object(w["G"])(e,{cancel:!1});var r=e,s=e.originalEvent;i.trigger(I["ne"],r,function(e){if(e.originalEvent=e.originalEvent?e.originalEvent:s,!e.cancel)switch(!Object(w["T"])(e.item)&&e.item.id){case n+"_print":i.print();break;case n+"_edit":i.startEdit();break;case n+"_update":i.endEdit();break;case n+"_cancel":i.closeEdit();break;case n+"_add":i.addRecord();break;case n+"_delete":i.deleteRecord();break;case n+"_search":e.originalEvent.target.id===n+"_searchbutton"&&t.searchElement?t.search():!i.enableAdaptiveUI||t.searchElement||!e.originalEvent.target.classList.contains("e-search-wrapper")&&e.originalEvent.target.id!==n+"_searchbutton"?e.originalEvent.target.id===n+"_clearbutton"&&t.searchElement&&(t.searchElement.value="",t.sIcon.classList.add("e-clear-icon-hide"),t.isSearched&&(t.parent.search(t.searchElement.value),t.isSearched=!1)):t.renderResponsiveSearch(!0);break;case n+"_columnchooser":var r=t.parent.element.querySelector(".e-ccdiv"),a=r.getBoundingClientRect().top,o=r.getBoundingClientRect().left,l=e.originalEvent.target;a=r.getBoundingClientRect().top+r.offsetTop,i.createColumnchooser(o,a,l);break;case n+"_responsivefilter":i.showResponsiveCustomFilter();break;case n+"_responsivesort":i.showResponsiveCustomSort();break;case n+"_responsiveback":t.renderResponsiveSearch(!1);break}})},e.prototype.modelChanged=function(e){"edit"===e.module&&this.refreshToolbarItems()},e.prototype.onPropertyChanged=function(e){e.module===this.getModuleName()&&this.parent.toolbar&&(this.element&&Object(w["fb"])(this.element),this.render())},e.prototype.keyUpHandler=function(e){13===e.keyCode&&this.search(),this.searchElement&&(this.sIcon=this.searchElement.parentElement.querySelector(".e-clear-icon"),this.searchElement.value.length&&!Object(w["T"])(this.sIcon)?this.sIcon.classList.remove("e-clear-icon-hide"):this.sIcon.classList.add("e-clear-icon-hide"))},e.prototype.search=function(){this.isSearched=!0,this.parent.search(this.searchElement.value)},e.prototype.updateSearchBox=function(){this.searchElement&&(this.searchElement.value=this.parent.searchSettings.key)},e.prototype.wireEvent=function(){this.searchElement&&(this.searchBoxObj=new Nt["b"](this.searchElement),w["l"].add(this.searchElement,"keyup",this.keyUpHandler,this),this.searchBoxObj.wireEvent()),w["l"].add(this.toolbar.element,"focusin",this.onFocusIn,this),w["l"].add(this.toolbar.element,"focusout",this.onFocusOut,this)},e.prototype.unWireEvent=function(){this.searchElement&&(w["l"].remove(this.searchElement,"keyup",this.keyUpHandler),this.searchBoxObj.unWireEvent()),w["l"].remove(this.toolbar.element,"focusin",this.onFocusIn),w["l"].remove(this.toolbar.element,"focusout",this.onFocusOut)},e.prototype.onFocusIn=function(e){var t=this.parent.focusModule.currentInfo;t&&t.element&&(Object(w["gb"])([t.element,t.elementToFocus],["e-focused","e-focus"]),t.element.tabIndex=-1),e.target.tabIndex=0},e.prototype.onFocusOut=function(e){e.target.tabIndex=-1},e.prototype.setFocusToolbarItem=function(e){var t=e.querySelector(".e-btn,.e-input");!t&&this.parent.enableAdaptiveUI&&!this.searchElement&&e.classList.contains("e-search-wrapper")&&(t=e.querySelector("#"+this.gridID+"_searchbutton")),t.focus()},e.prototype.getFocusableToolbarItems=function(){return this.toolbar.element.querySelectorAll(".e-toolbar-item:not(.e-overlay):not(.e-hidden)")},e.prototype.keyPressedHandler=function(e){if(e.target&&Object(j["hb"])(e.target,"e-toolbar-item")){var t=Object(j["hb"])(e.target,"e-toolbar-item"),i=this.getFocusableToolbarItems();if("tab"===e.action||"shiftTab"===e.action){if("tab"===e.action&&t===i[i.length-1]||"shiftTab"===e.action&&t===i[0])return;for(var n=0;n<i.length;n++)if(t===i[n]){e.preventDefault();var r="tab"===e.action?n+1:n-1;return void this.setFocusToolbarItem(i[r])}}"enter"===e.action&&this.parent.enableAdaptiveUI&&!this.searchElement&&e.target.id===this.gridID+"_searchbutton"&&this.renderResponsiveSearch(!0)}},e.prototype.reRenderToolbar=function(){this.element&&Object(w["fb"])(this.element),this.render()},e.prototype.addEventListener=function(){this.parent.isDestroyed||(this.evtHandlers=[{event:I["ee"],handler:this.reRenderToolbar},{event:I["Ic"],handler:this.render},{event:I["qe"],handler:this.onPropertyChanged},{event:I["Bc"],handler:this.updateSearchBox.bind(this)},{event:I["Nc"],handler:this.refreshToolbarItems},{event:I["oe"],handler:this.refreshToolbarItems},{event:I["Bc"],handler:this.modelChanged},{event:I["Ab"],handler:this.refreshToolbarItems},{event:I["Y"],handler:this.removeResponsiveSearch},{event:I["Pd"],handler:this.reRenderToolbar},{event:I["Hb"],handler:this.destroy},{event:I["Kc"],handler:this.keyPressedHandler}],Object(j["d"])(this.parent,this.evtHandlers,!0,this),this.rowSelectedFunction=this.rowSelected.bind(this),this.rowDeSelectedFunction=this.rowSelected.bind(this),this.parent.addEventListener(I["Rd"],this.rowSelectedFunction),this.parent.addEventListener(I["Id"],this.rowDeSelectedFunction))},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(Object(j["d"])(this.parent,this.evtHandlers,!1),this.parent.removeEventListener(I["Rd"],this.rowSelectedFunction),this.parent.removeEventListener(I["Id"],this.rowDeSelectedFunction))},e.prototype.removeResponsiveSearch=function(e){var t=e.target,i=t.classList.contains("e-search-icon")||t.classList.contains("e-search-wrapper");this.parent.enableAdaptiveUI&&!i&&this.searchElement&&!Object(j["hb"])(e.target,"e-res-toolbar")&&this.renderResponsiveSearch(!1)},e.prototype.rowSelected=function(){this.parent.enableAdaptiveUI&&this.refreshResponsiveToolbarItems(A["d"].isInitial)},e.prototype.getModuleName=function(){return"toolbar"},e}(),Bt=i("2e78"),Ft=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Ht=function(e){function t(t,i){var n=e.call(this,t,i)||this;return n.parent=t,n.serviceLocator=i,n.initEvent(),n}return Ft(t,e),t.prototype.initEvent=function(){this.parent.isDestroyed||(this.parent.on(I["Gc"],this.initForeignKeyColumns,this),this.parent.on(I["rc"],this.getForeignKeyData,this),this.parent.on(I["pc"],this.generateQueryFormData,this))},t.prototype.initForeignKeyColumns=function(e){for(var t=0;t<e.length;t++)e[t].dataSource=e[t].dataSource instanceof O["a"]?e[t].dataSource:Object(w["T"])(e[t].dataSource)?new O["a"]:"result"in e[t].dataSource?e[t].dataSource:new O["a"](e[t].dataSource)},t.prototype.eventfPromise=function(e,t,i,n){var r=this.getStateEventArgument(t),s=new O["b"],a=new O["b"];r.action=e.action;var o=this.parent.getDataModule();return!Object(w["T"])(e.action)&&e.action.requestType&&!1!==o.foreignKeyDataState.isDataChanged?(o.setForeignKeyDataState({isPending:!0,resolver:a.resolve}),a.promise.then(function(){s.resolve(n.dataSource)}),r.setColumnData=this.parent.setForeignKeyData.bind(this.parent),this.parent.trigger(I["eb"],r)):(o.setForeignKeyDataState({}),s.resolve(i)),s},t.prototype.getForeignKeyData=function(e){for(var t=this,i=e.column?[e.column]:this.parent.getForeignKeyColumns(),n=[],r=function(t){var r=void 0,a=e.isComplex?s.genarateColumnQuery(i[t]):s.genarateQuery(i[t],e.result.result,!1,!0);a.params=s.parent.query.params;var o=i[t].dataSource;if(o&&"result"in o){var l=s.eventfPromise(e,a,o,i[t]);r=l.promise}else r=!o.ready||o.dataSource.offline?o.executeQuery(a):o.ready.then(function(){return o.executeQuery(a)});n.push(r)},s=this,a=0;a<i.length;a++)r(a);Promise.all(n).then(function(t){for(var n=0;n<t.length;n++)i[n].columnData=t[n].result,"dropdownedit"===i[n].editType&&"result"in i[n].dataSource&&(i[n].edit.params=Object(w["G"])(i[n].edit.params,{dataSource:t[n].result,query:new T["b"],fields:{value:i[n].foreignKeyField||i[n].field,text:i[n].foreignKeyValue}}));e.promise.resolve(e.result)}).catch(function(i){return t.parent.log(["actionfailure","foreign_key_failure"]),e.promise&&e.promise.reject&&e.promise.reject(i),i})},t.prototype.generateQueryFormData=function(e){e.predicate.predicate=this.genarateQuery(e.column,e.column.columnData,!0)},t.prototype.genarateQuery=function(e,t,i,n){var r=this.parent,s=[],a=new T["b"],o=i?e.foreignKeyField:e.field;if(r.allowPaging||r.enableVirtualization||i){t=new O["a"](r.allowGrouping&&r.groupSettings.columns.length&&!i?t.records:t).executeLocal((new T["b"]).select(o));var l=S["a"].distinct(t,o,!1);o=i?e.field:e.foreignKeyField;for(var d=0;d<l.length;d++)l[d]&&l[d].getDay?s.push(Object(j["D"])({field:o,operator:"equal",value:l[d],matchCase:!1})):s.push(new T["a"](o,"equal",l[d],!1))}return n?s.length?a.where(T["a"].or(s)):a:s.length?T["a"].or(s):{predicates:[]}},t.prototype.genarateColumnQuery=function(e){var t=this.parent,i=new T["b"],n=this.isFiltered(e);if(n.isTrue&&(i=this.filterQuery(i,n.column,!0)),t.searchSettings.key.length){var r=t.searchSettings;e.dataSource instanceof O["a"]&&e.dataSource.adaptor.getModuleName&&"ODataV4Adaptor"===e.dataSource.adaptor.getModuleName()?i=this.searchQuery(i,e,!0):i.search(r.key,e.foreignKeyValue,r.operator,r.ignoreCase)}return i},t.prototype.isFiltered=function(e){var t=this.parent.filterSettings.columns.filter(function(t){return t.field===e.foreignKeyValue&&t.uid===e.uid});return{column:t,isTrue:!!t.length}},t.prototype.getModuleName=function(){return"foreignKey"},t.prototype.destroy=function(){this.destroyEvent()},t.prototype.destroyEvent=function(){this.parent.isDestroyed||(this.parent.off(I["Gc"],this.initForeignKeyColumns),this.parent.off(I["rc"],this.getForeignKeyData),this.parent.off(I["pc"],this.generateQueryFormData))},t}(Bt["a"]),Vt=i("cb3f"),qt="load",zt="initial-load",_t="content-changed",Ut="initial-end",Gt="iframe-click",Wt="destroy",Kt="toolbarClick",$t="toolbar-refresh",Xt="refresh-begin",Jt="toolbar-updated",Qt="bind-on-end",Yt="render-color-picker",Zt="html-toolbar-click",ei="markdown-toolbar-click",ti="destroy-color-picker",ii="model-changed",ni="keyUp",ri="keyDown",si="mouseUp",ai="toolbarCreated",oi="toolbarRenderComplete",li="enableFullScreen",di="disableFullScreen",ci="dropDownSelect",hi="beforeDropDownItemRender",pi="execCommandCallBack",ui="image-toolbar-action",mi="link-toolbar-action",gi="resize",fi="insertLink",bi="unLink",vi="editLink",yi="openLink",Ci="actionBegin",wi="actionComplete",Oi="updatedToolbarStatus",Ti="updateToolbarItem",ki="insertImage",Si="insertCompleted",ji="sourceCode",Ri="updateSource",Di="beforeDropDownOpen",Ei="selection-save",Ii="selection-restore",xi="expandPopupClick",Mi="count",Pi="mouseDown",Li="sourceCodeMouseDown",Ni="editAreaClick",Ai="scroll",Bi="contentscroll",Fi="colorPickerChanged",Hi="tableColorPickerChanged",Vi="focusChange",qi="selectAll",zi="selectRange",_i="getSelectedHtml",Ui="renderInlineToolbar",Gi="paste-content",Wi="rtl-mode",Ki="createTable",$i="docClick",Xi="table-toolbar-action",Ji="checkUndoStack",Qi="readOnlyMode",Yi="pasteClean",Zi="enterHandler",en="beforeDialogOpen",tn="clearDialogObj",nn="dialogOpen",rn="beforeDialogClose",sn="dialogClose",an="beforeQuickToolbarOpen",on="quickToolbarOpen",ln="quickToolbarClose",dn="drop",cn="xhtmlValidation",hn="resizeInitialized",pn="renderFileManager",un="dynamicModule",mn="updateTbItemsStatus",gn="showLinkDialog",fn="closeLinkDialog",bn="showImageDialog",vn="closeImageDialog",yn="showTableDialog",Cn="closeTableDialog",wn="closeTableDialog",On="address:empty, article:empty, aside:empty, blockquote:empty,\n details:empty, dd:empty, div:empty, dl:empty, dt:empty, fieldset:empty, footer:empty,form:empty, h1:empty,\n h2:empty, h3:empty, h4:empty, h5:empty, h6:empty, header:empty, hgroup:empty, li:empty, main:empty, nav:empty,\n noscript:empty, output:empty, p:empty, pre:empty, section:empty, td:empty, th:empty",Tn="a:empty, abbr:empty, acronym:empty, b:empty, bdi:empty, bdo:empty, big:empty, button:empty,\n canvas:empty, cite:empty, code:empty, data:empty, datalist:empty, del:empty, dfn:empty, em:empty, font:empty, i:empty, iframe:empty,\n ins:empty, kbd:empty, label:empty, map:empty, mark:empty, meter:empty, noscript:empty, object:empty, output:empty, picture:empty, progress:empty,\n q:empty, ruby:empty, s:empty, samp:empty, script:empty, select:empty, slot:empty, small:empty, span:empty, strong:empty, strike:empty, sub:empty, sup:empty, svg:empty,\n template:empty, textarea:empty, time:empty, u:empty, tt:empty, var:empty, wbr:empty",kn="e-richtexteditor",Sn="e-rtl",jn="e-disabled",Rn="rte-iframe-script-sheet",Dn="rte-iframe-style-sheet",En="e-rte-toolbar",In="e-rte-tb-fixed",xn="e-rte-tb-float",Mn="e-rte-tb-abs-float",Pn="e-rte-inline",Ln="e-rte-tb-expand",Nn="e-rte-full-screen",An="e-rte-quick-toolbar",Bn="e-rte-pop",Fn="e-tb-static",Hn="e-rte-quick-popup",Vn="e-quick-dropdown",qn="e-rte-image-popup",zn="e-rte-inline-popup",_n="e-rte-inline-dropdown",Un="e-rte-dropdown-popup",Gn="e-rte-dropdown-icons",Wn="e-rte-dropdown-items",Kn="e-rte-dropdown-btn",$n="e-rte-content",Xn="e-toolbar-item",Jn="e-toolbar-wrapper",Qn="e-show",Yn="e-hide",Zn="e-visible",er="e-focused",tr="e-remove-white-space",ir="e-imgbreak",nr="e-imginline",rr="e-rte-character-count",sr="e-warning",ar="e-error",or="e-icons",lr="e-active",dr="e-expand-open",cr="e-rte-elements",hr="e-tbar-btn",pr="e-rte-horizontal-separator",ur="e-tbar-ios-fixed",mr="e-rte-list-primary-content",gr="e-rte-numberformatlist-dropdown",fr="e-rte-bulletformatlist-dropdown",br="e-formats-tbar-btn",vr="e-font-name-tbar-btn",yr="e-font-size-tbar-btn",Cr="e-alignment-tbar-btn",wr="e-rte-fontcolor-element",Or="e-rte-backgroundcolor-element",Tr="e-rte-color-content",kr="e-rte-fontcolor-dropdown",Sr="e-rte-backgroundcolor-dropdown",jr="e-rte-square-palette",Rr="e-rte-fontcolor-colorpicker",Dr="e-rte-backgroundcolor-colorpicker",Er="e-rte-readonly",Ir="e-rte-hidden",xr="e-resize-handle",Mr="e-rte-image",Pr="e-custom-tile",Lr="e-nocolor-item",Nr="e-rte-fixed-tb-expand",Ar="e-rte-toolbar-enabled";(function(e){e[e["Toolbar"]=0]="Toolbar",e[e["Content"]=1]="Content",e[e["Popup"]=2]="Popup",e[e["LinkToolbar"]=3]="LinkToolbar",e[e["TextToolbar"]=4]="TextToolbar",e[e["ImageToolbar"]=5]="ImageToolbar",e[e["InlineToolbar"]=6]="InlineToolbar",e[e["TableToolbar"]=7]="TableToolbar"})(ve||(ve={})),function(e){e["Expand"]="Expand",e["MultiRow"]="MultiRow",e["Scrollable"]="Scrollable"}(ye||(ye={})),function(e){e["InsertLink"]="InsertLink",e["InsertImage"]="InsertImage",e["InsertTable"]="InsertTable"}(Ce||(Ce={}));var Br=function(){function e(e,t){this.parent=e,this.locator=t,this.renderer=this.locator.getService("rendererFactory"),this.addEventListener()}return e.prototype.render=function(){this.parent;this.contentRenderer=this.renderer.getRenderer(ve.Content),this.contentRenderer.renderPanel()},e.prototype.refresh=function(e){void 0===e&&(e={requestType:"refresh"}),this.parent.notify(e.requestType+"-begin",e)},e.prototype.destroy=function(){this.removeEventListener()},e.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(ii,this.refresh,this),this.parent.on(ni,this.keyUp,this))},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(ii,this.refresh),this.parent.off(ni,this.keyUp))},e.prototype.keyUp=function(e){if("HTML"===this.parent.editorMode)switch(e.args.which){case 46:case 8:var t=this.parent.contentModule.getEditPanel().childNodes;if(0===t.length||1===t.length&&0===t[0].childNodes.length&&("BR"===t[0].tagName||("P"===t[0].tagName||"DIV"===t[0].tagName)&&""===t[0].textContent)){var i=this.parent.contentModule.getEditPanel();"DIV"===this.parent.enterKey?i.innerHTML="<div><br/></div>":"BR"===this.parent.enterKey?i.innerHTML="<br/>":i.innerHTML="<p><br/></p>",this.parent.formatter.editorManager.nodeSelection.setCursorPoint(this.parent.contentModule.getDocument(),i.childNodes[0],0)}break}},e}(),Fr="keydown",Hr="action",Vr="format-type",qr="keydown-handler",zr="list-type",_r="keyup-handler",Ur="keyup",Gr="model_changed_plugin",Wr="model_changed",Kr="ms_word_cleanup_plugin",$r="ms_word_cleanup",Xr="onBegin",Jr="actionBegin",Qr=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Yr=function(e,t,i,n){var r,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var o=e.length-1;o>=0;o--)(r=e[o])&&(a=(s<3?r(a):s>3?r(t,i,a):r(t,i))||a);return s>3&&a&&Object.defineProperty(t,i,a),a},Zr={backspace:8,tab:9,enter:13,shift:16,control:17,alt:18,pause:19,capslock:20,space:32,escape:27,pageup:33,pagedown:34,end:35,home:36,leftarrow:37,uparrow:38,rightarrow:39,downarrow:40,insert:45,delete:46,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,semicolon:186,plus:187,comma:188,minus:189,dot:190,forwardslash:191,graveaccent:192,openbracket:219,backslash:220,closebracket:221,singlequote:222,"]":221,"[":219,"=":187},es=function(e){function t(t,n){var r=e.call(this,n,t)||this;return r.keyPressHandler=function(e){for(var t=e.altKey,n=e.ctrlKey,s=e.shiftKey,a=e.metaKey,o=e.which,l=Object.keys(r.keyConfigs),d=0,c=l;d<c.length;d++)for(var h=c[d],p=r.keyConfigs[h].split(","),u=0,m=p;u<m.length;u++){var g=m[u],f=i.getKeyConfigData(g.trim());t!==f.altKey||n!==f.ctrlKey&&!a||s!==f.shiftKey||o!==f.keyCode||(e.action=h)}r.keyAction&&r.keyAction(e)},r.bind(),r}var i;return Qr(t,e),i=t,t.prototype.destroy=function(){this.unwireEvents(),e.prototype.destroy.call(this)},t.prototype.onPropertyChanged=function(e,t){},t.prototype.bind=function(){this.wireEvents()},t.prototype.getModuleName=function(){return"keyboard"},t.prototype.wireEvents=function(){this.element.addEventListener(this.eventName,this.keyPressHandler)},t.prototype.unwireEvents=function(){this.element.removeEventListener(this.eventName,this.keyPressHandler)},t.getKeyConfigData=function(e){if(e in this.configCache)return this.configCache[e];var t=e.toLowerCase().split("+"),n={altKey:-1!==t.indexOf("alt"),ctrlKey:-1!==t.indexOf("ctrl"),shiftKey:-1!==t.indexOf("shift"),keyCode:null};return t[t.length-1].length>1&&Number(t[t.length-1])?n.keyCode=Number(t[t.length-1]):n.keyCode=i.getKeyCode(t[t.length-1]),i.configCache[e]=n,n},t.getKeyCode=function(e){return Zr[e]||e.toUpperCase().charCodeAt(0)},t.configCache={},Yr([Object(w["r"])({})],t.prototype,"keyConfigs",void 0),Yr([Object(w["r"])("keyup")],t.prototype,"eventName",void 0),Yr([Object(w["k"])()],t.prototype,"keyAction",void 0),t=i=Yr([w["p"]],t),t}(w["c"]),ts=function(){function e(e,t){this.parent=e;var i=t;this.rendererFactory=i.getService("rendererFactory"),this.addEventListener()}return e.prototype.addEventListener=function(){this.parent.on(ji,this.sourceCode,this),this.parent.on(Ut,this.onInitialEnd,this),this.parent.on(Ri,this.updateSourceCode,this),this.parent.on(Wt,this.destroy,this)},e.prototype.onInitialEnd=function(){this.parent.formatter.editorManager.observer.on(qr,this.onKeyDown,this)},e.prototype.removeEventListener=function(){this.unWireEvent(),this.parent.off(ji,this.sourceCode),this.parent.off(Ri,this.updateSourceCode),this.parent.off(Ut,this.onInitialEnd),this.parent.off(Wt,this.destroy),this.parent.formatter.editorManager.observer.off(qr,this.onKeyDown)},e.prototype.getSourceCode=function(){return this.parent.createElement("textarea",{className:"e-rte-srctextarea "+this.parent.cssClass})},e.prototype.wireEvent=function(e){this.keyboardModule=new es(e,{keyAction:this.previewKeyDown.bind(this),keyConfigs:this.parent.formatter.keyConfig,eventName:"keydown"}),w["l"].add(this.previewElement,"mousedown",this.mouseDownHandler,this)},e.prototype.unWireEvent=function(){this.keyboardModule&&this.keyboardModule.destroy(),this.previewElement&&w["l"].remove(this.previewElement,"mousedown",this.mouseDownHandler)},e.prototype.wireBaseKeyDown=function(){this.parent.keyboardModule=new es(this.contentModule.getEditPanel(),{keyAction:this.parent.keyDown.bind(this.parent),keyConfigs:this.parent.formatter.keyConfig,eventName:"keydown"})},e.prototype.unWireBaseKeyDown=function(){this.parent.keyboardModule.destroy()},e.prototype.mouseDownHandler=function(e){this.parent.notify(Li,{args:e})},e.prototype.previewKeyDown=function(e){switch(e.action){case"html-source":this.updateSourceCode(e),e.preventDefault();break;case"toolbar-focus":if(this.parent.toolbarSettings.enable){var t='.e-toolbar-item[aria-disabled="false"][title] [tabindex]';this.parent.toolbarModule.baseToolbar.toolbarObj.element.querySelector(t).focus()}break}},e.prototype.onKeyDown=function(e){switch(e.event.action){case"html-source":e.event.preventDefault(),this.sourceCode(e),e.callBack({requestType:"SourceCode",editorMode:"HTML",event:e.event});break}},e.prototype.sourceCode=function(e){this.parent.isBlur=!1,this.parent.trigger(Ci,{requestType:"SourceCode",targetItem:"SourceCode",args:e});var t=Object(w["kb"])("."+Xn,this.parent.element);if(this.contentModule=this.rendererFactory.getRenderer(ve.Content),this.parent.notify(Ti,{targetItem:"SourceCode",updateItem:"Preview",baseToolbar:this.parent.getBaseToolbarObject()}),Object(w["T"])(this.previewElement)&&(this.previewElement=this.getSourceCode()),this.parent.updateValueData(),this.parent.iframeSettings.enable){var i=void 0;i=Object(w["T"])(this.parent.element.querySelector("#"+this.parent.element.id+"_source-view"))?this.parent.createElement("div",{className:"e-source-content",id:this.parent.element.id+"_source-view"}):this.parent.element.querySelector("#"+this.parent.element.id+"_source-view"),i.appendChild(this.previewElement),this.parent.element.appendChild(i),i.style.height=this.contentModule.getPanel().style.height,i.style.marginTop=this.contentModule.getPanel().style.marginTop,this.getPanel().value=this.getTextAreaValue(),this.contentModule.getPanel().style.display="none",i.style.display="block",this.getPanel().style.display="block"}else this.contentModule.getPanel().appendChild(this.previewElement),this.getPanel().value=this.getTextAreaValue(),this.contentModule.getEditPanel().style.display="none",this.previewElement.style.display="block";if(this.parent.isBlur=!1,this.parent.disableToolbarItem(this.parent.toolbarSettings.items),this.parent.enableToolbarItem("SourceCode"),this.parent.getToolbar()&&Object(w["gb"])([this.parent.getToolbar()],[dr]),Object(w["gb"])(t,[lr]),this.parent.setContentHeight("sourceCode",!0),this.wireEvent(this.previewElement),this.unWireBaseKeyDown(),this.previewElement.focus(),this.parent.updateValue(),!Object(w["T"])(this.parent.placeholder)&&!this.parent.iframeSettings.enable){var n=this.parent.element.querySelector(".rte-placeholder.e-rte-placeholder");n.style.display="none"}this.parent.trigger(wi,{requestType:"SourceCode",targetItem:"SourceCode",args:e}),this.parent.invokeChangeEvent()},e.prototype.updateSourceCode=function(e){this.parent.isBlur=!1,this.parent.trigger(Ci,{requestType:"Preview",targetItem:"Preview",args:e});var t=this.getPanel();this.parent.notify(Ti,{targetItem:"Preview",updateItem:"SourceCode",baseToolbar:this.parent.getBaseToolbarObject()});var i,n=this.parent.serializeValue(t.value);if(i=null===n||""===n?"DIV"===this.parent.enterKey?"<div><br/></div>":"BR"===this.parent.enterKey?"<br/>":"<p><br/></p>":n,this.parent.iframeSettings.enable?(t.parentElement.style.display="none",t.style.display="none",this.contentModule.getPanel().style.display="block",this.contentModule.getEditPanel().innerHTML=i):(t.style.display="none",this.contentModule.getEditPanel().style.display="block",this.contentModule.getEditPanel().innerHTML=i),this.parent.isBlur=!1,this.parent.enableToolbarItem(this.parent.toolbarSettings.items),this.parent.getToolbar()&&Object(w["gb"])([this.parent.getToolbar()],[dr]),this.parent.setContentHeight("preview",!0),this.unWireEvent(),this.wireBaseKeyDown(),this.contentModule.getEditPanel().focus(),this.parent.updateValue(),!Object(w["T"])(this.parent.placeholder)&&0===this.contentModule.getEditPanel().innerText.length){var r=this.parent.element.querySelector(".rte-placeholder.e-rte-placeholder");r.style.display="block"}this.parent.trigger(wi,{requestType:"Preview",targetItem:"Preview",args:e}),this.parent.formatter.enableUndo(this.parent),this.parent.invokeChangeEvent()},e.prototype.getTextAreaValue=function(){return"<p><br></p>"===this.contentModule.getEditPanel().innerHTML||"<div><br></div>"===this.contentModule.getEditPanel().innerHTML||"<br>"===this.contentModule.getEditPanel().innerHTML||1===this.contentModule.getEditPanel().childNodes.length&&"P"===this.contentModule.getEditPanel().childNodes[0].tagName&&7===this.contentModule.getEditPanel().innerHTML.length||"DIV"===this.contentModule.getEditPanel().childNodes[0].tagName&&11===this.contentModule.getEditPanel().innerHTML.length?"":this.parent.value},e.prototype.getPanel=function(){return this.parent.element&&this.parent.element.querySelector(".e-rte-srctextarea")},e.prototype.getViewPanel=function(){return this.parent.iframeSettings.enable&&this.getPanel()?this.getPanel().parentElement:this.getPanel()},e.prototype.destroy=function(){this.removeEventListener()},e}(),is={bold:{command:"Style",subCommand:"Bold",value:"strong"},italic:{command:"Style",subCommand:"Italic",value:"em"},underline:{command:"Style",subCommand:"Underline",value:"span"},strikeThrough:{command:"Style",subCommand:"StrikeThrough",value:"span"},insertCode:{command:"Formats",subCommand:"Pre",value:"pre"},superscript:{command:"Effects",subCommand:"SuperScript",value:"sup"},subscript:{command:"Effects",subCommand:"SubScript",value:"sub"},uppercase:{command:"Casing",subCommand:"UpperCase"},lowercase:{command:"Casing",subCommand:"LowerCase"},fontColor:{command:"font",subCommand:"fontcolor",value:"#ff0000"},fontName:{command:"font",subCommand:"fontname",value:"Segoe UI"},fontSize:{command:"font",subCommand:"fontsize",value:"10pt"},backColor:{command:"font",subCommand:"backgroundcolor",value:"#ffff00"},justifyCenter:{command:"Alignments",subCommand:"JustifyCenter"},justifyFull:{command:"Alignments",subCommand:"JustifyFull"},justifyLeft:{command:"Alignments",subCommand:"JustifyLeft"},justifyRight:{command:"Alignments",subCommand:"JustifyRight"},undo:{command:"Actions",subCommand:"Undo"},redo:{command:"Actions",subCommand:"Redo"},createLink:{command:"Links",subCommand:"createLink"},editLink:{command:"Links",subCommand:"createLink"},createImage:{command:"Images",subCommand:"Images"},formatBlock:{command:"Formats",value:"P"},heading:{command:"Formats",value:"H1"},indent:{command:"Indents",subCommand:"Indent"},outdent:{command:"Indents",subCommand:"Outdent"},insertHTML:{command:"InsertHTML",subCommand:"InsertHTML",value:""},insertText:{command:"InsertText",subCommand:"InsertText",value:""},insertHorizontalRule:{command:"InsertHTML",subCommand:"InsertHTML",value:"<hr/>"},insertImage:{command:"Images",subCommand:"Image"},editImage:{command:"Images",subCommand:"Image"},insertTable:{command:"Table",subCommand:"CreateTable"},insertBrOnReturn:{command:"InsertHTML",subCommand:"InsertHTML",value:"<br/>"},insertOrderedList:{command:"Lists",value:"OL"},insertUnorderedList:{command:"Lists",value:"UL"},insertParagraph:{command:"Formats",value:"P"},removeFormat:{command:"Clear",subCommand:"ClearFormat"}},ns=function(){function e(){this.services={}}return e.prototype.register=function(e,t){Object(w["T"])(this.services[e])&&(this.services[e]=t)},e.prototype.getService=function(e){if(Object(w["T"])(this.services[e]))throw"The service "+e+" is not registered";return this.services[e]},e}(),rs=function(){function e(){this.rendererMap={}}return e.prototype.addRenderer=function(e,t){var i=Object(w["L"])(ve,e);Object(w["T"])(this.rendererMap[i])&&(this.rendererMap[i]=t)},e.prototype.getRenderer=function(e){var t=Object(w["L"])(ve,e);if(Object(w["T"])(this.rendererMap[t]))throw"The renderer "+t+" is not found";return this.rendererMap[t]},e}(),ss=function(){function e(e){this.parent=e,this.addEventListener()}return e.prototype.addEventListener=function(){this.parent.on(pi,this.commandCallBack,this),this.parent.on(Wt,this.removeEventListener,this)},e.prototype.commandCallBack=function(e){"Undo"!==e.requestType&&"Redo"!==e.requestType&&this.parent.formatter.saveData(),this.parent.notify($t,{args:e}),this.parent.notify(Mi,{})},e.prototype.removeEventListener=function(){this.parent.off(pi,this.commandCallBack),this.parent.off(Wt,this.removeEventListener)},e}(),as=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),os=function(e,t,i,n){var r,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var o=e.length-1;o>=0;o--)(r=e[o])&&(a=(s<3?r(a):s>3?r(t,i,a):r(t,i))||a);return s>3&&a&&Object.defineProperty(t,i,a),a},ls=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return as(t,e),os([Object(w["r"])(null)],t.prototype,"downloadUrl",void 0),os([Object(w["r"])(null)],t.prototype,"getImageUrl",void 0),os([Object(w["r"])(null)],t.prototype,"uploadUrl",void 0),os([Object(w["r"])(null)],t.prototype,"url",void 0),t}(w["e"]),ds=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),cs=function(e,t,i,n){var r,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var o=e.length-1;o>=0;o--)(r=e[o])&&(a=(s<3?r(a):s>3?r(t,i,a):r(t,i))||a);return s>3&&a&&Object.defineProperty(t,i,a),a},hs=["Open","|","Cut","Copy","|","Delete","Download","Rename","|","Details"],ps=["Open","|","Cut","Copy","Paste","|","Delete","Rename","Download","|","Details"],us=["SortBy","View","Refresh","|","Paste","|","NewFolder","Upload","|","Details","|","SelectAll"],ms=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ds(t,e),cs([Object(w["r"])(hs)],t.prototype,"file",void 0),cs([Object(w["r"])(ps)],t.prototype,"folder",void 0),cs([Object(w["r"])(us)],t.prototype,"layout",void 0),cs([Object(w["r"])(!0)],t.prototype,"visible",void 0),t}(w["e"]),gs=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),fs=function(e,t,i,n){var r,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var o=e.length-1;o>=0;o--)(r=e[o])&&(a=(s<3?r(a):s>3?r(t,i,a):r(t,i))||a);return s>3&&a&&Object.defineProperty(t,i,a),a},bs=[{field:"name",headerText:"Name",minWidth:120,template:'<span class="e-fe-text">${name}</span>',customAttributes:{class:"e-fe-grid-name"}},{field:"_fm_modified",headerText:"DateModified",type:"dateTime",format:"MMMM dd, yyyy HH:mm",minWidth:120,width:"190"},{field:"size",headerText:"Size",minWidth:90,width:"110",template:'<span class="e-fe-size">${size}</span>'}],vs=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return gs(t,e),fs([Object(w["r"])(!0)],t.prototype,"columnResizing",void 0),fs([Object(w["r"])(bs)],t.prototype,"columns",void 0),t}(w["e"]),ys=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Cs=function(e,t,i,n){var r,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var o=e.length-1;o>=0;o--)(r=e[o])&&(a=(s<3?r(a):s>3?r(t,i,a):r(t,i))||a);return s>3&&a&&Object.defineProperty(t,i,a),a},ws=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ys(t,e),Cs([Object(w["r"])("650px")],t.prototype,"maxWidth",void 0),Cs([Object(w["r"])("240px")],t.prototype,"minWidth",void 0),Cs([Object(w["r"])(!0)],t.prototype,"visible",void 0),Cs([Object(w["r"])("None")],t.prototype,"sortOrder",void 0),t}(w["e"]),Os=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Ts=function(e,t,i,n){var r,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var o=e.length-1;o>=0;o--)(r=e[o])&&(a=(s<3?r(a):s>3?r(t,i,a):r(t,i))||a);return s>3&&a&&Object.defineProperty(t,i,a),a},ks=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Os(t,e),Ts([Object(w["r"])(!0)],t.prototype,"allowSearchOnTyping",void 0),Ts([Object(w["r"])("contains")],t.prototype,"filterType",void 0),Ts([Object(w["r"])(!0)],t.prototype,"ignoreCase",void 0),Ts([Object(w["r"])(null)],t.prototype,"placeholder",void 0),t}(w["e"]),Ss=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),js=function(e,t,i,n){var r,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var o=e.length-1;o>=0;o--)(r=e[o])&&(a=(s<3?r(a):s>3?r(t,i,a):r(t,i))||a);return s>3&&a&&Object.defineProperty(t,i,a),a},Rs=["NewFolder","Upload","Cut","Copy","Paste","Delete","Download","Rename","SortBy","Refresh","Selection","View","Details"],Ds=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ss(t,e),js([Object(w["r"])(Rs)],t.prototype,"items",void 0),js([Object(w["r"])(!0)],t.prototype,"visible",void 0),t}(w["e"]),Es=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Is=function(e,t,i,n){var r,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var o=e.length-1;o>=0;o--)(r=e[o])&&(a=(s<3?r(a):s>3?r(t,i,a):r(t,i))||a);return s>3&&a&&Object.defineProperty(t,i,a),a},xs=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Es(t,e),Is([Object(w["r"])("")],t.prototype,"allowedExtensions",void 0),Is([Object(w["r"])(!0)],t.prototype,"autoUpload",void 0),Is([Object(w["r"])(!1)],t.prototype,"autoClose",void 0),Is([Object(w["r"])(0)],t.prototype,"minFileSize",void 0),Is([Object(w["r"])(3e7)],t.prototype,"maxFileSize",void 0),t}(w["e"]),Ms=["alignments","formats","fontname","fontsize","fontcolor","backgroundcolor","align","display","tablerows","tablecolumns","tablecell","tablecellhorizontalalign","tablecellverticalalign","styles","numberformatlist","bulletformatlist"],Ps={alignments:{id:"Alignments",icon:"e-alignments",tooltip:"Alignments",command:"Alignments",subCommand:"Alignments"},justifyleft:{id:"JustifyLeft",icon:"e-justify-left",tooltip:"JustifyLeft",command:"Alignments",subCommand:"JustifyLeft"},justifycenter:{id:"JustifyCenter",icon:"e-justify-center",tooltip:"JustifyCenter",command:"Alignments",subCommand:"JustifyCenter"},justifyright:{id:"JustifyRight",icon:"e-justify-right",tooltip:"JustifyRight",command:"Alignments",subCommand:"JustifyRight"},justifyfull:{id:"JustifyFull",icon:"e-justify-full",tooltip:"JustifyFull",command:"Alignments",subCommand:"JustifyFull"},fontname:{id:"FontName",icon:"e-font-name",tooltip:"Font Name",command:"Font",subCommand:"FontName"},fontsize:{id:"FontSize",icon:"e-font-size",tooltip:"Font Size",command:"Font",subCommand:"FontSize"},fontcolor:{id:"FontColor",icon:"e-font-color",tooltip:"Font Color",command:"Font",subCommand:"FontColor",value:"#ff0000ff"},backgroundcolor:{id:"BackgroundColor",icon:"e-background-color",tooltip:"Background Color",command:"Font",subCommand:"BackgroundColor",value:"#ffff00ff"},bold:{id:"Bold",icon:"e-bold",tooltip:"Bold",command:"Style",subCommand:"Bold"},italic:{id:"Italic",icon:"e-italic",tooltip:"Italic",command:"Style",subCommand:"Italic"},underline:{id:"Underline",icon:"e-underline",tooltip:"Underline",command:"Style",subCommand:"Underline"},strikethrough:{id:"StrikeThrough",icon:"e-strike-through",tooltip:"StrikeThrough",command:"Style",subCommand:"StrikeThrough"},clearformat:{id:"ClearFormat",icon:"e-clear-format",tooltip:"Clear Format",command:"Clear",subCommand:"ClearFormat"},clearall:{id:"ClearAll",icon:"e-clear-all",tooltip:"Clear All",command:"Clear",subCommand:"ClearAll"},cut:{id:"Cut",icon:"e-cut",tooltip:"Cut",command:"ClipBoard",subCommand:"Cut"},copy:{id:"Copy",icon:"e-copy",tooltip:"Copy",command:"ClipBoard",subCommand:"Copy"},paste:{id:"Paste",icon:"e-paste",tooltip:"Paste",command:"ClipBoard",subCommand:"Paste"},unorderedlist:{id:"UnorderedList",icon:"e-unorder-list",tooltip:"Bulleted List",command:"Lists",subCommand:"UL"},orderedlist:{id:"OrderedList",icon:"e-order-list",tooltip:"Numbered List",command:"Lists",subCommand:"OL"},numberformatlist:{id:"NumberFormatList",icon:"e-order-list",tooltip:"Number Format List",command:"NumberFormatList",subCommand:"NumberFormatList"},bulletformatlist:{id:"BulletFormatList",icon:"e-unorder-list",tooltip:"Bullet Format List",command:"BulletFormatList",subCommand:"BulletFormatList"},indent:{id:"Indent",icon:"e-indent",tooltip:"Increase Indent",command:"Indents",subCommand:"Indent"},outdent:{id:"Outdent",icon:"e-outdent",tooltip:"Decrease Indent",command:"Indents",subCommand:"Outdent"},undo:{id:"Undo",icon:"e-undo",tooltip:"Undo",command:"Actions",subCommand:"Undo"},redo:{id:"Redo",icon:"e-redo",tooltip:"Redo",command:"Actions",subCommand:"Redo"},superscript:{id:"SuperScript",icon:"e-super-script",tooltip:"Superscript",command:"Effects",subCommand:"SuperScript"},subscript:{id:"SubScript",icon:"e-sub-script",tooltip:"Subscript",command:"Effects",subCommand:"SubScript"},createlink:{id:"CreateLink",icon:"e-create-link",tooltip:"Insert Hyperlink",command:"Links",subCommand:"CreateLink"},openlink:{id:"OpenLink",icon:"e-open-link",tooltip:"Open Link",command:"Links",subCommand:"OpenLink"},editlink:{id:"EditLink",icon:"e-edit-link",tooltip:"Edit Link",command:"Links",subCommand:"EditLink"},removelink:{id:"RemoveLink",icon:"e-remove-link",tooltip:"Remove Link",command:"Links",subCommand:"RemoveLink"},image:{id:"Image",icon:"e-image",tooltip:"Insert Image",command:"Images",subCommand:"Image"},filemanager:{id:"FileManager",icon:"e-rte-file-manager",tooltip:"File Manager",command:"Files",subCommand:"File"},createtable:{id:"CreateTable",icon:"e-create-table",tooltip:"Create Table",command:"Table",subCommand:"CreateTable"},removetable:{id:"removeTable",icon:"e-remove-table",tooltip:"Remove Table",command:"removeTable",subCommand:"removeTable"},replace:{id:"Replace",icon:"e-replace",tooltip:"Replace",command:"Images",subCommand:"Replace"},align:{id:"Align",icon:"e-align",tooltip:"Align",command:"Images",subCommand:"Align"},caption:{id:"Caption",icon:"e-caption",tooltip:"Image Caption",command:"Images",subCommand:"Caption"},remove:{id:"Remove",icon:"e-remove",tooltip:"Remove",command:"Images",subCommand:"Remove"},openimagelink:{id:"OpenImageLink",icon:"e-open-link",tooltip:"Open Link",command:"Images",subCommand:"OpenImageLink"},editimagelink:{id:"EditImageLink",icon:"e-edit-link",tooltip:"Edit Link",command:"Images",subCommand:"EditImageLink"},removeimagelink:{id:"RemoveImageLink",icon:"e-remove-link",tooltip:"Remove Link",command:"Images",subCommand:"RemoveImageLink"},insertlink:{id:"InsertLink",icon:"e-insert-link",tooltip:"Insert Link",command:"Images",subCommand:"InsertLink"},display:{id:"Display",icon:"e-display",tooltip:"Display",command:"Images",subCommand:"Display"},alttext:{id:"AltText",icon:"e-alt-text",tooltip:"Alternative Text",command:"Images",subCommand:"AltText"},dimension:{id:"Dimension",icon:"e-img-dimension",tooltip:"Change Size",command:"Images",subCommand:"Dimension"},fullscreen:{id:"Maximize",icon:"e-maximize",tooltip:"Maximize",command:"View",subCommand:"Maximize"},maximize:{id:"Maximize",icon:"e-maximize",tooltip:"Maximize",command:"FullScreen",subCommand:"Maximize"},minimize:{id:"Minimize",icon:"e-minimize",tooltip:"Minimize",command:"FullScreen",subCommand:"Minimize"},lowercase:{id:"LowerCase",icon:"e-lower-case",tooltip:"Lower Case",command:"Casing",subCommand:"LowerCase"},uppercase:{id:"UpperCase",icon:"e-upper-case",tooltip:"Upper Case",command:"Casing",subCommand:"UpperCase"},print:{id:"Print",icon:"e-print",tooltip:"Print",command:"Print",subCommand:"Print"},formats:{id:"Formats",icon:"e-formats",tooltip:"Formats",command:"Formats",subCommand:"Formats"},sourcecode:{id:"SourceCode",icon:"e-source-code",tooltip:"Source Code",command:"SourceCode",subCommand:"SourceCode"},preview:{id:"Preview",icon:"e-preview",tooltip:"Preview",command:"Preview",subCommand:"Preview"},viewside:{id:"ViewSide",icon:"e-view-side",tooltip:"ViewSide",command:"ViewSide",subCommand:"ViewSide"},insertcode:{id:"InsertCode",icon:"e-insert-code",tooltip:"Insert Code",command:"Formats",subCommand:"Pre"},tableheader:{id:"TableHeader",icon:"e-table-header",tooltip:"Table Header",command:"Table",subCommand:"TableHeader"},tableremove:{id:"TableRemove",icon:"e-table-remove",tooltip:"Table Remove",command:"Table",subCommand:"TableRemove"},tablerows:{id:"TableRows",icon:"e-table-rows",tooltip:"Table Rows",command:"Table",subCommand:"TableRows"},tablecolumns:{id:"TableColumns",icon:"e-table-columns",tooltip:"Table Columns",command:"Table",subCommand:"TableColumns"},tablecell:{id:"TableCell",icon:"e-table-cell",tooltip:"Table Cell",command:"Table",subCommand:"TableCell"},tablecellbackground:{id:"TableCellBackground",icon:"e-table-cell-background",tooltip:"Table Cell Background",command:"Table",subCommand:"TableCellBackground"},tablecellhorizontalalign:{id:"TableCellHorizontalAlign",icon:"e-table-cell-horizontalAlign",tooltip:"Table Cell HorizontalAlign",command:"Table",subCommand:"TableCellHorizontalAlign"},tablecellverticalalign:{id:"TableCellVerticalAlign",icon:"e-table-cell-verticalAlign",tooltip:"Table Cell VerticalAlign",command:"Table",subCommand:"TableCellVerticalAlign"},tableeditproperties:{id:"TableEditProperties",icon:"e-table-edit-properties",tooltip:"Table Edit Properties",command:"Table",subCommand:"TableEditProperties"},styles:{id:"Styles",icon:"e-table-styles",tooltip:"Styles",command:"Table",subCommand:"Styles"}},Ls=[{locale:"alignmentsDropDownLeft",value:"JustifyLeft"},{locale:"alignmentsDropDownCenter",value:"JustifyCenter"},{locale:"alignmentsDropDownRight",value:"JustifyRight"},{locale:"alignmentsDropDownJustify",value:"JustifyFull"}],Ns=[{iconCss:"e-icons e-justify-left",text:"Align Left",command:"Alignments",subCommand:"JustifyLeft"},{iconCss:"e-icons e-justify-center",text:"Align Center",command:"Alignments",subCommand:"JustifyCenter"},{iconCss:"e-icons e-justify-right",text:"Align Right",command:"Alignments",subCommand:"JustifyRight"},{iconCss:"e-icons e-justify-full",text:"Align Justify",command:"Alignments",subCommand:"JustifyFull"}],As=[{iconCss:"e-icons e-justify-left",command:"Images",subCommand:"JustifyLeft"},{iconCss:"e-icons e-justify-center",command:"Images",subCommand:"JustifyCenter"},{iconCss:"e-icons e-justify-right",command:"Images",subCommand:"JustifyRight"}],Bs=[{locale:"imageDisplayDropDownInline",value:"Inline"},{locale:"imageDisplayDropDownBreak",value:"Break"}],Fs=[{text:"Inline",cssClass:"e-inline",command:"Images",subCommand:"Inline"},{text:"Break",cssClass:"e-break",command:"Images",subCommand:"Break"}],Hs=[{iconCss:"e-icons e-cell-merge",text:"Merge cells",command:"Table",subCommand:"Merge"},{iconCss:"e-icons e-cell-horizontal-split",text:"Horizontal split",command:"Table",subCommand:"HorizontalSplit"},{iconCss:"e-icons e-cell-vertical-split",text:"Vertical split",command:"Table",subCommand:"VerticalSplit"}],Vs=[{locale:"tableInsertRowDropDownBefore",value:"InsertRowBefore"},{locale:"tableInsertRowDropDownAfter",value:"InsertRowAfter"},{locale:"tableInsertRowDropDownDelete",value:"DeleteRow"}],qs=[{iconCss:"e-icons e-insert-row-before",text:"Insert row before",command:"Table",subCommand:"InsertRowBefore"},{iconCss:"e-icons e-insert-row-after",text:"Insert row after",command:"Table",subCommand:"InsertRowAfter"},{iconCss:"e-icons e-delete-row",text:"Delete row",command:"Table",subCommand:"DeleteRow"}],zs=[{locale:"tableInsertColumnDropDownLeft",value:"InsertColumnLeft"},{locale:"tableInsertColumnDropDownRight",value:"InsertColumnRight"},{locale:"tableInsertColumnDropDownDelete",value:"DeleteColumn"}],_s=[{iconCss:"e-icons e-insert-column-left",text:"Insert column left",command:"Table",subCommand:"InsertColumnLeft"},{iconCss:"e-icons e-insert-column-right",text:"Insert column right",command:"Table",subCommand:"InsertColumnRight"},{iconCss:"e-icons e-delete-column",text:"Delete column",command:"Table",subCommand:"DeleteColumn"}],Us=[{locale:"tableVerticalAlignDropDownTop",value:"AlignTop"},{locale:"tableVerticalAlignDropDownMiddle",value:"AlignMiddle"},{locale:"tableVerticalAlignDropDownBottom",value:"AlignBottom"}],Gs=[{iconCss:"e-icons e-align-top",text:"Align Top",command:"Table",subCommand:"AlignTop"},{iconCss:"e-icons e-align-middle",text:"Align Middle",command:"Table",subCommand:"AlignMiddle"},{iconCss:"e-icons e-align-bottom",text:"Align Bottom",command:"Table",subCommand:"AlignBottom"}],Ws=[{locale:"tableStylesDropDownDashedBorder",value:"Dashed"},{locale:"tableStylesDropDownAlternateRows",value:"Alternate"}],Ks=[{text:"Dashed Borders",cssClass:"e-dashed-borders",command:"Table",subCommand:"Dashed"},{text:"Alternate Rows",cssClass:"e-alternate-rows",command:"Table",subCommand:"Alternate"}],$s=["Bold","Italic","Underline","|","Formats","Alignments","OrderedList","UnorderedList","|","CreateLink","Image","|","SourceCode","Undo","Redo"],Xs=[{cssClass:"e-segoe-ui",text:"Segoe UI",command:"Font",subCommand:"FontName",value:"Segoe UI"},{cssClass:"e-arial",text:"Arial",command:"Font",subCommand:"FontName",value:"Arial,Helvetica,sans-serif"},{cssClass:"e-georgia",text:"Georgia",command:"Font",subCommand:"FontName",value:"Georgia,serif"},{cssClass:"e-impact",text:"Impact",command:"Font",subCommand:"FontName",value:"Impact,Charcoal,sans-serif"},{cssClass:"e-tahoma",text:"Tahoma",command:"Font",subCommand:"FontName",value:"Tahoma,Geneva,sans-serif"},{cssClass:"e-times-new-roman",text:"Times New Roman",command:"Font",subCommand:"FontName",value:"Times New Roman,Times,serif"},{cssClass:"e-verdana",text:"Verdana",command:"Font",subCommand:"FontName",value:"Verdana,Geneva,sans-serif"}],Js=[{text:"8 pt",value:"8pt"},{text:"10 pt",value:"10pt"},{text:"12 pt",value:"12pt"},{text:"14 pt",value:"14pt"},{text:"18 pt",value:"18pt"},{text:"24 pt",value:"24pt"},{text:"36 pt",value:"36pt"}],Qs=[{cssClass:"e-paragraph",text:"Paragraph",command:"Formats",subCommand:"P",value:"P"},{cssClass:"e-code",text:"Code",command:"Formats",subCommand:"Pre",value:"Pre"},{cssClass:"e-quote",text:"Quotation",command:"Formats",subCommand:"BlockQuote",value:"BlockQuote"},{cssClass:"e-h1",text:"Heading 1",command:"Formats",subCommand:"H1",value:"H1"},{cssClass:"e-h2",text:"Heading 2",command:"Formats",subCommand:"H2",value:"H2"},{cssClass:"e-h3",text:"Heading 3",command:"Formats",subCommand:"H3",value:"H3"},{cssClass:"e-h4",text:"Heading 4",command:"Formats",subCommand:"H4",value:"H4"}],Ys={Custom:["","#000000","#e7e6e6","#44546a","#4472c4","#ed7d31","#a5a5a5","#ffc000","#70ad47","#ff0000","#f2f2f2","#808080","#cfcdcd","#d5dce4","#d9e2f3","#fbe4d5","#ededed","#fff2cc","#e2efd9","#ffcccc","#d9d9d9","#595959","#aeaaaa","#acb9ca","#b4c6e7","#f7caac","#dbdbdb","#ffe599","#c5e0b3","#ff8080","#bfbfbf","#404040","#747070","#8496b0","#8eaadb","#f4b083","#c9c9c9","#ffd966","#a8d08d","#ff3333","#a6a6a6","#262626","#3b3838","#323e4f","#2f5496","#c45911","#7b7b7b","#bf8f00","#538135","#b30000","#7f7f7f","#0d0d0d","#161616","#212934","#1f3763","#823b0b","#525252","#7f5f00","#375623","#660000"]},Zs={Custom:["","#000000","#ffff00","#00ff00","#00ffff","#0000ff","#ff0000","#000080","#800080","#996633","#f2f2f2","#808080","#ffffcc","#b3ffb3","#ccffff","#ccccff","#ffcccc","#ccccff","#ff80ff","#f2e6d9","#d9d9d9","#595959","#ffff80","#80ff80","#b3ffff","#8080ff","#ff8080","#8080ff","#ff00ff","#dfbf9f","#bfbfbf","#404040","#ffff33","#33ff33","#33ffff","#3333ff","#ff3333","#0000b3","#b300b3","#c68c53","#a6a6a6","#262626","#e6e600","#00b300","#009999","#000099","#b30000","#000066","#660066","#86592d","#7f7f7f","#0d0d0d","#999900","#006600","#006666","#000066","#660000","#00004d","#4d004d","#734d26"]},ea=[{text:"None",command:"Lists",subCommand:"NumberFormatList",value:"none"},{text:"Number",command:"Lists",subCommand:"NumberFormatList",value:"decimal"},{text:"Lower Greek",command:"Lists",subCommand:"NumberFormatList",value:"lowerGreek"},{text:"Lower Roman",command:"Lists",subCommand:"NumberFormatList",value:"lowerRoman"},{text:"Upper Alpha",command:"Lists",subCommand:"NumberFormatList",value:"upperAlpha"},{text:"Lower Alpha",command:"Lists",subCommand:"NumberFormatList",value:"lowerAlpha"},{text:"Upper Roman",command:"Lists",subCommand:"NumberFormatList",value:"upperRoman"}],ta=[{text:"None",command:"Lists",subCommand:"BulletFormatList",value:"none"},{text:"Disc",command:"Lists",subCommand:"BulletFormatList",value:"disc"},{text:"Circle",command:"Lists",subCommand:"BulletFormatList",value:"circle"},{text:"Square",command:"Lists",subCommand:"BulletFormatList",value:"square"}];function ia(e,t,i){for(var n=0;t.length>n;n++)if(t[n].value===i.subCommand)return e.localeObj.getConstant(t[n].locale);return i.text}function na(e){Ns.forEach(function(t,i){Ns[i].text=ia(e,Ls,Ns[i])}),Fs.forEach(function(t,i){Fs[i].text=ia(e,Bs,Fs[i])}),qs.forEach(function(t,i){qs[i].text=ia(e,Vs,qs[i])}),_s.forEach(function(t,i){_s[i].text=ia(e,zs,_s[i])}),Gs.forEach(function(t,i){Gs[i].text=ia(e,Us,Gs[i])}),Ks.forEach(function(t,i){Ks[i].text=ia(e,Ws,Ks[i])})}var ra=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),sa=function(e,t,i,n){var r,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var o=e.length-1;o>=0;o--)(r=e[o])&&(a=(s<3?r(a):s>3?r(t,i,a):r(t,i))||a);return s>3&&a&&Object.defineProperty(t,i,a),a},aa=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ra(t,e),sa([Object(w["r"])(!0)],t.prototype,"enable",void 0),sa([Object(w["r"])(!0)],t.prototype,"enableFloating",void 0),sa([Object(w["r"])(ye.Expand)],t.prototype,"type",void 0),sa([Object(w["r"])($s)],t.prototype,"items",void 0),sa([Object(w["r"])({})],t.prototype,"itemConfigs",void 0),t}(w["e"]),oa=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ra(t,e),sa([Object(w["r"])([".jpeg",".jpg",".png"])],t.prototype,"allowedTypes",void 0),sa([Object(w["r"])("inline")],t.prototype,"display",void 0),sa([Object(w["r"])("Blob")],t.prototype,"saveFormat",void 0),sa([Object(w["r"])("auto")],t.prototype,"width",void 0),sa([Object(w["r"])("auto")],t.prototype,"height",void 0),sa([Object(w["r"])(null)],t.prototype,"saveUrl",void 0),sa([Object(w["r"])(null)],t.prototype,"path",void 0),sa([Object(w["r"])(!0)],t.prototype,"resize",void 0),sa([Object(w["r"])(null)],t.prototype,"removeUrl",void 0),sa([Object(w["r"])(0)],t.prototype,"minWidth",void 0),sa([Object(w["r"])(null)],t.prototype,"maxWidth",void 0),sa([Object(w["r"])(0)],t.prototype,"minHeight",void 0),sa([Object(w["r"])(null)],t.prototype,"maxHeight",void 0),sa([Object(w["r"])(!1)],t.prototype,"resizeByPercent",void 0),t}(w["e"]),la=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ra(t,e),sa([Object(w["g"])({getImageUrl:null,url:null,uploadUrl:null},ls)],t.prototype,"ajaxSettings",void 0),sa([Object(w["r"])(!1)],t.prototype,"allowDragAndDrop",void 0),sa([Object(w["g"])({visible:!0,file:["Open","|","Cut","Copy","|","Delete","Rename","|","Details"],folder:["Open","|","Cut","Copy","Paste","|","Delete","Rename","|","Details"],layout:["SortBy","View","Refresh","|","Paste","|","NewFolder","Upload","|","Details","|","SelectAll"]},ms)],t.prototype,"contextMenuSettings",void 0),sa([Object(w["r"])("")],t.prototype,"cssClass",void 0),sa([Object(w["g"])({},vs)],t.prototype,"detailsViewSettings",void 0),sa([Object(w["r"])(!1)],t.prototype,"enable",void 0),sa([Object(w["g"])({maxWidth:"650px",minWidth:"240px",visible:!0},ws)],t.prototype,"navigationPaneSettings",void 0),sa([Object(w["r"])("/")],t.prototype,"path",void 0),sa([Object(w["r"])(null)],t.prototype,"rootAliasName",void 0),sa([Object(w["g"])({},ks)],t.prototype,"searchSettings",void 0),sa([Object(w["r"])(!0)],t.prototype,"showFileExtension",void 0),sa([Object(w["r"])(!1)],t.prototype,"showHiddenItems",void 0),sa([Object(w["r"])(!0)],t.prototype,"showThumbnail",void 0),sa([Object(w["r"])("Ascending")],t.prototype,"sortOrder",void 0),sa([Object(w["g"])({visible:!0,items:["NewFolder","Upload","Cut","Copy","Paste","Delete","Download","Rename","SortBy","Refresh","Selection","View","Details"]},Ds)],t.prototype,"toolbarSettings",void 0),sa([Object(w["g"])({autoUpload:!0,minFileSize:0,maxFileSize:3e7,allowedExtensions:"",autoClose:!1},xs)],t.prototype,"uploadSettings",void 0),sa([Object(w["r"])("LargeIcons")],t.prototype,"view",void 0),t}(w["e"]),da=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ra(t,e),sa([Object(w["r"])("100%")],t.prototype,"width",void 0),sa([Object(w["r"])(Ks)],t.prototype,"styles",void 0),sa([Object(w["r"])(!0)],t.prototype,"resize",void 0),sa([Object(w["r"])(0)],t.prototype,"minWidth",void 0),sa([Object(w["r"])(null)],t.prototype,"maxWidth",void 0),t}(w["e"]),ca=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ra(t,e),sa([Object(w["r"])(!0)],t.prototype,"enable",void 0),sa([Object(w["r"])(!1)],t.prototype,"showOnRightClick",void 0),sa([Object(w["r"])("hide")],t.prototype,"actionOnScroll",void 0),sa([Object(w["r"])(["Open","Edit","UnLink"])],t.prototype,"link",void 0),sa([Object(w["r"])(["Replace","Align","Caption","Remove","-","InsertLink","OpenImageLink","EditImageLink","RemoveImageLink","Display","AltText","Dimension"])],t.prototype,"image",void 0),sa([Object(w["r"])(["Cut","Copy","Paste"])],t.prototype,"text",void 0),sa([Object(w["r"])(["TableHeader","TableRows","TableColumns","BackgroundColor","-","TableRemove","Alignments","TableCellVerticalAlign","Styles"])],t.prototype,"table",void 0),t}(w["e"]),ha=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ra(t,e),sa([Object(w["r"])(!1)],t.prototype,"prompt",void 0),sa([Object(w["r"])(null)],t.prototype,"deniedAttrs",void 0),sa([Object(w["r"])(["background","background-color","border","border-bottom","border-left","border-radius","border-right","border-style","border-top","border-width","clear","color","cursor","direction","display","float","font","font-family","font-size","font-weight","font-style","height","left","line-height","list-style-type","margin","margin-top","margin-left","margin-right","margin-bottom","max-height","max-width","min-height","min-width","overflow","overflow-x","overflow-y","padding","padding-bottom","padding-left","padding-right","padding-top","position","right","table-layout","text-align","text-decoration","text-indent","top","vertical-align","visibility","white-space","width"])],t.prototype,"allowedStyleProps",void 0),sa([Object(w["r"])(null)],t.prototype,"deniedTags",void 0),sa([Object(w["r"])(!0)],t.prototype,"keepFormat",void 0),sa([Object(w["r"])(!1)],t.prototype,"plainText",void 0),t}(w["e"]),pa=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ra(t,e),sa([Object(w["r"])(null)],t.prototype,"default",void 0),sa([Object(w["r"])("65px")],t.prototype,"width",void 0),sa([Object(w["r"])(Xs)],t.prototype,"items",void 0),t}(w["e"]),ua=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ra(t,e),sa([Object(w["r"])(null)],t.prototype,"default",void 0),sa([Object(w["r"])("35px")],t.prototype,"width",void 0),sa([Object(w["r"])(Js)],t.prototype,"items",void 0),t}(w["e"]),ma=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ra(t,e),sa([Object(w["r"])(null)],t.prototype,"default",void 0),sa([Object(w["r"])("65px")],t.prototype,"width",void 0),sa([Object(w["r"])(Qs)],t.prototype,"types",void 0),t}(w["e"]),ga=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ra(t,e),sa([Object(w["r"])("#ff0000")],t.prototype,"default",void 0),sa([Object(w["r"])("Palette")],t.prototype,"mode",void 0),sa([Object(w["r"])(10)],t.prototype,"columns",void 0),sa([Object(w["r"])(Ys)],t.prototype,"colorCode",void 0),sa([Object(w["r"])(!1)],t.prototype,"modeSwitcher",void 0),t}(w["e"]),fa=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ra(t,e),sa([Object(w["r"])("#ffff00")],t.prototype,"default",void 0),sa([Object(w["r"])("Palette")],t.prototype,"mode",void 0),sa([Object(w["r"])(10)],t.prototype,"columns",void 0),sa([Object(w["r"])(Zs)],t.prototype,"colorCode",void 0),sa([Object(w["r"])(!1)],t.prototype,"modeSwitcher",void 0),t}(w["e"]),ba=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ra(t,e),sa([Object(w["r"])(ea)],t.prototype,"types",void 0),t}(w["e"]),va=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ra(t,e),sa([Object(w["r"])(ta)],t.prototype,"types",void 0),t}(w["e"]),ya=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Ca=function(e,t,i,n){var r,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var o=e.length-1;o>=0;o--)(r=e[o])&&(a=(s<3?r(a):s>3?r(t,i,a):r(t,i))||a);return s>3&&a&&Object.defineProperty(t,i,a),a},wa=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ya(t,e),Ca([Object(w["r"])([])],t.prototype,"styles",void 0),Ca([Object(w["r"])([])],t.prototype,"scripts",void 0),t}(w["e"]),Oa=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ya(t,e),Ca([Object(w["r"])(!1)],t.prototype,"enable",void 0),Ca([Object(w["r"])(null)],t.prototype,"attributes",void 0),Ca([Object(w["g"])({},wa)],t.prototype,"resources",void 0),t}(w["e"]),Ta=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ka=function(e,t,i,n){var r,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var o=e.length-1;o>=0;o--)(r=e[o])&&(a=(s<3?r(a):s>3?r(t,i,a):r(t,i))||a);return s>3&&a&&Object.defineProperty(t,i,a),a},Sa=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ta(t,e),ka([Object(w["r"])(!1)],t.prototype,"enable",void 0),ka([Object(w["r"])(!0)],t.prototype,"onSelection",void 0),t}(w["e"]),ja={alignments:"Alignments",justifyLeft:"Align Left",justifyCenter:"Align Center",justifyRight:"Align Right",justifyFull:"Align Justify",fontName:"Font Name",fontSize:"Font Size",fontColor:"Font Color",backgroundColor:"Background Color",bold:"Bold",italic:"Italic",underline:"Underline",strikethrough:"Strikethrough",clearFormat:"Clear Format",clearAll:"Clear All",cut:"Cut",copy:"Copy",paste:"Paste",unorderedList:"Bulleted List",orderedList:"Numbered List",indent:"Increase Indent",outdent:"Decrease Indent",undo:"Undo",redo:"Redo",superscript:"Superscript",subscript:"Subscript",createLink:"Insert Link",openLink:"Open Link",editLink:"Edit Link",removeLink:"Remove Link",image:"Insert Image",replace:"Replace",align:"Align",caption:"Image Caption",remove:"Remove",insertLink:"Insert Link",display:"Display",altText:"Alternative Text",dimension:"Change Size",fullscreen:"Maximize",maximize:"Maximize",minimize:"Minimize",lowerCase:"Lower Case",upperCase:"Upper Case",print:"Print",formats:"Formats",sourcecode:"Code View",preview:"Preview",viewside:"ViewSide",insertCode:"Insert Code",linkText:"Display Text",linkTooltipLabel:"Title",linkWebUrl:"Web Address",linkTitle:"Enter a title",linkurl:"http://example.com",linkOpenInNewWindow:"Open Link in New Window",linkHeader:"Insert Link",dialogInsert:"Insert",dialogCancel:"Cancel",dialogUpdate:"Update",imageHeader:"Insert Image",imageLinkHeader:"You can also provide a link from the web",mdimageLink:"Please provide a URL for your image",imageUploadMessage:"Drop image here or browse to upload",imageDeviceUploadMessage:"Click here to upload",imageAlternateText:"Alternate Text",alternateHeader:"Alternative Text",browse:"Browse",imageUrl:"http://example.com/image.png",imageCaption:"Caption",imageSizeHeader:"Image Size",imageHeight:"Height",imageWidth:"Width",textPlaceholder:"Enter Text",inserttablebtn:"Insert Table",tabledialogHeader:"Insert Table",tableWidth:"Width",cellpadding:"Cell Padding",cellspacing:"Cell Spacing",columns:"Number of columns",rows:"Number of rows",tableRows:"Table Rows",tableColumns:"Table Columns",tableCellHorizontalAlign:"Table Cell Horizontal Align",tableCellVerticalAlign:"Table Cell Vertical Align",createTable:"Create Table",removeTable:"Remove Table",tableHeader:"Table Header",tableRemove:"Table Remove",tableCellBackground:"Table Cell Background",tableEditProperties:"Table Edit Properties",styles:"Styles",insertColumnLeft:"Insert Column Left",insertColumnRight:"Insert Column Right",deleteColumn:"Delete Column",insertRowBefore:"Insert Row Before",insertRowAfter:"Insert Row After",deleteRow:"Delete Row",tableEditHeader:"Edit Table",TableHeadingText:"Heading",TableColText:"Col",imageInsertLinkHeader:"Insert Link",editImageHeader:"Edit Image",alignmentsDropDownLeft:"Align Left",alignmentsDropDownCenter:"Align Center",alignmentsDropDownRight:"Align Right",alignmentsDropDownJustify:"Align Justify",imageDisplayDropDownInline:"Inline",imageDisplayDropDownBreak:"Break",tableInsertRowDropDownBefore:"Insert row before",tableInsertRowDropDownAfter:"Insert row after",tableInsertRowDropDownDelete:"Delete row",tableInsertColumnDropDownLeft:"Insert column left",tableInsertColumnDropDownRight:"Insert column right",tableInsertColumnDropDownDelete:"Delete column",tableVerticalAlignDropDownTop:"Align Top",tableVerticalAlignDropDownMiddle:"Align Middle",tableVerticalAlignDropDownBottom:"Align Bottom",tableStylesDropDownDashedBorder:"Dashed Borders",tableStylesDropDownAlternateRows:"Alternate Rows",pasteFormat:"Paste Format",pasteFormatContent:"Choose the formatting action",plainText:"Plain Text",cleanFormat:"Clean",keepFormat:"Keep",pasteDialogOk:"OK",pasteDialogCancel:"Cancel",fileManager:"File Manager",fileDialogHeader:"File Browser",formatsDropDownParagraph:"Paragraph",formatsDropDownCode:"Code",formatsDropDownQuotation:"Quotation",formatsDropDownHeading1:"Heading 1",formatsDropDownHeading2:"Heading 2",formatsDropDownHeading3:"Heading 3",formatsDropDownHeading4:"Heading 4",fontNameSegoeUI:"Segoe UI",fontNameArial:"Arial",fontNameGeorgia:"Georgia",fontNameImpact:"Impact",fontNameTahoma:"Tahoma",fontNameTimesNewRoman:"Times New Roman",fontNameVerdana:"Verdana",numberFormatListNumber:"Number",numberFormatListLowerAlpha:"LowerAlpha",numberFormatListUpperAlpha:"UpperAlpha",numberFormatListLowerRoman:"LowerRoman",numberFormatListUpperRoman:"UpperRoman",numberFormatListLowerGreek:"LowerGreek",bulletFormatListDisc:"Disc",bulletFormatListCircle:"Circle",bulletFormatListSquare:"Square",numberFormatListNone:"None",bulletFormatListNone:"None"},Ra={alignments:"alignments",justifyleft:"justifyLeft",justifycenter:"justifyCenter",justifyright:"justifyRight",justifyfull:"justifyFull",fontname:"fontName",fontsize:"fontSize",fontcolor:"fontColor",backgroundcolor:"backgroundColor",bold:"bold",italic:"italic",underline:"underline",strikethrough:"strikethrough",clearformat:"clearFormat",clearall:"clearAll",cut:"cut",copy:"copy",paste:"paste",unorderedlist:"unorderedList",orderedlist:"orderedList",indent:"indent",outdent:"outdent",undo:"undo",redo:"redo",superscript:"superscript",subscript:"subscript",createlink:"createLink",openlink:"openLink",editlink:"editLink",removelink:"removeLink",openimagelink:"openLink",editimagelink:"editLink",removeimagelink:"removeLink",image:"image",replace:"replace",align:"align",caption:"caption",remove:"remove",insertlink:"insertLink",display:"display",alttext:"altText",dimension:"dimension",fullscreen:"fullscreen",maximize:"maximize",minimize:"minimize",lowercase:"lowerCase",uppercase:"upperCase",print:"print",formats:"formats",sourcecode:"sourcecode",preview:"preview",viewside:"viewside",insertcode:"insertCode",tablerows:"tableRows",tablecolumns:"tableColumns",tablecellhorizontalalign:"tableCellHorizontalAlign",tablecellverticalalign:"tableCellVerticalAlign",createtable:"createTable",removetable:"removeTable",tableheader:"tableHeader",tableremove:"tableRemove",tablecellbackground:"tableCellBackground",tableeditproperties:"tableEditProperties",styles:"styles",insertcolumnleft:"insertColumnLeft",insertcolumnright:"insertColumnRight",deletecolumn:"deleteColumn",aligntop:"AlignTop",alignmiddle:"AlignMiddle",alignbottom:"AlignBottom",insertrowbefore:"insertRowBefore",insertrowafter:"insertRowAfter",deleterow:"deleteRow"},Da=[{locale:"fontNameSegoeUI",value:"Segoe UI"},{locale:"fontNameArial",value:"Arial,Helvetica,sans-serif"},{locale:"fontNameGeorgia",value:"Georgia,serif"},{locale:"fontNameImpact",value:"Impact,Charcoal,sans-serif"},{locale:"fontNameTahoma",value:"Tahoma,Geneva,sans-serif"},{locale:"fontNameTimesNewRoman",value:"Times New Roman,Times,serif"},{locale:"fontNameVerdana",value:"Verdana,Geneva,sans-serif"}],Ea=[{locale:"formatsDropDownParagraph",value:"P"},{locale:"formatsDropDownCode",value:"Pre"},{locale:"formatsDropDownQuotation",value:"BlockQuote"},{locale:"formatsDropDownHeading1",value:"H1"},{locale:"formatsDropDownHeading2",value:"H2"},{locale:"formatsDropDownHeading3",value:"H3"},{locale:"formatsDropDownHeading4",value:"H4"}],Ia=[{locale:"numberFormatListNone",value:"none"},{locale:"numberFormatListNumber",value:"decimal"},{locale:"numberFormatListLowerAlpha",value:"lower-alpha"},{locale:"numberFormatListUpperAlpha",value:"upper-alpha"},{locale:"numberFormatListLowerRoman",value:"lower-roman"},{locale:"numberFormatListUpperRoman",value:"upper-roman"},{locale:"numberFormatListLowerGreek",value:"lower-greek"}],xa=[{locale:"bulletFormatListNone",value:"none"},{locale:"bulletFormatListDisc",value:"disc"},{locale:"bulletFormatListCircle",value:"circle"},{locale:"bulletFormatListSquare",value:"square"}];function Ma(e,t,i,n){var r;if(i){var s=t.contentModule.getDocument();r=s.querySelector("body")}else r=t.element;if(Object.keys(e).length)for(var a=0,o=Object.keys(e);a<o.length;a++){var l=o[a];if("class"===l)r.classList.add(e[l]);else if("disabled"===l&&"disabled"===e[l])t.enabled=!1,t.setEnable();else if("readonly"===l&&"readonly"===e[l])t.readonly=!0,t.setReadOnly(n);else if("style"===l)r.setAttribute("style",e[l]);else if("tabindex"===l)t.inputElement.setAttribute("tabindex",e[l]);else if("placeholder"===l)t.placeholder=e[l],t.setPlaceHolder();else{var d=["name","required"];d.indexOf(l)>-1?t.valueContainer.setAttribute(l,e[l]):r.setAttribute(l,e[l])}}}var Pa=function(){function e(e){this.parent=e,this.addEventListener()}return e.prototype.showFullScreen=function(e){var t=this;if(!0!==this.parent.toolbarSettings.enable||"Markdown"===this.parent.editorMode||Object(w["T"])(this.parent.quickToolbarModule)||this.parent.quickToolbarModule.hideQuickToolbars(),this.scrollableParent=Object(Vt["c"])(this.parent.element),!this.parent.element.classList.contains(Nn)){var i={cancel:!1,requestType:"Maximize",targetItem:"Maximize",args:e};this.parent.trigger(Ci,i,function(i){if(!i.cancel){t.parent.toolbarSettings.enableFloating&&!t.parent.inlineMode.enable&&t.parent.toolbarSettings.enable&&(t.parent.getToolbarElement().style.width="100%",t.parent.getToolbarElement().style.top="0px"),t.parent.element.classList.add(Nn),t.toggleParentOverflow(!0);var n=t.parent.element.querySelectorAll(".e-toolbar-extended.e-popup-open").length>0;t.parent.setContentHeight(null,n),t.parent.toolbarModule&&(t.parent.getBaseToolbarObject().toolbarObj.items[0].properties||t.parent.getBaseToolbarObject().toolbarObj.removeItems(0),w["d"].isDevice&&t.parent.toolbarModule.removeFixedTBarClass(),t.parent.toolbarModule.updateItem({targetItem:"Maximize",updateItem:"Minimize",baseToolbar:t.parent.getBaseToolbarObject()})),t.parent.trigger(wi,{requestType:"Maximize",targetItem:"Maximize",args:e})}})}},e.prototype.hideFullScreen=function(e){var t=this;if(!0!==this.parent.toolbarSettings.enable||"Markdown"===this.parent.editorMode||Object(w["T"])(this.parent.quickToolbarModule)||this.parent.quickToolbarModule.hideQuickToolbars(),this.parent.element.classList.contains(Nn)){var i={cancel:!1,requestType:"Minimize",targetItem:"Minimize",args:e};this.parent.trigger(Ci,i,function(i){if(!i.cancel){t.parent.element.classList.remove(Nn);for(var n=document.querySelectorAll(".e-rte-overflow"),r=0;r<n.length;r++)Object(w["gb"])([n[r]],["e-rte-overflow"]);var s=t.parent.element.querySelectorAll(".e-toolbar-extended.e-popup-open").length>0;t.parent.setContentHeight(null,s),t.parent.toolbarModule&&(t.parent.getBaseToolbarObject().toolbarObj.items[0].properties||t.parent.getBaseToolbarObject().toolbarObj.removeItems(0),t.parent.toolbarModule.updateItem({targetItem:"Minimize",updateItem:"Maximize",baseToolbar:t.parent.getBaseToolbarObject()}),w["d"].isDevice&&t.parent.inlineMode.enable&&t.parent.toolbarModule.addFixedTBarClass()),t.parent.trigger(wi,{requestType:"Minimize",targetItem:"Minimize",args:e})}})}},e.prototype.toggleParentOverflow=function(e){if(!Object(w["T"])(this.scrollableParent))for(var t=0;t<this.scrollableParent.length;t++)if("#document"===this.scrollableParent[t].nodeName){var i=document.querySelector("body");Object(w["u"])([i],["e-rte-overflow"])}else{i=this.scrollableParent[t];Object(w["u"])([i],["e-rte-overflow"])}},e.prototype.onKeyDown=function(e){var t=e.args;switch(t.action){case"full-screen":this.showFullScreen(e.args),t.preventDefault();break;case"escape":this.hideFullScreen(e.args),t.preventDefault();break}},e.prototype.addEventListener=function(){this.parent.on(ri,this.onKeyDown,this),this.parent.on(Wt,this.destroy,this)},e.prototype.removeEventListener=function(){this.parent.off(ri,this.onKeyDown),this.parent.off(Wt,this.destroy)},e.prototype.destroy=function(){this.parent.element.classList.contains(Nn)&&this.toggleParentOverflow(!1);for(var e=document.querySelectorAll(".e-rte-overflow"),t=0;t<e.length;t++)Object(w["gb"])([e[t]],["e-rte-overflow"]);this.removeEventListener()},e}(),La=function(){function e(e){this.parent=e,this.addEventListener()}return e.prototype.addEventListener=function(){this.parent.on(Zi,this.enterHandler,this),this.parent.on(Wt,this.destroy,this)},e.prototype.destroy=function(){this.removeEventListener()},e.prototype.removeEventListener=function(){this.parent.off(Zi,this.enterHandler),this.parent.off(Wt,this.destroy)},e.prototype.getRangeNode=function(){this.range=this.parent.getRange(),this.startNode="#text"===this.range.startContainer.nodeName?this.range.startContainer.parentElement:this.range.startContainer,this.endNode="#text"===this.range.endContainer.nodeName?this.range.endContainer.parentElement:this.range.endContainer},e.prototype.enterHandler=function(e){var t=this;this.getRangeNode();var i=!0;if(!Object(w["T"])(this.startNode.closest("TABLE"))&&!Object(w["T"])(this.endNode.closest("TABLE"))){i=!1;var n=this.startNode,r=n;while(!this.parent.formatter.editorManager.domNode.isBlockNode(n))r=n,n=n.parentElement;i="TD"!==r.tagName}if(13===e.args.which&&"Enter"===e.args.code&&Object(w["T"])(this.startNode.closest("LI"))&&Object(w["T"])(this.endNode.closest("LI"))&&i&&Object(w["T"])(this.startNode.closest("PRE"))&&Object(w["T"])(this.endNode.closest("PRE"))){var s=e.args.shiftKey,a={cancel:!1,name:Ci,requestType:s?"ShiftEnterAction":"EnterAction",originalEvent:e.args};this.parent.trigger(Ci,a,function(n){if(!n.cancel){if(t.range.startOffset!==t.range.endOffset||t.range.startContainer!==t.range.endContainer)if(t.range.deleteContents(),"#text"===t.range.startContainer.nodeName&&0===t.range.startContainer.textContent.length&&t.range.startContainer.parentElement!==t.parent.inputElement)"BR"===t.parent.enterKey?t.range.startContainer.parentElement.innerHTML="&#8203;":t.range.startContainer.parentElement.innerHTML="<br>";else if(t.range.startContainer===t.parent.inputElement&&""===t.range.startContainer.innerHTML){t.range.startContainer.innerHTML="<br>";var r=t.range.startContainer.childNodes[t.range.startOffset];t.parent.formatter.editorManager.nodeSelection.setCursorPoint(t.parent.contentModule.getDocument(),r,0)}else if(t.parent.inputElement===t.range.startContainer){r=t.range.startContainer.childNodes[t.range.startOffset];if("#text"===r.nodeName&&0===r.textContent.length)t.parent.formatter.editorManager.nodeSelection.setCursorPoint(t.parent.contentModule.getDocument(),r,r.previousSibling.textContent.length);else if(t.parent.formatter.editorManager.nodeSelection.setCursorPoint(t.parent.contentModule.getDocument(),r,r.textContent.length>=0?0:1),0===r.previousSibling.textContent.length)Object(w["F"])(r.previousSibling);else if(0===r.textContent.length){var a=r.previousSibling.lastChild;while("#text"!==a.nodeName)a=a.lastChild;t.parent.formatter.editorManager.nodeSelection.setCursorPoint(t.parent.contentModule.getDocument(),a,a.textContent.length),Object(w["F"])(r)}else if("BR"!==t.parent.enterKey&&0!==r.previousSibling.textContent.length&&0!==r.textContent.length)return void e.args.preventDefault();t.getRangeNode()}if(t.range.startContainer===t.range.endContainer&&t.range.startOffset===t.range.endOffset&&t.range.startContainer===t.parent.inputElement&&(t.parent.formatter.editorManager.nodeSelection.setCursorPoint(t.parent.contentModule.getDocument(),t.range.startContainer.childNodes[t.range.startOffset],0),t.getRangeNode()),"P"===t.parent.enterKey&&!s||"DIV"===t.parent.enterKey&&!s||"P"===t.parent.shiftEnterKey&&s||"DIV"===t.parent.shiftEnterKey&&s){var o=void 0;o=i&&t.parent.formatter.editorManager.domNode.isBlockNode(t.startNode)?t.startNode:t.parent.formatter.editorManager.domNode.blockParentNode(t.startNode);var l=!1,d=!1;if(0==t.range.startOffset||0==t.range.endOffset||t.range.startContainer!==t.range.endContainer||!Object(w["T"])(o.childNodes[0])&&"IMG"===o.childNodes[0].nodeName)0===t.range.startOffset&&0===t.range.endOffset&&(d=!0);else{var c=t.range.startContainer.textContent,h=c.substring(0,t.range.startOffset);160!=h.charCodeAt(t.range.startOffset-1)&&0===h.trim().length&&(d=!0)}if(t.removeBRElement(o),(0===t.range.startOffset&&0===t.range.endOffset||d)&&(Object(w["T"])(t.range.startContainer.previousSibling)||"IMG"!==t.range.startContainer.previousSibling.nodeName&&"BR"!==t.range.startContainer.previousSibling.nodeName)){var p=void 0,u=void 0;"IMG"===t.range.startContainer.nodeName?(u=t.createInsertElement(s),l=!0,p=!1):0!==o.textContent.trim().length?(u=t.parent.formatter.editorManager.nodeCutter.SplitNode(t.range,o,!1).cloneNode(!0),p=!1):(u=t.parent.formatter.editorManager.nodeCutter.SplitNode(t.range,o,!0).cloneNode(!0),p=!0);var m=t.createInsertElement(s);while(u.firstChild)m.appendChild(u.firstChild);if(o.parentElement.insertBefore(m,o),!p){a=m;var g=void 0;while(!Object(w["T"])(a)&&"#text"!==a.nodeName)g=a,a=a.lastChild;g.innerHTML="<br>",l||Object(w["F"])(o)}t.parent.formatter.editorManager.nodeSelection.setCursorPoint(t.parent.contentModule.getDocument(),m.nextElementSibling,0)}else if(0!==o.textContent.length||!Object(w["T"])(o.childNodes[0])&&"IMG"===o.childNodes[0].nodeName){u=t.parent.formatter.editorManager.nodeCutter.SplitNode(t.range,o,!0);if(Object(w["T"])(u.childNodes[0])||"#text"!==u.childNodes[0].nodeName||0!==u.childNodes[0].textContent.length||Object(w["F"])(u.childNodes[0]),0===u.textContent.trim().length){var f=t.parent.createElement("br");if("A"===t.startNode.nodeName){var b=t.startNode.parentElement;t.startNode.parentElement.insertBefore(f,t.startNode),Object(w["F"])(t.startNode),t.startNode=b}else t.startNode.appendChild(f);"\n"===u.childNodes[0].textContent&&Object(w["F"])(u.childNodes[0]),t.parent.formatter.editorManager.nodeSelection.setCursorPoint(t.parent.contentModule.getDocument(),t.startNode,0)}if(("P"===t.parent.enterKey||"DIV"===t.parent.enterKey)&&!s||("DIV"===t.parent.shiftEnterKey||"P"===t.parent.shiftEnterKey)&&s){var v=t.createInsertElement(s);while(u.firstChild)v.appendChild(u.firstChild);t.parent.formatter.editorManager.domNode.insertAfter(v,u),Object(w["F"])(u),t.parent.formatter.editorManager.nodeSelection.setCursorPoint(t.parent.contentModule.getDocument(),t.parent.formatter.editorManager.domNode.isBlockNode(t.startNode)?v:t.startNode,0)}}else if(Object(w["T"])(o.children[0])||"BR"===o.children[0].tagName){m=t.createInsertElement(s);m.innerHTML="<br>",t.parent.formatter.editorManager.domNode.insertAfter(m,o),t.parent.formatter.editorManager.nodeSelection.setCursorPoint(t.parent.contentModule.getDocument(),m,0)}else{var u=t.parent.formatter.editorManager.nodeCutter.SplitNode(t.range,o,!1).cloneNode(!0);t.parent.formatter.editorManager.domNode.insertAfter(u,o),t.parent.formatter.editorManager.nodeSelection.setCursorPoint(t.parent.contentModule.getDocument(),u,u.textContent.length>=0?0:1)}e.args.preventDefault()}if("BR"===t.parent.enterKey&&!s||"BR"===t.parent.shiftEnterKey&&s){var y=void 0;if(t.parent.formatter.editorManager.domNode.isBlockNode(t.startNode))y=t.startNode;else{var C=t.startNode,O=C;while(!t.parent.formatter.editorManager.domNode.isBlockNode(C))O=C,C=C.parentElement;y=C===t.parent.inputElement?O:C}t.removeBRElement(y);var T=y.lastChild;while(!Object(w["T"])(T)&&"#text"!==T.nodeName&&"BR"!==T.nodeName)T=T.lastChild;var k=t.range.startContainer===T?t.range.startContainer.textContent.length:y.textContent.length;if(y!==t.parent.inputElement&&t.parent.formatter.editorManager.domNode.isBlockNode(y)&&t.range.startOffset===t.range.endOffset&&t.range.startOffset===k){var S=t.parent.createElement("br");if("BR"===T.nodeName&&0===y.textContent.length)t.parent.formatter.editorManager.domNode.insertAfter(S,T);else{var j=t.parent.createElement("br");t.parent.formatter.editorManager.domNode.insertAfter(S,t.range.startContainer),t.parent.formatter.editorManager.domNode.insertAfter(j,t.range.startContainer)}t.parent.formatter.editorManager.nodeSelection.setCursorPoint(t.parent.contentModule.getDocument(),S,0)}else if(Object(w["T"])(y)||y===t.parent.inputElement||"BR"===y.nodeName)t.insertBRElement();else if(0===y.textContent.trim().length||1===y.textContent.trim().length&&8203===y.textContent.charCodeAt(0)){u=t.parent.formatter.editorManager.nodeCutter.SplitNode(t.range,y,!0).cloneNode(!0);t.parent.formatter.editorManager.domNode.insertAfter(u,y);var R=t.parent.createElement("br");u.parentElement.insertBefore(R,u),t.parent.formatter.editorManager.nodeSelection.setCursorPoint(t.parent.contentModule.getDocument(),u,0)}else{u=void 0,R=t.parent.createElement("br");if(0!==t.range.startOffset||0!==t.range.endOffset||Object(w["T"])(y.previousSibling)||"BR"!==y.previousSibling.nodeName)t.insertBRElement();else{u=t.parent.formatter.editorManager.nodeCutter.SplitNode(t.range,y,!1).cloneNode(!0),t.parent.formatter.editorManager.domNode.insertAfter(R,y),t.insertFocusContent();a=R.nextSibling;while(!Object(w["T"])(a)&&"#text"!==a.nodeName)a=a.lastChild;t.parent.formatter.editorManager.nodeSelection.setCursorPoint(t.parent.contentModule.getDocument(),a,0),!0}}e.args.preventDefault()}t.parent.trigger(wi,{requestType:s?"ShiftEnterAction":"EnterAction",args:e.args})}})}},e.prototype.removeBRElement=function(e){-1!=w["d"].userAgent.indexOf("Firefox")&&this.range.endOffset===e.textContent.length&&(0!==e.textContent.length||e.querySelectorAll("BR").length>1)&&!Object(w["T"])(e.lastChild)&&"BR"===e.lastChild.nodeName&&Object(w["F"])(e.lastChild)},e.prototype.insertBRElement=function(){var e=!1,t=this.parent.createElement("br");if("BR"===this.startNode.nodeName&&"BR"===this.endNode.nodeName&&0===this.range.startOffset&&this.range.startOffset===this.range.endOffset?(this.parent.formatter.editorManager.domNode.insertAfter(t,this.startNode),e=!0):(this.startNode!==this.parent.inputElement||Object(w["T"])(this.range.startContainer.previousSibling)||"BR"!==this.range.startContainer.previousSibling.nodeName||0!==this.range.startContainer.textContent.length||(e=!0),this.range.insertNode(t)),e||!Object(w["T"])(t.nextElementSibling)&&"BR"===t.nextElementSibling.tagName||!Object(w["T"])(t.nextSibling)&&t.nextSibling.textContent.length>0)this.parent.formatter.editorManager.nodeSelection.setCursorPoint(this.parent.contentModule.getDocument(),Object(w["T"])(t.nextSibling)?t:t.nextSibling,0),e=!1;else{var i=this.parent.createElement("br");this.range.insertNode(i),this.parent.formatter.editorManager.nodeSelection.setCursorPoint(this.parent.contentModule.getDocument(),t,0)}},e.prototype.insertFocusContent=function(){0===this.range.startContainer.textContent.length&&("#text"===this.range.startContainer.nodeName?this.range.startContainer.parentElement.innerHTML="&#8203;":this.range.startContainer.innerHTML="&#8203;")},e.prototype.createInsertElement=function(e){var t;return"DIV"===this.parent.enterKey&&!e||"DIV"===this.parent.shiftEnterKey&&e?t=this.parent.createElement("div"):("P"===this.parent.enterKey&&!e||"P"===this.parent.shiftEnterKey&&e)&&(t=this.parent.createElement("p")),t},e}(),Na=["Undo","Redo"],Aa=["a","abbr","acronym","audio","b","bdi","bdo","big","br","button","canvas","cite","code","data","datalist","del","dfn","em","embed","font","i","iframe","img","input","ins","kbd","label","map","mark","meter","noscript","object","output","picture","progress","q","ruby","s","samp","script","select","slot","small","span","strong","strike","sub","sup","svg","template","textarea","time","u","tt","var","video","wbr"];function Ba(e,t){var i=-1;return t.some(function(t,n){return"string"===typeof t&&e===t.toLocaleLowerCase()&&(i=n,!0)}),i}function Fa(e,t){var i=!1;return e.classList.contains(t)&&(i=!0),i}function Ha(e,t,i,n){for(var r,s,a=0;a<e.length;a++){if("value"===i&&e[a].value.toLocaleLowerCase()===t.toLocaleLowerCase()){r=e[a];break}if("text"===i&&e[a].text.toLocaleLowerCase()===t.toLocaleLowerCase()){r=e[a];break}if("subCommand"===i&&e[a].subCommand.toLocaleLowerCase()===t.toLocaleLowerCase()){r=e[a];break}}if(!Object(w["T"])(r))switch(n){case"text":s=r.text;break;case"value":s=r.value;break;case"iconCss":s=r.iconCss;break}return s}function Va(){var e=!1;return w["d"].isDevice&&w["d"].isIos&&(e=!0),e}function qa(e){return Object(w["T"])(e)?"":e}function za(e,t,i){var n=0;return n=i?window.pageYOffset+t.getBoundingClientRect().top+e.clientY:e.pageY,n}function _a(e,t){var i=t.getService("rteLocale"),n=Ra[e],r=i.getConstant(n);return r}function Ua(e,t,i){so(i);for(var n=e.dropDownModule,r=e.args,s=Object.keys(e.args),a=0,o=s;a<o.length;a++)for(var l=o[a],d=0;d<e.tbItems.length;d++){var c=e.tbItems[d].subCommand,h=c&&c.toLocaleLowerCase();if(c&&h===l||"UL"===c&&"unorderedlist"===l||"OL"===c&&"orderedlist"===l||"pre"===h&&"insertcode"===l)if("boolean"===typeof r[l])!0===r[l]?Object(w["u"])([e.tbElements[d]],[lr]):Object(w["gb"])([e.tbElements[d]],[lr]);else if(("string"===typeof r[l]||null===r[l])&&Ba(l,e.parent.toolbarSettings.items)>-1){var p=r[l]?r[l]:"",u="";switch(l){case"formats":if(Object(w["T"])(n.formatDropDown)||t||!Object(w["T"])(n.formatDropDown)&&n.formatDropDown.isDestroyed)break;var m=e.parent.format.types,g=Object(w["T"])(e.parent.format.default)?m[0].text:e.parent.format.default;u=Ha(m,p,"subCommand","text"),n.formatDropDown.content='<span style="display: inline-flex;width:'+e.parent.format.width+'" ><span class="e-rte-dropdown-btn-text '+e.parent.cssClass+'">'+(Object(w["T"])(u)?g:u)+"</span></span>",n.formatDropDown.dataBind();break;case"alignments":if(Object(w["T"])(n.alignDropDown)||!Object(w["T"])(n.alignDropDown)&&n.alignDropDown.isDestroyed)break;var f=Ns;u=Ha(f,p,"subCommand","iconCss"),n.alignDropDown.iconCss=Object(w["T"])(u)?"e-icons e-justify-left":u,n.alignDropDown.dataBind();break;case"fontname":if(Object(w["T"])(n.fontNameDropDown)||t||!Object(w["T"])(n.fontNameDropDown)&&n.fontNameDropDown.isDestroyed)break;var b=e.parent.fontFamily.items;u=Ha(b,p,"value","text");var v=Object(w["T"])(e.parent.fontFamily.default)?b[0].text:e.parent.fontFamily.default,y=Object(w["T"])(u)?v:u;e.tbElements[d].title=y,n.fontNameDropDown.content='<span style="display: inline-flex;width:'+e.parent.fontFamily.width+'" ><span class="e-rte-dropdown-btn-text '+e.parent.cssClass+'">'+y+"</span></span>",n.fontNameDropDown.dataBind();break;case"fontsize":if(Object(w["T"])(n.fontSizeDropDown)||!Object(w["T"])(n.fontSizeDropDown)&&n.fontSizeDropDown.isDestroyed)break;var C=e.parent.fontSize.items,O=Object(w["T"])(e.parent.fontSize.default)?C[1].text:e.parent.fontSize.default;u=Ha(C,""===p?O.replace(/\s/g,""):p,"value","text"),n.fontSizeDropDown.content='<span style="display: inline-flex;width:'+e.parent.fontSize.width+'" ><span class="e-rte-dropdown-btn-text '+e.parent.cssClass+'">'+qa(u)+"</span></span>",n.fontSizeDropDown.dataBind();break}}}}function Ga(e){return"object"===typeof e?e:[e]}function Wa(e,t){for(var i=[],n=0;n<e.length;n++)for(var r=0;r<t.length;r++)if("Separator"!==t[r].type){if("OrderedList"===e[n]&&"OL"===t[r].subCommand){i.push(r);break}if("UnorderedList"===e[n]&&"UL"===t[r].subCommand){i.push(r);break}if("InsertCode"===e[n]&&"Pre"===t[r].subCommand){i.push(r);break}if("FileManager"===e[n]&&"File"===t[r].subCommand){i.push(r);break}if("object"===typeof e[n]&&"Custom"===e[n].command){i.push(n);break}if(e[n]===t[r].subCommand){i.push(r);break}}return i}function Ka(e,t){for(var i=0,n=Wa(Ga(Na),e.toolbarObj.items),r=Object(w["kb"])("."+Xn,e.toolbarObj.element),s=Object.keys(t),a=0,o=s;a<o.length;a++){var l=o[a],d=r[n[i]];d&&e.toolbarObj.enableItems(d,t[l]),i++}}function $a(e,t){var i=document.createEvent("HTMLEvents");i.initEvent(t,!1,!0),e.dispatchEvent(i)}function Xa(e){var t=Object(w["C"])("template");return t.innerHTML=e,t.content instanceof DocumentFragment?t.content:document.createRange().createContextualFragment(e)}function Ja(e,t){var i=[];for(t=t.firstChild;t;t=t.nextSibling)3===t.nodeType?i.push(t):i=i.concat(Ja(e,t));return i}function Qa(e){for(var t={},i=Object.keys(e),n=0;n<Object.keys(e).length;n++)t[i[n].toLocaleLowerCase()]=e[i[n]];return t}function Ya(e,t){var i;return null!==e&&""!==e?(i=t.enableHtmlEncode?Za(io(e),t):Za(e,t),t.setProperties({value:i},!0)):i="DIV"===t.enterKey?t.enableHtmlEncode?"&lt;div&gt;&lt;br/&gt;&lt;/div&gt;":"<div><br/></div>":"BR"===t.enterKey?t.enableHtmlEncode?"&lt;br/&gt;":"<br/>":t.enableHtmlEncode?"&lt;p&gt;&lt;br/&gt;&lt;/p&gt;":"<p><br/></p>",i}function Za(e,t){var i=document.createElement("div"),n=document.createElement("div"),r=i.childNodes;if(i.innerHTML=e,i.setAttribute("class","tempDiv"),r.length>0){var s=void 0,a=void 0,o=void 0;while(i.firstChild){for(var l=i.querySelectorAll(On),d=0;d<l.length;d++)l[d].innerHTML="<br>";var c=i.querySelectorAll(Tn);for(d=0;d<c.length;d++)c[d].innerHTML="&ZeroWidthSpace;";"BR"!==t.enterKey&&("#text"===i.firstChild.nodeName&&(i.firstChild.textContent.indexOf("\n")<0||""!==i.firstChild.textContent.trim())||Aa.indexOf(i.firstChild.nodeName.toLocaleLowerCase())>=0)?(s?a.appendChild(i.firstChild):(o="DIV"===t.enterKey?Object(w["C"])("div"):Object(w["C"])("p"),n.appendChild(o),o.appendChild(i.firstChild)),a=o,s=!0):"#text"===i.firstChild.nodeName&&("\n"===i.firstChild.textContent||i.firstChild.textContent.indexOf("\n")>=0&&""===i.firstChild.textContent.trim())?Object(w["F"])(i.firstChild):(n.appendChild(i.firstChild),s=!1)}var h=n.querySelectorAll("img");for(d=0;d<h.length;d++)h[d].classList.contains(Mr)||h[d].classList.add(Mr),h[d].classList.contains(nr)||h[d].classList.contains(ir)||h[d].classList.add(nr)}return n.innerHTML}function eo(e){var t;return t="DIV"===e.enterKey?e.enableHtmlEncode?"&lt;div&gt;&lt;br/&gt;&lt;/div&gt;":"<div><br/></div>":"BR"===e.enterKey?e.enableHtmlEncode?"&lt;br/&gt;":"<br/>":e.enableHtmlEncode?"&lt;p&gt;&lt;br/&gt;&lt;/p&gt;":"<p><br/></p>",t}function to(e){return"<p><br></p>"===e||"&lt;p&gt;&lt;br&gt;&lt;/p&gt;"===e||"<div><br></div>"===e||"&lt;div&gt;&lt;br&gt;&lt;/div&gt;"===e||"<br>"===e||"&lt;br&gt;"===e||""===e}function io(e){return e.replace(/&amp;/g,"&").replace(/&amp;lt;/g,"<").replace(/&lt;/g,"<").replace(/&amp;gt;/g,">").replace(/&gt;/g,">").replace(/&nbsp;/g," ").replace(/&amp;nbsp;/g," ").replace(/&quot;/g,"")}function no(e,t){if(t.enableHtmlSanitizer){var i=w["s"].beforeSanitize(),n={cancel:!1,helper:null};Object(w["G"])(i,i,n),t.trigger("beforeSanitizeHtml",i),i.cancel&&!Object(w["T"])(i.helper)?e=i.helper(e):i.cancel||(e=w["s"].serializeValue(i,e))}return e}function ro(e,t,i){for(var n=0;t.length>n;n++)if(t[n].value===i.value||t[n].value===i.subCommand)return e.localeObj.getConstant(t[n].locale);return i.text}function so(e){Xs.forEach(function(t,i){Xs[i].text=ro(e,Da,Xs[i])}),Qs.forEach(function(t,i){Qs[i].text=ro(e,Ea,Qs[i])}),ea.forEach(function(t,i){ea[i].text=ro(e,Ia,ea[i])}),ta.forEach(function(t,i){ta[i].text=ro(e,xa,ta[i])})}var ao=function(){function e(e){this.parent=e}return e.prototype.render=function(e){var t;return e.beforeOpen=this.beforeOpen.bind(this),e.open=this.open.bind(this),Object(w["T"])(e.close)&&(e.close=this.close.bind(this)),e.beforeClose=this.beforeClose.bind(this),t=new L["a"](e),t.isStringTemplate=!0,t},e.prototype.beforeOpen=function(e){this.parent.trigger(en,e,this.beforeOpenCallback.bind(this,e))},e.prototype.beforeOpenCallback=function(e){e.cancel&&this.parent.notify(tn,null)},e.prototype.open=function(e){this.parent.trigger(nn,e)},e.prototype.beforeClose=function(e){this.parent.trigger(rn,e,function(e){e.cancel||e.container.classList.contains("e-popup-close")&&(e.cancel=!0)})},e.prototype.close=function(e){this.parent.trigger(sn,e)},e}(),oo=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),lo=function(){return lo=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i],t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},lo.apply(this,arguments)},co=function(e,t,i,n){var r,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var o=e.length-1;o>=0;o--)(r=e[o])&&(a=(s<3?r(a):s>3?r(t,i,a):r(t,i))||a);return s>3&&a&&Object.defineProperty(t,i,a),a},ho=function(e){function t(t,i){return e.call(this,t,i)||this}return oo(t,e),t.prototype.requiredModules=function(){var e=[];return this.toolbarSettings.enable&&(e.push({member:"toolbar",args:[this,this.serviceLocator]}),e.push({member:"link",args:[this,this.serviceLocator]}),e.push({member:"table",args:[this,this.serviceLocator]}),e.push({member:"image",args:[this,this.serviceLocator]}),this.quickToolbarSettings.enable&&e.push({member:"quickToolbar",args:[this,this.serviceLocator]})),this.showCharCount&&e.push({member:"count",args:[this,this.serviceLocator]}),"Markdown"===this.editorMode&&e.push({member:"markdownEditor",args:[this,this.serviceLocator]}),"HTML"===this.editorMode&&(e.push({member:"htmlEditor",args:[this,this.serviceLocator]}),e.push({member:"pasteCleanup",args:[this,this.serviceLocator]})),this.fileManagerSettings.enable&&e.push({member:"fileManager",args:[this,this.serviceLocator]}),this.enableResize&&e.push({member:"resize",args:[this]}),e},t.prototype.updateEnable=function(){this.enabled?(Object(w["gb"])([this.element],jn),this.element.setAttribute("aria-disabled","false"),Object(w["T"])(this.htmlAttributes.tabindex)?this.inputElement.setAttribute("tabindex","0"):this.inputElement.setAttribute("tabindex",this.htmlAttributes.tabindex)):(this.getToolbar()&&(Object(w["gb"])(this.getToolbar().querySelectorAll("."+lr),lr),Object(w["gb"])([this.getToolbar()],[xn,Mn])),Object(w["u"])([this.element],jn),this.element.tabIndex=-1,this.element.setAttribute("aria-disabled","true"),this.inputElement.setAttribute("tabindex","-1"))},t.prototype.setEnable=function(){this.updateEnable(),this.enabled?this.eventInitializer():this.unWireEvents()},t.prototype.initializeValue=function(){this.isFocusOut=!1,this.isRTE=!1,this.isBlur=!0,this.needsID=!0,this.defaultResetValue=null,this.isResizeInitialized=!1},t.prototype.preRender=function(){this.initializeValue(),this.onBlurHandler=this.blurHandler.bind(this),this.onFocusHandler=this.focusHandler.bind(this),this.onResizeHandler=this.resizeHandler.bind(this),this.clickPoints={clientX:0,clientY:0},this.initialValue=this.value,this.serviceLocator=new ns,this.initializeServices(),this.setContainer(),this.persistData(),Object(w["mb"])(this.element,{width:Object(w["H"])(this.width)}),Object(w["w"])(this.element,{role:"application"})},t.prototype.persistData=function(){if(this.enablePersistence&&"TEXTAREA"===this.originalElement.tagName){this.element.id=this.originalElement.id+"_wrapper";var e=window.localStorage.getItem(this.getModuleName()+this.element.id);Object(w["T"])(e)||""===e||this.setProperties(JSON.parse(e),!0)}},t.prototype.setContainer=function(){this.originalElement=this.element.cloneNode(!0),null!==this.value&&null===this.valueTemplate||this.setValue(),this.element.hasAttribute("tabindex")&&(this.htmlAttributes={tabindex:this.element.getAttribute("tabindex")},this.element.removeAttribute("tabindex")),this.element.innerHTML="";for(var e=["class","style","id","ejs-for"],t={},i=0;i<this.element.attributes.length;i++)-1!==e.indexOf(this.element.attributes[i].name)||/^data-val/.test(this.element.attributes[i].name)||(t[this.element.attributes[i].name]=this.element.getAttribute(this.element.attributes[i].name));if(Object(w["G"])(t,this.htmlAttributes,t),this.setProperties({htmlAttributes:t},!0),Object(w["T"])(this.htmlAttributes.id)||(this.element.id=this.htmlAttributes.id),"TEXTAREA"===this.element.tagName){var n=this.createElement("div",{className:this.element.getAttribute("class")});this.element.innerHTML="",this.element.parentElement.insertBefore(n,this.element),this.valueContainer=this.element,Object(w["gb"])([this.valueContainer],this.element.getAttribute("class").split(" ")),this.element=n}else this.valueContainer=this.createElement("textarea",{id:this.getID()+"-value",attrs:{"aria-labelledby":this.getID()}});if(this.valueContainer.name=this.getID(),Object(w["u"])([this.valueContainer],Ir),!Object(w["T"])(this.cssClass))for(var r=this.cssClass.split(" "),s=0;s<r.length;s++)Object(w["u"])([this.valueContainer],r[s]);this.element.appendChild(this.valueContainer)},t.prototype.getPersistData=function(){return this.addOnPersist(["value"])},t.prototype.focusIn=function(){this.enabled&&(this.inputElement.focus(),this.focusHandler({}))},t.prototype.focusOut=function(){this.enabled&&(this.inputElement.blur(),this.blurHandler({}))},t.prototype.selectAll=function(){this.notify(qi,{})},t.prototype.selectRange=function(e){this.notify(zi,{range:e})},t.prototype.getSelection=function(){var e="";return this.notify(_i,{callBack:function(t){e=t}}),e},t.prototype.executeCommand=function(e,t,i){if(t=this.htmlPurifier(e,t),"HTML"===this.editorMode){var n=this.getRange();this.iframeSettings.enable&&this.formatter.editorManager.nodeSelection.Clear(this.element.ownerDocument);var r=!(!this.iframeSettings.enable||n.startContainer!==this.inputElement)||!this.inputElement.contains(n.startContainer);r&&this.focusIn()}var s=is[e];if(i&&i.undo&&i.undo&&0===this.formatter.getUndoRedoStack().length&&this.formatter.saveData(),-1!==this.maxLength&&!Object(w["T"])(s.command)){var a=0;if("Links"===s.command&&(a=0===t.text.length?t.url.length:t.text.length),"Images"!==s.command&&"Table"!==s.command&&"Files"!==s.command||(a=1),"InsertHTML"===s.command)if(Object(w["T"])(t))Object(w["T"])(s.value)||"<hr/>"!==s.value&&"<br/>"!==s.value||(a=1);else{var o=this.createElement("div");o.innerHTML=t,a=o.textContent.length}"InsertText"===s.command&&(a=t.length);var l=this.getText().trim().length,d=this.getSelection().length,c=l-d+a;if(!(-1===this.maxLength||c<=this.maxLength))return}this.formatter.editorManager.execCommand(s.command,s.subCommand?s.subCommand:t||s.value,null,null,t||s.value,t||s.value),i&&i.undo&&(this.formatter.saveData(),this.formatter.enableUndo(this)),this.setPlaceHolder(),this.notify(_t,{})},t.prototype.htmlPurifier=function(e,t){if("HTML"===this.editorMode)switch(e){case"insertHTML":this.enableHtmlSanitizer&&(t="string"===typeof t?this.htmlEditorModule.sanitizeHelper(t):this.htmlEditorModule.sanitizeHelper(t.outerHTML));break;case"insertTable":Object(w["T"])(t.width)&&(t.width={minWidth:this.tableSettings.minWidth,maxWidth:this.tableSettings.maxWidth,width:this.tableSettings.width});break;case"insertImage":var i=this.createElement("img",{attrs:{src:t.url}}),n=i.outerHTML;this.enableHtmlSanitizer&&(n=this.htmlEditorModule.sanitizeHelper(i.outerHTML));var r=""!==n&&this.createElement("div",{innerHTML:n}).firstElementChild.getAttribute("src")||null;r=Object(w["T"])(r)?"":r,t.url=r,Object(w["T"])(t.width)&&(t.width={minWidth:this.insertImageSettings.minWidth,maxWidth:this.insertImageSettings.maxWidth,width:this.insertImageSettings.width}),Object(w["T"])(t.height)&&(t.height={minHeight:this.insertImageSettings.minHeight,maxHeight:this.insertImageSettings.maxHeight,height:this.insertImageSettings.height});break;case"createLink":var s=this.createElement("a",{attrs:{href:t.url}}),a=s.outerHTML;this.enableHtmlSanitizer&&(a=this.htmlEditorModule.sanitizeHelper(s.outerHTML));var o=""!==a&&this.createElement("div",{innerHTML:a}).firstElementChild.getAttribute("href")||null;o=Object(w["T"])(o)?"":o,t.url=o;break}return t},t.prototype.encode=function(e){var t=this.createElement("div");return t.innerText=e.trim(),t.innerHTML.replace(/<br\s*[\/]?>/gi,"\n")},t.prototype.render=function(){this.value&&!this.valueTemplate&&this.setProperties({value:this.serializeValue(this.value)},!0),this.renderModule=new Br(this,this.serviceLocator),this.sourceCodeModule=new ts(this,this.serviceLocator),this.notify(zt,{}),this.trigger(qt),this.RTERender();new ss(this);this.notify(Ut,{}),this.enableXhtml&&this.setProperties({value:this.getXhtml()},!0),this.toolbarSettings.enable&&"Expand"===this.toolbarSettings.type&&!Object(w["T"])(this.getToolbar())&&this.toolbarSettings.items.indexOf("Undo")>-1&&this.toolbarSettings.items.indexOf("Redo")>-1&&this.disableToolbarItem(["Undo","Redo"]),this.setContentHeight(),null!==this.value&&(this.valueContainer.defaultValue=this.value),this.enabled?this.eventInitializer():this.unWireEvents(),this.notify(wn,{cssClass:this.cssClass}),this.renderComplete()},t.prototype.eventInitializer=function(){this.wireEvents()},t.prototype.cleanList=function(e){var t=this.getRange(),i=t.startContainer,n=t.endContainer,r=t.startOffset,s=i===n,a="#text"===t.endContainer.nodeName?t.endContainer.parentElement:t.endContainer,o=Object(w["A"])(a,"LI");if(!Object(w["T"])(o)&&a.textContent.length===t.endOffset&&!t.collapsed&&Object(w["T"])(a.nextElementSibling)){for(var l=0;l<o.childNodes.length;l++)"#text"===o.childNodes[l].nodeName&&0===o.childNodes[l].textContent.trim().length&&(Object(w["F"])(o.childNodes[l]),l--);var d=o;while(null!==d.lastChild&&"#text"!==d.nodeName)d=d.lastChild;this.formatter.editorManager.nodeSelection.setSelectionText(this.contentModule.getDocument(),s?"BR"!==d.nodeName||Object(w["T"])(d.previousSibling)?d:d.previousSibling:i,d,r,"BR"===d.nodeName?0:d.textContent.length)}},t.prototype.keyDown=function(e){if(this.notify(ri,{member:"keydown",args:e}),this.restrict(e),"HTML"===this.editorMode&&this.cleanList(e),"HTML"===this.editorMode&&(8===e.which&&"Backspace"===e.code||46===e.which&&"Delete"===e.code)){var t=this.getRange(),i="#text"===t.startContainer.nodeName?t.startContainer.parentElement:t.startContainer;if(Object(w["A"])(i,"pre")&&8===e.which&&8203===t.startContainer.textContent.charCodeAt(t.startOffset-1)||46===e.which&&8203===t.startContainer.textContent.charCodeAt(t.startOffset)){var n=new RegExp(String.fromCharCode(8203),"g"),r=8===e.which?t.startOffset-1:t.startOffset;t.startContainer.textContent=t.startContainer.textContent.replace(n,""),this.formatter.editorManager.nodeSelection.setCursorPoint(this.contentModule.getDocument(),t.startContainer,r)}else if("Backspace"===e.code&&8===e.which&&8203===t.startContainer.textContent.charCodeAt(0)&&t.collapsed){var s=t.startContainer.parentElement,a=void 0,o=void 0;for(o=0;o<s.childNodes.length;o++)s.childNodes[o]===t.startContainer&&(a=o);var l=!0,d=[];for(o=a;o>=0;o--)3===s.childNodes[o].nodeType&&8203===s.childNodes[o].textContent.charCodeAt(0)&&l?d.push(o):l=!1;if(d.length>0)for(o=d.length-1;o>0;o--)s.childNodes[d[o]].textContent="";this.formatter.editorManager.nodeSelection.setCursorPoint(this.contentModule.getDocument(),t.startContainer,t.startOffset)}}if(0===this.formatter.getUndoRedoStack().length&&this.formatter.saveData(),"insert-link"!==e.action&&(e.action&&"paste"!==e.action&&"space"!==e.action||9===e.which||"Backspace"===e.code&&8===e.which))switch(this.formatter.process(this,null,e),e.action){case"toolbar-focus":if(this.toolbarSettings.enable){var c='.e-toolbar-item[aria-disabled="false"][title] [tabindex]';this.toolbarModule.baseToolbar.toolbarObj.element.querySelector(c).focus()}break;case"escape":this.contentModule.getEditPanel().focus();break}Object(w["T"])(this.placeholder)||(Object(w["T"])(this.placeHolderWrapper)||1===this.inputElement.textContent.length?this.setPlaceHolder():this.placeHolderWrapper.style.display="none"),this.autoResize()},t.prototype.keyUp=function(e){if("HTML"===this.editorMode){var t=this.getRange();if(-1!=w["d"].userAgent.indexOf("Firefox")&&"#text"===t.startContainer.nodeName&&t.startContainer.parentElement===this.inputElement&&"BR"!==this.enterKey){var i=this.getRange(),n=this.createElement(this.enterKey);i.startContainer.parentElement.insertBefore(n,i.startContainer),n.appendChild(i.startContainer),this.formatter.editorManager.nodeSelection.setSelectionText(this.contentModule.getDocument(),n.childNodes[0],n.childNodes[0],n.childNodes[0].textContent.length,n.childNodes[0].textContent.length)}}this.notify(ni,{member:"keyup",args:e}),"KeyX"!==e.code||88!==e.which||88!==e.keyCode||!e.ctrlKey||""!==this.inputElement.innerHTML&&"<br>"!==this.inputElement.innerHTML||(this.inputElement.innerHTML=Ya(eo(this),this));var r=32===e.which||13===e.which||8===e.which||46===e.which;("shift"!==e.key&&!e.ctrlKey&&e.key&&1===e.key.length||r||"Markdown"===this.editorMode&&("shift"!==e.key&&!e.ctrlKey&&e.key&&1===e.key.length||r)&&!this.inlineMode.enable)&&this.formatter.onKeyHandler(this,e),(this.inputElement&&0!==this.inputElement.textContent.length||this.element.querySelectorAll(".e-toolbar-item.e-active").length>0)&&this.notify($t,{args:e}),Object(w["T"])(this.placeholder)||"Enter"===e.key&&13===e.keyCode||"<p><br></p>"!==this.inputElement.innerHTML&&"<div><br></div>"!==this.inputElement.innerHTML&&"<br>"!==this.inputElement.innerHTML||this.setPlaceHolder()},t.prototype.serializeValue=function(e){return"HTML"!==this.editorMode||Object(w["T"])(e)||(this.enableHtmlEncode?(e=this.htmlEditorModule.sanitizeHelper(io(e)),e=this.encode(e)):e=this.htmlEditorModule.sanitizeHelper(e)),e},t.prototype.sanitizeHtml=function(e){return this.serializeValue(e)},t.prototype.updateValue=function(e){if(Object(w["T"])(e)){var t=this.inputElement.innerHTML;this.setProperties({value:to(t)?null:t})}else this.setProperties({value:e})},t.prototype.triggerEditArea=function(e){if(Va()){var t=e.touches?e.changedTouches[0]:e;this.clickPoints.clientX===t.clientX&&this.clickPoints.clientY===t.clientY&&this.notify(Ni,{member:"editAreaClick",args:e})}else this.notify(Ni,{member:"editAreaClick",args:e})},t.prototype.notifyMouseUp=function(e){var t=e.touches?e.changedTouches[0]:e;this.notify(si,{member:"mouseUp",args:e,touchData:{prevClientX:this.clickPoints.clientX,prevClientY:this.clickPoints.clientY,clientX:t.clientX,clientY:t.clientY}}),this.inputElement&&("HTML"===this.editorMode&&0!==this.inputElement.textContent.length||"Markdown"===this.editorMode&&0!==this.inputElement.value.length)&&this.notify($t,{args:e}),this.triggerEditArea(e)},t.prototype.mouseUp=function(e){if(this.quickToolbarSettings.showOnRightClick&&w["d"].isDevice){var t=e.target,i=Object(w["A"])(t,"table");if(t&&"A"===t.nodeName||"IMG"===t.nodeName||"TD"===t.nodeName||"TH"===t.nodeName||"TABLE"===t.nodeName||i&&this.contentModule.getEditPanel().contains(i))return}if(this.notifyMouseUp(e),3===e.detail){var n=this.getRange(),r=this.formatter.editorManager.domNode.getSelection();/\s+$/.test(r.toString())&&((Object(w["T"])(n.startContainer.parentElement)||(Object(w["T"])(n.startContainer.parentElement.nextSibling)||3===n.startContainer.parentElement.nextSibling.nodeType&&!/\s+$/.test(n.startContainer.parentElement.nextSibling.textContent))&&n.startOffset!==n.endOffset)&&"li"!==n.startContainer.parentElement.tagName.toLocaleLowerCase()||(n.setStart(n.startContainer,n.startOffset),n.setEnd(n.startContainer,n.startContainer.textContent.length)))}},t.prototype.ensureModuleInjected=function(e){return this.getInjectedModules().indexOf(e)>=0},t.prototype.onCopy=function(){this.contentModule.getDocument().execCommand("copy",!1,null)},t.prototype.onCut=function(){this.contentModule.getDocument().execCommand("cut",!1,null)},t.prototype.onPaste=function(e){var t=this,i={originalEvent:e,cancel:!1,requestType:"Paste"};this.trigger(Ci,i,function(i){var n=t.inputElement.textContent.length,r=t.getSelection().length,s=Object(w["T"])(e)||Object(w["T"])(e.clipboardData)?0:e.clipboardData.getData("text/plain").length,a=n-r+s;if("Markdown"===t.editorMode){var o={requestType:"Paste",editorMode:t.editorMode,event:e};return setTimeout(function(){t.formatter.onSuccess(t,o)},0),void(-1===t.maxLength||a<=t.maxLength||e.preventDefault())}if(!i.cancel&&"true"===t.inputElement.contentEditable&&(-1===t.maxLength||a<=t.maxLength))if(Object(w["T"])(t.pasteCleanupModule)){var l={requestType:"Paste",editorMode:t.editorMode,event:e},d=null,c=!1;e&&!Object(w["T"])(e.clipboardData)&&(d=e.clipboardData.getData("text/plain"),c=e.clipboardData.getData("text/html").indexOf("MsoNormal")>0);var h=e&&e.clipboardData&&e.clipboardData.items.length>0?e.clipboardData.items[0].getAsFile():null;null!==d&&t.notify(Gi,{file:h,args:e,text:d,isWordPaste:c}),setTimeout(function(){t.formatter.onSuccess(t,l)},0)}else t.notify(Yi,{args:e});else e.preventDefault()})},t.prototype.clipboardAction=function(e,t){switch(e.toLowerCase()){case"cut":this.onCut(),this.formatter.onSuccess(this,{requestType:"Cut",editorMode:this.editorMode,event:t});break;case"copy":this.onCopy(),this.formatter.onSuccess(this,{requestType:"Copy",editorMode:this.editorMode,event:t});break;case"paste":this.onPaste(t);break}},t.prototype.destroy=function(){if(!this.isDestroyed&&this.isRendered)if(null!==this.element.offsetParent||Object(w["T"])(this.toolbarModule)){if(this.notify(Wt,{}),this.destroyDependentModules(),Object(w["T"])(this.timeInterval)||(clearInterval(this.timeInterval),this.timeInterval=null),this.unWireEvents(),"TEXTAREA"===this.originalElement.tagName){this.element.parentElement.insertBefore(this.valueContainer,this.element),this.valueContainer.id=this.getID(),this.valueContainer.removeAttribute("name"),Object(w["F"])(this.element),""!==this.originalElement.innerHTML.trim()?(this.valueContainer.value=this.originalElement.innerHTML.trim(),this.setProperties({value:Object(w["T"])(this.initialValue)?null:this.initialValue},!0)):this.valueContainer.value=this.valueContainer.defaultValue,this.element=this.valueContainer;for(var t=0;t<this.originalElement.classList.length;t++)Object(w["u"])([this.element],this.originalElement.classList[t]);if(!Object(w["T"])(this.cssClass)){var i=this.cssClass.split(" ");for(t=0;t<i.length;t++)Object(w["u"])([this.element],i[t])}Object(w["gb"])([this.element],Ir)}else""!==this.originalElement.innerHTML.trim()?(this.element.innerHTML=this.originalElement.innerHTML.trim(),this.setProperties({value:Object(w["T"])(this.initialValue)?null:this.initialValue},!0)):this.element.innerHTML="";if(this.placeholder&&this.placeHolderWrapper&&(this.placeHolderWrapper=null),!Object(w["T"])(this.cssClass)){var n=this.cssClass.split(" ");for(t=0;t<n.length;t++)""!==n[t].trim()&&Object(w["gb"])([this.element],n[t])}this.removeHtmlAttributes(),this.removeAttributes(),e.prototype.destroy.call(this),this.isRendered=!1,this.enablePersistence&&window.localStorage.removeItem(this.getModuleName()+this.element.id)}else this.toolbarModule.destroy()},t.prototype.removeHtmlAttributes=function(){if(this.htmlAttributes)for(var e=Object.keys(this.htmlAttributes),t=0;t<e.length&&this.element.hasAttribute(e[t]);t++)this.element.removeAttribute(e[t])},t.prototype.removeAttributes=function(){this.enabled||Object(w["gb"])([this.element],jn),this.enableRtl&&Object(w["gb"])([this.element],Sn),this.readonly&&Object(w["gb"])([this.element],Er),""!==this.element.style.width&&""===this.originalElement.style.width&&this.element.style.removeProperty("width"),""!==this.element.style.height&&""===this.originalElement.style.height&&this.element.style.removeProperty("height"),this.element.removeAttribute("aria-disabled"),this.element.removeAttribute("role"),this.element.removeAttribute("tabindex")},t.prototype.destroyDependentModules=function(){this.renderModule.destroy(),this.formatter.editorManager.undoRedoManager.destroy(),this.sourceCodeModule.destroy()},t.prototype.getContent=function(){return this.contentModule.getPanel()},t.prototype.getText=function(){return this.contentModule.getText()},t.prototype.getSelectedHtml=function(){var e,t=this.createElement("div"),i=this.contentModule.getDocument().getSelection();if(i.rangeCount>0){e=i.getRangeAt(0);var n=e.cloneContents();t.appendChild(n)}return t.innerHTML},t.prototype.showInlineToolbar=function(){if(this.inlineMode.enable){var e=this.getRange(),t="#text"===e.endContainer.nodeName?e.endContainer.parentElement:e.endContainer,i=e.getClientRects()[0].left,n=e.getClientRects()[0].top;this.quickToolbarModule.showInlineQTBar(i,n,t)}},t.prototype.hideInlineToolbar=function(){this.quickToolbarModule.hideInlineQTBar()},t.prototype.getModuleName=function(){return"richtexteditor"},t.prototype.onPropertyChanged=function(t,i){for(var n=0,r=Object.keys(t);n<r.length;n++){var s=r[n];switch(s){case"enterKey":case"value":var a=void 0;a="enterKey"===s?null===this.value||"<div><br></div>"===this.value||"<p><br></p>"===this.value||"<br>"===this.value?null:this.value:t[s];var o="HTML"===this.editorMode?Ya(a,this):a;(!Object(w["T"])(a)&&""!==a||"enterKey"===s)&&(this.value=this.serializeValue(this.enableHtmlEncode?this.encode(io(o)):o)),this.updatePanelValue(),this.setPlaceHolder(),this.notify(cn,{module:"XhtmlValidation",newProp:t,oldProp:i}),this.enableXhtml&&this.setProperties({value:this.getXhtml()},!0),this.showCharCount&&this.countModule.refresh();break;case"valueTemplate":this.setValue(),this.showCharCount&&this.countModule.refresh();break;case"width":this.setWidth(t[s]),this.toolbarSettings.enable&&!this.inlineMode.enable&&(this.toolbarModule.refreshToolbarOverflow(),this.resizeHandler());break;case"height":this.setHeight(t[s]),this.setContentHeight(),this.autoResize();break;case"readonly":this.setReadOnly(!1);break;case"cssClass":this.element.classList.remove(i[s]),this.setCssClass(t[s]),this.notify(wn,{cssClass:t[s],oldCssClass:i[s]});break;case"enabled":this.setEnable();break;case"enableRtl":this.updateRTL();break;case"placeholder":this.placeholder=t[s],this.setPlaceHolder();break;case"htmlAttributes":Ma(this.htmlAttributes,this,!1,!1);break;case"iframeSettings":var l=i[s];if(l.resources){var d=this.contentModule.getDocument(),c=d.querySelector("head"),h=void 0;l.resources.scripts&&(h=c.querySelectorAll("."+Rn),this.removeSheets(h)),l.resources.styles&&(h=c.querySelectorAll("."+Dn),this.removeSheets(h))}this.setIframeSettings();break;case"locale":e.prototype.refresh.call(this);break;case"inlineMode":this.notify(ii,{module:"quickToolbar",newProp:t,oldProp:i}),this.setContentHeight();break;case"toolbarSettings":this.notify(ii,{module:"toolbar",newProp:t,oldProp:i}),this.setContentHeight();break;case"maxLength":this.showCharCount&&this.countModule.refresh();break;case"showCharCount":t[s]&&this.countModule?this.countModule.renderCount():!1===t[s]&&this.countModule&&this.countModule.destroy();break;case"enableHtmlEncode":this.updateValueData(),this.updatePanelValue(),this.setPlaceHolder(),this.showCharCount&&this.countModule.refresh();break;case"undoRedoSteps":case"undoRedoTimer":this.formatter.editorManager.observer.notify(Wr,{newProp:t,oldProp:i});break;case"enableXhtml":this.notify(cn,{module:"XhtmlValidation",newProp:t,oldProp:i});break;case"quickToolbarSettings":t.quickToolbarSettings.showOnRightClick?this.wireContextEvent():this.unWireContextEvent(),this.notify(ii,{newProp:t,oldProp:i});break;default:this.notify(ii,{newProp:t,oldProp:i});break}}},t.prototype.updateValueData=function(){this.enableHtmlEncode?this.setProperties({value:this.encode(io(this.inputElement.innerHTML))},!0):this.setProperties({value:/<[a-z][\s\S]*>/i.test(this.inputElement.innerHTML)?this.inputElement.innerHTML:io(this.inputElement.innerHTML)})},t.prototype.removeSheets=function(e){var t;for(t=0;t<e.length;t++)Object(w["F"])(e[t])},t.prototype.updatePanelValue=function(){var e=this.value;e=this.enableHtmlEncode&&this.value?io(e):e;var t=this.element.querySelector(".e-rte-srctextarea");e?(t&&"block"===t.style.display&&(t.value=this.value),this.valueContainer&&(this.valueContainer.value=this.enableHtmlEncode?this.value:e),"HTML"===this.editorMode&&this.inputElement&&this.inputElement.innerHTML.trim()!==e.trim()?this.inputElement.innerHTML=e:"Markdown"===this.editorMode&&this.inputElement&&this.inputElement.value.trim()!==e.trim()&&(this.inputElement.value=e)):(t&&"block"===t.style.display&&(t.value=""),"HTML"===this.editorMode?"DIV"===this.enterKey?this.inputElement.innerHTML="<div><br/></div>":"BR"===this.enterKey?this.inputElement.innerHTML="<br/>":(this.inputElement.innerHTML="<p><br/></p>",""===e&&this.formatter&&this.inputElement&&this.formatter.editorManager.nodeSelection.setCursorPoint(this.contentModule.getDocument(),this.inputElement.firstElementChild,this.inputElement.firstElementChild.childElementCount)):this.inputElement.value="",this.valueContainer&&(this.valueContainer.value="")),this.showCharCount&&this.countModule.refresh()},t.prototype.setHeight=function(e){this.element.style.height="auto"!==e?Object(w["H"])(e):"auto","Expand"===this.toolbarSettings.type&&("string"===typeof this.height&&this.height.indexOf("px")>-1||"number"===typeof this.height)?this.element.classList.add(Nr):this.element.classList.remove(Nr)},t.prototype.setPlaceHolder=function(){this.inputElement&&this.placeholder&&!0!==this.iframeSettings.enable&&("Markdown"!==this.editorMode?(this.placeHolderWrapper||(this.placeHolderWrapper=this.createElement("span",{className:"rte-placeholder e-rte-placeholder "+this.cssClass}),this.inputElement&&this.inputElement.parentElement.insertBefore(this.placeHolderWrapper,this.inputElement),Object(w["w"])(this.placeHolderWrapper,{style:"font-size: 14px; margin-left: 0px; margin-right: 0px;"})),this.placeHolderWrapper.innerHTML=this.placeholder,0!==this.inputElement.textContent.length||Object(w["T"])(this.inputElement.firstChild)||"BR"!==this.inputElement.firstChild.nodeName&&("P"!==this.inputElement.firstChild.nodeName&&"DIV"!==this.inputElement.firstChild.nodeName||Object(w["T"])(this.inputElement.firstChild.firstChild)||"BR"!==this.inputElement.firstChild.firstChild.nodeName)?this.placeHolderWrapper.style.display="none":this.placeHolderWrapper.style.display="block"):this.inputElement.setAttribute("placeholder",this.placeholder))},t.prototype.setWidth=function(e){"auto"!==e?Object(w["mb"])(this.element,{width:Object(w["H"])(this.width)}):this.element.style.width="auto"},t.prototype.setCssClass=function(e){if(!Object(w["T"])(e))for(var t=e.split(" "),i=0;i<t.length;i++)""!==t[i].trim()&&this.element.classList.add(t[i])},t.prototype.updateRTL=function(){this.notify(Wi,{enableRtl:this.enableRtl}),this.enableRtl?this.element.classList.add(Sn):this.element.classList.remove(Sn)},t.prototype.updateReadOnly=function(){this.notify(Qi,{editPanel:this.inputElement,mode:this.readonly})},t.prototype.setReadOnly=function(e){this.updateReadOnly(),e||(this.readonly&&this.enabled?this.unbindEvents():this.enabled&&this.bindEvents())},t.prototype.print=function(){var e,t=this,i={element:this.inputElement,requestType:"print",cancel:!1};this.trigger(Ci,i,function(i){if(e=window.open("","print","height="+window.outerHeight+",width="+window.outerWidth),"msie"===w["d"].info.name&&e.resizeTo(screen.availWidth,screen.availHeight),e=Object(w["db"])(t.inputElement,e),!i.cancel){var n={requestType:"print"};t.trigger(wi,n)}})},t.prototype.refreshUI=function(){this.renderModule.refresh()},t.prototype.showFullScreen=function(){this.fullScreenModule.showFullScreen()},t.prototype.enableToolbarItem=function(e,t){this.toolbarModule.enableTBarItems(this.getBaseToolbarObject(),e,!0,t)},t.prototype.disableToolbarItem=function(e,t){this.toolbarModule.enableTBarItems(this.getBaseToolbarObject(),e,!1,t)},t.prototype.removeToolbarItem=function(e){this.toolbarModule.removeTBarItems(e)},t.prototype.getRange=function(){return this.formatter.editorManager.nodeSelection.getRange(this.contentModule.getDocument())},t.prototype.initializeServices=function(){this.serviceLocator.register("rendererFactory",new rs),this.serviceLocator.register("rteLocale",this.localeObj=new w["o"](this.getModuleName(),ja,this.locale)),this.serviceLocator.register("dialogRenderObject",new ao(this))},t.prototype.RTERender=function(){var e=this.serviceLocator.getService("rendererFactory");this.contentModule=e.getRenderer(ve.Content),this.fullScreenModule=new Pa(this),this.enterKeyModule=new La(this),this.renderModule.render(),this.inputElement=this.contentModule.getEditPanel(),this.setHeight(this.height),Ma(this.htmlAttributes,this,!1,!0),this.iframeSettings&&this.setIframeSettings(),this.setCssClass(this.cssClass),this.updateEnable(),this.setPlaceHolder(),this.updateRTL(),this.updateReadOnly(),this.updatePanelValue(),this.enableHtmlEncode&&!Object(w["T"])(this.value)&&this.setProperties({value:this.encode(io(this.value))})},t.prototype.setIframeSettings=function(){if(this.iframeSettings.resources){var e=this.iframeSettings.resources.styles,t=this.iframeSettings.resources.scripts;this.iframeSettings.resources.scripts.length>0&&this.InjectSheet(!0,t),this.iframeSettings.resources.styles.length>0&&this.InjectSheet(!1,e)}this.iframeSettings.attributes&&Ma(this.iframeSettings.attributes,this,!0,!1)},t.prototype.InjectSheet=function(e,t){try{if(t&&t.length>0)for(var i=this.contentModule.getDocument(),n=i.querySelector("head"),r=0;r<t.length;r++)if(e){var s=this.createScriptElement();s.src=t[r],n.appendChild(s)}else{var a=this.createStyleElement();a.href=t[r],n.appendChild(a)}}catch(e){return}},t.prototype.createScriptElement=function(){var e=this.createElement("script",{className:Rn});return e.type="text/javascript",e},t.prototype.createStyleElement=function(){var e=this.createElement("link",{className:Dn});return e.rel="stylesheet",e},t.prototype.setValue=function(){if(this.valueTemplate){var e=new RegExp(/<(?=.*? .*?\/ ?>|br|hr|input|!--|wbr)[a-z]+.*?>|<([a-z]+).*?<\/\1>/i);if(e.test(this.valueTemplate))this.setProperties({value:this.valueTemplate});else{for(var t=Object(w["B"])(this.valueTemplate)("",this,"valueTemplate"),i=0;i<t.length;i++){var n=t[i];Object(w["v"])([n],this.element)}this.setProperties({value:this.element.innerHTML.trim()})}}else{var r=!Object(w["T"])(this.element.innerHTML)&&this.element.innerHTML.replace(/<(\/?|\!?)(!--!--)>/g,"").trim();""!==r&&("TEXTAREA"===this.element.tagName?this.setProperties({value:io(r)}):this.setProperties({value:r}))}},t.prototype.updateResizeFlag=function(){this.isResizeInitialized=!0},t.prototype.getInsertImgMaxWidth=function(){var e=this.insertImageSettings.maxWidth,t=12,i=2,n=this.contentModule.getEditPanel(),r=window.getComputedStyle(n),s=n.offsetWidth-(t+i+parseFloat(r.paddingLeft.split("px")[0])+parseFloat(r.paddingRight.split("px")[0])+parseFloat(r.marginLeft.split("px")[0])+parseFloat(r.marginRight.split("px")[0]));return Object(w["T"])(e)?s:e},t.prototype.setContentHeight=function(e,t){var i,n,r=0,s="string"===typeof this.height&&this.height.indexOf("%")>-1,a=this.sourceCodeModule.getPanel()&&"block"===this.sourceCodeModule.getPanel().parentElement.style.display?this.sourceCodeModule.getPanel().parentElement:this.contentModule.getPanel(),o=this.element.offsetHeight;0!==o||"auto"===this.height||this.getToolbar()||(o=parseInt(this.height,10),s&&(n=this.height));var l=this.getToolbar()?this.toolbarModule.getToolbarHeight():0,d=this.element.querySelector("."+xr),c=this.enableResize?Object(w["T"])(d)?0:d.offsetHeight+8:0,h=this.getToolbar()?this.toolbarModule.getExpandTBarPopHeight():0;if(this.toolbarSettings.type===ye.Expand&&t&&"preview"!==e?(i="auto"===this.height&&0===c?"auto":o-(l+h+c)+"px",r=this.toolbarSettings.enableFloating?0:h):i="auto"!==this.height||this.element.classList.contains("e-rte-full-screen")||this.isResizeInitialized?s&&n?n:o-(l+c)+"px":"auto","windowResize"!==e&&(this.iframeSettings.enable?"auto"!==i&&Object(w["mb"])(a,{height:i,marginTop:r+"px"}):Object(w["mb"])(a,{height:i,marginTop:r+"px"})),this.iframeSettings.enable&&"sourceCode"===e){var p=Object(w["jb"])("."+$n,this.element);Object(w["mb"])(p,{height:i,marginTop:r+"px"})}if(this.toolbarSettings.enableFloating&&this.getToolbar()&&!this.inlineMode.enable){var u=(t?l+h:l)+"px";Object(w["mb"])(this.getToolbar().parentElement,{height:u})}0===c&&this.autoResize()},t.prototype.getHtml=function(){return this.serializeValue(this.contentModule.getEditPanel().innerHTML)},t.prototype.getXhtml=function(){var e=this.value;return!Object(w["T"])(e)&&this.enableXhtml&&(e=this.htmlEditorModule.xhtmlValidation.selfEncloseValidation(e)),e},t.prototype.showSourceCode=function(){this.readonly||this.notify(ji,{})},t.prototype.getCharCount=function(){var e,t="Markdown"===this.editorMode?this.inputElement.value.trim():this.inputElement.textContent.trim();return e="Markdown"!==this.editorMode&&-1!==t.indexOf("​")?t.replace(/\u200B/g,"").length:t.length,e},t.prototype.showDialog=function(e){e===Ce.InsertLink?this.notify(gn,{}):e===Ce.InsertImage?this.notify(bn,{}):e===Ce.InsertTable&&this.notify(yn,{})},t.prototype.closeDialog=function(e){e===Ce.InsertLink?this.notify(fn,{}):e===Ce.InsertImage?this.notify(vn,{}):e===Ce.InsertTable&&this.notify(Cn,{})},t.prototype.getBaseToolbarObject=function(){var e;return e=!this.inlineMode.enable||w["d"].isDevice&&!Va()?this.toolbarModule&&this.toolbarModule.getBaseToolbar():this.quickToolbarModule&&this.quickToolbarModule.getInlineBaseToolbar(),e},t.prototype.getToolbar=function(){return this.toolbarModule?this.toolbarModule.getToolbarElement():null},t.prototype.getToolbarElement=function(){return this.toolbarModule&&this.toolbarModule.getToolbarElement()},t.prototype.getID=function(){return"TEXTAREA"===this.originalElement.tagName?this.valueContainer.id:this.element.id},t.prototype.mouseDownHandler=function(e){var t=e.touches?e.changedTouches[0]:e;Object(w["u"])([this.element],[er]),this.preventDefaultResize(e),this.notify(Pi,{args:e}),this.clickPoints={clientX:t.clientX,clientY:t.clientY}},t.prototype.preventImgResize=function(e){"img"===e.target.nodeName.toLocaleLowerCase()&&e.preventDefault()},t.prototype.preventDefaultResize=function(e){"msie"===w["d"].info.name?this.contentModule.getEditPanel().addEventListener("mscontrolselect",this.preventImgResize):"mozilla"===w["d"].info.name&&(this.contentModule.getDocument().execCommand("enableObjectResizing",!1,"false"),this.contentModule.getDocument().execCommand("enableInlineTableEditing",!1,"false"))},t.prototype.defaultResize=function(e){"msie"===w["d"].info.name?this.contentModule.getEditPanel().removeEventListener("mscontrolselect",this.preventImgResize):"mozilla"===w["d"].info.name&&(this.contentModule.getDocument().execCommand("enableObjectResizing",!0,"true"),this.contentModule.getDocument().execCommand("enableInlineTableEditing",!0,"true"))},t.prototype.resizeHandler=function(){var e=!1;document.body.contains(this.element)?(this.toolbarSettings.enable&&!this.inlineMode.enable&&(this.toolbarModule.refreshToolbarOverflow(),e=this.toolbarModule.baseToolbar.toolbarObj.element.classList.contains(dr)),this.setContentHeight("windowResize",e),this.notify(gi,null)):document.defaultView.removeEventListener("resize",this.onResizeHandler,!0)},t.prototype.scrollHandler=function(e){this.notify(Ai,{args:e})},t.prototype.contentScrollHandler=function(e){this.notify(Bi,{args:e})},t.prototype.focusHandler=function(e){if(!this.isRTE||this.isFocusOut){this.isRTE=!this.isFocusOut,this.isFocusOut=!1,Object(w["u"])([this.element],[er]),"HTML"===this.editorMode?this.cloneValue="<p><br></p>"===this.inputElement.innerHTML||"<div><br></div>"===this.inputElement.innerHTML||"<br>"===this.inputElement.innerHTML?null:this.enableHtmlEncode?this.encode(io(this.inputElement.innerHTML)):this.inputElement.innerHTML:this.cloneValue=""===this.inputElement.value?null:this.inputElement.value;var t=document.activeElement;if((t===this.element||t===this.getToolbarElement()||t===this.contentModule.getEditPanel()||this.iframeSettings.enable&&t===this.contentModule.getPanel()&&e.target&&!e.target.classList.contains("e-img-inner")&&e.target&&e.target.parentElement&&!e.target.parentElement.classList.contains("e-img-wrap")||Object(w["A"])(t,".e-rte-toolbar")===this.getToolbarElement())&&(this.contentModule.getEditPanel().focus(),!Object(w["T"])(this.getToolbarElement()))){this.getToolbarElement().setAttribute("tabindex","-1");for(var i=this.getToolbarElement().querySelectorAll('[tabindex="0"]'),n=0;n<i.length;n++)i[n].setAttribute("tabindex","-1")}this.preventDefaultResize(e),this.trigger("focus",{event:e,isInteracted:0!==Object.keys(e).length}),!Object(w["T"])(this.saveInterval)&&this.saveInterval>0&&!this.autoSaveOnIdle&&(this.timeInterval=setInterval(this.updateValueOnIdle.bind(this),this.saveInterval)),w["l"].add(document,"mousedown",this.onDocumentClick,this)}if(!Object(w["T"])(this.getToolbarElement())){var r=this.getToolbarElement().querySelectorAll("input,select,button,a,[tabindex]");for(n=0;n<r.length;n++)r[n].classList.contains("e-rte-dropdown-btn")||r[n].classList.contains("e-insert-table-btn")||r[n].hasAttribute("tabindex")&&"-1"===r[n].getAttribute("tabindex")||r[n].setAttribute("tabindex","-1")}},t.prototype.getUpdatedValue=function(){var e;Object(w["T"])(this.tableModule)||this.tableModule.removeResizeElement();var t=this.element.querySelector(".e-rte-srctextarea");return"HTML"===this.editorMode?(e="<p><br></p>"===this.inputElement.innerHTML||"<div><br></div>"===this.inputElement.innerHTML||"<br>"===this.inputElement.innerHTML?null:this.enableHtmlEncode?this.encode(io(this.inputElement.innerHTML)):this.inputElement.innerHTML,t&&"block"===t.style.display&&(e=t.value)):e=""===this.inputElement.value?null:this.inputElement.value,e},t.prototype.updateValueOnIdle=function(){(Object(w["T"])(this.tableModule)||Object(w["T"])(this.inputElement.querySelector(".e-table-box.e-rbox-select")))&&(this.setProperties({value:this.getUpdatedValue()},!0),this.valueContainer.value=this.value,this.invokeChangeEvent())},t.prototype.updateIntervalValue=function(){clearTimeout(this.idleInterval),this.idleInterval=setTimeout(this.updateValueOnIdle.bind(this),0)},t.prototype.updateStatus=function(e){if(!Object(w["T"])(e.html)||!Object(w["T"])(e.markdown)){var t=this.formatter.editorManager.undoRedoManager.getUndoStatus(),i={undo:t.undo,redo:t.redo,html:e.html,markdown:e.markdown};this.trigger(Oi,i)}},t.prototype.onDocumentClick=function(e){var t=e.target,i=Object(w["A"])(t,"."+kn);this.element.contains(e.target)||document===e.target||i===this.element||Object(w["A"])(t,'[aria-owns="'+this.getID()+'"]')||(this.isBlur=!0,this.isRTE=!1),this.notify($i,{args:e}),"msie"!==w["d"].info.name&&e.detail>3&&e.preventDefault()},t.prototype.blurHandler=function(e){var t=e.relatedTarget;if(t){var i=Object(w["A"])(t,"."+kn);i&&i===this.element?(this.isBlur=!1,t===this.getToolbarElement()&&t.setAttribute("tabindex","-1")):Object(w["A"])(t,'[aria-owns="'+this.getID()+'"]')?this.isBlur=!1:(this.isBlur=!0,t=null)}if(this.isBlur&&Object(w["T"])(t)){Object(w["gb"])([this.element],[er]),this.notify(Vi,{});var n=this.getUpdatedValue();this.setProperties({value:n}),this.notify($t,{args:e,documentNode:document}),this.invokeChangeEvent(),this.isFocusOut=!0,this.isBlur=!1,$a(this.valueContainer,"focusout"),this.defaultResize(e),this.trigger("blur",{event:e,isInteracted:0!==Object.keys(e).length}),Object(w["T"])(this.timeInterval)||(clearInterval(this.timeInterval),this.timeInterval=null),w["l"].remove(document,"mousedown",this.onDocumentClick)}else this.isRTE=!0},t.prototype.contentChanged=function(){this.autoSaveOnIdle&&(Object(w["T"])(this.saveInterval)||(clearTimeout(this.timeInterval),this.timeInterval=setTimeout(this.updateIntervalValue.bind(this),this.saveInterval)))},t.prototype.invokeChangeEvent=function(){var e;e=this.enableXhtml?this.getXhtml():this.value;var t={value:e};this.value!==this.cloneValue&&(this.trigger("change",t),this.cloneValue=this.value)},t.prototype.wireScrollElementsEvents=function(){this.scrollParentElements=Object(Vt["c"])(this.element);for(var e=0,t=this.scrollParentElements;e<t.length;e++){var i=t[e];w["l"].add(i,"scroll",this.scrollHandler,this)}this.iframeSettings.enable||w["l"].add(this.contentModule.getPanel(),"scroll",this.contentScrollHandler,this)},t.prototype.wireContextEvent=function(){this.quickToolbarSettings.showOnRightClick&&(w["l"].add(this.inputElement,"contextmenu",this.contextHandler,this),w["d"].isDevice&&(this.touchModule=new w["t"](this.inputElement,{tapHold:this.touchHandler.bind(this),tapHoldThreshold:500})))},t.prototype.unWireContextEvent=function(){w["l"].remove(this.inputElement,"contextmenu",this.contextHandler),w["d"].isDevice&&this.touchModule&&this.touchModule.destroy()},t.prototype.unWireScrollElementsEvents=function(){this.scrollParentElements=Object(Vt["c"])(this.element);for(var e=0,t=this.scrollParentElements;e<t.length;e++){var i=t[e];w["l"].remove(i,"scroll",this.scrollHandler)}this.iframeSettings.enable||w["l"].remove(this.contentModule.getPanel(),"scroll",this.contentScrollHandler)},t.prototype.touchHandler=function(e){this.notifyMouseUp(e.originalEvent),this.triggerEditArea(e.originalEvent)},t.prototype.contextHandler=function(e){var t=Object(w["A"])(e.target,"a, table, img");!1!==this.inlineMode.onSelection&&(Object(w["T"])(t)||!this.inputElement.contains(t)||"IMG"!==t.tagName&&"TABLE"!==t.tagName&&"A"!==t.tagName)||e.preventDefault()},t.prototype.resetHandler=function(){var e=this.valueContainer.defaultValue.trim();this.setProperties({value:""===e?null:e})},t.prototype.autoResize=function(){var e=this;if("auto"===this.height){if("Markdown"===this.editorMode)setTimeout(function(){e.setAutoHeight(e.inputElement)},0);else if(this.iframeSettings.enable){var t=this.element.querySelector("#"+this.getID()+"_rte-view");setTimeout(function(){e.setAutoHeight(t)},100),this.inputElement.style.overflow="hidden"}}else this.inputElement.style.overflow=null},t.prototype.setAutoHeight=function(e){Object(w["T"])(e)||(e.style.height="",e.style.height=this.inputElement.scrollHeight+"px",e.style.overflow="hidden")},t.prototype.wireEvents=function(){this.element.addEventListener("focusin",this.onFocusHandler,!0),this.element.addEventListener("focusout",this.onBlurHandler,!0),this.on(_t,this.contentChanged,this),this.on(hn,this.updateResizeFlag,this),this.on(mn,this.updateStatus,this),this.readonly&&this.enabled||this.bindEvents()},t.prototype.restrict=function(e){if(this.maxLength>=0){for(var t="Markdown"===this.editorMode?this.contentModule.getText():e.currentTarget.textContent,i=[8,16,17,37,38,39,40,46,65],n=void 0,r=0;r<=i.length-1;r++)if(e.which===i[r]){if(e.ctrlKey&&65===e.which)return;if(65!==e.which)return void(n=i[r])}t.length>=this.maxLength&&-1!==this.maxLength&&e.which!==n&&e.preventDefault()}},t.prototype.bindEvents=function(){this.keyboardModule=new es(this.inputElement,{keyAction:this.keyDown.bind(this),keyConfigs:lo({},this.formatter.keyConfig,this.keyConfig),eventName:"keydown"});var e=Object(w["A"])(this.valueContainer,"form");e&&w["l"].add(e,"reset",this.resetHandler,this),w["l"].add(this.inputElement,"keyup",this.keyUp,this),w["l"].add(this.inputElement,"paste",this.onPaste,this),w["l"].add(this.inputElement,w["d"].touchEndEvent,Object(w["D"])(this.mouseUp,30),this),w["l"].add(this.inputElement,w["d"].touchStartEvent,this.mouseDownHandler,this),this.wireContextEvent(),this.formatter.editorManager.observer.on(qr,this.editorKeyDown,this),this.element.ownerDocument.defaultView.addEventListener("resize",this.onResizeHandler,!0),this.iframeSettings.enable&&(w["l"].add(this.inputElement,"focusin",this.focusHandler,this),w["l"].add(this.inputElement,"focusout",this.blurHandler,this),w["l"].add(this.inputElement.ownerDocument,"scroll",this.contentScrollHandler,this),w["l"].add(this.inputElement.ownerDocument,w["d"].touchStartEvent,this.onIframeMouseDown,this)),this.wireScrollElementsEvents()},t.prototype.onIframeMouseDown=function(e){this.isBlur=!1,this.currentTarget=e.target,this.notify(Gt,e)},t.prototype.editorKeyDown=function(e){switch(e.event.action){case"copy":this.onCopy();break;case"cut":this.onCut();break}!e.callBack||"copy"!==e.event.action&&"cut"!==e.event.action&&"delete"!==e.event.action||e.callBack({requestType:e.event.action,editorMode:"HTML",event:e.event})},t.prototype.unWireEvents=function(){this.element.removeEventListener("focusin",this.onFocusHandler,!0),this.element.removeEventListener("focusout",this.onBlurHandler,!0),this.off(_t,this.contentChanged),this.off(hn,this.updateResizeFlag),this.off(mn,this.updateStatus),this.readonly&&this.enabled||this.unbindEvents()},t.prototype.unbindEvents=function(){this.keyboardModule&&this.keyboardModule.destroy();var e=Object(w["A"])(this.valueContainer,"form");e&&w["l"].remove(e,"reset",this.resetHandler),w["l"].remove(this.inputElement,"keyup",this.keyUp),w["l"].remove(this.inputElement,"paste",this.onPaste),w["l"].remove(this.inputElement,w["d"].touchEndEvent,Object(w["D"])(this.mouseUp,30)),w["l"].remove(this.inputElement,w["d"].touchStartEvent,this.mouseDownHandler),this.unWireContextEvent(),this.formatter&&this.formatter.editorManager.observer.off(qr,this.editorKeyDown),this.element.ownerDocument.defaultView.removeEventListener("resize",this.onResizeHandler,!0),this.iframeSettings.enable&&(w["l"].remove(this.inputElement,"focusin",this.focusHandler),w["l"].remove(this.inputElement,"focusout",this.blurHandler),w["l"].remove(this.inputElement.ownerDocument,"scroll",this.contentScrollHandler),w["l"].remove(this.inputElement.ownerDocument,w["d"].touchStartEvent,this.onIframeMouseDown)),this.unWireScrollElementsEvents()},co([Object(w["g"])({},aa)],t.prototype,"toolbarSettings",void 0),co([Object(w["g"])({},ca)],t.prototype,"quickToolbarSettings",void 0),co([Object(w["g"])({},ha)],t.prototype,"pasteCleanupSettings",void 0),co([Object(w["g"])({},Oa)],t.prototype,"iframeSettings",void 0),co([Object(w["g"])({},oa)],t.prototype,"insertImageSettings",void 0),co([Object(w["g"])({},da)],t.prototype,"tableSettings",void 0),co([Object(w["r"])(0)],t.prototype,"floatingToolbarOffset",void 0),co([Object(w["g"])({},Sa)],t.prototype,"inlineMode",void 0),co([Object(w["g"])({},la)],t.prototype,"fileManagerSettings",void 0),co([Object(w["r"])("100%")],t.prototype,"width",void 0),co([Object(w["r"])(!1)],t.prototype,"enablePersistence",void 0),co([Object(w["r"])(!1)],t.prototype,"enableResize",void 0),co([Object(w["r"])({})],t.prototype,"htmlAttributes",void 0),co([Object(w["r"])(null)],t.prototype,"placeholder",void 0),co([Object(w["r"])(!1)],t.prototype,"autoSaveOnIdle",void 0),co([Object(w["r"])(!1)],t.prototype,"readonly",void 0),co([Object(w["r"])(!0)],t.prototype,"enabled",void 0),co([Object(w["r"])(!0)],t.prototype,"enableHtmlSanitizer",void 0),co([Object(w["r"])(!1)],t.prototype,"enableHtmlEncode",void 0),co([Object(w["r"])(!1)],t.prototype,"enableXhtml",void 0),co([Object(w["r"])("auto")],t.prototype,"height",void 0),co([Object(w["r"])(null)],t.prototype,"cssClass",void 0),co([Object(w["r"])(null)],t.prototype,"value",void 0),co([Object(w["r"])("P")],t.prototype,"enterKey",void 0),co([Object(w["r"])("BR")],t.prototype,"shiftEnterKey",void 0),co([Object(w["r"])(30)],t.prototype,"undoRedoSteps",void 0),co([Object(w["r"])(300)],t.prototype,"undoRedoTimer",void 0),co([Object(w["r"])("HTML")],t.prototype,"editorMode",void 0),co([Object(w["r"])(null)],t.prototype,"keyConfig",void 0),co([Object(w["r"])(!1)],t.prototype,"showCharCount",void 0),co([Object(w["r"])(!1)],t.prototype,"enableTabKey",void 0),co([Object(w["r"])(!1)],t.prototype,"enableAutoUrl",void 0),co([Object(w["r"])(-1)],t.prototype,"maxLength",void 0),co([Object(w["g"])({},ma)],t.prototype,"format",void 0),co([Object(w["g"])({},ba)],t.prototype,"numberFormatList",void 0),co([Object(w["g"])({},va)],t.prototype,"bulletFormatList",void 0),co([Object(w["g"])({},pa)],t.prototype,"fontFamily",void 0),co([Object(w["g"])({},ua)],t.prototype,"fontSize",void 0),co([Object(w["g"])({},ga)],t.prototype,"fontColor",void 0),co([Object(w["g"])({},fa)],t.prototype,"backgroundColor",void 0),co([Object(w["r"])(null)],t.prototype,"valueTemplate",void 0),co([Object(w["r"])(1e4)],t.prototype,"saveInterval",void 0),co([Object(w["k"])()],t.prototype,"actionBegin",void 0),co([Object(w["k"])()],t.prototype,"actionComplete",void 0),co([Object(w["k"])()],t.prototype,"beforeDialogOpen",void 0),co([Object(w["k"])()],t.prototype,"dialogOpen",void 0),co([Object(w["k"])()],t.prototype,"beforeDialogClose",void 0),co([Object(w["k"])()],t.prototype,"dialogClose",void 0),co([Object(w["k"])()],t.prototype,"beforeQuickToolbarOpen",void 0),co([Object(w["k"])()],t.prototype,"quickToolbarOpen",void 0),co([Object(w["k"])()],t.prototype,"quickToolbarClose",void 0),co([Object(w["k"])()],t.prototype,"toolbarStatusUpdate",void 0),co([Object(w["k"])()],t.prototype,"updatedToolbarStatus",void 0),co([Object(w["k"])()],t.prototype,"imageSelected",void 0),co([Object(w["k"])()],t.prototype,"beforeImageUpload",void 0),co([Object(w["k"])()],t.prototype,"imageUploading",void 0),co([Object(w["k"])()],t.prototype,"imageUploadSuccess",void 0),co([Object(w["k"])()],t.prototype,"imageUploadFailed",void 0),co([Object(w["k"])()],t.prototype,"imageRemoving",void 0),co([Object(w["k"])()],t.prototype,"afterImageDelete",void 0),co([Object(w["k"])()],t.prototype,"created",void 0),co([Object(w["k"])()],t.prototype,"destroyed",void 0),co([Object(w["k"])()],t.prototype,"beforeSanitizeHtml",void 0),co([Object(w["k"])()],t.prototype,"blur",void 0),co([Object(w["k"])()],t.prototype,"toolbarClick",void 0),co([Object(w["k"])()],t.prototype,"focus",void 0),co([Object(w["k"])()],t.prototype,"change",void 0),co([Object(w["k"])()],t.prototype,"resizing",void 0),co([Object(w["k"])()],t.prototype,"resizeStart",void 0),co([Object(w["k"])()],t.prototype,"resizeStop",void 0),co([Object(w["k"])()],t.prototype,"beforePasteCleanup",void 0),co([Object(w["k"])()],t.prototype,"afterPasteCleanup",void 0),co([Object(w["k"])()],t.prototype,"beforeImageDrop",void 0),co([Object(w["r"])(null)],t.prototype,"formatter",void 0),t=co([w["p"]],t),t}(w["h"]),po=i("faf3"),uo=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),mo=function(e,t,i,n){var r,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var o=e.length-1;o>=0;o--)(r=e[o])&&(a=(s<3?r(a):s>3?r(t,i,a):r(t,i))||a);return s>3&&a&&Object.defineProperty(t,i,a),a};function go(e,t){for(var i=Object(w["G"])({},e),n=0,r=Object.keys(i);n<r.length;n++){var s=r[n];t.indexOf(s)<0&&Object(w["E"])(i,s)}return i}function fo(e,t){var i,n=40===t?0:e.childElementCount-1,r=n,s=e.querySelector(".e-selected");s&&s.classList.remove("e-selected");for(var a=0,o=e.children.length;a<o;a++)e.children[a].classList.contains("e-focused")&&(i=e.children[a],r=a,i.classList.remove("e-focused"),40===t?r++:r--,r===(40===t?e.childElementCount:-1)&&(r=n));i=e.children[r],r=bo(e,i,r,t),-1!==r&&(Object(w["u"])([e.children[r]],"e-focused"),e.children[r].focus())}function bo(e,t,i,n,r){if(void 0===r&&(r=0),(t.classList.contains("e-separator")||t.classList.contains("e-disabled"))&&(i===(40===n?e.childElementCount-1:0)?i=40===n?0:e.childElementCount-1:40===n?i++:i--),t=e.children[i],t.classList.contains("e-separator")||t.classList.contains("e-disabled")){if(r++,r===e.childElementCount)return-1;i=bo(e,t,i,n,r)}return i}function vo(e){var t=[].slice.call(e.getElementsByClassName("e-blank-icon"));if(t.length){var i=e.querySelector(".e-item:not(.e-blank-icon):not(.e-separator)");if(!Object(w["T"])(i)){i.classList.contains("e-url")&&(i=i.querySelector(".e-menu-url"));var n,r=i.querySelector(".e-menu-icon"),s=e.classList.contains("e-rtl");n=s?{padding:"paddingRight",margin:"marginLeft"}:{padding:"paddingLeft",margin:"marginRight"};var a=parseInt(getComputedStyle(r).fontSize,10)+parseInt(getComputedStyle(r)[n.margin],10)+parseInt(getComputedStyle(i).paddingLeft,10)+"px";t.forEach(function(e){e.classList.contains("e-url")?e.querySelector(".e-menu-url").style[n.padding]=a:e.style[n.padding]=a})}}}var yo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return uo(t,e),mo([Object(w["r"])("")],t.prototype,"iconCss",void 0),mo([Object(w["r"])("")],t.prototype,"id",void 0),mo([Object(w["r"])(!1)],t.prototype,"separator",void 0),mo([Object(w["r"])("")],t.prototype,"text",void 0),mo([Object(w["r"])("")],t.prototype,"url",void 0),mo([Object(w["r"])(!1)],t.prototype,"disabled",void 0),t}(w["e"]),Co=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),wo=function(e,t,i,n){var r,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var o=e.length-1;o>=0;o--)(r=e[o])&&(a=(s<3?r(a):s>3?r(t,i,a):r(t,i))||a);return s>3&&a&&Object.defineProperty(t,i,a),a},Oo={DISABLED:"e-disabled",FOCUS:"e-focused",ICON:"e-menu-icon",ITEM:"e-item",POPUP:"e-dropdown-popup",RTL:"e-rtl",SEPARATOR:"e-separator",VERTICAL:"e-vertical"},To=function(e){function t(t,i){var n=e.call(this,t,i)||this;return n.isPopupCreated=!0,n}return Co(t,e),t.prototype.preRender=function(){},t.prototype.getPersistData=function(){return this.addOnPersist([])},t.prototype.toggle=function(){this.canOpen()?this.openPopUp():this.closePopup()},t.prototype.render=function(){this.initialize(),this.disabled||this.wireEvents(),this.renderComplete()},t.prototype.addItems=function(e,t){for(var i,n=this.items.length,r=0,s=this.items.length;r<s;r++)if(t===this.items[r].text){n=r;break}for(var a=e.length-1;a>=0;a--)i=new yo(this,"items",e[a],!0),this.items.splice(n,0,i);this.canOpen()||this.createItems()},t.prototype.removeItems=function(e,t){for(var i=!1,n=0,r=e.length;n<r;n++)for(var s=0,a=this.items.length;s<a;s++)if(e[n]===(t?this.items[s].id:this.items[s].text)){this.items.splice(s,1),i=!0;break}i&&this.getULElement()&&this.createItems()},t.prototype.createPopup=function(){var e,t=this.createElement("div",{className:Oo.POPUP,id:this.element.id+"-popup"});document.body.appendChild(t),this.dropDown=new Vt["a"](t,{relateTo:this.element,collision:{X:"fit",Y:"flip"},position:{X:"left",Y:"bottom"},targetType:"relative",content:this.target?this.getTargetElement():"",enableRtl:this.enableRtl}),"fixed"===this.dropDown.element.style.position&&this.dropDown.refreshPosition(this.element),this.dropDown.hide(),Object(w["w"])(this.element,(e={},e["aria-haspopup"]=this.items.length||this.target?"true":"false",e["aria-expanded"]="false",e["aria-owns"]=this.getPopUpElement().id,e["type"]="button",e["aria-label"]=this.element.textContent?this.element.textContent:"dropdownbutton",e)),this.cssClass&&Object(w["u"])([t],this.cssClass.split(" ")),this.isPopupCreated=!0},t.prototype.getTargetElement=function(){return"string"===typeof this.target?Object(w["jb"])(this.target):this.target},t.prototype.createItems=function(e){var t,i,n,r,s=this.items,a=this.hasIcon(this.items,"iconCss"),o=this.getULElement();o?o.innerHTML="":o=this.createElement("ul",{attrs:{role:"menu",tabindex:"0"}});for(var l=0;l<s.length;l++){i=s[l];var d=i.text;n=this.createElement("li",{innerHTML:i.url?"":d,className:i.separator?Oo.ITEM+" "+Oo.SEPARATOR:Oo.ITEM,attrs:{role:"menuItem",tabindex:"-1","aria-label":d},id:i.id?i.id:Object(w["Q"])("e-"+this.getModuleName()+"-item")}),this.enableHtmlSanitizer?n.textContent=i.url?"":d:n.innerHTML=i.url?"":d,i.url&&(n.appendChild(this.createAnchor(i)),n.classList.add("e-url")),i.iconCss?(t=this.createElement("span",{className:Oo.ICON+" "+i.iconCss}),i.url?n.childNodes[0].appendChild(t):n.insertBefore(t,n.childNodes[0])):a&&!i.separator&&n.classList.add("e-blank-icon"),i.disabled&&n.classList.add("e-disabled"),r={item:i,element:n},this.trigger("beforeItemRender",r),o.appendChild(n)}e&&this.getPopUpElement().appendChild(o),a&&vo(this.getPopUpElement())},t.prototype.hasIcon=function(e,t){for(var i=0,n=e.length;i<n;i++)if(e[i][t])return!0;return!1},t.prototype.createAnchor=function(e){var t=this.enableHtmlSanitizer?w["s"].sanitize(e.text):e.text;return this.createElement("a",{className:"e-menu-text e-menu-url",innerHTML:t,attrs:{href:e.url}})},t.prototype.initialize=function(){this.button=new po["a"]({iconCss:this.iconCss,iconPosition:this.iconPosition,cssClass:this.cssClass,content:this.content,disabled:this.disabled,enableRtl:this.enableRtl,enablePersistence:this.enablePersistence}),this.button.createElement=this.createElement,this.button.appendTo(this.element),this.element.id||(this.element.id=Object(w["Q"])("e-"+this.getModuleName())),this.appendArrowSpan(),this.setActiveElem([this.element]),this.target&&!this.isColorPicker()||!this.createPopupOnClick?this.createPopup():this.isPopupCreated=!1},t.prototype.isColorPicker=function(){if(!this.element)return!1;var e=this.element.previousSibling;return!!(e&&e.classList&&e.classList.contains("e-split-colorpicker"))},t.prototype.appendArrowSpan=function(){this.element.appendChild(this.createElement("span",{className:"e-btn-icon e-icons e-icon-"+(this.cssClass.indexOf(Oo.VERTICAL)>-1?"bottom":"right")+" e-caret"}))},t.prototype.setActiveElem=function(e){this.activeElem=e},t.prototype.getModuleName=function(){return"dropdown-btn"},t.prototype.canOpen=function(){var e=!1;return this.isPopupCreated&&(e=this.getPopUpElement().classList.contains("e-popup-close")),e},t.prototype.destroy=function(){var t=this;if(e.prototype.destroy.call(this),"dropdown-btn"===this.getModuleName()){var i;this.element.querySelector("span.e-caret")&&Object(w["F"])(this.element.querySelector("span.e-caret")),this.cssClass&&(i=this.cssClass.split(" ")),this.button.destroy(),i&&Object(w["gb"])([this.element],i),Object(w["gb"])(this.activeElem,["e-active"]);var n=this.element.getAttribute("class")?["aria-haspopup","aria-expanded","aria-owns","type"]:["aria-haspopup","aria-expanded","aria-owns","type","class"];n.forEach(function(e){t.element.removeAttribute(e)}),this.popupUnWireEvents(),this.destroyPopup(),this.isPopupCreated=!1,this.disabled||this.unWireEvents()}},t.prototype.destroyPopup=function(){if(this.isPopupCreated){if(this.dropDown.destroy(),this.getPopUpElement()){var e=document.getElementById(this.getPopUpElement().id);e&&(Object(w["gb"])([e],["e-popup-open","e-popup-close"]),Object(w["F"])(e))}w["l"].remove(this.getPopUpElement(),"click",this.clickHandler),w["l"].remove(this.getPopUpElement(),"keydown",this.keyBoardHandler),this.isPopupCreated&&(this.dropDown=void 0)}this.isPopupCreated=!1},t.prototype.getPopUpElement=function(){var e=null;return this.dropDown&&(e=this.dropDown.element),e},t.prototype.getULElement=function(){var e=null;return this.getPopUpElement()&&(e=this.getPopUpElement().children[0]),e},t.prototype.wireEvents=function(){this.delegateMousedownHandler=this.mousedownHandler.bind(this),this.createPopupOnClick||w["l"].add(document,"mousedown touchstart",this.delegateMousedownHandler,this),w["l"].add(this.element,"click",this.clickHandler,this),w["l"].add(this.element,"keydown",this.keyBoardHandler,this)},t.prototype.popupWireEvents=function(){var e=this.getPopUpElement();this.createPopupOnClick&&w["l"].add(document,"mousedown touchstart",this.delegateMousedownHandler,this),e&&(w["l"].add(e,"click",this.clickHandler,this),w["l"].add(e,"keydown",this.keyBoardHandler,this)),this.rippleFn=Object(w["ib"])(e,{selector:"."+Oo.ITEM})},t.prototype.popupUnWireEvents=function(){var e=this.getPopUpElement();this.createPopupOnClick&&w["l"].remove(document,"mousedown touchstart",this.delegateMousedownHandler),e&&e.parentElement&&(w["l"].remove(e,"click",this.clickHandler),w["l"].remove(e,"keydown",this.keyBoardHandler))},t.prototype.keyBoardHandler=function(e){if(e.target!==this.element||9!==e.keyCode&&(e.altKey||40!==e.keyCode)&&38!==e.keyCode)switch(e.keyCode){case 38:case 40:!e.altKey||38!==e.keyCode&&40!==e.keyCode?this.upDownKeyHandler(e):this.keyEventHandler(e);break;case 9:case 13:case 27:case 32:this.keyEventHandler(e);break}},t.prototype.upDownKeyHandler=function(e){(!this.target||38!==e.keyCode&&40!==e.keyCode)&&(e.preventDefault(),fo(this.getULElement(),e.keyCode))},t.prototype.keyEventHandler=function(e){(!this.target||13!==e.keyCode&&9!==e.keyCode)&&(e.target&&e.target.className.indexOf("e-edit-template")>-1&&32===e.keyCode||(9!==e.keyCode&&e.preventDefault(),27===e.keyCode||38===e.keyCode||9===e.keyCode?this.canOpen()||this.closePopup(e,this.element):this.clickHandler(e)))},t.prototype.getLI=function(e){return"LI"===e.tagName?e:Object(w["A"])(e,"li")},t.prototype.mousedownHandler=function(e){var t=e.target;!this.dropDown||this.canOpen()||Object(w["A"])(t,'[id="'+this.getPopUpElement().id+'"]')||Object(w["A"])(t,'[id="'+this.element.id+'"]')||this.closePopup(e)},t.prototype.clickHandler=function(e){var t=e.target;if(Object(w["A"])(t,'[id="'+this.element.id+'"]'))!this.createPopupOnClick||this.target&&!this.isColorPicker()?this.getPopUpElement().classList.contains("e-popup-close")?this.openPopUp(e):this.closePopup(e):this.isPopupCreated?this.closePopup(e,this.activeElem[0]):(this.createPopup(),this.openPopUp(e));else if(Object(w["A"])(t,'[id="'+this.getPopUpElement().id+'"]')){var i=void 0,n=void 0,r=void 0,s=this.getLI(t);s&&(n=Array.prototype.indexOf.call(this.getULElement().children,s),r=this.items[n],r&&(i={element:s,item:r},this.trigger("select",i)),this.closePopup(e,this.activeElem[0]))}},t.prototype.openPopUp=function(e){var t=this;void 0===e&&(e=null);var i=this.getPopUpElement();if(this.target)if(this.activeElem.length>1){var n=Object(w["I"])(this.activeElem[0],"split-btn");n.isReact&&i.childNodes.length<1&&(!0,n.appendReactElement(this.getTargetElement(),this.getPopUpElement()),this.renderReactTemplates())}else this.isReact&&i.childNodes.length<1&&(!0,this.appendReactElement(this.getTargetElement(),this.getPopUpElement()),this.renderReactTemplates());else this.createItems(!0);var r=this.getULElement();this.popupWireEvents();var s={element:r,items:this.items,event:e,cancel:!1};this.trigger("beforeOpen",s,function(e){if(!e.cancel){var i=t.getULElement();t.dropDown.show(null,t.element),Object(w["u"])([t.element],"e-active"),t.element.setAttribute("aria-expanded","true"),i.focus();var n={element:i,items:t.items};t.trigger("open",n)}})},t.prototype.closePopup=function(e,t){var i=this;void 0===e&&(e=null);var n=this.getULElement(),r={element:n,items:this.items,event:e,cancel:!1},s=this.getPopUpElement();s&&w["l"].remove(s,"keydown",this.keyBoardHandler),this.trigger("beforeClose",r,function(e){if(!e.cancel){i.popupUnWireEvents();var n=i.getULElement(),r=n.querySelector(".e-selected");r&&r.classList.remove("e-selected"),i.dropDown.hide(),Object(w["gb"])(i.activeElem,"e-active"),i.element.setAttribute("aria-expanded","false"),t&&t.focus();var s={element:n,items:i.items};i.trigger("close",s),!i.target&&n&&Object(w["F"])(n),i.target&&!i.isColorPicker()||i.createPopupOnClick&&i.destroyPopup(),i.target&&(i.isPopupCreated=!i.createPopupOnClick)}})},t.prototype.unWireEvents=function(){this.createPopupOnClick||w["l"].remove(document,"mousedown touchstart",this.delegateMousedownHandler),w["l"].remove(this.element,"click",this.clickHandler),w["l"].remove(this.element,"keydown",this.keyBoardHandler),this.isPopupCreated&&(w["l"].remove(this.getPopUpElement(),"click",this.clickHandler),w["l"].remove(this.getPopUpElement(),"keydown",this.keyBoardHandler))},t.prototype.onPropertyChanged=function(e,t){var i,n=["content","cssClass","iconCss","iconPosition","disabled","enableRtl"];this.button.setProperties(go(e,n)),this.isPopupCreated&&(i=this.getPopUpElement(),this.dropDown.setProperties(go(e,["enableRtl"])));for(var r=0,s=Object.keys(e);r<s.length;r++){var a=s[r];switch(a){case"content":this.element.querySelector("span.e-caret")||this.appendArrowSpan();break;case"disabled":e.disabled?(this.unWireEvents(),this.isPopupCreated&&!this.canOpen()&&this.closePopup()):this.wireEvents();break;case"cssClass":if(e.cssClass.indexOf(Oo.VERTICAL)>-1){var o=this.element.querySelector("span.e-caret");Object(w["y"])(o,["e-icon-bottom"],["e-icon-right"])}this.isPopupCreated&&(t.cssClass&&Object(w["gb"])([i],t.cssClass.split(" ")),e.cssClass&&Object(w["u"])([i],e.cssClass.split(" ")));break;case"target":this.dropDown.content=this.getTargetElement(),this.dropDown.dataBind();break;case"items":this.isPopupCreated&&this.getULElement()&&this.createItems();break;case"createPopupOnClick":e.createPopupOnClick?this.destroyPopup():this.createPopup();break}}},t.prototype.focusIn=function(){this.element.focus()},wo([Object(w["r"])("")],t.prototype,"content",void 0),wo([Object(w["r"])("")],t.prototype,"cssClass",void 0),wo([Object(w["r"])(!1)],t.prototype,"disabled",void 0),wo([Object(w["r"])("")],t.prototype,"iconCss",void 0),wo([Object(w["r"])("Left")],t.prototype,"iconPosition",void 0),wo([Object(w["r"])(!1)],t.prototype,"enableHtmlSanitizer",void 0),wo([Object(w["f"])([],yo)],t.prototype,"items",void 0),wo([Object(w["r"])(!1)],t.prototype,"createPopupOnClick",void 0),wo([Object(w["r"])("")],t.prototype,"target",void 0),wo([Object(w["k"])()],t.prototype,"beforeItemRender",void 0),wo([Object(w["k"])()],t.prototype,"beforeOpen",void 0),wo([Object(w["k"])()],t.prototype,"beforeClose",void 0),wo([Object(w["k"])()],t.prototype,"close",void 0),wo([Object(w["k"])()],t.prototype,"open",void 0),wo([Object(w["k"])()],t.prototype,"select",void 0),wo([Object(w["k"])()],t.prototype,"created",void 0),t=wo([w["p"]],t),t}(w["h"]),ko=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),So=function(e,t,i,n){var r,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var o=e.length-1;o>=0;o--)(r=e[o])&&(a=(s<3?r(a):s>3?r(t,i,a):r(t,i))||a);return s>3&&a&&Object.defineProperty(t,i,a),a},jo="e-rtl",Ro="EJS-SPLITBUTTON",Do=function(e){function t(t,i){return e.call(this,t,i)||this}return ko(t,e),t.prototype.preRender=function(){var e=this.element;if(e.tagName===Ro){for(var t=Object(w["R"])("ej2_instances",e),i=this.createElement("button",{attrs:{type:"button"}}),n=this.createElement(Ro,{className:"e-"+this.getModuleName()+"-wrapper"}),r=0,s=e.attributes.length;r<s;r++)i.setAttribute(e.attributes[r].nodeName,e.attributes[r].nodeValue);e.parentNode.insertBefore(n,e),Object(w["F"])(e),e=i,n.appendChild(e),Object(w["ob"])("ej2_instances",t,e),this.wrapper=n,this.element=e}this.element.id||(this.element.id=Object(w["Q"])("e-"+this.getModuleName()))},t.prototype.render=function(){this.initWrapper(),this.createPrimaryButton(),this.renderControl()},t.prototype.renderControl=function(){this.createSecondaryButton(),this.setActiveElem([this.element,this.secondaryBtnObj.element]),this.setAria(),this.wireEvents(),this.renderComplete()},t.prototype.addItems=function(t,i){e.prototype.addItems.call(this,t,i),this.secondaryBtnObj.items=this.items},t.prototype.removeItems=function(t,i){e.prototype.removeItems.call(this,t,i),this.secondaryBtnObj.items=this.items},t.prototype.initWrapper=function(){this.wrapper||(this.wrapper=this.createElement("div",{className:"e-"+this.getModuleName()+"-wrapper"}),this.element.parentNode.insertBefore(this.wrapper,this.element)),this.element.classList.remove("e-"+this.getModuleName()),this.enableRtl&&this.wrapper.classList.add(jo),this.cssClass&&Object(w["u"])([this.wrapper],this.cssClass.split(" "))},t.prototype.createPrimaryButton=function(){var e={cssClass:this.cssClass,enableRtl:this.enableRtl,iconCss:this.iconCss,iconPosition:this.iconPosition,content:this.content,disabled:this.disabled};this.primaryBtnObj=new po["a"](e),this.primaryBtnObj.createElement=this.createElement,this.primaryBtnObj.appendTo(this.element),this.element.classList.add("e-"+this.getModuleName()),this.element.type="button",this.wrapper.appendChild(this.element)},t.prototype.createSecondaryButton=function(){var e=this,t=this.createElement("button",{className:"e-icon-btn",attrs:{tabindex:"-1"},id:this.element.id+"_dropdownbtn"});this.wrapper.appendChild(t);var i={cssClass:this.cssClass,disabled:this.disabled,enableRtl:this.enableRtl,items:this.items,target:this.target,createPopupOnClick:this.createPopupOnClick,beforeItemRender:function(t){e.createPopupOnClick&&(e.secondaryBtnObj.dropDown.relateTo=e.wrapper,e.dropDown=e.secondaryBtnObj.dropDown),e.trigger("beforeItemRender",t)},open:function(t){e.trigger("open",t)},close:function(t){e.trigger("close",t)},select:function(t){e.trigger("select",t)},beforeOpen:function(t){var i=new Eo;return e.trigger("beforeOpen",t,function(e){i.resolve(e)}),i},beforeClose:function(t){var i=new Eo;return e.trigger("beforeClose",t,function(e){i.resolve(e)}),i}};this.secondaryBtnObj=new To(i),this.secondaryBtnObj.createElement=this.createElement,this.secondaryBtnObj.appendTo(t),this.createPopupOnClick||(this.secondaryBtnObj.dropDown.relateTo=this.wrapper,this.dropDown=this.secondaryBtnObj.dropDown),this.secondaryBtnObj.activeElem=[this.element,this.secondaryBtnObj.element],this.secondaryBtnObj.element.querySelector(".e-btn-icon").classList.remove("e-icon-right")},t.prototype.setAria=function(){Object(w["w"])(this.element,{"aria-expanded":"false","aria-haspopup":"true","aria-label":this.element.textContent+" splitbutton","aria-owns":this.element.id+"_dropdownbtn-popup"})},t.prototype.getModuleName=function(){return"split-btn"},t.prototype.toggle=function(){this.secondaryBtnObj.toggle()},t.prototype.destroy=function(){var t=this,i=[jo];if(this.cssClass&&(i=i.concat(this.cssClass.split(" "))),this.element){var n=document.getElementById(this.element.id);n&&n.parentElement===this.wrapper&&(this.wrapper.tagName===Ro?(this.wrapper.innerHTML="",Object(w["gb"])([this.wrapper],["e-rtl","e-"+this.getModuleName()+"-wrapper"]),Object(w["gb"])([this.wrapper],this.cssClass.split(" "))):(Object(w["gb"])([this.element],i),["aria-label","aria-haspopup","aria-expanded","aria-owns","type"].forEach(function(e){t.element.removeAttribute(e)}),this.wrapper.parentNode.insertBefore(this.element,this.wrapper),Object(w["fb"])(this.wrapper)),this.unWireEvents())}this.primaryBtnObj.destroy(),this.secondaryBtnObj.destroy(),e.prototype.destroy.call(this),this.element.getAttribute("class")||this.element.removeAttribute("class")},t.prototype.wireEvents=function(){w["l"].add(this.element,"click",this.primaryBtnClickHandler,this),new w["n"](this.element,{keyAction:this.btnKeyBoardHandler.bind(this),keyConfigs:{altdownarrow:"alt+downarrow"}})},t.prototype.unWireEvents=function(){w["l"].remove(this.element,"click",this.primaryBtnClickHandler),Object(w["M"])(this.element,w["n"]).destroy()},t.prototype.primaryBtnClickHandler=function(){this.trigger("click",{element:this.element})},t.prototype.btnKeyBoardHandler=function(e){switch(e.action){case"altdownarrow":this.clickHandler(e);break}},t.prototype.onPropertyChanged=function(e,t){var i=["content","iconCss","iconPosition","cssClass","disabled","enableRtl"];this.primaryBtnObj.setProperties(go(e,i)),i=["beforeOpen","beforeItemRender","select","open","close","cssClass","disabled","enableRtl","createPopupOnClick"],Object.keys(e).indexOf("items")>-1&&(this.secondaryBtnObj.items=e.items,this.secondaryBtnObj.dataBind()),this.secondaryBtnObj.setProperties(go(e,i));for(var n=0,r=Object.keys(e);n<r.length;n++){var s=r[n];switch(s){case"cssClass":t.cssClass&&Object(w["gb"])([this.wrapper],t.cssClass.split(" ")),Object(w["u"])([this.wrapper],e.cssClass.split(" "));break;case"enableRtl":e.enableRtl?Object(w["u"])([this.wrapper],jo):Object(w["gb"])([this.wrapper],jo);break}}},t.prototype.focusIn=function(){this.element.focus()},So([Object(w["r"])("")],t.prototype,"content",void 0),So([Object(w["r"])("")],t.prototype,"cssClass",void 0),So([Object(w["r"])(!1)],t.prototype,"disabled",void 0),So([Object(w["r"])("")],t.prototype,"iconCss",void 0),So([Object(w["r"])("Left")],t.prototype,"iconPosition",void 0),So([Object(w["r"])(!1)],t.prototype,"createPopupOnClick",void 0),So([Object(w["f"])([],yo)],t.prototype,"items",void 0),So([Object(w["r"])("")],t.prototype,"target",void 0),So([Object(w["k"])()],t.prototype,"beforeItemRender",void 0),So([Object(w["k"])()],t.prototype,"beforeOpen",void 0),So([Object(w["k"])()],t.prototype,"beforeClose",void 0),So([Object(w["k"])()],t.prototype,"click",void 0),So([Object(w["k"])()],t.prototype,"close",void 0),So([Object(w["k"])()],t.prototype,"open",void 0),So([Object(w["k"])()],t.prototype,"select",void 0),So([Object(w["k"])()],t.prototype,"created",void 0),t=So([w["p"]],t),t}(To),Eo=function(){function e(){var e=this;this.promise=new Promise(function(t,i){e.resolve=t,e.reject=i}),this.catch=this.promise.catch.bind(this.promise),this.then=this.promise.then.bind(this.promise)}return e}(),Io=i("45a9"),xo=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Mo=function(e,t,i,n){var r,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var o=e.length-1;o>=0;o--)(r=e[o])&&(a=(s<3?r(a):s>3?r(t,i,a):r(t,i))||a);return s>3&&a&&Object.defineProperty(t,i,a),a},Po=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return xo(t,e),Mo([Object(w["r"])("None")],t.prototype,"placement",void 0),Mo([Object(w["r"])(10)],t.prototype,"largeStep",void 0),Mo([Object(w["r"])(1)],t.prototype,"smallStep",void 0),Mo([Object(w["r"])(!1)],t.prototype,"showSmallTicks",void 0),Mo([Object(w["r"])(null)],t.prototype,"format",void 0),t}(w["e"]),Lo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return xo(t,e),Mo([Object(w["r"])(null)],t.prototype,"color",void 0),Mo([Object(w["r"])(null)],t.prototype,"start",void 0),Mo([Object(w["r"])(null)],t.prototype,"end",void 0),t}(w["e"]),No=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return xo(t,e),Mo([Object(w["r"])(!1)],t.prototype,"enabled",void 0),Mo([Object(w["r"])(null)],t.prototype,"minStart",void 0),Mo([Object(w["r"])(null)],t.prototype,"minEnd",void 0),Mo([Object(w["r"])(null)],t.prototype,"maxStart",void 0),Mo([Object(w["r"])(null)],t.prototype,"maxEnd",void 0),Mo([Object(w["r"])(!1)],t.prototype,"startHandleFixed",void 0),Mo([Object(w["r"])(!1)],t.prototype,"endHandleFixed",void 0),t}(w["e"]),Ao=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return xo(t,e),Mo([Object(w["r"])("")],t.prototype,"cssClass",void 0),Mo([Object(w["r"])("Before")],t.prototype,"placement",void 0),Mo([Object(w["r"])("Focus")],t.prototype,"showOn",void 0),Mo([Object(w["r"])(!1)],t.prototype,"isVisible",void 0),Mo([Object(w["r"])(null)],t.prototype,"format",void 0),t}(w["e"]),Bo=6,Fo=3,Ho={root:"e-slider",rtl:"e-rtl",sliderHiddenInput:"e-slider-input",controlWrapper:"e-control-wrapper",sliderHandle:"e-handle",rangeBar:"e-range",sliderButton:"e-slider-button",firstButton:"e-first-button",secondButton:"e-second-button",scale:"e-scale",tick:"e-tick",large:"e-large",tickValue:"e-tick-value",sliderTooltip:"e-slider-tooltip",sliderHover:"e-slider-hover",sliderFirstHandle:"e-handle-first",sliderSecondHandle:"e-handle-second",sliderDisabled:"e-disabled",sliderContainer:"e-slider-container",horizontalTooltipBefore:"e-slider-horizontal-before",horizontalTooltipAfter:"e-slider-horizontal-after",verticalTooltipBefore:"e-slider-vertical-before",verticalTooltipAfter:"e-slider-vertical-after",materialTooltip:"e-material-tooltip",materialTooltipOpen:"e-material-tooltip-open",materialTooltipActive:"e-tooltip-active",materialSlider:"e-material-slider",sliderTrack:"e-slider-track",sliderHorizantalColor:"e-slider-horizantal-color",sliderVerticalColor:"e-slider-vertical-color",sliderHandleFocused:"e-handle-focused",verticalSlider:"e-vertical",horizontalSlider:"e-horizontal",sliderHandleStart:"e-handle-start",sliderTooltipStart:"e-material-tooltip-start",sliderTabHandle:"e-tab-handle",sliderButtonIcon:"e-button-icon",sliderSmallSize:"e-small-size",sliderTickPosition:"e-tick-pos",sliderFirstTick:"e-first-tick",sliderLastTick:"e-last-tick",sliderButtonClass:"e-slider-btn",sliderTooltipWrapper:"e-tooltip-wrap",sliderTabTrack:"e-tab-track",sliderTabRange:"e-tab-range",sliderActiveHandle:"e-handle-active",sliderMaterialHandle:"e-material-handle",sliderMaterialRange:"e-material-range",sliderMaterialDefault:"e-material-default",materialTooltipShow:"e-material-tooltip-show",materialTooltipHide:"e-material-tooltip-hide",readonly:"e-read-only",limits:"e-limits",limitBarDefault:"e-limit-bar",limitBarFirst:"e-limit-first",limitBarSecond:"e-limit-second",dragHorizontal:"e-drag-horizontal",dragVertical:"e-drag-vertical"},Vo=function(e){function t(t,i){var n=e.call(this,t,i)||this;return n.horDir="left",n.verDir="bottom",n.transition={handle:"left .4s cubic-bezier(.25, .8, .25, 1), right .4s cubic-bezier(.25, .8, .25, 1), top .4s cubic-bezier(.25, .8, .25, 1) , bottom .4s cubic-bezier(.25, .8, .25, 1)",rangeBar:"all .4s cubic-bezier(.25, .8, .25, 1)"},n.transitionOnMaterialTooltip={handle:"left 1ms ease-out, right 1ms ease-out, bottom 1ms ease-out, top 1ms ease-out",rangeBar:"left 1ms ease-out, right 1ms ease-out, bottom 1ms ease-out, width 1ms ease-out, height 1ms ease-out"},n.scaleTransform="transform .4s cubic-bezier(.25, .8, .25, 1)",n.customAriaText=null,n.drag=!0,n.isDragComplete=!1,n.initialTooltip=!0,n}return xo(t,e),t.prototype.preRender=function(){var e={incrementTitle:"Increase",decrementTitle:"Decrease"};this.l10n=new w["o"]("slider",e,this.locale),this.isElementFocused=!1,this.tickElementCollection=[],this.tooltipFormatInfo={},this.ticksFormatInfo={},this.initCultureInfo(),this.initCultureFunc(),this.formChecker()},t.prototype.formChecker=function(){var e=Object(w["A"])(this.element,"form");e?(this.isForm=!0,Object(w["T"])(this.formResetValue)||this.setProperties({value:this.formResetValue},!0),this.formResetValue=this.value,"Range"!==this.type||!Object(w["T"])(this.formResetValue)&&"object"===typeof this.formResetValue?Object(w["T"])(this.formResetValue)&&(this.formResetValue=parseFloat(Object(w["H"])(this.min))):this.formResetValue=[parseFloat(Object(w["H"])(this.min)),parseFloat(Object(w["H"])(this.max))],this.formElement=e):this.isForm=!1},t.prototype.initCultureFunc=function(){this.internationalization=new w["m"](this.locale)},t.prototype.initCultureInfo=function(){this.tooltipFormatInfo.format=Object(w["T"])(this.tooltip.format)?null:this.tooltip.format,this.ticksFormatInfo.format=Object(w["T"])(this.ticks.format)?null:this.ticks.format},t.prototype.formatString=function(e,t){var i=null,n=null;if(e||0===e){i=this.formatNumber(e);var r=this.numberOfDecimals(e);n=this.internationalization.getNumberFormat(t)(this.makeRoundNumber(e,r))}return{elementVal:i,formatString:n}},t.prototype.formatNumber=function(e){var t=this.numberOfDecimals(e);return this.internationalization.getNumberFormat({maximumFractionDigits:t,minimumFractionDigits:t,useGrouping:!1})(e)},t.prototype.numberOfDecimals=function(e){var t=e.toString().split(".")[1],i=t&&t.length?t.length:0;return i},t.prototype.makeRoundNumber=function(e,t){var i=t||0;return Number(e.toFixed(i))},t.prototype.fractionalToInteger=function(e){e=0===this.numberOfDecimals(e)?Number(e).toFixed(this.noOfDecimals):e;for(var t=1,i=0;i<this.noOfDecimals;i++)t*=10;return e=Number((e*t).toFixed(0)),e},t.prototype.render=function(){var e=this;this.initialize(),this.initRender(),this.wireEvents(),this.setZindex(),this.renderComplete(),"EJS-SLIDER"===this.element.tagName&&"none"==this.getTheme(this.sliderContainer)&&setTimeout(function(){e.refresh()},0)},t.prototype.initialize=function(){Object(w["u"])([this.element],Ho.root),this.setCSSClass()},t.prototype.setElementWidth=function(e){Object(w["T"])(e)||("number"===typeof e?this.sliderContainer.style.width=Object(w["H"])(e):"string"===typeof e&&(this.sliderContainer.style.width=e.match(/px|%|em/)?e:Object(w["H"])(e)))},t.prototype.setCSSClass=function(e){e&&Object(w["gb"])([this.element],e.split(" ")),this.cssClass&&Object(w["u"])([this.element],this.cssClass.split(" "))},t.prototype.setEnabled=function(){this.enabled?(Object(w["gb"])([this.sliderContainer],[Ho.sliderDisabled]),this.tooltip.isVisible&&this.tooltipElement&&"Always"===this.tooltip.showOn&&this.tooltipElement.classList.remove(Ho.sliderDisabled),this.wireEvents()):(Object(w["u"])([this.sliderContainer],[Ho.sliderDisabled]),this.tooltip.isVisible&&this.tooltipElement&&"Always"===this.tooltip.showOn&&this.tooltipElement.classList.add(Ho.sliderDisabled),this.unwireEvents())},t.prototype.getTheme=function(e){var t=window.getComputedStyle(e,":after").getPropertyValue("content");return t.replace(/['"]+/g,"")},t.prototype.initRender=function(){this.sliderContainer=this.createElement("div",{className:Ho.sliderContainer+" "+Ho.controlWrapper}),this.element.parentNode.insertBefore(this.sliderContainer,this.element),this.sliderContainer.appendChild(this.element),this.sliderTrack=this.createElement("div",{className:Ho.sliderTrack}),this.element.appendChild(this.sliderTrack),this.setElementWidth(this.width),this.element.tabIndex=-1,this.getThemeInitialization(),this.setHandler(),this.createRangeBar(),this.limits.enabled&&this.createLimitBar(),this.setOrientClass(),this.hiddenInput=this.createElement("input",{attrs:{type:"hidden",value:Object(w["T"])(this.value)?this.min.toString():this.value.toString(),name:this.element.getAttribute("name")||this.element.getAttribute("id")||"_"+(1e3*Math.random()).toFixed(0)+"slider",class:Ho.sliderHiddenInput}}),this.hiddenInput.tabIndex=-1,this.sliderContainer.appendChild(this.hiddenInput),this.showButtons&&this.setButtons(),this.setEnableRTL(),"Range"===this.type?this.rangeValueUpdate():this.value=Object(w["T"])(this.value)?parseFloat(Object(w["H"])(this.min.toString())):this.value,this.previousVal="Range"!==this.type?this.checkHandleValue(parseFloat(Object(w["H"])(this.value.toString()))):[this.checkHandleValue(parseFloat(Object(w["H"])(this.value[0].toString()))),this.checkHandleValue(parseFloat(Object(w["H"])(this.value[1].toString())))],this.previousChanged=this.previousVal,Object(w["T"])(this.element.hasAttribute("name"))||this.element.removeAttribute("name"),this.setValue(),this.limits.enabled&&this.setLimitBar(),"None"!==this.ticks.placement&&this.renderScale(),this.tooltip.isVisible&&this.renderTooltip(),this.enabled?Object(w["gb"])([this.sliderContainer],[Ho.sliderDisabled]):Object(w["u"])([this.sliderContainer],[Ho.sliderDisabled]),this.readonly?Object(w["u"])([this.sliderContainer],[Ho.readonly]):Object(w["gb"])([this.sliderContainer],[Ho.readonly])},t.prototype.getThemeInitialization=function(){this.isMaterial="material"===this.getTheme(this.sliderContainer)||"material-dark"===this.getTheme(this.sliderContainer),this.isBootstrap="bootstrap"===this.getTheme(this.sliderContainer)||"bootstrap-dark"===this.getTheme(this.sliderContainer),this.isBootstrap4="bootstrap4"===this.getTheme(this.sliderContainer),this.isTailwind="tailwind"===this.getTheme(this.sliderContainer)||"tailwind-dark"===this.getTheme(this.sliderContainer),this.isBootstrap5="bootstrap5"===this.getTheme(this.sliderContainer),this.isFluent="FluentUI"===this.getTheme(this.sliderContainer),this.isMaterialTooltip=this.isMaterial&&"Range"!==this.type&&this.tooltip.isVisible},t.prototype.createRangeBar=function(){"Default"!==this.type&&(this.rangeBar=this.createElement("div",{attrs:{class:Ho.rangeBar}}),this.element.appendChild(this.rangeBar),this.drag&&"Range"===this.type&&("Horizontal"===this.orientation?this.rangeBar.classList.add(Ho.dragHorizontal):this.rangeBar.classList.add(Ho.dragVertical)))},t.prototype.createLimitBar=function(){var e="Range"!==this.type?Ho.limitBarDefault:Ho.limitBarFirst;e+=" "+Ho.limits,this.limitBarFirst=this.createElement("div",{attrs:{class:e}}),this.element.appendChild(this.limitBarFirst),"Range"===this.type&&(this.limitBarSecond=this.createElement("div",{attrs:{class:Ho.limitBarSecond+" "+Ho.limits}}),this.element.appendChild(this.limitBarSecond))},t.prototype.setOrientClass=function(){"Vertical"!==this.orientation?(this.sliderContainer.classList.remove(Ho.verticalSlider),this.sliderContainer.classList.add(Ho.horizontalSlider),this.firstHandle.setAttribute("aria-orientation","horizontal"),"Range"===this.type&&this.secondHandle.setAttribute("aria-orientation","horizontal")):(this.sliderContainer.classList.remove(Ho.horizontalSlider),this.sliderContainer.classList.add(Ho.verticalSlider),this.firstHandle.setAttribute("aria-orientation","vertical"),"Range"===this.type&&this.secondHandle.setAttribute("aria-orientation","vertical"))},t.prototype.setAriaAttributes=function(e){var t=this,i=this.min,n=this.max;if(!Object(w["T"])(this.customValues)&&this.customValues.length>0&&(i=this.customValues[0],n=this.customValues[this.customValues.length-1]),"Range"!==this.type)Object(w["w"])(e,{"aria-valuemin":i.toString(),"aria-valuemax":n.toString()});else{var r=!Object(w["T"])(this.customValues)&&this.customValues.length>0?[[i.toString(),this.customValues[this.value[1]].toString()],[this.customValues[this.value[0]].toString(),n.toString()]]:[[i.toString(),this.value[1].toString()],[this.value[0].toString(),n.toString()]];r.forEach(function(e,i){var n=0===i?t.firstHandle:t.secondHandle;n&&Object(w["w"])(n,{"aria-valuemin":e[0],"aria-valuemax":e[1]})})}},t.prototype.createSecondHandle=function(){this.secondHandle=this.createElement("div",{attrs:{class:Ho.sliderHandle,role:"slider",tabIndex:"0"}}),this.secondHandle.classList.add(Ho.sliderSecondHandle),this.element.appendChild(this.secondHandle)},t.prototype.createFirstHandle=function(){this.firstHandle=this.createElement("div",{attrs:{class:Ho.sliderHandle,role:"slider",tabIndex:"0"}}),this.firstHandle.classList.add(Ho.sliderFirstHandle),this.element.appendChild(this.firstHandle),this.isMaterialTooltip&&(this.materialHandle=this.createElement("div",{attrs:{class:Ho.sliderHandle+" "+Ho.sliderMaterialHandle}}),this.element.appendChild(this.materialHandle))},t.prototype.wireFirstHandleEvt=function(e){e?(w["l"].remove(this.firstHandle,"mousedown touchstart",this.handleFocus),w["l"].remove(this.firstHandle,"transitionend",this.transitionEnd),w["l"].remove(this.firstHandle,"mouseenter touchenter",this.handleOver),w["l"].remove(this.firstHandle,"mouseleave touchend",this.handleLeave)):(w["l"].add(this.firstHandle,"mousedown touchstart",this.handleFocus,this),w["l"].add(this.firstHandle,"transitionend",this.transitionEnd,this),w["l"].add(this.firstHandle,"mouseenter touchenter",this.handleOver,this),w["l"].add(this.firstHandle,"mouseleave touchend",this.handleLeave,this))},t.prototype.wireSecondHandleEvt=function(e){e?(w["l"].remove(this.secondHandle,"mousedown touchstart",this.handleFocus),w["l"].remove(this.secondHandle,"transitionend",this.transitionEnd),w["l"].remove(this.secondHandle,"mouseenter touchenter",this.handleOver),w["l"].remove(this.secondHandle,"mouseleave touchend",this.handleLeave)):(w["l"].add(this.secondHandle,"mousedown touchstart",this.handleFocus,this),w["l"].add(this.secondHandle,"transitionend",this.transitionEnd,this),w["l"].add(this.secondHandle,"mouseenter touchenter",this.handleOver,this),w["l"].add(this.secondHandle,"mouseleave touchend",this.handleLeave,this))},t.prototype.handleStart=function(){"Range"!==this.type&&(this.firstHandle.classList[0===this.handlePos1?"add":"remove"](Ho.sliderHandleStart),this.isMaterialTooltip&&(this.materialHandle.classList[0===this.handlePos1?"add":"remove"](Ho.sliderHandleStart),this.tooltipElement&&this.tooltipElement.classList[0===this.handlePos1?"add":"remove"](Ho.sliderTooltipStart)))},t.prototype.transitionEnd=function(e){"transform"!==e.propertyName&&(this.handleStart(),this.enableAnimation||(this.getHandle().style.transition="none"),"Default"!==this.type&&(this.rangeBar.style.transition="none"),this.isMaterial&&this.tooltip.isVisible&&"Default"===this.type&&(this.tooltipElement.style.transition=this.transition.handle),this.tooltipToggle(this.getHandle()),this.closeTooltip())},t.prototype.handleFocusOut=function(){this.firstHandle.classList.contains(Ho.sliderHandleFocused)&&this.firstHandle.classList.remove(Ho.sliderHandleFocused),"Range"===this.type&&this.secondHandle.classList.contains(Ho.sliderHandleFocused)&&this.secondHandle.classList.remove(Ho.sliderHandleFocused)},t.prototype.handleFocus=function(e){this.focusSliderElement(),this.sliderBarClick(e),e.currentTarget===this.firstHandle?(this.firstHandle.classList.add(Ho.sliderHandleFocused),this.firstHandle.classList.add(Ho.sliderTabHandle)):(this.secondHandle.classList.add(Ho.sliderHandleFocused),this.secondHandle.classList.add(Ho.sliderTabHandle)),w["l"].add(document,"mousemove touchmove",this.sliderBarMove,this),w["l"].add(document,"mouseup touchend",this.sliderBarUp,this)},t.prototype.handleOver=function(e){this.tooltip.isVisible&&"Hover"===this.tooltip.showOn&&this.tooltipToggle(e.currentTarget),"Default"===this.type&&this.tooltipToggle(this.getHandle())},t.prototype.handleLeave=function(e){!this.tooltip.isVisible||"Hover"!==this.tooltip.showOn||e.currentTarget.classList.contains(Ho.sliderHandleFocused)||e.currentTarget.classList.contains(Ho.sliderTabHandle)||this.closeTooltip()},t.prototype.setHandler=function(){this.min>this.max&&(this.min=this.max),this.createFirstHandle(),"Range"===this.type&&this.createSecondHandle()},t.prototype.setEnableRTL=function(){this.enableRtl&&"Vertical"!==this.orientation?Object(w["u"])([this.sliderContainer],Ho.rtl):Object(w["gb"])([this.sliderContainer],Ho.rtl);var e="Vertical"!==this.orientation?this.horDir:this.verDir;this.enableRtl?(this.horDir="right",this.verDir="bottom"):(this.horDir="left",this.verDir="bottom");var t="Vertical"!==this.orientation?this.horDir:this.verDir;e!==t&&"Horizontal"===this.orientation&&(Object(w["mb"])(this.firstHandle,{right:"",left:"auto"}),"Range"===this.type&&Object(w["mb"])(this.secondHandle,{top:"",left:"auto"})),this.setBarColor()},t.prototype.tooltipValue=function(){var e,t=this,i={value:this.value,text:""};this.initialTooltip&&(this.initialTooltip=!1,this.setTooltipContent(),i.text=e=this.tooltipObj.content,this.trigger("tooltipChange",i,function(i){t.addTooltipClass(i.text),e!==i.text&&(t.customAriaText=i.text,t.tooltipObj.content=i.text,t.setAriaAttrValue(t.firstHandle),"Range"===t.type&&t.setAriaAttrValue(t.secondHandle))}),this.isMaterialTooltip&&this.setPreviousVal("change",this.value))},t.prototype.setTooltipContent=function(){var e;e=this.formatContent(this.tooltipFormatInfo,!1),this.tooltipObj.content=e},t.prototype.formatContent=function(e,t){var i="",n=this.handleVal1,r=this.handleVal2;return!Object(w["T"])(this.customValues)&&this.customValues.length>0&&(n=this.customValues[this.handleVal1],r=this.customValues[this.handleVal2]),t?("Range"===this.type?i=this.enableRtl&&"Vertical"!==this.orientation?Object(w["T"])(this.tooltip)||Object(w["T"])(this.tooltip.format)?r.toString()+" - "+n.toString():this.formatString(r,e).elementVal+" - "+this.formatString(n,e).elementVal:Object(w["T"])(this.tooltip)||Object(w["T"])(this.tooltip.format)?n.toString()+" - "+r.toString():this.formatString(n,e).elementVal+" - "+this.formatString(r,e).elementVal:Object(w["T"])(n)||(i=Object(w["T"])(this.tooltip)||Object(w["T"])(this.tooltip.format)?n.toString():this.formatString(n,e).elementVal),i):("Range"===this.type?i=this.enableRtl&&"Vertical"!==this.orientation?Object(w["T"])(e.format)?r.toString()+" - "+n.toString():this.formatString(r,e).formatString+" - "+this.formatString(n,e).formatString:Object(w["T"])(e.format)?n.toString()+" - "+r.toString():this.formatString(n,e).formatString+" - "+this.formatString(r,e).formatString:Object(w["T"])(n)||(i=Object(w["T"])(e.format)?n.toString():this.formatString(n,e).formatString),i)},t.prototype.addTooltipClass=function(e){if(this.isMaterialTooltip){var t=e.toString().length;if(this.tooltipElement){i=t>4?{oldCss:Ho.sliderMaterialDefault,newCss:Ho.sliderMaterialRange}:{oldCss:Ho.sliderMaterialRange,newCss:Ho.sliderMaterialDefault};this.tooltipElement.classList.remove(i.oldCss),this.tooltipElement.classList.contains(i.newCss)||(this.tooltipElement.classList.add(i.newCss),this.tooltipElement.style.transform=t>4?"scale(1)":this.getTooltipTransformProperties(this.previousTooltipClass).rotate)}else{var i=t>4?Ho.sliderMaterialRange:Ho.sliderMaterialDefault;this.tooltipObj.cssClass=Ho.sliderTooltip+" "+i}}},t.prototype.tooltipPlacement=function(){return"Horizontal"===this.orientation?"Before"===this.tooltip.placement?"TopCenter":"BottomCenter":"Before"===this.tooltip.placement?"LeftCenter":"RightCenter"},t.prototype.tooltipBeforeOpen=function(e){this.tooltipElement=e.element,this.tooltip.cssClass&&Object(w["u"])([this.tooltipElement],this.tooltip.cssClass.split(" ").filter(function(e){return e})),e.target.removeAttribute("aria-describedby"),this.isMaterialTooltip&&(this.tooltipElement.firstElementChild.classList.add(Ho.materialTooltipHide),this.handleStart(),this.setTooltipTransform())},t.prototype.tooltipCollision=function(e){if(this.isBootstrap||this.isBootstrap4||this.isMaterial&&!this.isMaterialTooltip){var t=this.isBootstrap4?Fo:Bo;switch(e){case"TopCenter":this.tooltipObj.setProperties({offsetY:-t},!1);break;case"BottomCenter":this.tooltipObj.setProperties({offsetY:t},!1);break;case"LeftCenter":this.tooltipObj.setProperties({offsetX:-t},!1);break;case"RightCenter":this.tooltipObj.setProperties({offsetX:t},!1);break}}},t.prototype.materialTooltipEventCallBack=function(e){this.sliderBarClick(e),w["l"].add(document,"mousemove touchmove",this.sliderBarMove,this),w["l"].add(document,"mouseup touchend",this.sliderBarUp,this)},t.prototype.wireMaterialTooltipEvent=function(e){this.isMaterialTooltip&&(e?w["l"].remove(this.tooltipElement,"mousedown touchstart",this.materialTooltipEventCallBack):w["l"].add(this.tooltipElement,"mousedown touchstart",this.materialTooltipEventCallBack,this))},t.prototype.tooltipPositionCalculation=function(e){var t;switch(e){case"TopCenter":t=Ho.horizontalTooltipBefore;break;case"BottomCenter":t=Ho.horizontalTooltipAfter;break;case"LeftCenter":t=Ho.verticalTooltipBefore;break;case"RightCenter":t=Ho.verticalTooltipAfter;break}return t},t.prototype.getTooltipTransformProperties=function(e){var t;if(this.tooltipElement){var i="Horizontal"===this.orientation?this.tooltipElement.clientHeight+14-this.tooltipElement.clientHeight/2:this.tooltipElement.clientWidth+14-this.tooltipElement.clientWidth/2;t="Horizontal"===this.orientation?e===Ho.horizontalTooltipBefore?{rotate:"rotate(45deg)",translate:"translateY("+i+"px)"}:{rotate:"rotate(225deg)",translate:"translateY("+-i+"px)"}:e===Ho.verticalTooltipBefore?{rotate:"rotate(-45deg)",translate:"translateX("+i+"px)"}:{rotate:"rotate(-225deg)",translate:"translateX("+-i+"px)"}}return t},t.prototype.openMaterialTooltip=function(){var e=this;if(this.isMaterialTooltip){this.refreshTooltip(this.firstHandle);var t=this.tooltipElement.firstElementChild;t.classList.remove(Ho.materialTooltipHide),t.classList.add(Ho.materialTooltipShow),this.firstHandle.style.cursor="default",this.tooltipElement.style.transition=this.scaleTransform,this.tooltipElement.classList.add(Ho.materialTooltipOpen),this.materialHandle.style.transform="scale(0)",t.innerText.length>4?this.tooltipElement.style.transform="scale(1)":this.tooltipElement.style.transform=this.getTooltipTransformProperties(this.previousTooltipClass).rotate,"Default"===this.type?setTimeout(function(){e.tooltipElement.style.transition=e.transition.handle},2500):setTimeout(function(){e.tooltipElement.style.transition="none"},2500)}},t.prototype.closeMaterialTooltip=function(){var e=this;if(this.isMaterialTooltip){var t=this.tooltipElement.firstElementChild;this.tooltipElement.style.transition=this.scaleTransform,t.classList.remove(Ho.materialTooltipShow),t.classList.add(Ho.materialTooltipHide),this.firstHandle.style.cursor="-webkit-grab",this.firstHandle.style.cursor="grab",this.materialHandle&&(this.materialHandle.style.transform="scale(1)"),this.tooltipElement.classList.remove(Ho.materialTooltipOpen),this.setTooltipTransform(),this.tooltipTarget=void 0,setTimeout(function(){e.tooltipElement.style.transition="none"},2500)}},t.prototype.checkTooltipPosition=function(e){var t=this.tooltipPositionCalculation(e.collidedPosition);void 0!==this.tooltipCollidedPosition&&this.tooltipCollidedPosition===e.collidedPosition&&e.element.classList.contains(t)||(this.isMaterialTooltip&&(void 0!==t&&(e.element.classList.remove(this.previousTooltipClass),e.element.classList.add(t),this.previousTooltipClass=t),e.element.style.transform&&e.element.classList.contains(Ho.materialTooltipOpen)&&e.element.firstElementChild.innerText.length<=4&&(e.element.style.transform=this.getTooltipTransformProperties(this.previousTooltipClass).rotate)),this.tooltipCollidedPosition=e.collidedPosition),this.isMaterialTooltip&&this.tooltipElement&&-1!==this.tooltipElement.style.transform.indexOf("translate")&&this.setTooltipTransform()},t.prototype.setTooltipTransform=function(){var e=this.getTooltipTransformProperties(this.previousTooltipClass);this.tooltipElement.firstElementChild.innerText.length>4?this.tooltipElement.style.transform=e.translate+" scale(0.01)":this.tooltipElement.style.transform=e.translate+" "+e.rotate+" scale(0.01)"},t.prototype.renderTooltip=function(){this.tooltipObj=new Me["a"]({showTipPointer:this.isBootstrap||this.isMaterial||this.isBootstrap4||this.isTailwind||this.isBootstrap5||this.isFluent,cssClass:Ho.sliderTooltip,height:this.isMaterial?30:"auto",animation:{open:{effect:"None"},close:{effect:"FadeOut",duration:500}},opensOn:"Custom",beforeOpen:this.tooltipBeforeOpen.bind(this),beforeCollision:this.checkTooltipPosition.bind(this),beforeClose:this.tooltipBeforeClose.bind(this),enableHtmlSanitizer:this.enableHtmlSanitizer}),this.tooltipObj.appendTo(this.firstHandle),this.initializeTooltipProps()},t.prototype.initializeTooltipProps=function(){var e="Auto"===this.tooltip.showOn?"Hover":this.tooltip.showOn;this.setProperties({tooltip:{showOn:e}},!0),this.tooltipObj.position=this.tooltipPlacement(),this.tooltipCollision(this.tooltipObj.position),[this.firstHandle,this.rangeBar,this.secondHandle].forEach(function(e){Object(w["T"])(e)||(e.style.transition="none")}),this.isMaterialTooltip&&(this.sliderContainer.classList.add(Ho.materialSlider),this.tooltipValue(),this.tooltipObj.animation.close.effect="None",this.tooltipObj.open(this.firstHandle))},t.prototype.tooltipBeforeClose=function(){this.tooltipElement=void 0,this.tooltipCollidedPosition=void 0},t.prototype.setButtons=function(){this.firstBtn=this.createElement("div",{className:Ho.sliderButton+" "+Ho.firstButton}),this.firstBtn.appendChild(this.createElement("span",{className:Ho.sliderButtonIcon})),this.isTailwind&&this.firstBtn.querySelector("span").classList.add("e-icons"),this.firstBtn.tabIndex=-1,this.secondBtn=this.createElement("div",{className:Ho.sliderButton+" "+Ho.secondButton}),this.secondBtn.appendChild(this.createElement("span",{className:Ho.sliderButtonIcon})),this.isTailwind&&this.secondBtn.querySelector("span").classList.add("e-icons"),this.secondBtn.tabIndex=-1,this.sliderContainer.classList.add(Ho.sliderButtonClass),this.sliderContainer.appendChild(this.firstBtn),this.sliderContainer.appendChild(this.secondBtn),this.sliderContainer.appendChild(this.element),this.buttonTitle()},t.prototype.buttonTitle=function(){var e=this.enableRtl&&"Vertical"!==this.orientation;this.l10n.setLocale(this.locale);var t=this.l10n.getConstant("decrementTitle"),i=this.l10n.getConstant("incrementTitle");Object(w["w"])(e?this.secondBtn:this.firstBtn,{"aria-label":t,title:t}),Object(w["w"])(e?this.firstBtn:this.secondBtn,{"aria-label":i,title:i})},t.prototype.buttonFocusOut=function(){this.isMaterial&&this.getHandle().classList.remove("e-large-thumb-size")},t.prototype.repeatButton=function(e){var t,i=this.handleValueUpdate(),n=this.enableRtl&&"Vertical"!==this.orientation;e.target.parentElement.classList.contains(Ho.firstButton)||e.target.classList.contains(Ho.firstButton)?t=n?this.add(i,parseFloat(this.step.toString()),!0):this.add(i,parseFloat(this.step.toString()),!1):(e.target.parentElement.classList.contains(Ho.secondButton)||e.target.classList.contains(Ho.secondButton))&&(t=n?this.add(i,parseFloat(this.step.toString()),!1):this.add(i,parseFloat(this.step.toString()),!0)),this.limits.enabled&&(t=this.getLimitCorrectedValues(t)),t>=this.min&&t<=this.max&&(this.changeHandleValue(t),this.tooltipToggle(this.getHandle()))},t.prototype.repeatHandlerMouse=function(e){e.preventDefault(),"mousedown"!==e.type&&"touchstart"!==e.type||(this.buttonClick(e),this.repeatInterval=setInterval(this.repeatButton.bind(this),180,e))},t.prototype.materialChange=function(){this.getHandle().classList.contains("e-large-thumb-size")||this.getHandle().classList.add("e-large-thumb-size")},t.prototype.focusHandle=function(){this.getHandle().classList.contains(Ho.sliderTabHandle)||this.getHandle().classList.add(Ho.sliderTabHandle)},t.prototype.repeatHandlerUp=function(e){this.changeEvent("changed",e),this.closeTooltip(),clearInterval(this.repeatInterval),this.getHandle().focus()},t.prototype.customTickCounter=function(e){var t=4;return!Object(w["T"])(this.customValues)&&this.customValues.length>0&&(e>4&&(t=3),e>7&&(t=2),e>14&&(t=1),e>28&&(t=0)),t},t.prototype.renderScale=function(){var e="Vertical"===this.orientation?"v":"h";this.noOfDecimals=this.numberOfDecimals(this.step),this.ul=this.createElement("ul",{className:Ho.scale+" e-"+e+"-scale "+Ho.tick+"-"+this.ticks.placement.toLowerCase(),attrs:{role:"presentation",tabIndex:"-1","aria-hidden":"true"}}),this.ul.style.zIndex="-1",w["d"].isAndroid&&"h"===e&&this.ul.classList.add(Ho.sliderTickPosition);var t=this.ticks.smallStep;this.ticks.showSmallTicks?t<=0&&(t=parseFloat(Object(w["H"])(this.step))):t=this.ticks.largeStep>0?this.ticks.largeStep:parseFloat(Object(w["H"])(this.max))-parseFloat(Object(w["H"])(this.min));var i,n=this.fractionalToInteger(this.min),r=this.fractionalToInteger(this.max),s=this.fractionalToInteger(t),a=!Object(w["T"])(this.customValues)&&this.customValues.length>0&&this.customValues.length-1,o=this.customTickCounter(a),l=!Object(w["T"])(this.customValues)&&this.customValues.length>0?a*o+a:Math.abs((r-n)/s);this.element.appendChild(this.ul);var d=parseFloat(this.min.toString());"v"===e&&(d=parseFloat(this.max.toString()));var c,h=0,p=100/l;p===1/0&&(p=5);for(var u=0,m=!Object(w["T"])(this.customValues)&&this.customValues.length>0?this.customValues.length-1:0,g=0;u<=l;u++){if(i=this.createElement("li",{attrs:{class:Ho.tick,role:"presentation",tabIndex:"-1","aria-hidden":"true"}}),!Object(w["T"])(this.customValues)&&this.customValues.length>0)c=u%(o+1)===0,c&&("h"===e?(d=this.customValues[g],g++):(d=this.customValues[m],m--),i.setAttribute("title",d.toString()));else if(i.setAttribute("title",d.toString()),0===this.numberOfDecimals(this.max)&&0===this.numberOfDecimals(this.min)&&0===this.numberOfDecimals(this.step))c="h"===e?(d-parseFloat(this.min.toString()))%this.ticks.largeStep===0:Math.abs(d-parseFloat(this.max.toString()))%this.ticks.largeStep===0;else{var f=this.fractionalToInteger(this.ticks.largeStep),b=this.fractionalToInteger(d);c="h"===e?(b-n)%f===0:Math.abs(b-parseFloat(r.toString()))%f===0}c&&i.classList.add(Ho.large),"h"===e?i.style.width=p+"%":i.style.height=p+"%";var v=c?"Both"===this.ticks.placement?2:1:0;if(c)for(var y=0;y<v;y++)this.createTick(i,d,p);else Object(w["T"])(this.customValues)&&this.formatTicksValue(i,d);this.ul.appendChild(i),this.tickElementCollection.push(i);var C=void 0;Object(w["T"])(this.customValues)&&(C=this.numberOfDecimals(t)>this.numberOfDecimals(d)?this.numberOfDecimals(t):this.numberOfDecimals(d),d="h"===e?this.makeRoundNumber(d+t,C):this.makeRoundNumber(d-t,C),h=this.makeRoundNumber(h+t,C))}this.ticksAlignment(e,p)},t.prototype.ticksAlignment=function(e,t,i){void 0===i&&(i=!0),this.firstChild=this.ul.firstElementChild,this.lastChild=this.ul.lastElementChild,this.firstChild.classList.add(Ho.sliderFirstTick),this.lastChild.classList.add(Ho.sliderLastTick),this.sliderContainer.classList.add(Ho.scale+"-"+this.ticks.placement.toLowerCase()),"h"===e?(this.firstChild.style.width=t/2+"%",this.lastChild.style.width=t/2+"%"):(this.firstChild.style.height=t/2+"%",this.lastChild.style.height=t/2+"%");var n={ticksWrapper:this.ul,tickElements:this.tickElementCollection};i&&this.trigger("renderedTicks",n),this.scaleAlignment()},t.prototype.createTick=function(e,t,i){var n=this.createElement("span",{className:Ho.tickValue+" "+Ho.tick+"-"+this.ticks.placement.toLowerCase(),attrs:{role:"presentation",tabIndex:"-1","aria-hidden":"true"}});e.appendChild(n),Object(w["T"])(this.customValues)?this.formatTicksValue(e,t,n,i):this.enableHtmlSanitizer?n.innerHTML=w["s"].sanitize(t.toString()):n.innerHTML=t.toString()},t.prototype.formatTicksValue=function(e,t,i,n){var r=this,s=this.formatNumber(t),a=Object(w["T"])(this.ticks)||Object(w["T"])(this.ticks.format)?s:this.formatString(t,this.ticksFormatInfo).formatString,o={value:t,text:a,tickElement:e};this.trigger("renderingTicks",o,function(t){e.setAttribute("title",t.text.toString()),i&&(r.enableHtmlSanitizer?i.innerHTML=w["s"].sanitize(t.text.toString()):i.innerHTML=t.text.toString())})},t.prototype.scaleAlignment=function(){this.tickValuePosition();this.orientation;"Vertical"===this.orientation?this.element.getBoundingClientRect().width<=15?this.sliderContainer.classList.add(Ho.sliderSmallSize):this.sliderContainer.classList.remove(Ho.sliderSmallSize):this.element.getBoundingClientRect().height<=15?this.sliderContainer.classList.add(Ho.sliderSmallSize):this.sliderContainer.classList.remove(Ho.sliderSmallSize)},t.prototype.tickValuePosition=function(){this.firstChild=this.element.querySelector("ul").children[0];var e,t,i=this.firstChild.getBoundingClientRect(),n=this.ticks.smallStep,r=Math.abs(parseFloat(Object(w["H"])(this.max))-parseFloat(Object(w["H"])(this.min)))/n;this.firstChild.children.length>0&&(e=this.firstChild.children[0].getBoundingClientRect());var s,a=[this.sliderContainer.querySelectorAll("."+Ho.tick+"."+Ho.large+" ."+Ho.tickValue)];s="Both"===this.ticks.placement?[].slice.call(a[0],2):[].slice.call(a[0],1);for(var o="Vertical"===this.orientation?2*i.height:2*i.width,l=0;l<this.firstChild.children.length;l++)"Vertical"===this.orientation?this.firstChild.children[l].style.top=-e.height/2+"px":this.enableRtl?this.firstChild.children[l].style.left=(o-this.firstChild.children[l].getBoundingClientRect().width)/2+"px":this.firstChild.children[l].style.left=-e.width/2+"px";for(l=0;l<s.length;l++)t=s[l].getBoundingClientRect(),"Vertical"===this.orientation?Object(w["mb"])(s[l],{top:(o-t.height)/2+"px"}):Object(w["mb"])(s[l],{left:(o-t.width)/2+"px"});this.enableRtl&&this.lastChild.children.length&&0!==r&&(this.lastChild.children[0].style.left=-this.lastChild.getBoundingClientRect().width/2+"px","Both"===this.ticks.placement&&(this.lastChild.children[1].style.left=-this.lastChild.getBoundingClientRect().width/2+"px")),0===r&&("Horizontal"===this.orientation&&(this.enableRtl?(this.firstChild.classList.remove(Ho.sliderLastTick),this.firstChild.style.right=this.firstHandle.style.right,this.firstChild.children[0].style.left=this.firstChild.getBoundingClientRect().width/2+2+"px","Both"===this.ticks.placement&&(this.firstChild.children[1].style.left=this.firstChild.getBoundingClientRect().width/2+2+"px")):(this.firstChild.classList.remove(Ho.sliderLastTick),this.firstChild.style.left=this.firstHandle.style.left)),"Vertical"===this.orientation&&this.firstChild.classList.remove(Ho.sliderLastTick))},t.prototype.setAriaAttrValue=function(e){var t,i=!Object(w["T"])(this.ticks)&&!Object(w["T"])(this.ticks.format),n=i?this.formatContent(this.tooltipFormatInfo,!1):this.formatContent(this.ticksFormatInfo,!1),r=i?this.formatContent(this.ticksFormatInfo,!0):this.formatContent(this.tooltipFormatInfo,!0);n=this.customAriaText?this.customAriaText:n,t=2===n.split(" - ").length?n.split(" - "):[n,n],this.setAriaAttributes(e),"Range"!==this.type?Object(w["w"])(e,{"aria-valuenow":r,"aria-valuetext":n}):this.enableRtl?e===this.firstHandle?Object(w["w"])(e,{"aria-valuenow":r.split(" - ")[1],"aria-valuetext":t[1]}):Object(w["w"])(e,{"aria-valuenow":r.split(" - ")[0],"aria-valuetext":t[0]}):e===this.firstHandle?Object(w["w"])(e,{"aria-valuenow":r.split(" - ")[0],"aria-valuetext":t[0]}):Object(w["w"])(e,{"aria-valuenow":r.split(" - ")[1],"aria-valuetext":t[1]})},t.prototype.handleValueUpdate=function(){var e;return e="Range"===this.type?1===this.activeHandle?this.handleVal1:this.handleVal2:this.handleVal1,e},t.prototype.getLimitCorrectedValues=function(e){return e="MinRange"===this.type||"Default"===this.type?this.getLimitValueAndPosition(e,this.limits.minStart,this.limits.minEnd)[0]:1===this.activeHandle?this.getLimitValueAndPosition(e,this.limits.minStart,this.limits.minEnd)[0]:this.getLimitValueAndPosition(e,this.limits.maxStart,this.limits.maxEnd)[0],e},t.prototype.focusSliderElement=function(){this.isElementFocused||(this.element.focus(),this.isElementFocused=!0)},t.prototype.buttonClick=function(e){var t;this.focusSliderElement();var i=this.enableRtl&&"Vertical"!==this.orientation,n=this.handleValueUpdate();40===e.keyCode||37===e.keyCode||e.currentTarget.classList.contains(Ho.firstButton)?t=i?this.add(n,parseFloat(this.step.toString()),!0):this.add(n,parseFloat(this.step.toString()),!1):38===e.keyCode||39===e.keyCode||e.currentTarget.classList.contains(Ho.secondButton)?t=i?this.add(n,parseFloat(this.step.toString()),!1):this.add(n,parseFloat(this.step.toString()),!0):33===e.keyCode||e.currentTarget.classList.contains(Ho.firstButton)?t=i?this.add(n,parseFloat(this.ticks.largeStep.toString()),!1):this.add(n,parseFloat(this.ticks.largeStep.toString()),!0):34===e.keyCode||e.currentTarget.classList.contains(Ho.secondButton)?t=i?this.add(n,parseFloat(this.ticks.largeStep.toString()),!0):this.add(n,parseFloat(this.ticks.largeStep.toString()),!1):36===e.keyCode?t=parseFloat(this.min.toString()):35===e.keyCode&&(t=parseFloat(this.max.toString())),this.limits.enabled&&(t=this.getLimitCorrectedValues(t)),this.changeHandleValue(t),!this.isMaterial||this.tooltip.isVisible||this.getHandle().classList.contains(Ho.sliderTabHandle)||this.materialChange(),this.tooltipToggle(this.getHandle()),this.getHandle().focus(),this.focusHandle(),e.currentTarget.classList.contains(Ho.firstButton)&&w["l"].add(this.firstBtn,"mouseup touchend",this.buttonUp,this),e.currentTarget.classList.contains(Ho.secondButton)&&w["l"].add(this.secondBtn,"mouseup touchend",this.buttonUp,this)},t.prototype.tooltipToggle=function(e){this.isMaterialTooltip?this.tooltipElement.classList.contains(Ho.materialTooltipOpen)?this.refreshTooltip(this.firstHandle):this.openMaterialTooltip():this.tooltipElement?this.refreshTooltip(e):this.openTooltip(e)},t.prototype.buttonUp=function(e){e.currentTarget.classList.contains(Ho.firstButton)&&w["l"].remove(this.firstBtn,"mouseup touchend",this.buttonUp),e.currentTarget.classList.contains(Ho.secondButton)&&w["l"].remove(this.secondBtn,"mouseup touchend",this.buttonUp)},t.prototype.setRangeBar=function(){"Horizontal"===this.orientation?"MinRange"===this.type?(this.enableRtl?this.rangeBar.style.right="0px":this.rangeBar.style.left="0px",Object(w["mb"])(this.rangeBar,{width:Object(w["T"])(this.handlePos1)?0:this.handlePos1+"px"})):(this.enableRtl?this.rangeBar.style.right=this.handlePos1+"px":this.rangeBar.style.left=this.handlePos1+"px",Object(w["mb"])(this.rangeBar,{width:this.handlePos2-this.handlePos1+"px"})):"MinRange"===this.type?(this.rangeBar.style.bottom="0px",Object(w["mb"])(this.rangeBar,{height:Object(w["T"])(this.handlePos1)?0:this.handlePos1+"px"})):(this.rangeBar.style.bottom=this.handlePos1+"px",Object(w["mb"])(this.rangeBar,{height:this.handlePos2-this.handlePos1+"px"}))},t.prototype.checkValidValueAndPos=function(e){return e=this.checkHandleValue(e),e=this.checkHandlePosition(e),e},t.prototype.setLimitBarPositions=function(e,t,i,n){"Horizontal"===this.orientation?this.enableRtl?(this.limitBarFirst.style.right=e+"px",this.limitBarFirst.style.width=t-e+"px"):(this.limitBarFirst.style.left=e+"px",this.limitBarFirst.style.width=t-e+"px"):(this.limitBarFirst.style.bottom=e+"px",this.limitBarFirst.style.height=t-e+"px"),"Range"===this.type&&("Horizontal"===this.orientation?this.enableRtl?(this.limitBarSecond.style.right=i+"px",this.limitBarSecond.style.width=n-i+"px"):(this.limitBarSecond.style.left=i+"px",this.limitBarSecond.style.width=n-i+"px"):(this.limitBarSecond.style.bottom=i+"px",this.limitBarSecond.style.height=n-i+"px"))},t.prototype.setLimitBar=function(){if("Default"===this.type||"MinRange"===this.type){var e=this.getLimitValueAndPosition(this.limits.minStart,this.limits.minStart,this.limits.minEnd,!0)[0];e=this.checkValidValueAndPos(e);var t=this.getLimitValueAndPosition(this.limits.minEnd,this.limits.minStart,this.limits.minEnd,!0)[0];t=this.checkValidValueAndPos(t),this.setLimitBarPositions(e,t)}else if("Range"===this.type){var i=this.getLimitValueAndPosition(this.limits.minStart,this.limits.minStart,this.limits.minEnd,!0)[0];i=this.checkValidValueAndPos(i);var n=this.getLimitValueAndPosition(this.limits.minEnd,this.limits.minStart,this.limits.minEnd,!0)[0];n=this.checkValidValueAndPos(n);var r=this.getLimitValueAndPosition(this.limits.maxStart,this.limits.maxStart,this.limits.maxEnd,!0)[0];r=this.checkValidValueAndPos(r);var s=this.getLimitValueAndPosition(this.limits.maxEnd,this.limits.maxStart,this.limits.maxEnd,!0)[0];s=this.checkValidValueAndPos(s),this.setLimitBarPositions(i,n,r,s)}},t.prototype.getLimitValueAndPosition=function(e,t,i,n){return Object(w["T"])(t)&&(t=this.min,Object(w["T"])(e)&&n&&(e=t)),Object(w["T"])(i)&&(i=this.max,Object(w["T"])(e)&&n&&(e=i)),e<t&&(e=t),e>i&&(e=i),[e,this.checkHandlePosition(e)]},t.prototype.setValue=function(){if(!Object(w["T"])(this.customValues)&&this.customValues.length>0&&(this.min=0,this.max=this.customValues.length-1,this.setBarColor()),this.setAriaAttributes(this.firstHandle),this.handleVal1=Object(w["T"])(this.value)?this.checkHandleValue(parseFloat(this.min.toString())):this.checkHandleValue(parseFloat(this.value.toString())),this.handlePos1=this.checkHandlePosition(this.handleVal1),this.preHandlePos1=this.handlePos1,Object(w["T"])(this.activeHandle)?"Range"===this.type?this.activeHandle=2:this.activeHandle=1:this.activeHandle=this.activeHandle,"Default"===this.type||"MinRange"===this.type){if(this.limits.enabled){var e=this.getLimitValueAndPosition(this.handleVal1,this.limits.minStart,this.limits.minEnd);this.handleVal1=e[0],this.handlePos1=e[1],this.preHandlePos1=this.handlePos1}this.setHandlePosition(null),this.handleStart(),this.value=this.handleVal1,this.setAriaAttrValue(this.firstHandle),this.changeEvent("changed",null)}else this.validateRangeValue();"Default"!==this.type&&this.setRangeBar(),this.limits.enabled&&this.setLimitBar()},t.prototype.rangeValueUpdate=function(){null!==this.value&&"object"===typeof this.value||(this.value=[parseFloat(Object(w["H"])(this.min)),parseFloat(Object(w["H"])(this.max))])},t.prototype.validateRangeValue=function(){this.rangeValueUpdate(),this.setRangeValue()},t.prototype.modifyZindex=function(){"Range"===this.type?1===this.activeHandle?(this.firstHandle.style.zIndex=this.zIndex+4+"",this.secondHandle.style.zIndex=this.zIndex+3+""):(this.firstHandle.style.zIndex=this.zIndex+3+"",this.secondHandle.style.zIndex=this.zIndex+4+""):this.isMaterialTooltip&&this.tooltipElement&&(this.tooltipElement.style.zIndex=Object(Vt["d"])(this.element)+"")},t.prototype.setHandlePosition=function(e){var t,i=this,n=1===this.activeHandle?this.handlePos1:this.handlePos2;t=this.isMaterialTooltip?[this.firstHandle,this.materialHandle]:[this.getHandle()],this.handleStart(),t.forEach(function(e){"Horizontal"===i.orientation?i.enableRtl?e.style.right=n+"px":e.style.left=n+"px":e.style.bottom=n+"px"}),this.changeEvent("change",e)},t.prototype.getHandle=function(){return 1===this.activeHandle?this.firstHandle:this.secondHandle},t.prototype.setRangeValue=function(){this.updateRangeValue(),this.activeHandle=1,this.setHandlePosition(null),this.activeHandle=2,this.setHandlePosition(null),this.activeHandle=1},t.prototype.changeEvent=function(e,t){var i="change"===e?this.previousVal:this.previousChanged;if("Range"!==this.type)this.setProperties({value:this.handleVal1},!0),i===this.value||this.isMaterialTooltip&&this.initialTooltip||(this.trigger(e,this.changeEventArgs(e,t)),this.initialTooltip=!0,this.setPreviousVal(e,this.value)),this.setAriaAttrValue(this.firstHandle);else{var n=this.value=[this.handleVal1,this.handleVal2];this.setProperties({value:n},!0),(i.length===this.value.length&&this.value[0]!==i[0]||this.value[1]!==i[1])&&(this.initialTooltip=!1,this.trigger(e,this.changeEventArgs(e,t)),this.initialTooltip=!0,this.setPreviousVal(e,this.value)),this.setAriaAttrValue(this.getHandle())}this.hiddenInput.value=this.value.toString()},t.prototype.changeEventArgs=function(e,t){var i;return this.tooltip.isVisible&&this.tooltipObj&&this.initialTooltip?(this.tooltipValue(),i={value:this.value,previousValue:"change"===e?this.previousVal:this.previousChanged,action:e,text:this.tooltipObj.content,isInteracted:!Object(w["T"])(t)}):i={value:this.value,previousValue:"change"===e?this.previousVal:this.previousChanged,action:e,text:Object(w["T"])(this.ticksFormatInfo.format)?this.value.toString():"Range"!==this.type?this.formatString(this.value,this.ticksFormatInfo).formatString:this.formatString(this.value[0],this.ticksFormatInfo).formatString+" - "+this.formatString(this.value[1],this.ticksFormatInfo).formatString,isInteracted:!Object(w["T"])(t)},i},t.prototype.setPreviousVal=function(e,t){"change"===e?this.previousVal=t:this.previousChanged=t},t.prototype.updateRangeValue=function(){var e=this.value.toString().split(",").map(Number);if(this.enableRtl&&"Vertical"!==this.orientation||this.rtl?this.value=[e[1],e[0]]:this.value=[e[0],e[1]],this.enableRtl&&"Vertical"!==this.orientation?(this.handleVal1=this.checkHandleValue(this.value[1]),this.handleVal2=this.checkHandleValue(this.value[0])):(this.handleVal1=this.checkHandleValue(this.value[0]),this.handleVal2=this.checkHandleValue(this.value[1])),this.handlePos1=this.checkHandlePosition(this.handleVal1),this.handlePos2=this.checkHandlePosition(this.handleVal2),this.handlePos1>this.handlePos2&&(this.handlePos1=this.handlePos2,this.handleVal1=this.handleVal2),this.preHandlePos1=this.handlePos1,this.preHandlePos2=this.handlePos2,this.limits.enabled){this.activeHandle=1;var t=this.getLimitValueAndPosition(this.handleVal1,this.limits.minStart,this.limits.minEnd);this.handleVal1=t[0],this.handlePos1=t[1],this.preHandlePos1=this.handlePos1,this.activeHandle=2,t=this.getLimitValueAndPosition(this.handleVal2,this.limits.maxStart,this.limits.maxEnd),this.handleVal2=t[0],this.handlePos2=t[1],this.preHandlePos2=this.handlePos2}},t.prototype.checkHandlePosition=function(e){var t;return e=100*(e-parseFloat(Object(w["H"])(this.min)))/(parseFloat(Object(w["H"])(this.max))-parseFloat(Object(w["H"])(this.min))),t="Horizontal"===this.orientation?this.element.getBoundingClientRect().width*(e/100):this.element.getBoundingClientRect().height*(e/100),parseFloat(Object(w["H"])(this.max))===parseFloat(Object(w["H"])(this.min))&&(t="Horizontal"===this.orientation?this.element.getBoundingClientRect().width:this.element.getBoundingClientRect().height),t},t.prototype.checkHandleValue=function(e){if(this.min>this.max&&(this.min=this.max),this.min===this.max)return parseFloat(Object(w["H"])(this.max));var t=this.tempStartEnd();return e<t.start?e=t.start:e>t.end&&(e=t.end),e},t.prototype.reposition=function(){var e=this;this.firstHandle.style.transition="none","Default"!==this.type&&(this.rangeBar.style.transition="none"),"Range"===this.type&&(this.secondHandle.style.transition="none"),this.handlePos1=this.checkHandlePosition(this.handleVal1),this.handleVal2&&(this.handlePos2=this.checkHandlePosition(this.handleVal2)),"Horizontal"===this.orientation?(this.enableRtl?this.firstHandle.style.right=this.handlePos1+"px":this.firstHandle.style.left=this.handlePos1+"px",this.isMaterialTooltip&&(this.enableRtl?this.materialHandle.style.right=this.handlePos1+"px":this.materialHandle.style.left=this.handlePos1+"px"),"MinRange"===this.type?(this.enableRtl?this.rangeBar.style.right="0px":this.rangeBar.style.left="0px",Object(w["mb"])(this.rangeBar,{width:Object(w["T"])(this.handlePos1)?0:this.handlePos1+"px"})):"Range"===this.type&&(this.enableRtl?this.secondHandle.style.right=this.handlePos2+"px":this.secondHandle.style.left=this.handlePos2+"px",this.enableRtl?this.rangeBar.style.right=this.handlePos1+"px":this.rangeBar.style.left=this.handlePos1+"px",Object(w["mb"])(this.rangeBar,{width:this.handlePos2-this.handlePos1+"px"}))):(this.firstHandle.style.bottom=this.handlePos1+"px",this.isMaterialTooltip&&(this.materialHandle.style.bottom=this.handlePos1+"px"),"MinRange"===this.type?(this.rangeBar.style.bottom="0px",Object(w["mb"])(this.rangeBar,{height:Object(w["T"])(this.handlePos1)?0:this.handlePos1+"px"})):"Range"===this.type&&(this.secondHandle.style.bottom=this.handlePos2+"px",this.rangeBar.style.bottom=this.handlePos1+"px",Object(w["mb"])(this.rangeBar,{height:this.handlePos2-this.handlePos1+"px"}))),this.limits.enabled&&this.setLimitBar(),"None"!==this.ticks.placement&&this.ul&&(this.removeElement(this.ul),this.ul=void 0,this.renderScale()),this.handleStart(),this.tooltip.isVisible||setTimeout(function(){e.firstHandle.style.transition=e.scaleTransform,"Range"===e.type&&(e.secondHandle.style.transition=e.scaleTransform)}),this.refreshTooltip(this.tooltipTarget),this.setBarColor()},t.prototype.changeHandleValue=function(e){var t=null;1===this.activeHandle?(this.limits.enabled&&this.limits.startHandleFixed||(this.handleVal1=this.checkHandleValue(e),this.handlePos1=this.checkHandlePosition(this.handleVal1),"Range"===this.type&&this.handlePos1>this.handlePos2&&(this.handlePos1=this.handlePos2,this.handleVal1=this.handleVal2),this.handlePos1!==this.preHandlePos1&&(t=this.preHandlePos1=this.handlePos1)),this.modifyZindex()):(this.limits.enabled&&this.limits.endHandleFixed||(this.handleVal2=this.checkHandleValue(e),this.handlePos2=this.checkHandlePosition(this.handleVal2),"Range"===this.type&&this.handlePos2<this.handlePos1&&(this.handlePos2=this.handlePos1,this.handleVal2=this.handleVal1),this.handlePos2!==this.preHandlePos2&&(t=this.preHandlePos2=this.handlePos2)),this.modifyZindex()),null!==t&&("Default"!==this.type&&this.setRangeBar(),this.setHandlePosition(null))},t.prototype.tempStartEnd=function(){return this.min>this.max?{start:this.max,end:this.min}:{start:this.min,end:this.max}},t.prototype.xyToPosition=function(e){var t;if(this.min===this.max)return 100;if("Horizontal"===this.orientation){var i=e.x-this.element.getBoundingClientRect().left,n=this.element.offsetWidth/100;this.val=i/n}else{var r=e.y-this.element.getBoundingClientRect().top;n=this.element.offsetHeight/100;this.val=100-r/n}var s=this.stepValueCalculation(this.val);return s<0?s=0:s>100&&(s=100),this.enableRtl&&"Vertical"!==this.orientation&&(s=100-s),t="Horizontal"===this.orientation?this.element.getBoundingClientRect().width*(s/100):this.element.getBoundingClientRect().height*(s/100),t},t.prototype.stepValueCalculation=function(e){0===this.step&&(this.step=1);var t=parseFloat(Object(w["H"])(this.step))/((parseFloat(Object(w["H"])(this.max))-parseFloat(Object(w["H"])(this.min)))/100),i=e%Math.abs(t);return 0!==i&&(t/2>i?e-=i:e+=Math.abs(t)-i),e},t.prototype.add=function(e,t,i){var n,r,s=Math.pow(10,n||3);return r=i?(Math.round(e*s)+Math.round(t*s))/s:(Math.round(e*s)-Math.round(t*s))/s,r},t.prototype.positionToValue=function(e){var t,i=parseFloat(Object(w["H"])(this.max))-parseFloat(Object(w["H"])(this.min));t="Horizontal"===this.orientation?e/this.element.getBoundingClientRect().width*i:e/this.element.getBoundingClientRect().height*i;var n=this.add(t,parseFloat(this.min.toString()),!0);return n},t.prototype.sliderBarClick=function(e){var t;e.preventDefault(),"mousedown"===e.type||"mouseup"===e.type||"click"===e.type?t={x:e.clientX,y:e.clientY}:"touchend"!==e.type&&"touchstart"!==e.type||(t={x:e.changedTouches[0].clientX,y:e.changedTouches[0].clientY});var i=this.xyToPosition(t),n=this.positionToValue(i);if("Range"===this.type&&this.handlePos2-i<i-this.handlePos1){if(this.activeHandle=2,!this.limits.enabled||!this.limits.endHandleFixed){if(this.limits.enabled){var r=this.getLimitValueAndPosition(n,this.limits.maxStart,this.limits.maxEnd);n=r[0],i=r[1]}this.secondHandle.classList.add(Ho.sliderActiveHandle),this.handlePos2=this.preHandlePos2=i,this.handleVal2=n}this.modifyZindex(),this.secondHandle.focus()}else{if(this.activeHandle=1,!this.limits.enabled||!this.limits.startHandleFixed){if(this.limits.enabled){r=this.getLimitValueAndPosition(n,this.limits.minStart,this.limits.minEnd);n=r[0],i=r[1]}this.firstHandle.classList.add(Ho.sliderActiveHandle),this.handlePos1=this.preHandlePos1=i,this.handleVal1=n}this.modifyZindex(),this.firstHandle.focus()}this.isMaterialTooltip&&this.tooltipElement.classList.add(Ho.materialTooltipActive);var s=this.element.querySelector("."+Ho.sliderTabHandle);s&&this.getHandle()!==s&&s.classList.remove(Ho.sliderTabHandle);var a=1===this.activeHandle?this.firstHandle:this.secondHandle;if(e.target===a)return!this.isMaterial||this.tooltip.isVisible||this.getHandle().classList.contains(Ho.sliderTabHandle)||this.materialChange(),this.sliderBarUp(e),void this.tooltipToggle(this.getHandle());if(this.checkRepeatedValue(n)){var o=this.isMaterial&&this.tooltip.isVisible?this.transitionOnMaterialTooltip:this.transition;this.getHandle().style.transition=o.handle,"Default"!==this.type&&(this.rangeBar.style.transition=o.rangeBar),this.setHandlePosition(e),this.isMaterialTooltip&&(this.initialTooltip=!1),this.changeEvent("changed",e),"Default"!==this.type&&this.setRangeBar()}},t.prototype.handleValueAdjust=function(e,t,i){1===i?(this.handleVal1=t,this.handleVal2=this.handleVal1+this.minDiff):2===i&&(this.handleVal2=t,this.handleVal1=this.handleVal2-this.minDiff),this.handlePos1=this.checkHandlePosition(this.handleVal1),this.handlePos2=this.checkHandlePosition(this.handleVal2)},t.prototype.dragRangeBarMove=function(e){var t,i,n,r,s;if("touchmove"!==e.type&&e.preventDefault(),this.rangeBarDragged=!0,this.rangeBar.style.transition="none",this.firstHandle.style.transition="none",this.secondHandle.style.transition="none","mousemove"===e.type?(t=[e.clientX,e.clientY],r=t[0],s=t[1]):(i=[e.changedTouches[0].clientX,e.changedTouches[0].clientY],r=i[0],s=i[1]),(!this.limits.enabled||!this.limits.startHandleFixed)&&(!this.limits.enabled||!this.limits.endHandleFixed)){if(n=this.enableRtl?{x:r+this.secondPartRemain,y:s+this.secondPartRemain}:{x:r-this.firstPartRemain,y:s+this.secondPartRemain},this.handlePos1=this.xyToPosition(n),this.handleVal1=this.positionToValue(this.handlePos1),n=this.enableRtl?{x:r-this.firstPartRemain,y:s-this.firstPartRemain}:{x:r+this.secondPartRemain,y:s-this.firstPartRemain},this.handlePos2=this.xyToPosition(n),this.handleVal2=this.positionToValue(this.handlePos2),this.limits.enabled){var a=this.getLimitValueAndPosition(this.handleVal1,this.limits.minStart,this.limits.minEnd);this.handleVal1=a[0],this.handlePos1=a[1],this.handleVal1===this.limits.minEnd&&this.handleValueAdjust(this.handleVal1,this.limits.minEnd,1),this.handleVal1===this.limits.minStart&&this.handleValueAdjust(this.handleVal1,this.limits.minStart,1),a=this.getLimitValueAndPosition(this.handleVal2,this.limits.maxStart,this.limits.maxEnd),this.handleVal2=a[0],this.handlePos2=a[1],this.handleVal2===this.limits.maxStart&&this.handleValueAdjust(this.handleVal2,this.limits.maxStart,2),this.handleVal2===this.limits.maxEnd&&this.handleValueAdjust(this.handleVal2,this.limits.maxEnd,2)}this.handleVal2===this.max&&this.handleValueAdjust(this.handleVal2,this.max,2),this.handleVal1===this.min&&this.handleValueAdjust(this.handleVal1,this.min,1)}this.activeHandle=1,this.setHandlePosition(e),this.activeHandle=2,this.setHandlePosition(e),this.tooltipToggle(this.rangeBar),this.setRangeBar()},t.prototype.sliderBarUp=function(e){this.changeEvent("changed",e),this.handleFocusOut(),this.firstHandle.classList.remove(Ho.sliderActiveHandle),"Range"===this.type&&(this.initialTooltip=!1,this.secondHandle.classList.remove(Ho.sliderActiveHandle)),this.closeTooltip(),this.isMaterial&&(this.getHandle().classList.remove("e-large-thumb-size"),this.isMaterialTooltip&&this.tooltipElement.classList.remove(Ho.materialTooltipActive)),w["l"].remove(document,"mousemove touchmove",this.sliderBarMove),w["l"].remove(document,"mouseup touchend",this.sliderBarUp)},t.prototype.sliderBarMove=function(e){var t;"touchmove"!==e.type&&e.preventDefault(),t="mousemove"===e.type?{x:e.clientX,y:e.clientY}:{x:e.changedTouches[0].clientX,y:e.changedTouches[0].clientY};var i=this.xyToPosition(t),n=this.positionToValue(i);if(i=Math.round(i),"Range"!==this.type&&1===this.activeHandle){if(!this.limits.enabled||!this.limits.startHandleFixed){if(this.limits.enabled){var r=this.getLimitValueAndPosition(n,this.limits.minStart,this.limits.minEnd);i=r[1],n=r[0]}this.handlePos1=i,this.handleVal1=n}this.firstHandle.classList.add(Ho.sliderActiveHandle)}if("Range"===this.type)if(1===this.activeHandle){if(this.firstHandle.classList.add(Ho.sliderActiveHandle),(!this.limits.enabled||!this.limits.startHandleFixed)&&(i>this.handlePos2&&(i=this.handlePos2,n=this.handleVal2),i!==this.preHandlePos1)){if(this.limits.enabled){var s=this.getLimitValueAndPosition(n,this.limits.minStart,this.limits.minEnd);n=s[0],i=s[1]}this.handlePos1=this.preHandlePos1=i,this.handleVal1=n,this.activeHandle=1}}else if(2===this.activeHandle&&(this.secondHandle.classList.add(Ho.sliderActiveHandle),(!this.limits.enabled||!this.limits.endHandleFixed)&&(i<this.handlePos1&&(i=this.handlePos1,n=this.handleVal1),i!==this.preHandlePos2))){if(this.limits.enabled){s=this.getLimitValueAndPosition(n,this.limits.maxStart,this.limits.maxEnd);n=s[0],i=s[1]}this.handlePos2=this.preHandlePos2=i,this.handleVal2=n,this.activeHandle=2}this.checkRepeatedValue(n)&&(this.getHandle().style.transition=this.scaleTransform,"Default"!==this.type&&(this.rangeBar.style.transition="none"),this.setHandlePosition(e),!this.isMaterial||this.tooltip.isVisible||this.getHandle().classList.contains(Ho.sliderTabHandle)||this.materialChange(),this.tooltipToggle(this.getHandle()),"Default"!==this.type&&this.setRangeBar())},t.prototype.dragRangeBarUp=function(e){this.rangeBarDragged?this.isDragComplete=!0:(this.focusSliderElement(),this.sliderBarClick(e)),this.changeEvent("changed",e),this.closeTooltip(),w["l"].remove(document,"mousemove touchmove",this.dragRangeBarMove),w["l"].remove(document,"mouseup touchend",this.dragRangeBarUp),this.rangeBarDragged=!1},t.prototype.checkRepeatedValue=function(e){if("Range"===this.type){var t=this.enableRtl&&"Vertical"!==this.orientation?1===this.activeHandle?this.previousVal[1]:this.previousVal[0]:1===this.activeHandle?this.previousVal[0]:this.previousVal[1];if(e===t)return 0}else if(e===this.previousVal)return 0;return 1},t.prototype.refreshTooltip=function(e){this.tooltip.isVisible&&this.tooltipObj&&(this.tooltipValue(),e&&(this.tooltipObj.refresh(e),this.tooltipTarget=e))},t.prototype.openTooltip=function(e){this.tooltip.isVisible&&this.tooltipObj&&!this.isMaterialTooltip&&(this.tooltipValue(),this.tooltipObj.open(e),this.tooltipTarget=e)},t.prototype.closeTooltip=function(){this.tooltip.isVisible&&this.tooltipObj&&"Always"!==this.tooltip.showOn&&!this.isMaterialTooltip&&(this.tooltipValue(),this.tooltipObj.close(),this.tooltipTarget=void 0)},t.prototype.keyDown=function(e){switch(e.keyCode){case 37:case 38:case 39:case 40:case 33:case 34:case 36:case 35:e.preventDefault(),this.buttonClick(e);break}},t.prototype.wireButtonEvt=function(e){e?(w["l"].remove(this.firstBtn,"mouseleave touchleave",this.buttonFocusOut),w["l"].remove(this.secondBtn,"mouseleave touchleave",this.buttonFocusOut),w["l"].remove(this.firstBtn,"mousedown touchstart",this.repeatHandlerMouse),w["l"].remove(this.firstBtn,"mouseup mouseleave touchup touchend",this.repeatHandlerUp),w["l"].remove(this.secondBtn,"mousedown touchstart",this.repeatHandlerMouse),w["l"].remove(this.secondBtn,"mouseup mouseleave touchup touchend",this.repeatHandlerUp),w["l"].remove(this.firstBtn,"focusout",this.sliderFocusOut),w["l"].remove(this.secondBtn,"focusout",this.sliderFocusOut)):(w["l"].add(this.firstBtn,"mouseleave touchleave",this.buttonFocusOut,this),w["l"].add(this.secondBtn,"mouseleave touchleave",this.buttonFocusOut,this),w["l"].add(this.firstBtn,"mousedown touchstart",this.repeatHandlerMouse,this),w["l"].add(this.firstBtn,"mouseup mouseleave touchup touchend",this.repeatHandlerUp,this),w["l"].add(this.secondBtn,"mousedown touchstart",this.repeatHandlerMouse,this),w["l"].add(this.secondBtn,"mouseup mouseleave touchup touchend",this.repeatHandlerUp,this),w["l"].add(this.firstBtn,"focusout",this.sliderFocusOut,this),w["l"].add(this.secondBtn,"focusout",this.sliderFocusOut,this))},t.prototype.rangeBarMousedown=function(e){var t,i;if(e.preventDefault(),this.focusSliderElement(),"Range"===this.type&&this.drag&&e.target===this.rangeBar){var n=void 0,r=void 0;"mousedown"===e.type?(t=[e.clientX,e.clientY],n=t[0],r=t[1]):"touchstart"===e.type&&(i=[e.changedTouches[0].clientX,e.changedTouches[0].clientY],n=i[0],r=i[1]),"Horizontal"===this.orientation?(this.firstPartRemain=n-this.rangeBar.getBoundingClientRect().left,this.secondPartRemain=this.rangeBar.getBoundingClientRect().right-n):(this.firstPartRemain=r-this.rangeBar.getBoundingClientRect().top,this.secondPartRemain=this.rangeBar.getBoundingClientRect().bottom-r),this.minDiff=this.handleVal2-this.handleVal1,this.tooltipToggle(this.rangeBar);var s=this.element.querySelector("."+Ho.sliderTabHandle);s&&s.classList.remove(Ho.sliderTabHandle),w["l"].add(document,"mousemove touchmove",this.dragRangeBarMove,this),w["l"].add(document,"mouseup touchend",this.dragRangeBarUp,this)}},t.prototype.elementClick=function(e){this.isDragComplete?this.isDragComplete=!1:(e.preventDefault(),this.focusSliderElement(),this.sliderBarClick(e),this.focusHandle())},t.prototype.wireEvents=function(){this.onresize=this.reposition.bind(this),window.addEventListener("resize",this.onresize),this.enabled&&!this.readonly&&(w["l"].add(this.element,"click",this.elementClick,this),"Range"===this.type&&this.drag&&w["l"].add(this.rangeBar,"mousedown touchstart",this.rangeBarMousedown,this),w["l"].add(this.sliderContainer,"keydown",this.keyDown,this),w["l"].add(this.sliderContainer,"keyup",this.keyUp,this),w["l"].add(this.element,"focusout",this.sliderFocusOut,this),w["l"].add(this.sliderContainer,"mouseover mouseout touchstart touchend",this.hover,this),this.wireFirstHandleEvt(!1),"Range"===this.type&&this.wireSecondHandleEvt(!1),this.showButtons&&this.wireButtonEvt(!1),this.wireMaterialTooltipEvent(!1),this.isForm&&w["l"].add(this.formElement,"reset",this.formResetHandler,this))},t.prototype.unwireEvents=function(){w["l"].remove(this.element,"click",this.elementClick),"Range"===this.type&&this.drag&&w["l"].remove(this.rangeBar,"mousedown touchstart",this.rangeBarMousedown),w["l"].remove(this.sliderContainer,"keydown",this.keyDown),w["l"].remove(this.sliderContainer,"keyup",this.keyUp),w["l"].remove(this.element,"focusout",this.sliderFocusOut),w["l"].remove(this.sliderContainer,"mouseover mouseout touchstart touchend",this.hover),this.wireFirstHandleEvt(!0),"Range"===this.type&&this.wireSecondHandleEvt(!0),this.showButtons&&this.wireButtonEvt(!0),this.wireMaterialTooltipEvent(!0),w["l"].remove(this.element,"reset",this.formResetHandler)},t.prototype.formResetHandler=function(){this.setProperties({value:this.formResetValue},!0),this.setValue()},t.prototype.keyUp=function(e){if(9===e.keyCode&&e.target.classList.contains(Ho.sliderHandle)&&(this.focusSliderElement(),!e.target.classList.contains(Ho.sliderTabHandle))){this.element.querySelector("."+Ho.sliderTabHandle)&&this.element.querySelector("."+Ho.sliderTabHandle).classList.remove(Ho.sliderTabHandle),e.target.classList.add(Ho.sliderTabHandle);var t=e.target.parentElement;t===this.element&&(t.querySelector("."+Ho.sliderTrack).classList.add(Ho.sliderTabTrack),"Range"!==this.type&&"MinRange"!==this.type||t.querySelector("."+Ho.rangeBar).classList.add(Ho.sliderTabRange)),"Range"===this.type&&(e.target.previousSibling.classList.contains(Ho.sliderHandle)?this.activeHandle=2:this.activeHandle=1),this.getHandle().focus(),this.tooltipToggle(this.getHandle())}this.closeTooltip(),this.changeEvent("changed",e)},t.prototype.hover=function(e){if(!Object(w["T"])(e))if("mouseover"===e.type||"touchmove"===e.type||"mousemove"===e.type||"pointermove"===e.type||"touchstart"===e.type)this.sliderContainer.classList.add(Ho.sliderHover);else{this.sliderContainer.classList.remove(Ho.sliderHover);var t=e.currentTarget;this.tooltip.isVisible&&"Always"!==this.tooltip.showOn&&this.tooltipObj&&this.isMaterialTooltip&&!t.classList.contains(Ho.sliderHandleFocused)&&!t.classList.contains(Ho.sliderTabHandle)&&this.closeMaterialTooltip()}},t.prototype.sliderFocusOut=function(e){e.relatedTarget!==this.secondHandle&&e.relatedTarget!==this.firstHandle&&e.relatedTarget!==this.element&&e.relatedTarget!==this.firstBtn&&e.relatedTarget!==this.secondBtn&&(this.closeMaterialTooltip(),this.closeTooltip(),this.element.querySelector("."+Ho.sliderTabHandle)&&this.element.querySelector("."+Ho.sliderTabHandle).classList.remove(Ho.sliderTabHandle),this.element.querySelector("."+Ho.sliderTabTrack)&&(this.element.querySelector("."+Ho.sliderTabTrack).classList.remove(Ho.sliderTabTrack),"Range"!==this.type&&"MinRange"!==this.type||!this.element.querySelector("."+Ho.sliderTabRange)||this.element.querySelector("."+Ho.sliderTabRange).classList.remove(Ho.sliderTabRange)),this.hiddenInput.focus(),this.hiddenInput.blur(),this.isElementFocused=!1)},t.prototype.removeElement=function(e){e.parentNode&&e.parentNode.removeChild(e)},t.prototype.changeSliderType=function(e,t){this.isMaterialTooltip&&this.materialHandle&&(this.sliderContainer.classList.remove(Ho.materialSlider),this.removeElement(this.materialHandle),this.materialHandle=void 0),this.removeElement(this.firstHandle),this.firstHandle=void 0,"Default"!==e&&("Range"===e&&(this.removeElement(this.secondHandle),this.secondHandle=void 0),this.removeElement(this.rangeBar),this.rangeBar=void 0),this.tooltip.isVisible&&!Object(w["T"])(this.tooltipObj)&&(this.tooltipObj.destroy(),this.tooltipElement=void 0,this.tooltipCollidedPosition=void 0),this.limits.enabled&&("MinRange"===e||"Default"===e?Object(w["T"])(this.limitBarFirst)||(this.removeElement(this.limitBarFirst),this.limitBarFirst=void 0):Object(w["T"])(this.limitBarSecond)||(this.removeElement(this.limitBarSecond),this.limitBarSecond=void 0)),this.activeHandle=1,this.getThemeInitialization(),"Range"===this.type&&this.rangeValueUpdate(),this.createRangeBar(),this.limits.enabled&&this.createLimitBar(),this.setHandler(),this.setOrientClass(),this.wireFirstHandleEvt(!1),"Range"===this.type&&this.wireSecondHandleEvt(!1),this.setValue(),this.tooltip.isVisible&&(this.renderTooltip(),this.wireMaterialTooltipEvent(!1)),this.setBarColor(),"tooltip"!==t&&this.updateConfig()},t.prototype.changeRtl=function(){if(this.enableRtl||"Range"!==this.type||(this.value=[this.handleVal2,this.handleVal1]),this.updateConfig(),this.tooltip.isVisible&&this.tooltipObj.refresh(this.firstHandle),this.showButtons){var e=this.enableRtl&&"Vertical"!==this.orientation;Object(w["w"])(e?this.secondBtn:this.firstBtn,{"aria-label":"Decrease",title:"Decrease"}),Object(w["w"])(e?this.firstBtn:this.secondBtn,{"aria-label":"Increase",title:"Increase"})}},t.prototype.changeOrientation=function(){this.changeSliderType(this.type,"null")},t.prototype.updateConfig=function(){this.setEnableRTL(),this.setValue(),this.tooltip.isVisible&&this.refreshTooltip(this.tooltipTarget),"None"!==this.ticks.placement&&this.ul&&(this.removeElement(this.ul),this.ul=void 0,this.renderScale()),this.limitsPropertyChange()},t.prototype.limitsPropertyChange=function(){this.limits.enabled?(Object(w["T"])(this.limitBarFirst)&&"Range"!==this.type&&this.createLimitBar(),Object(w["T"])(this.limitBarFirst)&&Object(w["T"])(this.limitBarSecond)&&"Range"===this.type&&this.createLimitBar(),this.setLimitBar(),this.setValue()):(Object(w["T"])(this.limitBarFirst)||Object(w["F"])(this.limitBarFirst),Object(w["T"])(this.limitBarSecond)||Object(w["F"])(this.limitBarSecond))},t.prototype.getPersistData=function(){var e=["value"];return this.addOnPersist(e)},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.unwireEvents(),window.removeEventListener("resize",this.onresize),Object(w["gb"])([this.sliderContainer],[Ho.sliderDisabled]),this.firstHandle.removeAttribute("aria-orientation"),"Range"===this.type&&this.secondHandle.removeAttribute("aria-orientation"),this.sliderContainer.parentNode.insertBefore(this.element,this.sliderContainer),Object(w["F"])(this.sliderContainer),this.tooltip.isVisible&&this.tooltipObj.destroy(),this.element.innerHTML=""},t.prototype.onPropertyChanged=function(e,t){for(var i=this,n=0,r=Object.keys(e);n<r.length;n++){var s=r[n];switch(s){case"cssClass":this.setCSSClass(t.cssClass);break;case"value":if(e&&t){var a=Object(w["T"])(e.value)?"Range"===this.type?[this.min,this.max]:this.min:e.value;this.setProperties({value:a},!0),Object(w["T"])(t.value)||t.value.toString()===a.toString()||(this.setValue(),this.refreshTooltip(this.tooltipTarget),"Range"===this.type&&(Object(w["T"])(e.value)||t.value[1]===a[1]?this.activeHandle=1:this.activeHandle=2))}break;case"min":case"step":case"max":this.setMinMaxValue();break;case"tooltip":Object(w["T"])(e.tooltip)||Object(w["T"])(t.tooltip)||this.setTooltip(s);break;case"type":Object(w["T"])(t)||!Object.keys(t).length||Object(w["T"])(t.type)||(this.changeSliderType(t.type,s),this.setZindex());break;case"enableRtl":t.enableRtl!==e.enableRtl&&"Vertical"!==this.orientation&&(this.rtl=t.enableRtl,this.changeRtl());break;case"limits":this.limitsPropertyChange();break;case"orientation":this.changeOrientation();break;case"ticks":Object(w["T"])(this.sliderContainer.querySelector("."+Ho.scale))||(Object(w["F"])(this.ul),Array.prototype.forEach.call(this.sliderContainer.classList,function(e){e.match(/e-scale-/)&&i.sliderContainer.classList.remove(e)})),"None"!==this.ticks.placement&&(this.renderScale(),this.setZindex());break;case"locale":this.showButtons&&this.buttonTitle();break;case"showButtons":e.showButtons?(this.setButtons(),this.reposition(),this.enabled&&!this.readonly&&this.wireButtonEvt(!1)):this.firstBtn&&this.secondBtn&&(this.sliderContainer.removeChild(this.firstBtn),this.sliderContainer.removeChild(this.secondBtn),this.sliderContainer.classList.remove(Ho.sliderButtonClass),this.firstBtn=void 0,this.secondBtn=void 0,this.reposition());break;case"enabled":this.setEnabled();break;case"readonly":this.setReadOnly();break;case"customValues":this.setValue(),this.reposition();break;case"colorRange":this.reposition();break;case"width":this.setElementWidth(e.width),this.setMinMaxValue(),this.limits&&this.limitsPropertyChange();break}}},t.prototype.setReadOnly=function(){this.readonly?(this.unwireEvents(),this.sliderContainer.classList.add(Ho.readonly)):(this.wireEvents(),this.sliderContainer.classList.remove(Ho.readonly))},t.prototype.setMinMaxValue=function(){var e=this;this.setValue(),this.refreshTooltip(this.tooltipTarget),Object(w["T"])(this.sliderContainer.querySelector("."+Ho.scale))||this.ul&&(Object(w["F"])(this.ul),Array.prototype.forEach.call(this.sliderContainer.classList,function(t){t.match(/e-scale-/)&&e.sliderContainer.classList.remove(t)})),"None"!==this.ticks.placement&&(this.renderScale(),this.setZindex())},t.prototype.setZindex=function(){this.zIndex=6,Object(w["T"])(this.ticks)||"None"===this.ticks.placement||(this.ul.style.zIndex=this.zIndex+-7+"",this.element.style.zIndex=this.zIndex+2+""),this.isMaterial||Object(w["T"])(this.ticks)||"Both"!==this.ticks.placement||(this.element.style.zIndex=this.zIndex+2+""),this.firstHandle.style.zIndex=this.zIndex+3+"","Range"===this.type&&(this.secondHandle.style.zIndex=this.zIndex+4+"")},t.prototype.setTooltip=function(e){this.changeSliderType(this.type,e)},t.prototype.setBarColor=function(){var e,t,i=this.sliderTrack.lastElementChild;while(i)this.sliderTrack.removeChild(i),i=this.sliderTrack.lastElementChild;for(var n=0;n<this.colorRange.length;n++)if(!Object(w["T"])(this.colorRange[n].start)&&!Object(w["T"])(this.colorRange[n].end)&&this.colorRange[n].end>this.colorRange[n].start){this.colorRange[n].start<this.min&&(this.colorRange[n].start=this.min),this.colorRange[n].end>this.max&&(this.colorRange[n].end=this.max);var r=this.checkHandlePosition(this.colorRange[n].start),s=this.checkHandlePosition(this.colorRange[n].end),a=this.createElement("div");a.style.backgroundColor=this.colorRange[n].color,a.style.border="1px solid "+this.colorRange[n].color,"Horizontal"===this.orientation?(t=Ho.sliderHorizantalColor,e=this.enableRtl?Object(w["T"])(this.customValues)?this.checkHandlePosition(this.max)-this.checkHandlePosition(this.colorRange[n].end):this.checkHandlePosition(this.customValues.length-this.colorRange[n].end-1):this.checkHandlePosition(this.colorRange[n].start),a.style.width=s-r+"px",a.style.left=e+"px"):(t=Ho.sliderVerticalColor,e=this.checkHandlePosition(this.colorRange[n].start),a.style.height=s-r+"px",a.style.bottom=e+"px"),a.classList.add(t),this.sliderTrack.appendChild(a)}},t.prototype.getModuleName=function(){return"slider"},Mo([Object(w["r"])(null)],t.prototype,"value",void 0),Mo([Object(w["r"])(null)],t.prototype,"customValues",void 0),Mo([Object(w["r"])(1)],t.prototype,"step",void 0),Mo([Object(w["r"])(null)],t.prototype,"width",void 0),Mo([Object(w["r"])(0)],t.prototype,"min",void 0),Mo([Object(w["r"])(100)],t.prototype,"max",void 0),Mo([Object(w["r"])(!1)],t.prototype,"readonly",void 0),Mo([Object(w["r"])("Default")],t.prototype,"type",void 0),Mo([Object(w["f"])([{}],Lo)],t.prototype,"colorRange",void 0),Mo([Object(w["g"])({},Po)],t.prototype,"ticks",void 0),Mo([Object(w["g"])({},No)],t.prototype,"limits",void 0),Mo([Object(w["r"])(!0)],t.prototype,"enabled",void 0),Mo([Object(w["g"])({},Ao)],t.prototype,"tooltip",void 0),Mo([Object(w["r"])(!1)],t.prototype,"showButtons",void 0),Mo([Object(w["r"])(!0)],t.prototype,"enableAnimation",void 0),Mo([Object(w["r"])("Horizontal")],t.prototype,"orientation",void 0),Mo([Object(w["r"])("")],t.prototype,"cssClass",void 0),Mo([Object(w["r"])(!1)],t.prototype,"enableHtmlSanitizer",void 0),Mo([Object(w["k"])()],t.prototype,"created",void 0),Mo([Object(w["k"])()],t.prototype,"change",void 0),Mo([Object(w["k"])()],t.prototype,"changed",void 0),Mo([Object(w["k"])()],t.prototype,"renderingTicks",void 0),Mo([Object(w["k"])()],t.prototype,"renderedTicks",void 0),Mo([Object(w["k"])()],t.prototype,"tooltipChange",void 0),t=Mo([w["p"]],t),t}(w["h"]),qo=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),zo=function(e,t,i,n){var r,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var o=e.length-1;o>=0;o--)(r=e[o])&&(a=(s<3?r(a):s>3?r(t,i,a):r(t,i))||a);return s>3&&a&&Object.defineProperty(t,i,a),a},_o="e-apply",Uo="e-cancel",Go="e-current",Wo="e-container",Ko="e-ctrl-btn",$o="e-switch-ctrl-btn",Xo="e-disabled",Jo="e-value-switch-btn",Qo="e-handler",Yo="e-hex",Zo="e-hide-hex-value",el="e-hide-opacity",tl="e-hide-switchable-value",il="e-hide-value",nl="e-hide-valueswitcher",rl="e-hsv-color",sl="e-hsv-container",al="e-selected-value",ol="e-mode-switch-btn",ll="e-nocolor-item",dl="e-opacity-value",cl="e-palette",hl="e-color-palette",pl="e-color-picker",ul="e-preview-container",ml="e-previous",gl="e-rtl",fl="e-show-value",bl="e-selected",vl="e-split-preview",yl="e-tile",Cl={default:["#000000","#f44336","#e91e63","#9c27b0","#673ab7","#2196f3","#03a9f4","#00bcd4","#009688","#ffeb3b","#ffffff","#ffebee","#fce4ec","#f3e5f5","#ede7f6","#e3f2fd","#e1f5fe","#e0f7fa","#e0f2f1","#fffde7","#f2f2f2","#ffcdd2","#f8bbd0","#e1bee7","#d1c4e9","#bbdefb","#b3e5fc","#b2ebf2","#b2dfdb","#fff9c4","#e6e6e6","#ef9a9a","#f48fb1","#ce93d8","#b39ddb","#90caf9","#81d4fa","#80deea","#80cbc4","#fff59d","#cccccc","#e57373","#f06292","#ba68c8","#9575cd","#64b5f6","#4fc3f7","#4dd0e1","#4db6ac","#fff176","#b3b3b3","#ef5350","#ec407a","#ab47bc","#7e57c2","#42a5f5","#29b6f6","#26c6da","#26a69a","#ffee58","#999999","#e53935","#d81b60","#8e24aa","#5e35b1","#1e88e5","#039be5","#00acc1","#00897b","#fdd835","#808080","#d32f2f","#c2185b","#7b1fa2","#512da8","#1976d2","#0288d1","#0097a7","#00796b","#fbc02d","#666666","#c62828","#ad1457","#6a1b9a","#4527a0","#1565c0","#0277bd","#00838f","#00695c","#f9a825","#4d4d4d","#b71c1c","#880e4f","#4a148c","#311b92","#0d47a1","#01579b","#006064","#004d40","#f57f17"]},wl=function(e){function t(t,i){return e.call(this,t,i)||this}return qo(t,e),t.prototype.preRender=function(){var e=this.element;this.formElement=Object(w["A"])(this.element,"form"),this.formElement&&w["l"].add(this.formElement,"reset",this.formResetHandler,this);var t={Apply:"Apply",Cancel:"Cancel",ModeSwitcher:"Switch Mode"};this.l10n=new w["o"]("colorpicker",t,this.locale),e.getAttribute("ejs-for")&&!e.getAttribute("name")&&e.setAttribute("name",e.id)},t.prototype.render=function(){this.initWrapper(),this.inline?this.createWidget():this.createSplitBtn(),this.enableOpacity||Object(w["u"])([this.container.parentElement],el),this.renderComplete()},t.prototype.initWrapper=function(){var e=this.createElement("div",{className:"e-"+this.getModuleName()+"-wrapper"});this.element.parentNode.insertBefore(e,this.element),e.appendChild(this.element),Object(w["w"])(this.element,{tabindex:"-1",spellcheck:"false"}),this.container=this.createElement("div",{className:Wo}),this.getWrapper().appendChild(this.container);var t=this.value?this.roundValue(this.value).toLowerCase():"#008000ff";this.noColor&&"Palette"===this.mode&&""===this.value&&(t="");var i=t.slice(0,7);Object(w["T"])(this.initialInputValue)&&(this.initialInputValue=i),this.element.value=i,this.enableOpacity?this.setProperties({value:t},!0):this.setProperties({value:i},!0),this.enableRtl&&e.classList.add(gl),this.cssClass&&Object(w["u"])([e],this.cssClass.split(" ")),this.tileRipple=Object(w["ib"])(this.container,{selector:"."+yl}),this.ctrlBtnRipple=Object(w["ib"])(this.container,{selector:".e-btn"})},t.prototype.getWrapper=function(){return this.element.parentElement},t.prototype.createWidget=function(){"Palette"===this.mode?(this.createPalette(),this.inline||this.firstPaletteFocus()):(this.createPicker(),this.inline||this.getDragHandler().focus()),this.isRgb=!0,this.createInput(),this.createCtrlBtn(),this.disabled||this.wireEvents(),this.inline&&this.disabled&&this.toggleDisabled(!0),w["d"].isDevice&&this.refreshPopupPos()},t.prototype.createSplitBtn=function(){var e=this,t=this.createElement("button",{className:"e-split-colorpicker"});this.getWrapper().appendChild(t),this.splitBtn=new Do({iconCss:"e-selected-color",target:this.container,disabled:this.disabled,enableRtl:this.enableRtl,createPopupOnClick:this.createPopupOnClick,open:this.onOpen.bind(this),click:function(){e.trigger("change",{currentValue:{hex:e.value.slice(0,7),rgba:e.convertToRgbString(e.hexToRgb(e.value))},previousValue:{hex:null,rgba:null},value:e.value})}}),this.splitBtn.createElement=this.createElement,this.splitBtn.appendTo(t);var i=this.createElement("span",{className:vl});Object(w["jb"])(".e-selected-color",t).appendChild(i),i.style.backgroundColor=this.convertToRgbString(this.hexToRgb(this.value));var n=this.getPopupEle();if(Object(w["u"])([n],"e-colorpicker-popup"),this.cssClass&&Object(w["u"])([n],this.cssClass.split(" ")),w["d"].isDevice){var r=this.getPopupInst();r.relateTo=document.body,r.position={X:"center",Y:"center"},r.targetType="container",r.collision={X:"fit",Y:"fit"},r.offsetY=4,n.style.zIndex=Object(Vt["d"])(this.splitBtn.element).toString()}this.bindCallBackEvent()},t.prototype.onOpen=function(){this.trigger("open",{element:this.container})},t.prototype.getPopupInst=function(){return Object(w["M"])(this.getPopupEle(),Vt["a"])},t.prototype.bindCallBackEvent=function(){var e=this;this.splitBtn.beforeOpen=function(t){var i=new Eo;return e.trigger("beforeOpen",t,function(n){if(!n.cancel){var r=e.getPopupEle();r.style.top=Object(w["H"])(0+pageYOffset),r.style.left=Object(w["H"])(0+pageXOffset),r.style.display="block",e.createWidget(),r.style.display="",w["d"].isDevice&&(e.modal=e.createElement("div"),e.modal.className="e-"+e.getModuleName()+" e-modal",e.modal.style.display="none",document.body.insertBefore(e.modal,r),document.body.className+=" e-colorpicker-overflow",e.modal.style.display="block",e.modal.style.zIndex=(Number(r.style.zIndex)-1).toString())}t.cancel=n.cancel,i.resolve(n)}),i},this.splitBtn.beforeClose=function(t){var i=new Eo;if(Object(w["T"])(t.event))i.resolve(t);else{var n={element:e.container,event:t.event,cancel:!1};e.trigger("beforeClose",n,function(n){w["d"].isDevice&&t.event.target===e.modal&&(n.cancel=!0),n.cancel||e.onPopupClose(),t.cancel=n.cancel,i.resolve(n)})}return i}},t.prototype.onPopupClose=function(){this.unWireEvents(),this.destroyOtherComp(),this.container.style.width="",Object(w["jb"])("."+vl,this.splitBtn.element).style.backgroundColor=this.convertToRgbString(this.hexToRgb(this.value)),this.container.innerHTML="",Object(w["gb"])([this.container],[pl,hl]),w["d"].isDevice&&this.modal&&(Object(w["gb"])([document.body],"e-colorpicker-overflow"),this.modal.style.display="none",this.modal.outerHTML="",this.modal=null)},t.prototype.createPalette=function(){if(Object(w["y"])(this.container,[hl],[pl]),this.presetColors){var e=this.createElement("div",{className:"e-custom-palette"});this.appendElement(e);var t=Object.keys(this.presetColors);if(1===t.length)this.appendPalette(this.presetColors[t[0]],t[0],e);else for(var i=0,n=t.length;i<n;i++)this.appendPalette(this.presetColors[t[i]],t[i],e);Object(w["kb"])(".e-row",e).length>10&&Object(w["u"])([e],"e-palette-group")}else this.appendPalette(Cl.default,"default");"Palette"===this.mode&&!this.modeSwitcher&&this.noColor&&this.setNoColor();var r=parseInt(getComputedStyle(this.container).borderBottomWidth,10);this.container.style.width=Object(w["H"])(this.container.children[0].offsetWidth+r+r),this.rgb=this.hexToRgb(this.roundValue(this.value)),this.hsv=this.rgbToHsv.apply(this,this.rgb)},t.prototype.firstPaletteFocus=function(){Object(w["jb"])("."+bl,this.container.children[0])||Object(w["kb"])("."+cl,this.container)[0].focus()},t.prototype.appendPalette=function(e,t,i){var n,r,s,a=this.createElement("div",{className:cl,attrs:{tabindex:"0"}});i?i.appendChild(a):this.appendElement(a);for(var o=0,l=e.length;o<l;o++)0!==o&&o%this.columns!==0||(n=this.createElement("div",{className:"e-row",attrs:{role:"presentation"}}),a.appendChild(n)),s=this.roundValue(e[o]).toLowerCase(),r=this.createElement("span",{className:yl,attrs:{role:"gridcell","aria-label":s,"aria-selected":"false",tabindex:"0"}}),this.trigger("beforeTileRender",{element:r,presetName:t,value:e[o]}),n.appendChild(r),this.value===s&&(this.addTileSelection(r),a.focus()),r.style.backgroundColor=this.convertToRgbString(this.hexToRgb(s))},t.prototype.setNoColor=function(){var e=this.container.querySelector(".e-row").children[0];e.classList.add(ll),this.value||(e.classList.add(bl),Object(w["A"])(e,"."+cl).focus()),["aria-selected","aria-label"].forEach(function(t){e.removeAttribute(t)}),e.style.backgroundColor=""},t.prototype.appendElement=function(e,t){void 0===t&&(t=0);var i=this.container.children[t];i?this.container.insertBefore(e,i):this.container.appendChild(e)},t.prototype.addTileSelection=function(e){e.classList.add(bl),e.setAttribute("aria-selected","true")},t.prototype.createPicker=function(){Object(w["y"])(this.container,[pl],[hl]);var e=this.createElement("div",{className:sl});this.appendElement(e),e.appendChild(this.createElement("div",{className:rl}));var t=this.createElement("span",{className:Qo,attrs:{tabindex:"0"}});e.appendChild(t),null===this.value&&(this.value="#008000ff"),this.rgb=this.hexToRgb(this.value),this.hsv=this.rgbToHsv.apply(this,this.rgb),this.setHsvContainerBg(),this.setHandlerPosition(),this.createSlider(),this.createDragTooltip()},t.prototype.setHsvContainerBg=function(e){void 0===e&&(e=this.hsv[0]),this.getHsvContainer().style.backgroundColor=this.convertToRgbString(this.hsvToRgb(e,100,100,1))},t.prototype.getHsvContainer=function(){return Object(w["jb"])("."+sl,this.container)},t.prototype.setHandlerPosition=function(){var e=this.getDragHandler(),t=Object(w["jb"])("."+rl,this.container);this.enableRtl?e.style.left=Object(w["H"])(t.offsetWidth*Math.abs(100-this.hsv[1])/100):e.style.left=Object(w["H"])(t.offsetWidth*this.hsv[1]/100),e.style.top=Object(w["H"])(t.offsetHeight*(100-this.hsv[2])/100)},t.prototype.createSlider=function(){var e=this.createElement("div",{className:"e-slider-preview"});this.appendElement(e,1),this.createPreview(e);var t=this.createElement("div",{className:"e-colorpicker-slider"});e.insertBefore(t,e.children[0]);var i=this.createElement("div",{className:"e-hue-slider"});t.appendChild(i),this.hueSlider=new Vo({value:this.hsv[0],min:0,max:359,enableRtl:this.enableRtl,enabled:!this.disabled,change:this.hueChange.bind(this)}),this.hueSlider.createElement=this.createElement,this.hueSlider.appendTo(i),this.enableOpacity&&(i=this.createElement("div",{className:"e-opacity-slider"}),t.appendChild(i),this.createOpacitySlider(i))},t.prototype.createOpacitySlider=function(e){this.opacitySlider=new Vo({value:100*this.rgb[3],min:0,max:100,enableRtl:this.enableRtl,enabled:!this.disabled,change:this.opacityChange.bind(this)}),this.opacitySlider.createElement=this.createElement,this.opacitySlider.appendTo(e);var t=this.createElement("div",{className:"e-opacity-empty-track"});e.appendChild(t),this.updateOpacitySliderBg()},t.prototype.updateOpacitySliderBg=function(){var e=this.enableRtl?"to left":"to right",t=Object(w["jb"])(".e-opacity-empty-track",this.opacitySlider.element);t&&(t.style.background="linear-gradient("+e+", rgba("+this.rgb.slice(0,3)+", 0) 0%, "+this.convertToRgbString(this.rgb.slice(0,3))+" 100%)")},t.prototype.hueChange=function(e){this.hsv[0]=e.value,this.setHsvContainerBg(),this.convertToOtherFormat()},t.prototype.opacityChange=function(e){var t=e.value,i=this.rgbToHex(this.rgb);this.hsv[3]=t/100,this.rgb[3]=t/100;var n=this.rgbToHex(this.rgb);this.updateOpacityInput(t);var r=this.convertToRgbString(this.rgb);this.updatePreview(r),this.triggerEvent(n,i,r)},t.prototype.updateOpacityInput=function(e){if(this.enableOpacity&&!this.getWrapper().classList.contains(il)){var t=Object(w["M"])(Object(w["jb"])("."+dl,this.container),K["a"]);t.value=e,t.dataBind()}},t.prototype.createPreview=function(e){var t=this.createElement("div",{className:ul});e.appendChild(t);var i=this.createElement("span",{className:"e-preview "+Go});t.appendChild(i);var n=this.convertToRgbString(this.rgb);i.style.backgroundColor=n,i=this.createElement("span",{className:"e-preview "+ml}),t.appendChild(i),i.style.backgroundColor=n},t.prototype.isPicker=function(){return!this.container.classList.contains(hl)},t.prototype.getPopupEle=function(){return this.container.parentElement},t.prototype.createNumericInput=function(e,t,i,n){var r=this,s=new K["a"]({value:t,placeholder:i,min:0,max:n,format:"###.##",showSpinButton:!1,floatLabelType:"Always",enableRtl:this.enableRtl,enabled:!this.disabled,readonly:!this.isPicker(),change:function(e){e.event&&r.inputHandler(e.event)}});s.createElement=this.createElement,s.appendTo(e)},t.prototype.createInput=function(){var e=this.isPicker(),t=this.getWrapper();if(e&&!t.classList.contains(il)||!e&&t.classList.contains(fl)){var i=this.createElement("div",{className:al});e?this.appendElement(i,2):this.appendElement(i,1);var n=this.createElement("div",{className:"e-input-container"});if(i.appendChild(n),t.classList.contains(nl)||this.appendValueSwitchBtn(i),!t.classList.contains(Zo)){var r=this.createElement("input",{className:Yo,attrs:{maxlength:"7",spellcheck:"false"}});n.appendChild(r),Io["a"].createInput({element:r,floatLabelType:"Always",properties:{placeholder:"HEX",enableRtl:this.enableRtl,enabled:!this.disabled,readonly:!this.isPicker()}},this.createElement),Io["a"].setValue(this.value.slice(0,7),r),r.addEventListener("input",this.inputHandler.bind(this))}if(!t.classList.contains(tl)){var s=void 0,a=void 0;this.isRgb?(s="RGB",a=this.rgb):(s="HSV",a=this.hsv);for(var o=["rh","gs","bv"],l=0;l<3;l++)this.createNumericInput(n.appendChild(this.createElement("input",{className:"e-"+o[l]+"-value"})),a[l],s[l],255);this.enableOpacity&&this.appendOpacityValue(n)}}},t.prototype.appendOpacityValue=function(e){this.createNumericInput(e.appendChild(this.createElement("input",{className:dl})),100*this.rgb[3],"A",100)},t.prototype.appendValueSwitchBtn=function(e){var t=this.createElement("button",{className:"e-icons e-css e-btn e-flat e-icon-btn "+Jo});e.appendChild(t),this.isPicker()&&!this.getWrapper().classList.contains(tl)&&t.addEventListener("click",this.formatSwitchHandler.bind(this))},t.prototype.createCtrlBtn=function(){if(this.modeSwitcher||this.showButtons){this.l10n.setLocale(this.locale);var e=this.createElement("div",{className:$o});if(this.container.appendChild(e),this.showButtons){var t=this.createElement("div",{className:Ko});e.appendChild(t);var i=this.l10n.getConstant("Apply");t.appendChild(this.createElement("button",{innerHTML:i,className:"e-btn e-css e-flat e-primary e-small "+_o,attrs:{title:i}}));var n=this.l10n.getConstant("Cancel");t.appendChild(this.createElement("button",{innerHTML:n,className:"e-btn e-css e-flat e-small "+Uo,attrs:{title:n}}))}this.modeSwitcher&&this.appendModeSwitchBtn()}},t.prototype.appendModeSwitchBtn=function(){var e=this.createElement("button",{className:"e-icons e-btn e-flat e-icon-btn "+ol,attrs:{title:this.l10n.getConstant("ModeSwitcher")}});Object(w["jb"])("."+$o,this.container).insertBefore(e,Object(w["jb"])("."+Ko,this.container))},t.prototype.createDragTooltip=function(){var e=this,t=new Me["a"]({opensOn:"Custom",showTipPointer:!1,cssClass:"e-color-picker-tooltip",beforeOpen:function(t){e.tooltipEle=t.element},animation:{open:{effect:"None"},close:{effect:"None"}}});t.createElement=this.createElement,t.appendTo(this.container),t.open(this.container),this.tooltipEle.style.zIndex=Object(Vt["d"])(this.tooltipEle).toString(),Object(w["jb"])(".e-tip-content",this.tooltipEle).appendChild(this.createElement("div",{className:"e-tip-transparent"}))},t.prototype.getTooltipInst=function(){return Object(w["M"])(this.container,Me["a"])},t.prototype.setTooltipOffset=function(e){this.getTooltipInst().offsetY=e},t.prototype.toggleDisabled=function(e){e?this.getWrapper().classList.add(Xo):this.getWrapper().classList.remove(Xo),this.showButtons&&[].slice.call(Object(w["kb"])(".e-btn",this.container)).forEach(function(t){e?Object(w["w"])(t,{disabled:""}):t.removeAttribute("disabled")})},t.prototype.convertToRgbString=function(e){return e.length?4===e.length?"rgba("+e.join()+")":"rgb("+e.join()+")":""},t.prototype.convertToHsvString=function(e){return 4===e.length?"hsva("+e.join()+")":"hsv("+e.join()+")"},t.prototype.updateHsv=function(){this.hsv[1]=this.hsv[1]>100?100:this.hsv[1],this.hsv[2]=this.hsv[2]>100?100:this.hsv[2],this.setHandlerPosition()},t.prototype.convertToOtherFormat=function(e){void 0===e&&(e=!1);var t=this.rgbToHex(this.rgb);this.rgb=this.hsvToRgb.apply(this,this.hsv);var i=this.rgbToHex(this.rgb),n=this.convertToRgbString(this.rgb);this.updatePreview(n),this.updateInput(i),this.triggerEvent(i,t,n,e)},t.prototype.updateInput=function(e){var t=this.getWrapper();t.classList.contains(il)||(t.classList.contains(Zo)||Io["a"].setValue(e.substr(0,7),Object(w["jb"])("."+Yo,this.container)),t.classList.contains(tl)||(this.isRgb?this.updateValue(this.rgb,!1):this.updateValue(this.hsv,!1)))},t.prototype.updatePreview=function(e){this.enableOpacity&&this.updateOpacitySliderBg(),Object(w["jb"])(".e-tip-transparent",this.tooltipEle).style.backgroundColor=e,Object(w["jb"])("."+ul+" ."+Go,this.container).style.backgroundColor=e,Object(w["jb"])("."+ul+" ."+ml,this.container).style.backgroundColor=this.convertToRgbString(this.hexToRgb(this.value))},t.prototype.getDragHandler=function(){return Object(w["jb"])("."+Qo,this.container)},t.prototype.removeTileSelection=function(){var e=[].slice.call(Object(w["kb"])("."+bl,this.container.children[0]));e.forEach(function(e){e.classList.remove(bl),e.setAttribute("aria-selected","false")})},t.prototype.convertRgbToNumberArray=function(e){return e.slice(e.indexOf("(")+1,e.indexOf(")")).split(",").map(function(e,t){return 3!==t?parseInt(e,10):parseFloat(e)})},t.prototype.getValue=function(e,t){if(e||(e=this.value),t=t?t.toLowerCase():"hex","r"===e[0]){var i=this.convertRgbToNumberArray(e);if("hex"===t||"hexa"===t){var n=this.rgbToHex(i);return"hex"===t?n.slice(0,7):n}return"hsv"===t?this.convertToHsvString(this.rgbToHsv.apply(this,i.slice(0,3))):"hsva"===t?this.convertToHsvString(this.rgbToHsv.apply(this,i)):"null"}if("h"===e[0]){i=this.hsvToRgb.apply(this,this.convertRgbToNumberArray(e));if("rgba"===t)return this.convertToRgbString(i);if("hex"===t||"hexa"===t){n=this.rgbToHex(i);return"hex"===t?n.slice(0,7):n}return"rgb"===t?this.convertToRgbString(i.slice(0,3)):"null"}e=this.roundValue(e);var r=this.hexToRgb(e);return"rgb"!==t&&"hsv"!==t||(r=r.slice(0,3)),"rgba"===t||"rgb"===t?this.convertToRgbString(r):"hsva"===t||"hsv"===t?this.convertToHsvString(this.rgbToHsv.apply(this,r)):"hex"===t?e.slice(0,7):"a"===t?r[3].toString():"null"},t.prototype.toggle=function(){this.container.parentElement.classList.contains("e-popup-close")?this.splitBtn.toggle():this.closePopup(null)},t.prototype.getModuleName=function(){return"colorpicker"},t.prototype.getPersistData=function(){return this.addOnPersist(["value"])},t.prototype.wireEvents=function(){if(this.isPicker()){var e=this.getDragHandler();w["l"].add(e,"keydown",this.pickerKeyDown,this),w["l"].add(this.getHsvContainer(),"mousedown touchstart",this.handlerDown,this),(this.modeSwitcher||this.showButtons)&&this.addCtrlSwitchEvent(),w["l"].add(Object(w["jb"])("."+ml,this.container),"click",this.previewHandler,this)}else w["l"].add(this.container,"click",this.paletteClickHandler,this),w["l"].add(this.container,"keydown",this.paletteKeyDown,this)},t.prototype.formResetHandler=function(){this.value=this.initialInputValue,Object(w["w"])(this.element,{value:this.initialInputValue})},t.prototype.addCtrlSwitchEvent=function(){var e=Object(w["jb"])("."+$o,this.container);e&&w["l"].add(e,"click",this.btnClickHandler,this)},t.prototype.pickerKeyDown=function(e){switch(e.keyCode){case 39:this.handlerDragPosition(1,this.enableRtl?-1:1,e);break;case 37:this.handlerDragPosition(1,this.enableRtl?1:-1,e);break;case 38:this.handlerDragPosition(2,1,e);break;case 40:this.handlerDragPosition(2,-1,e);break;case 13:e.preventDefault();var t=this.rgbToHex(this.rgb);this.enterKeyHandler(t,e)}},t.prototype.enterKeyHandler=function(e,t){this.triggerChangeEvent(e),this.inline||(this.closePopup(t),this.splitBtn.element.focus())},t.prototype.closePopup=function(e){var t=this,i={element:this.container,event:e,cancel:!1};this.trigger("beforeClose",i,function(e){e.cancel||(t.splitBtn.toggle(),t.onPopupClose())})},t.prototype.triggerChangeEvent=function(e){var t=e.slice(0,7);this.trigger("change",{currentValue:{hex:t,rgba:this.convertToRgbString(this.rgb)},previousValue:{hex:this.value.slice(0,7),rgba:this.convertToRgbString(this.hexToRgb(this.value))},value:this.enableOpacity?e:t}),this.enableOpacity?this.setProperties({value:e},!0):this.setProperties({value:t},!0),this.element.value=t||"#000000"},t.prototype.handlerDragPosition=function(e,t,i){i.preventDefault(),this.hsv[e]+=t*(i.ctrlKey?1:3),this.hsv[e]<0&&(this.hsv[e]=0),this.updateHsv(),this.convertToOtherFormat(!0)},t.prototype.handlerDown=function(e){e.preventDefault(),"mousedown"===e.type?(this.clientX=Math.abs(e.pageX-pageXOffset),this.clientY=Math.abs(e.pageY-pageYOffset),this.setTooltipOffset(8)):(this.clientX=Math.abs(e.changedTouches[0].pageX-pageXOffset),this.clientY=Math.abs(e.changedTouches[0].pageY-pageYOffset),this.setTooltipOffset(-8)),this.setHsv(this.clientX,this.clientY),this.getDragHandler().style.transition="left .4s cubic-bezier(.25, .8, .25, 1), top .4s cubic-bezier(.25, .8, .25, 1)",this.updateHsv(),this.convertToOtherFormat(),this.getDragHandler().focus(),w["l"].add(document,"mousemove touchmove",this.handlerMove,this),w["l"].add(document,"mouseup touchend",this.handlerEnd,this)},t.prototype.handlerMove=function(e){var t,i;"touchmove"!==e.type&&e.preventDefault(),"mousemove"===e.type?(t=Math.abs(e.pageX-pageXOffset),i=Math.abs(e.pageY-pageYOffset)):(t=Math.abs(e.changedTouches[0].pageX-pageXOffset),i=Math.abs(e.changedTouches[0].pageY-pageYOffset)),this.setHsv(t,i);var n=this.getDragHandler();this.updateHsv(),this.convertToOtherFormat(),this.getTooltipInst().refresh(n),this.tooltipEle.style.transform||(Math.abs(this.clientX-t)>8||Math.abs(this.clientY-i)>8)&&(Object(w["jb"])("."+rl,this.container).style.cursor="pointer",n.style.transition="none",this.inline||(this.tooltipEle.style.zIndex=(parseInt(this.getPopupEle().style.zIndex,10)+1).toString()),this.tooltipEle.style.transform="rotate(45deg)",n.classList.add("e-hide-handler"))},t.prototype.setHsv=function(e,t){var i=Object(w["jb"])("."+rl,this.container),n=i.getBoundingClientRect();e=this.enableRtl?e>n.right?0:Math.abs(e-n.right):e>n.left?Math.abs(e-n.left):0,t=t>n.top?Math.abs(t-n.top):0,this.hsv[2]=Math.round(10*Number(100*(i.offsetHeight-Math.max(0,Math.min(i.offsetHeight,t-i.offsetTop)))/i.offsetHeight))/10,this.hsv[1]=Math.round(10*Number(100*Math.max(0,Math.min(i.offsetWidth,e-i.offsetLeft))/i.offsetWidth))/10},t.prototype.handlerEnd=function(e){"touchend"!==e.type&&e.preventDefault(),w["l"].remove(document,"mousemove touchmove",this.handlerMove),w["l"].remove(document,"mouseup touchend",this.handlerEnd);var t=this.getDragHandler();Object(w["jb"])("."+rl,this.container).style.cursor="",this.tooltipEle.style.transform&&(this.tooltipEle.style.transform="",t.classList.remove("e-hide-handler")),this.inline||this.showButtons||this.closePopup(e)},t.prototype.btnClickHandler=function(e){var t=e.target;Object(w["A"])(t,"."+ol)?(e.stopPropagation(),this.switchToPalette()):(t.classList.contains(_o)||t.classList.contains(Uo))&&this.ctrlBtnClick(t,e)},t.prototype.switchToPalette=function(){this.trigger("beforeModeSwitch",{element:this.container,mode:"Palette"}),this.unWireEvents(),this.destroyOtherComp(),Object(w["F"])(Object(w["jb"])(".e-slider-preview",this.container)),this.getWrapper().classList.contains(il)||Object(w["fb"])(Object(w["jb"])("."+al,this.container)),Object(w["F"])(this.getHsvContainer()),this.createPalette(),this.firstPaletteFocus(),this.createInput(),this.refreshPopupPos(),this.wireEvents(),this.trigger("onModeSwitch",{element:this.container,mode:"Palette"})},t.prototype.refreshPopupPos=function(){if(!this.inline){var e=this.getPopupEle();e.style.left=Object(w["H"])(0+pageXOffset),e.style.top=Object(w["H"])(0+pageYOffset),this.getPopupInst().refreshPosition(this.splitBtn.element.parentElement)}},t.prototype.formatSwitchHandler=function(){this.isRgb?(this.updateValue(this.hsv,!0,3,[360,100,100]),this.isRgb=!1):(this.updateValue(this.rgb,!0,2),this.isRgb=!0)},t.prototype.updateValue=function(e,t,i,n){for(var r,s=["e-rh-value","e-gs-value","e-bv-value"],a=0,o=s.length;a<o;a++)r=Object(w["M"])(Object(w["jb"])("."+s[a],this.container),K["a"]),r.value=Math.round(e[a]),t&&(r.placeholder=s[a].substr(i,1).toUpperCase(),r.max=n?n[a]:255),r.dataBind()},t.prototype.previewHandler=function(e){var t=e.target,i=this.rgbToHex(this.rgb);this.rgb=this.convertRgbToNumberArray(t.style.backgroundColor),this.rgb[3]||(this.rgb[3]=1);var n=this.rgbToHex(this.rgb),r=this.rgbToHsv.apply(this,this.rgb);r[0]!==this.hsv[0]&&(this.hueSlider.setProperties({value:r[0]},!0),this.hueSlider.refresh()),this.setHsvContainerBg(r[0]),this.enableOpacity&&r[3]!==this.hsv[3]&&(this.opacitySlider.setProperties({value:100*r[3]},!0),this.opacitySlider.refresh(),this.updateOpacitySliderBg()),this.hsv=r,this.setHandlerPosition(),this.updateInput(n),Object(w["jb"])("."+ul+" ."+Go,this.container).style.backgroundColor=this.convertToRgbString(this.rgb),this.triggerEvent(n,i,this.convertToRgbString(this.rgb))},t.prototype.paletteClickHandler=function(e){e.preventDefault();var t=e.target;if(t.classList.contains(yl)){if(this.removeTileSelection(),this.addTileSelection(t),t.classList.contains(ll))this.noColorTile();else{var i=t.getAttribute("aria-label"),n=this.rgbToHex(this.rgb);this.rgb=this.hexToRgb(this.roundValue(i)),this.hsv=this.rgbToHsv.apply(this,this.rgb),this.getWrapper().classList.contains(fl)&&this.updateInput(i),this.triggerEvent(i,n,this.convertToRgbString(this.rgb))}this.inline||this.showButtons||this.closePopup(e)}else Object(w["A"])(t,"."+ol)?this.switchToPicker():t.classList.contains(_o)||t.classList.contains(Uo)?this.ctrlBtnClick(t,e):this.getWrapper().classList.contains(fl)&&Object(w["A"])(t,"."+Jo)&&this.formatSwitchHandler()},t.prototype.noColorTile=function(e){void 0===e&&(e=!1);var t=this.rgbToHex(this.rgb);this.rgb=[],this.hsv=[],this.triggerEvent("",t,"",e)},t.prototype.switchToPicker=function(){var e=this.getWrapper();this.trigger("beforeModeSwitch",{element:this.container,mode:"Picker"}),this.unWireEvents(),[].slice.call(Object(w["kb"])("."+cl,this.container)).forEach(function(e){Object(w["F"])(e)}),e.classList.contains(fl)&&Object(w["F"])(Object(w["jb"])("."+al,this.container)),this.container.style.width="";var t=Object(w["jb"])(".e-custom-palette",this.container);this.presetColors&&Object(w["fb"])(t),this.createPicker(),this.getDragHandler().focus(),this.createInput(),this.refreshPopupPos(),this.wireEvents(),this.trigger("onModeSwitch",{element:this.container,mode:"Picker"})},t.prototype.ctrlBtnClick=function(e,t){if(e.classList.contains(_o)){var i=this.rgbToHex(this.rgb);this.triggerChangeEvent(i)}this.inline||(this.closePopup(t),this.splitBtn.element.focus())},t.prototype.paletteKeyDown=function(e){var t=e.target;if(t.classList.contains(cl)){var i,n,r=[].slice.call(Object(w["kb"])("."+yl,t)),s=r.filter(function(e){return e.classList.contains("e-selected")}).pop();switch(!e.altKey&&e.keyCode){case 39:e.preventDefault(),i=s?r[this.tilePosition(r,s,this.enableRtl?-1:1)]:r[this.enableRtl?r.length-1:0],this.keySelectionChanges(i);break;case 37:e.preventDefault(),i=s?r[this.tilePosition(r,s,this.enableRtl?1:-1)]:r[this.enableRtl?0:r.length-1],this.keySelectionChanges(i);break;case 38:e.preventDefault(),n=s?this.tilePosition(r,s,-this.columns):0,i=r[n]?r[n]:r[n-this.columns],this.keySelectionChanges(i);break;case 40:e.preventDefault(),n=s?this.tilePosition(r,s,this.columns):r.length-1,r[n]?i=r[n]:(n%=r.length,n+=r[r.length-1].parentElement.childElementCount,i=r[n]),this.keySelectionChanges(i);break;case 13:if(e.preventDefault(),s){var a=s.getAttribute("aria-label");this.enterKeyHandler(a||"",e)}}}},t.prototype.keySelectionChanges=function(e){if(this.removeTileSelection(),this.addTileSelection(e),e.classList.contains(ll))this.noColorTile(!0);else{var t=e.getAttribute("aria-label"),i=this.rgbToHex(this.rgb);this.rgb=this.hexToRgb(t),this.hsv=this.rgbToHsv.apply(this,this.rgb),this.getWrapper().classList.contains(fl)&&this.updateInput(t),this.triggerEvent(t,i,this.convertToRgbString(this.rgb),!0)}},t.prototype.tilePosition=function(e,t,i){e=Array.prototype.slice.call(e);var n=e.length,r=this.columns-e[n-1].parentElement.childElementCount,s=e.indexOf(t);return s+=i,s<0?s+=n+r:s%=n+r,s},t.prototype.inputHandler=function(e){var t=e.target;if(t.value.length){var i,n,r=Object(w["jb"])(".e-float-text",t.parentElement).textContent;switch(r){case"HEX":var s="";if(("#"===t.value[0]&&5!==t.value.length||"#"!==t.value[0]&&4!==t.value.length)&&(s=this.roundValue(t.value)),9!==s.length)return;n=this.rgbToHex(this.rgb),this.rgb=this.hexToRgb(s+s.substr(-2)),this.inputValueChange(this.rgbToHsv.apply(this,this.rgb),n,t.value);break;case"R":this.rgb[0]!==Number(t.value)&&(n=this.rgbToHex(this.rgb),this.rgb[0]=Number(t.value),i=this.rgbToHsv.apply(this,this.rgb),this.inputValueChange(i,n));break;case"G":this.rgb[1]!==Number(t.value)&&(n=this.rgbToHex(this.rgb),this.rgb[1]=Number(t.value),i=this.rgbToHsv.apply(this,this.rgb),this.inputValueChange(i,n));break;case"B":this.rgb[2]!==Number(t.value)&&(n=this.rgbToHex(this.rgb),this.rgb[2]=Number(t.value),i=this.rgbToHsv.apply(this,this.rgb),this.inputValueChange(i,n));break;case"H":this.hueSlider.value=Number(t.value);break;case"S":this.hsv[1]!==Number(t.value)&&(this.hsv[1]=Number(t.value),this.updateHsv(),this.convertToOtherFormat());break;case"V":this.hsv[2]!==Number(t.value)&&(this.hsv[2]=Number(t.value),this.updateHsv(),this.convertToOtherFormat());break;case"A":this.opacitySlider.value=Number(t.value);break}}},t.prototype.inputValueChange=function(e,t,i){e[0]!==this.hsv[0]&&(this.hueSlider.setProperties({value:e[0]},!0),this.hueSlider.refresh(),this.setHsvContainerBg(e[0])),this.hsv=e;var n=this.rgbToHex(this.rgb);this.setHandlerPosition(),this.updateInput(i||n);var r=this.convertToRgbString(this.rgb);this.updatePreview(r),this.triggerEvent(n,t,r)},t.prototype.triggerEvent=function(e,t,i,n){void 0===n&&(n=!1);var r=e.slice(0,7);this.showButtons||n?this.trigger("select",{currentValue:{hex:r,rgba:i},previousValue:{hex:t.slice(0,7),rgba:this.convertToRgbString(this.hexToRgb(t))}}):(this.trigger("change",{currentValue:{hex:r,rgba:i},previousValue:{hex:this.value.slice(0,7),rgba:this.convertToRgbString(this.hexToRgb(this.value))},value:e}),this.enableOpacity?this.setProperties({value:e},!0):this.setProperties({value:r},!0),this.element.value=r||"#000000")},t.prototype.destroy=function(){var t=this,i=this.getWrapper();e.prototype.destroy.call(this),["tabindex","spellcheck"].forEach(function(e){t.element.removeAttribute(e)}),this.inline?(this.unWireEvents(),this.destroyOtherComp()):(this.isPopupOpen()&&(this.unWireEvents(),this.destroyOtherComp()),this.splitBtn.destroy(),this.splitBtn=null),this.tileRipple(),this.tileRipple=null,this.ctrlBtnRipple(),this.ctrlBtnRipple=null,this.element.nextElementSibling&&Object(w["F"])(this.element.nextElementSibling),i&&(i.parentElement.insertBefore(this.element,i),Object(w["F"])(i)),this.container=null,this.formElement&&w["l"].remove(this.formElement,"reset",this.formResetHandler)},t.prototype.destroyOtherComp=function(){if(this.isPicker()){this.hueSlider.destroy(),this.enableOpacity&&(this.opacitySlider.destroy(),this.opacitySlider=null),this.hueSlider=null;var e=this.getTooltipInst();e.close(),e.destroy(),this.tooltipEle=null}},t.prototype.isPopupOpen=function(){return this.getPopupEle().classList.contains("e-popup-open")},t.prototype.unWireEvents=function(){if(this.isPicker()){var e=this.getDragHandler();w["l"].remove(e,"keydown",this.pickerKeyDown),w["l"].remove(this.getHsvContainer(),"mousedown touchstart",this.handlerDown),(this.modeSwitcher||this.showButtons)&&w["l"].remove(Object(w["jb"])("."+$o,this.container),"click",this.btnClickHandler),w["l"].remove(Object(w["jb"])("."+ml,this.container),"click",this.previewHandler)}else w["l"].remove(this.container,"click",this.paletteClickHandler),w["l"].remove(this.container,"keydown",this.paletteKeyDown)},t.prototype.roundValue=function(e){if(!e)return"";"#"!==e[0]&&(e="#"+e);var t=e.length;if(4===t&&(e+="f",t=5),5===t){for(var i="",n=1,r=e.length;n<r;n++)i+=e.charAt(n)+e.charAt(n);e="#"+i,t=9}return 7===t&&(e+="ff"),e},t.prototype.hexToRgb=function(e){if(!e)return[];e=e.trim(),9!==e.length&&(e=this.roundValue(e));var t=Number((parseInt(e.slice(-2),16)/255).toFixed(2));e=e.slice(1,7);var i=parseInt(e,16),n=[];return n.push(i>>16&255),n.push(i>>8&255),n.push(255&i),n.push(t),n},t.prototype.rgbToHsv=function(e,t,i,n){if(this.rgb&&!this.rgb.length)return[];e/=255,t/=255,i/=255;var r,s=Math.max(e,t,i),a=Math.min(e,t,i),o=s,l=s-a,d=0===s?0:l/s;if(s===a)r=0;else{switch(s){case e:r=(t-i)/l+(t<i?6:0);break;case t:r=(i-e)/l+2;break;case i:r=(e-t)/l+4;break}r/=6}var c=[Math.round(360*r),Math.round(1e3*d)/10,Math.round(1e3*o)/10];return Object(w["T"])(n)||c.push(n),c},t.prototype.hsvToRgb=function(e,t,i,n){var r,s,a;if(t/=100,i/=100,0===t)return r=s=a=i,[Math.round(255*r),Math.round(255*s),Math.round(255*a),n];e/=60;var o=Math.floor(e),l=e-o,d=i*(1-t),c=i*(1-t*l),h=i*(1-t*(1-l));switch(o){case 0:r=i,s=h,a=d;break;case 1:r=c,s=i,a=d;break;case 2:r=d,s=i,a=h;break;case 3:r=d,s=c,a=i;break;case 4:r=h,s=d,a=i;break;default:r=i,s=d,a=c}var p=[Math.round(255*r),Math.round(255*s),Math.round(255*a)];return Object(w["T"])(n)||p.push(n),p},t.prototype.rgbToHex=function(e){return e.length?"#"+this.hex(e[0])+this.hex(e[1])+this.hex(e[2])+(Object(w["T"])(e[3])?"":0!==e[3]?(Math.round(255*e[3])+65536).toString(16).substr(-2):"00"):""},t.prototype.hex=function(e){return("0"+e.toString(16)).slice(-2)},t.prototype.changeModeSwitcherProp=function(e){var t=Object(w["jb"])("."+$o,this.container);e?t?this.appendModeSwitchBtn():(this.createCtrlBtn(),this.isPicker()&&!this.disabled&&this.addCtrlSwitchEvent()):t&&(this.showButtons?Object(w["F"])(Object(w["jb"])("."+ol,t)):Object(w["fb"])(t))},t.prototype.changeShowBtnProps=function(e){var t=Object(w["jb"])("."+$o,this.container);e?(t&&Object(w["fb"])(t),this.createCtrlBtn(),this.isPicker()&&!this.disabled&&this.addCtrlSwitchEvent()):this.modeSwitcher?Object(w["F"])(Object(w["jb"])("."+Ko,t)):Object(w["fb"])(t)},t.prototype.changeValueProp=function(e){if(this.isPicker())this.rgb=this.hexToRgb(e),this.hsv=this.rgbToHsv.apply(this,this.rgb),this.setHandlerPosition(),Object(w["F"])(Object(w["A"])(this.hueSlider.element,".e-slider-preview")),this.createSlider(),this.setHsvContainerBg(),this.updateInput(e),4===this.rgb.length&&this.updateOpacityInput(100*this.rgb[3]);else{this.removeTileSelection();var t=this.container.querySelector('span[aria-label="'+this.roundValue(e)+'"]');t&&this.addTileSelection(t)}},t.prototype.setInputEleProps=function(){Object(w["fb"])(Object(w["jb"])("."+al,this.container)),this.createInput()},t.prototype.changeDisabledProp=function(e){this.isPicker()&&(this.hueSlider.enabled=!e,this.opacitySlider.enabled=!e,this.setInputEleProps()),e?(this.toggleDisabled(!0),this.unWireEvents()):(this.toggleDisabled(!1),this.wireEvents())},t.prototype.changeCssClassProps=function(e,t){var i=this.getWrapper(),n=this.getPopupEle();t&&Object(w["gb"])([i,n],t.split(" ")),e&&Object(w["u"])([i,n],e.split(" "))},t.prototype.changeRtlProps=function(e){e?Object(w["u"])([this.getWrapper()],"e-rtl"):Object(w["gb"])([this.getWrapper()],"e-rtl")},t.prototype.changePaletteProps=function(){Object(w["F"])(this.container.children[0]),this.container.style.width="",this.createPalette()},t.prototype.changeOpacityProps=function(e){var t=this.getWrapper();e?(Object(w["gb"])([this.container.parentElement],el),this.createOpacitySlider(Object(w["jb"])(".e-colorpicker-slider",this.container).appendChild(this.createElement("div",{className:"e-opacity-slider"}))),t.classList.contains(il)||t.classList.contains(tl)||this.appendOpacityValue(Object(w["jb"])(".e-input-container",this.container))):(Object(w["u"])([this.container.parentElement],el),this.opacitySlider.destroy(),Object(w["fb"])(this.opacitySlider.element),this.opacitySlider=null,t.classList.contains(il)||t.classList.contains(tl)||Object(w["fb"])(Object(w["jb"])("."+dl,this.container).parentElement))},t.prototype.onPropertyChanged=function(e,t){var i=this;if(!Object(w["T"])(e.value)){var n=this.roundValue(e.value);if(9===n.length){this.element.value=this.roundValue(n).slice(0,7);var r=this.splitBtn&&Object(w["jb"])("."+vl,this.splitBtn.element);r&&(r.style.backgroundColor=this.convertToRgbString(this.hexToRgb(e.value)))}else this.value=t.value}if(!this.inline&&Object(w["T"])(e.inline)){var s=["disabled","enableRtl"];if(this.splitBtn.setProperties(go(e,s)),!this.isPopupOpen())return this.changeCssClassProps(e.cssClass,t.cssClass),void this.changeRtlProps(e.enableRtl)}for(var a=function(n){switch(n){case"inline":e.inline?(o.getWrapper().appendChild(o.container),o.splitBtn.destroy(),Object(w["F"])(o.element.nextElementSibling),o.container.children.length||o.createWidget()):(o.destroyOtherComp(),o.unWireEvents(),o.container.innerHTML="",o.createSplitBtn());break;case"cssClass":o.changeCssClassProps(e.cssClass,t.cssClass);var r=e.cssClass.split(" ").concat(t.cssClass.split(" "));r=r.reduce(function(e,t){return e.indexOf(t)<0&&e.push(t),e},[]);var s=0;r.forEach(function(e){if(0===s&&(e===il||e===nl||e===fl||e===Zo||e===tl)){var t=Object(w["jb"])("."+al,i.container);t&&Object(w["fb"])(Object(w["jb"])("."+al,i.container)),i.createInput(),s++}});break;case"enableRtl":o.isPicker()&&(o.hueSlider.enableRtl=e.enableRtl,o.enableOpacity&&(o.opacitySlider.enableRtl=e.enableRtl),o.setInputEleProps()),o.changeRtlProps(e.enableRtl);break;case"disabled":o.changeDisabledProp(e.disabled);break;case"value":o.value!==t.value&&o.changeValueProp(e.value);break;case"showButtons":o.changeShowBtnProps(e.showButtons);break;case"mode":"Picker"===e.mode?o.switchToPicker():o.switchToPalette();break;case"modeSwitcher":o.changeModeSwitcherProp(e.modeSwitcher);break;case"columns":case"presetColors":o.isPicker()||o.changePaletteProps();break;case"noColor":e.noColor?"Palette"!==o.mode||o.modeSwitcher||o.setNoColor():o.changePaletteProps();break;case"enableOpacity":o.changeOpacityProps(e.enableOpacity);break}},o=this,l=0,d=Object.keys(e);l<d.length;l++){var c=d[l];a(c)}},t.prototype.focusIn=function(){this.element.parentElement.focus()},zo([Object(w["r"])("#008000ff")],t.prototype,"value",void 0),zo([Object(w["r"])("")],t.prototype,"cssClass",void 0),zo([Object(w["r"])(!1)],t.prototype,"disabled",void 0),zo([Object(w["r"])("Picker")],t.prototype,"mode",void 0),zo([Object(w["r"])(!0)],t.prototype,"modeSwitcher",void 0),zo([Object(w["r"])(null)],t.prototype,"presetColors",void 0),zo([Object(w["r"])(!0)],t.prototype,"showButtons",void 0),zo([Object(w["r"])(10)],t.prototype,"columns",void 0),zo([Object(w["r"])(!1)],t.prototype,"inline",void 0),zo([Object(w["r"])(!1)],t.prototype,"noColor",void 0),zo([Object(w["r"])(!1)],t.prototype,"enablePersistence",void 0),zo([Object(w["r"])(!0)],t.prototype,"enableOpacity",void 0),zo([Object(w["r"])(!1)],t.prototype,"createPopupOnClick",void 0),zo([Object(w["k"])()],t.prototype,"select",void 0),zo([Object(w["k"])()],t.prototype,"change",void 0),zo([Object(w["k"])()],t.prototype,"beforeTileRender",void 0),zo([Object(w["k"])()],t.prototype,"beforeOpen",void 0),zo([Object(w["k"])()],t.prototype,"open",void 0),zo([Object(w["k"])()],t.prototype,"beforeClose",void 0),zo([Object(w["k"])()],t.prototype,"beforeModeSwitch",void 0),zo([Object(w["k"])()],t.prototype,"onModeSwitch",void 0),zo([Object(w["k"])()],t.prototype,"created",void 0),t=zo([w["p"]],t),t}(w["h"]),Ol=function(){function e(e){this.parent=e,this.wireEvent()}return e.prototype.wireEvent=function(){this.parent.on(Wt,this.unWireEvent,this)},e.prototype.unWireEvent=function(){this.parent.off(Wt,this.unWireEvent),this.popupOverlay&&w["l"].remove(this.popupOverlay,"click touchmove",this.onPopupOverlay),this.removePopupContainer()},e.prototype.toolbarBeforeCreate=function(e){"Extended"===this.mode&&(e.enableCollision=!1)},e.prototype.toolbarCreated=function(){this.parent.notify(ai,this)},e.prototype.toolbarClicked=function(e){this.parent.enabled&&(this.parent.readonly&&!Object(w["T"])(e.item)||this.parent.notify(Kt,e),this.parent.trigger("toolbarClick",e))},e.prototype.dropDownSelected=function(e){this.parent.notify(ci,e),this.onPopupOverlay()},e.prototype.beforeDropDownItemRender=function(e){!this.parent.readonly&&this.parent.enabled&&this.parent.notify(hi,e)},e.prototype.dropDownOpen=function(e){if(e.element.parentElement.getAttribute("id").indexOf("TableCell")>-1&&!Object(w["T"])(e.element.parentElement.querySelector(".e-cell-merge"))&&(!Object(w["T"])(e.element.parentElement.querySelector(".e-cell-horizontal-split"))||!Object(w["T"])(e.element.parentElement.querySelector(".e-cell-vertical-split")))){var t=e.element.querySelectorAll("li");1===this.parent.inputElement.querySelectorAll(".e-cell-select").length?(Object(w["u"])([t[0]],"e-disabled"),Object(w["gb"])([t[1],t[2]],"e-disabled")):this.parent.inputElement.querySelectorAll(".e-cell-select").length>1&&(Object(w["gb"])([t[0]],"e-disabled"),Object(w["u"])([t[1],t[2]],"e-disabled"))}w["d"].isDevice&&!e.element.parentElement.classList.contains(Vn)&&this.popupModal(e.element.parentElement),this.parent.notify(Ei,e)},e.prototype.dropDownClose=function(e){this.removePopupContainer(),this.parent.notify(Ii,e)},e.prototype.removePopupContainer=function(){if(w["d"].isDevice&&!Object(w["T"])(this.popupContainer)){var e=this.popupContainer.querySelector(".e-dropdown-popup.e-tbar-btn.e-control");e&&(this.popupContainer.parentNode.insertBefore(e,this.popupContainer.nextSibling),e.style.removeProperty("position"),Object(w["gb"])([e],"e-popup-modal")),Object(w["F"])(this.popupContainer),this.popupContainer=void 0}},e.prototype.renderToolbar=function(e){this.setPanel(e.target),this.renderPanel(),this.mode=e.overflowMode,e.rteToolbarObj.toolbarObj=new Be["a"]({items:e.items,width:"100%",overflowMode:e.overflowMode,beforeCreate:this.toolbarBeforeCreate.bind(this),created:this.toolbarCreated.bind(this),clicked:this.toolbarClicked.bind(this),enablePersistence:e.enablePersistence,enableRtl:e.enableRtl,cssClass:e.cssClass}),e.rteToolbarObj.toolbarObj.isStringTemplate=!0,e.rteToolbarObj.toolbarObj.createElement=this.parent.createElement,e.rteToolbarObj.toolbarObj.appendTo(e.target)},e.prototype.renderDropDownButton=function(e){var t,i=this;e.element.classList.add(Kn),t=e.cssClass+" "+cr+" "+hr,this.parent.inlineMode.enable&&w["d"].isDevice&&(t=t+" "+_n);var n=this,r=new To({items:e.items,iconCss:e.iconCss,cssClass:t,content:e.content,enablePersistence:this.parent.enablePersistence,enableRtl:this.parent.enableRtl,select:this.dropDownSelected.bind(this),beforeOpen:function(e){if(!n.parent.readonly&&n.parent.enabled){for(var t=0;t<e.element.childNodes.length;t++){var s=i.parent.createElement("div");s.innerHTML=r.content.trim(),""!==s.textContent.trim()&&e.element.childNodes[t].textContent.trim()===s.textContent.trim()?e.element.childNodes[t].classList.contains("e-active")||Object(w["u"])([e.element.childNodes[t]],"e-active"):Object(w["gb"])([e.element.childNodes[t]],"e-active")}n.parent.notify(Di,e)}else e.cancel=!0},close:this.dropDownClose.bind(this),open:this.dropDownOpen.bind(this),beforeItemRender:this.beforeDropDownItemRender.bind(this)});r.isStringTemplate=!0,r.createElement=n.parent.createElement,r.appendTo(e.element),e.element.tabIndex=-1;var s=document.getElementById(r.element.id+"-popup");return s.setAttribute("aria-owns",this.parent.getID()),r},e.prototype.renderListDropDown=function(e){var t=this,i=cr+" "+hr+(this.parent.inlineMode?" "+_n:"");i+=" "+("NumberFormatList"===e.itemName?gr:fr);var n=t.parent.createElement("span",{className:mr}),r=t.parent.createElement("span",{className:e.cssClass});n.appendChild(r);var s=new To({items:e.items,cssClass:i,content:e.content,enablePersistence:this.parent.enablePersistence,enableRtl:this.parent.enableRtl,select:this.dropDownSelected.bind(this),beforeOpen:function(e){if(!t.parent.readonly&&t.parent.enabled){var i=e.event?e.event.target:null;t.currentElement=s.element,t.currentDropdown=s,e.event&&"click"===e.event.type&&(i.classList.contains(mr)||i.parentElement.classList.contains(mr))?e.cancel=!0:t.parent.notify(Di,e)}else e.cancel=!0},close:this.dropDownClose.bind(this),open:this.dropDownOpen.bind(this),beforeItemRender:this.beforeDropDownItemRender.bind(this)});s.isStringTemplate=!0,s.createElement=t.parent.createElement,s.appendTo(e.element),e.element.tabIndex=-1;var a=document.getElementById(s.element.id+"-popup");return a.setAttribute("aria-owns",this.parent.getID()),1===e.element.childElementCount&&s.element.insertBefore(n,s.element.querySelector(".e-caret")),e.element.tabIndex=-1,s.element.removeAttribute("type"),s},e.prototype.onPopupOverlay=function(e){Object(w["T"])(this.popupOverlay)||(Object(w["A"])(this.popupOverlay,".e-popup-container").style.display="none",this.popupOverlay.style.display="none",Object(w["gb"])([this.popupOverlay],"e-popup-overlay"))},e.prototype.setIsModel=function(e){Object(w["A"])(e,".e-popup-container")?(e.parentElement.style.display="flex",this.popupOverlay=e.nextElementSibling,this.popupOverlay.style.display="block",Object(w["u"])([this.popupOverlay],"e-popup-overlay")):(this.popupContainer=this.parent.createElement("div",{className:"e-rte-modal-popup e-popup-container e-center"}),e.parentNode.insertBefore(this.popupContainer,e),this.popupContainer.appendChild(e),this.popupContainer.style.zIndex=e.style.zIndex,this.popupContainer.style.display="flex",e.style.position="relative",Object(w["u"])([e],"e-popup-modal"),this.popupOverlay=this.parent.createElement("div",{className:"e-popup-overlay"}),this.popupOverlay.style.zIndex=(parseInt(e.style.zIndex,null)-1).toString(),this.popupOverlay.style.display="block",this.popupContainer.appendChild(this.popupOverlay),w["l"].add(this.popupOverlay,"click touchmove",this.onPopupOverlay,this))},e.prototype.paletteSelection=function(e,t){var i=e.element.querySelector(".e-control.e-colorpicker"),n=[].slice.call(Object(w["kb"])(".e-tile",i.parentElement));Object(w["gb"])(n,"e-selected");var r=t.querySelector("."+cr).style.borderBottomColor;n.filter(function(e){e.style.backgroundColor===r&&Object(w["u"])([e],"e-selected")})},e.prototype.renderColorPickerDropDown=function(e,t,i,n){var r=this,s=this,a=cr+" "+hr+(this.parent.inlineMode?" "+_n:"");a+=" "+("backgroundcolor"===t?Sr:kr),a+=" "+this.parent.cssClass;var o,l=s.parent.createElement("span",{className:Tr}),d=s.parent.createElement("span",{className:e.cssClass}),c=Object(w["T"])(n)?s.parent.backgroundColor.default:n;d.style.borderBottomColor="backgroundcolor"===t?c:s.parent.fontColor.default,l.appendChild(d);var h=new To({target:i.element.parentElement,cssClass:a,enablePersistence:this.parent.enablePersistence,enableRtl:this.parent.enableRtl,beforeOpen:function(t){if(!s.parent.readonly&&s.parent.enabled){var i=t.event?t.event.target:null;if(s.currentElement=h.element,s.currentDropdown=h,s.paletteSelection(t,s.currentElement),t.event&&"click"===t.event.type&&(i.classList.contains(Tr)||i.parentElement.classList.contains(Tr))){t.cancel=!0;var n=i.classList.contains(cr)?i.style.borderBottomColor:i.querySelector("."+cr).style.borderBottomColor;s.parent.notify(Ii,{}),o=s.parent.formatter.editorManager.nodeSelection.getRange(s.parent.contentModule.getDocument());var r=o.startContainer.parentNode;("TD"===o.startContainer.nodeName||"TH"===o.startContainer.nodeName||Object(w["A"])(o.startContainer.parentNode,"td,th")||s.parent.iframeSettings.enable&&!Fa(r.ownerDocument.querySelector("body"),"e-lib"))&&o.collapsed&&"BackgroundColor"===e.subCommand?s.parent.notify(Hi,{item:{command:e.command,subCommand:e.subCommand,value:n}}):s.parent.notify(Fi,{item:{command:e.command,subCommand:e.subCommand,value:n}})}else{var a=t.element.querySelector(".e-control.e-colorpicker"),l=Object(w["M"])(a,wl);l.showButtons=!t.element.querySelector(".e-color-palette"),l.dataBind(),t.element.onclick=function(e){e.target.classList.contains("e-cancel")&&h.toggle()}}}else t.cancel=!0},open:function(e){var t;r.setColorPickerContentWidth(i);var n=e.element.querySelector(".e-control.e-colorpicker");t=e.element.querySelector(".e-color-palette")?n.parentElement.querySelector(".e-palette"):n.parentElement.querySelector("e-handler"),t&&t.focus(),w["d"].isDevice&&r.popupModal(e.element.parentElement),r.pickerRefresh(e)},beforeClose:function(t){var i=t.event?t.event.target:null;if(t.event&&"click"===t.event.type&&(i.classList.contains(Tr)||i.parentElement.classList.contains(Tr))){var n=i.classList.contains(cr)?i.style.borderBottomColor:i.querySelector("."+cr).style.borderBottomColor;return o=s.parent.formatter.editorManager.nodeSelection.getRange(s.parent.contentModule.getDocument()),void(("TD"===o.startContainer.nodeName||"TH"===o.startContainer.nodeName||Object(w["A"])(o.startContainer.parentNode,"td,th"))&&o.collapsed?s.parent.notify(Hi,{item:{command:e.command,subCommand:e.subCommand,value:n}}):s.parent.notify(Fi,{item:{command:e.command,subCommand:e.subCommand,value:n}}))}},close:function(e){s.parent.notify(Ii,{});var t=Object(w["A"])(e.element.parentElement,".e-popup-container");if(t&&(t.style.display="none",t.lastElementChild.style.display="none",Object(w["gb"])([t.lastElementChild],"e-popup-overlay")),w["d"].isDevice&&!Object(w["T"])(t)){var i=t.querySelector(".e-dropdown-popup.e-tbar-btn.e-control");i&&(t.parentNode.insertBefore(i,t.nextSibling),i.style.removeProperty("position"),Object(w["gb"])([i],"e-popup-modal")),Object(w["F"])(t),s.popupContainer=void 0}}});h.isStringTemplate=!0,h.createElement=s.parent.createElement,e.element.setAttribute("role","button"),h.appendTo(e.element);var p=document.getElementById(h.element.id+"-popup");return p.setAttribute("aria-owns",this.parent.getID()),h.element.insertBefore(l,h.element.querySelector(".e-caret")),e.element.tabIndex=-1,h.element.removeAttribute("type"),h.element.onmousedown=function(){s.parent.notify(Ei,{})},h.element.onkeydown=function(){s.parent.notify(Ei,{})},h},e.prototype.pickerRefresh=function(e){if("Picker"===this.parent.backgroundColor.mode){var t=e.element.parentElement;t.style.width=(t.offsetWidth+5).toString()+"px",Object(w["M"])(t,Vt["a"]).refreshPosition(t),t.style.width=(t.offsetWidth-5).toString()+"px"}},e.prototype.popupModal=function(e){var t=Object(w["M"])(e,Vt["a"]);t.relateTo=document.body,t.position={X:0,Y:0},t.targetType="container",t.collision={X:"fit",Y:"fit"},t.offsetY=4,t.dataBind(),this.setIsModel(e)},e.prototype.setColorPickerContentWidth=function(e){var t=e.element.nextSibling;if("0px"===t.style.width){t.style.width="";var i=parseInt(getComputedStyle(t).borderBottomWidth,10);t.style.width=Object(w["H"])(t.children[0].offsetWidth+i+i)}},e.prototype.renderColorPicker=function(e,t){var i,n=this,r=this,s=new wl({enablePersistence:this.parent.enablePersistence,enableRtl:this.parent.enableRtl,inline:!0,value:"#fff",created:function(){var e="backgroundcolor"===t?r.parent.backgroundColor.default:r.parent.fontColor.default;s.setProperties({value:e})},mode:"backgroundcolor"===t?r.parent.backgroundColor.mode:r.parent.fontColor.mode,modeSwitcher:"backgroundcolor"===t?r.parent.backgroundColor.modeSwitcher:r.parent.fontColor.modeSwitcher,beforeTileRender:function(e){if(e.element.classList.add(jr),e.element.classList.add(Pr),!Object(w["T"])(n.parent.cssClass))for(var t=n.parent.cssClass.split(" "),i=0;i<t.length;i++)""!==t[i].trim()&&e.element.classList.add(t[i]);""===e.value&&e.element.classList.add(Lr)},change:function(t){var i=t.currentValue.rgba;t.item={command:e.command,subCommand:e.subCommand,value:i},r.parent.notify(Ii,{}),r.currentElement.querySelector("."+cr).style.borderBottomColor=i;var n=r.parent.formatter.editorManager.nodeSelection.getRange(r.parent.contentModule.getDocument()),s=Object(w["A"])(n.startContainer.parentNode,"table");("TD"===n.startContainer.nodeName||"TH"===n.startContainer.nodeName||"BODY"===n.startContainer.nodeName||Object(w["A"])(n.startContainer.parentNode,"td,th"))&&n.collapsed&&"BackgroundColor"===e.subCommand&&Object(w["A"])(s,"."+kn)?r.parent.notify(Hi,t):r.parent.notify(Fi,t),r.currentDropdown.toggle()},beforeModeSwitch:function(e){i=s.value,""===i&&s.setProperties({value:"Picker"===e.mode?"#008000ff":""},!0),s.showButtons="Palette"!==e.mode}});return s.isStringTemplate=!0,s.columns="backgroundcolor"===t?this.parent.backgroundColor.columns:this.parent.fontColor.columns,s.presetColors="backgroundcolor"===t?this.parent.backgroundColor.colorCode:this.parent.fontColor.colorCode,s.cssClass=("backgroundcolor"===t?Dr:Rr)+" "+e.cssClass,s.createElement=this.parent.createElement,s.appendTo(document.getElementById(e.target)),s},e.prototype.renderPanel=function(){this.getPanel().classList.add(En)},e.prototype.getPanel=function(){return this.toolbarPanel},e.prototype.setPanel=function(e){this.toolbarPanel=e},e}(),Tl=function(){function e(e,t){this.tools={},this.parent=e,this.locator=t,this.renderFactory=this.locator.getService("rendererFactory"),this.addEventListener(),this.parent.toolbarSettings&&Object.keys(this.parent.toolbarSettings.itemConfigs).length>0?Object(w["G"])(this.tools,Ps,Qa(this.parent.toolbarSettings.itemConfigs),!0):this.tools=Ps}return e.prototype.addEventListener=function(){this.parent.on(Wi,this.setRtl,this),this.parent.on(wn,this.setCssClass,this),this.parent.on(Wt,this.removeEventListener,this)},e.prototype.removeEventListener=function(){this.parent.off(Wi,this.setRtl),this.parent.off(wn,this.setCssClass),this.parent.off(Wt,this.removeEventListener)},e.prototype.setCssClass=function(e){Object(w["T"])(this.toolbarObj)||(Object(w["T"])(e.oldCssClass)?this.toolbarObj.setProperties({cssClass:(this.toolbarObj.cssClass+" "+e.cssClass).trim()}):this.toolbarObj.setProperties({cssClass:(this.toolbarObj.cssClass.replace(e.oldCssClass,"").trim()+" "+e.cssClass).trim()}))},e.prototype.setRtl=function(e){Object(w["T"])(this.toolbarObj)||this.toolbarObj.setProperties({enableRtl:e.enableRtl})},e.prototype.getClass=function(e){var t;switch(e){case"fontsize":t="e-rte-inline-size-template";break;case"fontcolor":case"backgroundcolor":t="e-rte-inline-color-template";break;default:t="e-rte-inline-template";break}return t},e.prototype.getTemplateObject=function(e,t){var i;switch(e){case"fontcolor":case"backgroundcolor":case"numberformatlist":case"bulletformatlist":i="span";break;default:i="button";break}return{command:this.tools[e.toLocaleLowerCase()].command,subCommand:this.tools[e.toLocaleLowerCase()].subCommand,template:this.parent.createElement(i,{id:this.parent.getID()+"_"+t+"_"+this.tools[e.toLocaleLowerCase()].id}).outerHTML,cssClass:this.parent.inlineMode.enable?this.getClass(e):"",tooltipText:_a(e,this.locator)}},e.prototype.getObject=function(e,t){var i=e.toLowerCase();if(-1!==Ms.indexOf(i))return this.getTemplateObject(i,t);switch(i){case"|":return{type:"Separator"};case"-":return{type:"Separator",cssClass:pr};default:return{id:this.parent.getID()+"_"+t+"_"+this.tools[i.toLocaleLowerCase()].id,prefixIcon:this.tools[i.toLocaleLowerCase()].icon,tooltipText:_a(i,this.locator),command:this.tools[i.toLocaleLowerCase()].command,subCommand:this.tools[i.toLocaleLowerCase()].subCommand}}},e.prototype.getItems=function(e,t){var i=this;if(this.parent.toolbarSettings.items.length<1)return[];for(var n=[],r=function(e){switch(typeof e){case"string":n.push(s.getObject(e,t));break;default:if(!Object(w["T"])(e.click)){var r=e,a=r.click;r.click=function(){r.undo&&0===i.parent.formatter.getUndoRedoStack().length&&i.parent.formatter.saveData(),a.call(i),i.parent.formatter.getUndoRedoStack()[i.parent.formatter.getUndoRedoStack().length-1].text.trim()!==i.parent.inputElement.innerHTML.trim()&&r.undo&&i.parent.formatter.saveData()}}n.push(e)}},s=this,a=0,o=e;a<o.length;a++){var l=o[a];r(l)}return n},e.prototype.getToolbarOptions=function(e){return{target:e.target,rteToolbarObj:this,items:this.getItems(e.items,e.container),overflowMode:e.mode,enablePersistence:this.parent.enablePersistence,enableRtl:this.parent.enableRtl,cssClass:e.cssClass}},e.prototype.render=function(e){this.toolbarRenderer=this.renderFactory.getRenderer(ve.Toolbar),this.toolbarRenderer.renderToolbar(this.getToolbarOptions(e))},e}(),kl=function(){function e(e,t){this.parent=e,this.locator=t,this.renderFactory=this.locator.getService("rendererFactory"),this.addEventListener()}return e.prototype.initializeInstance=function(){this.toolbarRenderer=this.renderFactory.getRenderer(ve.Toolbar)},e.prototype.beforeRender=function(e){var t=e.item;t.cssClass&&Object(w["u"])([e.element],t.cssClass),"Alignments"!==t.command&&"JustifyLeft"!==t.subCommand&&"JustifyRight"!==t.subCommand&&"JustifyCenter"!==t.subCommand||e.element.setAttribute("title",_a(t.subCommand.toLocaleLowerCase(),this.locator))},e.prototype.dropdownContent=function(e,t,i){return'<span style="display: inline-flex;width:'+("quick"===t?"auto":e)+'" ><span class="e-rte-dropdown-btn-text">'+i+"</span></span>"},e.prototype.renderDropDowns=function(e){var t=this;this.initializeInstance();var i=e.containerType,n=e.container;Ms.forEach(function(r){var s=void 0;if(-1!==Ba(r,e.items))switch(r){case"numberformatlist":if(s=Object(w["jb"])("#"+t.parent.getID()+"_"+i+"_NumberFormatList",n),Object(w["T"])(s)||s.classList.contains(Kn))return;var a=t.parent.numberFormatList.types.slice();a.forEach(function(e){Object.defineProperties(e,{command:{value:"Lists",enumerable:!0},subCommand:{value:"NumberFormatList",enumerable:!0}})}),t.numberFormatListDropDown=t.toolbarRenderer.renderListDropDown({cssClass:"e-order-list "+cr+" "+or,itemName:"NumberFormatList",items:a,element:s});break;case"bulletformatlist":if(s=Object(w["jb"])("#"+t.parent.getID()+"_"+i+"_BulletFormatList",n),Object(w["T"])(s)||s.classList.contains(Kn))return;var o=t.parent.bulletFormatList.types.slice();o.forEach(function(e){Object.defineProperties(e,{command:{value:"Lists",enumerable:!0},subCommand:{value:"BulletFormatList",enumerable:!0}})}),t.bulletFormatListDropDown=t.toolbarRenderer.renderListDropDown({cssClass:"e-unorder-list "+cr+" "+or,itemName:"BulletFormatList",items:o,element:s});break;case"formats":if(s=Object(w["jb"])("#"+t.parent.getID()+"_"+i+"_Formats",n),Object(w["T"])(s)||s.classList.contains(Kn))return;var l=t.parent.format.types.slice();l.forEach(function(e){Object.defineProperties(e,{command:{value:"Formats",enumerable:!0},subCommand:{value:e.value,enumerable:!0}})});var d=Object(w["T"])(t.parent.format.default)?l[0].text:t.parent.format.default;t.formatDropDown=t.toolbarRenderer.renderDropDownButton({iconCss:"quick"===i?"e-formats e-icons":"",content:t.dropdownContent(t.parent.format.width,i,"quick"===i?"":Ha(l,d,"text","text")),cssClass:Un+" "+Wn+" "+br,itemName:"Formats",items:l,element:s});break;case"fontname":if(s=Object(w["jb"])("#"+t.parent.getID()+"_"+i+"_FontName",n),Object(w["T"])(s)||s.classList.contains(Kn))return;var c=t.parent.fontFamily.items.slice();c.forEach(function(e){Object.defineProperties(e,{command:{value:"Font",enumerable:!0},subCommand:{value:"FontName",enumerable:!0}})});var h=Object(w["T"])(t.parent.fontFamily.default)?c[0].text:t.parent.fontFamily.default;t.fontNameDropDown=t.toolbarRenderer.renderDropDownButton({iconCss:"quick"===i?"e-font-name e-icons":"",content:t.dropdownContent(t.parent.fontFamily.width,i,"quick"===i?"":Ha(c,h,"text","text")),cssClass:Un+" "+Wn+" "+vr,itemName:"FontName",items:c,element:s}),Object(w["T"])(t.parent.fontFamily.default)||(t.getEditNode().style.fontFamily=t.parent.fontFamily.default);break;case"fontsize":if(s=Object(w["jb"])("#"+t.parent.getID()+"_"+i+"_FontSize",n),Object(w["T"])(s)||s.classList.contains(Kn))return;var p=t.parent.fontSize.items.slice();p.forEach(function(e){Object.defineProperties(e,{command:{value:"Font",enumerable:!0},subCommand:{value:"FontSize",enumerable:!0}})});var u=Object(w["T"])(t.parent.fontSize.default)?p[1].text:t.parent.fontSize.default;t.fontSizeDropDown=t.toolbarRenderer.renderDropDownButton({content:t.dropdownContent(t.parent.fontSize.width,i,qa(Ha(p,u.replace(/\s/g,""),"value","text"))),cssClass:Un+" "+Wn+" "+yr,itemName:"FontSize",items:p,element:s}),Object(w["T"])(t.parent.fontSize.default)||(t.getEditNode().style.fontSize=t.parent.fontSize.default);break;case"alignments":if(s=Object(w["jb"])("#"+t.parent.getID()+"_"+i+"_Alignments",n),Object(w["T"])(s)||s.classList.contains(Kn))return;t.alignDropDown=t.toolbarRenderer.renderDropDownButton({iconCss:"e-justify-left e-icons",cssClass:Un+" "+Wn+" "+Cr,itemName:"Alignments",items:Ns,element:s});break;case"align":t.imageAlignmentDropDown(i,n,s);break;case"display":t.imageDisplayDropDown(i,n,s);break;case"tablerows":t.rowDropDown(i,n,s);break;case"tablecolumns":t.columnDropDown(i,n,s);break;case"tablecell":t.cellDropDown(i,n,s);break;case"tablecellverticalalign":t.verticalAlignDropDown(i,n,s);break;case"styles":t.tableStylesDropDown(i,n,s);break}}),this.parent.inlineMode.enable&&this.setCssClass({cssClass:this.parent.cssClass})},e.prototype.getUpdateItems=function(e,t){var i=e.slice();return i.forEach(function(e){Object.defineProperties(e,{command:{value:"Format"===t?"Formats":"Font",enumerable:!0},subCommand:{value:"Format"===t?e.value:t,enumerable:!0}})}),i},e.prototype.onPropertyChanged=function(e){for(var t,i,n=e.newProp,r=0,s=Object.keys(n);r<s.length;r++){var a=s[r];switch(a){case"fontFamily":if(this.fontNameDropDown)for(var o=0,l=Object.keys(n.fontFamily);o<l.length;o++){var d=l[o];switch(d){case"default":case"width":var c=this.fontNameDropDown.items;t=Object(w["T"])(Object(w["A"])(this.fontNameDropDown.element,"."+An))?"toolbar":"quick";var h=Object(w["T"])(this.parent.fontFamily.default)?c[0].text:this.parent.fontFamily.default;i=this.dropdownContent(this.parent.fontFamily.width,t,"quick"===t?"":Ha(c,h,"text","text")),this.fontNameDropDown.setProperties({content:i}),Object(w["T"])(this.parent.fontFamily.default)?this.getEditNode().style.removeProperty("font-family"):this.getEditNode().style.fontFamily=this.parent.fontFamily.default;break;case"items":this.fontNameDropDown.setProperties({items:this.getUpdateItems(n.fontFamily.items,"FontName")});break}}break;case"fontSize":if(this.fontSizeDropDown)for(var p=0,u=Object.keys(n.fontSize);p<u.length;p++){var m=u[p];switch(m){case"default":case"width":var g=this.fontSizeDropDown.items;t=Object(w["T"])(Object(w["A"])(this.fontSizeDropDown.element,"."+An))?"toolbar":"quick";var f=Object(w["T"])(this.parent.fontSize.default)?g[1].text:this.parent.fontSize.default;i=this.dropdownContent(this.parent.fontSize.width,t,qa(Ha(g,f.replace(/\s/g,""),"value","text"))),this.fontSizeDropDown.setProperties({content:i}),Object(w["T"])(this.parent.fontSize.default)?this.getEditNode().style.removeProperty("font-size"):this.getEditNode().style.fontSize=this.parent.fontSize.default;break;case"items":this.fontSizeDropDown.setProperties({items:this.getUpdateItems(n.fontSize.items,"FontSize")});break}}break;case"format":if(this.formatDropDown)for(var b=0,v=Object.keys(n.format);b<v.length;b++){var y=v[b];switch(y){case"default":case"width":var C=this.formatDropDown.items;t=Object(w["T"])(Object(w["A"])(this.formatDropDown.element,"."+An))?"toolbar":"quick";var O=Object(w["T"])(this.parent.format.default)?C[0].text:this.parent.format.default;i=this.dropdownContent(this.parent.format.width,t,"quick"===t?"":Ha(C,O,"text","text")),this.formatDropDown.setProperties({content:i});break;case"types":this.formatDropDown.setProperties({items:this.getUpdateItems(n.format.types,"Format")});break}}break}}},e.prototype.getEditNode=function(){return this.parent.contentModule.getEditPanel()},e.prototype.rowDropDown=function(e,t,i){i=Object(w["jb"])("#"+this.parent.getID()+"_"+e+"_TableRows",t),i.classList.contains(Kn)||(this.tableRowsDropDown=this.toolbarRenderer.renderDropDownButton({iconCss:"e-table-rows e-icons",cssClass:Un+" "+Wn+" "+Vn,itemName:"TableRows",items:qs,element:i}))},e.prototype.columnDropDown=function(e,t,i){i=Object(w["jb"])("#"+this.parent.getID()+"_"+e+"_TableColumns",t),i.classList.contains(Kn)||(this.tableColumnsDropDown=this.toolbarRenderer.renderDropDownButton({iconCss:"e-table-columns e-icons",cssClass:Un+" "+Wn+" "+Vn,itemName:"TableColumns",items:_s,element:i}))},e.prototype.cellDropDown=function(e,t,i){i=Object(w["jb"])("#"+this.parent.getID()+"_"+e+"_TableCell",t),i.classList.contains(Kn)||(this.tableRowsDropDown=this.toolbarRenderer.renderDropDownButton({iconCss:"e-table-cell e-icons",cssClass:Un+" "+Wn+" "+Vn,itemName:"TableCell",items:Hs,element:i}))},e.prototype.verticalAlignDropDown=function(e,t,i){i=Object(w["jb"])("#"+this.parent.getID()+"_"+e+"_TableCellVerticalAlign",t),i.classList.contains(Kn)||(this.tableCellVerticalAlignDropDown=this.toolbarRenderer.renderDropDownButton({iconCss:"e-table-cell-ver-align e-icons",cssClass:Un+" "+Wn+" "+Vn,itemName:"TableCellVerticalAlign",items:Gs,element:i}))},e.prototype.imageDisplayDropDown=function(e,t,i){i=Object(w["jb"])("#"+this.parent.getID()+"_"+e+"_Display",t),i.classList.contains(Kn)||(this.displayDropDown=this.toolbarRenderer.renderDropDownButton({iconCss:"e-display e-icons",cssClass:Un+" "+Wn+" "+Vn,itemName:"Display",items:Fs,element:i}))},e.prototype.imageAlignmentDropDown=function(e,t,i){i=Object(w["jb"])("#"+this.parent.getID()+"_"+e+"_Align",t),i.classList.contains(Kn)||(this.imageAlignDropDown=this.toolbarRenderer.renderDropDownButton({iconCss:"e-justify-left e-icons",cssClass:Un+" "+Gn+" "+Vn,itemName:"Align",items:As,element:i}))},e.prototype.tableStylesDropDown=function(e,t,i){i=Object(w["jb"])("#"+this.parent.getID()+"_"+e+"_Styles",t),i.classList.contains(Kn)||(this.imageAlignDropDown=this.toolbarRenderer.renderDropDownButton({iconCss:"e-style e-icons",cssClass:Un+" "+Gn+" "+Vn,itemName:"Styles",items:this.parent.tableSettings.styles,element:i}))},e.prototype.removeDropDownClasses=function(e){Object(w["gb"])([e],[Kn,Un,Gn,Wn])},e.prototype.destroyDropDowns=function(){this.formatDropDown&&(this.removeDropDownClasses(this.formatDropDown.element),this.formatDropDown.destroy()),this.fontNameDropDown&&(this.removeDropDownClasses(this.fontNameDropDown.element),this.fontNameDropDown.destroy()),this.fontSizeDropDown&&(this.removeDropDownClasses(this.fontSizeDropDown.element),this.fontSizeDropDown.destroy()),this.alignDropDown&&(this.removeDropDownClasses(this.alignDropDown.element),this.alignDropDown.destroy()),this.imageAlignDropDown&&(this.removeDropDownClasses(this.imageAlignDropDown.element),this.imageAlignDropDown.destroy()),this.displayDropDown&&(this.removeDropDownClasses(this.displayDropDown.element),this.displayDropDown.destroy()),this.tableRowsDropDown&&(this.removeDropDownClasses(this.tableRowsDropDown.element),this.tableRowsDropDown.destroy()),this.tableColumnsDropDown&&(this.removeDropDownClasses(this.tableColumnsDropDown.element),this.tableColumnsDropDown.destroy()),this.tableCellVerticalAlignDropDown&&(this.removeDropDownClasses(this.tableCellVerticalAlignDropDown.element),this.tableCellVerticalAlignDropDown.destroy()),this.numberFormatListDropDown&&(this.removeDropDownClasses(this.numberFormatListDropDown.element),this.numberFormatListDropDown.destroy()),this.bulletFormatListDropDown&&(this.removeDropDownClasses(this.bulletFormatListDropDown.element),this.bulletFormatListDropDown.destroy())},e.prototype.setRtl=function(e){this.formatDropDown&&this.formatDropDown.setProperties({enableRtl:e.enableRtl}),this.fontNameDropDown&&this.fontNameDropDown.setProperties({enableRtl:e.enableRtl}),this.fontSizeDropDown&&this.fontSizeDropDown.setProperties({enableRtl:e.enableRtl}),this.alignDropDown&&this.alignDropDown.setProperties({enableRtl:e.enableRtl}),this.imageAlignDropDown&&this.imageAlignDropDown.setProperties({enableRtl:e.enableRtl}),this.displayDropDown&&this.displayDropDown.setProperties({enableRtl:e.enableRtl}),this.numberFormatListDropDown&&this.numberFormatListDropDown.setProperties({enableRtl:e.enableRtl}),this.bulletFormatListDropDown&&this.bulletFormatListDropDown.setProperties({enableRtl:e.enableRtl})},e.prototype.updateCss=function(e,t){e&&t.cssClass&&(Object(w["T"])(t.oldCssClass)?e.setProperties({cssClass:(e.cssClass+" "+t.cssClass).trim()}):e.setProperties({cssClass:(e.cssClass.replace(t.oldCssClass,"").trim()+" "+t.cssClass).trim()}))},e.prototype.setCssClass=function(e){for(var t=[this.formatDropDown,this.fontNameDropDown,this.fontSizeDropDown,this.alignDropDown,this.imageAlignDropDown,this.displayDropDown,this.numberFormatListDropDown,this.bulletFormatListDropDown,this.tableRowsDropDown,this.tableColumnsDropDown,this.tableCellVerticalAlignDropDown],i=0;i<t.length;i++)this.updateCss(t[i],e)},e.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(hi,this.beforeRender,this),this.parent.on(Gt,this.onIframeMouseDown,this),this.parent.on(Wi,this.setRtl,this),this.parent.on(Wt,this.removeEventListener,this),this.parent.on(ii,this.onPropertyChanged,this),this.parent.on(wn,this.setCssClass,this))},e.prototype.onIframeMouseDown=function(){$a(document,"mousedown")},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Gt,this.onIframeMouseDown),this.parent.off(Wi,this.setRtl),this.parent.off(hi,this.beforeRender),this.parent.off(Wt,this.removeEventListener),this.parent.off(ii,this.onPropertyChanged),this.parent.off(wn,this.setCssClass))},e}(),Sl=function(){function e(e){this.parent=e,this.addEventListener(),this.serviceLocator=new ns,this.serviceLocator.register("rendererFactory",new rs)}return e.prototype.addEventListener=function(){this.parent.on(Kt,this.toolbarClick,this),this.parent.on(ci,this.dropDownSelect,this),this.parent.on(Fi,this.renderSelection,this),this.parent.on(Wt,this.removeEventListener,this)},e.prototype.toolbarClick=function(e){if(!Object(w["T"])(e.item)){if(!Object(w["T"])(e.item.controlParent)){var t=e.item.controlParent.activeEle;t&&(t.tabIndex=-1)}"NumberFormatList"!==e.item.command&&"BulletFormatList"!==e.item.command||(e.originalEvent.target.classList.contains("e-order-list")||e.originalEvent.target.classList.contains("e-unorder-list"))&&(e.item.command="Lists",e.item.subCommand="NumberFormatList"===e.item.subCommand?"OL":"UL"),"Lists"===e.item.command&&e.originalEvent.target.classList.contains("e-caret")&&(e.originalEvent.target.parentElement.classList.contains("e-rte-bulletformatlist-dropdown")||e.originalEvent.target.parentElement.classList.contains("e-rte-numberformatlist-dropdown"))&&(e.item.command=e.item.subCommand=null),this.parent.notify(Zt,e),this.parent.notify(ei,e)}},e.prototype.dropDownSelect=function(e){if(this.parent.notify(Ii,{}),!document.body.contains(document.body.querySelector(".e-rte-quick-toolbar"))||!e.item||"Images"!==e.item.command&&"Display"!==e.item.command&&"Table"!==e.item.command){var t=e.item.controlParent&&this.parent.quickToolbarModule&&this.parent.quickToolbarModule.tableQTBar&&this.parent.quickToolbarModule.tableQTBar.element.contains(e.item.controlParent.element)?"Table":null;if("Lists"===e.item.command){var i={listStyle:e.item.value,listImage:e.item.listImage,type:e.item.subCommand};this.parent.formatter.process(this.parent,e,e.originalEvent,i)}else this.parent.formatter.process(this.parent,e,e.originalEvent,t)}this.parent.notify(Ei,{})},e.prototype.renderSelection=function(e){this.parent.notify(Ii,{}),this.parent.formatter.process(this.parent,e,e.originalEvent,null),this.parent.notify(Ei,{})},e.prototype.removeEventListener=function(){this.parent.off(Kt,this.toolbarClick),this.parent.off(ci,this.dropDownSelect),this.parent.off(Fi,this.renderSelection),this.parent.off(Wt,this.removeEventListener)},e}(),jl=function(){function e(e,t){this.parent=e,this.isToolbar=!1,this.locator=t,this.isTransformChild=!1,this.renderFactory=this.locator.getService("rendererFactory"),na(this.parent),so(this.parent),this.renderFactory.addRenderer(ve.Toolbar,new Ol(this.parent)),this.toolbarRenderer=this.renderFactory.getRenderer(ve.Toolbar),this.baseToolbar=new Tl(this.parent,this.locator),this.addEventListener(),this.parent.toolbarSettings&&Object.keys(this.parent.toolbarSettings.itemConfigs).length>0?Object(w["G"])(this.tools,Ps,Qa(this.parent.toolbarSettings.itemConfigs),!0):this.tools=Ps}return e.prototype.initializeInstance=function(){this.contentRenderer=this.renderFactory.getRenderer(ve.Content),this.editableElement=this.contentRenderer.getEditPanel(),this.editPanel=this.contentRenderer.getPanel()},e.prototype.toolbarBindEvent=function(){this.parent.inlineMode.enable||(this.keyBoardModule=new w["n"](this.getToolbarElement(),{keyAction:this.toolBarKeyDown.bind(this),keyConfigs:this.parent.formatter.keyConfig,eventName:"keydown"}))},e.prototype.toolBarKeyDown=function(e){switch(e.action){case"escape":this.parent.contentModule.getEditPanel().focus();break}},e.prototype.createToolbarElement=function(){this.tbElement=this.parent.createElement("div",{id:this.parent.getID()+"_toolbar"}),!w["d"].isDevice&&this.parent.inlineMode.enable&&Va()||(this.parent.toolbarSettings.enableFloating&&!this.parent.inlineMode.enable?(this.tbWrapper=this.parent.createElement("div",{id:this.parent.getID()+"_toolbar_wrapper",innerHTML:this.tbElement.outerHTML,className:Jn}),this.tbElement=this.tbWrapper.firstElementChild,this.parent.element.insertBefore(this.tbWrapper,this.editPanel)):this.parent.element.insertBefore(this.tbElement,this.editPanel))},e.prototype.getToolbarMode=function(){var e;switch(this.parent.toolbarSettings.type){case ye.Expand:e="Extended";break;case ye.Scrollable:e="Scrollable";break;default:e="MultiRow"}return Va()&&this.parent.toolbarSettings.type===ye.Expand&&(e=ye.Scrollable),e},e.prototype.checkToolbarResponsive=function(e){return!(!w["d"].isDevice||Va())&&(t=this.parent.toolbarSettings.type===ye.Expand?ye.MultiRow:this.parent.toolbarSettings.type,this.baseToolbar.render({container:this.parent.inlineMode.enable?"quick":"toolbar",items:this.parent.toolbarSettings.items,mode:t,target:e,cssClass:this.parent.cssClass}),this.parent.toolbarSettings.type===ye.Expand&&(Object(w["u"])([e],["e-rte-tb-mobile"]),this.parent.inlineMode.enable?this.addFixedTBarClass():Object(w["u"])([e],[Fn])),this.wireEvents(),this.dropDownModule.renderDropDowns({container:e,containerType:this.parent.inlineMode.enable?"quick":"toolbar",items:this.parent.toolbarSettings.items}),this.parent.notify(Yt,{container:this.tbElement,containerType:this.parent.inlineMode.enable?"quick":"toolbar",items:this.parent.toolbarSettings.items}),!0);var t},e.prototype.checkIsTransformChild=function(){this.isTransformChild=!1;for(var e=Object(w["kb"])('[style*="transform"]',document),t=0;t<e.length;t++)if(!Object(w["T"])(e[t].contains)&&e[t].contains(this.parent.element)){this.isTransformChild=!0;break}},e.prototype.toggleFloatClass=function(e){var t,i,n=!1,r=!1,s=this.parent.floatingToolbarOffset;e&&this.parent.iframeSettings.enable&&this.parent.inputElement.ownerDocument===e.target?i=e.target.body:e&&e.target!==document?i=e.target:(n=!0,i=document.body);var a=this.getToolbarHeight()+this.getExpandTBarPopHeight();if(this.isTransformChild){t=0;var o=0,l=this.parent.element.offsetHeight;if(n){var d=window.getComputedStyle(i);o=parseFloat(d.marginTop.split("px")[0])+parseFloat(d.paddingTop.split("px")[0])}var c=this.parent.element.getBoundingClientRect().top,h=w["d"].isMSPointer&&n?window.pageYOffset:i.parentElement.scrollTop,p=i.getBoundingClientRect(),u=n?p.top+h:p.top,m=!(c-(n?0:u)+l>a+s);c>u+s||c<-l||c<0&&m?(r=!1,Object(w["gb"])([this.tbElement],[Mn])):c<u+s&&(t=c<0?-c+u:u-c,t=n?t-o:t,Object(w["u"])([this.tbElement],[Mn]),r=!0)}else{var g=this.parent.element.getBoundingClientRect();if(window.innerHeight<g.top)return;t=e&&e.target!==document?i.getBoundingClientRect().top:0,g.bottom<s+a+t||g.bottom<0||g.top>s+t?r=!1:(g.top<s||g.top<s+t)&&(r=!0)}r?(Object(w["u"])([this.tbElement],[xn]),Object(w["mb"])(this.tbElement,{width:this.parent.element.offsetWidth+"px",top:s+t+"px"})):(Object(w["gb"])([this.tbElement],[xn]),Object(w["mb"])(this.tbElement,{top:"0px",width:"100%"}))},e.prototype.renderToolbar=function(){if(this.initializeInstance(),this.createToolbarElement(),!this.checkToolbarResponsive(this.tbElement)){this.parent.inlineMode.enable?this.parent.notify(Ui,{}):(this.baseToolbar.render({container:"toolbar",items:this.parent.toolbarSettings.items,mode:this.getToolbarMode(),target:this.tbElement,cssClass:this.parent.cssClass}),this.parent.inlineMode.enable||(this.parent.toolbarSettings.enableFloating&&(this.checkIsTransformChild(),this.toggleFloatClass()),Object(w["u"])([this.parent.element],[Ar]),this.parent.toolbarSettings.type===ye.Expand&&Object(w["u"])([this.parent.element],[Ln]))),this.wireEvents(),this.parent.inlineMode.enable&&!Va()&&this.addFixedTBarClass(),this.parent.inlineMode.enable||(this.dropDownModule.renderDropDowns({container:this.tbElement,containerType:"toolbar",items:this.parent.toolbarSettings.items}),this.parent.notify(Yt,{container:this.tbElement,containerType:"toolbar",items:this.parent.toolbarSettings.items}),this.refreshToolbarOverflow());var e=this.parent.element.querySelector(".e-rte-srctextarea"),t=this.parent.element.querySelector(".e-source-content");(!this.parent.iframeSettings.enable&&!Object(w["T"])(e)&&"block"===e.style.display||this.parent.iframeSettings.enable&&!Object(w["T"])(t)&&"block"===t.style.display)&&(this.parent.notify(Ti,{targetItem:"SourceCode",updateItem:"Preview",baseToolbar:this.parent.getBaseToolbarObject()}),this.parent.disableToolbarItem(this.parent.toolbarSettings.items))}},e.prototype.addFixedTBarClass=function(){Object(w["u"])([this.tbElement],[In])},e.prototype.removeFixedTBarClass=function(){Object(w["gb"])([this.tbElement],[In])},e.prototype.showFixedTBar=function(){Object(w["u"])([this.tbElement],[Qn]),w["d"].isIos&&Object(w["u"])([this.tbElement],[ur])},e.prototype.hideFixedTBar=function(){this.isToolbar?this.isToolbar=!1:Object(w["gb"])([this.tbElement],[Qn,ur])},e.prototype.updateItem=function(e){var t=this.tools[e.updateItem.toLocaleLowerCase()],i=this.tools[e.targetItem.toLocaleLowerCase()],n=Wa(Ga(i.subCommand),e.baseToolbar.toolbarObj.items)[0];if(Object(w["T"])(n))this.addTBarItem(e,0);else{var r=this.parent.inlineMode.enable?"_quick_":"_toolbar_";e.baseToolbar.toolbarObj.items[n].id=this.parent.getID()+r+t.id,e.baseToolbar.toolbarObj.items[n].prefixIcon=t.icon,e.baseToolbar.toolbarObj.items[n].tooltipText=t.tooltip,e.baseToolbar.toolbarObj.items[n].subCommand=t.subCommand,e.baseToolbar.toolbarObj.dataBind()}},e.prototype.updateToolbarStatus=function(e){if(this.tbElement&&(!this.parent.inlineMode.enable||!Va()&&w["d"].isDevice)){var t={args:e,dropDownModule:this.dropDownModule,parent:this.parent,tbElements:Object(w["kb"])("."+Xn,this.tbElement),tbItems:this.baseToolbar.toolbarObj.items};Ua(t,!!this.parent.inlineMode.enable,this.parent)}},e.prototype.fullScreen=function(e){this.parent.fullScreenModule.showFullScreen(e)},e.prototype.hideScreen=function(e){this.parent.fullScreenModule.hideFullScreen(e)},e.prototype.getBaseToolbar=function(){return this.baseToolbar},e.prototype.addTBarItem=function(e,t){e.baseToolbar.toolbarObj.addItems([e.baseToolbar.getObject(e.updateItem,"toolbar")],t)},e.prototype.enableTBarItems=function(e,t,i,n){var r=Wa(Ga(t),e.toolbarObj.items);this.tbItems=Object(w["kb"])("."+Xn,e.toolbarObj.element);for(var s=0;s<r.length;s++){var a=this.tbItems[r[s]];a&&e.toolbarObj.enableItems(a,i)}Object(w["jb"])(".e-rte-srctextarea",this.parent.element)||n||Ka(e,this.parent.formatter.editorManager.undoRedoManager.getUndoStatus())},e.prototype.removeTBarItems=function(e){Object(w["T"])(this.baseToolbar.toolbarObj)&&(this.baseToolbar=this.parent.getBaseToolbarObject());var t=Wa(Ga(e),this.baseToolbar.toolbarObj.items);this.tbItems=this.parent.inlineMode.enable?Object(w["kb"])("."+Xn,this.baseToolbar.toolbarObj.element):Object(w["kb"])("."+Xn,this.parent.element);for(var i=0;i<t.length;i++)this.baseToolbar.toolbarObj.removeItems(this.tbItems[t[i]])},e.prototype.getExpandTBarPopHeight=function(){var e=0;if(this.parent.toolbarSettings.type===ye.Expand&&this.tbElement.classList.contains("e-extended-toolbar")){var t=Object(w["jb"])(".e-toolbar-extended",this.tbElement);t&&this.tbElement.classList.contains("e-expand-open")||t&&t.classList.contains("e-popup-open")?(Object(w["u"])([t],[Zn]),e+=t.offsetHeight,Object(w["gb"])([t],[Zn])):Object(w["gb"])([this.tbElement],[dr])}return e},e.prototype.getToolbarHeight=function(){return this.tbElement.offsetHeight},e.prototype.getToolbarElement=function(){return Object(w["jb"])("."+En,this.parent.element)},e.prototype.refreshToolbarOverflow=function(){this.baseToolbar.toolbarObj.refreshOverflow()},e.prototype.isToolbarDestroyed=function(){return this.baseToolbar.toolbarObj&&!this.baseToolbar.toolbarObj.isDestroyed},e.prototype.destroyToolbar=function(){if(this.isToolbarDestroyed()){this.parent.unWireScrollElementsEvents(),this.unWireEvents(),this.parent.notify(ti,{}),this.dropDownModule.destroyDropDowns(),this.baseToolbar.toolbarObj.destroy(),this.removeEventListener(),Object(w["gb"])([this.parent.element],[Ar]),Object(w["gb"])([this.parent.element],[Ln]);var e=Object(w["jb"])("."+Jn,this.parent.element),t=Object(w["jb"])("."+En,this.parent.element);Object(w["T"])(e)?Object(w["T"])(t)||Object(w["F"])(t):Object(w["F"])(e)}},e.prototype.destroy=function(){this.isToolbarDestroyed()&&(this.destroyToolbar(),this.keyBoardModule&&this.keyBoardModule.destroy())},e.prototype.scrollHandler=function(e){this.parent.inlineMode.enable||this.parent.toolbarSettings.enableFloating&&this.getDOMVisibility(this.tbElement)&&this.toggleFloatClass(e.args)},e.prototype.getDOMVisibility=function(e){return!(!e.offsetParent&&0===e.offsetWidth&&0===e.offsetHeight)},e.prototype.mouseDownHandler=function(){w["d"].isDevice&&this.parent.inlineMode.enable&&!Va()&&this.showFixedTBar()},e.prototype.focusChangeHandler=function(){w["d"].isDevice&&this.parent.inlineMode.enable&&!Va()&&(this.isToolbar=!1,this.hideFixedTBar())},e.prototype.dropDownBeforeOpenHandler=function(){this.isToolbar=!0},e.prototype.tbFocusHandler=function(e){var t=document.activeElement,i=Object(w["A"])(t,".e-rte-toolbar");if(t===this.parent.getToolbarElement()||i===this.parent.getToolbarElement())for(var n=this.parent.getToolbarElement().querySelectorAll(".e-expended-nav"),r=0;r<n.length;r++)Object(w["T"])(this.parent.getToolbarElement().querySelector(".e-insert-table-btn"))?n[r].setAttribute("tabindex","0"):n[r].setAttribute("tabindex","1")},e.prototype.tbKeydownHandler=function(e){(e.target.classList.contains("e-dropdown-btn")||e.target.getAttribute("id")===this.parent.getID()+"_toolbar_CreateTable")&&e.target.setAttribute("tabindex","0")},e.prototype.toolbarClickHandler=function(e){var t=Object(w["A"])(e.originalEvent.target,".e-hor-nav");t&&this.parent.toolbarSettings.type===ye.Expand&&!Object(w["T"])(t)?t.classList.contains("e-nav-active")?(Object(w["u"])([this.tbElement],[dr]),this.parent.setContentHeight("toolbar",!0)):(Object(w["gb"])([this.tbElement],[dr]),this.parent.setContentHeight("toolbar",!1)):(w["d"].isDevice||this.parent.inlineMode.enable)&&(this.isToolbar=!0),Object(w["T"])(t)&&this.parent.toolbarSettings.type===ye.Expand&&Object(w["gb"])([this.tbElement],[dr])},e.prototype.wireEvents=function(){this.parent.inlineMode.enable&&Va()||(w["l"].add(this.tbElement,"focusin",this.tbFocusHandler,this),w["l"].add(this.tbElement,"keydown",this.tbKeydownHandler,this))},e.prototype.unWireEvents=function(){w["l"].remove(this.tbElement,"focusin",this.tbFocusHandler),w["l"].remove(this.tbElement,"keydown",this.tbKeydownHandler)},e.prototype.addEventListener=function(){this.parent.isDestroyed||(this.dropDownModule=new kl(this.parent,this.locator),this.toolbarActionModule=new Sl(this.parent),this.parent.on(Ut,this.renderToolbar,this),this.parent.on(Ai,this.scrollHandler,this),this.parent.on(Qt,this.toolbarBindEvent,this),this.parent.on(Jt,this.updateToolbarStatus,this),this.parent.on(ii,this.onPropertyChanged,this),this.parent.on(Xt,this.onRefresh,this),this.parent.on(Wt,this.destroy,this),this.parent.on(li,this.fullScreen,this),this.parent.on(di,this.hideScreen,this),this.parent.on(Ti,this.updateItem,this),this.parent.on(Di,this.dropDownBeforeOpenHandler,this),this.parent.on(xi,this.parent.setContentHeight,this.parent),this.parent.on(Vi,this.focusChangeHandler,this),this.parent.on(Pi,this.mouseDownHandler,this),this.parent.on(Li,this.mouseDownHandler,this),this.parent.on(wn,this.setCssClass,this),this.parent.inlineMode.enable||Va()||this.parent.on(Kt,this.toolbarClickHandler,this))},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Ut,this.renderToolbar),this.parent.off(Ai,this.scrollHandler),this.parent.off(Qt,this.toolbarBindEvent),this.parent.off(Jt,this.updateToolbarStatus),this.parent.off(ii,this.onPropertyChanged),this.parent.off(Xt,this.onRefresh),this.parent.off(Wt,this.destroy),this.parent.off(li,this.parent.fullScreenModule.showFullScreen),this.parent.off(di,this.parent.fullScreenModule.hideFullScreen),this.parent.off(Ti,this.updateItem),this.parent.off(Di,this.dropDownBeforeOpenHandler),this.parent.off(xi,this.parent.setContentHeight),this.parent.off(Vi,this.focusChangeHandler),this.parent.off(Pi,this.mouseDownHandler),this.parent.off(Li,this.mouseDownHandler),this.parent.off(wn,this.setCssClass),this.parent.inlineMode.enable||Va()||this.parent.off(Kt,this.toolbarClickHandler))},e.prototype.setCssClass=function(e){this.toolbarObj&&e.cssClass&&(Object(w["T"])(e.oldCssClass)?this.toolbarObj.setProperties({cssClass:(this.toolbarObj.cssClass+" "+e.cssClass).trim()}):this.toolbarObj.setProperties({cssClass:(this.toolbarObj.cssClass.replace(e.oldCssClass,"").trim()+" "+e.cssClass).trim()}))},e.prototype.onRefresh=function(){this.parent.inlineMode.enable||this.refreshToolbarOverflow(),this.parent.setContentHeight("",!0)},e.prototype.onPropertyChanged=function(e){if(!Object(w["T"])(e.newProp.inlineMode))for(var t=0,i=Object.keys(e.newProp.inlineMode);t<i.length;t++){var n=i[t];switch(n){case"enable":this.refreshToolbar();break}}e.module===this.getModuleName()&&this.refreshToolbar()},e.prototype.refreshToolbar=function(){Object(w["T"])(this.baseToolbar.toolbarObj)&&(this.baseToolbar=this.parent.getBaseToolbarObject());var e=Object(w["jb"])("."+Jn,this.parent.element),t=Object(w["jb"])("."+En,this.parent.element);(t||e)&&this.destroyToolbar(),this.parent.toolbarSettings.enable&&(this.addEventListener(),this.renderToolbar(),this.parent.wireScrollElementsEvents(),Object(w["jb"])(".e-rte-srctextarea",this.parent.element)||Ka(this.baseToolbar,this.parent.formatter.editorManager.undoRedoManager.getUndoStatus()),this.parent.notify(un,{}))},e.prototype.getModuleName=function(){return"toolbar"},e}(),Rl=["a","abbr","acronym","audio","b","bdi","bdo","big","br","button","canvas","cite","code","data","datalist","del","dfn","em","embed","font","i","iframe","img","input","ins","kbd","label","map","mark","meter","noscript","object","output","picture","progress","q","ruby","s","samp","script","select","slot","small","span","strong","strike","sub","sup","svg","template","textarea","time","u","tt","var","video","wbr"];function Dl(){var e=!1;return w["d"].isDevice&&w["d"].isIos&&(e=!0),e}function El(e,t){if("BODY"===e.nodeName&&!Object(w["T"])(t)){var i=top.window.document.querySelector(t);Object(w["T"])(i)||i.contentWindow.focus()}}function Il(e){var t=document.createElement("div");t.innerHTML=e,t.setAttribute("class","tempDiv");var i=document.createElement("div"),n=t.childNodes;if(n.length>0){var r=void 0,s=void 0,a=void 0;while(t.firstChild)"#text"===t.firstChild.nodeName&&(t.firstChild.textContent.indexOf("\n")<0||""!==t.firstChild.textContent.trim())||Rl.indexOf(t.firstChild.nodeName.toLocaleLowerCase())>=0?(r?s.appendChild(t.firstChild):(a=Object(w["C"])("p"),i.appendChild(a),a.appendChild(t.firstChild)),s=a,r=!0):"#text"===t.firstChild.nodeName&&("\n"===t.firstChild.textContent||t.firstChild.textContent.indexOf("\n")>=0&&""===t.firstChild.textContent.trim())?Object(w["F"])(t.firstChild):(i.appendChild(t.firstChild),r=!1);for(var o=i.querySelectorAll("table"),l=0;l<o.length;l++){"0"===o[l].getAttribute("border")&&o[l].removeAttribute("border");for(var d=o[l].querySelectorAll("td"),c=0;c<d.length;c++)"none"===d[c].style.borderLeft&&d[c].style.removeProperty("border-left"),"none"===d[c].style.borderRight&&d[c].style.removeProperty("border-right"),"none"===d[c].style.borderBottom&&d[c].style.removeProperty("border-bottom"),"none"===d[c].style.borderTop&&d[c].style.removeProperty("border-top"),"none"===d[c].style.border&&d[c].style.removeProperty("border");o[l].classList.contains("e-rte-table")||o[l].classList.add("e-rte-table")}var h=i.querySelectorAll("img");for(l=0;l<h.length;l++)h[l].classList.contains("e-rte-image")||h[l].classList.add("e-rte-image"),h[l].classList.contains("e-imginline")||h[l].classList.contains("e-imgbreak")||h[l].classList.add("e-imginline")}return i.innerHTML}function xl(e){var t=e;do{t.childNodes.length>0&&(t=t.childNodes[0])}while(t.childNodes.length>0);return t}function Ml(){return{bold:!1,italic:!1,subscript:!1,superscript:!1,strikethrough:!1,orderedlist:!1,unorderedlist:!1,underline:!1,alignments:null,backgroundcolor:null,fontcolor:null,fontname:null,fontsize:null,formats:null,createlink:!1,insertcode:!1}}var Pl=function(){function e(e,t){this.parent=e,this.rteID=e.element.id,this.i10n=t.getService("rteLocale"),this.addEventListener(),this.serviceLocator=t,this.rendererFactory=t.getService("rendererFactory"),this.dialogRenderObj=t.getService("dialogRenderObject")}return e.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(fi,this.linkDialog,this),this.parent.on(gn,this.showDialog,this),this.parent.on(fn,this.closeDialog,this),this.parent.on(ri,this.onKeyDown,this),this.parent.on(Si,this.showLinkQuickToolbar,this),this.parent.on(tn,this.clearDialogObj,this),this.parent.on(mi,this.onToolbarAction,this),this.parent.on(Gt,this.onIframeMouseDown,this),this.parent.on(bi,this.removeLink,this),this.parent.on(vi,this.editLink,this),this.parent.on(yi,this.openLink,this),this.parent.on(Ni,this.editAreaClickHandler,this),this.parent.on(wn,this.setCssClass,this),this.parent.on(Wt,this.destroy,this))},e.prototype.onToolbarAction=function(e){var t=e.args.item;switch(t.subCommand){case"OpenLink":this.parent.notify(yi,e);break;case"EditLink":this.parent.notify(vi,e);break;case"RemoveLink":this.parent.notify(bi,e);break}},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(fi,this.linkDialog),this.parent.off(gn,this.showDialog),this.parent.off(fn,this.closeDialog),this.parent.off(ri,this.onKeyDown),this.parent.off(Si,this.showLinkQuickToolbar),this.parent.off(tn,this.clearDialogObj),this.parent.off(mi,this.onToolbarAction),this.parent.off(bi,this.removeLink),this.parent.off(Gt,this.onIframeMouseDown),this.parent.off(vi,this.editLink),this.parent.off(yi,this.openLink),this.parent.off(Ni,this.editAreaClickHandler),this.parent.off(wn,this.setCssClass),this.parent.off(Wt,this.destroy))},e.prototype.onIframeMouseDown=function(){this.dialogObj&&this.dialogObj.hide({returnValue:!0})},e.prototype.updateCss=function(e,t){e&&t.cssClass&&(Object(w["T"])(t.oldCssClass)?e.setProperties({cssClass:(e.cssClass+" "+t.cssClass).trim()}):e.setProperties({cssClass:(e.cssClass.replace(t.oldCssClass,"").trim()+" "+t.cssClass).trim()}))},e.prototype.setCssClass=function(e){this.updateCss(this.checkBoxObj,e),this.updateCss(this.dialogObj,e)},e.prototype.showLinkQuickToolbar=function(e){if(!Object(w["T"])(e.args)&&"enter"!==e.args.action&&"space"!==e.args.action){var t=void 0,i=void 0;if("Links"!==e.type||Object(w["T"])(this.parent.quickToolbarModule)||Object(w["T"])(this.parent.quickToolbarModule.linkQTBar))return;this.quickToolObj=this.parent.quickToolbarModule;var n,r=this.parent.element.getBoundingClientRect().top,s=this.parent.element.getBoundingClientRect().left,a=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument());if([].forEach.call(e.elements,function(e,t){0===t&&(n="#text"===e.nodeName?e.parentNode:e)}),e.isNotify){var o=this.parent.toolbarModule.getToolbarElement(),l=n.getBoundingClientRect().top,d=n.getBoundingClientRect().left,c=l-r,h=o?o.offsetHeight+this.parent.toolbarModule.getExpandTBarPopHeight():0;t=this.parent.iframeSettings.enable?s+d:n.getBoundingClientRect().left,i=window.pageYOffset+(this.parent.iframeSettings.enable?r+h+l:r+c)}else{var p=void 0;p=e.args.touches?e.args.changedTouches[0]:p=e.args,t=this.parent.iframeSettings.enable?window.pageXOffset+s+p.clientX:p.pageX,i=this.parent.iframeSettings.enable?window.pageYOffset+r+p.clientY:p.pageY}this.quickToolObj.linkQTBar&&this.quickToolObj.linkQTBar.showPopup(t,i,a.endContainer)}},e.prototype.hideLinkQuickToolbar=function(){this.quickToolObj&&this.quickToolObj.linkQTBar&&document.body.contains(this.quickToolObj.linkQTBar.element)&&this.quickToolObj.linkQTBar.hidePopup()},e.prototype.editAreaClickHandler=function(e){if(this.parent.readonly)this.hideLinkQuickToolbar();else{var t=e.args,i=this.parent.quickToolbarSettings.showOnRightClick;if(!(2===t.which||i&&1===t.which||!i&&3===t.which)&&"HTML"===this.parent.editorMode&&this.parent.quickToolbarModule&&this.parent.quickToolbarModule.linkQTBar){this.quickToolObj=this.parent.quickToolbarModule;var n=t.target;n=this.getAnchorNode(n),this.contentModule=this.rendererFactory.getRenderer(ve.Content);var r=this.quickToolObj.linkQTBar.element.classList.contains("e-rte-pop");if("A"===n.nodeName&&n.childNodes.length>0&&"IMG"!==n.childNodes[0].nodeName&&"IMG"!==e.args.target.nodeName&&!Object(w["T"])(Object(w["A"])(this.parent.getRange().startContainer.parentElement,"A"))&&!Object(w["T"])(Object(w["A"])(this.parent.getRange().endContainer.parentElement,"A"))){if(r)return;this.showLinkQuickToolbar({args:t,isNotify:!1,type:"Links",elements:[t.target]})}else this.hideLinkQuickToolbar()}}},e.prototype.onKeyDown=function(e){var t=e.args;switch(t.action){case"escape":Object(w["T"])(this.dialogObj)||this.dialogObj.close();break;case"insert-link":this.openDialog(!0,e),t.preventDefault();break}},e.prototype.openDialog=function(e,t){if(e||this.parent.contentModule.getEditPanel().focus(),"HTML"===this.parent.editorMode){var i=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()),n=this.parent.formatter.editorManager.nodeSelection.save(i,this.parent.contentModule.getDocument()),r=this.parent.formatter.editorManager.nodeSelection.getNodeCollection(i),s=this.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(i),a={args:t?t.args:{item:{command:"Links",subCommand:"CreateLink"},originalEvent:void 0},selectNode:r,selection:n,selectParent:s};this.linkDialog(a)}else{var o=this.parent.contentModule.getEditPanel();this.parent.formatter.editorManager.markdownSelection.save(o.selectionStart,o.selectionEnd),this.linkDialog({args:{item:{command:"Links",subCommand:"Link"},originalEvent:t&&t.args},member:"link",text:this.parent.formatter.editorManager.markdownSelection.getSelectedText(this.parent.contentModule.getEditPanel()),module:"Markdown",name:"insertLink"})}},e.prototype.showDialog=function(){this.openDialog(!1),this.setCssClass({cssClass:this.parent.cssClass})},e.prototype.closeDialog=function(){this.dialogObj&&this.dialogObj.hide({returnValue:!0})},e.prototype.clearDialogObj=function(){this.dialogObj&&(this.dialogObj.destroy(),Object(w["F"])(this.dialogObj.element),this.dialogObj=null)},e.prototype.linkDialog=function(e,t){var i=this;if(this.dialogObj)this.dialogObj.hide({returnValue:!0});else if("HTML"===this.parent.editorMode&&e.selectParent.length>0&&!Object(w["T"])(e.selectParent[0].classList)&&e.selectParent[0].classList.contains("e-rte-anchor")&&Object(w["T"])(t))this.editLink(e);else{var n=this.i10n.getConstant("linkWebUrl"),r=this.i10n.getConstant("linkText"),s=this.i10n.getConstant("linkTooltipLabel"),a=this.i10n.getConstant("linkurl"),o=this.i10n.getConstant("textPlaceholder"),l=this.i10n.getConstant("linkTitle"),d=this.parent.createElement("div",{className:"e-rte-link-dialog "+this.parent.cssClass,id:this.rteID+"_rtelink"});this.parent.element.appendChild(d);var c=this.parent.createElement("div",{className:"e-rte-linkcontent "+this.parent.cssClass,id:this.rteID+"_linkContent"}),h="HTML"===this.parent.editorMode?"<label>"+s+'</label></div><div class="e-rte-field '+this.parent.cssClass+'"><input type="text" data-role ="none" spellcheck="false" placeholder = "'+l+'" class="e-input e-rte-linkTitle '+this.parent.cssClass+'"></div><div class="e-rte-label '+this.parent.cssClass+'"></div><div class="e-rte-field '+this.parent.cssClass+'"><input type="checkbox" class="e-rte-linkTarget '+this.parent.cssClass+'"  data-role ="none"></div>':"",p='<div class="e-rte-label '+this.parent.cssClass+'"><label>'+n+'</label></div><div class="e-rte-field '+this.parent.cssClass+'"><input type="text" data-role ="none" spellcheck="false" placeholder="'+a+'" class="e-input e-rte-linkurl '+this.parent.cssClass+'"/></div><div class="e-rte-label '+this.parent.cssClass+'"><label>'+r+'</label></div><div class="e-rte-field '+this.parent.cssClass+'"> <input type="text" data-role ="none" spellcheck="false" class="e-input e-rte-linkText '+this.parent.cssClass+'" placeholder="'+o+'"></div><div class="e-rte-label '+this.parent.cssClass+'">'+h,u=Xa(p);c.appendChild(u);var m=c.querySelector(".e-rte-linkTarget"),g=c.querySelector(".e-rte-linkurl"),f=c.querySelector(".e-rte-linkText"),b=c.querySelector(".e-rte-linkTitle"),v=this.i10n.getConstant("linkOpenInNewWindow");this.checkBoxObj=new V["a"]({label:v,checked:!0,enableRtl:this.parent.enableRtl,cssClass:this.parent.cssClass}),this.checkBoxObj.isStringTemplate=!0,this.checkBoxObj.createElement=this.parent.createElement,this.checkBoxObj.appendTo(m);var y="HTML"===this.parent.editorMode?e.selection.getRange(this.parent.contentModule.getDocument()).toString():e.text,C=this.i10n.getConstant("dialogInsert"),O=this.i10n.getConstant("dialogCancel"),T=e.selection,k={selfLink:this,selection:e.selection,selectParent:e.selectParent,args:e.args},S={header:this.i10n.getConstant("linkHeader"),content:c,cssClass:cr+" "+this.parent.cssClass,enableRtl:this.parent.enableRtl,locale:this.parent.locale,showCloseIcon:!0,closeOnEscape:!0,width:w["d"].isDevice?"290px":"310px",height:"inherit",isModal:w["d"].isDevice,buttons:[{click:this.insertlink.bind(k),buttonModel:{content:C,cssClass:"e-flat e-insertLink "+this.parent.cssClass,isPrimary:!0}},{click:this.cancelDialog.bind(k),buttonModel:{cssClass:"e-flat "+this.parent.cssClass,content:O}}],target:w["d"].isDevice?document.body:this.parent.element,animationSettings:{effect:"None"},close:function(e){i.parent.isBlur=!1,e&&e.event.returnValue&&("HTML"===i.parent.editorMode?T.restore():i.parent.formatter.editorManager.markdownSelection.restore(i.parent.contentModule.getEditPanel())),i.dialogObj.destroy(),Object(w["F"])(i.dialogObj.element);var t=i.dialogObj;i.dialogRenderObj.close(t),i.dialogObj=null}};this.dialogObj=this.dialogRenderObj.render(S),this.dialogObj.createElement=this.parent.createElement,this.dialogObj.appendTo(d),d.style.maxHeight="inherit",Object(w["T"])(this.dialogObj)||(Object(w["T"])(t)||(g.value=t.url,f.value=t.text,b.value=t.title,t.target?this.checkBoxObj.checked=!0:this.checkBoxObj.checked=!1,this.dialogObj.header=t.header,this.dialogObj.element.querySelector(".e-insertLink").textContent=t.btnText),this.checkUrl(!1),("HTML"===this.parent.editorMode&&Object(w["T"])(t)&&(!Object(w["T"])(y)&&""!==y&&0===e.selection.range.startOffset||e.selection.range.startOffset!==e.selection.range.endOffset)||"Markdown"===e.module)&&(f.value=y),w["l"].add(this.parent.element.ownerDocument,"mousedown",this.onDocumentClick,this),this.quickToolObj&&(this.hideLinkQuickToolbar(),this.quickToolObj.inlineQTBar&&document.body.contains(this.quickToolObj.inlineQTBar.element)&&this.quickToolObj.inlineQTBar.hidePopup()))}},e.prototype.insertlink=function(e){var t,i=this.selfLink.dialogObj.element,n=i.querySelector(".e-rte-linkurl").value,r=i.querySelector(".e-rte-linkText").value;"HTML"===this.selfLink.parent.editorMode&&(t=i.querySelector(".e-rte-linkTitle").value);var s=this.selfLink.checkBoxObj.checked?"_blank":null;if(""!==n){this.selfLink.isUrl(n)?this.selfLink.checkUrl(!1):(r=""===r?n:r,n=this.selfLink.parent.enableAutoUrl?n:n.indexOf("http")>-1?n:"http://"+n);var a=this.selfLink;if("HTML"===a.parent.editorMode&&Object(w["T"])(Object(w["A"])(this.selection.range.startContainer.parentNode,"[id='"+a.parent.contentModule.getPanel().id+"']"))){a.parent.contentModule.getEditPanel().focus(),w["d"].isIE&&a.parent.iframeSettings.enable&&this.selection.restore();var o=a.parent.formatter.editorManager.nodeSelection.getRange(a.parent.contentModule.getDocument());this.selection=a.parent.formatter.editorManager.nodeSelection.save(o,a.parent.contentModule.getDocument()),this.selectParent=a.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(o)}var l,d={url:n,text:r,title:t,target:s,selection:this.selection,selectParent:this.selectParent};if(document.body.contains(a.dialogObj.element)&&this.selfLink.dialogObj.hide({returnValue:!1}),Dl()&&a.parent.iframeSettings.enable&&Object(w["jb"])("iframe",a.parent.element).contentWindow.focus(),"HTML"===a.parent.editorMode&&this.selection.restore(),0===a.parent.formatter.getUndoRedoStack().length&&a.parent.formatter.saveData(),Object(w["T"])(this.args)||"KeyK"!==this.args.code)l=this.args;else{var c=this.args;Object(w["G"])(this.args,{item:{command:"Links",subCommand:"CreateLink"},originalEvent:c},!0);var h={item:{command:"Links",subCommand:"CreateLink"},originalEvent:c};l=h}this.selfLink.parent.formatter.process(this.selfLink.parent,l,!Object(w["T"])(this.args)&&this.args.originalEvent,d),this.selfLink.parent.contentModule.getEditPanel().focus()}else this.selfLink.checkUrl(!0)},e.prototype.isUrl=function(e){var t=/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/gi;return t.test(e)},e.prototype.checkUrl=function(e){var t=this.dialogObj.element,i=t.querySelector(".e-rte-linkurl");e?(Object(w["u"])([i],"e-error"),i.setSelectionRange(0,i.value.length),i.focus()):Object(w["gb"])([i],"e-error")},e.prototype.removeLink=function(e){0===this.parent.formatter.getUndoRedoStack().length&&this.parent.formatter.saveData();var t=this.getAnchorNode(e.selectParent[0]);this.parent.formatter.process(this.parent,e.args,e.args,{selectNode:e.selectNode,selectParent:e.selectParent,selection:e.selection,text:t.innerText,subCommand:e.args.item.subCommand}),Dl()&&this.parent.iframeSettings.enable?Object(w["jb"])("iframe",this.parent.element).contentWindow.focus():this.parent.contentModule.getEditPanel().focus(),this.hideLinkQuickToolbar()},e.prototype.openLink=function(e){var t=this.getAnchorNode(e.selectParent[0]);(t.classList.contains("e-rte-anchor")||"A"===t.tagName)&&this.parent.formatter.process(this.parent,e.args,e.args,{url:t.href,text:t.innerText,target:""===t.target?"_self":"_blank",selectNode:e.selectNode,subCommand:e.args.item.subCommand})},e.prototype.getAnchorNode=function(e){var t=Object(w["A"])(e,"a");return t||e},e.prototype.editLink=function(e){var t=this.getAnchorNode(e.selectNode[0]),i=this.getAnchorNode(e.selectParent[0]);if(i="A"===t.nodeName?t:i,i.classList.contains("e-rte-anchor")||"A"===i.tagName){var n=this.i10n.getConstant("dialogUpdate"),r={url:i.getAttribute("href"),text:i.innerText,title:i.title,target:i.target,header:this.i10n.getConstant("editLink"),btnText:n};this.linkDialog(e,r)}},e.prototype.cancelDialog=function(e){this.selfLink.parent.isBlur=!1,this.selfLink.dialogObj.hide({returnValue:!0}),Dl()?this.selection.restore():this.selfLink.parent.contentModule.getEditPanel().focus()},e.prototype.onDocumentClick=function(e){var t=e.target;!Object(w["T"])(this.dialogObj)&&(!Object(w["A"])(t,"[id='"+this.dialogObj.element.id+"']")&&this.parent.toolbarSettings.enable&&this.parent.getToolbarElement()&&!this.parent.getToolbarElement().contains(e.target)||(this.parent.getToolbarElement()&&this.parent.getToolbarElement().contains(e.target)||this.parent.inlineMode.enable&&!Object(w["A"])(t,"#"+this.dialogObj.element.id))&&!Object(w["A"])(t,"#"+this.parent.getID()+"_toolbar_CreateLink")&&!t.querySelector("#"+this.parent.getID()+"_toolbar_CreateLink"))&&(this.dialogObj.hide({returnValue:!0}),w["l"].remove(this.parent.element.ownerDocument,"mousedown",this.onDocumentClick),this.parent.isBlur=!0,$a(this.parent.element,"focusout"))},e.prototype.destroy=function(){this.removeEventListener()},e.prototype.getModuleName=function(){return"link"},e}(),Ll=function(){function e(){}return e.prototype.process=function(e,t,i,n){var r,s=this,a=e.contentModule.getDocument().getSelection(),o=a.rangeCount>0?a.getRangeAt(a.rangeCount-1):null;if("HTML"===e.editorMode&&(r=this.editorManager.nodeSelection.save(o,e.contentModule.getDocument())),Object(w["T"])(t)||!t.item.command||"Table"===t.item.command||"Actions"===t.item.command||"Links"===t.item.command||"Images"===t.item.command||"Files"===t.item.command||!o||e.contentModule.getEditPanel().contains(this.getAncestorNode(o.commonAncestorContainer))||e.contentModule.getEditPanel()===o.commonAncestorContainer||e.contentModule.getPanel()===o.commonAncestorContainer){if(!Object(w["T"])(t)&&-1!==e.maxLength&&!Object(w["T"])(t.item.command)){var l=0;"Links"===t.item.command&&(l=0===n.text.length?n.url.length:n.text.length),"Images"!==t.item.command&&"Table"!==t.item.command&&"Files"!==t.item.command||(l=1);var d=e.getText().trim().length,c=e.getSelection().length,h=d-c+l;if(!(-1===e.maxLength||h<=e.maxLength))return}if(Object(w["T"])(t)){var p=i.action;if("tab"!==p&&"enter"!==p&&"space"!==p&&"escape"!==p){t={},"Markdown"===e.editorMode&&"insert-table"===p&&(n={headingText:e.localeObj.getConstant("TableHeadingText"),colText:e.localeObj.getConstant("TableColText")});var u={originalEvent:i,cancel:!1,requestType:p||i.key+"Key",itemCollection:n};Object(w["G"])(t,t,u,!0),e.trigger(Ci,t,function(e){e.cancel&&("paste"!==p&&"cut"!==p&&"copy"!==p||i.preventDefault())})}var m=!!Object(w["T"])(e.tableModule)||!!e.tableModule&&e.tableModule.ensureInsideTableList;(9===i.which&&m||9!==i.which)&&(13===i.which&&"HTML"===e.editorMode&&(n={enterAction:e.enterKey}),this.editorManager.observer.notify("keydown"===i.type?Fr:Ur,{event:i,callBack:this.onSuccess.bind(this,e),value:n,enterAction:e.enterKey}))}else!Object(w["T"])(t)&&t.item.command&&t.item.subCommand&&(t.item.command!==t.item.subCommand&&"Font"!==t.item.command||("FontName"===t.item.subCommand||"FontSize"===t.item.subCommand)&&"dropDownSelect"===t.name||("BackgroundColor"===t.item.subCommand||"FontColor"===t.item.subCommand)&&"colorPickerChanged"===t.name)&&(Object(w["G"])(t,t,{requestType:t.item.subCommand,cancel:!1,itemCollection:n,selectType:t.name},!0),e.trigger(Ci,t,function(t){if(!t.cancel){0===s.getUndoRedoStack().length&&"Links"!==t.item.command&&"Images"!==t.item.command&&s.saveData(),e.isBlur=!1,e.contentModule.getEditPanel().focus(),"HTML"===e.editorMode&&r.restore();var a=t.item.subCommand.toLocaleLowerCase();"paste"===a||"cut"===a||"copy"===a?e.clipboardAction(a,i):(s.editorManager.observer.notify(Ji,{subCommand:t.item.subCommand}),s.editorManager.execCommand(t.item.command,t.item.subCommand,i,s.onSuccess.bind(s,e),t.item.value,"Pre"===t.item.subCommand&&"dropDownSelect"===t.selectType?{name:t.selectType}:n,"#"+e.getID()+" iframe",e.enterKey))}}));(Object(w["T"])(i)||i&&"copy"!==i.action)&&this.enableUndo(e)}},e.prototype.getAncestorNode=function(e){return e=3===e.nodeType?e.parentNode:e,e},e.prototype.onKeyHandler=function(e,t){var i=this;this.editorManager.observer.notify(Ur,{event:t,callBack:function(){e.notify(_t,{}),i.enableUndo(e)}})},e.prototype.onSuccess=function(e,t){e.notify(_t,{}),t&&(Object(w["T"])(t.event)||"copy"!==t.event.action)&&(this.enableUndo(e),e.notify(pi,t)),e.trigger(wi,t,function(t){if(e.setPlaceHolder(),("Images"===t.requestType||"Links"===t.requestType)&&"HTML"===e.editorMode){var i=t;if("Links"===t.requestType&&t.event&&"keydown"===t.event.type&&32===t.event.keyCode)return;e.notify(Si,{args:i.event,type:t.requestType,isNotify:!0,elements:i.elements})}e.autoResize()})},e.prototype.saveData=function(e){this.editorManager.undoRedoManager.saveData(e)},e.prototype.getUndoStatus=function(){return this.editorManager.undoRedoManager.getUndoStatus()},e.prototype.getUndoRedoStack=function(){return this.editorManager.undoRedoManager.undoRedoStack},e.prototype.enableUndo=function(e){var t=this.getUndoStatus();!e.inlineMode.enable||w["d"].isDevice&&!Va()?e.toolbarModule&&Ka(e.toolbarModule.baseToolbar,t):Ka(e.quickToolbarModule.inlineQTBar.quickTBarObj,t)},e}(),Nl="INSERT-IMAGE",Al="INSERT-TABLE",Bl="INSERT-LINK",Fl="INSERT-ROW",Hl="INSERT-COLUMN",Vl="DELETE-ROW",ql="DELETE-COLUMN",zl="REMOVE-TABLE",_l="TABLE-HEADER",Ul="TABLE_VERTICAL_ALIGN",Gl="TABLE_MERGE",Wl="TABLE_VERTICAL_SPLIT",Kl="TABLE_HORIZONTAL_SPLIT",$l="TABLE_MOVE",Xl="alignment-type",Jl="indent-type",Ql="p",Yl=["address","article","aside","audio","blockquote","canvas","details","dd","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","li","main","nav","noscript","ol","output","p","pre","section","table","tbody","td","tfoot","th","thead","tr","ul","video","body"],Zl=["td","th"],ed=["table","tbody","td","tfoot","th","thead","tr"],td="selection-type",id="inserthtml-type",nd="insert-text-type",rd="clear-type",sd=["area","base","br","embed","hr","img","input","param","source","track","wbr","iframe","td"],ad=function(){function e(){this.startNodeName=[],this.endNodeName=[]}return e.prototype.saveInstance=function(e,t){return this.range=e.cloneRange(),this.rootNode=this.documentFromRange(e),this.body=t,this.startContainer=this.getNodeArray(e.startContainer,!0),this.endContainer=this.getNodeArray(e.endContainer,!1),this.startOffset=e.startOffset,this.endOffset=e.endOffset,this.html=this.body.innerHTML,this},e.prototype.documentFromRange=function(e){return 9===e.startContainer.nodeType?e.startContainer:e.startContainer.ownerDocument},e.prototype.getRange=function(e){var t=this.get(e),i=t&&t.rangeCount>0?t.getRangeAt(t.rangeCount-1):e.createRange();return i.startContainer!==e||i.endContainer!==e||i.startOffset||i.endOffset||(i.setStart(e.body,0),i.collapse(!0)),i},e.prototype.get=function(e){return e.defaultView.getSelection()},e.prototype.save=function(e,t){return e=e?e.cloneRange():this.getRange(t),this.saveInstance(e,t.body)},e.prototype.getIndex=function(e){var t,i=0;if(e=e.previousSibling||"BR"!==e.tagName?e.previousSibling:e,e)for(e.nodeType;e;null)t=e.nodeType,i++,t,e=e.previousSibling;return i},e.prototype.isChildNode=function(e,t){for(var i=0;i<t.childNodes.length;i++)if(e.indexOf(t.childNodes[i])>-1)return!0;return!1},e.prototype.getNode=function(e,t,i){return t!==e||3!==e.nodeType&&e.firstChild&&-1===i.indexOf(e.firstChild)&&!this.isChildNode(i,e)?-1===i.indexOf(e.firstChild)&&e.firstChild&&!this.isChildNode(i,e)?e.firstChild:e.nextSibling?e.nextSibling:e.parentNode?e.parentNode:null:null},e.prototype.getNodeCollection=function(e){var t=e.startContainer.childNodes[e.startOffset]||e.startContainer,i=e.endContainer.childNodes[e.endOffset>0?e.endOffset-1:e.endOffset]||e.endContainer;if((t===i||"BR"===t.nodeName&&t===e.endContainer.childNodes[e.endOffset])&&0===t.childNodes.length)return[t];if(e.startOffset===e.endOffset&&0!==e.startOffset&&"PRE"===e.startContainer.nodeName)return["BR"===t.nodeName||"#text"===t.nodeName?t:t.childNodes[0]];var n=[];do{-1===n.indexOf(t)&&n.push(t),t=this.getNode(t,i,n)}while(t);return n},e.prototype.getParentNodeCollection=function(e){return this.getParentNodes(this.getNodeCollection(e),e)},e.prototype.getParentNodes=function(e,t){e=e.reverse();for(var i=0;i<e.length;i++)-1!==e.indexOf(e[i].parentNode)||3===e[i].nodeType&&t.startContainer!==t.endContainer&&t.startContainer.parentNode!==t.endContainer.parentNode?(e.splice(i,1),i--):3===e[i].nodeType&&(e[i]=e[i].parentNode);return e},e.prototype.getSelectionNodeCollection=function(e){return this.getSelectionNodes(this.getNodeCollection(e))},e.prototype.getSelectionNodeCollectionBr=function(e){return this.getSelectionNodesBr(this.getNodeCollection(e))},e.prototype.getSelectionNodes=function(e){e=e.reverse();for(var t=new RegExp(String.fromCharCode(8203),"g"),i=0;i<e.length;i++)(3!==e[i].nodeType||""===e[i].textContent.trim()||1===e[i].textContent.length&&e[i].textContent.match(t))&&(e.splice(i,1),i--);return e.reverse()},e.prototype.getSelectionNodesBr=function(e){e=e.reverse();for(var t=new RegExp(String.fromCharCode(8203),"g"),i=0;i<e.length;i++)"BR"!==e[i].nodeName&&(3!==e[i].nodeType||""===e[i].textContent.trim()||1===e[i].textContent.length&&e[i].textContent.match(t))&&(e.splice(i,1),i--);return e.reverse()},e.prototype.getInsertNodeCollection=function(e){return this.getInsertNodes(this.getNodeCollection(e))},e.prototype.getInsertNodes=function(e){e=e.reverse();for(var t=0;t<e.length;t++)(0!==e[t].childNodes.length&&3!==e[t].nodeType||3===e[t].nodeType&&""===e[t].textContent)&&(e.splice(t,1),t--);return e.reverse()},e.prototype.getNodeArray=function(e,t,i){var n=[];for(t?this.startNodeName=[]:this.endNodeName=[];e!==(i||this.rootNode);null){if(Object(w["T"])(e))break;t?this.startNodeName.push(e.nodeName.toLowerCase()):this.endNodeName.push(e.nodeName.toLowerCase()),n.push(this.getIndex(e)),e=e.parentNode}return n},e.prototype.setRangePoint=function(e,t,i,n){for(var r=this.rootNode,s=i.length,a=n;s--;null)r=r&&r.childNodes[i[s]];return r&&a>=0&&"html"!==r.nodeName&&(3===r.nodeType&&"&nbsp;"===r.nodeValue.replace(/\u00a0/g,"&nbsp;")&&(a=r.textContent.length),e[t?"setStart":"setEnd"](r,a)),e},e.prototype.restore=function(){var e=this.range.cloneRange();return e=this.setRangePoint(e,!0,this.startContainer,this.startOffset),e=this.setRangePoint(e,!1,this.endContainer,this.endOffset),this.selectRange(this.rootNode,e),e},e.prototype.selectRange=function(e,t){this.setRange(e,t),this.save(t,e)},e.prototype.setRange=function(e,t){var i=this.get(e);i.removeAllRanges(),i.addRange(t)},e.prototype.setSelectionText=function(e,t,i,n,r){var s=e.createRange();s.setStart(t,n),s.setEnd(i,r),this.setRange(e,s)},e.prototype.setSelectionContents=function(e,t){var i=e.createRange();i.selectNode(t),this.setRange(e,i)},e.prototype.setSelectionNode=function(e,t){var i=e.createRange();i.selectNodeContents(t),this.setRange(e,i)},e.prototype.getSelectedNodes=function(e){return this.getNodeCollection(this.getRange(e))},e.prototype.Clear=function(e){this.get(e).removeAllRanges()},e.prototype.insertParentNode=function(e,t,i){i.surroundContents(t),this.selectRange(e,i)},e.prototype.setCursorPoint=function(e,t,i){var n=e.createRange(),r=e.defaultView.getSelection();n.setStart(t,i),n.collapse(!0),r.removeAllRanges(),r.addRange(n)},e}(),od={"toolbar-focus":"alt+f10",escape:"27","insert-link":"ctrl+k","insert-image":"ctrl+shift+i","insert-table":"ctrl+shift+e",undo:"ctrl+z",redo:"ctrl+y",copy:"ctrl+c",cut:"ctrl+x",paste:"ctrl+v",bold:"ctrl+b",italic:"ctrl+i",underline:"ctrl+u",strikethrough:"ctrl+shift+s",uppercase:"ctrl+shift+u",lowercase:"ctrl+shift+l",superscript:"ctrl+shift+=",subscript:"ctrl+=",indents:"ctrl+]",outdents:"ctrl+[","html-source":"ctrl+shift+h","full-screen":"ctrl+shift+f","decrease-fontsize":"ctrl+shift+<","increase-fontsize":"ctrl+shift+>","justify-center":"ctrl+e","justify-full":"ctrl+j","justify-left":"ctrl+l","justify-right":"ctrl+r","clear-format":"ctrl+shift+r","ordered-list":"ctrl+shift+o","unordered-list":"ctrl+alt+o",space:"32",enter:"13",tab:"tab",delete:"46"},ld=["BR","IMG"],dd={startSelection:"e-editor-select-start",endSelection:"e-editor-select-end"},cd=function(){function e(e,t){this.parent=e,this.nodeSelection=new ad,this.currentDocument=t}return e.prototype.contents=function(e){return e&&"IFRAME"!==e.tagName?Array.prototype.slice.call(e.childNodes||[]):[]},e.prototype.isBlockNode=function(e){return!!e&&e.nodeType===Node.ELEMENT_NODE&&Yl.indexOf(e.tagName.toLowerCase())>=0},e.prototype.isLink=function(e){return!!e&&e.nodeType===Node.ELEMENT_NODE&&"a"===e.tagName.toLowerCase()},e.prototype.blockParentNode=function(e){for(;e&&e.parentNode!==this.parent&&(!e.parentNode||!this.hasClass(e.parentNode,"e-node-inner"));null)if(e=e.parentNode,this.isBlockNode(e))return e;return e},e.prototype.rawAttributes=function(e){var t={},i=e.attributes;if(i.length>0)for(var n=0;n<i.length;n++){var r=i[n];t[r.nodeName]=r.value}return t},e.prototype.attributes=function(e){if(!e)return"";for(var t="",i=this.rawAttributes(e),n=Object.keys(i).sort(),r=0;r<n.length;r++){var s=n[r],a=i[s];a.indexOf("'")<0&&a.indexOf('"')>=0?t+=" "+s+"='"+a+"'":a.indexOf('"')>=0&&a.indexOf("'")>=0?(a=a.replace(/"/g,"&quot;"),t+=" "+s+'="'+a+'"'):t+=" "+s+'="'+a+'"'}return t},e.prototype.clearAttributes=function(e){for(var t=e.attributes,i=t.length-1;i>=0;i--){var n=t[i];e.removeAttribute(n.nodeName)}},e.prototype.openTagString=function(e){return"<"+e.tagName.toLowerCase()+this.attributes(e)+">"},e.prototype.closeTagString=function(e){return"</"+e.tagName.toLowerCase()+">"},e.prototype.createTagString=function(e,t,i){return"<"+e.toLowerCase()+this.attributes(t)+">"+i+"</"+e.toLowerCase()+">"},e.prototype.isList=function(e){return!!e&&["UL","OL"].indexOf(e.tagName)>=0},e.prototype.isElement=function(e){return e===this.parent},e.prototype.isEditable=function(e){return(!e.getAttribute||"true"===e.getAttribute("contenteditable"))&&["STYLE","SCRIPT"].indexOf(e.tagName)<0},e.prototype.hasClass=function(e,t){return e&&e.classList&&e.classList.contains(t)},e.prototype.replaceWith=function(e,t){var i=e.parentNode;i.insertBefore(this.parseHTMLFragment(t),e),Object(w["F"])(e)},e.prototype.parseHTMLFragment=function(e){var t=Object(w["C"])("template");return t.innerHTML=e,t.content instanceof DocumentFragment?t.content:document.createRange().createContextualFragment(e)},e.prototype.wrap=function(e,t){return e.parentNode.insertBefore(t,e),t=e.previousSibling,t.appendChild(e),t},e.prototype.insertAfter=function(e,t){t.parentNode.insertBefore(e,t.nextSibling)},e.prototype.wrapInner=function(e,t){e.appendChild(t),t=e.querySelector(".e-rte-wrap-inner"),t.classList.remove("e-rte-wrap-inner"),0===t.classList.length&&t.removeAttribute("class");while(e.firstChild!==t)t.appendChild(e.firstChild);return t},e.prototype.unWrap=function(e){var t=e.parentNode,i=[];while(e.firstChild)i.push(e.firstChild),t.insertBefore(e.firstChild,e);return i=i.length>0?i:[e.parentNode],t.removeChild(e),i},e.prototype.getSelectedNode=function(e,t){return e.nodeType===Node.ELEMENT_NODE&&e.childNodes.length>0&&e.childNodes[t-1]&&e.childNodes[t-1].nodeType===Node.ELEMENT_NODE&&(e.childNodes[t-1].classList.contains(dd.startSelection)||e.childNodes[t-1].classList.contains(dd.endSelection))?e=e.childNodes[t-1]:e.nodeType===Node.ELEMENT_NODE&&e.childNodes.length>0&&e.childNodes[t]&&(e=e.childNodes[t]),e.nodeType===Node.TEXT_NODE&&(e=e.parentNode),e},e.prototype.nodeFinds=function(e,t){for(var i=[],n=0;n<t.length;n++)e.contains(t[n])&&e!==t[n]&&i.push(t[n]);return i},e.prototype.isEditorArea=function(){var e,t=this.getRangePoint(0);for(e=t.commonAncestorContainer;e&&!this.isElement(e);null)e=e.parentNode;return!!this.isElement(e)},e.prototype.getRangePoint=function(e){var t=this.getSelection(),i=[];if(t&&t.getRangeAt&&t.rangeCount){i=[];for(var n=0;n<t.rangeCount;n++)i.push(t.getRangeAt(n))}else i=[this.currentDocument.createRange()];return"undefined"!==typeof e?i[e]:i},e.prototype.getSelection=function(){return this.nodeSelection.get(this.currentDocument)},e.prototype.getPreviousNode=function(e){for(e=e.previousElementSibling;e&&"\n"===e.textContent;null)e=e.previousElementSibling;return e},e.prototype.encode=function(e){var t=document.createElement("div");return t.innerText=e,t.innerHTML.replace(/<br\s*[\/]?>/gi,"\n")},e.prototype.saveMarker=function(e,t){var i,n,r=this.parent.querySelector("."+dd.startSelection),s=this.parent.querySelector("."+dd.endSelection);if(""===r.textContent&&Object(w["T"])(s)&&"tab"!==t&&(1===r.childNodes.length&&"BR"===r.childNodes[0].nodeName?r.innerHTML="&#65279;&#65279;<br>":r.innerHTML="&#65279;&#65279;"),this.hasClass(r,dd.startSelection)&&r.classList.length>1){var a=this.createTagString(Ql,r,this.encode(r.textContent));this.replaceWith(r,a),r=this.parent.querySelector("."+dd.startSelection),r.classList.remove(dd.startSelection),i=r.childNodes[0]}else i=this.unWrap(r)[0];if(this.hasClass(s,dd.endSelection)&&s.classList.length>1){a=this.createTagString(Ql,s,this.encode(s.textContent));this.replaceWith(s,a),s=this.parent.querySelector("."+dd.endSelection),s.classList.remove(dd.endSelection),n=s.childNodes[0]}else n=s?this.unWrap(s)[0]:i;return e.startContainer=e.getNodeArray(i,!0),e.endContainer=e.getNodeArray(n,!1),e},e.prototype.marker=function(e,t){return'<span class="'+e+'">'+t+"</span>"},e.prototype.setMarker=function(e){var t=e.range,i=t.startContainer.childNodes,n=i.length>1&&"TABLE"===i[0].nodeName,r=(n?xl(i[t.startOffset+1]):i[t.startOffset>0?t.startOffset-1:t.startOffset])||t.startContainer,s=t.endContainer.childNodes[t.endOffset>0?t.endOffset-1:t.endOffset]||t.endContainer;if(r.nodeType===Node.ELEMENT_NODE&&s.nodeType===Node.ELEMENT_NODE&&(r.contains(s)||s.contains(r))){var a=r.contains(s)?r:s,o=a.nodeType!==Node.TEXT_NODE;if(o){for(var l=[],d=[],c=a;a.contains(c);null)l.indexOf(c)<0&&c.childNodes&&c.childNodes.length?(l.push(c),c=c.childNodes[0]):c.nextSibling?c=c.nextSibling:c.parentNode&&(c=c.parentNode,l.push(c)),d.indexOf(c)<0&&(c.nodeType===Node.TEXT_NODE||Zl.indexOf(c.parentNode.tagName.toLocaleLowerCase())>=0&&("BR"===c.tagName||"IMG"===c.tagName))&&d.push(c);d.length&&(r=r.contains(s)?d[0]:r,s=d[d.length-1])}}if(r!==s){if(r.nodeType!==Node.TEXT_NODE&&("BR"===r.tagName&&Zl.indexOf(r.parentNode.tagName.toLocaleLowerCase())>=0||"IMG"===r.tagName)){this.replaceWith(r,this.marker(dd.startSelection,this.encode(r.textContent)));var h=t.startContainer.querySelector("."+dd.startSelection);h.appendChild(r)}else if(3!=r.nodeType&&"#text"!=r.nodeName){var p=this.marker(dd.startSelection,"");Object(w["v"])([this.parseHTMLFragment(p)],r)}else this.replaceWith(r,this.marker(dd.startSelection,this.encode(r.textContent)));if(s.nodeType!==Node.TEXT_NODE&&"BR"===s.tagName&&Zl.indexOf(s.parentNode.tagName.toLocaleLowerCase())>=0){this.replaceWith(s,this.marker(dd.endSelection,this.encode(s.textContent)));var u=t.endContainer.querySelector("."+dd.endSelection);u.appendChild(s)}else this.ensureSelfClosingTag(s,dd.endSelection,t)}else this.ensureSelfClosingTag(r,dd.startSelection,t)},e.prototype.ensureSelfClosingTag=function(e,t,i){var n=!1;if(3===e.nodeType)this.replaceWith(e,this.marker(t,this.encode(e.textContent)));else if("BR"===e.tagName){this.replaceWith(e,this.marker(t,this.encode(e.textContent)));var r=i.startContainer.querySelector("."+t);r.appendChild(e)}else{if("IMG"===e.tagName){var s=document.createElement("p");e.parentElement.insertBefore(s,e),s.appendChild(e),e=s.children[0]}if("TABLE"===e.tagName)if(n=!0,""===e.textContent){var a=e.querySelectorAll("td");e=a[a.length-1],e=Object(w["T"])(e.childNodes[0])?e:e.childNodes[0]}else{var o=e.lastChild;while(3!==o.nodeType&&"#text"!==o.nodeName&&"BR"!==o.nodeName)o=o.lastChild;e=o}for(var l=0;l<ld.length;l++)e=e.tagName!==ld[l]||n?e:e.parentNode;if(3===e.nodeType&&"#text"===e.nodeName)this.replaceWith(e,this.marker(t,this.encode(e.textContent)));else if("BR"===e.nodeName){this.replaceWith(e,this.marker(dd.endSelection,this.encode(e.textContent)));var d=i.endContainer.querySelector("."+dd.endSelection);d.appendChild(e)}else{var c=this.marker(t,"");Object(w["v"])([this.parseHTMLFragment(c)],e)}}},e.prototype.createTempNode=function(e){var t=e.textContent;if("BR"===e.tagName){var i="<"+Ql+"></"+Ql+">",n=e.parentNode;Zl.indexOf(n.tagName.toLocaleLowerCase())>=0&&(e=this.wrap(e,this.parseHTMLFragment(i)))}else if(e.nodeType!==Node.TEXT_NODE&&(e.classList.contains(dd.startSelection)||e.classList.contains(dd.endSelection))||t.replace(/\n/g,"").replace(/(^ *)|( *$)/g,"").length>0||t.length&&t.indexOf("\n")<0){i="<"+Ql+"></"+Ql+">";var r=e;e=this.wrap(e,this.parseHTMLFragment(i));var s=r.nodeType===Node.ELEMENT_NODE&&r.firstChild&&"BR"===r.firstChild.nodeName&&(r.classList.contains(dd.startSelection)||r.classList.contains(dd.endSelection));!s&&e.nextElementSibling&&"BR"===e.nextElementSibling.tagName&&e.appendChild(e.nextElementSibling)}return e},e.prototype.getImageTagInSelection=function(){var e=this.getSelection();return this.isEditorArea()&&e.rangeCount?e.focusNode.querySelectorAll("img"):null},e.prototype.blockNodes=function(){var e=[],t=this.getSelection();if(this.isEditorArea()&&t.rangeCount)for(var i=this.getRangePoint(),n=0;n<i.length;n++){var r=void 0,s=i[n],a=this.getSelectedNode(s.startContainer,s.startOffset),o=this.getSelectedNode(s.endContainer,s.endOffset);if(this.isBlockNode(a)&&e.indexOf(a)<0&&e.push(a),r=this.blockParentNode(a),r&&e.indexOf(r)<0)if(Zl.indexOf(r.tagName.toLocaleLowerCase())>=0&&("BR"===a.tagName||a.nodeType===Node.TEXT_NODE||a.classList.contains(dd.startSelection)||a.classList.contains(dd.endSelection))){var l=a.previousSibling&&a.previousSibling.nodeType===Node.TEXT_NODE?a.previousSibling:a;a.nextSibling||a.previousSibling||"BR"!==a.tagName?e.push(this.createTempNode(l)):e.push(l)}else e.push(r);for(var d=[],c=a;c!==o&&c!==this.parent;null)d.indexOf(c)<0&&c.childNodes&&c.childNodes.length?(d.push(c),c=c.childNodes[0]):c&&8!==c.nodeType&&("BR"===c.tagName||c.nodeType===Node.TEXT_NODE&&""!==c.textContent.trim()||c.nodeType!==Node.TEXT_NODE&&(c.classList.contains(dd.startSelection)||c.classList.contains(dd.endSelection)))&&Zl.indexOf(c.parentNode.tagName.toLocaleLowerCase())>=0?c=this.createTempNode(c):c.nextSibling&&8!==c.nextSibling.nodeType&&("BR"===c.nextSibling.tagName||c.nextSibling.nodeType===Node.TEXT_NODE||c.nextSibling.classList.contains(dd.startSelection)||c.nextSibling.classList.contains(dd.endSelection))&&Zl.indexOf(c.nextSibling.parentNode.tagName.toLocaleLowerCase())>=0?c=this.createTempNode(c.nextSibling):c.nextSibling?c=c.nextSibling:c.parentNode&&(c=c.parentNode,d.push(c)),e.indexOf(c)<0&&c.nodeType===Node.ELEMENT_NODE&&Zl.indexOf(c.parentNode.tagName.toLocaleLowerCase())>=0&&(c.classList.contains(dd.startSelection)||c.classList.contains(dd.endSelection))&&e.push(this.createTempNode(c)),this.isBlockNode(c)&&this.ignoreTableTag(c)&&d.indexOf(c)<0&&e.indexOf(c)<0&&(c!==o||s.endOffset>0)&&e.push(c),"IMG"===c.nodeName&&"true"===c.parentElement.contentEditable&&e.push(c);r=this.blockParentNode(o),r&&this.ignoreTableTag(r)&&e.indexOf(r)<0&&!Object(w["T"])(r.previousElementSibling)&&"IMG"!==r.previousElementSibling.tagName&&e.push(r)}for(var h=e.length-1;h>0;h--){d=this.nodeFinds(e[h],e);if(d.length){var p=e[h].querySelectorAll("ul, ol");if("LI"===e[h].tagName&&p.length>0)continue;e.splice(h,1)}}return e},e.prototype.ignoreTableTag=function(e){return!(ed.indexOf(e.tagName.toLocaleLowerCase())>=0)},e}(),hd=function(){function e(e){this.parent=e,this.domNode=this.parent.domNode,this.addEventListener()}return e.prototype.addEventListener=function(){this.parent.observer.on(zr,this.applyListsHandler,this),this.parent.observer.on(qr,this.keyDownHandler,this),this.parent.observer.on(Jr,this.spaceKeyAction,this)},e.prototype.testList=function(e){var t=[/^[\d]+[.]+$/,/^(?=[MDCLXVI])M*(C[MD]|D?C{0,3})(X[CL]|L?X{0,3})(I[XV]|V?I{0,3})[.]$/gi,/^[a-zA-Z][.]+$/],i=Object(w["T"])(e)?null:e.innerText.trim().split(".")[0]+".";if(!Object(w["T"])(i))for(var n=0;n<t.length;n++)if(t[n].test(i))return!0;return!1},e.prototype.testCurrentList=function(e){var t=[/^[1]+[.]+$/,/^[i]+[.]+$/,/^[a]+[.]+$/];if(!Object(w["T"])(e.startContainer.textContent.slice(0,e.startOffset)))for(var i=e.startContainer.textContent.replace(/\u200B/g,"").slice(0,e.startOffset).trim(),n=0;n<t.length;n++)if(t[n].test(i)&&2===i.length)return!0;return!1},e.prototype.spaceList=function(e){var t=this.parent.nodeSelection.getRange(this.parent.currentDocument);this.saveSelection=this.parent.nodeSelection.save(t,this.parent.currentDocument);var i=this.parent.domNode.getSelectedNode(t.startContainer,t.startOffset),n=(this.parent.domNode.getSelectedNode(t.endContainer,t.endOffset),i.previousElementSibling),r=i.nextElementSibling,s=Object(w["T"])(n)?null:n.innerText.trim().substring(0,1),a=Object(w["T"])(r)?null:r.innerText.trim().substring(0,1),o=this.testCurrentList(t),l=this.testList(n),d=this.testList(r);l||d||"*"===s||"*"===a||(o?(t.startContainer.textContent=t.startContainer.textContent.slice(t.startOffset,t.startContainer.textContent.length),this.applyListsHandler({subCommand:"OL",callBack:e.callBack}),e.event.preventDefault()):"*"!==t.startContainer.textContent.replace(/\u200B/g,"").slice(0,t.startOffset).trim()&&"-"!==t.startContainer.textContent.replace(/\u200B/g,"").slice(0,t.startOffset).trim()||(t.startContainer.textContent=t.startContainer.textContent.slice(t.startOffset,t.startContainer.textContent.length),this.applyListsHandler({subCommand:"UL",callBack:e.callBack}),e.event.preventDefault()))},e.prototype.enterList=function(e){var t=this.parent.nodeSelection.getRange(this.parent.currentDocument),i="LI"===t.startContainer.nodeName?t.startContainer:t.startContainer.parentElement.closest("LI"),n="LI"===t.endContainer.nodeName?t.endContainer:t.endContainer.parentElement.closest("LI");if(!Object(w["T"])(i)&&!Object(w["T"])(n)&&i===n&&"LI"===i.tagName&&""===i.textContent.trim()&&0===i.querySelectorAll("IMG").length){if(i.innerHTML.indexOf("&nbsp;")>=0)return;65279===i.textContent.charCodeAt(0)&&(i.textContent="");var r=i.parentElement;if(Object(w["T"])(r.parentElement.closest("UL"))&&Object(w["T"])(r.parentElement.closest("OL"))){if(!Object(w["T"])(i.nextElementSibling)){var s=this.parent.domNode.blockParentNode(i);this.parent.nodeCutter.GetSpliceNode(t,s)}var a=void 0;"DIV"===e.enterAction?(a=Object(w["C"])("div"),a.innerHTML="<br>"):"P"===e.enterAction?(a=Object(w["C"])("p"),a.innerHTML="<br>"):a=Object(w["C"])("br"),this.parent.domNode.insertAfter(a,r),e.event.preventDefault(),this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,a,0),""===r.textContent?Object(w["F"])(r):Object(w["F"])(i)}}},e.prototype.backspaceList=function(e){var t=this.parent.nodeSelection.getRange(this.parent.currentDocument),i=this.parent.domNode.getSelectedNode(t.startContainer,t.startOffset),n=this.parent.domNode.getSelectedNode(t.endContainer,t.endOffset);if(i="BR"===i.nodeName?i.parentElement:i,n="BR"===n.nodeName?n.parentElement:n,i===n&&!Object(w["T"])(Object(w["A"])(i,"li"))&&(""===i.textContent.trim()&&65279===i.textContent.charCodeAt(0)||1===i.textContent.length&&8203===i.textContent.charCodeAt(0))&&(i.textContent=""),i===n&&"LI"===i.tagName&&0===i.textContent.length&&Object(w["T"])(i.previousElementSibling)&&i.removeAttribute("style"),i===n&&""===i.textContent){if("LI"===i.parentElement.tagName&&"LI"===n.parentElement.tagName)Object(w["F"])(i);else if(i.closest("ul")||i.closest("ol")){var r=Object(w["T"])(i.closest("ul"))?i.closest("ol"):i.closest("ul");if(r.firstElementChild===i&&!Object(w["T"])(r.children[1])&&("OL"===r.children[1].tagName||"UL"===r.children[1].tagName))if(r.tagName===r.children[1].tagName){while(r.children[1].lastChild)this.parent.domNode.insertAfter(r.children[1].lastChild,r.children[1]);Object(w["F"])(r.children[1])}else r.parentElement.insertBefore(r.children[1],r)}}else if(!Object(w["T"])(i.firstChild)&&"BR"===i.firstChild.nodeName&&!Object(w["T"])(i.childNodes[1])&&("UL"===i.childNodes[1].nodeName||"OL"===i.childNodes[1].nodeName)){r=Object(w["T"])(i.closest("ul"))?i.closest("ol"):i.closest("ul");if(r.tagName===i.childNodes[1].nodeName){while(i.childNodes[1].lastChild)this.parent.domNode.insertAfter(i.children[1].lastChild,i);Object(w["F"])(i.childNodes[1])}else r.parentElement.insertBefore(i.children[1],r)}this.removeList(t,e)},e.prototype.removeList=function(e,t){var i=this.parent.domNode.getSelectedNode(e.startContainer,e.startOffset),n=this.parent.domNode.getSelectedNode(e.endContainer,e.endOffset);i="BR"===i.nodeName?i.parentElement:i,n="BR"===n.nodeName?n.parentElement:n,i="LI"===i.nodeName||Object(w["T"])(i.closest("LI"))?i:i.closest("LI"),n="LI"===n.nodeName||Object(w["T"])(n.closest("LI"))?n:n.closest("LI"),(("OL"===e.commonAncestorContainer.nodeName||"UL"===e.commonAncestorContainer.nodeName||"LI"===e.commonAncestorContainer.nodeName)&&Object(w["T"])(n.nextElementSibling)&&n.textContent.length===e.endOffset&&Object(w["T"])(i.previousElementSibling)&&0===e.startOffset||-1!=w["d"].userAgent.indexOf("Firefox")&&e.startContainer===e.endContainer&&e.startContainer===this.parent.editableElement&&0===e.startOffset&&1===e.endOffset)&&(-1!=w["d"].userAgent.indexOf("Firefox")?Object(w["F"])(e.commonAncestorContainer.childNodes[0]):"LI"===e.commonAncestorContainer.nodeName?Object(w["F"])(e.commonAncestorContainer.parentElement):Object(w["F"])(e.commonAncestorContainer),t.event.preventDefault())},e.prototype.keyDownHandler=function(e){if(13===e.event.which&&this.enterList(e),32===e.event.which&&this.spaceList(e),8===e.event.which&&this.backspaceList(e),46===e.event.which&&"delete"===e.event.action){var t=this.parent.nodeSelection.getRange(this.parent.currentDocument),i=t.commonAncestorContainer,n=t.startContainer,r=t.endContainer,s=3===n.nodeType?n.parentElement:n,a=3===r.nodeType?r.parentElement:r;"UL"!==i.nodeName&&"OL"!==i.nodeName||s===a||Object(w["T"])(Object(w["A"])(s,"ul"))&&Object(w["T"])(Object(w["A"])(s,"ol"))||Object(w["T"])(Object(w["A"])(a,"ul"))&&Object(w["T"])(Object(w["A"])(a,"ol"))||i.lastElementChild!==Object(w["A"])(a,"li")||t.collapsed||Object(w["F"])(i),this.removeList(t,e)}if(9===e.event.which){t=this.parent.nodeSelection.getRange(this.parent.currentDocument);e.event.action&&"indent"===e.event.action||(this.saveSelection=this.parent.nodeSelection.save(t,this.parent.currentDocument));var o=void 0,l=t.startOffset,d=t.endOffset;s=this.parent.domNode.getSelectedNode(t.startContainer,t.startOffset),a=this.parent.domNode.getSelectedNode(t.endContainer,t.endOffset);if(s===a&&("BR"===s.nodeName||"#text"===s.nodeName)&&Zl.indexOf(s.parentNode.tagName.toLocaleLowerCase())>=0)return;e.event.action&&"indent"===e.event.action||this.domNode.setMarker(this.saveSelection),o=this.domNode.blockNodes();for(var c=[],h=!0,p=0;p<o.length;p++)"LI"===o[p].parentNode.tagName?c.push(o[p].parentNode):"LI"===o[p].tagName&&"P"!==o[p].childNodes[0].tagName&&"OL"!==o[p].childNodes[0].tagName&&"UL"!==o[p].childNodes[0].tagName&&c.push(o[p]);c.length>1||c.length&&(0===l&&0===d||e.ignoreDefault)?(e.event.preventDefault(),e.event.stopPropagation(),this.currentAction=this.getAction(c[0]),e.event.shiftKey?(this.revertList(c,e),this.revertClean()):h=this.nestedList(c),h&&(this.cleanNode(),this.parent.editableElement.focus()),e.event.action&&"indent"===e.event.action||(this.saveSelection=this.domNode.saveMarker(this.saveSelection),this.saveSelection.restore(),e.callBack&&e.callBack({requestType:this.currentAction,editorMode:"HTML",range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.domNode.blockNodes(),event:e.event}))):e.event.action&&"indent"===e.event.action||(e.event&&e.event.shiftKey&&"Tab"===e.event.key&&(e.event.action="tab"),this.saveSelection=this.domNode.saveMarker(this.saveSelection,e.event.action),this.saveSelection.restore())}else switch(e.event.action){case"ordered-list":this.applyListsHandler({subCommand:"OL",callBack:e.callBack}),e.event.preventDefault();break;case"unordered-list":this.applyListsHandler({subCommand:"UL",callBack:e.callBack}),e.event.preventDefault();break}},e.prototype.spaceKeyAction=function(e){32===e.event.which&&this.spaceList(e)},e.prototype.getAction=function(e){var t=e.parentNode;return"OL"===t.nodeName?"OL":"UL"},e.prototype.revertClean=function(){for(var e=this.parent.editableElement.querySelectorAll("ul, ol"),t=0;t<e.length;t++){var i=e[t].querySelectorAll("ul, ol");if(i.length>0)for(var n=0;n<i.length;n++){var r=i[n].previousSibling;r&&"LI"===r.tagName&&r.appendChild(i[n])}}},e.prototype.noPreviousElement=function(e){var t,i,n=e.querySelectorAll("ol, ul"),r=e.querySelectorAll("li"),s=this.domNode.contents(r[0])[0];if(r.length>0&&("OL"===s.nodeName||"UL"===s.nodeName)?t=r[0]:i=n[0],t)for(var a=this.domNode.contents(e)[0];a&&!this.domNode.isList(a);null){var o=a.nextSibling;Object(w["cb"])([a],t),Object(w["mb"])(e,{"list-style-type":"none"}),Object(w["mb"])(t,{"list-style-type":""}),a=o}else if(i){var l=Object(w["C"])("li");Object(w["cb"])([l],i);for(a=this.domNode.contents(e)[0];a&&!this.domNode.isList(a);null){o=a.nextSibling;l.appendChild(a),a=o}Object(w["cb"])([i],e.parentNode),Object(w["F"])(e);var d=Object(w["C"])("li",{styles:"list-style-type: none;"});Object(w["cb"])([d],i.parentNode),Object(w["v"])([i],d)}else{d=Object(w["C"])("li",{styles:"list-style-type: none;"});Object(w["cb"])([d],e.parentNode);l=Object(w["C"])(e.parentNode.tagName);Object(w["cb"])([l],d),Object(w["v"])([e],l)}},e.prototype.nestedList=function(e){for(var t=!1,i=0;i<e.length;i++){var n=this.domNode.getPreviousNode(e[i]);if(n){t=!0;var r=void 0,s=void 0,a=e[i].querySelectorAll("ol, ul"),o=e[i].querySelectorAll("li"),l=this.domNode.contents(o[0])[0];if(o.length>0&&("OL"===l.nodeName||"UL"===l.nodeName)?s=o[0]:r=a[0],r){var d=Object(w["C"])("li");Object(w["cb"])([d],r);for(var c=this.domNode.contents(e[i])[0];c&&!this.domNode.isList(c);null){var h=c.nextSibling;d.appendChild(c),c=h}Object(w["v"])([r],n),Object(w["F"])(e[i])}else if(s){if("LI"===n.tagName){for(c=this.domNode.contents(e[i])[0];c&&!this.domNode.isList(c);null){h=c.nextSibling;Object(w["cb"])([c],s),Object(w["mb"])(e[i],{"list-style-type":"none"}),Object(w["mb"])(s,{"list-style-type":""}),c=h}Object(w["v"])([s.parentNode],n),Object(w["F"])(e[i])}}else if("LI"===n.tagName){d=Object(w["C"])(e[i].parentNode.tagName);Object(w["v"])([d],n),Object(w["v"])([e[i]],d)}else"OL"!==n.tagName&&"UL"!==n.tagName||Object(w["v"])([e[i]],n)}else{var p=e[i];t=!0,this.noPreviousElement(p)}}return t},e.prototype.applyListsHandler=function(e){var t=this.parent.nodeSelection.getRange(this.parent.currentDocument);if(-1!=w["d"].userAgent.indexOf("Firefox")&&t.startContainer===t.endContainer&&t.startContainer===this.parent.editableElement){var i=t.startContainer.childNodes,n=i[t.startOffset>0?t.startOffset-1:t.startOffset]||t.startContainer,r=t.endContainer.childNodes[t.endOffset>0?t.endOffset-1:t.endOffset]||t.endContainer,s="BR"===r.lastChild.nodeName?Object(w["T"])(r.lastChild.previousSibling)?r:r.lastChild.previousSibling:r.lastChild;while(!Object(w["T"])(s)&&"#text"!==s.nodeName&&"IMG"!==s.nodeName&&"BR"!==s.nodeName&&"HR"!==s.nodeName)s=s.lastChild;this.parent.nodeSelection.setSelectionText(this.parent.currentDocument,n,s,0,s.textContent.length),t=this.parent.nodeSelection.getRange(this.parent.currentDocument)}if(t.startContainer===t.endContainer&&t.startContainer===this.parent.editableElement&&t.startOffset===t.endOffset&&0===t.startOffset&&0===this.parent.editableElement.textContent.length&&"TABLE"!=this.parent.editableElement.childNodes[0].nodeName&&"IMG"!=this.parent.editableElement.childNodes[0].nodeName){var a=t.startContainer.childNodes[0];this.parent.nodeSelection.setSelectionText(this.parent.currentDocument,a,a,0,0),t=this.parent.nodeSelection.getRange(this.parent.currentDocument)}this.saveSelection=this.parent.nodeSelection.save(t,this.parent.currentDocument),this.currentAction=e.subCommand,this.currentAction=e.subCommand="NumberFormatList"===this.currentAction?"OL":"BulletFormatList"===this.currentAction?"UL":this.currentAction,this.domNode.setMarker(this.saveSelection);var o=this.domNode.blockNodes();if("BR"===e.enterAction){this.setSelectionBRConfig();var l=this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument),d=this.parent.nodeSelection.getSelectionNodes(l),c=[];0===d.length&&d.push(o[0]);for(var h=0;h<d.length;h++){var p=d[h],u=void 0;while(!this.parent.domNode.isBlockNode(p)&&p!==this.parent.editableElement)u=p,p=p.parentElement;this.parent.domNode.isBlockNode(p)&&p===this.parent.editableElement&&c.push(u)}for(h=0;h<c.length;h++)if(!this.parent.domNode.isBlockNode(c[h])){p=c[h];var m=p;while(p===this.parent.editableElement)m=p,p=p.parentElement;var g=void 0;this.parent.domNode.isBlockNode(m.parentElement)&&m.parentElement===this.parent.editableElement?(g=Object(w["C"])("p"),m.parentElement.insertBefore(g,m),g.appendChild(m)):g=m;var f=g.previousSibling;while(!Object(w["T"])(f)&&"BR"!==f.nodeName&&!this.parent.domNode.isBlockNode(f))g.firstChild.parentElement.insertBefore(f,g.firstChild),f=g.previousSibling;Object(w["T"])(f)||"BR"!==f.nodeName||Object(w["F"])(f);var b=g.nextSibling;while(!Object(w["T"])(b)&&"BR"!==b.nodeName&&!this.parent.domNode.isBlockNode(b))g.appendChild(b),b=g.nextSibling;Object(w["T"])(b)||"BR"!==b.nodeName||Object(w["F"])(b)}this.setSelectionBRConfig(),o=this.parent.domNode.blockNodes()}for(h=0;h<o.length;h++)"TABLE"!==o[h].tagName||t.collapsed||o.splice(h,1),o.length>0&&"LI"!==o[h].tagName&&"LI"===o[h].parentNode.tagName&&(o[h]=o[h].parentNode);this.applyLists(o,this.currentAction,e.selector,e.item,e),e.callBack&&e.callBack({requestType:this.currentAction,event:e.event,editorMode:"HTML",range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.domNode.blockNodes()})},e.prototype.setSelectionBRConfig=function(){var e=this.parent.editableElement.querySelector("."+dd.startSelection),t=this.parent.editableElement.querySelector("."+dd.endSelection);Object(w["T"])(t)?this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,e,0):this.parent.nodeSelection.setSelectionText(this.parent.currentDocument,e,t,0,0)},e.prototype.applyLists=function(e,t,i,n,r){if(this.isRevert(e,t,n)&&Object(w["T"])(n))this.revertList(e,r),this.removeEmptyListElements();else{this.checkLists(e,t,n);for(var s=0;s<e.length;s++)if(Object(w["T"])(n)||Object(w["T"])(n.listStyle)||("listImage"===n.listStyle?Object(w["mb"])(e[s],{"list-style-image":n.listImage}):(Object(w["mb"])(e[s],{"list-style-image":"none"}),Object(w["mb"])(e[s],{"list-style-type":n.listStyle.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}))),"true"===e[s].getAttribute("contenteditable")&&1===e[s].childNodes.length&&"TABLE"===e[s].childNodes[0].nodeName){var a=document.createElement(t);a.innerHTML="<li><br/></li>",e[s].appendChild(a)}else if("LI"!==e[s].tagName&&Object(w["T"])(n)){!1;var o="IMG"===e[s].tagName?"":this.domNode.attributes(e[s]),l="<"+t+">",d="</"+t+">",c="li"+o,h=e[s].tagName.toLowerCase()===Ql?e[s].innerHTML:e[s].outerHTML,p=this.domNode.createTagString(c,null,h),u=l+p+d;this.domNode.replaceWith(e[s],u)}else if(!Object(w["T"])(n)&&"LI"!==e[s].tagName){!1;o="IMG"===e[s].tagName?"":this.domNode.attributes(e[s]),l="<"+t+o+">",d="</"+t+">",c="li",h=e[s].tagName.toLowerCase()===Ql?e[s].innerHTML:e[s].outerHTML,p=this.domNode.createTagString(c,null,h),u=l+p+d;this.domNode.replaceWith(e[s],u)}}this.cleanNode(),this.parent.editableElement.focus(),Dl()&&El(this.parent.editableElement,i),this.saveSelection=this.domNode.saveMarker(this.saveSelection),this.saveSelection.restore()},e.prototype.removeEmptyListElements=function(){for(var e=this.parent.editableElement.querySelectorAll("ol, ul"),t=0;t<e.length;t++)""===e[t].textContent.trim()&&Object(w["F"])(e[t])},e.prototype.isRevert=function(e,t,i){for(var n=!0,r=0;r<e.length;r++){if("LI"!==e[r].tagName)return!1;(e[r].parentNode.tagName!==t||Object(w["T"])(i)&&""!==e[r].parentNode.style.listStyleType)&&(n=!1)}return n},e.prototype.checkLists=function(e,t,i){for(var n=[],r=0;r<e.length;r++){var s=e[r].parentNode;Object(w["T"])(i)||"LI"!==e[r].tagName||Object(w["T"])(i.listStyle)||("listImage"===i.listStyle?Object(w["mb"])(s,{"list-style-image":i.listImage}):(Object(w["mb"])(s,{"list-style-image":"none"}),Object(w["mb"])(s,{"list-style-type":i.listStyle.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}))),("LI"===e[r].tagName&&s.tagName!==t&&n.indexOf(s)<0||"LI"===e[r].tagName&&s.tagName===t&&n.indexOf(s)<0&&null!==i)&&n.push(s),Object(w["T"])(i)&&(s.tagName===t||("UL"===s.tagName||"OL"===s.tagName)&&s.hasAttribute("style"))&&s.hasAttribute("style")&&s.removeAttribute("style")}for(var a=n.length-1;a>=0;a--){var o=n[a],l="<"+t.toLowerCase()+" "+this.domNode.attributes(o)+">"+o.innerHTML+"</"+t.toLowerCase()+">";this.domNode.replaceWith(n[a],l)}},e.prototype.cleanNode=function(){for(var e=this.parent.editableElement.querySelectorAll("ol + ol, ul + ul"),t=0;t<e.length;t++){var i=e[t];if(this.domNode.isList(i.previousElementSibling)&&this.domNode.openTagString(i)===this.domNode.openTagString(i.previousElementSibling)){for(var n=this.domNode.contents(i),r=0;r<n.length;r++)i.previousElementSibling.appendChild(n[r]);i.parentNode.removeChild(i)}}},e.prototype.findUnSelected=function(e,t){if(e=e.slice().reverse(),e.length>0){var i=[],n=[],r=t[t.length-1],s=[],a=[];s=r.childNodes;for(var o=0;o<s.length;o++)if("OL"===s[o].tagName||"UL"===s[o].tagName){var l=s[o].querySelectorAll("li");if(l.length>0)for(var d=0;d<l.length;d++)a.push(l[d])}for(var c=0;c<a.length;c++){for(var h=0,p=0;p<e.length;p++)a[c].contains(e[p])||(h+=1);h===e.length&&n.push(a[c])}if(n.length>0)for(var u=0;u<n.length;u++)"OL"!==this.domNode.contents(n[u])[0].nodeName&&"UL"!==this.domNode.contents(n[u])[0].nodeName&&i.push(n[u]);i.length>0&&this.nestedList(i)}},e.prototype.revertList=function(e,t){for(var i=[],n=e.length-1;n>=0;n--)for(var r=n-1;r>=0;r--)if(e[r].contains(e[n])||e[r]===e[n]){i.push(e[n]),e.splice(n,1);break}this.findUnSelected(i,e);var s=[];for(n=0;n<e.length;n++){var a=e[n];3===this.domNode.contents(a)[0].nodeType&&0===this.domNode.contents(a)[0].textContent.trim().length&&Object(w["F"])(this.domNode.contents(a)[0]);var o=e[n].parentNode,l=a.getAttribute("class");if(0===i.length){var d=e[n].querySelectorAll("ul, ol"),c=d[0];if(c){var h=c.querySelectorAll("li");if(h){var p=Object(w["C"])(c.tagName);Object(w["v"])([p],c.parentNode);var u=Object(w["C"])("li",{styles:"list-style-type: none;"});Object(w["v"])([u],p),Object(w["v"])([c],u)}}}if(a.parentNode.insertBefore(this.closeTag(o.tagName),a),"LI"===o.parentNode.tagName||"OL"===o.parentNode.tagName||"UL"===o.parentNode.tagName)a.parentNode.insertBefore(this.closeTag("LI"),a);else{if(l&&' class="'+l+'"',Ql&&0===a.querySelectorAll(Yl.join(", ")).length){var m=Object(w["T"])(l)?' class="e-rte-wrap-inner"':' class="'+l+' e-rte-wrap-inner"',g="<"+Ql+m+this.domNode.attributes(o)+"></"+Ql+">";"BR"!==t.enterAction&&this.domNode.wrapInner(a,this.domNode.parseHTMLFragment(g))}else if(3===this.domNode.contents(a)[0].nodeType){var f=this.domNode.createTagString(Ql,o,this.parent.domNode.encode(this.domNode.contents(a)[0].textContent));this.domNode.replaceWith(this.domNode.contents(a)[0],f)}else if(this.domNode.contents(a)[0].classList.contains(dd.startSelection)||this.domNode.contents(a)[0].classList.contains(dd.endSelection)){f=this.domNode.createTagString(Ql,o,this.domNode.contents(a)[0].outerHTML);this.domNode.replaceWith(this.domNode.contents(a)[0],f)}else{var b=a.firstChild;l=b.getAttribute("class"),Object(w["w"])(b,this.domNode.rawAttributes(o)),l&&b.getAttribute("class")&&Object(w["w"])(b,{class:l+" "+b.getAttribute("class")})}Object(w["v"])([this.openTag("LI")],a),Object(w["cb"])([this.closeTag("LI")],a)}this.domNode.insertAfter(this.openTag(o.tagName),a),"LI"===o.parentNode.tagName&&(o=o.parentNode.parentNode),s.indexOf(o)<0&&s.push(o)}for(n=0;n<s.length;n++){var v=s[n],y=v.innerHTML,C=/<span class="e-rte-list-close-([a-z]*)"><\/span>/g,O=/<span class="e-rte-list-open-([a-z]*)"><\/span>/g;y=y.replace(C,"</$1>"),y=y.replace(O,"<$1 "+this.domNode.attributes(v)+">"),this.domNode.replaceWith(v,this.domNode.openTagString(v)+y.trim()+this.domNode.closeTagString(v))}var T=this.parent.editableElement.querySelectorAll("ul:empty, ol:empty");for(n=0;n<T.length;n++)Object(w["F"])(T[n]);var k=this.parent.editableElement.querySelectorAll("li:empty");for(n=0;n<k.length;n++)Object(w["F"])(k[n])},e.prototype.openTag=function(e){return this.domNode.parseHTMLFragment('<span class="e-rte-list-open-'+e.toLowerCase()+'"></span>')},e.prototype.closeTag=function(e){return this.domNode.parseHTMLFragment('<span class="e-rte-list-close-'+e.toLowerCase()+'"></span>')},e}(),pd=function(){function e(){}return e.WrapBefore=function(e,t,i){return t.innerText=e.textContent,i?this.AppendBefore(t,e,!0):this.AppendBefore(t,e),e.parentNode&&e.parentNode.removeChild(e),t.childNodes[0]},e.Wrap=function(e,t){return this.AppendBefore(t,e),t.appendChild(e),e},e.unwrap=function(e){for(var t=e.parentNode,i=[];e.firstChild;null)i.push(t.insertBefore(e.firstChild,e));return t.removeChild(e),i},e.AppendBefore=function(e,t,i){return t.parentNode?i?t.parentNode.insertBefore(e,t.nextSibling):t.parentNode.insertBefore(e,t):t},e}(),ud=function(){function e(){this.enterAction="P",this.position=-1,this.nodeSelection=new ad}return e.prototype.GetSpliceNode=function(e,t){return t=this.SplitNode(e,t,!0),t=this.SplitNode(e,t,!1),t},e.prototype.SplitNode=function(e,t,i){if(t){var n=e.cloneRange(),r=t.parentNode,s=this.nodeSelection.getIndex(t);n.collapse(i),i?n.setStartBefore(t):n.setEndAfter(t);var a=n.extractContents();if(i){if(t=r.childNodes[s],a=this.spliceEmptyNode(a,!1),a&&a.childNodes.length>0){var o=!(1!==a.childNodes.length||"IMG"===a.childNodes[0].nodeName||!this.isImgElm(a)||""!==a.textContent);if(!o)if(t)pd.AppendBefore(a,t);else{r.appendChild(a);var l=document.createElement("div");l.innerHTML="&#65279;&#65279;",t=l.firstChild,r.appendChild(t)}}}else if(t=r.childNodes.length>1?r.childNodes[s]:r.childNodes[0],a=this.spliceEmptyNode(a,!0),a&&a.childNodes.length>0){o=!(1!==a.childNodes.length||"IMG"===a.childNodes[0].nodeName||!this.isImgElm(a)||""!==a.textContent);if(!o)if(t)pd.AppendBefore(a,t,!0);else{r.appendChild(a);l=document.createElement("div");l.innerHTML="&#65279;&#65279;",r.insertBefore(l.firstChild,r.firstChild),t=r.firstChild}}return t}return null},e.prototype.isImgElm=function(e){var t=!0;if(1===e.childNodes.length&&"IMG"!==e.childNodes[0].nodeName)for(var i=e.childNodes[0],n=0;!Object(w["T"])(i.childNodes)&&n<i.childNodes.length;n++)"IMG"===i.childNodes[n].nodeName&&(t=!1);else t=!0;return t},e.prototype.spliceEmptyNode=function(e,t){var i;return i=1===e.childNodes.length&&"#text"===e.childNodes[0].nodeName&&""===e.childNodes[0].textContent||""===e.textContent?-1:e.childNodes.length-1,i>-1&&!t?this.spliceEmptyNode(e.childNodes[i],t):i>-1?this.spliceEmptyNode(e.childNodes[0],t):3!==e.nodeType&&11!==e.nodeType&&"IMG"!==e.nodeName&&e.parentNode.removeChild(e),e},e.prototype.GetCursorStart=function(e,t,i){e=i?e:e.reverse();for(var n=e[0],r=0;r<e.length&&(i?e[r]<t:e[r]>=t);r++)n=e[r];return n},e.prototype.GetCursorRange=function(e,t,i){var n=e.createRange(),r=[];r.push(0);var s=this.TrimLineBreak(i.data),a=s.indexOf(" ",0);while(-1!==a)r.indexOf(a)<0&&r.push(a),new RegExp("\\s").test(s[a-1])&&r.indexOf(a-1)<0&&r.push(a-1),new RegExp("\\s").test(s[a+1])&&r.push(a+1),a=s.indexOf(" ",a+1);if(r.push(s.length),r.indexOf(t.startOffset)>=0||r.indexOf(t.startOffset-1)>=0&&(1!==t.startOffset||1===t.startOffset&&new RegExp("\\s").test(s[0]))||r[r.length-1]-1===t.startOffset)n=t,this.position=1;else{var o=this.GetCursorStart(r,t.startOffset,!0);this.position=t.startOffset-o,n.setStart(t.startContainer,o),n.setEnd(t.startContainer,this.GetCursorStart(r,t.startOffset,!1))}return n},e.prototype.GetCursorNode=function(e,t,i){return this.GetSpliceNode(this.GetCursorRange(e,t,i),i)},e.prototype.TrimLineBreak=function(e){return e.replace(/(\r\n\t|\n|\r\t)/gm," ")},e}(),md=function(){function e(e){this.parent=e,this.addEventListener()}return e.prototype.addEventListener=function(){this.parent.observer.on(Vr,this.applyFormats,this),this.parent.observer.on(_r,this.onKeyUp,this),this.parent.observer.on(qr,this.onKeyDown,this)},e.prototype.getParentNode=function(e){for(;e.parentNode&&e.parentNode!==this.parent.editableElement;null)e=e.parentNode;return e},e.prototype.onKeyUp=function(e){var t=this.parent.nodeSelection.getRange(this.parent.currentDocument),i=t.endContainer,n=i.lastChild;if(13===e.event.which&&t.startContainer===i&&3!==i.nodeType){var r=Object(w["C"])("p");if(r.innerHTML="<br>",!Object(w["T"])(n)&&n&&"BR"===n.nodeName&&n.previousSibling&&"TABLE"===n.previousSibling.nodeName)i.replaceChild(r,n),this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,r,0);else{var s=this.parent.nodeSelection.getSelectionNodeCollectionBr(t)[0];!Object(w["T"])(s)&&"BR"===s.nodeName&&s.previousSibling&&"TABLE"===s.previousSibling.nodeName&&(i.replaceChild(r,s),this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,r,0))}}},e.prototype.onKeyDown=function(e){if(13===e.event.which){var t=this.parent.nodeSelection.getRange(this.parent.currentDocument),i=0===t.startContainer.textContent.length||"PRE"===t.startContainer.nodeName?t.startContainer:t.startContainer.parentElement,n=0===t.endContainer.textContent.length||"PRE"===t.endContainer.nodeName?t.endContainer:t.endContainer.parentElement,r=Object(w["A"])(i,"pre"),s=Object(w["A"])(n,"pre"),a=!Object(w["T"])(r)&&!Object(w["T"])(r.parentElement)&&"LI"===r.parentElement.tagName;if(a)return;if((Object(w["T"])(r)&&!Object(w["T"])(s)||!Object(w["T"])(r)&&Object(w["T"])(s))&&(e.event.preventDefault(),this.deleteContent(t),this.removeCodeContent(t),t=this.parent.nodeSelection.getRange(this.parent.currentDocument),this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,n,0)),13===e.event.which&&!Object(w["T"])(r)&&!Object(w["T"])(s)){e.event.preventDefault(),this.deleteContent(t),this.removeCodeContent(t),t=this.parent.nodeSelection.getRange(this.parent.currentDocument);var o=t.startContainer.childNodes[t.endOffset],l=t.startContainer.childNodes[t.endOffset-1],d=t.startContainer;if(Object(w["T"])(o)||Object(w["T"])(l)||!Object(w["T"])(o.nextSibling)||"BR"!==o.nodeName||"BR"!==l.nodeName)if(8203===d.textContent.charCodeAt(0)&&1===d.textContent.length||0===d.textContent.length){while("PRE"!==d.parentElement.nodeName&&(1===d.textContent.length||0===d.textContent.length))d=d.parentElement;!Object(w["T"])(d.previousSibling)&&"BR"===d.previousSibling.nodeName&&Object(w["T"])(d.nextSibling)?this.paraFocus(d.parentElement):this.isNotEndCursor(r,t)}else this.isNotEndCursor(r,t);else this.paraFocus(t.startContainer,e.enterAction)}}},e.prototype.removeCodeContent=function(e){var t=new RegExp(String.fromCharCode(65279),"g");if(!Object(w["T"])(e.endContainer.textContent.match(t))){var i=65279===e.endContainer.textContent.charCodeAt(e.endOffset-1)?e.endOffset-2:e.endOffset;e.endContainer.textContent=e.endContainer.textContent.replace(t,""),""===e.endContainer.textContent?this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,e.endContainer.parentElement,0):this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,e.endContainer,i)}},e.prototype.deleteContent=function(e){e.startContainer===e.endContainer&&e.startOffset===e.endOffset||e.deleteContents()},e.prototype.paraFocus=function(e,t){var i;"DIV"===t?(i=Object(w["C"])("div"),i.innerHTML="<br>"):"BR"===t?i=Object(w["C"])("br"):(i=Object(w["C"])("p"),i.innerHTML="<br>"),this.parent.domNode.insertAfter(i,e),this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,i,0),Object(w["F"])(e.lastChild)},e.prototype.isNotEndCursor=function(e,t){var i=new ud,n=t.startOffset===e.lastChild.textContent.length&&e.lastChild.textContent===t.startContainer.textContent;if(0===e.textContent.indexOf(t.startContainer.textContent)&&(0===t.startOffset&&0===t.endOffset||"PRE"===t.startContainer.nodeName)){this.insertMarker(e,t);var r=Object(w["C"])("br");e.childNodes[t.endOffset].parentElement.insertBefore(r,e.childNodes[t.endOffset])}else{var s=i.SplitNode(t,e,!0);this.insertMarker(e,t);var a=e.previousElementSibling;"PRE"===a.tagName&&(a.insertAdjacentHTML("beforeend","<br>"+s.innerHTML),Object(w["F"])(e))}this.setCursorPosition(n,e)},e.prototype.setCursorPosition=function(e,t){var i=!1,n=this.parent.editableElement.querySelector(".tempSpan"),r=n.parentElement;if(""===n.parentNode.textContent?i=!0:this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,n,0),e)if(i)r===t?(this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,n,0),Object(w["F"])(n)):this.focusSelectionParent(n,r);else{var s=Object(w["C"])("br");this.parent.domNode.insertAfter(s,n),this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,n,0),Object(w["F"])(n)}else i?this.focusSelectionParent(n,r):Object(w["F"])(n)},e.prototype.focusSelectionParent=function(e,t){Object(w["F"])(e),t.innerHTML="​",this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,t,0)},e.prototype.insertMarker=function(e,t){var i=Object(w["C"])("span",{className:"tempSpan"});"PRE"===t.startContainer.nodeName?e.childNodes[t.endOffset].parentElement.insertBefore(i,e.childNodes[t.endOffset]):t.startContainer.parentElement.insertBefore(i,t.startContainer)},e.prototype.applyFormats=function(e){var t=this.parent.nodeSelection.getRange(this.parent.currentDocument),i=!1;this.parent.editableElement!==t.endContainer||Object(w["T"])(this.parent.editableElement.children[t.endOffset-1])||"TABLE"!==this.parent.editableElement.children[t.endOffset-1].tagName||t.collapsed||(i=!0);var n=this.parent.nodeSelection.save(t,this.parent.currentDocument);this.parent.domNode.setMarker(n);var r=this.parent.domNode.blockNodes();if("BR"===e.enterAction){this.setSelectionBRConfig();var s=this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument),a=this.parent.nodeSelection.getSelectionNodes(s),o=[];0===a.length&&a.push(r[0]);for(var l=0;l<a.length;l++){var d=a[l],c=void 0;while(!this.parent.domNode.isBlockNode(d)&&d!==this.parent.editableElement)c=d,d=d.parentElement;this.parent.domNode.isBlockNode(d)&&d===this.parent.editableElement&&o.push(c)}for(l=0;l<o.length;l++)if(!this.parent.domNode.isBlockNode(o[l])){d=o[l];var h=d;while(d===this.parent.editableElement)h=d,d=d.parentElement;var p=void 0;this.parent.domNode.isBlockNode(h.parentElement)&&h.parentElement===this.parent.editableElement?(p=Object(w["C"])("div"),h.parentElement.insertBefore(p,h),p.appendChild(h)):p=h;var u=p.previousSibling;while(!Object(w["T"])(u)&&"BR"!==u.nodeName&&!this.parent.domNode.isBlockNode(u))p.firstChild.parentElement.insertBefore(u,p.firstChild),u=p.previousSibling;Object(w["T"])(u)||"BR"!==u.nodeName||Object(w["F"])(u);var m=p.nextSibling;while(!Object(w["T"])(m)&&"BR"!==m.nodeName&&!this.parent.domNode.isBlockNode(m))p.appendChild(m),m=p.nextSibling;Object(w["T"])(m)||"BR"!==m.nodeName||Object(w["F"])(m)}this.setSelectionBRConfig(),r=this.parent.domNode.blockNodes()}for(l=0;l<r.length;l++){var g=void 0,f=void 0;if("blockquote"===e.subCommand.toLowerCase()?(g=this.getParentNode(r[l]),f=this.parent.domNode.isList(g)||"TABLE"===g.tagName?g.outerHTML:g.innerHTML):(g=r[l],f=g.innerHTML),!(e.subCommand.toLowerCase()===g.tagName.toLowerCase()&&("pre"!==e.subCommand.toLowerCase()||!Object(w["T"])(e.exeValue)&&"dropDownSelect"===e.exeValue.name)||Object(w["T"])(g.parentNode)||"TABLE"===g.tagName&&"pre"===e.subCommand.toLowerCase())){this.cleanFormats(g,e.subCommand);var b="pre"===e.subCommand.toLowerCase()&&"pre"===g.tagName.toLowerCase()?"p":e.subCommand,v=this.parent.domNode.createTagString(b,g,f.replace(/>\s+</g,"><"));"LI"===g.tagName?(g.innerHTML="",g.insertAdjacentHTML("beforeend",v)):this.parent.domNode.replaceWith(g,v)}}this.preFormatMerge();var y=this.parent.editableElement.querySelector("."+dd.startSelection),C=this.parent.editableElement.querySelector("."+dd.endSelection);Object(w["T"])(y)||Object(w["T"])(C)||(y=y.lastChild,C=C.lastChild),n=this.parent.domNode.saveMarker(n,null),Dl()&&El(this.parent.editableElement,e.selector),i?this.parent.nodeSelection.setSelectionText(this.parent.currentDocument,y,C,0,C.textContent.length):n.restore(),e.callBack&&e.callBack({requestType:e.subCommand,editorMode:"HTML",event:e.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.domNode.blockNodes()})},e.prototype.setSelectionBRConfig=function(){var e=this.parent.editableElement.querySelector("."+dd.startSelection),t=this.parent.editableElement.querySelector("."+dd.endSelection);Object(w["T"])(t)?this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,e,0):this.parent.nodeSelection.setSelectionText(this.parent.currentDocument,e,t,0,0)},e.prototype.preFormatMerge=function(){var e=this.parent.editableElement.querySelectorAll("PRE");if(!Object(w["T"])(e))for(var t=0;t<e.length;t++){var i=e[t].previousElementSibling;Object(w["T"])(i)||"PRE"!==i.tagName||(i.insertAdjacentHTML("beforeend","<br>"+e[t].innerHTML),Object(w["F"])(e[t]))}},e.prototype.cleanFormats=function(e,t){var i=["display","font-size","margin-top","margin-bottom","margin-left","margin-right","font-weight"];t=t.toLowerCase();for(var n=0;n<i.length&&"p"!==t&&"blockquote"!==t&&"pre"!==t;n++)e.style.removeProperty(i[n])},e}(),gd=function(){function e(){}return e.Insert=function(e,t,i,n){var r;if("string"===typeof t){var s=document.createElement("div");s.innerHTML=t,r=n?s:s.firstChild}else if(n&&(Object(w["T"])(t)||Object(w["T"])(t.classList)||!t.classList.contains("pasteContent"))){s=document.createElement("div");s.appendChild(t),r=s}else r=t;var a=new ad,o=new ud,l=a.getRange(e);if(l.startContainer===i&&l.startContainer===l.endContainer&&0===l.startOffset&&l.startOffset===l.endOffset&&0===i.textContent.length&&"P"===i.children[0].tagName&&(a.setSelectionText(e,l.startContainer.children[0],l.startContainer.children[0],0,0),l=a.getRange(e)),"BR"===l.startContainer.nodeName&&0===l.startOffset&&l.startOffset===l.endOffset&&l.startContainer===l.endContainer){var d=Array.prototype.slice.call(l.startContainer.parentElement.children).indexOf(l.startContainer);a.setSelectionText(e,l.startContainer.parentElement,l.startContainer.parentElement,d+1,d+1),l=a.getRange(e)}var c=l.startOffset===l.endOffset&&0===l.startOffset&&l.startContainer===l.endContainer,h=l.collapsed,p=this.getNodeCollection(l,a,r),u="table"===r.nodeName.toLowerCase()?this.closestEle(p[0].parentNode,i):p[0];if(n||!Object(w["T"])(r)&&!Object(w["T"])(r.classList)&&r.classList.contains("pasteContent"))this.pasteInsertHTML(p,r,l,a,o,e,h,u,i);else if(i!==l.startContainer&&(!h&&(u.nodeType!==Node.ELEMENT_NODE||-1===ed.indexOf(u.tagName.toLocaleLowerCase()))||"table"===r.nodeName.toLowerCase()&&u&&-1===ed.indexOf(u.tagName.toLocaleLowerCase()))){var m=o.GetSpliceNode(l,u),g=m.previousSibling,f=m.parentNode;if(1===p.length||"table"===r.nodeName.toLowerCase()&&0===m.childElementCount)a.setSelectionContents(e,m),l=a.getRange(e);else{var b=o.GetSpliceNode(l,p[p.length-1].parentElement);b=Object(w["T"])(b)?m:b,a.setSelectionText(e,m,b,0,3===b.nodeType?b.textContent.length:b.childNodes.length),l=a.getRange(e)}l.extractContents(),"TABLE"===t.tagName&&this.removeEmptyElements(i);for(var v=0;v<p.length;v++)if(3!==p[v].nodeType&&null!=p[v].parentNode){if("IMG"===p[v].nodeName)continue;p[v].parentNode.removeChild(p[v])}if(g)pd.AppendBefore(r,g,!0);else{var y=null;while(f!==i&&f.firstChild&&""===f.textContent.trim()){var C=f.parentNode;y=f,f=C}null!==y&&(f=y),f.firstChild&&(f!==i||"TABLE"===r.nodeName&&c&&f===l.startContainer&&f===l.endContainer)?""===f.textContent.trim()&&f!==i?(pd.AppendBefore(r,f,!1),Object(w["F"])(f)):pd.AppendBefore(r,f.firstChild,!1):f.appendChild(r)}"IMG"===r.nodeName?this.imageFocus(r,a,e):3!==r.nodeType?a.setSelectionText(e,r,r,0,r.childNodes.length):a.setSelectionText(e,r,r,0,r.textContent.length)}else{if(l.deleteContents(),c&&""===l.startContainer.textContent&&"BR"!==l.startContainer.nodeName&&(l.startContainer.innerHTML=""),w["d"].isIE){var O=e.createDocumentFragment();O.appendChild(r),l.insertNode(O)}else if(1===l.startContainer.nodeType&&"hr"===l.startContainer.nodeName.toLowerCase()&&"hr"===l.endContainer.nodeName.toLowerCase()){var T=l.startContainer.nextElementSibling;T&&(T.querySelector("br")&&Object(w["F"])(T.querySelector("br")),T.appendChild(r))}else"BR"===l.startContainer.nodeName?l.startContainer.parentElement.insertBefore(r,l.startContainer):l.insertNode(r);3!==r.nodeType&&r.childNodes.length>0?a.setSelectionText(e,r,r,1,1):"IMG"===r.nodeName?this.imageFocus(r,a,e):3!==r.nodeType?a.setSelectionContents(e,r):a.setSelectionText(e,r,r,r.textContent.length,r.textContent.length)}},e.pasteInsertHTML=function(e,t,i,n,r,s,a,o,l){var d,c,h,p,u=i.startOffset===i.endOffset&&i.startContainer===i.endContainer;if(u&&i.startContainer===l&&""===l.textContent){var m=this.getImmediateBlockNode(e[e.length-1],l);n.setSelectionText(s,m,m,0,0),i=n.getRange(s)}l!==i.startContainer&&(!a&&(o.nodeType!==Node.ELEMENT_NODE||-1===ed.indexOf(o.tagName.toLocaleLowerCase()))||"table"===t.nodeName.toLowerCase()&&o&&-1===ed.indexOf(o.tagName.toLocaleLowerCase()))&&(p=r.GetSpliceNode(i,o),c=Object(w["T"])(p.previousSibling)?p.parentNode.previousSibling:p.previousSibling,1===e.length?(n.setSelectionContents(s,p),i=n.getRange(s),h=!0):(d=r.GetSpliceNode(i,e[e.length-1].parentElement),d=Object(w["T"])(d)?p:d,n.setSelectionText(s,p,d,0,3===d.nodeType?d.textContent.length:d.childNodes.length),i=n.getRange(s),h=!1));var g=!1;this.removingComments(t);for(var f,b=t.childNodes,v=0;v<b.length;v++)if(Yl.indexOf(b[v].nodeName.toLocaleLowerCase())>=0){g=!0;break}var y=document.createDocumentFragment();if(g){this.insertTempNode(i,t,e,r,l);var C=!0,O=void 0,T=void 0,k=void 0;this.contentsDeleted||i.deleteContents();while(t.firstChild)if("#text"!==t.firstChild.nodeName||""!==t.firstChild.textContent.trim())if("#text"===t.firstChild.nodeName&&C||this.inlineNode.indexOf(t.firstChild.nodeName.toLocaleLowerCase())>=0&&C){if(f=t.firstChild,Object(w["T"])(t.previousElementSibling)){var S=Object(w["C"])("p");t.parentElement.insertBefore(S,t)}t.previousElementSibling.appendChild(t.firstChild)}else f=t.firstChild,"#text"===t.firstChild.nodeName||this.inlineNode.indexOf(t.firstChild.nodeName.toLocaleLowerCase())>=0?(O?(k.appendChild(t.firstChild),y.appendChild(k)):(T=Object(w["C"])("p"),T.appendChild(t.firstChild),y.appendChild(T)),k=T,O=!0):(y.appendChild(t.firstChild),O=!1),C=!1;else Object(w["F"])(t.firstChild);t.parentNode.replaceChild(y,t)}else if(u){var j=Object(w["C"])("span",{className:"tempSpan"}),R=Object(w["A"])(i.startContainer.parentElement,"a");if(3===i.startContainer.nodeType&&R&&Object(w["A"])(R,"span")){var D=this.getImmediateBlockNode(i.startContainer,l);D.querySelectorAll("br").length>0&&Object(w["F"])(D.querySelector("br"));var E=Object(w["A"])(R,"span");E.appendChild(j)}else i.insertNode(j);while(t.firstChild)f=t.firstChild,y.appendChild(t.firstChild);j.parentNode.replaceChild(y,j)}else{while(t.firstChild)f=t.firstChild,y.appendChild(t.firstChild);h?p.parentNode.replaceChild(y,p):(i.deleteContents(),Object(w["F"])(d),Object(w["T"])(c)?l.appendChild(y):c.parentNode.appendChild(y))}"#text"===f.nodeName?this.placeCursorEnd(f,t,n,s,l):this.cursorPos(f,t,n,s,l)},e.placeCursorEnd=function(e,t,i,n,r){e="BR"===e.nodeName?Object(w["T"])(e.previousSibling)?e.parentNode:e.previousSibling:e;while(!Object(w["T"])(e)&&"#text"!==e.nodeName&&"IMG"!==e.nodeName&&"BR"!==e.nodeName&&"HR"!==e.nodeName)e=e.lastChild;e=Object(w["T"])(e)?t:e,"IMG"===e.nodeName?this.imageFocus(e,i,n):i.setSelectionText(n,e,e,e.textContent.length,e.textContent.length),this.removeEmptyElements(r)},e.getNodeCollection=function(e,t,i){var n=[];return e.startOffset===e.endOffset&&e.startContainer===e.endContainer&&"BR"!=e.startContainer.nodeName&&("TD"===e.startContainer.nodeName||3!==e.startContainer.nodeType&&i.classList&&i.classList.contains("pasteContent"))?n.push(e.startContainer.childNodes[e.endOffset]):n=t.getInsertNodeCollection(e),n},e.insertTempNode=function(e,t,i,n,r){if(e.startContainer!==r||Object(w["T"])(e.startContainer.childNodes[e.endOffset-1])||"TABLE"!==e.startContainer.childNodes[e.endOffset-1].nodeName)if(e.startContainer!==r||Object(w["T"])(e.startContainer.childNodes[e.endOffset])||"TABLE"!==e.startContainer.childNodes[e.endOffset].nodeName)if(e.startContainer===e.endContainer&&3!==e.startContainer.nodeType&&"HR"===t.firstChild.nodeName)e.startContainer.classList.contains("e-content")||"BODY"===e.startContainer.nodeName?e.startContainer.appendChild(t):e.startContainer.parentNode.insertBefore(t,e.startContainer);else{var s=this.getImmediateBlockNode(i[i.length-1],r);if((Object(w["T"])(s)||Object(w["T"])(s.parentElement))&&3!==e.endContainer.nodeType&&(s=e.endContainer,e.setEnd(s,e.endContainer.textContent.length)),"BODY"===s.nodeName&&e.startContainer===e.endContainer&&1===e.startContainer.nodeType&&(s=e.startContainer),s.closest("LI")&&t&&t.firstElementChild&&("OL"===t.firstElementChild.tagName||"UL"===t.firstElementChild.tagName)){var a=void 0;while(t.firstElementChild.lastElementChild&&"LI"===t.firstElementChild.lastElementChild.tagName)a=t.firstElementChild.lastElementChild,a.style.removeProperty("margin-left"),a.style.removeProperty("margin-top"),a.style.removeProperty("margin-bottom"),t.firstElementChild.insertAdjacentElement("afterend",a)}if("TD"===s.nodeName||"TH"===s.nodeName){var o=Object(w["C"])("span",{className:"tempSpan"});e.insertNode(o),o.parentNode.replaceChild(t,o)}else{var l=new ad,d=this.getNodeCollection(e,l,t)[this.getNodeCollection(e,l,t).length-1],c=void 0;if("BR"!==d.nodeName&&"HR"!==d.nodeName&&("#text"!==d.nodeName||Object(w["T"])(d.parentElement)||"LI"!==d.parentElement.nodeName)||Object(w["T"])(d.parentElement)||0!==d.parentElement.textContent.trim().length){if("#text"===d.nodeName&&!Object(w["T"])(d.parentElement)&&"LI"===d.parentElement.nodeName&&d.parentElement.textContent.trim().length>0)return c=d,"LI"!==d.parentElement.nodeName||Object(w["T"])(d.nextSibling)||"BR"!==d.nextSibling.nodeName||Object(w["F"])(d.nextSibling),e.collapsed||e.deleteContents(),e.insertNode(t),void(this.contentsDeleted=!0);c=n.GetSpliceNode(e,s)}else c=d,"LI"!==d.parentElement.nodeName||Object(w["T"])(d.nextSibling)||"BR"!==d.nextSibling.nodeName||Object(w["F"])(d.nextSibling);c.parentNode.replaceChild(t,c)}}else e.startContainer.insertBefore(t,e.startContainer.childNodes[e.endOffset]);else Object(w["T"])(e.startContainer.childNodes[e.endOffset-1].nextSibling)?e.startContainer.appendChild(t):e.startContainer.insertBefore(t,e.startContainer.childNodes[e.endOffset-1].nextSibling)},e.cursorPos=function(e,t,i,n,r){e.classList.add("lastNode"),r.innerHTML=Il(r.innerHTML),e=r.querySelector(".lastNode"),Object(w["T"])(e)||(this.placeCursorEnd(e,t,i,n,r),e.classList.remove("lastNode"),0===e.classList.length&&e.removeAttribute("class"))},e.imageFocus=function(e,t,i){var n=document.createTextNode(" ");e.parentNode.insertBefore(n,e.nextSibling),t.setSelectionText(i,e.nextSibling,e.nextSibling,0,0)},e.getImmediateBlockNode=function(e,t){do{e=e.parentNode}while(e&&Yl.indexOf(e.nodeName.toLocaleLowerCase())<0);return e},e.removingComments=function(e){var t=e.innerHTML;t=t.replace(/<!--[\s\S]*?-->/g,""),e.innerHTML=t},e.findDetachEmptyElem=function(e){var t;return t=Object(w["T"])(e.parentElement)?null:""===e.parentElement.textContent.trim()&&"true"!==e.parentElement.contentEditable?this.findDetachEmptyElem(e.parentElement):e,t},e.removeEmptyElements=function(e){for(var t=e.querySelectorAll(":empty"),i=0;i<t.length;i++)if(sd.indexOf(t[i].tagName.toLowerCase())<0){var n=this.findDetachEmptyElem(t[i]);Object(w["T"])(n)||Object(w["F"])(n)}},e.closestEle=function(e,t){var i=e;while(i&&1===i.nodeType){if(i.parentNode===t||!Object(w["T"])(i.parentNode.tagName)&&-1!==Zl.indexOf(i.parentNode.tagName.toLocaleLowerCase()))return i;i=i.parentNode}return null},e.inlineNode=["a","abbr","acronym","audio","b","bdi","bdo","big","br","button","canvas","cite","code","data","datalist","del","dfn","em","embed","font","i","iframe","img","input","ins","kbd","label","map","mark","meter","noscript","object","output","picture","progress","q","ruby","s","samp","script","select","slot","small","span","strong","sub","sup","svg","template","textarea","time","u","tt","var","video","wbr"],e.contentsDeleted=!1,e}(),fd=function(){function e(e){this.parent=e,this.addEventListener()}return e.prototype.addEventListener=function(){this.parent.observer.on(Bl,this.linkCommand,this)},e.prototype.linkCommand=function(e){switch(e.value.toString().toLocaleLowerCase()){case"createlink":case"editlink":this.createLink(e);break;case"openlink":this.openLink(e);break;case"removelink":this.removeLink(e);break}},e.prototype.createLink=function(e){var t=!Object(w["T"])(e.item.selectParent)&&e.item.selectParent.length>0&&Object(w["A"])(e.item.selectParent[0],"a");if(t=Object(w["T"])(t)?!Object(w["T"])(e.item.selectParent)&&e.item.selectParent.length>0?e.item.selectParent[0]:null:t,Object(w["T"])(t)||"A"!==t.tagName){var i=new ad,n=i.getRange(this.parent.currentDocument);"#text"===n.endContainer.nodeName&&n.startContainer.textContent.length===n.endOffset+1&&" "===n.endContainer.textContent.charAt(n.endOffset)&&"A"===n.endContainer.nextSibling.nodeName&&(i.setSelectionText(this.parent.currentDocument,n.startContainer,n.endContainer,n.startOffset,n.endOffset+1),n=i.getRange(this.parent.currentDocument));var r=!!Object(w["T"])(e.item.text)||e.item.text.replace(/ /g,"").localeCompare(n.toString().replace(/\n/g," ").replace(/ /g,""))<0;if(e.event&&"keydown"===e.event.type&&(32===e.event.keyCode||13===e.event.keyCode)||"Paste"===e.item.action||n.collapsed||r){var s=this.createAchorNode(e);if(s.innerText=""===e.item.text?e.item.url:e.item.text,e.item.selection.restore(),gd.Insert(this.parent.currentDocument,s,this.parent.editableElement),!e.event||"keydown"!==e.event.type||32!==e.event.keyCode&&13!==e.event.keyCode){d="Paste"===e.item.action?s.childNodes[0].textContent.length:0;e.item.selection.setSelectionText(this.parent.currentDocument,s.childNodes[0],s.childNodes[0],d,s.childNodes[0].textContent.length)}else{var a=e.item.selection.range.startContainer;a.textContent=this.removeText(a.textContent,e.item.text)}}else this.createLinkNode(e)}else{var o=t,l="";if(Object(w["T"])(e.item.url)||o.setAttribute("href",e.item.url),Object(w["T"])(e.item.title)||o.setAttribute("title",e.item.title),Object(w["T"])(e.item.text)||""===e.item.text||(l=o.innerText,o.innerText=e.item.text),Object(w["T"])(e.item.target)?o.removeAttribute("target"):o.setAttribute("target",e.item.target),l===e.item.text)e.item.selection.setSelectionText(this.parent.currentDocument,o,o,1,1),e.item.selection.restore();else{var d="Paste"===e.item.action?o.childNodes[0].textContent.length:0;e.item.selection.setSelectionText(this.parent.currentDocument,o.childNodes[0],o.childNodes[0],d,o.childNodes[0].textContent.length)}}e.callBack&&e.callBack({requestType:"Links",editorMode:"HTML",event:e.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},e.prototype.createLinkNode=function(e){for(var t,i,n=new ad,r=new ud,s=n.getRange(this.parent.currentDocument),a=this.getSelectionNodes(n.getNodeCollection(s)),o=n.save(s,this.parent.currentDocument),l=[],d=[],c=[],h=[],p=[],u=0;u<a.length;u++)a[u]=r.GetSpliceNode(s,a[u]),l[u]=a[u];for(var m=0;m<l.length;m++){var g=!0;t=l[m];while(!0===g){if("A"===t.parentNode.nodeName){var f=t.parentNode;t.parentNode.parentNode.insertBefore(f.firstChild,f),t.parentNode.removeChild(f)}this.isBlockNode(t.parentNode)||0===l.length||0===m||m===l.length-1||3===s.startContainer.nodeType?(d[m]=t,g=!1):t=t.parentNode}}m=0;for(var b=0;m<d.length;m++)if(0===m&&(p[b]=d[m]),d.length>1&&m<d.length-1){if(d[m].parentElement===d[m+1].parentElement&&d[m]===d[m+1])continue;p[b+1]=d[m+1],b++}var v=0;h[v]=this.createAchorNode(e);for(m=0;m<p.length;m++)if(0===m&&(i=p[m].cloneNode(!0),h[m].appendChild(i)),m<p.length-1)if(p[m].parentNode===p[m+1].parentNode){var y=p[m+1].cloneNode(!0);h[v].appendChild(y)}else v+=1,h[v]=this.createAchorNode(e),i=p[m+1].cloneNode(!0),h[v].appendChild(i);this.parent.nodeSelection.setRange(document,o.range);m=0;for(var C=0,w=0;m<=p.length;m++)0===m&&(p[m].parentNode.insertBefore(h[C],p[m].nextSibling),1===this.parent.domNode.blockNodes().length&&this.parent.nodeSelection.setSelectionNode(this.parent.currentDocument,h[C]),c[w]=p[m],w++),m<p.length-1&&(p[m].parentNode===p[m+1].parentNode?(c[w]=p[m+1],w++):(C+=1,p[m+1].parentNode.insertBefore(h[C],p[m+1]),c[w]=p[m+1],w++));for(m=0;m<c.length;m++)c[m].parentNode&&c[m].parentNode.removeChild(c[m])},e.prototype.createAchorNode=function(e){var t=Object(w["C"])("a",{className:"e-rte-anchor",attrs:{href:e.item.url,title:Object(w["T"])(e.item.title)||""===e.item.title?e.item.url:e.item.title}});return Object(w["T"])(e.item.target)||t.setAttribute("target",e.item.target),t},e.prototype.getSelectionNodes=function(e){e=e.reverse();for(var t=0;t<e.length;t++)3===e[t].nodeType&&""!==e[t].textContent.trim()||"IMG"!==e[t].nodeName&&(e.splice(t,1),t--);return e.reverse()},e.prototype.isBlockNode=function(e){return!!e&&e.nodeType===Node.ELEMENT_NODE&&Yl.indexOf(e.tagName.toLowerCase())>=0},e.prototype.removeText=function(e,t){for(var i=e.split(" "),n=0;n<i.length;n++)i[n]===t&&(i.splice(n,1),n--);return i.join(" ")+" "},e.prototype.openLink=function(e){document.defaultView.open(e.item.url,e.item.target),this.callBack(e)},e.prototype.removeLink=function(e){var t=this.parent.domNode.blockNodes();if(t.length<2){this.parent.domNode.setMarker(e.item.selection);for(var i=Object(w["A"])(e.item.selectParent[0],"a"),n=i||e.item.selectParent[0],r=n.parentNode,s=[];n.firstChild;null)s.push(r.insertBefore(n.firstChild,n));r.removeChild(n),s&&1===s.length&&(e.item.selection.startContainer=e.item.selection.getNodeArray(s[s.length-1],!0),e.item.selection.endContainer=e.item.selection.startContainer),e.item.selection=this.parent.domNode.saveMarker(e.item.selection)}else for(var a=0;a<t.length;a++)for(var o=t[a].querySelectorAll("a"),l=0;l<o.length;l++)document.getSelection().containsNode(o[l],!0)&&(o[l].outerHTML=o[l].innerHTML);e.item.selection.restore(),this.callBack(e)},e.prototype.callBack=function(e){e.callBack&&e.callBack({requestType:e.item.subCommand,editorMode:"HTML",event:e.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},e}(),bd=function(){function e(e){this.alignments={JustifyLeft:"left",JustifyCenter:"center",JustifyRight:"right",JustifyFull:"justify"},this.parent=e,this.addEventListener()}return e.prototype.addEventListener=function(){this.parent.observer.on(Xl,this.applyAlignment,this),this.parent.observer.on(qr,this.onKeyDown,this)},e.prototype.onKeyDown=function(e){switch(e.event.action){case"justify-center":this.applyAlignment({subCommand:"JustifyCenter",callBack:e.callBack}),e.event.preventDefault();break;case"justify-full":this.applyAlignment({subCommand:"JustifyFull",callBack:e.callBack}),e.event.preventDefault();break;case"justify-left":this.applyAlignment({subCommand:"JustifyLeft",callBack:e.callBack}),e.event.preventDefault();break;case"justify-right":this.applyAlignment({subCommand:"JustifyRight",callBack:e.callBack}),e.event.preventDefault();break}},e.prototype.getTableNode=function(e){var t=e.startContainer.nodeType===Node.ELEMENT_NODE?e.startContainer:e.startContainer.parentNode,i=Object(w["A"])(t,"td,th");return[i]},e.prototype.applyAlignment=function(e){var t="Table"===e.value,i=this.parent.nodeSelection.getRange(this.parent.currentDocument),n=this.parent.nodeSelection.save(i,this.parent.currentDocument);if(t)Object(w["mb"])(this.getTableNode(i)[0],{"text-align":this.alignments[e.subCommand]});else{this.parent.domNode.setMarker(n);for(var r=this.parent.domNode.blockNodes(),s=0;s<r.length;s++){var a=r[s];Object(w["mb"])(a,{"text-align":this.alignments[e.subCommand]})}var o=this.parent.domNode.getImageTagInSelection();for(s=0;s<o.length;s++){var l=[];l.push(o[s]),this.parent.imgObj.imageCommand({item:{selectNode:l},subCommand:e.subCommand,value:e.subCommand,callBack:e.callBack,selector:e.selector})}this.parent.editableElement.focus(),n=this.parent.domNode.saveMarker(n),Dl()&&El(this.parent.editableElement,e.selector),n.restore()}e.callBack&&e.callBack({requestType:e.subCommand,editorMode:"HTML",event:e.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:t?this.getTableNode(i):this.parent.domNode.blockNodes()})},e}(),vd=function(){function e(e){this.indentValue=20,this.parent=e,this.addEventListener()}return e.prototype.addEventListener=function(){this.parent.observer.on(Jl,this.applyIndents,this),this.parent.observer.on(qr,this.onKeyDown,this)},e.prototype.onKeyDown=function(e){switch(e.event.action){case"indents":this.applyIndents({subCommand:"Indent",callBack:e.callBack}),e.event.preventDefault();break;case"outdents":this.applyIndents({subCommand:"Outdent",callBack:e.callBack}),e.event.preventDefault();break}},e.prototype.applyIndents=function(e){var t=this.parent.editableElement,i=t.classList.contains("e-rtl"),n=this.parent.nodeSelection.getRange(this.parent.currentDocument),r=this.parent.nodeSelection.save(n,this.parent.currentDocument);this.parent.domNode.setMarker(r);for(var s=this.parent.domNode.blockNodes(),a=s.slice(),o=[],l=0;l<a.length;l++)"LI"!==a[l].tagName&&"LI"===a[l].parentNode.tagName?(s.splice(s.indexOf(a[l]),1),o.push(a[l].parentNode)):"LI"===a[l].tagName&&(s.splice(s.indexOf(a[l]),1),o.push(a[l]));o.length>0&&this.parent.observer.notify(qr,{event:{preventDefault:function(){},stopPropagation:function(){},shiftKey:"Indent"!==e.subCommand,which:9,action:"indent"},ignoreDefault:!0});for(l=0;l<s.length;l++){var d=s[l],c=i?d.style.marginRight:d.style.marginLeft,h=void 0;"Indent"===e.subCommand?(h=""===c?this.indentValue+"px":parseInt(c,null)+this.indentValue+"px",i?d.style.marginRight=h:d.style.marginLeft=h):(h=""===c||"0px"===c?"":parseInt(c,null)-this.indentValue+"px",i?d.style.marginRight=h:d.style.marginLeft=h)}t.focus(),Dl()&&El(t,e.selector),r=this.parent.domNode.saveMarker(r),r.restore(),e.callBack&&e.callBack({requestType:e.subCommand,editorMode:"HTML",event:e.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.domNode.blockNodes()})},e}(),yd="e-imgright",Cd="e-imgleft",wd="e-imgcenter",Od="e-imgbreak",Td="e-img-caption",kd="e-caption-inline",Sd="e-imginline",jd=function(){function e(e){this.parent=e,this.addEventListener()}return e.prototype.addEventListener=function(){this.parent.observer.on(Nl,this.imageCommand,this)},e.prototype.imageCommand=function(e){switch(e.value.toString().toLowerCase()){case"image":case"replace":this.createImage(e);break;case"insertlink":this.insertImageLink(e);break;case"openimagelink":this.openImageLink(e);break;case"editimagelink":this.editImageLink(e);break;case"removeimagelink":this.removeImageLink(e);break;case"remove":this.removeImage(e);break;case"alttext":this.insertAltTextImage(e);break;case"dimension":this.imageDimension(e);break;case"caption":this.imageCaption(e);break;case"justifyleft":this.imageJustifyLeft(e);break;case"justifycenter":this.imageJustifyCenter(e);break;case"justifyright":this.imageJustifyRight(e);break;case"inline":this.imageInline(e);break;case"break":this.imageBreak(e);break}},e.prototype.createImage=function(e){var t=this,i=!1;if(e.item.url=Object(w["T"])(e.item.url)||"undefined"===e.item.url?e.item.src:e.item.url,Object(w["T"])(e.item.selectParent)||"IMG"!==e.item.selectParent[0].tagName){var n=Object(w["C"])("img");this.setStyle(n,e),Object(w["T"])(e.item.selection)||e.item.selection.restore(),Object(w["T"])(e.selector)||"pasteCleanupModule"!==e.selector?gd.Insert(this.parent.currentDocument,n,this.parent.editableElement):e.callBack({requestType:"Images",editorMode:"HTML",event:e.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:[n]})}else{var r=e.item.selectParent[0];this.setStyle(r,e),i=!0}if(e.callBack&&(Object(w["T"])(e.selector)||!Object(w["T"])(e.selector)&&"pasteCleanupModule"!==e.selector)){var s=this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)[0],a="Replace"===e.value||i?e.item.selectParent[0]:w["d"].isIE?s.previousSibling:s.previousElementSibling;a.addEventListener("load",function(){"Replace"===e.value&&i||e.callBack({requestType:"Images",editorMode:"HTML",event:e.event,range:t.parent.nodeSelection.getRange(t.parent.currentDocument),elements:[a]})})}},e.prototype.setStyle=function(e,t){Object(w["T"])(t.item.url)||e.setAttribute("src",t.item.url),e.setAttribute("class","e-rte-image"+(Object(w["T"])(t.item.cssClass)?"":" "+t.item.cssClass)),Object(w["T"])(t.item.altText)||e.setAttribute("alt",t.item.altText),Object(w["T"])(t.item.width)||Object(w["T"])(t.item.width.width)||e.setAttribute("width",this.calculateStyleValue(t.item.width.width)),Object(w["T"])(t.item.height)||Object(w["T"])(t.item.height.height)||e.setAttribute("height",this.calculateStyleValue(t.item.height.height)),Object(w["T"])(t.item.width)||Object(w["T"])(t.item.width.minWidth)||(e.style.minWidth=this.calculateStyleValue(t.item.width.minWidth)),Object(w["T"])(t.item.width)||Object(w["T"])(t.item.width.maxWidth)||(e.style.maxWidth=this.calculateStyleValue(t.item.width.maxWidth)),Object(w["T"])(t.item.height)||Object(w["T"])(t.item.height.minHeight)||(e.style.minHeight=this.calculateStyleValue(t.item.height.minHeight)),Object(w["T"])(t.item.height)||Object(w["T"])(t.item.height.maxHeight)||(e.style.maxHeight=this.calculateStyleValue(t.item.height.maxHeight))},e.prototype.calculateStyleValue=function(e){var t;return t="string"===typeof e&&(e.indexOf("px")||e.indexOf("%")||e.indexOf("auto"))?e:e+"px",t},e.prototype.insertImageLink=function(e){var t=Object(w["C"])("a",{attrs:{href:e.item.url}});e.item.selectNode[0].parentElement.classList.contains("e-img-wrap")&&(e.item.selection.restore(),t.setAttribute("contenteditable","true")),t.appendChild(e.item.selectNode[0]),Object(w["T"])(e.item.target)||t.setAttribute("target",e.item.target),gd.Insert(this.parent.currentDocument,t,this.parent.editableElement),this.callBack(e)},e.prototype.openImageLink=function(e){document.defaultView.open(e.item.url,e.item.target),this.callBack(e)},e.prototype.removeImageLink=function(e){var t=e.item.selectParent[0];if(t.classList.contains("e-img-caption")){var i=Object(w["jb"])(".e-img-wrap",t),n=Object(w["jb"])(".e-img-inner",t),r=n.cloneNode(!0);Object(w["F"])(Object(w["jb"])("a",t)),Object(w["F"])(n),i.appendChild(e.item.insertElement),i.appendChild(r)}else Object(w["F"])(t),w["d"].isIE&&e.item.selection.restore(),gd.Insert(this.parent.currentDocument,e.item.insertElement,this.parent.editableElement);this.callBack(e)},e.prototype.editImageLink=function(e){e.item.selectNode[0].parentElement.href=e.item.url,Object(w["T"])(e.item.target)?e.item.selectNode[0].parentElement.removeAttribute("target"):e.item.selectNode[0].parentElement.target=e.item.target,this.callBack(e)},e.prototype.removeImage=function(e){Object(w["A"])(e.item.selectNode[0],"a")&&("A"!==e.item.selectNode[0].parentElement.nodeName||Object(w["T"])(e.item.selectNode[0].parentElement.innerText))?Object(w["F"])(Object(w["A"])(e.item.selectNode[0],"a")):Object(w["T"])(Object(w["A"])(e.item.selectNode[0],"."+Td))?Object(w["F"])(e.item.selectNode[0]):Object(w["F"])(Object(w["A"])(e.item.selectNode[0],"."+Td)),this.callBack(e)},e.prototype.insertAltTextImage=function(e){e.item.selectNode[0].setAttribute("alt",e.item.altText),this.callBack(e)},e.prototype.imageDimension=function(e){var t=e.item.selectNode[0];t.style.height="",t.style.width="","auto"!==e.item.width?t.style.width=Object(w["H"])(e.item.width):t.removeAttribute("width"),"auto"!==e.item.height?t.style.height=Object(w["H"])(e.item.height):t.removeAttribute("height"),this.callBack(e)},e.prototype.imageCaption=function(e){gd.Insert(this.parent.currentDocument,e.item.insertElement,this.parent.editableElement),this.callBack(e)},e.prototype.imageJustifyLeft=function(e){var t=e.item.selectNode[0];Object(w["T"])(t)||(t.removeAttribute("class"),Object(w["u"])([t],"e-rte-image"),Object(w["T"])(Object(w["A"])(t,"."+Td))||(Object(w["gb"])([Object(w["A"])(t,"."+Td)],yd),Object(w["u"])([Object(w["A"])(t,"."+Td)],Cd)),"A"===t.parentElement.nodeName?(Object(w["gb"])([t.parentElement],yd),Object(w["u"])([t.parentElement],Cd),Object(w["u"])([t],Cd)):Object(w["u"])([t],Cd),this.callBack(e))},e.prototype.imageJustifyCenter=function(e){var t=e.item.selectNode[0];Object(w["T"])(t)||(t.removeAttribute("class"),Object(w["u"])([t],"e-rte-image"),Object(w["T"])(Object(w["A"])(t,"."+Td))||(Object(w["gb"])([Object(w["A"])(t,"."+Td)],Cd),Object(w["gb"])([Object(w["A"])(t,"."+Td)],yd),Object(w["u"])([Object(w["A"])(t,"."+Td)],wd)),"A"===t.parentElement.nodeName?(Object(w["gb"])([t.parentElement],Cd),Object(w["gb"])([t.parentElement],yd),Object(w["u"])([t.parentElement],wd),Object(w["u"])([t],wd)):Object(w["u"])([t],wd),this.callBack(e))},e.prototype.imageJustifyRight=function(e){var t=e.item.selectNode[0];Object(w["T"])(t)||(t.removeAttribute("class"),Object(w["u"])([t],"e-rte-image"),Object(w["T"])(Object(w["A"])(t,"."+Td))||(Object(w["gb"])([Object(w["A"])(t,"."+Td)],Cd),Object(w["u"])([Object(w["A"])(t,"."+Td)],yd)),"A"===t.parentElement.nodeName?(Object(w["gb"])([t.parentElement],Cd),Object(w["u"])([t.parentElement],yd),Object(w["u"])([t],yd)):Object(w["u"])([t],yd),this.callBack(e))},e.prototype.imageInline=function(e){var t=e.item.selectNode[0];t.removeAttribute("class"),Object(w["u"])([t],"e-rte-image"),Object(w["u"])([t],Sd),Object(w["T"])(Object(w["A"])(t,"."+Td))||(Object(w["gb"])([Object(w["A"])(t,"."+Td)],Od),Object(w["gb"])([Object(w["A"])(t,"."+Td)],wd),Object(w["gb"])([Object(w["A"])(t,"."+Td)],Cd),Object(w["gb"])([Object(w["A"])(t,"."+Td)],yd),Object(w["u"])([Object(w["A"])(t,"."+Td)],kd)),this.callBack(e)},e.prototype.imageBreak=function(e){var t=e.item.selectNode[0];t.removeAttribute("class"),Object(w["u"])([t],Od),Object(w["u"])([t],"e-rte-image"),Object(w["T"])(Object(w["A"])(t,"."+Td))||(Object(w["gb"])([Object(w["A"])(t,"."+Td)],kd),Object(w["gb"])([Object(w["A"])(t,"."+Td)],wd),Object(w["gb"])([Object(w["A"])(t,"."+Td)],Cd),Object(w["gb"])([Object(w["A"])(t,"."+Td)],yd),Object(w["u"])([Object(w["A"])(t,"."+Td)],Od)),this.callBack(e)},e.prototype.callBack=function(e){e.callBack&&e.callBack({requestType:e.item.subCommand,editorMode:"HTML",event:e.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},e}(),Rd=function(){function e(e){this.parent=e,this.addEventListener()}return e.prototype.addEventListener=function(){this.parent.observer.on(Al,this.createTable,this),this.parent.observer.on(Fl,this.insertRow,this),this.parent.observer.on(Hl,this.insertColumn,this),this.parent.observer.on(Vl,this.deleteRow,this),this.parent.observer.on(ql,this.deleteColumn,this),this.parent.observer.on(zl,this.removeTable,this),this.parent.observer.on(_l,this.tableHeader,this),this.parent.observer.on(Ul,this.tableVerticalAlign,this),this.parent.observer.on(Gl,this.cellMerge,this),this.parent.observer.on(Kl,this.HorizontalSplit,this),this.parent.observer.on(Wl,this.VerticalSplit,this),this.parent.observer.on($l,this.tableMove,this)},e.prototype.createTable=function(e){var t=Object(w["C"])("table",{className:"e-rte-table"}),i=Object(w["C"])("tbody");Object(w["T"])(e.item.width.width)||(t.style.width=this.calculateStyleValue(e.item.width.width)),Object(w["T"])(e.item.width.minWidth)||(t.style.minWidth=this.calculateStyleValue(e.item.width.minWidth)),Object(w["T"])(e.item.width.maxWidth)||(t.style.maxWidth=this.calculateStyleValue(e.item.width.maxWidth));for(var n=parseInt(e.item.width.width,10)>100?100/e.item.columns:parseInt(e.item.width.width,10)/e.item.columns,r=0;r<e.item.rows;r++){for(var s=Object(w["C"])("tr"),a=0;a<e.item.columns;a++){var o=Object(w["C"])("td");o.appendChild(Object(w["C"])("br")),o.style.width=n+"%",s.appendChild(o)}i.appendChild(s)}if(t.appendChild(i),e.item.selection.restore(),gd.Insert(this.parent.currentDocument,t,this.parent.editableElement),this.removeEmptyNode(),e.item.selection.setSelectionText(this.parent.currentDocument,t.querySelector("td"),t.querySelector("td"),0,0),null===t.nextElementSibling){var l=void 0;"DIV"===e.enterAction?(l=Object(w["C"])("div"),l.appendChild(Object(w["C"])("br"))):"BR"===e.enterAction?l=Object(w["C"])("br"):(l=Object(w["C"])("p"),l.appendChild(Object(w["C"])("br"))),this.insertAfter(l,t)}return t.querySelector("td").classList.add("e-cell-select"),e.callBack&&e.callBack({requestType:"Table",editorMode:"HTML",event:e.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:[t]}),t},e.prototype.calculateStyleValue=function(e){var t;return t="string"===typeof e&&(e.indexOf("px")||e.indexOf("%")||e.indexOf("auto"))?e:e+"px",t},e.prototype.removeEmptyNode=function(){for(var e=this.parent.editableElement.querySelectorAll("ul:empty, ol:empty"),t=0;t<e.length;t++)Object(w["F"])(e[t]);var i=this.parent.editableElement.querySelectorAll("li *:empty:not(img)");for(t=0;t<i.length;t++)Object(w["F"])(i[t]),i.length===t+1&&(i=this.parent.editableElement.querySelectorAll("li *:empty:not(img)"),t=-1);var n=this.parent.editableElement.querySelectorAll("li:empty");for(t=0;t<n.length;t++)Object(w["F"])(n[t])},e.prototype.insertAfter=function(e,t){t.parentNode.insertBefore(e,t.nextSibling)},e.prototype.getSelectedCellMinMaxIndex=function(e){for(var t=this.curTable.querySelectorAll(".e-cell-select"),i=0,n=e.length,r=0,s=e[0].length,a=0;i<t.length;i++){var o=this.getCorrespondingIndex(t[i],e),l=this.FindIndex(o[0],o[1],e);n=Math.min(o[0],n),r=Math.max(l[0],r),s=Math.min(o[1],s),a=Math.max(l[1],a)}return{startRow:n,endRow:r,startColumn:s,endColumn:a}},e.prototype.insertRow=function(e){var t="InsertRowBefore"!==e.item.subCommand,i=e.item.selection.range.startContainer;if("TH"!==i.nodeName&&"TD"!==i.nodeName&&(i=Object(w["A"])(i.parentElement,"td,th")),"th"!==i.nodeName.toLowerCase()||"InsertRowBefore"!==e.item.subCommand){if(this.curTable=Object(w["A"])(this.parent.nodeSelection.range.startContainer.parentElement,"table"),0===this.curTable.querySelectorAll(".e-cell-select").length){var n=this.curTable.rows[this.curTable.rows.length-1],r=n.cloneNode(!0);r.removeAttribute("rowspan"),this.insertAfter(r,n)}else{for(var s=this.getCorrespondingColumns(),a=this.getSelectedCellMinMaxIndex(s),o=t?a.endRow:a.startRow,l=Object(w["C"])("tr"),d=this.curTable.querySelectorAll("th.e-cell-select").length>0,c=0;c<s[o].length;c++)if(t&&o<s.length-1&&s[o][c]===s[o+1][c]||!t&&0<o&&s[o][c]===s[o-1][c])(0===c||0<c&&s[o][c]!==s[o][c-1])&&s[o][c].setAttribute("rowspan",(parseInt(s[o][c].getAttribute("rowspan"),10)+1).toString());else{var h=Object(w["C"])("td");h.appendChild(Object(w["C"])("br")),l.appendChild(h),h.setAttribute("style",s[d&&t&&s[o+1]?o+1:o][c].getAttribute("style"))}var p=void 0;p=d&&t?this.curTable.querySelector("tbody").childNodes[0]:this.curTable.rows[o],"InsertRowBefore"===e.item.subCommand?p.parentElement.insertBefore(l,p):d?p.parentElement.insertBefore(l,p):this.insertAfter(l,p)}e.item.selection.setSelectionText(this.parent.currentDocument,e.item.selection.range.startContainer,e.item.selection.range.startContainer,0,0),e.callBack&&e.callBack({requestType:e.item.subCommand,editorMode:"HTML",event:e.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})}},e.prototype.insertColumn=function(e){var t=e.item.selection.range.startContainer;"TH"!==t.nodeName&&"TD"!==t.nodeName&&(t=Object(w["A"])(t.parentElement,"td,th"));for(var i,n=Object(w["A"])(t,"tr"),r=Object(w["A"])(n,"table").rows,s=Array.prototype.slice.call(n.querySelectorAll(":scope > td, :scope > th")).indexOf(t),a=parseInt(e.item.width,10)/n.querySelectorAll(":scope > td, :scope > th").length,o=parseInt(e.item.width,10)/(n.querySelectorAll(":scope > td, :scope > th").length+1),l=Object(w["A"])(n,"table"),d=Object(w["A"])(n,"table").querySelectorAll("th,td"),c=0;c<d.length;c++)d[c].dataset.oldWidth=d[c].offsetWidth/l.offsetWidth*100+"%";for(c=0;c<r.length;c++){i=r[c].querySelectorAll(":scope > td, :scope > th")[s];var h=i.cloneNode(!0);h.innerHTML="",h.appendChild(Object(w["C"])("br")),h.removeAttribute("class"),h.removeAttribute("colspan"),h.removeAttribute("rowspan"),"InsertColumnLeft"===e.item.subCommand?i.parentElement.insertBefore(h,i):this.insertAfter(h,i),h.style.width=o.toFixed(4)+"%",delete h.dataset.oldWidth}for(c=0;c<d.length;c++)d[c].style.width=(Number(d[c].dataset.oldWidth.split("%")[0])*o/a).toFixed(4)+"%",delete d[c].dataset.oldWidth;e.item.selection.setSelectionText(this.parent.currentDocument,t,t,0,0),e.callBack&&e.callBack({requestType:e.item.subCommand,editorMode:"HTML",event:e.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},e.prototype.deleteColumn=function(e){var t=e.item.selection.range.startContainer;3===t.nodeType&&(t=Object(w["A"])(t.parentElement,"td,th"));var i=Object(w["A"])(t,"TH"===t.tagName?"thead":"tbody"),n=i&&Array.prototype.indexOf.call(i.childNodes,t.parentNode);this.curTable=Object(w["A"])(t,"table");var r=Object(w["A"])(t,"tr");if(1===r.querySelectorAll("th,td").length)e.item.selection.restore(),Object(w["F"])(Object(w["A"])(t.parentElement,"table"));else{for(var s=void 0,a=this.getCorrespondingColumns(),o=this.getSelectedCellMinMaxIndex(a),l=o.startColumn,d=o.endColumn,c=0;c<a.length;c++)for(var h=a[c],p=0;p<h.length;p++){var u=h[p],m=this.getCorrespondingIndex(u,a),g=parseInt(u.getAttribute("colspan"),10)||1;m[1]+(g-1)>=l&&m[1]<=d&&(g>1?u.setAttribute("colspan",(g-1).toString()):(Object(w["F"])(u),s=p,w["d"].isIE&&(e.item.selection.setSelectionText(this.parent.currentDocument,this.curTable.querySelector("td"),this.curTable.querySelector("td"),0,0),this.curTable.querySelector("td, th").classList.add("e-cell-select"))))}if(s>-1){var f=i.children[n],b=f&&f.children[s<=f.children.length-1?s:s-1];b&&(e.item.selection.setSelectionText(this.parent.currentDocument,b,b,0,0),b.classList.add("e-cell-select"))}}if(e.callBack){var v=this.parent.nodeSelection.getRange(this.parent.currentDocument).startContainer;if("TD"!==v.nodeName){var y=this.parent.nodeSelection.getRange(this.parent.currentDocument).startOffset,C=v.children[y];C&&this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,C,0)}e.callBack({requestType:e.item.subCommand,editorMode:"HTML",event:e.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})}},e.prototype.deleteRow=function(e){var t=e.item.selection.range.startContainer;3===t.nodeType&&(t=Object(w["A"])(t.parentElement,"td,th"));var i,n=Array.prototype.indexOf.call(t.parentNode.childNodes,t);this.curTable=Object(w["A"])(t,"table");var r,s,a=this.getCorrespondingColumns(),o=this.getSelectedCellMinMaxIndex(a);if(1===this.curTable.rows.length)e.item.selection.restore(),Object(w["F"])(Object(w["A"])(t.parentElement,"table"));else for(r=o.endRow;r>=o.startRow;r--){for(i=this.curTable.rows[r],s=0;s<a[r].length;s++){if((0===s||a[r][s]!==a[r][s-1])&&1<parseInt(a[r][s].getAttribute("rowspan"),10)){var l=parseInt(a[r][s].getAttribute("rowspan"),10)-1;1===l?a[r][s].removeAttribute("rowspan"):a[r][s].setAttribute("rowspan",l.toString())}if(r<a.length-1&&a[r][s]===a[r+1][s]&&(0===r||a[r][s]!==a[r-1][s])){var d=a[r][s],c=void 0;for(c=s;0<c&&a[r][c]===a[r][c-1];c--)0===c?this.curTable.rows[r+1].prepend(d):a[r+1][c-1].insertAdjacentElement("afterend",d)}}var h=i.rowIndex;this.curTable.deleteRow(h);var p=Object(w["T"])(this.curTable.rows[h])?this.curTable.querySelectorAll("tbody tr")[h-1]:this.curTable.querySelectorAll("tbody tr")[h],u=p&&p.querySelectorAll("td")[n];u?(e.item.selection.setSelectionText(this.parent.currentDocument,u,u,0,0),u.classList.add("e-cell-select")):(e.item.selection.setSelectionText(this.parent.currentDocument,this.curTable.querySelector("td"),this.curTable.querySelector("td"),0,0),this.curTable.querySelector("td, th").classList.add("e-cell-select"))}e.callBack&&e.callBack({requestType:e.item.subCommand,editorMode:"HTML",event:e.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},e.prototype.removeTable=function(e){var t=e.item.selection.range.startContainer;t=3===t.nodeType?t.parentNode:t;var i=Object(w["A"])(t.parentElement,"table");i&&(e.item.selection.restore(),Object(w["F"])(i)),e.callBack&&e.callBack({requestType:e.item.subCommand,editorMode:"HTML",event:e.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},e.prototype.tableHeader=function(e){var t=!1,i=e.item.selection.range.startContainer;i=3===i.nodeType?i.parentNode:i;var n=Object(w["A"])(i.parentElement,"table");if([].slice.call(n.childNodes).forEach(function(e){"THEAD"===e.nodeName&&(t=!0)}),n&&!t){for(var r=n.querySelector("tr").childElementCount,s=0,a=0;a<r;a++)s+=parseInt(n.querySelector("tr").children[a].getAttribute("colspan"),10)||1;for(var o=n.createTHead(),l=o.insertRow(0),d=0;d<s;d++){var c=Object(w["C"])("th");c.appendChild(Object(w["C"])("br")),l.appendChild(c)}}else n.deleteTHead();e.callBack&&e.callBack({requestType:e.item.subCommand,editorMode:"HTML",event:e.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},e.prototype.tableVerticalAlign=function(e){"AlignTop"===e.item.subCommand?e.item.tableCell.style.verticalAlign="top":"AlignMiddle"===e.item.subCommand?e.item.tableCell.style.verticalAlign="middle":e.item.tableCell.style.verticalAlign="bottom",e.callBack&&e.callBack({requestType:e.item.subCommand,editorMode:"HTML",event:e.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},e.prototype.cellMerge=function(e){Object(w["T"])(this.curTable)&&(this.curTable=Object(w["A"])(this.parent.nodeSelection.range.startContainer.parentElement,"table"));var t=this.curTable.querySelectorAll(".e-cell-select");if(!(t.length<2)){this.mergeCellContent();var i=this.getSelectedMinMaxIndexes(this.getCorrespondingColumns()),n=t[0],r=n.parentElement.querySelectorAll(".e-cell-select");i.startColumn<i.endColumn&&n.setAttribute("colspan",(i.endColumn-i.startColumn+1).toString()),i.startRow<i.endRow&&n.setAttribute("rowspan",(i.endRow-i.startRow+1).toString());for(var s=0,a=r.length-1;a>=0;a--)s+=parseFloat(r[a].style.width);n.style.width=s+"%";for(var o=1;o<=t.length-1;o++)Object(w["F"])(t[o]);for(o=0;o<this.curTable.rows.length;o++)""===this.curTable.rows[o].innerHTML&&Object(w["F"])(this.curTable.rows[o]);this.updateRowSpanStyle(i.startRow,i.endRow,this.getCorrespondingColumns()),this.updateColSpanStyle(i.startColumn,i.endColumn,this.getCorrespondingColumns()),e.item.selection.setSelectionText(this.parent.currentDocument,e.item.selection.range.startContainer,e.item.selection.range.startContainer,0,0),this.parent.nodeSelection.range&&this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,this.parent.nodeSelection.range.endContainer,0),e.callBack&&e.callBack({requestType:e.item.subCommand,editorMode:"HTML",event:e.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})}},e.prototype.updateColSpanStyle=function(e,t,i){var n,r,s,a,o=0,l=0,d=i;if(e<(t=Math.min(t,d[0].length-1))){for(r===e;r<=t;r++)if(!(e<r&&d[0][r]===d[0][r-1])&&1<(o=Math.min(parseInt(d[0][r].getAttribute("colspan"),10)||1,t-e+1))&&d[0][r]===d[0][r+1])for(l=o-1,n=1;n<d.length;n++){if(d[n][r]!==d[n-1][r])for(s=r;s<r+o;s++)if(1<(a=parseInt(d[n][s].getAttribute("colspan"),10)||1)&&d[n][s]===d[n][s+1])s+=l=Math.min(l,a-1);else if(!(l=Math.max(0,l-1)))break;if(!l)break}l&&this.updateCellAttribute(d,l,"colspan",0,d.length-1,e,t)}},e.prototype.updateRowSpanStyle=function(e,t,i){var n,r,s,a,o=0,l=0,d=i;if(e<(t=Math.min(t,d.length-1))){for(n=e;n<=t;n++)if(!(e<n&&d[n][0]===d[n-1][0])&&d[n][0]&&1<(o=Math.min(parseInt(d[n][0].getAttribute("rowspan"),10)||1,t-e+1))&&d[n][0]===d[n+1][0])for(l=o-1,r=1;r<d[0].length;r++)if(d[n][r]!==d[n][r-1]){for(s=n;s<n+o;s++)if(1<(a=parseInt(d[s][r].getAttribute("rowspan"),10)||1)&&d[s][r]===d[s+1][r])s+=l=Math.min(l,a-1);else if(!(l=Math.max(0,l-1)))break;if(!l)break}l&&this.updateCellAttribute(d,l,"rowspan",e,t,0,d[0].length-1)}},e.prototype.updateCellAttribute=function(e,t,i,n,r,s,a){var o,l,d;for(o=n;o<=r;o++)for(l=s;l<=a;l++)n<o&&e[o][l]===e[o-1][l]||s<l&&e[o][l]===e[o][l-1]||1<(d=parseInt(e[o][l].getAttribute(i),10)||1)&&(1<d-t?e[o][l].setAttribute(i,(d-t).toString()):e[o][l].removeAttribute(i))},e.prototype.mergeCellContent=function(){for(var e=this.curTable.querySelectorAll(".e-cell-select"),t="<br>"===e[0].innerHTML?"":e[0].innerHTML,i=1;i<e.length;i++)"<br>"!==e[i].innerHTML&&(t=t?t+"<br>"+e[i].innerHTML:t+e[i].innerHTML);e[0].innerHTML=t},e.prototype.getSelectedMinMaxIndexes=function(e){var t=this.curTable.querySelectorAll(".e-cell-select");if(0<t.length){for(var i=e.length,n=0,r=e[0].length,s=0,a=0;a<t.length;a++){var o=this.getCorrespondingIndex(t[a],e),l=this.FindIndex(o[0],o[1],e);i=Math.min(o[0],i),n=Math.max(l[0],n),r=Math.min(o[1],r),s=Math.max(l[1],s)}return{startRow:i,endRow:n,startColumn:r,endColumn:s}}return null},e.prototype.HorizontalSplit=function(e){var t=e.item.selection.range.startContainer;if(this.curTable=Object(w["A"])(t.parentElement,"table"),!(this.curTable.querySelectorAll(".e-cell-select").length>1)){this.activeCell=this.curTable.querySelector(".e-cell-select");var i=this.activeCell.cloneNode(!0);i.removeAttribute("class"),i.innerHTML="</br>";var n=this.getCorrespondingIndex(this.activeCell,this.getCorrespondingColumns()),r=this.getCorrespondingColumns(),s=this.activeCell.getAttribute("rowspan")?parseInt(this.activeCell.getAttribute("rowspan"),10):1;if(s>1){var a=Math.ceil(s/2);1<a?this.activeCell.setAttribute("rowspan",a.toString()):this.activeCell.removeAttribute("rowspan"),1<s-a?i.setAttribute("rowspan",(s-a).toString()):i.removeAttribute("rowspan");var o=void 0,l=void 0;for(o=n[0]+Math.ceil(s/2),l=0===n[1]?n[1]:n[1]-1;0<=l&&(r[o][l]===r[o][l-1]||0<o&&r[o][l]===r[o-1][l]);)l--;-1===l?this.curTable.rows[o].firstChild?this.curTable.rows[o].prepend(i):this.curTable.appendChild(i):r[o][l].insertAdjacentElement("afterend",i)}else{var d=Object(w["C"])("tr");d.appendChild(i);for(var c=r[n[0]],h=0;h<=c.length-1;h++)c[h]!==c[h-1]&&c[h]!==this.activeCell&&c[h].setAttribute("rowspan",((parseInt(c[h].getAttribute("rowspan"),10)?parseInt(c[h].getAttribute("rowspan"),10):1)+1).toString());this.activeCell.parentNode.insertAdjacentElement("afterend",d)}e.callBack&&e.callBack({requestType:e.item.subCommand,editorMode:"HTML",event:e.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})}},e.prototype.VerticalSplit=function(e){var t=e.item.selection.range.startContainer;if(this.curTable=Object(w["A"])(t.parentElement,"table"),!(this.curTable.querySelectorAll(".e-cell-select").length>1)){this.activeCell=this.curTable.querySelector(".e-cell-select");var i=this.curTable.rows,n=this.activeCell.cloneNode(!0);n.removeAttribute("class"),n.innerHTML="</br>";var r=parseFloat(this.activeCell.style.width)/2;if("TH"===this.activeCell.tagName&&isNaN(r)){for(var s=this.curTable.querySelector("tr").childElementCount,a=0;a<s;a++)parseInt(this.curTable.querySelector("tr").children[a].getAttribute("colspan"),10)||1;r=parseFloat((this.activeCell.offsetWidth/2/this.curTable.offsetWidth*100).toFixed(1))}var o=this.getCorrespondingIndex(this.activeCell,this.getCorrespondingColumns()),l=this.getCorrespondingColumns(),d=parseInt(this.activeCell.getAttribute("colspan"),10);if(d>1)1<Math.ceil(d/2)?this.activeCell.setAttribute("colspan",(d/2).toString()):this.activeCell.removeAttribute("colspan"),1<d-d/2?n.setAttribute("colspan",(d-d/2).toString()):n.removeAttribute("colspan");else for(a=0;a<=i.length-1;a++)if(0===a||l[a][o[1]]!==l[a-1][o[1]]){var c=l[a][o[1]];c!==this.activeCell&&c.setAttribute("colspan",((parseInt(c.getAttribute("colspan"),10)?parseInt(c.getAttribute("colspan"),10):1)+1).toString())}this.activeCell.style.width=r+"%",n.style.width=r+"%",this.activeCell.parentNode.insertBefore(n,this.activeCell.nextSibling),e.callBack&&e.callBack({requestType:e.item.subCommand,editorMode:"HTML",event:e.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})}},e.prototype.getCorrespondingColumns=function(){for(var e=[],t=this,i=0,n=t.curTable.rows,r=0;r<=n.length-1;r++)for(var s=n[r],a=0,o=0;o<=s.children.length-1;o++){for(var l=s.children[o],d=l,c=parseInt(d.getAttribute("colspan"),10)||1,h=parseInt(d.getAttribute("rowspan"),10)||1,p=r;p<r+h;p++)for(var u=a;u<a+c;u++)e[p]||(e[p]=[]),e[p][u]?a++:e[p][u]=l;a+=i}return e},e.prototype.FindIndex=function(e,t,i){var n,r;for(n=e+1,r=t+1;n<i.length;){if(i[n][t]!==i[e][t]){n--;break}n++}for(n===i.length&&n--;r<i[e].length;){if(i[e][r]!==i[e][t]){r--;break}r++}return r===i[e].length&&r--,[n,r]},e.prototype.getCorrespondingIndex=function(e,t){for(var i=0;i<t.length;i++)for(var n=0;n<t[i].length;n++)if(t[i][n]===e)return[i,n];return[]},e.prototype.highlightCells=function(e,t,i,n,r){var s,a,o,l,d=e,c=t,h=i,p=n,u=new Dd;for(s=d;s<=c;s++){for((1<(parseInt(r[s][h].getAttribute("rowspan"),10)||1)||1<(parseInt(r[s][h].getAttribute("colspan"),10)||1))&&(l=this.FindIndex((o=this.getCorrespondingIndex(r[s][h],r))[0],o[1],r))?(d=Math.min(o[0],d),c=Math.max(l[0],c),h=Math.min(o[1],h),p=Math.max(l[1],p)):(1<(parseInt(r[s][p].getAttribute("rowspan"),10)||1)||1<(parseInt(r[s][p].getAttribute("colspan"),10)||1))&&(l=this.FindIndex((o=this.getCorrespondingIndex(r[s][p],r))[0],o[1],r))&&(d=Math.min(o[0],d),c=Math.max(l[0],c),h=Math.min(o[1],h),p=Math.max(l[1],p)),a=h;a<=p;a++)(1<(parseInt(r[d][a].getAttribute("rowspan"),10)||1)||1<(parseInt(r[d][a].getAttribute("colspan"),10)||1))&&(l=this.FindIndex((o=this.getCorrespondingIndex(r[d][a],r))[0],o[1],r))?(d=Math.min(o[0],d),c=Math.max(l[0],c),h=Math.min(o[1],h),p=Math.max(l[1],p)):(1<(parseInt(r[c][a].getAttribute("rowspan"),10)||1)||1<(parseInt(r[c][a].getAttribute("colspan"),10)||1))&&(l=this.FindIndex((o=this.getCorrespondingIndex(r[c][a],r))[0],o[1],r))&&(d=Math.min(o[0],d),c=Math.max(l[0],c),h=Math.min(o[1],h),p=Math.max(l[1],p));u=d===e&&c===t&&h===i&&p===n?{startRow:e,endRow:t,startColumn:i,endColumn:n}:this.highlightCells(d,c,h,p,r)}return u},e.prototype.tableMove=function(e){this.activeCell=e.selectNode[0];var t=e.event.target,i=this.activeCell.tagName,n=t.tagName;if(this.curTable=Object(w["A"])(t,"table"),this.curTable.querySelectorAll(".e-cell-select").length>1&&this.parent.nodeSelection.Clear(this.parent.currentDocument),"TD"===t.tagName||"TH"===t.tagName||i===n){for(var r=Array.prototype.slice.call(this.activeCell.parentElement.parentElement.children).indexOf(this.activeCell.parentElement),s=Array.prototype.slice.call(this.activeCell.parentElement.children).indexOf(this.activeCell),a=Array.prototype.slice.call(t.parentElement.parentElement.children).indexOf(t.parentElement),o=Array.prototype.slice.call(t.parentElement.children).indexOf(t),l=this.curTable.querySelectorAll(".e-cell-select"),d=l.length-1;d>=0;d--)this.activeCell!==l[d]&&l[d].classList.remove("e-cell-select");if(r!==a||s!==o){for(var c=this.getCorrespondingColumns(),h=this.getCorrespondingIndex(this.activeCell,c),p=this.getCorrespondingIndex(t,c),u=this.highlightCells(Math.min(h[0],p[0]),Math.max(h[0],p[0]),Math.min(h[1],p[1]),Math.max(h[1],p[1]),c),m=u.startRow;m<=u.endRow;m++)for(var g=u.startColumn;g<=u.endColumn;g++)c[m][g].classList.add("e-cell-select");this.parent.nodeSelection.range&&(this.parent.nodeSelection.setSelectionText(this.parent.currentDocument,this.parent.nodeSelection.range.endContainer,this.parent.nodeSelection.range.endContainer,0,0),this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,this.parent.nodeSelection.range.endContainer,0))}}},e}(),Dd=function(){function e(){}return e}(),Ed=function(){function e(){}return e.prototype.getFormattedNode=function(e,t,i){var n=this.getFormatParent(e,t,i);return null!==n&&n!==i?n:null},e.prototype.getFormatParent=function(e,t,i){do{e=e.parentNode}while(e&&e!==i&&!this.isFormattedNode(e,t));return e},e.prototype.isFormattedNode=function(t,i){switch(i){case"bold":return e.isBold(t);case"italic":return e.isItalic(t);case"underline":return e.isUnderline(t);case"strikethrough":return e.isStrikethrough(t);case"superscript":return e.isSuperscript(t);case"subscript":return e.isSubscript(t);case"fontcolor":return this.isFontColor(t);case"fontname":return this.isFontName(t);case"fontsize":return this.isFontSize(t);case"backgroundcolor":return this.isBackgroundColor(t);default:return!1}},e.isBold=function(e){var t=["strong","b"];return-1!==t.indexOf(e.nodeName.toLowerCase())||!(-1===this.inlineTags.indexOf(e.nodeName.toLowerCase())||!e.style||"bold"!==e.style.fontWeight)},e.isItalic=function(e){var t=["em","i"];return-1!==t.indexOf(e.nodeName.toLowerCase())||!(-1===this.inlineTags.indexOf(e.nodeName.toLowerCase())||!e.style||"italic"!==e.style.fontStyle)},e.isUnderline=function(e){var t=["u"];return-1!==t.indexOf(e.nodeName.toLowerCase())||!(-1===this.inlineTags.indexOf(e.nodeName.toLowerCase())||!e.style||"underline"!==e.style.textDecoration)},e.isStrikethrough=function(e){var t=["del","strike"];return-1!==t.indexOf(e.nodeName.toLowerCase())||!(-1===this.inlineTags.indexOf(e.nodeName.toLowerCase())||!e.style||"line-through"!==e.style.textDecoration)},e.isSuperscript=function(e){var t=["sup"];return-1!==t.indexOf(e.nodeName.toLowerCase())},e.isSubscript=function(e){var t=["sub"];return-1!==t.indexOf(e.nodeName.toLowerCase())},e.prototype.isFontColor=function(t){var i=t.style&&t.style.color;return-1!==e.inlineTags.indexOf(t.nodeName.toLowerCase())&&null!==i&&""!==i&&void 0!==i},e.prototype.isBackgroundColor=function(t){var i=t.style&&t.style.backgroundColor;return-1!==e.inlineTags.indexOf(t.nodeName.toLowerCase())&&null!==i&&""!==i&&void 0!==i},e.prototype.isFontSize=function(t){var i=t.style&&t.style.fontSize;return-1!==e.inlineTags.indexOf(t.nodeName.toLowerCase())&&null!==i&&""!==i&&void 0!==i},e.prototype.isFontName=function(t){var i=t.style&&t.style.fontFamily;return-1!==e.inlineTags.indexOf(t.nodeName.toLowerCase())&&null!==i&&""!==i&&void 0!==i},e.inlineTags=["a","abbr","acronym","b","bdo","big","cite","code","dfn","em","i","kbd","label","q","samp","small","span","strong","sub","sup","tt","u","var","del"],e}(),Id=function(){function e(){}return e.applyFormat=function(e,t,i,n,r,s){this.enterAction=n;var a=["bold","italic","underline","strikethrough","superscript","subscript","uppercase","lowercase","fontcolor","fontname","fontsize","backgroundcolor"];if(a.indexOf(t)>-1){"backgroundcolor"===t&&""===r&&(r="transparent");var o=new ad,l=new cd(i,e),d=new ud,c=new Ed,h=o.getRange(e),p=o.save(h,e),u=h.collapsed?o.getSelectionNodeCollection(h):o.getSelectionNodeCollectionBr(h),m=!1,g=!1,f=!1,b=!1,v=["fontcolor","fontname","fontsize","backgroundcolor"].indexOf(t)>-1;if(h.collapsed){var y=c.getFormattedNode(h.startContainer,t,i),C=Object(w["T"])(y)?null:null===y.getAttribute("style")?y.nodeName:y.nodeName+"[style='"+y.getAttribute("style")+"']";if(u.length>0)m=!0,h=d.GetCursorRange(e,h,u[0]);else if(3===h.startContainer.nodeType&&(h.startContainer.parentElement.childElementCount>0&&h.startOffset>0&&"br"!==h.startContainer.parentElement.firstElementChild.tagName.toLowerCase()||!Object(w["T"])(y)&&y===h.startContainer.parentElement.closest(C)&&0!=h.startContainer.parentElement.closest(C).textContent.replace(new RegExp(String.fromCharCode(8203),"g"),"").trim().length))m=!0,h=d.GetCursorRange(e,h,h.startContainer),u.push(h.startContainer);else{var O=this.insertCursorNode(e,o,h,c,d,t,r,i);o.endContainer=o.startContainer=o.getNodeArray(O,!0);var T="BR"===O.nodeName&&O.parentNode.childNodes;Object(w["T"])(T)||1!==T.length||"BR"!==T[0].nodeName||0!==u.length?o.endOffset=o.startOffset=1:(o.setSelectionText(e,h.startContainer,h.endContainer,0,0),b=!0),"BR"===O.nodeName&&0===O.parentNode.textContent.length&&(b=!0)}}f=h.collapsed;for(var k=!1,S=0;S<u.length;S++){var j=c.getFormattedNode(u[S],t,i);null===j&&("subscript"===t?(j=c.getFormattedNode(u[S],"superscript",i),k=null!==j):"superscript"===t&&(j=c.getFormattedNode(u[S],"subscript",i),k=null!==j)),0===S&&null===j&&(g=!0),u[S]=null===j||g&&!v?this.insertFormat(e,u,S,j,f,g,v,h,d,t,r):this.removeFormat(u,S,j,f,g,v,h,d,t,r,o,i,l),o=this.applySelection(u,o,d,S,m)}Dl()&&El(i,s),b||p.restore(),k&&this.applyFormat(e,t,i,n)}},e.insertCursorNode=function(e,t,i,n,r,s,a,o){var l=t.getNodeCollection(i),d=new cd(o,e),c=l.length>0?l.length>1&&i.startContainer===i.endContainer?this.getCursorFormat(n,l,s,o):n.getFormattedNode(l[0],s,o):null,h=null;if(c){if(h=l[0],8203===c.firstChild.textContent.charCodeAt(0)&&3===c.firstChild.nodeType){var p=new RegExp(String.fromCharCode(8203),"g"),u=void 0;c.firstChild===h?(h.textContent=c.parentElement&&(d.isBlockNode(c.parentElement)&&c.parentElement.textContent.length<=1?c.parentElement.childElementCount>1:0===c.childElementCount)&&(c.parentElement.textContent.length>1||c.parentElement.firstChild&&1===c.parentElement.firstChild.nodeType)?h.textContent:h.textContent.replace(p,""),u=h,!0):(c.firstChild.textContent=c.firstChild.textContent.replace(p,""),u=c.firstChild);var m=void 0;if(0===u.textContent.length)if(Object(w["T"])(u.previousSibling)){if(!Object(w["T"])(u.parentElement)&&0===u.parentElement.textContent.length){var g=document.createElement("BR");u.parentElement.appendChild(g),Object(w["F"])(u),h=g,t.setCursorPoint(e,h.parentElement,0)}}else h=u.previousSibling,m=u.textContent.length-1,t.setCursorPoint(e,u,m)}["fontcolor","fontname","fontsize","backgroundcolor"].indexOf(s)>-1?("fontcolor"===s?c.style.color=a:"fontname"===s?c.style.fontFamily=a:"fontsize"===s?c.style.fontSize=a:c.style.backgroundColor=a,h=c):pd.unwrap(c)}else l.length>1&&i.startOffset>0&&l[0].firstElementChild&&"br"===l[0].firstElementChild.tagName.toLowerCase()&&(l[0].innerHTML=""),1!==l.length||0!==i.startOffset||"BR"!==l[0].nodeName&&"BR"!==l[0].nextSibling.nodeName||Object(w["F"])("#text"===l[0].nodeName?l[0].nextSibling:l[0]),h=this.getInsertNode(e,i,s,a).firstChild;return h},e.getCursorFormat=function(e,t,i,n){for(var r,s=0;s<t.length;s++)r=t[s].lastElementChild?t[s].lastElementChild:t[s];return e.getFormattedNode(r,i,n)},e.removeFormat=function(e,t,i,n,r,s,a,o,l,d,c,h,p){var u,m,g=null,f="#text"===a.startContainer.nodeName?a.startContainer.textContent.substring(a.startOffset,a.startContainer.textContent.length):a.startContainer.textContent;if(a.startContainer!==a.endContainer||0!==a.startOffset||a.endOffset!==a.startContainer.length){var b=[],v=e[t];do{b.push(c.getIndex(v)),v=v.parentNode}while(v&&v!==i);if("BR"!==e[t].nodeName&&(v=g=n&&i.textContent.length-1===a.startOffset?o.SplitNode(a,i,!0):o.GetSpliceNode(a,i)),n){for(var y=g;null!==y.firstChild&&3!==y.firstChild.nodeType;null)y=y.firstChild;y.innerHTML="&#8203;",e[t]=y.firstChild}else{while(v&&v.childNodes.length>0&&b.length-1>=0&&v.childNodes.length>b[b.length-1])v=v.childNodes[b[b.length-1]],b.pop();if("BR"!==e[t].nodeName)if(3!==v.nodeType||n&&""===v.nodeValue){var C=document.createElement("div");C.innerHTML="&#8203;",3!==v.nodeType?(v.insertBefore(C.firstChild,v.firstChild),e[t]=v.firstChild):(v.parentNode.insertBefore(C.firstChild,v),e[t]=v.previousSibling,v.parentNode.removeChild(v))}else e[t]=v}}if("backgroundcolor"===l&&(u=i.style.fontSize),"fontsize"===l){var O=Object(w["A"])(e[t].parentElement,"span[style*=background-color]");Object(w["T"])(O)||(m=O.style.backgroundColor)}var T=i.getAttribute("style"),k=i.tagName,S=pd.unwrap(i);if(S[0]&&!s)for(var j=S[t]?S[t]:S[0],R=j;j&&j.parentElement&&j.parentElement!==h;j=j){var D=void 0;if(D="SPAN"===i.nodeName?j.parentElement.tagName.toLocaleLowerCase()===i.tagName.toLocaleLowerCase()&&j.parentElement.getAttribute("style")===T:j.parentElement.tagName.toLocaleLowerCase()===i.tagName.toLocaleLowerCase(),j.parentElement&&D&&(j.parentElement.childElementCount>1||a.startOffset>1)){if(R.parentElement&&R.parentElement.tagName.toLocaleLowerCase()===i.tagName.toLocaleLowerCase()&&a.startOffset===a.endOffset&&1!==R.nodeType&&!Object(w["T"])(R.textContent)&&R.parentElement.childElementCount>1&&(a.setStart(R,0),a.setEnd(R,R.textContent.length),o.SplitNode(a,R.parentElement,!1)),"span"===j.parentElement.tagName.toLocaleLowerCase()&&"underline"===i.style.textDecoration&&"underline"!==j.parentElement.style.textDecoration){j=j.parentElement;continue}pd.unwrap(j.parentElement),j=Object(w["T"])(j.parentElement)||p.isBlockNode(j.parentElement)?j.parentElement:R}else j=j.parentElement}if(S.length>0&&s){for(var E=0;E<S.length;E++)(3!==S[E].nodeType||S[E].textContent&&S[E].textContent.trim().length>0)&&(S[E]=pd.Wrap(S[E],this.GetFormatNode(l,d,k,T)),S[E].textContent===f&&(0===E?a.setStartBefore(S[E]):E===S.length-1&&a.setEndAfter(S[E])));var I=e[t].parentElement;if(Object(w["T"])(u)||""===u||(I.style.fontSize=u),Object(w["T"])(m)||""===m||(I.style.backgroundColor=m),"backgroundcolor"===l&&!Object(w["T"])(u)&&""!==u&&I.parentElement.innerHTML===I.outerHTML){var x=I.parentElement;x.parentElement.insertBefore(I,x),Object(w["F"])(x)}if("fontsize"===l||"fontcolor"===l){var M=e[t].parentElement,P=e[t].parentElement;while(!Object(w["T"])(P)&&"li"!==P.tagName.toLowerCase())P=P.parentElement,M=P;Object(w["T"])(M)||"li"!==M.tagName.toLowerCase()||M.textContent.trim()!==e[t].textContent.trim()||("fontsize"===l?M.style.fontSize=d:(M.style.color=d,M.style.textDecoration="inherit"))}}return e[t]},e.insertFormat=function(e,t,i,n,r,s,a,o,l,d,c){if(r)if("uppercase"!==d&&"lowercase"!==d){h=this.getInsertNode(e,o,d,c);t[i]=h.firstChild,l.position=1}else l.position=o.startOffset;else if(null===n&&s||a){if("BR"!==t[i].nodeName&&(t[i]=l.GetSpliceNode(o,t[i]),t[i].textContent=l.TrimLineBreak(t[i].textContent)),"uppercase"===d||"lowercase"===d)t[i].textContent="uppercase"===d?t[i].textContent.toLocaleUpperCase():t[i].textContent.toLocaleLowerCase();else if(!0!==a||""!==c){var h=this.GetFormatNode(d,c);if("fontsize"===d||"fontcolor"===d){var p=t[i].parentElement,u=t[i].parentElement;while(!Object(w["T"])(u)&&"li"!==u.tagName.toLowerCase())u=u.parentElement,p=u;if(Object(w["T"])(p)||"li"!==p.tagName.toLowerCase()||p.textContent.trim()!==t[i].textContent.trim()||("fontsize"===d?p.style.fontSize=c:(p.style.color=c,p.style.textDecoration="inherit")),t[i]=this.applyStyles(t,i,h),"fontsize"===d){var m=Object(w["A"])(t[i].parentElement,"span[style*=background-color]");Object(w["T"])(m)||(t[i].parentElement.style.backgroundColor=m.style.backgroundColor)}}else t[i]=this.applyStyles(t,i,h)}}else t[i]=l.GetSpliceNode(o,t[i]);return t[i]},e.applyStyles=function(e,t,i){return"BR"===e[t].nodeName&&"BR"===this.enterAction||(e[t]=t===e.length-1||"BR"===e[t].nodeName?pd.Wrap(e[t],i):pd.WrapBefore(e[t],i,!0),e[t]=this.getChildNode(e[t],i)),e[t]},e.getInsertNode=function(e,t,i,n){var r=this.GetFormatNode(i,n);if(r.innerHTML="&#8203;",w["d"].isIE){var s=e.createDocumentFragment();s.appendChild(r),t.insertNode(s)}else t.insertNode(r);return r},e.getChildNode=function(e,t){return void 0!==e&&null!==e||(t.innerHTML="&#8203;",e=t.firstChild),e},e.applySelection=function(e,t,i,n,r){return 1!==e.length||r?1===e.length&&r?(t.startContainer=t.getNodeArray(e[n],!0),t.endContainer=t.startContainer,t.startOffset=i.position,t.endOffset=i.position):0===n?(t.startContainer=t.getNodeArray(e[n],!0),t.startOffset=0):n===e.length-1&&(t.endContainer=t.getNodeArray(e[n],!1),t.endOffset=e[n].textContent.length):(t.startContainer=t.getNodeArray(e[n],!0),t.endContainer=t.startContainer,t.startOffset=0,t.endOffset=e[n].textContent.length),t},e.GetFormatNode=function(e,t,i,n){var r;switch(e){case"bold":return document.createElement("strong");case"italic":return document.createElement("em");case"underline":return r=document.createElement("span"),this.updateStyles(r,i,n),r.style.textDecoration="underline",r;case"strikethrough":return r=document.createElement("span"),this.updateStyles(r,i,n),r.style.textDecoration="line-through",r;case"superscript":return document.createElement("sup");case"subscript":return document.createElement("sub");case"fontcolor":return r=document.createElement("span"),this.updateStyles(r,i,n),r.style.color=t,r.style.textDecoration="inherit",r;case"fontname":return r=document.createElement("span"),this.updateStyles(r,i,n),r.style.fontFamily=t,r;case"fontsize":return r=document.createElement("span"),this.updateStyles(r,i,n),r.style.fontSize=t,r;default:return r=document.createElement("span"),this.updateStyles(r,i,n),r.style.backgroundColor=t,r}},e.updateStyles=function(e,t,i){null!==i&&"SPAN"===t&&e.setAttribute("style",i)},e.enterAction="P",e}(),xd=function(){function e(e){this.parent=e,this.addEventListener()}return e.prototype.addEventListener=function(){this.parent.observer.on(td,this.applySelection,this),this.parent.observer.on(qr,this.keyDownHandler,this)},e.prototype.keyDownHandler=function(e){var t=["bold","italic","underline","strikethrough","superscript","subscript","uppercase","lowercase"];e.event.ctrlKey&&t.indexOf(e.event.action)>-1&&(e.event.preventDefault(),Id.applyFormat(this.parent.currentDocument,e.event.action,this.parent.editableElement,e.enterAction),this.callBack(e,e.event.action))},e.prototype.applySelection=function(e){Id.applyFormat(this.parent.currentDocument,e.subCommand.toLocaleLowerCase(),this.parent.editableElement,e.enterAction,e.value,e.selector),this.callBack(e,e.subCommand)},e.prototype.callBack=function(e,t){e.callBack&&e.callBack({requestType:t,event:e.event,editorMode:"HTML",range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},e}(),Md=function(){function e(e){this.parent=e,this.addEventListener()}return e.prototype.addEventListener=function(){this.parent.observer.on(id,this.applyHtml,this)},e.prototype.applyHtml=function(e){if(gd.Insert(this.parent.currentDocument,e.value,this.parent.editableElement,!0),"pasteCleanup"===e.subCommand){var t=this.parent.editableElement.querySelectorAll(".pasteContent_RTE"),i=[].slice.call(t),n=this.parent.editableElement.querySelectorAll(".pasteContent_Img"),r=[].slice.call(n);e.callBack({requestType:e.subCommand,editorMode:"HTML",elements:i,imgElem:r})}else e.callBack&&e.callBack({requestType:e.subCommand,editorMode:"HTML",event:e.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},e}(),Pd=function(){function e(){}return e.clear=function(e,t,i,n){this.domNode=new cd(t,e),this.defaultTag="P"===i?this.defaultTag:"div";var r=new ad,s=new ud,a=r.getRange(e),o=a.collapsed,l=r.getInsertNodeCollection(a),d=r.save(a,e);if(!o){var c=void 0;if(c="BR"===l[0].nodeName&&Object(w["A"])(l[0],"table")?s.GetSpliceNode(a,Object(w["A"])(l[0],"table")):s.GetSpliceNode(a,l[l.length>1&&"IMG"===l[0].nodeName?1:0]),1===l.length)r.setSelectionContents(e,c),a=r.getRange(e);else{var h=1,p=l[l.length-h];while(l.length<=h&&"BR"===l[l.length-h].nodeName)h++,p=l[l.length-h];var u=s.GetSpliceNode(a,p);r.setSelectionText(e,c,u,0,3===u.nodeType?u.textContent.length:u.childNodes.length),a=r.getRange(e)}var m=r.getNodeCollection(a),g=m.slice();this.clearInlines(r.getSelectionNodes(g),g,r.getRange(e),s,t),this.reSelection(e,d,m),a=r.getRange(e),m=r.getNodeCollection(a);var f=m.slice();this.clearBlocks(e,f,t,s,r),Dl()&&El(t,n),this.reSelection(e,d,m)}},e.reSelection=function(e,t,i){var n=t.getInsertNodes(i);t.startContainer=t.getNodeArray(n[0],!0,e),t.startOffset=0,t.endContainer=t.getNodeArray(n[n.length-1],!1,e);var r=n[n.length-1];t.endOffset=3===r.nodeType?r.textContent.length:r.childNodes.length,t.restore()},e.clearBlocks=function(e,t,i,n,r){for(var s=[],a=0;a<t.length;a++)this.BLOCK_TAGS.indexOf(t[a].nodeName.toLocaleLowerCase())>-1&&-1===s.indexOf(t[a])?s.push(t[a]):this.BLOCK_TAGS.indexOf(t[a].parentNode.nodeName.toLocaleLowerCase())>-1&&-1===s.indexOf(t[a].parentNode)&&i!==t[a].parentNode&&s.push(t[a].parentNode);s=this.spliceParent(s,t)[0],s=this.removeParent(s),this.unWrap(e,s,n,r)},e.spliceParent=function(e,t){for(var i=0;i<e.length;i++)for(var n=e[i].childNodes.length,r=0;r<n;r++)if(t.indexOf(e[i].childNodes[r])>0&&e[i].childNodes[r].childNodes.length>0&&(t=this.spliceParent([e[i].childNodes[r]],t)[1]),t.indexOf(e[i].childNodes[r])<=-1&&""!==e[i].childNodes[r].textContent.trim()){for(var s=0;s<n;s++)t.indexOf(e[i].childNodes[s])>-1&&t.splice(t.indexOf(e[i].childNodes[s]),1);r=e[i].childNodes.length;var a=e.indexOf(e[i].parentNode),o=t.indexOf(e[i].parentNode);a>-1&&e.splice(a,1),o>-1&&t.splice(o,1);var l=t.indexOf(e[i]);l>-1&&t.splice(l,1),e.splice(i,1),i--}return[e,t]},e.removeChild=function(e,t){var i=t.childNodes.length;if(i>0)for(var n=0;n<i;n++)e.indexOf(t.childNodes[n])>-1&&(e=this.removeChild(e,t.childNodes[n]),e.splice(e.indexOf(t.childNodes[n]),1));return e},e.removeParent=function(e){for(var t=0;t<e.length;t++)e.indexOf(e[t].parentNode)>-1&&(e=this.removeChild(e,e[t]),e.splice(t,1),t--);return e},e.unWrap=function(e,t,i,n){for(var r=0;r<t.length;r++)if(this.NONVALID_TAGS.indexOf(t[r].nodeName.toLowerCase())>-1&&t[r].parentNode&&this.NONVALID_PARENT_TAGS.indexOf(t[r].parentNode.nodeName.toLowerCase())>-1&&(n.setSelectionText(e,t[r],t[r],0,t[r].childNodes.length),pd.unwrap(i.GetSpliceNode(n.getRange(e),t[r].parentNode))),"p"!==t[r].nodeName.toLocaleLowerCase()){!(this.NONVALID_PARENT_TAGS.indexOf(t[r].nodeName.toLowerCase())<0&&"p"!==t[r].parentNode.nodeName.toLocaleLowerCase())||("blockquote"===t[r].nodeName.toLocaleLowerCase()||"li"===t[r].nodeName.toLocaleLowerCase())&&this.IGNORE_PARENT_TAGS.indexOf(t[r].childNodes[0].nodeName.toLocaleLowerCase())>-1||1===t[r].childNodes.length&&"p"===t[r].childNodes[0].nodeName.toLocaleLowerCase()||pd.Wrap(t[r],e.createElement(this.defaultTag));var s=pd.unwrap(t[r]);1===s.length&&"p"===s[0].parentNode.nodeName.toLocaleLowerCase()&&(pd.Wrap(t[r],e.createElement(this.defaultTag)),pd.unwrap(t[r]));for(var a=0;a<s.length;a++)if(this.NONVALID_TAGS.indexOf(s[a].nodeName.toLowerCase())>-1)this.unWrap(e,[s[a]],i,n);else if(this.BLOCK_TAGS.indexOf(s[a].nodeName.toLocaleLowerCase())>-1&&"p"!==s[a].nodeName.toLocaleLowerCase()){var o=this.removeParent([s[a]]);this.unWrap(e,o,i,n)}else this.BLOCK_TAGS.indexOf(s[a].nodeName.toLocaleLowerCase())>-1&&s[a].parentNode.nodeName.toLocaleLowerCase()===s[a].nodeName.toLocaleLowerCase()?pd.unwrap(s[a]):this.BLOCK_TAGS.indexOf(s[a].nodeName.toLocaleLowerCase())>-1&&"p"===s[a].nodeName.toLocaleLowerCase()&&(pd.Wrap(s[a],e.createElement(this.defaultTag)),pd.unwrap(s[a]))}else pd.Wrap(t[r],e.createElement(this.defaultTag)),pd.unwrap(t[r])},e.clearInlines=function(e,t,i,n,r){for(var s=0;s<e.length;s++){var a=e[s],o=void 0;while(!this.domNode.isBlockNode(a)&&a.parentElement&&!a.parentElement.classList.contains("e-img-inner"))o=a,a=a.parentElement;o&&Ed.inlineTags.indexOf(o.nodeName.toLocaleLowerCase())>-1&&(n.GetSpliceNode(i,o),this.removeInlineParent(o))}},e.removeInlineParent=function(e){for(var t=pd.unwrap(e),i=0;i<t.length;i++)1===t[i].parentNode.childNodes.length&&!t[i].parentNode.classList.contains("e-img-inner")&&Ed.inlineTags.indexOf(t[i].parentNode.nodeName.toLocaleLowerCase())>-1?this.removeInlineParent(t[i].parentNode):Ed.inlineTags.indexOf(t[i].nodeName.toLocaleLowerCase())>-1&&this.removeInlineParent(t[i])},e.BLOCK_TAGS=["address","article","aside","blockquote","details","dd","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","li","main","nav","noscript","ol","p","pre","section","ul"],e.NONVALID_PARENT_TAGS=["thead","tbody","ul","ol","table","tfoot","tr"],e.IGNORE_PARENT_TAGS=["ul","ol","table"],e.NONVALID_TAGS=["thead","tbody","figcaption","td","tr","th","tfoot","figcaption","li"],e.defaultTag="p",e}(),Ld=function(){function e(e){this.parent=e,this.addEventListener()}return e.prototype.addEventListener=function(){this.parent.observer.on(rd,this.applyClear,this),this.parent.observer.on(qr,this.onKeyDown,this)},e.prototype.onKeyDown=function(e){switch(e.event.action){case"clear-format":this.applyClear({subCommand:"ClearFormat",callBack:e.callBack,enterAction:e.enterAction}),e.event.preventDefault();break}},e.prototype.applyClear=function(e){"ClearFormat"===e.subCommand&&(Pd.clear(this.parent.currentDocument,this.parent.editableElement,e.enterAction,e.selector),e.callBack&&e.callBack({requestType:e.subCommand,event:e.event,editorMode:"HTML",range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)}))},e}(),Nd=function(){function e(e,t){this.undoRedoStack=[],this.parent=e,this.undoRedoSteps=Object(w["T"])(t)?30:t.undoRedoSteps,this.undoRedoTimer=Object(w["T"])(t)?300:t.undoRedoTimer,this.addEventListener()}return e.prototype.addEventListener=function(){var e=Object(w["D"])(this.keyUp,this.undoRedoTimer);this.parent.observer.on(_r,e,this),this.parent.observer.on(qr,this.keyDown,this),this.parent.observer.on(Hr,this.onAction,this),this.parent.observer.on(Gr,this.onPropertyChanged,this)},e.prototype.onPropertyChanged=function(e){for(var t=0,i=Object.keys(e.newProp);t<i.length;t++){var n=i[t];switch(n){case"undoRedoSteps":this.undoRedoSteps=e.newProp.undoRedoSteps;break;case"undoRedoTimer":this.undoRedoTimer=e.newProp.undoRedoTimer;break}}},e.prototype.removeEventListener=function(){this.parent.observer.off(_r,this.keyUp),this.parent.observer.off(qr,this.keyDown),this.parent.observer.off(Hr,this.onAction)},e.prototype.onAction=function(e){"Undo"===e.subCommand?this.undo(e):this.redo(e)},e.prototype.destroy=function(){this.removeEventListener()},e.prototype.keyDown=function(e){var t=e.event,i=this;switch(t.action){case"undo":t.preventDefault(),i.undo(e);break;case"redo":t.preventDefault(),i.redo(e);break}},e.prototype.keyUp=function(e){17===e.event.keyCode||e.event.ctrlKey||this.saveData(e)},e.prototype.saveData=function(e){for(var t=(new ad).getRange(this.parent.currentDocument),i=this.parent.editableElement===t.startContainer.parentElement?t.startContainer.parentElement:t.startContainer,n=i.childNodes.length-1;n>=0;n--)!Object(w["T"])(i.childNodes[n])&&"#text"===i.childNodes[n].nodeName&&0===i.childNodes[n].textContent.length&&"IMG"!==i.childNodes[n].nodeName&&"BR"!==i.childNodes[n].nodeName&&i.childNodes[n].nodeName&&Object(w["F"])(i.childNodes[n]);t=(new ad).getRange(this.parent.currentDocument);var r=(new ad).save(t,this.parent.currentDocument),s=this.parent.editableElement.innerHTML,a={text:s,range:r};this.undoRedoStack.length>=this.steps&&(this.undoRedoStack=this.undoRedoStack.slice(0,this.steps+1)),this.undoRedoStack.length>1&&this.undoRedoStack[this.undoRedoStack.length-1].range.range.collapsed===t.collapsed&&this.undoRedoStack[this.undoRedoStack.length-1].range.startOffset===r.range.startOffset&&this.undoRedoStack[this.undoRedoStack.length-1].range.endOffset===r.range.endOffset&&this.undoRedoStack[this.undoRedoStack.length-1].range.range.startContainer===r.range.startContainer&&this.undoRedoStack[this.undoRedoStack.length-1].text.trim()===a.text.trim()||(this.undoRedoStack.push(a),this.steps=this.undoRedoStack.length-1,this.steps>this.undoRedoSteps&&(this.undoRedoStack.shift(),this.steps--),e&&e.callBack&&e.callBack())},e.prototype.undo=function(e){if(this.steps>0){var t=this.undoRedoStack[this.steps-1].range,i=this.undoRedoStack[this.steps-1].text;this.parent.editableElement.innerHTML=i,this.parent.editableElement.focus(),Dl()&&El(this.parent.editableElement,e.selector),t.restore(),this.steps--,e.callBack&&e.callBack({requestType:"Undo",editorMode:"HTML",range:t,elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument),event:e.event})}},e.prototype.redo=function(e){if(null!=this.undoRedoStack[this.steps+1]){var t=this.undoRedoStack[this.steps+1].range;this.parent.editableElement.innerHTML=this.undoRedoStack[this.steps+1].text,this.parent.editableElement.focus(),Dl()&&El(this.parent.editableElement,e.selector),t.restore(),this.steps++,e.callBack&&e.callBack({requestType:"Redo",editorMode:"HTML",range:t,elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument),event:e.event})}},e.prototype.getUndoStatus=function(){var e={undo:!1,redo:!1};return this.steps>0&&(e.undo=!0),null!=this.undoRedoStack[this.steps+1]&&(e.redo=!0),e},e}(),Ad=function(){function e(e){this.olData=["decimal","lower-alpha","lower-roman","upper-alpha","upper-roman","lower-greek"],this.ulData=["disc","square","circle","disc","square","circle"],this.ignorableNodes=["A","APPLET","B","BLOCKQUOTE","BR","BUTTON","CENTER","CODE","COL","COLGROUP","DD","DEL","DFN","DIR","DIV","DL","DT","EM","FIELDSET","FONT","FORM","FRAME","FRAMESET","H1","H2","H3","H4","H5","H6","HR","I","IMG","IFRAME","INPUT","INS","LABEL","LI","OL","OPTION","P","PARAM","PRE","Q","S","SELECT","SPAN","STRIKE","STRONG","SUB","SUP","TABLE","TBODY","TD","TEXTAREA","TFOOT","TH","THEAD","TITLE","TR","TT","U","UL"],this.blockNode=["div","p","h1","h2","h3","h4","h5","h6","address","blockquote","button","center","dd","dir","dl","dt","fieldset","frameset","hr","iframe","isindex","li","map","menu","noframes","noscript","object","ol","pre","table","tbody","td","tfoot","th","thead","tr","ul","header","article","nav","footer","section","aside","main","figure","figcaption"],this.borderStyle=["border-top","border-right","border-bottom","border-left"],this.removableElements=["o:p","style"],this.listContents=[],this.parent=e,this.addEventListener()}return e.prototype.addEventListener=function(){this.parent.observer.on(Kr,this.wordCleanup,this)},e.prototype.wordCleanup=function(e){var t=Object(w["T"])(e.allowedStylePropertiesArray)?[]:e.allowedStylePropertiesArray,i=[],n=e.args.clipboardData.getData("text/HTML"),r=e.args.clipboardData.getData("text/rtf"),s=Object(w["C"])("p");s.setAttribute("id","MSWord-Content"),s.innerHTML=n;var a=/class='?Mso|style='[^ ]*\bmso-/i,o=/class="?Mso|style="[^ ]*\bmso-/i,l=/(class="?Mso|class='?Mso|class="?Xl|class='?Xl|class=Xl|style="[^"]*\bmso-|style='[^']*\bmso-|w:WordDocument)/gi,d=/style='mso-width-source:/i;a.test(n)||o.test(n)||l.test(n)||d.test(n)?(this.imageConversion(s,r),n=n.replace(/<img[^>]+>/i,""),this.addListClass(s),i=this.cleanUp(s,i),Object(w["T"])(i[0])||"UL"===i[0].parentElement.tagName||"OL"===i[0].parentElement.tagName||this.listConverter(i),this.styleCorrection(s,t),this.removingComments(s),this.removeUnwantedElements(s),this.removeEmptyElements(s),this.breakLineAddition(s),this.removeClassName(s),d.test(n)&&this.addTableBorderClass(s),e.callBack(s.innerHTML)):e.callBack(s.innerHTML)},e.prototype.addListClass=function(e){for(var t=e.querySelectorAll("*"),i=0;i<t.length;i++)!Object(w["T"])(t[i].getAttribute("style"))&&t[i].getAttribute("style").replace(/ /g,"").replace("\n","").indexOf("mso-list:l")>=0&&-1===t[i].className.toLowerCase().indexOf("msolistparagraph")&&"H"!==t[i].tagName.charAt(0)&&t[i].classList.add("msolistparagraph")},e.prototype.addTableBorderClass=function(e){for(var t=e.querySelectorAll("table"),i=!1,n=0;n<t.length;n++){for(var r=0;r<this.borderStyle.length;r++)if(t[n].innerHTML.indexOf(this.borderStyle[r])>=0){i=!0;break}i&&(t[n].classList.add("e-rte-table-border"),i=!1)}},e.prototype.imageConversion=function(e,t){this.checkVShape(e);for(var i=e.querySelectorAll("img"),n=0;n<i.length;n++)!Object(w["T"])(i[n].getAttribute("v:shapes"))&&i[n].getAttribute("v:shapes").indexOf("Picture")<0&&i[n].getAttribute("v:shapes").indexOf("Image")<0&&Object(w["F"])(i[n]);i=e.querySelectorAll("img");var r=[],s=[],a=[],o=new RegExp(/([^\S]|^)(((https?\:\/\/)|(www\.))(\S+))/gi);if(i.length>0){for(n=0;n<i.length;n++)r.push(i[n].getAttribute("src")),a.push(i[n].getAttribute("src").split("/")[i[n].getAttribute("src").split("/").length-1].split(".")[0]);var l=this.hexConversion(t);for(n=0;n<l.length;n++)s.push(this.convertToBase64(l[n]));for(n=0;n<i.length;n++)r[n].match(o)?i[n].setAttribute("src",r[n]):i[n].setAttribute("src",s[n]),i[n].setAttribute("id","msWordImg-"+a[n])}},e.prototype.checkVShape=function(e){for(var t=e.querySelectorAll("*"),i=0;i<t.length;i++)switch(t[i].nodeName){case"V:SHAPETYPE":Object(w["F"])(t[i]);break;case"V:SHAPE":if("V:IMAGEDATA"===t[i].firstElementChild.nodeName){var n=t[i].firstElementChild.getAttribute("src"),r=Object(w["C"])("img");r.setAttribute("src",n),t[i].parentElement.insertBefore(r,t[i]),Object(w["F"])(t[i])}break}},e.prototype.convertToBase64=function(e){var t=this.conHexStringToBytes(e.hex),i=this.conBytesToBase64(t),n=e.type?"data:"+e.type+";base64,"+i:null;return n},e.prototype.conBytesToBase64=function(e){for(var t="",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=e.length,r=0;r<n;r+=3){var s=e.slice(r,r+3),a=s.length,o=[];if(a<3)for(var l=a;l<3;l++)s[l]=0;o[0]=(252&s[0])>>2,o[1]=(3&s[0])<<4|s[1]>>4,o[2]=(15&s[1])<<2|(192&s[2])>>6,o[3]=63&s[2];for(l=0;l<4;l++)t+=l<=a?i.charAt(o[l]):"="}return t},e.prototype.conHexStringToBytes=function(e){for(var t=[],i=e.length/2,n=0;n<i;n++)t.push(parseInt(e.substr(2*n,2),16));return t},e.prototype.hexConversion=function(e){var t,i=/\{\\pict[\s\S]+?\\bliptag\-?\d+(\\blipupi\-?\d+)?(\{\\\*\\blipuid\s?[\da-fA-F]+)?[\s\}]*?/,n=new RegExp("(?:("+i.source+"))([\\da-fA-F\\s]+)\\}","g"),r=e.match(n),s=[];if(!Object(w["T"])(r))for(var a=0;a<r.length;a++)if(i.test(r[a])){if(-1!==r[a].indexOf("\\pngblip"))t="image/png";else{if(-1===r[a].indexOf("\\jpegblip"))continue;t="image/jpeg"}s.push({hex:t?r[a].replace(i,"").replace(/[^\da-fA-F]/g,""):null,type:t})}return s},e.prototype.removeClassName=function(e){for(var t=e.querySelectorAll("*[class]"),i=0;i<t.length;i++)t[i].removeAttribute("class")},e.prototype.breakLineAddition=function(e){for(var t=e.querySelectorAll("*"),i=0;i<t.length;i++)if(0===t[i].children.length&&"&nbsp;"===t[i].innerHTML&&"&nbsp;"===t[i].innerHTML&&!t[i].closest("li")&&!t[i].closest("td")){var n=this.findDetachElem(t[i]),r=Object(w["C"])("br");Object(w["T"])(n.parentElement)||(n.parentElement.insertBefore(r,n),Object(w["F"])(n))}},e.prototype.findDetachElem=function(e){var t;return t=!Object(w["T"])(e.parentElement)&&""===e.parentElement.textContent.trim()&&"TD"!==e.parentElement.tagName&&Object(w["T"])(e.parentElement.querySelector("img"))?this.findDetachElem(e.parentElement):e,t},e.prototype.removeUnwantedElements=function(e){for(var t=e.innerHTML,i=0;i<this.removableElements.length;i++){var n=new RegExp("<"+this.removableElements[i]+">","g"),r=new RegExp("</"+this.removableElements[i]+">","g");t=t.replace(n,""),t=t.replace(r,"")}e.innerHTML=t,e.querySelectorAll(":empty")},e.prototype.findDetachEmptyElem=function(e){var t;return t=Object(w["T"])(e.parentElement)?null:""===e.parentElement.textContent.trim()&&"MSWord-Content"!==e.parentElement.getAttribute("id")&&Object(w["T"])(e.parentElement.querySelector("img"))?this.findDetachEmptyElem(e.parentElement):e,t},e.prototype.removeEmptyElements=function(e){for(var t=e.querySelectorAll(":empty"),i=0;i<t.length;i++)if(Object(w["T"])(t[i].closest("td"))||Object(w["T"])(t[i].closest("td").querySelector(".MsoNormal"))||(t[i].innerHTML="-"),"IMG"!==t[i].tagName&&"BR"!==t[i].tagName&&"IFRAME"!==t[i].tagName&&"TD"!==t[i].tagName&&"HR"!==t[i].tagName){var n=this.findDetachEmptyElem(t[i]);Object(w["T"])(n)||Object(w["F"])(n)}},e.prototype.styleCorrection=function(e,t){var i=e.querySelectorAll("style");if(i.length>0){var n=i[0].innerHTML.match(/[\S ]+\s+{[\s\S]+?}/gi),r=Object(w["T"])(n)?null:this.findStyleObject(n),s=Object.keys(r),a=s.map(function(e){return r[e]});a=this.removeUnwantedStyle(a,t),this.filterStyles(e,t);for(var o=void 0,l=!1,d=0;d<s.length;d++){if(""===s[d].split(".")[0])o=e.getElementsByClassName(s[d].split(".")[1]),l=!0;else{if(1===s[d].split(".").length&&s[d].split(".")[0].indexOf("@")>=0)continue;o=1===s[d].split(".").length&&s[d].split(".")[0].indexOf("@")<0?e.getElementsByTagName(s[d]):e.querySelectorAll(s[d])}for(var c=0;c<o.length;c++){var h=o[c].getAttribute("style");if(Object(w["T"])(h)||""===h.trim())a[d]=a[d].replace(/text-indent:-(.*?)(?=;|$)/gm,""),o[c].setAttribute("style",a[d]);else{var p=a[d].split(";");if(!l)for(var u=0;u<p.length;u++)h.indexOf(p[u].split(":")[0])>=0&&(p.splice(u,1),u--);a[d]=p.join(";")+";";var m=h+a[d];o[c].setAttribute("style",m)}}l=!1}}},e.prototype.filterStyles=function(e,t){for(var i=e.querySelectorAll("*[style]"),n=0;n<i.length;n++){for(var r=i[n].getAttribute("style").split(";"),s="",a=0;a<r.length;a++)t.indexOf(r[a].split(":")[0].trim())>=0&&(s+=r[a]+";");i[n].setAttribute("style",s)}},e.prototype.removeUnwantedStyle=function(e,t){for(var i=0;i<e.length;i++){var n=e[i].split(";");e[i]="";for(var r=0;r<n.length;r++)t.indexOf(n[r].split(":")[0])>=0&&(e[i]+=n[r]+";")}return e},e.prototype.findStyleObject=function(e){for(var t={},i=0;i<e.length;i++){var n=e[i],r=n.replace(/([\S ]+\s+){[\s\S]+?}/gi,"$1"),s=n.replace(/[\S ]+\s+{([\s\S]+?)}/gi,"$1");r=r.replace(/^[\s]|[\s]$/gm,""),s=s.replace(/^[\s]|[\s]$/gm,""),r=r.replace(/\n|\r|\n\r/g,""),s=s.replace(/\n|\r|\n\r/g,"");for(var a=r.split(", "),o=0;o<a.length;o++)t[a[o]]=s}return t},e.prototype.removingComments=function(e){var t=e.innerHTML;t=t.replace(/<!--[\s\S]*?-->/g,""),e.innerHTML=t},e.prototype.cleanUp=function(e,t){for(var i,n=[],r=e.querySelectorAll("*"),s=0;s<r.length;s++)-1===this.ignorableNodes.indexOf(r[s].nodeName)||3===r[s].nodeType&&""===r[s].textContent.trim()?n.push(r[s]):(r[s].className&&-1!==r[s].className.toLowerCase().indexOf("msolistparagraph")&&1!==r[s].childElementCount&&!Object(w["T"])(r[s].getAttribute("style"))&&r[s].getAttribute("style").indexOf("mso-list:")>=0&&(r[s].className.indexOf("MsoListParagraphCxSpFirst")>=0&&t.length>0&&null!==t[t.length-1]&&t.push(null),t.push(r[s])),!i||-1===this.blockNode.indexOf(r[s].nodeName.toLowerCase())||r[s].className&&-1!==r[s].className.toLowerCase().indexOf("msolistparagraph")&&!Object(w["T"])(r[s].getAttribute("style"))&&r[s].getAttribute("style").indexOf("mso-list:")>=0||t.push(null),-1!==this.blockNode.indexOf(r[s].nodeName.toLowerCase())&&(i=!!(r[s].className&&-1!==r[s].className.toLowerCase().indexOf("msolistparagraph")&&!Object(w["T"])(r[s].getAttribute("style"))&&r[s].getAttribute("style").indexOf("mso-list:")>=0)));return t.length&&null!==t[t.length-1]&&t.push(null),t},e.prototype.listConverter=function(e){for(var t,i,n=[],r=[],s="",a="",o=0;o<e.length;o++)if(null!==e[o]){e[o].getAttribute("style")&&-1!==e[o].getAttribute("style").indexOf("mso-outline-level")&&e[o].setAttribute("style",e[o].getAttribute("style").replace("mso-outline-level","mso-outline")),s=e[o].getAttribute("style"),t=s&&-1!==s.indexOf("level")?parseInt(s.charAt(s.indexOf("level")+5),null):1,this.listContents=[],this.getListContent(e[o]);var l=void 0,d=void 0;if(!Object(w["T"])(this.listContents[0])){l=this.listContents[0].trim().length>1?"ol":"ul",d=this.getlistStyleType(this.listContents[0],l);for(var c=[],h=1;h<this.listContents.length;h++)c.push(this.listContents[h]);var p=void 0;Object(w["T"])(e[o].className)||(p=e[o].className),Object(w["T"])(e[o].getAttribute("style"))||(e[o].setAttribute("style",e[o].getAttribute("style").replace("text-align:start;","")),""!==e[o].style.textAlign&&(e[o].setAttribute("style","text-align:"+e[o].style.textAlign),a=e[o].getAttribute("style"))),r.push({listType:l,content:c,nestedLevel:t,class:p,listStyle:a,listStyleTypeName:d})}}else n.push({content:this.makeConversion(r),node:e[o-1]}),r=[];i=e.shift();while(i){for(var u=[],m=0;m<n.length;m++)if(n[m].node===i){for(var g=0;g<n[m].content.childNodes.length;g++)u.push(n[m].content.childNodes[g]);for(g=0;g<u.length;g++)i.parentElement.insertBefore(u[g],i);break}i.remove(),i=e.shift(),i||(i=e.shift())}},e.prototype.getlistStyleType=function(e,t){var i;if("ol"===t)switch(e.split(".")[0]){case"A":i="upper-alpha";break;case"a":i="lower-alpha";break;case"I":i="upper-roman";break;case"i":i="lower-roman";break;case"α":i="lower-greek";break;default:i="decimal";break}else switch(e.split(".")[0]){case"o":i="circle";break;case"§":i="square";break;default:i="disc";break}return i},e.prototype.makeConversion=function(e){for(var t,i,n,r=Object(w["C"])("div"),s=1,a=0,o=0;o<e.length;o++){var l=Object(w["C"])("p");if(l.innerHTML=e[o].content.join(" "),1===e[o].nestedLevel&&0===a&&e[o].content)r.appendChild(t=Object(w["C"])(e[o].listType)),i=Object(w["C"])("li"),i.appendChild(l),t.appendChild(i),t.setAttribute("level",e[o].nestedLevel.toString()),t.style.listStyleType=e[o].listStyleTypeName;else if(e[o].nestedLevel===s)i.parentElement.tagName.toLowerCase()===e[o].listType?(i.parentElement.appendChild(i=Object(w["C"])("li")),i.appendChild(l)):(t=Object(w["C"])(e[o].listType),t.style.listStyleType=e[o].listStyleTypeName,i.parentElement.parentElement.appendChild(t),i=Object(w["C"])("li"),i.appendChild(l),t.appendChild(i),t.setAttribute("level",e[o].nestedLevel.toString()));else if(e[o].nestedLevel>s)if(Object(w["T"])(i))r.appendChild(t=Object(w["C"])(e[o].listType)),i=Object(w["C"])("li"),i.appendChild(l),t.appendChild(i),t.setAttribute("level",e[o].nestedLevel.toString()),t.style.listStyleType=e[o].listStyleTypeName;else{for(var d=0;d<e[o].nestedLevel-s;d++)i.appendChild(t=Object(w["C"])(e[o].listType)),i=Object(w["C"])("li"),d!=e[o].nestedLevel-s-1&&e[o].nestedLevel-s>1&&(i.style.listStyleType="none"),t.appendChild(i);i.appendChild(l),t.setAttribute("level",e[o].nestedLevel.toString()),t.style.listStyleType=e[o].listStyleTypeName}else if(1===e[o].nestedLevel)r.lastChild.tagName.toLowerCase()===e[o].listType?t=r.lastChild:(r.appendChild(t=Object(w["C"])(e[o].listType)),t.style.listStyleType=e[o].listStyleTypeName),i=Object(w["C"])("li"),i.appendChild(l),t.appendChild(i),t.setAttribute("level",e[o].nestedLevel.toString());else{n=i;while(n.parentElement)if(n=n.parentElement,n.attributes.getNamedItem("level")){if(parseInt(n.attributes.getNamedItem("level").textContent,null)===e[o].nestedLevel){i=Object(w["C"])("li"),i.appendChild(l),n.appendChild(i);break}if(e[o].nestedLevel>parseInt(n.attributes.getNamedItem("level").textContent,null)){n.appendChild(t=Object(w["C"])(e[o].listType)),i=Object(w["C"])("li"),i.appendChild(l),t.appendChild(i),t.setAttribute("level",e[o].nestedLevel.toString()),t.style.listStyleType=e[o].listStyleTypeName;break}}}i.setAttribute("class",e[o].class);var c=i.getAttribute("style");i.setAttribute("style",Object(w["T"])(c)?"":c),s=e[o].nestedLevel,a++}return r},e.prototype.getListContent=function(e){var t="",i=e.firstElementChild;if(""!==i.textContent.trim()||Object(w["T"])(i.firstElementChild)||"IMG"!==i.firstElementChild.nodeName){var n=["b","em"];if(i.childNodes.length>0&&(i.querySelectorAll("b").length>0||i.querySelectorAll("em").length>0))for(var r=0;r<i.childNodes.length;r++){var s=i.childNodes[r].nodeName.toLowerCase();i.childNodes[r].textContent.trim().length>1&&-1!==n.indexOf(s)?(t="<"+s+">"+i.childNodes[r].textContent+"</"+s+">",this.listContents.push(t)):1===i.childNodes[r].textContent.trim().length&&this.listContents.push(i.childNodes[r].textContent.trim())}else t=i.textContent.trim(),this.listContents.push(t)}else t=e.innerHTML.trim(),this.listContents.push(""),this.listContents.push(t);Object(w["F"])(i),this.listContents.push(e.innerHTML)},e}(),Bd=function(){function e(e){this.parent=e,this.addEventListener()}return e.prototype.addEventListener=function(){this.parent.observer.on(nd,this.insertText,this)},e.prototype.insertText=function(e){var t=document.createTextNode(e.value);gd.Insert(this.parent.currentDocument,t,this.parent.editableElement),e.callBack&&e.callBack({requestType:e.subCommand,editorMode:"HTML",event:e.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},e}(),Fd=function(){function e(e){this.currentDocument=e.document,this.editableElement=e.editableElement,this.nodeSelection=new ad,this.nodeCutter=new ud,this.domNode=new cd(this.editableElement,this.currentDocument),this.observer=new w["q"](this),this.listObj=new hd(this),this.formatObj=new md(this),this.alignmentObj=new bd(this),this.indentsObj=new vd(this),this.linkObj=new fd(this),this.imgObj=new jd(this),this.selectionObj=new xd(this),this.inserthtmlObj=new Md(this),this.insertTextObj=new Bd(this),this.clearObj=new Ld(this),this.tableObj=new Rd(this),this.undoRedoManager=new Nd(this,e.options),this.msWordPaste=new Ad(this),this.wireEvents()}return e.prototype.wireEvents=function(){this.observer.on(Fr,this.editorKeyDown,this),this.observer.on(Ur,this.editorKeyUp,this),this.observer.on(Ur,this.editorKeyUp,this),this.observer.on(Wr,this.onPropertyChanged,this),this.observer.on($r,this.onWordPaste,this),this.observer.on(Xr,this.onBegin,this)},e.prototype.onWordPaste=function(e){this.observer.notify(Kr,e)},e.prototype.onPropertyChanged=function(e){this.observer.notify(Gr,e)},e.prototype.editorKeyDown=function(e){this.observer.notify(qr,e)},e.prototype.editorKeyUp=function(e){this.observer.notify(_r,e)},e.prototype.onBegin=function(e){this.observer.notify(Jr,e)},e.prototype.execCommand=function(e,t,i,n,r,s,a,o){switch(e.toLowerCase()){case"lists":this.observer.notify(zr,{subCommand:t,event:i,callBack:n,selector:a,item:s,enterAction:o});break;case"formats":this.observer.notify(Vr,{subCommand:t,event:i,callBack:n,selector:a,exeValue:s,enterAction:o});break;case"alignments":this.observer.notify(Xl,{subCommand:t,event:i,callBack:n,selector:a,value:s});break;case"indents":this.observer.notify(Jl,{subCommand:t,event:i,callBack:n,selector:a});break;case"links":this.observer.notify(Bl,{command:e,value:t,item:s,event:i,callBack:n});break;case"files":this.observer.notify(Nl,{command:e,value:"Image",item:s,event:i,callBack:n,selector:a});break;case"images":this.observer.notify(Nl,{command:e,value:t,item:s,event:i,callBack:n,selector:a});break;case"table":switch(t.toString().toLocaleLowerCase()){case"createtable":this.observer.notify(Al,{item:s,event:i,callBack:n,enterAction:o});break;case"insertrowbefore":case"insertrowafter":this.observer.notify(Fl,{item:s,event:i,callBack:n});break;case"insertcolumnleft":case"insertcolumnright":this.observer.notify(Hl,{item:s,event:i,callBack:n});break;case"deleterow":this.observer.notify(Vl,{item:s,event:i,callBack:n});break;case"deletecolumn":this.observer.notify(ql,{item:s,event:i,callBack:n});break;case"tableremove":this.observer.notify(zl,{item:s,event:i,callBack:n});break;case"tableheader":this.observer.notify(_l,{item:s,event:i,callBack:n});break;case"aligntop":case"alignmiddle":case"alignbottom":this.observer.notify(Ul,{item:s,event:i,callBack:n});break;case"merge":this.observer.notify(Gl,{item:s,event:i,callBack:n});break;case"horizontalsplit":this.observer.notify(Kl,{item:s,event:i,callBack:n});break;case"verticalsplit":this.observer.notify(Wl,{item:s,event:i,callBack:n});break}break;case"font":case"style":case"effects":case"casing":this.observer.notify(td,{subCommand:t,event:i,callBack:n,value:r,selector:a,enterAction:o});break;case"inserthtml":this.observer.notify(id,{subCommand:t,callBack:n,value:r});break;case"inserttext":this.observer.notify(nd,{subCommand:t,callBack:n,value:r});break;case"clear":this.observer.notify(rd,{subCommand:t,event:i,callBack:n,selector:a,enterAction:o});break;case"actions":this.observer.notify(Hr,{subCommand:t,event:i,callBack:n,selector:a});break}},e}(),Hd=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Vd=function(e){function t(t){var i=e.call(this)||this;return i.initialize(),Object(w["G"])(i,i,t,!0),i.currentDocument&&i.element&&i.updateFormatter(i.element,i.currentDocument,t.options),i}return Hd(t,e),t.prototype.initialize=function(){this.keyConfig=od},t.prototype.updateFormatter=function(e,t,i){e&&t&&(this.editorManager=new Fd({document:t,editableElement:e,options:i}))},t}(Ll),qd=Ml(),zd=function(){function e(){}return e.get=function(e,t,i,n,r,s){for(var a=JSON.parse(JSON.stringify(qd)),o=JSON.parse(JSON.stringify(qd)),l=new ad,d=s?[s]:l.getNodeCollection(l.getRange(e)),c=d.length,h=!1,p=l.getRange(e),u=0;u<d.length;u++){while(3===d[u].nodeType&&3===p.startContainer.nodeType&&d[u].parentNode&&d[u].parentNode.lastElementChild&&"BR"!==d[u].parentNode.lastElementChild.nodeName&&0===this.getImmediateBlockNode(d[u].parentNode).textContent.replace(/\u200B/g,"").length&&0===p.startContainer.textContent.replace(/\u200B/g,"").length&&0===l.get(e).toString().replace(/\u200B/g,"").length)d[u]=d[u].parentNode.lastElementChild.firstChild,h=!0;h&&d[u]&&(l.setCursorPoint(e,d[u],d[u].textContent.length),h=!1),("BR"!==d[u].nodeName&&3!==d[u].nodeType||c>1&&3===d[u].nodeType&&""===d[u].textContent.trim())&&(d.splice(u,1),u--)}for(u=0;u<d.length;u++)a=this.getFormatParent(e,a,d[u],t,i,n,r),(0===u&&a.bold||!a.bold)&&(o.bold=a.bold),(0===u&&a.insertcode||!a.insertcode)&&(o.insertcode=a.insertcode),(0===u&&a.italic||!a.italic)&&(o.italic=a.italic),(0===u&&a.underline||!a.underline)&&(o.underline=a.underline),(0===u&&a.strikethrough||!a.strikethrough)&&(o.strikethrough=a.strikethrough),(0===u&&a.superscript||!a.superscript)&&(o.superscript=a.superscript),(0===u&&a.subscript||!a.subscript)&&(o.subscript=a.subscript),(0===u&&a.fontcolor||!a.fontcolor)&&(o.fontcolor=a.fontcolor),(0===u&&a.fontname||!a.fontname)&&(o.fontname=a.fontname),(0===u&&a.fontsize||!a.fontsize)&&(o.fontsize=a.fontsize),(0===u&&a.backgroundcolor||!a.backgroundcolor)&&(o.backgroundcolor=a.backgroundcolor),(0===u&&a.orderedlist||!a.orderedlist)&&(o.orderedlist=a.orderedlist),(0===u&&a.unorderedlist||!a.unorderedlist)&&(o.unorderedlist=a.unorderedlist),(0===u&&a.alignments||!a.alignments)&&(o.alignments=a.alignments),(0===u&&a.formats||!a.formats)&&(o.formats=a.formats),(0===u&&a.createlink||!a.createlink)&&(o.createlink=a.createlink),(0===u&&a.numberFormatList||!a.numberFormatList)&&(o.numberFormatList=a.numberFormatList),(0===u&&a.bulletFormatList||!a.bulletFormatList)&&(o.bulletFormatList=a.bulletFormatList),a=JSON.parse(JSON.stringify(qd));return o},e.getImmediateBlockNode=function(e){do{e=e.parentNode}while(e&&Yl.indexOf(e.nodeName.toLocaleLowerCase())<0);return e},e.getFormatParent=function(e,t,i,n,r,s,a){if(n.contains(i)||3===i.nodeType&&3!==n.nodeType&&n.contains(i.parentNode))do{t=this.isFormattedNode(e,t,i,r,s,a),i=i.parentNode}while(i&&i!==n);return t},e.isFormattedNode=function(e,t,i,n,r,s){return t.bold||(t.bold=Ed.isBold(i)),t.italic||(t.italic=Ed.isItalic(i)),t.underline||(t.underline=Ed.isUnderline(i)),t.strikethrough||(t.strikethrough=Ed.isStrikethrough(i)),t.superscript||(t.superscript=Ed.isSuperscript(i)),t.subscript||(t.subscript=Ed.isSubscript(i)),t.fontcolor||(t.fontcolor=this.isFontColor(e,i)),t.fontname||(t.fontname=this.isFontName(e,i,s)),t.fontsize||(t.fontsize=this.isFontSize(i,r)),t.backgroundcolor||(t.backgroundcolor=this.isBackgroundColor(i)),t.orderedlist||(t.orderedlist=this.isOrderedList(i)),t.unorderedlist||(t.unorderedlist=this.isUnorderedList(i)),t.alignments||(t.alignments=this.isAlignment(i)),t.formats||(t.formats=this.isFormats(i,n),"pre"===t.formats&&(t.insertcode=!0)),t.createlink||(t.createlink=this.isLink(i)),t.numberFormatList||(t.numberFormatList=this.isNumberFormatList(i)),t.bulletFormatList||(t.bulletFormatList=this.isBulletFormatList(i)),t},e.isFontColor=function(e,t){var i=t.style&&t.style.color;return null!==i&&void 0!==i&&""!==i||3===t.nodeType||(i=this.getComputedStyle(e,t,"color")),null!==i&&""!==i&&void 0!==i?i:null},e.isLink=function(e){return"a"===e.nodeName.toLocaleLowerCase()},e.isBackgroundColor=function(e){var t=e.style&&e.style.backgroundColor;return null!==t&&""!==t&&void 0!==t?t:null},e.isFontSize=function(e,t){var i=e.style&&e.style.fontSize;return null!==i&&""!==i&&void 0!==i&&(null===t||void 0===t||t.indexOf(i)>-1)?i:null},e.isFontName=function(e,t,i){var n=t.style&&t.style.fontFamily;null!==n&&void 0!==n&&""!==n||3===t.nodeType||(n=this.getComputedStyle(e,t,"font-family"));var r=null;return null!==n&&""!==n&&void 0!==n&&(null===i||void 0===i||i.filter(function(e,t){var i=new RegExp(n,"i");(e.replace(/"/g,"").replace(/ /g,"")===n.replace(/"/g,"").replace(/ /g,"")||e.search(i)>-1)&&(r=t)})&&null!==r)?null!==r?i[r]:n.replace(/"/g,""):null},e.isOrderedList=function(e){return"ol"===e.nodeName.toLocaleLowerCase()},e.isUnorderedList=function(e){return"ul"===e.nodeName.toLocaleLowerCase()},e.isAlignment=function(e){var t=e.style&&e.style.textAlign;return"left"===t?"justifyleft":"center"===t?"justifycenter":"right"===t?"justifyright":"justify"===t?"justifyfull":null},e.isFormats=function(e,t){return(void 0===t||null===t)&&Yl.indexOf(e.nodeName.toLocaleLowerCase())>-1||null!==t&&void 0!==t&&t.indexOf(e.nodeName.toLocaleLowerCase())>-1?e.nodeName.toLocaleLowerCase():null},e.getComputedStyle=function(e,t,i){return e.defaultView.getComputedStyle(t,null).getPropertyValue(i)},e.isNumberFormatList=function(e){var t=e.style&&e.style.listStyleType;return"lower-alpha"===t?"Lower Alpha":"number"===t?"Number":"upper-alpha"===t?"Upper Alpha":"lower-roman"===t?"Lower Roman":"upper-roman"===t?"Upper Roman":"lower-greek"===t?"Lower Greek":"none"===t?"None":null},e.isBulletFormatList=function(e){var t=e.style&&e.style.listStyleType;return"circle"===t?"Circle":"square"===t?"Square":"none"===t?"None":"disc"===t?"Disc":null},e}(),_d=function(){function e(e){this.parent=e,this.toolbarStatus=this.prevToolbarStatus=Ml(),this.addEventListener()}return e.prototype.addEventListener=function(){this.parent.on($t,this.onRefreshHandler,this),this.parent.on(Wt,this.removeEventListener,this)},e.prototype.removeEventListener=function(){this.parent.off($t,this.onRefreshHandler),this.parent.off(Wt,this.removeEventListener)},e.prototype.onRefreshHandler=function(e){if(!this.parent.readonly){var t=[],i=[],n=[];this.parent.fontSize.items.forEach(function(e){t.push(e.value)}),this.parent.fontFamily.items.forEach(function(e){i.push(e.value)}),this.parent.format.types.forEach(function(e){n.push(e.value.toLocaleLowerCase())}),this.toolbarStatus=zd.get(this.parent.contentModule.getDocument(),this.parent.contentModule.getEditPanel(),n,t,i,e.documentNode);var r=JSON.stringify(this.toolbarStatus);this.parent.notify(Jt,this.toolbarStatus),JSON.stringify(this.prevToolbarStatus)!==r&&(this.parent.notify(mn,{html:JSON.parse(r),markdown:null}),this.prevToolbarStatus=JSON.parse(r))}},e}(),Ud=function(){function e(e,t){this.parent=e,this.serviceLocator=t}return e.prototype.renderPanel=function(){var e=this.parent,t=this.parent.createElement("div",{className:"e-rte-content",id:this.parent.getID()+"rte-view"}),i=Ya(e.value,e);this.editableElement=this.parent.createElement("div",{className:"e-content",id:this.parent.getID()+"_rte-edit-view",attrs:{contenteditable:"true"},innerHTML:i}),t.appendChild(this.editableElement),this.setPanel(t),e.element.appendChild(t)},e.prototype.getPanel=function(){return this.contentPanel},e.prototype.getEditPanel=function(){return this.editableElement},e.prototype.getText=function(){var e=this.getEditPanel().innerText;return"\n"===e?"":e},e.prototype.setPanel=function(e){this.contentPanel=e},e.prototype.getDocument=function(){return this.getEditPanel().ownerDocument},e}(),Gd=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Wd="\n<!DOCTYPE html> \n    <html>\n         <head>\n            <meta charset='utf-8' /> \n            <style>\n                @charset \"UTF-8\";\n                body {\n                    font-family: \"Roboto\", sans-serif;\n                    font-size: 14px;\n                }\n                html, body{height: 100%;margin: 0;}\n                body.e-cursor{cursor:default}\n                span.e-selected-node\t{background-color: #939393;color: white;}\n                span.e-selected-node.e-highlight {background-color: #1d9dd8;}\n                body{color:#333;word-wrap:break-word;padding: 8px;box-sizing: border-box;}\n                .e-rte-image {border: 0;cursor: pointer;display:\n                    block;float: none;height: auto;margin: 5px auto;max-width: 100%;position: relative;}\n                .e-rte-image.e-imginline {display: inline-block;float: none;max-width: calc(100% - (2 * 5px));padding: 1px;vertical-align: bottom;}\n                .e-rte-image.e-imgcenter {cursor: pointer;display: block;float: none;margin: 5px auto;max-width: 100%;position: relative;}\n                .e-rte-image.e-imgright { float: right; margin: 0 auto;margin-left: 5px;text-align: right;}\n                .e-rte-image.e-imgleft {float: left;margin: 0 auto;margin-right: 5px;text-align: left;}\n                .e-img-caption { display: inline-block; float: none; margin: 5px auto; max-width: 100%;position: relative;}\n                .e-img-caption.e-caption-inline {display: inline-block;float: none;\n                    margin: 5px auto;margin-left: 5px;margin-right: 5px;max-width: calc(100% - (2 * 5px));\n                    position: relativetext-align: center;vertical-align: bottom;}\n                .e-img-inner {box-sizing: border-box;display: block;font-size: 16px;font-weight: initial;\n                    margin: auto;opacity: .9;text-align: center;width: 100%;}\n                .e-img-wrap {display: inline-block;margin: auto;padding: 0;text-align: center;width: 100%;}\n                .e-imgleft {float: left;margin: 0 5px 0 0;text-align: left;}\n                .e-imgright {float: right;margin: 0 0 0 5px;text-align: right;}\n                .e-imgcenter {cursor: pointer;display: block;float: none;height: auto;margin: 5px auto;max-width: 100%;position: relative;}\n                .e-control img:not(.e-resize) {border: 2px solid transparent; z-index: 1000}\n                .e-imginline {display: inline-block;float: none;margin-left: 5px;margin-right: 5px;\n                    max-width: calc(100% - (2 * 5px));vertical-align: bottom;}\n                .e-imgbreak {border: 0;cursor: pointer;\n                    display: block;float: none;height: auto;margin: 5px auto;max-width: 100%;position: relative;}\n                .e-rte-image.e-img-focus:not(.e-resize) {border: solid 2px #4a90e2;}\n                img.e-img-focus::selection { background: transparent;color: transparent;}\n                span.e-rte-imageboxmark {  width: 10px; height: 10px; position: absolute; display: block;\n                    background: #4a90e2; border: 1px solid #fff; z-index: 1000;}\n                .e-mob-rte.e-mob-span span.e-rte-imageboxmark { background: #4a90e2; border: 1px solid #fff; }\n                .e-mob-rte span.e-rte-imageboxmark { background: #fff; border: 1px solid #4a90e2;\n                    border-radius: 15px; height: 20px; width: 20px; }\n                .e-mob-rte.e-mob-span span.e-rte-imageboxmark { background: #4a90e2; border: 1px solid #fff; }\n                .e-rte-content .e-content img.e-resize { z-index: 1000; }\n                .e-img-caption .e-img-inner { outline: 0; }\n                .e-img-caption a:focus-visible { outline: none; }\n                .e-img-caption .e-rte-image.e-imgright, .e-img-caption .e-rte-image.e-imgleft { float: none; margin: 0;}\n                body{box-sizing: border-box;min-height: 100px;outline: 0 solid transparent;\n                    overflow-x: auto;padding: 16px;position: relative;text-align: inherit;z-index: 2;}\n                p{margin: 0 0 10px;margin-bottom: 10px;}\n                li{margin-bottom: 10px;}\n                h1{font-size: 2.17em;font-weight: 400;line-height: 1;margin: 10px 0;}\n                h2{font-size: 1.74em;font-weight: 400;margin: 10px 0;}\n                h3{font-size: 1.31em;font-weight: 400;margin: 10px 0;}\n                h4{font-size: 16px;font-weight: 400;line-height: 1.5;margin: 0;}\n                h5{font-size: 00.8em;font-weight: 400;margin: 0;}\n                h6{font-size: 00.65em;font-weight: 400;margin: 0;}\n                blockquote{margin: 10px 0;margin-left: 0;padding-left: 5px;border-left: solid 2px #5c5c5c;}\n                pre{background-color: inherit;border: 0;border-radius: 0;color: #333;\n                    font-size: inherit;line-height: inherit;margin: 0 0 10px;overflow: visible;padding: 0;\n                    white-space: pre-wrap;word-break: inherit;word-wrap: break-word;}\n                strong, b{font-weight: 700;}\n                a{text-decoration: none;user-select: auto;}\n                a:hover{text-decoration: underline;};\n                p:last-child, pre:last-child, blockquote:last-child{margin-bottom: 0;}\n                h3+h4, h4+h5, h5+h6{margin-top: 00.6em;}\n                ul:last-child{margin-bottom: 0;}\n                table { border-collapse: collapse; empty-cells: show;}\n                table td,table th {border: 1px solid #BDBDBD; height: 20px; padding: 2px 5px; vertical-align: middle;}\n                table.e-alternate-border tbody tr:nth-child(2n) {background-color: #F5F5F5;}\n                table th {background-color: #E0E0E0;}\n                table.e-dashed-border td,table.e-dashed-border th { border: 1px dashed #BDBDBD} \n                table .e-cell-select {border: 1px double #4a90e2;}\n                span.e-table-box { cursor: nwse-resize; display: block; height: 10px; position: absolute; width: 10px; }\n                span.e-table-box.e-rmob {height: 14px;width: 14px;}\n                .e-row-resize, .e-column-resize { background-color: transparent; background-repeat: repeat;\n                    bottom: 0;cursor: col-resize;height: 1px;overflow: visible;position: absolute;width: 1px; }\n                .e-row-resize { cursor: row-resize; height: 1px;}\n                .e-table-rhelper { cursor: col-resize; opacity: .87;position: absolute;}\n                .e-table-rhelper.e-column-helper { width: 1px; }\n                .e-table-rhelper.e-row-helper {height: 1px;}\n                .e-reicon::before { border-bottom: 6px solid transparent; border-right: 6px solid;\n                    border-top: 6px solid transparent; content: ''; display: block; height: 0;\n                    position: absolute; right: 4px; top: 4px; width: 20px; }\n                .e-reicon::after { border-bottom: 6px solid transparent; border-left: 6px solid;\n                    border-top: 6px solid transparent; content: ''; display: block;\n                    height: 0; left: 4px; position: absolute; top: 4px; width: 20px; z-index: 3; }\n                .e-row-helper.e-reicon::after { top: 10px; transform: rotate(90deg); }\n                .e-row-helper.e-reicon::before { left: 4px; top: -20px; transform: rotate(90deg); }\n                span.e-table-box { background-color: #ffffff; border: 1px solid #BDBDBD; }\n                span.e-table-box.e-rbox-select { background-color: #BDBDBD; border: 1px solid #BDBDBD; }\n                .e-table-rhelper { background-color: #4a90e2;}\n                .e-rtl { direction: rtl; }\n            </style>\n        </head>",Kd=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Gd(t,e),t.prototype.renderPanel=function(){var e=this.parent,t=Ya(e.value,e),i='<body spellcheck="false" autocorrect="off" contenteditable="true">'+t+"</body></html>",n=Wd+i,r=this.parent.createElement("iframe",{id:this.parent.getID()+"_rte-view",className:"e-rte-content",styles:"display:block;",attrs:{srcdoc:n}});this.setPanel(r),e.element.appendChild(r),r.contentDocument.body.id=this.parent.getID()+"_rte-edit-view",r.contentDocument.body.setAttribute("aria-owns",this.parent.getID()),r.contentDocument.open(),n=this.setThemeColor(n,{color:"#333"}),r.contentDocument.write(n),r.contentDocument.close(),e.enableRtl&&this.contentPanel.contentDocument.body.setAttribute("class","e-rtl")},t.prototype.setThemeColor=function(e,t){var i=getComputedStyle(this.parent.element,".e-richtexteditor").getPropertyValue("color");return e.replace(t.color,i)},t.prototype.getEditPanel=function(){var e;return e=Object(w["T"])(this.contentPanel.contentDocument)?this.parent.inputElement:this.contentPanel.contentDocument.body,e},t.prototype.getDocument=function(){return this.getEditPanel().ownerDocument},t}(Ud),$d=function(){function e(e,t){this.tools={},this.parent=e,this.locator=t,this.renderFactory=this.locator.getService("rendererFactory"),this.addEventListener(),this.parent.toolbarSettings&&Object.keys(this.parent.toolbarSettings.itemConfigs).length>0?Object(w["G"])(this.tools,Ps,Qa(this.parent.toolbarSettings.itemConfigs),!0):this.tools=Ps}return e.prototype.initializeInstance=function(){this.toolbarRenderer=this.renderFactory.getRenderer(ve.Toolbar)},e.prototype.renderColorPickerInput=function(e){var t=this;this.initializeInstance();var i,n,r=e.containerType,s=e.container;Ms.forEach(function(a){if(-1!==Ba(a,e.items))switch(a){case"fontcolor":i=t.parent.getID()+"_"+r+"_FontColor_Target";var o=t.parent.createElement("input");if(o.id=i,o.classList.add(wr),!Object(w["T"])(t.parent.cssClass))for(var l=t.parent.cssClass.split(" "),d=0;d<l.length;d++)""!==l[d].trim()&&o.classList.add(l[d]);document.body.appendChild(o),n={cssClass:t.tools[a.toLocaleLowerCase()].icon+" "+cr+" "+or+" "+t.parent.cssClass,value:t.tools[a.toLocaleLowerCase()].value,command:t.tools[a.toLocaleLowerCase()].command,subCommand:t.tools[a.toLocaleLowerCase()].subCommand,element:Object(w["jb"])("#"+t.parent.getID()+"_"+r+"_FontColor",s),target:i},t.fontColorPicker=t.toolbarRenderer.renderColorPicker(n,"fontcolor"),t.fontColorDropDown=t.toolbarRenderer.renderColorPickerDropDown(n,"fontcolor",t.fontColorPicker);break;case"backgroundcolor":i=t.parent.getID()+"_"+r+"_BackgroundColor_Target";var c=t.parent.createElement("input");if(c.id=i,c.classList.add(Or),!Object(w["T"])(t.parent.cssClass))for(l=t.parent.cssClass.split(" "),d=0;d<l.length;d++)""!==l[d].trim()&&c.classList.add(l[d]);document.body.appendChild(c),n={cssClass:t.tools[a.toLocaleLowerCase()].icon+" "+cr+" "+or+" "+t.parent.cssClass,value:t.tools[a.toLocaleLowerCase()].value,command:t.tools[a.toLocaleLowerCase()].command,subCommand:t.tools[a.toLocaleLowerCase()].subCommand,element:Object(w["jb"])("#"+t.parent.getID()+"_"+r+"_BackgroundColor",s),target:i},t.backgroundColorPicker=t.toolbarRenderer.renderColorPicker(n,"backgroundcolor"),t.backgroundColorDropDown=t.toolbarRenderer.renderColorPickerDropDown(n,"backgroundcolor",t.backgroundColorPicker,t.defaultColorPicker);break}}),this.parent.inlineMode.enable&&this.setCssClass({cssClass:this.parent.cssClass})},e.prototype.destroy=function(){this.removeEventListener(),this.destroyColorPicker()},e.prototype.destroyColorPicker=function(){if(this.fontColorPicker&&!this.fontColorPicker.isDestroyed&&this.fontColorPicker.destroy(),this.backgroundColorPicker&&!this.backgroundColorPicker.isDestroyed&&this.backgroundColorPicker.destroy(),this.fontColorDropDown&&!this.fontColorDropDown.isDestroyed){var e=this.fontColorDropDown.element.querySelector(".e-rte-color-content");e&&Object(w["F"])(e),this.fontColorDropDown.destroy()}if(this.backgroundColorDropDown&&!this.backgroundColorDropDown.isDestroyed){e=this.backgroundColorDropDown.element.querySelector(".e-rte-color-content");e&&(this.defaultColorPicker=e.children[0].style.borderBottomColor,Object(w["F"])(e)),this.backgroundColorDropDown.destroy()}},e.prototype.setRtl=function(e){this.fontColorPicker&&(this.fontColorPicker.setProperties({enableRtl:e.enableRtl}),this.fontColorDropDown.setProperties({enableRtl:e.enableRtl})),this.backgroundColorPicker&&(this.backgroundColorPicker.setProperties({enableRtl:e.enableRtl}),this.backgroundColorDropDown.setProperties({enableRtl:e.enableRtl}))},e.prototype.setCssClass=function(e){this.updateCss(this.fontColorPicker,this.fontColorDropDown,e),this.updateCss(this.backgroundColorPicker,this.backgroundColorDropDown,e)},e.prototype.updateCss=function(e,t,i){e&&i.cssClass&&(Object(w["T"])(i.oldCssClass)?(e.setProperties({cssClass:(e.cssClass+" "+i.cssClass).trim()}),t.setProperties({cssClass:(t.cssClass+" "+i.cssClass).trim()})):(e.setProperties({cssClass:(e.cssClass.replace(i.oldCssClass,"").replace("  "," ").trim()+" "+i.cssClass).trim()}),t.setProperties({cssClass:(t.cssClass.replace(i.oldCssClass,"").replace("  "," ").trim()+" "+i.cssClass).trim()})))},e.prototype.addEventListener=function(){this.parent.on(oi,this.renderColorPickerInput,this),this.parent.on(Wi,this.setRtl,this),this.parent.on(Wt,this.destroy,this),this.parent.on(ti,this.destroyColorPicker,this),this.parent.on(ii,this.onPropertyChanged,this),this.parent.on(wn,this.setCssClass,this)},e.prototype.onPropertyChanged=function(e){for(var t,i=e.newProp,n=0,r=Object.keys(i);n<r.length;n++){var s=r[n];switch(s){case"fontColor":if(this.fontColorPicker)for(var a=0,o=Object.keys(i.fontColor);a<o.length;a++){var l=o[a];switch(l){case"default":this.fontColorPicker.setProperties({value:i.fontColor.default}),t=this.fontColorDropDown.element;var d=t.querySelector("."+this.tools["fontcolor"].icon);d.style.borderBottomColor=i.fontColor.default;break;case"mode":this.fontColorPicker.setProperties({mode:i.fontColor.mode});break;case"columns":this.fontColorPicker.setProperties({columns:i.fontColor.columns});break;case"colorCode":this.fontColorPicker.setProperties({presetColors:i.fontColor.colorCode});break;case"modeSwitcher":this.fontColorPicker.setProperties({modeSwitcher:i.fontColor.modeSwitcher});break}}break;case"backgroundColor":if(this.backgroundColorPicker)for(var c=0,h=Object.keys(i.backgroundColor);c<h.length;c++){var p=h[c];switch(p){case"default":this.backgroundColorPicker.setProperties({value:i.backgroundColor.default}),t=this.backgroundColorDropDown.element;var u=t.querySelector("."+this.tools["backgroundcolor"].icon);u.style.borderBottomColor=i.backgroundColor.default;break;case"mode":this.backgroundColorPicker.setProperties({mode:i.backgroundColor.mode});break;case"columns":this.backgroundColorPicker.setProperties({columns:i.backgroundColor.columns});break;case"colorCode":this.backgroundColorPicker.setProperties({presetColors:i.backgroundColor.colorCode});break;case"modeSwitcher":this.backgroundColorPicker.setProperties({modeSwitcher:i.backgroundColor.modeSwitcher});break}}break}}},e.prototype.removeEventListener=function(){this.parent.off(oi,this.renderColorPickerInput),this.parent.off(Wt,this.destroy),this.parent.off(Wi,this.setRtl),this.parent.off(ti,this.destroyColorPicker),this.parent.off(ii,this.onPropertyChanged),this.parent.off(wn,this.setCssClass)},e}(),Xd=function(){function e(e){this.parent=e,this.addEventListener()}return e.prototype.addEventListener=function(){this.parent.on(cn,this.enableXhtmlValidation,this),this.parent.on(Wt,this.removeEventListener,this)},e.prototype.removeEventListener=function(){this.parent.off(cn,this.enableXhtmlValidation),this.parent.off(Wt,this.removeEventListener)},e.prototype.enableXhtmlValidation=function(){this.parent.enableXhtml&&(Object(w["T"])(this.parent.inputElement)?this.currentElement=this.parent.element:this.currentElement=this.parent.inputElement,this.clean(this.currentElement),this.AddRootElement(),this.ImageTags(),this.removeTags(),this.RemoveUnsupported(),this.currentElement.innerHTML=this.selfEncloseValidation(this.currentElement.innerHTML,"\n"===this.currentElement.innerText?this.currentElement.innerText.length:this.currentElement.innerText.trim().length),this.parent.setProperties({value:this.currentElement.innerHTML},!0))},e.prototype.selfEncloseValidation=function(e,t){if(0===t&&e.indexOf("table")<0&&e.indexOf("img")<0){var i=e.split("&nbsp;");i[i.length-1]="&#8203;"+i[i.length-1],e=i.join("")}var n;e=e.replace(/<br>/g,"<br/>").replace(/<hr>/g,"<hr/>").replace(/ /g," ");for(var r=[],s=[],a=[/<img(.*?)>/gi,/<area(.*?)>/gi,/<base(.*?)>/gi,/<col (.*?)>/gi,/<embed(.*?)>/gi,/<input(.*?)>/gi,/<link(.*?)>/gi,/<meta(.*?)>/gi,/<param(.*?)>/gi,/<source(.*?)>/gi,/<track(.*?)>/gi,/<wbr(.*?)>/gi],o=0;o<a.length;o++){n=a[o].exec(e);while(null!==n)r.push(n[0].toString()),n=a[o].exec(e);s=r.slice(0);for(var l=0;l<r.length;l++)-1!==r[l].indexOf("/")&&r[l].lastIndexOf("/")===r[l].length-2||(r[l]=r[l].substr(0,r[l].length-1)+" /"+r[l].substr(r[l].length-1,r[l].length));for(var d=0;d<=r.length-1;d++)e=e.replace(s[d],r[d])}return e},e.prototype.AddRootElement=function(){if(1===this.currentElement.childNodes.length&&"DIV"!==this.currentElement.firstChild.nodeName||this.currentElement.childNodes.length>1){var e=this.parent.createElement("div");while(this.currentElement.childNodes.length>0)e.appendChild(this.currentElement.childNodes[0]);this.currentElement.appendChild(e)}},e.prototype.clean=function(e){for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];8===i.nodeType||"V:IMAGE"===i.nodeName?(e.removeChild(i),t--):1===i.nodeType&&this.clean(i)}return this.currentElement.innerHTML},e.prototype.ImageTags=function(){for(var e=this.currentElement.querySelectorAll("IMG"),t=e.length-1;t>=0;t--)if(!e[t].hasAttribute("alt")){var i=e[t];i.setAttribute("alt","")}},e.prototype.removeTags=function(){for(var e=[["br","ul"],["br","ol"],["table","span"],["div","span"],["p","span"]],t=0;t<e.length;t++)this.RemoveElementNode(e[t][0],e[t][1])},e.prototype.RemoveElementNode=function(e,t){for(var i=this.currentElement.querySelectorAll(t),n=0;n<i.length;n++)for(var r=i[n].querySelectorAll(e),s=r.length;s>0;s--)Object(w["F"])(r[s-1])},e.prototype.RemoveUnsupported=function(){for(var e=this.currentElement.querySelectorAll("u"),t=e.length-1;t>=0;t--){var i=this.parent.createElement("span");i.style.textDecoration="underline",i.innerHTML=e[t].innerHTML,e[t].parentNode.insertBefore(i,e[t]),Object(w["F"])(e[t])}var n=this.currentElement.querySelectorAll("strong");for(t=n.length-1;t>=0;t--){var r=this.parent.createElement("b");r.innerHTML=n[t].innerHTML,n[t].parentNode.insertBefore(r,n[t]),Object(w["F"])(n[t])}var s=["language","role","target","contenteditable","cellspacing","cellpadding","border","valign","colspan"];for(t=0;t<=s.length;t++)this.RemoveAttributeByName(s[t])},e.prototype.RemoveAttributeByName=function(e){if(null!==this.currentElement.firstChild&&3!==this.currentElement.firstChild.nodeType)for(var t=0;t<this.currentElement.childNodes.length;t++){var i=this.currentElement.childNodes[t];if(3!==i.nodeType&&"TABLE"!==i.nodeName&&"TBODY"!==i.nodeName&&"THEAD"!==i.nodeName&&"TH"!==i.nodeName&&"TR"!==i.nodeName&&"TD"!==i.nodeName&&(i.hasAttribute(e)&&i.removeAttribute(e),i.hasChildNodes()))for(var n=0;n<i.childNodes.length;n++){var r=i.childNodes[n];if(3!==r.nodeType&&"TABLE"!==r.nodeName&&"TBODY"!==r.nodeName&&"THEAD"!==r.nodeName&&"TH"!==r.nodeName&&"TR"!==r.nodeName&&"TD"!==r.nodeName&&r.hasAttribute(e)&&r.removeAttribute(e),r.hasChildNodes())for(var s=0;s<r.childNodes.length;s++)3!==r.childNodes[s].nodeType&&"TABLE"!==r.childNodes[s].nodeName&&"TBODY"!==r.childNodes[s].nodeName&&"THEAD"!==r.childNodes[s].nodeName&&"TH"!==r.childNodes[s].nodeName&&"TR"!==r.childNodes[s].nodeName&&"TD"!==r.childNodes[s].nodeName&&r.childNodes[s].hasAttribute(e)&&r.childNodes[s].removeAttribute(e)}}},e}(),Jd=function(){function e(e,t){this.rangeCollection=[],this.isImageDelete=!1,this.parent=e,this.locator=t,this.renderFactory=this.locator.getService("rendererFactory"),this.xhtmlValidation=new Xd(e),this.addEventListener()}return e.prototype.destroy=function(){this.removeEventListener()},e.prototype.sanitizeHelper=function(e){return e=no(e,this.parent),e},e.prototype.addEventListener=function(){this.parent.isDestroyed||(this.nodeSelectionObj=new ad,this.colorPickerModule=new $d(this.parent,this.locator),this.parent.on(zt,this.instantiateRenderer,this),this.parent.on(Zt,this.onToolbarClick,this),this.parent.on(ri,this.onKeyDown,this),this.parent.on(ni,this.onKeyUp,this),this.parent.on(Yt,this.renderColorPicker,this),this.parent.on(Ut,this.render,this),this.parent.on(ii,this.onPropertyChanged,this),this.parent.on(Wt,this.destroy,this),this.parent.on(qi,this.selectAll,this),this.parent.on(zi,this.selectRange,this),this.parent.on(_i,this.getSelectedHtml,this),this.parent.on(Ei,this.onSelectionSave,this),this.parent.on(Ii,this.onSelectionRestore,this),this.parent.on(Qi,this.updateReadOnly,this),this.parent.on(Gi,this.onPaste,this))},e.prototype.updateReadOnly=function(){this.parent.readonly?(Object(w["w"])(this.parent.contentModule.getEditPanel(),{contenteditable:"false"}),Object(w["u"])([this.parent.element],Er)):(Object(w["w"])(this.parent.contentModule.getEditPanel(),{contenteditable:"true"}),Object(w["gb"])([this.parent.element],Er))},e.prototype.onSelectionSave=function(){var e=this.contentRenderer.getDocument(),t=this.nodeSelectionObj.getRange(e);this.saveSelection=this.nodeSelectionObj.save(t,e)},e.prototype.onSelectionRestore=function(e){this.parent.isBlur=!1,this.contentRenderer.getEditPanel().focus(),(Object(w["T"])(e.items)||e.items)&&this.saveSelection.restore()},e.prototype.onKeyUp=function(e){var t,i=e.args,n=[8,9,13,16,17,18,20,27,37,38,39,40,44,45,46,91,112,113,114,115,116,117,118,119,120,121,122,123],r=this.parent.getRange(),s=new RegExp(String.fromCharCode(8203),"g");n.indexOf(i.keyCode)<0&&!i.shiftKey&&!i.ctrlKey&&!i.altKey&&(8203===r.startContainer.textContent.charCodeAt(0)&&(t=r.startOffset-1,r.startContainer.textContent=r.startContainer.textContent.replace(s,""),this.parent.formatter.editorManager.nodeSelection.setCursorPoint(this.parent.contentModule.getDocument(),r.startContainer,t)),!Object(w["T"])(r.startContainer.previousSibling)&&!Object(w["T"])(r.startContainer.previousSibling.parentElement)&&r.startContainer.parentElement===r.startContainer.previousSibling.parentElement&&8203===r.startContainer.previousSibling.textContent.charCodeAt(0)&&r.startContainer.previousSibling.textContent.length<=1&&(r.startContainer.previousSibling.textContent=r.startContainer.previousSibling.textContent.replace(s,"")),8203===r.endContainer.textContent.charCodeAt(r.endOffset)&&(t=r.startOffset,r.endContainer.textContent=r.endContainer.textContent.replace(s,""),this.parent.formatter.editorManager.nodeSelection.setCursorPoint(this.parent.contentModule.getDocument(),r.startContainer,t)))},e.prototype.onKeyDown=function(e){var t,i=this,n=e.args;if("chrome"===w["d"].info.name&&(t=this.parent.getRange(),this.backSpaceCleanup(e,t),this.deleteCleanup(e,t)),9===n.keyCode&&this.parent.enableTabKey&&!Object(w["T"])(n.target)&&Object(w["T"])(Object(w["A"])(n.target,".e-rte-toolbar"))){var r=this.nodeSelectionObj.getRange(this.contentRenderer.getDocument()),s=this.nodeSelectionObj.getParentNodeCollection(r);if("LI"!==s[0].nodeName&&!Object(w["A"])(s[0],"li")&&!Object(w["A"])(s[0],"table")||0!==r.startOffset)if(n.preventDefault(),n.shiftKey){if(this.rangeCollection.length>0&&4===this.rangeCollection[this.rangeCollection.length-1].startContainer.textContent.length){var a=this.rangeCollection[this.rangeCollection.length-1].startContainer;this.nodeSelectionObj.setSelectionText(this.contentRenderer.getDocument(),a,a,0,a.textContent.length),gd.Insert(this.contentRenderer.getDocument(),document.createTextNode("")),this.rangeCollection.pop()}}else gd.Insert(this.contentRenderer.getDocument(),"&nbsp;&nbsp;&nbsp;&nbsp;"),this.rangeCollection.push(this.nodeSelectionObj.getRange(this.contentRenderer.getDocument()))}if(("space"===e.args.action||"enter"===e.args.action||13===e.args.keyCode)&&(this.spaceLink(e.args),"HTML"===this.parent.editorMode&&!this.parent.readonly)){var o=this.parent.getText().trim().length,l=this.parent.getSelection().length,d=o-l+1;if(!(-1===this.parent.maxLength||d<=this.parent.maxLength||13!==e.args.keyCode))return void e.args.preventDefault();this.parent.notify(Zi,{args:e.args})}if("space"===e.args.action){var c=this.parent.getRange(),h=c.startContainer.textContent.slice(0,c.startOffset),p=this.isOrderedList(h),u=this.isUnOrderedList(h);if(p&&!u||u&&!p){var m={callBack:null,event:e.args,name:"keydown-handler"},g={cancel:!1,item:{command:"Lists",subCommand:p?"OL":"UL"},name:"actionBegin",originalEvent:e.args,requestType:p?"OL":"UL"};this.parent.trigger(Ci,g,function(t){t.cancel||(i.parent.formatter.editorManager.observer.notify(Xr,m),i.parent.trigger(wi,{editorMode:i.parent.editorMode,elements:i.parent.formatter.editorManager.domNode.blockNodes(),event:e.args,name:wi,range:i.parent.getRange(),requestType:p?"OL":"UL"}))})}}"chrome"!==w["d"].info.name||(Object(w["T"])(this.rangeElement)||Object(w["T"])(this.oldRangeElement))&&(Object(w["T"])(this.deleteRangeElement)||Object(w["T"])(this.deleteOldRangeElement))||"TD"===t.startContainer.parentElement.tagName||"TH"===t.startContainer.parentElement.tagName||(this.rangeElement=null,this.oldRangeElement=null,this.deleteRangeElement=null,this.deleteOldRangeElement=null,this.isImageDelete||n.preventDefault(),n.preventDefault())},e.prototype.isOrderedList=function(e){e=e.replace(/\u200B/g,"");var t=[/^[1]+[.]+$/,/^[i]+[.]+$/,/^[a]+[.]+$/];if(!Object(w["T"])(e))for(var i=0;i<t.length;i++)if(t[i].test(e))return!0;return!1},e.prototype.isUnOrderedList=function(e){e=e.replace(/\u200B/g,"");var t=[/^[*]$/,/^[-]$/];if(!Object(w["T"])(e))for(var i=0;i<t.length;i++)if(t[i].test(e))return!0;return!1},e.prototype.backSpaceCleanup=function(e,t){var i=!1;if("Backspace"===e.args.code&&8===e.args.keyCode&&0===t.startOffset&&0===t.endOffset&&0===this.parent.getSelection().length&&t.startContainer.textContent.length>0&&"TD"!==t.startContainer.parentElement.tagName&&"TH"!==t.startContainer.parentElement.tagName){if(this.rangeElement=this.getRootBlockNode(t.startContainer),"OL"===this.rangeElement.tagName||"UL"===this.rangeElement.tagName){var n=this.getRangeLiNode(t.startContainer);n.previousElementSibling&&n.previousElementSibling.childElementCount>0&&(this.oldRangeElement="BR"===n.previousElementSibling.lastElementChild.nodeName?n.previousElementSibling:n.previousElementSibling.lastElementChild,Object(w["T"])(n.lastElementChild)||"BR"===n.lastElementChild.nodeName?this.rangeElement=n:(this.rangeElement=n.lastElementChild,i=!0))}else{if(this.rangeElement===this.parent.inputElement||"TABLE"===this.rangeElement.tagName||!Object(w["T"])(this.rangeElement.previousElementSibling)&&"TABLE"===this.rangeElement.previousElementSibling.tagName)return;this.oldRangeElement=this.rangeElement.previousElementSibling}if(Object(w["T"])(this.oldRangeElement))return;if("OL"!==this.oldRangeElement.tagName&&"UL"!==this.oldRangeElement.tagName||(this.oldRangeElement=this.oldRangeElement.lastElementChild.lastElementChild?this.oldRangeElement.lastElementChild.lastElementChild:this.oldRangeElement.lastElementChild),this.parent.formatter.editorManager.nodeSelection.setCursorPoint(this.parent.contentModule.getDocument(),this.oldRangeElement,this.oldRangeElement.childNodes.length),this.oldRangeElement.querySelector("BR")&&Object(w["F"])(this.oldRangeElement.querySelector("BR")),!Object(w["T"])(this.rangeElement)&&this.oldRangeElement!==this.rangeElement){while(this.rangeElement.firstChild)this.oldRangeElement.appendChild(this.rangeElement.childNodes[0]);i?Object(w["F"])(this.rangeElement.parentElement):Object(w["F"])(this.rangeElement),this.oldRangeElement.normalize()}}},e.prototype.deleteCleanup=function(e,t){var i,n,r=!1;if("Delete"===e.args.code&&46===e.args.keyCode&&0!==this.parent.contentModule.getText().trim().length&&0===this.parent.getSelection().length&&"TD"!==t.startContainer.parentElement.tagName&&"TH"!==t.startContainer.parentElement.tagName){if(this.deleteRangeElement=n=this.getRootBlockNode(t.startContainer),"OL"===this.deleteRangeElement.tagName||"UL"===this.deleteRangeElement.tagName)i=this.getRangeLiNode(t.startContainer),i.nextElementSibling&&i.nextElementSibling.childElementCount>0&&!i.nextElementSibling.querySelector("BR")?Object(w["T"])(i.lastElementChild)?this.deleteRangeElement=i:(this.deleteRangeElement=i.lastElementChild,r=!0):this.deleteRangeElement=this.getRangeElement(i);else if(3===this.deleteRangeElement.nodeType||"TABLE"===this.deleteRangeElement.tagName||!Object(w["T"])(this.deleteRangeElement.nextElementSibling)&&"TABLE"===this.deleteRangeElement.nextElementSibling.tagName)return;if(this.getCaretIndex(t,this.deleteRangeElement)===this.deleteRangeElement.textContent.length){if(Object(w["T"])(i)?this.deleteOldRangeElement=this.deleteRangeElement.nextElementSibling:r||!Object(w["T"])(i.nextElementSibling)?this.deleteOldRangeElement=this.getRangeElement(i.nextElementSibling):this.deleteOldRangeElement=n.nextElementSibling,Object(w["T"])(this.deleteOldRangeElement))return;if(0===t.startOffset&&1===t.endOffset&&"IMG"===this.deleteRangeElement.childNodes[0].nodeName?(this.parent.formatter.editorManager.nodeSelection.setSelectionText(this.parent.contentModule.getDocument(),this.deleteRangeElement,this.deleteRangeElement,0,1),this.isImageDelete=!0):(this.parent.formatter.editorManager.nodeSelection.setCursorPoint(this.parent.contentModule.getDocument(),this.deleteRangeElement,this.deleteRangeElement.childNodes.length),this.isImageDelete=!1),this.deleteRangeElement.querySelector("BR")&&Object(w["F"])(this.deleteRangeElement.querySelector("BR")),Object(w["T"])(this.deleteRangeElement)||"OL"===this.deleteOldRangeElement.tagName||"UL"===this.deleteOldRangeElement.tagName||this.deleteOldRangeElement===this.deleteRangeElement)this.deleteRangeElement=null,this.deleteOldRangeElement=null;else{while(this.deleteOldRangeElement.firstChild)this.deleteRangeElement.appendChild(this.deleteOldRangeElement.childNodes[0]);r?Object(w["F"])(this.deleteOldRangeElement.parentElement):Object(w["F"])(this.deleteOldRangeElement),this.deleteRangeElement.normalize()}}else this.deleteRangeElement=null}},e.prototype.getCaretIndex=function(e,t){var i=0;if(0!==this.parent.contentModule.getDocument().getSelection().rangeCount){var n=e.cloneRange();n.selectNodeContents(t),n.setEnd(e.endContainer,e.endOffset),i=n.toString().length}return i},e.prototype.getRangeElement=function(e){var t=e.lastElementChild?"BR"===e.lastElementChild.tagName?e.lastElementChild.previousElementSibling?e.lastElementChild.previousElementSibling:e:e.lastElementChild:e;return t},e.prototype.getRootBlockNode=function(e){for(;e&&this.parent&&this.parent.inputElement!==e;e=e){if(e.parentElement===this.parent.inputElement)break;e=e.parentElement}return e},e.prototype.getRangeLiNode=function(e){var t=e.parentElement;while(t!==this.parent.inputElement){if(1===t.nodeType&&"LI"===t.tagName)break;t=t.parentElement}return t},e.prototype.onPaste=function(e){var t=new RegExp(/([^\S]|^)(((https?\:\/\/)|(www\.))(\S+))/gi);if(e.text.match(t)){if(e.isWordPaste)return;e.args.preventDefault();for(var i=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()),n=(this.parent.formatter.editorManager.nodeSelection.save(i,this.parent.contentModule.getDocument()),new RegExp(/([^\S]|^)(((https?\:\/\/)))/gi)),r=new RegExp(/([^\S]|^)(((www\.))(\S+))/gi),s=e.text.split("\n"),a="",o=0;o<s.length;o++)if(""===s[o].trim())a+=eo(this.parent);else{for(var l="",d=!0,c=s[o].split(" "),h=0;h<c.length;h++)""===c[h].trim()?l+=d?"&nbsp;":" ":(d=!1,l+=c[h]+" ");a+=0===o?"<span>"+l.trim()+"</span>":"<p>"+l.trim()+"</p>"}var p=this.parent.createElement("div");p.setAttribute("class","pasteContent"),p.style.display="inline",p.innerHTML=a.replace("&para","&amp;para");var u=p.querySelectorAll("span, p");for(o=0;o<u.length;o++){var m=u[o].innerHTML.split(" "),g="";for(h=0;h<m.length;h++)m[h].match(n)||m[h].match(r)?g+='<a className="e-rte-anchor" href="'+m[h]+'" title="'+m[h]+'"target="_blank">'+m[h]+" </a>":g+=m[h]+" ";u[o].innerHTML=g.trim()}Object(w["T"])(this.parent.pasteCleanupModule)?this.parent.formatter.editorManager.execCommand("insertHTML",null,null,null,p):e.callBack(p.innerHTML)}},e.prototype.spaceLink=function(e){var t=this.nodeSelectionObj.getRange(this.contentRenderer.getDocument()),i=this.nodeSelectionObj.getParentNodeCollection(t),n=t.startContainer.textContent.substr(0,t.endOffset),r=n.split(" "),s=r[r.length-1],a=t.startOffset-(n.length-r[r.length-1].length);s=s.slice(0,a);var o=new RegExp(/([^\S]|^)(((https?\:\/\/)|(www\.))(\S+))/gi);if("A"!==i[0].nodeName&&s.match(o)){var l=this.nodeSelectionObj.save(t,this.parent.contentModule.getDocument()),d=s.indexOf("http")>-1?s:"http://"+s,c=this.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(t),h={url:d,selection:l,selectParent:c,text:s,title:"",target:"_blank"};this.parent.formatter.process(this.parent,{item:{command:"Links",subCommand:"CreateLink"}},e,h)}},e.prototype.onToolbarClick=function(e){var t,i,n,r=e.item,s=Object(w["A"])(e.originalEvent.target,".e-rte-quick-popup");if(s&&!s.classList.contains("e-rte-inline-popup")){if("SourceCode"!==r.subCommand&&"Preview"!==r.subCommand&&"FontColor"!==r.subCommand&&"BackgroundColor"!==r.subCommand){Dl()&&"Images"===r.command&&this.nodeSelectionObj.restore();var a=this.nodeSelectionObj.getRange(this.parent.contentModule.getDocument());t=this.nodeSelectionObj.save(a,this.parent.contentModule.getDocument()),i=this.nodeSelectionObj.getNodeCollection(a),n=this.nodeSelectionObj.getParentNodeCollection(a)}"Images"===r.command&&this.parent.notify(ui,{member:"image",args:e,selectNode:i,selection:t,selectParent:n}),"Links"===r.command&&this.parent.notify(mi,{member:"link",args:e,selectNode:i,selection:t,selectParent:n}),"Table"===r.command&&this.parent.notify(Xi,{member:"table",args:e,selectNode:i,selection:t,selectParent:n})}else{var o=document.getElementById(this.parent.getID()+"_rtelink"),l=document.getElementById(this.parent.getID()+"_image");if("SourceCode"!==r.subCommand&&"Preview"!==r.subCommand&&"FontColor"!==r.subCommand&&"BackgroundColor"!==r.subCommand){a=this.nodeSelectionObj.getRange(this.parent.contentModule.getDocument());Object(w["T"])(o)&&Object(w["T"])(l)&&(t=this.nodeSelectionObj.save(a,this.parent.contentModule.getDocument())),i=this.nodeSelectionObj.getNodeCollection(a),n=this.nodeSelectionObj.getParentNodeCollection(a)}switch(r.subCommand){case"Maximize":this.parent.notify(li,{args:e});break;case"Minimize":this.parent.notify(di,{args:e});break;case"CreateLink":this.parent.notify(fi,{member:"link",args:e,selectNode:i,selection:t,selectParent:n});break;case"RemoveLink":this.parent.notify(bi,{member:"link",args:e,selectNode:i,selection:t,selectParent:n});break;case"Print":this.parent.print();break;case"Image":this.parent.notify(ki,{member:"image",args:e,selectNode:i,selection:t,selectParent:n});break;case"CreateTable":this.parent.notify(Ki,{member:"table",args:e,selection:t});break;case"SourceCode":this.parent.notify(ji,{member:"viewSource",args:e});break;case"Preview":this.parent.notify(Ri,{member:"updateSource",args:e});break;case"FontColor":case"BackgroundColor":break;case"File":this.parent.notify(pn,{member:"fileManager",args:e,selectNode:i,selection:t,selectParent:n});break;default:this.parent.formatter.process(this.parent,e,e.originalEvent,null);break}}},e.prototype.renderColorPicker=function(e){this.colorPickerModule.renderColorPickerInput(e)},e.prototype.instantiateRenderer=function(){this.parent.iframeSettings.enable?this.renderFactory.addRenderer(ve.Content,new Kd(this.parent,this.locator)):this.renderFactory.addRenderer(ve.Content,new Ud(this.parent,this.locator))},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Ut,this.render),this.parent.off(ii,this.onPropertyChanged),this.parent.off(Zt,this.onToolbarClick),this.parent.off(Yt,this.renderColorPicker),this.parent.off(Wt,this.destroy),this.parent.off(ri,this.onKeyDown),this.parent.off(zt,this.instantiateRenderer),this.parent.off(qi,this.selectAll),this.parent.off(zi,this.selectRange),this.parent.off(_i,this.getSelectedHtml),this.parent.off(Ei,this.onSelectionSave),this.parent.off(Ii,this.onSelectionRestore),this.parent.off(Qi,this.updateReadOnly),this.parent.off(Gi,this.onPaste))},e.prototype.render=function(){this.contentRenderer=this.renderFactory.getRenderer(ve.Content);var e=this.contentRenderer.getEditPanel(),t={undoRedoSteps:this.parent.undoRedoSteps,undoRedoTimer:this.parent.undoRedoTimer};if(Object(w["T"])(this.parent.formatter)){var i=new Vd({currentDocument:this.contentRenderer.getDocument(),element:e,options:t});this.parent.setProperties({formatter:i},!0)}else this.parent.formatter.updateFormatter(e,this.contentRenderer.getDocument(),t);this.parent.enableXhtml&&this.parent.notify(cn,{}),this.parent.toolbarSettings.enable&&(this.toolbarUpdate=new _d(this.parent)),this.parent.inlineMode.enable&&(Object(w["T"])(this.parent.fontFamily.default)||(e.style.fontFamily=this.parent.fontFamily.default),Object(w["T"])(this.parent.fontSize.default)||(e.style.fontSize=this.parent.fontSize.default)),this.parent.notify(Qt,{})},e.prototype.onPropertyChanged=function(e){if(!Object(w["T"])(e.newProp.formatter)){var t=this.contentRenderer.getEditPanel(),i={undoRedoSteps:this.parent.undoRedoSteps,undoRedoTimer:this.parent.undoRedoTimer};this.parent.formatter.updateFormatter(t,this.contentRenderer.getDocument(),i)}},e.prototype.getModuleName=function(){return"htmlEditor"},e.prototype.selectAll=function(){var e=Ja(this.parent.contentModule.getDocument(),this.parent.contentModule.getEditPanel());e.length>0&&this.parent.formatter.editorManager.nodeSelection.setSelectionText(this.parent.contentModule.getDocument(),e[0],e[e.length-1],0,e[e.length-1].textContent.length)},e.prototype.selectRange=function(e){this.parent.formatter.editorManager.nodeSelection.setRange(this.parent.contentModule.getDocument(),e.range)},e.prototype.getSelectedHtml=function(e){e.callBack(this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()).toString())},e}(),Qd=i("61be"),Yd=function(){function e(e,t){this.parent=e,this.locator=t,this.isDOMElement=!1,this.renderFactory=this.locator.getService("rendererFactory"),this.contentRenderer=this.renderFactory.getRenderer(ve.Content),this.popupRenderer=this.renderFactory.getRenderer(ve.Popup),this.dropDownButtons=new kl(this.parent,this.locator),this.colorPickerObj=new $d(this.parent,this.locator)}return e.prototype.appendPopupContent=function(){this.toolbarElement=this.parent.createElement("div",{className:An}),this.element.appendChild(this.toolbarElement)},e.prototype.render=function(e){var t;t="Image"===e.popupType?qn:"Inline"===e.popupType?zn:"";var i=Object(w["Q"])(e.popupType+"_Quick_Popup");this.stringItems=e.toolbarItems,this.element=this.parent.createElement("div",{id:i,className:t+" "+cr}),this.element.setAttribute("aria-owns",this.parent.getID()),this.appendPopupContent(),this.createToolbar(e.toolbarItems,e.mode,e.cssClass),this.popupRenderer.renderPopup(this),this.addEventListener()},e.prototype.createToolbar=function(e,t,i){this.quickTBarObj=new Tl(this.parent,this.locator),this.quickTBarObj.render({container:"quick",target:this.toolbarElement,items:e,mode:t,cssClass:i}),this.quickTBarObj.toolbarObj.refresh()},e.prototype.setPosition=function(e){var t,i,n=Object(w["A"])(e.target,".e-img-caption"),r=Object(w["T"])(n)?e.target:n;Object(w["u"])([this.toolbarElement],[tr]);var s=r.offsetTop,a=window.pageYOffset+e.parentData.top;i=s-e.editTop>e.popHeight?a+e.tBarElementHeight+(s-e.editTop)-e.popHeight-5:e.editTop+e.editHeight-(s+r.offsetHeight)>e.popHeight?a+e.tBarElementHeight+(s-e.editTop)+r.offsetHeight+5:e.y,t=r.offsetWidth>e.popWidth?r.offsetWidth/2-e.popWidth/2+e.parentData.left+r.offsetLeft:e.parentData.left+r.offsetLeft,this.popupObj.position.X=t+e.popWidth>e.parentData.right?e.parentData.right-e.popWidth:t,this.popupObj.position.Y=i>=0?i:e.y+5,this.popupObj.dataBind(),Object(w["gb"])([this.toolbarElement],[tr])},e.prototype.checkCollision=function(e,t,i){var n,r,s=e.parentData.top,a=e.windowY+s+e.tBarElementHeight,o=[];o="document"===t?Object(Qd["c"])(e.popup):Object(Qd["c"])(e.popup,e.parentElement);for(var l=0;l<o.length;l++)switch(o[l]){case"top":r="document"===t?e.windowY:window.pageYOffset+s+e.tBarElementHeight;break;case"bottom":var d=void 0;d="document"===t?"inline"===i?e.y-e.popHeight-10:e.windowHeight-(s+e.tBarElementHeight)>e.popHeight?a-e.windowHeight>e.popHeight?a+(e.windowHeight-s)-e.popHeight:a:e.windowY+(s+e.tBarElementHeight):"IMG"!==e.target.tagName?e.parentData.bottom+window.pageYOffset-e.popHeight-10:e.parentData.bottom+window.pageYOffset-e.popHeight-5,r=d;break;case"right":n="inline"===i?window.pageXOffset+(e.windowWidth-(e.popWidth+e.bodyRightSpace+10)):e.x-e.popWidth;break;case"left":n="inline"===i?0:e.parentData.left;break}this.popupObj.position.X=n||this.popupObj.position.X,this.popupObj.position.Y=r||this.popupObj.position.Y,this.popupObj.dataBind()},e.prototype.showPopup=function(e,t,i){var n=this,r={popup:this.popupObj,cancel:!1,targetElement:i};this.parent.trigger(an,r,function(r){if(!r.cancel){var s=void 0,a=void 0,o=window.getComputedStyle(document.body),l=parseFloat(o.marginRight.split("px")[0])+parseFloat(o.paddingRight.split("px")[0]),d=window.innerHeight,c=window.innerWidth,h=n.parent.element,p=!Object(w["T"])(n.parent.getToolbar()),u=p&&n.parent.toolbarModule.getToolbarHeight(),m=p&&n.parent.toolbarModule.getExpandTBarPopHeight(),g=p?u+m:0;if(Object(w["u"])([n.element],[Yn]),w["d"].isDevice&&!Va()&&Object(w["u"])([n.parent.getToolbar()],[Yn]),n.parent.iframeSettings.enable){var f=n.contentRenderer.getPanel().contentWindow;s=f.pageYOffset,a=f.innerHeight}else{f=Object(w["A"])(i,"."+$n);s=f?f.scrollTop:0,a=f?f.offsetHeight:0}n.parent.inlineMode.enable||Object(w["A"])(i,"table")||(n.parent.disableToolbarItem(n.parent.toolbarSettings.items),n.parent.enableToolbarItem(["Undo","Redo"])),Object(w["v"])([n.element],document.body),n.popupObj.position.X=e+20,n.popupObj.position.Y=t+20,n.popupObj.dataBind(),n.popupObj.element.classList.add("e-popup-open"),n.dropDownButtons.renderDropDowns({container:n.toolbarElement,containerType:"quick",items:n.stringItems}),n.colorPickerObj.renderColorPickerInput({container:n.toolbarElement,containerType:"quick",items:n.stringItems});var b={x:e,y:t,target:i,editTop:s,editHeight:a,popup:n.popupObj.element,popHeight:n.popupObj.element.offsetHeight,popWidth:n.popupObj.element.offsetWidth,parentElement:h,bodyRightSpace:l,windowY:window.pageYOffset,windowHeight:d,windowWidth:c,parentData:h.getBoundingClientRect(),tBarElementHeight:g};"IMG"===i.tagName&&n.setPosition(b),n.parent.inlineMode.enable||n.checkCollision(b,"parent",""),n.checkCollision(b,"document",n.parent.inlineMode.enable?"inline":""),n.popupObj.element.classList.remove("e-popup-open"),Object(w["gb"])([n.element],[Yn]),n.popupObj.show({name:"ZoomIn",duration:w["d"].isIE?250:400}),n.popupObj&&n.parent.cssClass&&(Object(w["gb"])([n.popupObj.element],n.parent.cssClass),Object(w["u"])([n.popupObj.element],n.parent.cssClass)),Object(w["mb"])(n.element,{maxWidth:window.outerWidth+"px"}),Object(w["u"])([n.element],[Bn]),n.isDOMElement=!0}})},e.prototype.hidePopup=function(){var e=this.parent.sourceCodeModule.getViewPanel();w["d"].isDevice&&!Va()&&Object(w["gb"])([this.parent.getToolbar()],[Yn]),Object(w["T"])(this.parent.getToolbar())||this.parent.inlineMode.enable||(Object(w["T"])(e)||"none"===e.style.display)&&this.parent.enableToolbarItem(this.parent.toolbarSettings.items),this.removeEleFromDOM(),this.isDOMElement=!1},e.prototype.addQTBarItem=function(e,t){this.quickTBarObj.toolbarObj.addItems(this.quickTBarObj.getItems(e,"toolbar"),t)},e.prototype.removeQTBarItem=function(e){this.quickTBarObj.toolbarObj.removeItems(e)},e.prototype.removeEleFromDOM=function(){var e=this.popupObj.element;if(this.isDOMElement){this.dropDownButtons.destroyDropDowns(),this.colorPickerObj.destroyColorPicker(),Object(w["gb"])([this.element],[Bn]),Object(w["F"])(e);var t=this.popupObj;this.parent.trigger(ln,t)}},e.prototype.updateStatus=function(e){var t={args:e,dropDownModule:this.dropDownButtons,parent:this.parent,tbElements:Object(w["kb"])("."+Xn,this.element),tbItems:this.quickTBarObj.toolbarObj.items};Ua(t,!0,this.parent),Object(w["jb"])(".e-rte-srctextarea",this.parent.element)||Ka(this.parent.getBaseToolbarObject(),this.parent.formatter.editorManager.undoRedoManager.getUndoStatus())},e.prototype.destroy=function(){this.popupObj&&!this.popupObj.isDestroyed&&(this.popupObj.destroy(),this.removeEleFromDOM()),this.removeEventListener()},e.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(Wt,this.destroy,this),this.parent.on(ii,this.onPropertyChanged,this),this.parent.inlineMode.enable&&this.parent.on(Jt,this.updateStatus,this))},e.prototype.onPropertyChanged=function(e){if(!Object(w["T"])(e.newProp.inlineMode))for(var t=0,i=Object.keys(e.newProp.inlineMode);t<i.length;t++){var n=i[t];switch(n){case"enable":e.newProp.inlineMode.enable?this.parent.on(Jt,this.updateStatus,this):this.parent.off(Jt,this.updateStatus);break}}},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Wt,this.destroy),this.parent.off(ii,this.onPropertyChanged),this.parent.inlineMode.enable&&this.parent.off(Jt,this.updateStatus))},e}(),Zd=function(){function e(e){this.parent=e}return e.prototype.quickToolbarOpen=function(){var e=this.popupObj;this.parent.trigger(on,e)},e.prototype.renderPopup=function(e){this.setPanel(e.element),this.renderPanel(),e.popupObj=new Vt["a"](e.element,{targetType:"relative",relateTo:this.parent.element,open:this.quickToolbarOpen.bind(this)}),this.popupObj=e.popupObj,e.popupObj.hide()},e.prototype.renderPanel=function(){this.getPanel().classList.add(Hn)},e.prototype.getPanel=function(){return this.popupPanel},e.prototype.setPanel=function(e){this.popupPanel=e},e}(),ec=function(){function e(e,t){this.parent=e,this.locator=t,this.renderFactory=this.locator.getService("rendererFactory"),this.renderFactory.addRenderer(ve.Popup,new Zd(this.parent)),this.addEventListener()}return e.prototype.formatItems=function(e){var t=[];return e.forEach(function(e){if("string"===typeof e)switch(e.toLocaleLowerCase()){case"open":t.push("openLink");break;case"edit":t.push("editLink");break;case"unlink":t.push("removeLink");break;default:t.push(e);break}else t.push(e)}),t},e.prototype.getQTBarOptions=function(e,t,i,n){return{popupType:e,toolbarItems:i,mode:t,renderType:n,cssClass:this.parent.cssClass}},e.prototype.createQTBar=function(e,t,i,n){if(i.length<1)return null;var r=new Yd(this.parent,this.locator);return r.render(this.getQTBarOptions(e,t,this.formatItems(i),n)),r},e.prototype.initializeQuickToolbars=function(){this.parent.quickToolbarModule=this,this.contentRenderer=this.renderFactory.getRenderer(ve.Content),this.parent.inlineMode.enable&&this.parent.inlineMode.onSelection&&Va()&&w["l"].add(this.contentRenderer.getDocument(),"selectionchange",this.selectionChangeHandler,this)},e.prototype.onMouseDown=function(e){this.parent.isBlur=!1,this.parent.isRTE=!0},e.prototype.keyUpQT=function(e){27==e.which&&this.hideQuickToolbars()},e.prototype.renderQuickToolbars=function(){this.linkQTBar||this.imageQTBar||this.textQTBar||this.tableQTBar||(this.linkQTBar=this.createQTBar("Link","Scrollable",this.parent.quickToolbarSettings.link,ve.LinkToolbar),this.renderFactory.addRenderer(ve.LinkToolbar,this.linkQTBar),this.textQTBar=this.createQTBar("Text","Scrollable",this.parent.quickToolbarSettings.text,ve.TextToolbar),this.renderFactory.addRenderer(ve.TextToolbar,this.textQTBar),this.imageQTBar=this.createQTBar("Image","MultiRow",this.parent.quickToolbarSettings.image,ve.ImageToolbar),this.renderFactory.addRenderer(ve.ImageToolbar,this.imageQTBar),this.tableQTBar=this.createQTBar("Table","MultiRow",this.parent.quickToolbarSettings.table,ve.TableToolbar),this.renderFactory.addRenderer(ve.TableToolbar,this.tableQTBar),this.linkQTBar&&(w["l"].add(this.linkQTBar.element,"mousedown",this.onMouseDown,this),w["l"].add(this.linkQTBar.element,"keyup",this.keyUpQT,this)),this.imageQTBar&&(w["l"].add(this.imageQTBar.element,"mousedown",this.onMouseDown,this),w["l"].add(this.imageQTBar.element,"keyup",this.keyUpQT,this)),this.textQTBar&&(w["l"].add(this.textQTBar.element,"mousedown",this.onMouseDown,this),w["l"].add(this.textQTBar.element,"keyup",this.keyUpQT,this)),this.tableQTBar&&(w["l"].add(this.tableQTBar.element,"mousedown",this.onMouseDown,this),w["l"].add(this.tableQTBar.element,"keyup",this.keyUpQT,this)))},e.prototype.renderInlineQuickToolbar=function(){!this.parent.inlineMode.enable||w["d"].isDevice&&!Va()||(Object(w["u"])([this.parent.element],[Pn]),this.inlineQTBar=this.createQTBar("Inline","MultiRow",this.parent.toolbarSettings.items,ve.InlineToolbar),this.renderFactory.addRenderer(ve.InlineToolbar,this.inlineQTBar),w["l"].add(this.inlineQTBar.element,"mousedown",this.onMouseDown,this),w["l"].add(this.inlineQTBar.element,"keyup",this.keyUpQT,this))},e.prototype.showInlineQTBar=function(e,t,i){this.parent.readonly||"img"===i.tagName.toLowerCase()||this.inlineQTBar.showPopup(e,t,i)},e.prototype.hideInlineQTBar=function(){this.inlineQTBar&&!Fa(this.inlineQTBar.element,"e-popup-close")&&this.inlineQTBar.hidePopup()},e.prototype.hideQuickToolbars=function(){this.linkQTBar&&!Fa(this.linkQTBar.element,"e-popup-close")&&document.body.contains(this.linkQTBar.element)&&this.linkQTBar.hidePopup(),this.textQTBar&&!Fa(this.textQTBar.element,"e-popup-close")&&document.body.contains(this.textQTBar.element)&&this.textQTBar.hidePopup(),this.imageQTBar&&!Fa(this.imageQTBar.element,"e-popup-close")&&document.body.contains(this.imageQTBar.element)&&this.imageQTBar.hidePopup(),this.tableQTBar&&!Fa(this.tableQTBar.element,"e-popup-close")&&document.body.contains(this.tableQTBar.element)&&this.tableQTBar.hidePopup(),!this.parent.inlineMode.enable||w["d"].isDevice&&!Va()||this.hideInlineQTBar()},e.prototype.deBounce=function(e,t,i){var n=this;clearTimeout(this.deBouncer),this.deBouncer=window.setTimeout(function(){n.showInlineQTBar(e,t,i)},1e3)},e.prototype.mouseUpHandler=function(e){if(this.parent.inlineMode.enable&&(!w["d"].isDevice||Va())){var t=e.args.touches?e.args.changedTouches[0]:e.args,i=this.parent.getRange(),n=e.args.target;if(Object(w["T"])(Object(w["jb"])("."+zn,document.body))){if(Va()&&e.touchData&&e.touchData.prevClientX!==e.touchData.clientX&&e.touchData.prevClientY!==e.touchData.clientY)return;this.hideInlineQTBar();var r=this.parent.element.getBoundingClientRect().left;if(this.offsetX=this.parent.iframeSettings.enable?window.pageXOffset+r+t.clientX:t.pageX,this.offsetY=za(t,this.parent.element,this.parent.iframeSettings.enable),"TEXTAREA"===n.nodeName)this.showInlineQTBar(this.offsetX,this.offsetY,n);else{var s=Object(w["A"])(n,"a");n=s||n;var a=this.parent.getRange().startContainer.parentElement,o=this.parent.getRange().endContainer.parentElement;if((Object(w["T"])(Object(w["A"])(a,"A"))||Object(w["T"])(Object(w["A"])(o,"A")))&&(!Object(w["A"])(n,"td,th")||!i.collapsed)&&("IMG"!==n.tagName||this.parent.getRange().startOffset!==this.parent.getRange().endOffset)){if(this.parent.inlineMode.onSelection&&i.collapsed)return;this.target=n,this.showInlineQTBar(this.offsetX,this.offsetY,n)}}}}},e.prototype.keyDownHandler=function(){!this.parent.inlineMode.enable||w["d"].isDevice&&!Va()||Object(w["T"])(Object(w["jb"])("."+zn,document))||this.hideInlineQTBar()},e.prototype.inlineQTBarMouseDownHandler=function(){!this.parent.inlineMode.enable||w["d"].isDevice&&!Va()||Object(w["T"])(Object(w["jb"])("."+zn,document))||this.hideInlineQTBar()},e.prototype.keyUpHandler=function(e){if(this.parent.inlineMode.enable&&!w["d"].isDevice){if(this.parent.inlineMode.onSelection)return;var t=e.args;this.deBounce(this.offsetX,this.offsetY,t.target)}},e.prototype.selectionChangeHandler=function(e){var t=this;clearTimeout(this.deBouncer),this.deBouncer=window.setTimeout(function(){t.onSelectionChange(e)},1e3)},e.prototype.onSelectionChange=function(e){if(Object(w["T"])(Object(w["jb"])("."+zn,document.body))){var t=this.contentRenderer.getDocument().getSelection();t.isCollapsed||this.mouseUpHandler({args:e})}},e.prototype.getInlineBaseToolbar=function(){return this.inlineQTBar&&this.inlineQTBar.quickTBarObj},e.prototype.destroy=function(){this.linkQTBar&&(w["l"].remove(this.linkQTBar.element,"mousedown",this.onMouseDown),w["l"].remove(this.linkQTBar.element,"keyup",this.keyUpQT),this.linkQTBar.destroy()),this.textQTBar&&(w["l"].remove(this.textQTBar.element,"mousedown",this.onMouseDown),w["l"].remove(this.textQTBar.element,"keyup",this.keyUpQT),this.textQTBar.destroy()),this.imageQTBar&&(w["l"].remove(this.imageQTBar.element,"mousedown",this.onMouseDown),w["l"].remove(this.imageQTBar.element,"keyup",this.keyUpQT),this.imageQTBar.destroy()),this.tableQTBar&&(w["l"].remove(this.tableQTBar.element,"mousedown",this.onMouseDown),w["l"].remove(this.tableQTBar.element,"keyup",this.keyUpQT),this.tableQTBar.destroy()),this.inlineQTBar&&(w["l"].remove(this.inlineQTBar.element,"mousedown",this.onMouseDown),w["l"].remove(this.inlineQTBar.element,"keyup",this.keyUpQT),Va()&&w["l"].remove(document,"selectionchange",this.selectionChangeHandler),this.inlineQTBar.destroy()),this.removeEventListener()},e.prototype.wireInlineQTBarEvents=function(){this.parent.on(si,this.mouseUpHandler,this),this.parent.on(Pi,this.inlineQTBarMouseDownHandler,this),this.parent.on(ri,this.keyDownHandler,this),this.parent.on(ni,this.keyUpHandler,this),this.parent.on(Li,this.mouseUpHandler,this),this.parent.on(Ui,this.renderInlineQuickToolbar,this)},e.prototype.unWireInlineQTBarEvents=function(){this.parent.off(si,this.mouseUpHandler),this.parent.off(Pi,this.inlineQTBarMouseDownHandler),this.parent.off(ri,this.keyDownHandler),this.parent.off(ni,this.keyUpHandler),this.parent.off(Li,this.mouseUpHandler),this.parent.off(Ui,this.renderInlineQuickToolbar)},e.prototype.toolbarUpdated=function(e){this.linkQTBar&&!Fa(this.linkQTBar.element,"e-popup-close")&&this.linkQTBar.hidePopup(),this.imageQTBar&&!Fa(this.imageQTBar.element,"e-popup-close")&&this.imageQTBar.hidePopup(),this.tableQTBar&&!Fa(this.tableQTBar.element,"e-popup-close")&&this.tableQTBar.hidePopup()},e.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(Ut,this.initializeQuickToolbars,this),this.parent.on(Pi,this.renderQuickToolbars,this),this.parent.on(Jt,this.toolbarUpdated,this),this.parent.on(dn,this.renderQuickToolbars,this),this.wireInlineQTBarEvents(),this.parent.on(ii,this.onPropertyChanged,this),"hide"===this.parent.quickToolbarSettings.actionOnScroll&&(this.parent.on(Ai,this.hideQuickToolbars,this),this.parent.on(Bi,this.hideQuickToolbars,this)),this.parent.on(Vi,this.hideQuickToolbars,this),this.parent.on(Gt,this.onIframeMouseDown,this),this.parent.on(Wt,this.destroy,this),this.parent.on(ri,this.onKeyDown,this),this.parent.on(Wi,this.setRtl,this),this.parent.on(wn,this.setCssClass,this))},e.prototype.onKeyDown=function(e){var t=e.args;8!==t.which&&46!==t.which||this.imageQTBar&&!Fa(this.imageQTBar.element,"e-popup-close")&&this.imageQTBar.hidePopup()},e.prototype.onIframeMouseDown=function(){this.hideQuickToolbars(),this.hideInlineQTBar()},e.prototype.updateCss=function(e,t){e&&t.cssClass&&(Object(w["T"])(t.oldCssClass&&e.quickTBarObj.toolbarObj.cssClass!==t.cssClass)?e.quickTBarObj.toolbarObj.setProperties({cssClass:(e.quickTBarObj.toolbarObj.cssClass+" "+t.cssClass).trim()}):e.quickTBarObj.toolbarObj.setProperties({cssClass:(e.quickTBarObj.toolbarObj.cssClass.replace(t.oldCssClass,"").trim()+" "+t.cssClass).trim()}))},e.prototype.setCssClass=function(e){for(var t=[this.inlineQTBar,this.imageQTBar,this.linkQTBar,this.textQTBar,this.tableQTBar],i=0;i<t.length;i++)this.updateCss(t[i],e)},e.prototype.setRtl=function(e){this.inlineQTBar&&this.inlineQTBar.quickTBarObj.toolbarObj.setProperties({enableRtl:e.enableRtl}),this.imageQTBar&&this.imageQTBar.quickTBarObj.toolbarObj.setProperties({enableRtl:e.enableRtl}),this.linkQTBar&&this.linkQTBar.quickTBarObj.toolbarObj.setProperties({enableRtl:e.enableRtl})},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Ut,this.initializeQuickToolbars),this.parent.off(Pi,this.renderQuickToolbars),this.parent.off(Jt,this.toolbarUpdated),this.parent.off(dn,this.renderQuickToolbars),this.unWireInlineQTBarEvents(),this.parent.off(ii,this.onPropertyChanged),"hide"===this.parent.quickToolbarSettings.actionOnScroll&&(this.parent.off(Ai,this.hideQuickToolbars),this.parent.off(Bi,this.hideQuickToolbars)),this.parent.off(Vi,this.hideQuickToolbars),this.parent.off(Wt,this.destroy),this.parent.off(Gt,this.onIframeMouseDown),this.parent.off(ri,this.onKeyDown),this.parent.off(Wi,this.setRtl),this.parent.off(wn,this.setCssClass))},e.prototype.onPropertyChanged=function(e){if(!Object(w["T"])(e.newProp.quickToolbarSettings))for(var t=0,i=Object.keys(e.newProp.quickToolbarSettings);t<i.length;t++){var n=i[t];switch(n){case"actionOnScroll":"none"===e.newProp.quickToolbarSettings.actionOnScroll?(this.parent.off(Ai,this.hideQuickToolbars),this.parent.off(Bi,this.hideQuickToolbars)):(this.parent.on(Ai,this.hideQuickToolbars,this),this.parent.on(Bi,this.hideQuickToolbars,this));break}}e.module===this.getModuleName()&&(this.inlineQTBar&&(Object(w["gb"])([this.parent.element],[Pn]),this.unWireInlineQTBarEvents(),this.hideInlineQTBar()),!this.parent.inlineMode.enable||w["d"].isDevice&&!Va()||(Object(w["u"])([this.parent.element],[Pn]),this.wireInlineQTBarEvents()))},e.prototype.getModuleName=function(){return"quickToolbar"},e}(),tc=function(){function e(e,t){this.parent=e,this.locator=t,this.renderFactory=this.locator.getService("rendererFactory"),this.addEventListener()}return e.prototype.initializeInstance=function(){this.contentRenderer=this.renderFactory.getRenderer(ve.Content),this.editPanel=this.contentRenderer.getEditPanel(),this.addEventListener()},e.prototype.renderCount=function(){this.initializeInstance(),this.element=this.parent.createElement("span",{className:rr}),this.contentRenderer.getPanel().parentElement.appendChild(this.element),this.appendCount(),-1!==this.parent.maxLength&&this.charCountBackground(this.htmlLength)},e.prototype.appendCount=function(){var e="Markdown"===this.parent.editorMode?this.editPanel.value:this.editPanel.textContent;"Markdown"!==this.parent.editorMode&&-1!==e.indexOf("​")?this.htmlLength=e.replace(/\u200B/g,"").length:this.htmlLength=e.length;var t=-1===this.parent.maxLength?this.htmlLength:this.htmlLength+" / "+this.parent.maxLength;this.element.innerHTML=t},e.prototype.charCountBackground=function(e){var t=e/this.parent.maxLength*100;t<85?(this.element.classList.remove(sr),this.element.classList.remove(ar)):t>85&&t<=90?(this.element.classList.remove(ar),this.element.classList.add(sr)):t>90&&(this.element.classList.remove(sr),this.element.classList.add(ar))},e.prototype.refresh=function(){Object(w["T"])(this.editPanel)||(this.appendCount(),-1!==this.parent.maxLength&&this.charCountBackground(this.htmlLength))},e.prototype.destroy=function(){this.element&&!Object(w["T"])(this.parent.element.querySelector("."+rr))&&Object(w["F"])(this.element),this.removeEventListener()},e.prototype.toggle=function(e){this.element.style.display="viewSource"===e.member?"none":"block"},e.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(Ut,this.renderCount,this),this.parent.on(ni,this.refresh,this),this.parent.on(Mi,this.refresh,this),this.parent.on(Xt,this.refresh,this),this.parent.on(Pi,this.refresh,this),this.parent.on(Wt,this.destroy,this),this.parent.on(ji,this.toggle,this),this.parent.on(Ri,this.toggle,this))},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Ut,this.renderCount),this.parent.off(ni,this.refresh),this.parent.off(Xt,this.refresh),this.parent.off(Mi,this.refresh),this.parent.off(Pi,this.refresh),this.parent.off(Wt,this.destroy),this.parent.off(ji,this.toggle),this.parent.off(Ri,this.toggle))},e.prototype.getModuleName=function(){return"count"},e}(),ic="e-error",nc="e-input-group",rc="e-float-input",sc="e-label-top",ac="e-label-bottom",oc={0:"[0-9]",9:"[0-9 ]","#":"[0-9 +-]",L:"[A-Za-z]","?":"[A-Za-z ]","&":"[^ ]+",C:"[^]+",A:"[A-Za-z0-9]",a:"[A-Za-z0-9 ]"};function lc(){if(Object(w["w"])(this.element,{role:"textbox",autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false","aria-live":"assertive","aria-valuenow":""}),this.mask){for(var e=this.mask.split("]"),t=0;t<e.length;t++)if("\\"===e[t][e[t].length-1]){e[t]=e[t]+"]";for(var i=e[t].split("["),n=0;n<i.length;n++)"\\"===i[n][i[n].length-1]&&(i[n]=i[n]+"["),vc.call(this,i[n])}else{i=e[t].split("[");if(i.length>1){var r=!1;for(n=0;n<i.length;n++)"\\"===i[n]?(this.customRegExpCollec.push("["),this.hiddenMask+=i[n]+"["):""===i[n]?r=!0:""!==i[n]&&r||n===i.length-1?(this.customRegExpCollec.push("["+i[n]+"]"),this.hiddenMask+=this.promptChar,r=!1):vc.call(this,i[n])}else vc.call(this,i[0])}if(this.escapeMaskValue=this.hiddenMask,this.promptMask=this.hiddenMask.replace(/[09?LCAa#&]/g,this.promptChar),!Object(w["T"])(this.customCharacters))for(t=0;t<this.promptMask.length;t++)Object(w["T"])(this.customCharacters[this.promptMask[t]])||(this.promptMask=this.promptMask.replace(new RegExp(this.promptMask[t],"g"),this.promptChar));var s=0;if(this.hiddenMask.match(new RegExp(/\\/)))for(t=0;t<this.hiddenMask.length;t++){n=0;t>=1&&(n=t),s=this.hiddenMask.length-this.promptMask.length,n-=s,t>0&&"\\"!==this.hiddenMask[t-1]&&(">"===this.hiddenMask[t]||"<"===this.hiddenMask[t]||"|"===this.hiddenMask[t])&&(this.promptMask=this.promptMask.substring(0,n)+this.promptMask.substring(t+1-s,this.promptMask.length),this.escapeMaskValue=this.escapeMaskValue.substring(0,n)+this.escapeMaskValue.substring(t+1-s,this.escapeMaskValue.length)),"\\"===this.hiddenMask[t]&&(this.promptMask=this.promptMask.substring(0,n)+this.hiddenMask[t+1]+this.promptMask.substring(t+2-s,this.promptMask.length),this.escapeMaskValue=this.escapeMaskValue.substring(0,n)+this.escapeMaskValue[t+1]+this.escapeMaskValue.substring(t+2-s,this.escapeMaskValue.length))}else this.promptMask=this.promptMask.replace(/[>|<]/g,""),this.escapeMaskValue=this.hiddenMask.replace(/[>|<]/g,"");Object(w["w"])(this.element,{"aria-invalid":"false"})}}function dc(){Uc.call(this,this.promptMask),_c.call(this,this.value)}function cc(){w["l"].add(this.element,"keydown",Dc,this),w["l"].add(this.element,"keypress",Mc,this),w["l"].add(this.element,"keyup",Lc,this),w["l"].add(this.element,"input",Rc,this),w["l"].add(this.element,"focus",wc,this),w["l"].add(this.element,"blur",Tc,this),w["l"].add(this.element,"paste",kc,this),w["l"].add(this.element,"cut",Sc,this),w["l"].add(this.element,"drop",jc,this),w["l"].add(this.element,"mousedown",yc,this),w["l"].add(this.element,"mouseup",Cc,this),this.enabled&&(pc.call(this),this.formElement&&w["l"].add(this.formElement,"reset",gc,this))}function hc(){w["l"].remove(this.element,"keydown",Dc),w["l"].remove(this.element,"keypress",Mc),w["l"].remove(this.element,"keyup",Lc),w["l"].remove(this.element,"input",Rc),w["l"].remove(this.element,"focus",wc),w["l"].remove(this.element,"blur",Tc),w["l"].remove(this.element,"paste",kc),w["l"].remove(this.element,"cut",Sc),w["l"].remove(this.element,"mousedown",yc),w["l"].remove(this.element,"mouseup",Cc),this.formElement&&w["l"].remove(this.formElement,"reset",gc)}function pc(){this.showClearButton&&w["l"].add(this.inputObj.clearButton,"mousedown touchstart",uc,this)}function uc(e){e.preventDefault(),this.inputObj.clearButton.classList.contains("e-clear-icon-hide")&&!this.inputObj.container.classList.contains("e-static-clear")||(mc.call(this,e),this.value="")}function mc(e){var t=this.element.value;Uc.call(this,this.promptMask),this.redoCollec.unshift({value:this.promptMask,startIndex:this.element.selectionStart,endIndex:this.element.selectionEnd}),Pc.call(this,e,t),this.element.setSelectionRange(0,0)}function gc(){"EJS-MASKEDTEXTBOX"===this.element.tagName?Uc.call(this,this.promptMask):this.value=this.initInputValue}function fc(e){return e.value}function bc(e,t){var i="",n=0,r=!1,s=Object(w["T"])(t)?Object(w["T"])(e)||Object(w["T"])(this)?t:e.value:t;if(s!==this.promptMask)for(var a=0;a<this.customRegExpCollec.length;a++)r&&(r=!1),">"!==this.customRegExpCollec[n]&&"<"!==this.customRegExpCollec[n]&&"|"!==this.customRegExpCollec[n]&&"\\"!==this.customRegExpCollec[n]||(--a,r=!0),r||s[a]!==this.promptChar&&!Object(w["T"])(this.customRegExpCollec[n])&&(this._callPasteHandler||!Object(w["T"])(this.regExpCollec[this.customRegExpCollec[n]])||this.customRegExpCollec[n].length>2&&"["===this.customRegExpCollec[n][0]&&"]"===this.customRegExpCollec[n][this.customRegExpCollec[n].length-1]||!Object(w["T"])(this.customCharacters)&&!Object(w["T"])(this.customCharacters[this.customRegExpCollec[n]]))&&""!==s&&(i+=s[a]),++n;return(null===this.mask||""===this.mask&&void 0!==this.value)&&(i=s),i}function vc(e){for(var t=0;t<e.length;t++)this.hiddenMask+=e[t],"\\"!==e[t]&&this.customRegExpCollec.push(e[t])}function yc(){this.isClicked=!0}function Cc(){this.isClicked=!1}function wc(e){var t=this,i=this.element,n=0,r=bc.call(this,i),s=!1,a=!1,o={selectionStart:i.selectionStart,event:e,value:this.value,maskedValue:i.value,container:this.inputObj.container,selectionEnd:i.selectionEnd};if(this.isClicked||Oc.call(this,o,i),this.mask&&(null!==r&&""!==r||"Always"===this.floatLabelType||null===this.placeholder||""===this.placeholder||(i.value=this.promptMask),setTimeout(function(){if(i.selectionStart===t.promptMask.length||i.value[i.selectionStart]===t.promptChar)s=!0;else for(var e=i.selectionStart;e<t.promptMask.length;e++){if(i.value[e]===t.promptChar){s=!0;break}if(i.value[e]!==t.promptMask[e]){s=!1;break}}}),setTimeout(function(){var e=i.selectionStart-1;if(e===t.promptMask.length-1||i.value[e]===t.promptChar)a=!0;else for(var n=e;n>=0;n--){if(i.value[n]===t.promptChar){a=!0;break}if(i.value[n]!==t.promptMask[n]){a=!1;break}}}),this.isClicked||"Always"!==this.floatLabelType&&(null===r||""===r)&&null!==this.placeholder&&""!==this.placeholder)){for(n=0;n<this.promptMask.length;n++)if(i.value[n]===this.promptChar){setTimeout(function(){(s||a)&&(i.selectionEnd=n,i.selectionStart=n),o={selectionStart:i.selectionStart,event:e,value:t.value,maskedValue:i.value,container:t.inputObj.container,selectionEnd:i.selectionEnd},Oc.call(t,o,i)});break}Object(w["T"])(i.value.match(this.promptChar))&&(o={selectionStart:i.selectionStart,event:e,value:this.value,maskedValue:i.value,container:this.inputObj.container,selectionEnd:i.selectionEnd},Oc.call(this,o,i)),this.isClicked=!1}}function Oc(e,t){this.trigger("focus",e,function(e){t.selectionStart=e.selectionStart,t.selectionEnd=e.selectionEnd})}function Tc(e){if(this.blurEventArgs={event:e,value:this.value,maskedValue:this.element.value,container:this.inputObj.container},this.trigger("blur",this.blurEventArgs),this.mask&&(this.isFocus=!1,this.placeholder&&this.element.value===this.promptMask&&"Always"!==this.floatLabelType)){Uc.call(this,"");var t=this.element.parentNode.querySelector(".e-float-text");"Auto"===this.floatLabelType&&!Object(w["T"])(t)&&t.classList.contains(sc)&&Object(w["gb"])([t],sc)}}function kc(e){var t=this;if(this.mask&&!this.readonly){var i=this.element.selectionStart,n=this.element.selectionEnd,r=this.element.value;Uc.call(this,""),this._callPasteHandler=!0,setTimeout(function(){var s=t.element.value.replace(/ /g,"");t.redoCollec.length>0&&t.redoCollec[0].value===t.element.value&&(s=bc.call(t,t.element)),Uc.call(t,r),t.element.selectionStart=i,t.element.selectionEnd=n;var a=0;t.maskKeyPress=!0;do{Bc.call(t,s[a],!1,null),++a}while(a<s.length);if(t.maskKeyPress=!1,t._callPasteHandler=!1,t.element.value===r){var o=0;t.maskKeyPress=!0;do{Bc.call(t,s[o],!1,null),++o}while(o<s.length);t.maskKeyPress=!1}else Pc.call(t,e,r)},1)}}function Sc(e){var t=this;if(this.mask&&!this.readonly){var i=this.element.value,n=this.element.selectionStart,r=this.element.selectionEnd;this.undoCollec.push({value:this.element.value,startIndex:this.element.selectionStart,endIndex:this.element.selectionEnd});var s=this.element.value.substring(0,n)+this.promptMask.substring(n,r)+this.element.value.substring(r);setTimeout(function(){Uc.call(t,s),t.element.selectionStart=t.element.selectionEnd=n,t.element.value!==i&&Pc.call(t,e,null)},0)}}function jc(e){e.preventDefault()}function Rc(e){if(!0!==w["d"].isIE||""!==this.element.value||"Never"!==this.floatLabelType){var t={ctrlKey:!1,keyCode:229};if(Object(w["G"])(e,t),this.mask){if(""===this.element.value&&this.redoCollec.unshift({value:this.promptMask,startIndex:this.element.selectionStart,endIndex:this.element.selectionEnd}),1===this.element.value.length&&(this.element.value=this.element.value+this.promptMask,this.element.setSelectionRange(1,1)),this._callPasteHandler||xc.call(this,e),this.element.value.length>this.promptMask.length){var i=this.element.selectionStart,n=this.element.value.length-this.promptMask.length,r=this.element.value.substring(i-n,i);this.maskKeyPress=!1;var s=0;do{Bc.call(this,r[s],e.ctrlKey,e),++s}while(s<r.length);this.element.value!==this.preEleVal&&Pc.call(this,e,null)}var a=bc.call(this,this.element);this.prevValue=a,this.value=a,""===a&&(Uc.call(this,this.promptMask),this.element.setSelectionRange(0,0))}}}function Dc(e){if(this.mask&&!this.readonly){229!==e.keyCode&&(!e.ctrlKey||89!==e.keyCode&&90!==e.keyCode||e.preventDefault(),xc.call(this,e));var t=this.element.value;if(e.ctrlKey&&(89===e.keyCode||90===e.keyCode)){var i=void 0;90===e.keyCode&&this.undoCollec.length>0&&t!==this.undoCollec[this.undoCollec.length-1].value?(i=this.undoCollec[this.undoCollec.length-1],this.redoCollec.unshift({value:this.element.value,startIndex:this.element.selectionStart,endIndex:this.element.selectionEnd}),Uc.call(this,i.value),this.element.selectionStart=i.startIndex,this.element.selectionEnd=i.endIndex,this.undoCollec.splice(this.undoCollec.length-1,1)):89===e.keyCode&&this.redoCollec.length>0&&t!==this.redoCollec[0].value&&(i=this.redoCollec[0],this.undoCollec.push({value:this.element.value,startIndex:this.element.selectionStart,endIndex:this.element.selectionEnd}),Uc.call(this,i.value),this.element.selectionStart=i.startIndex,this.element.selectionEnd=i.endIndex,this.redoCollec.splice(0,1))}}}function Ec(){var e,t=this.element.selectionStart,i=this.element.selectionEnd;this.redoCollec.length>0?(e=this.redoCollec[0],Uc.call(this,e.value),e.startIndex-t===1?(this.element.selectionStart=e.startIndex,this.element.selectionEnd=e.endIndex):(this.element.selectionStart=t+1,this.element.selectionEnd=i+1)):(Uc.call(this,this.promptMask),this.element.selectionStart=this.element.selectionEnd=t)}function Ic(e,t,i){return"input"===i.type&&(e=!1,t=this.element.value,Uc.call(this,this.promptMask),_c.call(this,t)),e}function xc(e){var t,i=!1,n=!1;this.element.value.length<this.promptMask.length&&(i=!0,t=this.element.value,i=Ic.call(this,i,t,e),Ec.call(this)),this.element.value.length>=this.promptMask.length&&"input"===e.type&&(i=Ic.call(this,i,t,e));var r=this.element.selectionStart,s=this.element.selectionEnd,a=this.element.selectionStart,o=this.element.selectionEnd,l=this.hiddenMask.replace(/[>|\\<]/g,""),d=l[a-1],c=this.element.selectionEnd;if(i||8===e.keyCode||46===e.keyCode){this.undoCollec.push({value:this.element.value,startIndex:this.element.selectionStart,endIndex:o});var h=!1,p=this.element.value;if(a>0||(8===e.keyCode||46===e.keyCode)&&a<this.element.value.length&&this.element.selectionEnd-a!==this.element.value.length){var u=a;a!==o?(a=o,46===e.keyCode&&(h=!0)):46===e.keyCode?++u:--u;for(var m=a;8===e.keyCode||i||h?m>u:m<u;8===e.keyCode||i||h?m--:m++)for(var g=a;8===e.keyCode||i||h?g>0:g<this.element.value.length;8===e.keyCode||i||h?g--:g++){var f=void 0;(8===e.keyCode||h)&&(r!==s&&r!==a||r===s)||i?(d=l[g-1],f=a-1):(d=l[g],f=a,++a);var b=this.element.value[f];if(Object(w["T"])(this.regExpCollec[d])&&!Object(w["T"])(this.customCharacters)&&Object(w["T"])(this.customCharacters[d])&&this.hiddenMask[f]!==this.promptChar&&"["!==this.customRegExpCollec[f][0]&&"]"!==this.customRegExpCollec[f][this.customRegExpCollec[f].length-1]||this.promptMask[f]!==this.promptChar&&Object(w["T"])(this.customCharacters))this.element.selectionStart=this.element.selectionEnd=f,e.preventDefault(),46!==e.keyCode||h||++this.element.selectionStart;else{var v=this.element.value,y=this.promptChar,C=v.substring(0,f)+y+v.substring(a,v.length);Uc.call(this,C),e.preventDefault(),46!==e.keyCode||h||f++,this.element.selectionStart=this.element.selectionEnd=f,n=!0}if(a=this.element.selectionStart,!n&&8===e.keyCode||h||!n&&46!==e.keyCode?f=a-1:(f=a,n=!1),b=this.element.value[f],r!==s&&this.element.selectionStart===r||this.promptMask[f]===this.promptChar||b!==this.promptMask[f]&&this.promptMask[f]!==this.promptChar&&!Object(w["T"])(this.customCharacters))break}}46===e.keyCode&&h&&n&&(this.element.selectionStart=this.element.selectionEnd=c),0===this.element.selectionStart&&this.element.selectionEnd===this.element.value.length&&(Uc.call(this,this.promptMask),e.preventDefault(),this.element.selectionStart=this.element.selectionEnd=a),this.redoCollec.unshift({value:this.element.value,startIndex:this.element.selectionStart,endIndex:this.element.selectionEnd}),this.element.value!==p&&Pc.call(this,e,t)}}function Mc(e){if(this.mask&&!this.readonly){var t=this.element.value;if(!e.ctrlKey||e.ctrlKey&&"KeyA"!==e.code&&"KeyY"!==e.code&&"KeyZ"!==e.code&&"KeyX"!==e.code&&"KeyC"!==e.code&&"KeyV"!==e.code){this.maskKeyPress=!0;var i=e.key;"Spacebar"===i&&(i=String.fromCharCode(e.keyCode)),i?i&&1===i.length&&(Bc.call(this,i,e.ctrlKey,e),e.preventDefault()):(this.isIosInvalid=!0,Bc.call(this,String.fromCharCode(e.keyCode),e.ctrlKey,e),e.preventDefault(),this.isIosInvalid=!1),32===e.keyCode&&" "===i&&" "===this.promptChar&&(this.element.selectionStart=this.element.selectionEnd=this.element.selectionStart-i.length)}this.element.value!==t&&Pc.call(this,e,t)}}function Pc(e,t){var i=this.isProtectedOnChange;if(!Object(w["T"])(this.changeEventArgs)&&!this.isInitial){var n={};this.changeEventArgs={value:this.element.value,maskedValue:this.element.value,isInteraction:!1,isInteracted:!1},this.mask&&(this.changeEventArgs.value=bc.call(this,this.element)),Object(w["T"])(e)||(this.changeEventArgs.isInteracted=!0,this.changeEventArgs.isInteraction=!0,this.changeEventArgs.event=e),this.isProtectedOnChange=!0,this.value=this.changeEventArgs.value,this.isProtectedOnChange=i,Object(w["ab"])(n,this.changeEventArgs),this.isAngular&&this.preventChange?this.preventChange=!1:this.trigger("change",n)}this.preEleVal=this.element.value,this.prevValue=bc.call(this,this.element),Object(w["w"])(this.element,{"aria-valuenow":this.element.value})}function Lc(e){if(this.mask&&!this.readonly){var t=void 0;if(this.maskKeyPress||229!==e.keyCode)qc.call(this);else{var i=void 0;if(1===this.element.value.length&&(this.element.value=this.element.value+this.promptMask,this.element.setSelectionRange(1,1)),this.element.value.length>this.promptMask.length){var n=this.element.selectionStart,r=this.element.value.length-this.promptMask.length,s=this.element.value.substring(n-r,n);if(this.undoCollec.length>0){t=this.undoCollec[this.undoCollec.length-1];var a=this.element.selectionStart;i=t.value;var o=t.value.substring(a-r,a);t=this.redoCollec[0],s=s.trim();var l=w["d"].isAndroid&&""===s;l||o===s||t.value.substring(a-r,a)===s?l&&Hc.call(this,e,a-1,this.element.selectionEnd-1,s,e.ctrlKey,!1):Bc.call(this,s,e.ctrlKey,e)}else i=this.promptMask,Bc.call(this,s,e.ctrlKey,e);this.maskKeyPress=!1,Pc.call(this,e,i)}}var d=bc.call(this,this.element);(0!==this.element.selectionStart||this.promptMask!==this.element.value||""!==d||""===d&&this.value!==d)&&(this.prevValue=d,this.value=d)}else Pc.call(this,e);if(0===this.element.selectionStart&&0===this.element.selectionEnd){var c=this.element;setTimeout(function(){c.setSelectionRange(0,0)},0)}}function Nc(e){if(e.length>1&&this.promptMask.length+e.length<this.element.value.length){var t=this.redoCollec[0].value.substring(0,this.redoCollec[0].startIndex)+e+this.redoCollec[0].value.substring(this.redoCollec[0].startIndex,this.redoCollec[0].value.length);Uc.call(this,t),this.element.selectionStart=this.element.selectionEnd=this.redoCollec[0].startIndex+e.length}this.element.selectionStart=this.element.selectionStart-e.length,this.element.selectionEnd=this.element.selectionEnd-e.length}function Ac(e){this.maskKeyPress||Nc.call(this,e)}function Bc(e,t,i){if(Ac.call(this,e),!Object(w["T"])(this)&&!Object(w["T"])(e))for(var n,r,s=this.element.selectionStart,a=s,o=!1,l=this.element.value,d=!1,c=!1,h=0;h<e.length;h++){var p=e[h];if(s=this.element.selectionStart,this.maskKeyPress||a!==s||(s+=h),!this.maskKeyPress||s<this.promptMask.length){for(var u=s;u<this.promptMask.length;u++){var m=this.escapeMaskValue;n=m[s],"\\"===this.hiddenMask[s]&&this.hiddenMask[s+1]===e&&(c=!0),(Object(w["T"])(this.regExpCollec[n])&&(Object(w["T"])(this.customCharacters)||!Object(w["T"])(this.customCharacters)&&Object(w["T"])(this.customCharacters[n]))&&this.hiddenMask[s]!==this.promptChar&&"["!==this.customRegExpCollec[s][0]&&"]"!==this.customRegExpCollec[s][this.customRegExpCollec[s].length-1]||this.promptMask[s]!==this.promptChar&&Object(w["T"])(this.customCharacters)||this.promptChar===n&&this.escapeMaskValue===this.mask)&&(this.element.selectionStart=this.element.selectionEnd=s+1,s=this.element.selectionStart,n=this.hiddenMask[s])}if(Object(w["T"])(this.customCharacters)||Object(w["T"])(this.customCharacters[n]))!Object(w["T"])(this.regExpCollec[n])&&p.match(new RegExp(this.regExpCollec[n]))&&this.promptMask[s]===this.promptChar?o=!0:this.promptMask[s]===this.promptChar&&"["===this.customRegExpCollec[s][0]&&"]"===this.customRegExpCollec[s][this.customRegExpCollec[s].length-1]&&p.match(new RegExp(this.customRegExpCollec[s]))&&(o=!0);else{var g=this.customCharacters[n],f=g.split(",");for(u=0;u<f.length;u++)if(p.match(new RegExp("["+f[u]+"]"))){o=!0;break}}if((!this.maskKeyPress||s<this.hiddenMask.length)&&o){if(0===h)if(this.maskKeyPress)this.undoCollec.push({value:l,startIndex:s,endIndex:s});else{var b=this.element.selectionStart,v=this.element.selectionEnd;this.redoCollec.length>0?(r=this.redoCollec[0].value,Uc.call(this,r),this.undoCollec.push(this.redoCollec[0])):(this.undoCollec.push({value:this.promptMask,startIndex:s,endIndex:s}),r=this.promptMask,Uc.call(this,r)),this.element.selectionStart=b,this.element.selectionEnd=v}s=this.element.selectionStart,Fc.call(this,i,s,p,r,c),d=!0,h===e.length-1&&this.redoCollec.unshift({value:this.element.value,startIndex:this.element.selectionStart,endIndex:this.element.selectionEnd}),o=!1}else s=this.element.selectionStart,Hc.call(this,i,s,a,e,t,d);h!==e.length-1||o||(!w["d"].isAndroid||w["d"].isAndroid&&s<this.promptMask.length)&&this.redoCollec.unshift({value:this.element.value,startIndex:this.element.selectionStart,endIndex:this.element.selectionEnd})}else 1!==e.length||t||Object(w["T"])(i)||Vc.call(this)}}function Fc(e,t,i,n,r){if(this.hiddenMask.length>this.promptMask.length&&(i=zc.call(this,i,this.element.value)),!r){var s=this.element.value,a=s.substring(0,t)+i+s.substring(t+1,s.length);Uc.call(this,a),this.element.selectionStart=this.element.selectionEnd=t+1}}function Hc(e,t,i,n,r,s){if(!this.maskKeyPress){var a=this.element.value;t>=this.promptMask.length?Uc.call(this,a.substring(0,t)):(i===t?Uc.call(this,a.substring(0,t)+a.substring(t+1,a.length)):this.promptMask.length===this.element.value.length?Uc.call(this,a.substring(0,t)+a.substring(t,a.length)):Uc.call(this,a.substring(0,i)+a.substring(i+1,a.length)),this.element.selectionStart=this.element.selectionEnd=s||this.element.value[i]!==this.promptChar?t:i),Vc.call(this)}1!==n.length||r||Object(w["T"])(e)||Vc.call(this)}function Vc(){var e=this,t=this.element.parentNode,i=200;t.classList.contains(nc)||t.classList.contains(rc)?Object(w["u"])([t],ic):Object(w["u"])([this.element],ic),!0===this.isIosInvalid&&(i=400),Object(w["w"])(this.element,{"aria-invalid":"true"}),setTimeout(function(){e.maskKeyPress||qc.call(e)},i)}function qc(){var e=this.element.parentNode;Object(w["T"])(e)||Object(w["gb"])([e],ic),Object(w["gb"])([this.element],ic),Object(w["w"])(this.element,{"aria-invalid":"false"})}function zc(e,t){var i,n,r=t,s=0;for(n=0;n<this.hiddenMask.length;n++)if("\\"===this.hiddenMask[n]&&(i=r.substring(0,n)+"\\"+r.substring(n,r.length)),">"!==this.hiddenMask[n]&&"<"!==this.hiddenMask[n]&&"|"!==this.hiddenMask[n]||(this.hiddenMask[n]!==r[n]&&(i=r.substring(0,n)+this.hiddenMask[n]+r.substring(n,r.length)),++s),i){if(i[n]===this.promptChar&&n>this.element.selectionStart||this.element.value.indexOf(this.promptChar)<0&&this.element.selectionStart+s===n){s=0;break}r=i}while(n>=0&&i){if(0===n||"\\"!==i[n-1]){if(">"===i[n]){e=e.toUpperCase();break}if("<"===i[n]){e=e.toLowerCase();break}if("|"===i[n])break}--n}return e}function _c(e){if(this.mask&&void 0!==e&&(void 0===this.prevValue||this.prevValue!==e)){if(this.maskKeyPress=!0,Uc.call(this,this.promptMask),""===e||null===e&&"Never"===this.floatLabelType&&this.placeholder||(this.element.selectionStart=0,this.element.selectionEnd=0),null!==e)for(var t=0;t<e.length;t++)Bc.call(this,e[t],!1,null);var i=bc.call(this,this.element);this.prevValue=i,this.value=i,Pc.call(this,null,null),this.maskKeyPress=!1;var n=this.element.parentNode.querySelector(".e-float-text");this.element.value===this.promptMask&&"Auto"===this.floatLabelType&&this.placeholder&&!Object(w["T"])(n)&&n.classList.contains(sc)&&!this.isFocus&&(Object(w["gb"])([n],sc),Object(w["u"])([n],ac),Uc.call(this,""))}(null===this.mask||""===this.mask&&void 0!==this.value)&&Uc.call(this,this.value)}function Uc(e,t){!this.isFocus&&"Auto"===this.floatLabelType&&this.placeholder&&Object(w["T"])(this.value)&&(e="");var i=bc.call(this,t||this.element,e);null===i||""===i?(Io["a"].setValue(e,t||this.element,this.floatLabelType,!1),this.showClearButton&&this.inputObj.clearButton.classList.add("e-clear-icon-hide")):Io["a"].setValue(e,t||this.element,this.floatLabelType,this.showClearButton)}var Gc=function(){function e(){}return e}(),Wc=(new Gc,function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}()),Kc=function(e,t,i,n){var r,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var o=e.length-1;o>=0;o--)(r=e[o])&&(a=(s<3?r(a):s>3?r(t,i,a):r(t,i))||a);return s>3&&a&&Object.defineProperty(t,i,a),a},$c="e-control-wrapper e-mask",Xc="e-input",Jc="e-maskedtextbox",Qc="e-control",Yc="e-input-focus",Zc=["title","style","class"],eh=function(e){function t(t,i){var n=e.call(this,t,i)||this;return n.initInputValue="",n.isAngular=!1,n.preventChange=!1,n.isClicked=!1,n.maskOptions=t,n}return Wc(t,e),t.prototype.getModuleName=function(){return"maskedtextbox"},t.prototype.preRender=function(){this.promptMask="",this.hiddenMask="",this.escapeMaskValue="",this.regExpCollec=oc,this.customRegExpCollec=[],this.undoCollec=[],this.redoCollec=[],this.changeEventArgs={},this.focusEventArgs={},this.blurEventArgs={},this.maskKeyPress=!1,this.isFocus=!1,this.isInitial=!1,this.isIosInvalid=!1;var e=Object(w["R"])("ej2_instances",this.element);if(this.cloneElement=this.element.cloneNode(!0),Object(w["gb"])([this.cloneElement],[Qc,Jc,"e-lib"]),this.angularTagName=null,this.formElement=Object(w["A"])(this.element,"form"),"EJS-MASKEDTEXTBOX"===this.element.tagName){this.angularTagName=this.element.tagName;for(var t=this.createElement("input"),i=0;i<this.element.attributes.length;i++)t.setAttribute(this.element.attributes[i].nodeName,this.element.attributes[i].nodeValue),t.innerHTML=this.element.innerHTML;this.element.hasAttribute("id")&&this.element.removeAttribute("id"),this.element.classList.remove("e-control","e-maskedtextbox"),this.element.classList.add("e-mask-container"),this.element.appendChild(t),this.element=t,Object(w["ob"])("ej2_instances",e,this.element)}this.updateHTMLAttrToElement(),this.checkHtmlAttributes(!1),this.formElement&&(this.initInputValue=this.value)},t.prototype.getPersistData=function(){var e=["value"];return this.addOnPersist(e)},t.prototype.render=function(){"input"===this.element.tagName.toLowerCase()&&("Never"===this.floatLabelType&&Object(w["u"])([this.element],Xc),this.createWrapper(),this.updateHTMLAttrToWrapper(),""===this.element.name&&this.element.setAttribute("name",this.element.id),this.isInitial=!0,this.resetMaskedTextBox(),this.isInitial=!1,this.setMaskPlaceholder(!0,!1),this.setWidth(this.width),this.preEleVal=this.element.value,w["d"].isDevice||"11.0"!==w["d"].info.version&&"edge"!==w["d"].info.name||this.element.blur(),w["d"].isDevice&&w["d"].isIos&&this.element.blur(),(this.element.getAttribute("value")||this.value)&&this.element.setAttribute("value",this.element.value),this.renderComplete())},t.prototype.updateHTMLAttrToElement=function(){if(!Object(w["T"])(this.htmlAttributes))for(var e=0,t=Object.keys(this.htmlAttributes);e<t.length;e++){var i=t[e];Zc.indexOf(i)<0&&this.element.setAttribute(i,this.htmlAttributes[i])}},t.prototype.updateCssClass=function(e,t){Io["a"].setCssClass(this.getValidClassList(e),[this.inputObj.container],this.getValidClassList(t))},t.prototype.getValidClassList=function(e){var t=e;return Object(w["T"])(e)||""===e||(t=e.replace(/\s+/g," ").trim()),t},t.prototype.updateHTMLAttrToWrapper=function(){if(!Object(w["T"])(this.htmlAttributes))for(var e=0,t=Object.keys(this.htmlAttributes);e<t.length;e++){var i=t[e];if(Zc.indexOf(i)>-1)if("class"===i){var n=this.htmlAttributes[i].replace(/\s+/g," ").trim();""!==n&&Object(w["u"])([this.inputObj.container],n.split(" "))}else if("style"===i){var r=this.inputObj.container.getAttribute(i);r=Object(w["T"])(r)?this.htmlAttributes[i]:r+this.htmlAttributes[i],this.inputObj.container.setAttribute(i,r)}else this.inputObj.container.setAttribute(i,this.htmlAttributes[i])}},t.prototype.resetMaskedTextBox=function(){this.promptMask="",this.hiddenMask="",this.escapeMaskValue="",this.customRegExpCollec=[],this.undoCollec=[],this.redoCollec=[],this.promptChar.length>1&&(this.promptChar=this.promptChar[0]),lc.call(this),dc.call(this),(null===this.mask||""===this.mask&&void 0!==this.value)&&Uc.call(this,this.value);var e=bc.call(this,this.element);this.prevValue=e,this.value=e,this.isInitial||hc.call(this),cc.call(this)},t.prototype.setMaskPlaceholder=function(e,t){(t||this.placeholder)&&(Io["a"].setPlaceholder(this.placeholder,this.element),(this.element.value===this.promptMask&&e&&"Always"!==this.floatLabelType||this.element.value===this.promptMask&&"Never"===this.floatLabelType)&&Uc.call(this,""))},t.prototype.setWidth=function(e){if(!Object(w["T"])(e))if("number"===typeof e)this.inputObj.container.style.width=Object(w["H"])(e),this.element.style.width=Object(w["H"])(e);else if("string"===typeof e){var t=e.match(/px|%|em/)?e:Object(w["H"])(e);this.inputObj.container.style.width=t,this.element.style.width=t}},t.prototype.checkHtmlAttributes=function(e){for(var t=e?Object(w["T"])(this.htmlAttributes)?[]:Object.keys(this.htmlAttributes):["placeholder","disabled","value","readonly"],i=0,n=t;i<n.length;i++){var r=n[i];if(!Object(w["T"])(this.element.getAttribute(r)))switch(r){case"placeholder":(Object(w["T"])(this.maskOptions)||void 0===this.maskOptions["placeholder"]||e)&&this.setProperties({placeholder:this.element.placeholder},!e);break;case"disabled":if(Object(w["T"])(this.maskOptions)||void 0===this.maskOptions["enabled"]||e){var s="disabled"!==this.element.getAttribute(r)&&""!==this.element.getAttribute(r)&&"true"!==this.element.getAttribute(r);this.setProperties({enabled:s},!e)}break;case"value":(Object(w["T"])(this.maskOptions)||void 0===this.maskOptions["value"]||e)&&this.setProperties({value:this.element.value},!e);break;case"readonly":if(Object(w["T"])(this.maskOptions)||void 0===this.maskOptions["readonly"]||e){var a="readonly"===this.element.getAttribute(r)||""===this.element.getAttribute(r)||"true"===this.element.getAttribute(r);this.setProperties({readonly:a},!e)}break}}},t.prototype.createWrapper=function(){var e=this.cssClass;Object(w["T"])(this.cssClass)||""===this.cssClass||(e=this.getValidClassList(this.cssClass)),this.inputObj=Io["a"].createInput({element:this.element,floatLabelType:this.floatLabelType,properties:{enableRtl:this.enableRtl,cssClass:e,enabled:this.enabled,readonly:this.readonly,placeholder:this.placeholder,showClearButton:this.showClearButton}},this.createElement),this.inputObj.container.setAttribute("class",$c+" "+this.inputObj.container.getAttribute("class"))},t.prototype.onPropertyChanged=function(e,t){for(var i=0,n=Object.keys(e);i<n.length;i++){var r=n[i];switch(r){case"value":_c.call(this,this.value),this.placeholder&&this.setMaskPlaceholder(!1,!1);break;case"placeholder":this.setMaskPlaceholder(!0,!0);break;case"width":this.setWidth(e.width);break;case"cssClass":this.updateCssClass(e.cssClass,t.cssClass);break;case"enabled":Io["a"].setEnabled(e.enabled,this.element,this.floatLabelType,this.inputObj.container);break;case"readonly":Io["a"].setReadonly(e.readonly,this.element);break;case"enableRtl":Io["a"].setEnableRtl(e.enableRtl,[this.inputObj.container]);break;case"customCharacters":this.customCharacters=e.customCharacters,this.resetMaskedTextBox();break;case"showClearButton":Io["a"].setClearButton(e.showClearButton,this.element,this.inputObj,void 0,this.createElement),pc.call(this);break;case"floatLabelType":this.floatLabelType=e.floatLabelType,Io["a"].removeFloating(this.inputObj),Io["a"].addFloating(this.element,this.floatLabelType,this.placeholder,this.createElement);break;case"htmlAttributes":this.updateHTMLAttrToElement(),this.updateHTMLAttrToWrapper(),this.checkHtmlAttributes(!0);break;case"mask":var s=this.value;this.mask=e.mask,this.updateValue(s);break;case"promptChar":e.promptChar.length>1&&(e.promptChar=e.promptChar[0]),e.promptChar?this.promptChar=e.promptChar:this.promptChar="_";var a=this.element.value.replace(new RegExp("["+t.promptChar+"]","g"),this.promptChar);this.promptMask===this.element.value&&(a=this.promptMask.replace(new RegExp("["+t.promptChar+"]","g"),this.promptChar)),this.promptMask=this.promptMask.replace(new RegExp("["+t.promptChar+"]","g"),this.promptChar),this.undoCollec=this.redoCollec=[],Uc.call(this,a);break}}this.preventChange=this.isAngular&&this.preventChange?!this.preventChange:this.preventChange},t.prototype.updateValue=function(e){this.resetMaskedTextBox(),_c.call(this,e)},t.prototype.getMaskedValue=function(){return fc.call(this,this.element)},t.prototype.focusIn=function(){document.activeElement!==this.element&&this.enabled&&(this.element.focus(),Object(w["u"])([this.inputObj.container],[Yc]))},t.prototype.focusOut=function(){document.activeElement===this.element&&this.enabled&&(this.element.blur(),Object(w["gb"])([this.inputObj.container],[Yc]))},t.prototype.destroy=function(){hc.call(this);for(var t=["aria-labelledby","role","autocomplete","aria-readonly","autocorrect","aria-disabled","aria-placeholder","autocapitalize","spellcheck","aria-autocomplete","aria-live","aria-valuenow","aria-invalid"],i=0;i<t.length;i++)this.element.removeAttribute(t[i]);this.element.classList.remove("e-input"),this.inputObj.container.insertAdjacentElement("afterend",this.element),Object(w["F"])(this.inputObj.container),e.prototype.destroy.call(this)},Kc([Object(w["r"])(null)],t.prototype,"cssClass",void 0),Kc([Object(w["r"])(null)],t.prototype,"width",void 0),Kc([Object(w["r"])(null)],t.prototype,"placeholder",void 0),Kc([Object(w["r"])("Never")],t.prototype,"floatLabelType",void 0),Kc([Object(w["r"])({})],t.prototype,"htmlAttributes",void 0),Kc([Object(w["r"])(!0)],t.prototype,"enabled",void 0),Kc([Object(w["r"])(!1)],t.prototype,"readonly",void 0),Kc([Object(w["r"])(!1)],t.prototype,"showClearButton",void 0),Kc([Object(w["r"])(!1)],t.prototype,"enablePersistence",void 0),Kc([Object(w["r"])(null)],t.prototype,"mask",void 0),Kc([Object(w["r"])("_")],t.prototype,"promptChar",void 0),Kc([Object(w["r"])(null)],t.prototype,"value",void 0),Kc([Object(w["r"])(null)],t.prototype,"customCharacters",void 0),Kc([Object(w["k"])()],t.prototype,"created",void 0),Kc([Object(w["k"])()],t.prototype,"destroyed",void 0),Kc([Object(w["k"])()],t.prototype,"change",void 0),Kc([Object(w["k"])()],t.prototype,"focus",void 0),Kc([Object(w["k"])()],t.prototype,"blur",void 0),t=Kc([w["p"]],t),t}(w["h"]),th=i("80ef"),ih=i("30d1"),nh=i("45d5"),rh=i("d10b"),sh=i("d724"),ah=function(){function e(e,t,i){var n=this;this.fromWheel=!1,this.touchMove=!1,this.options={},this.sentinelInfo={up:{check:function(e,t){var i=e.top-n.containerRect.top;return t.entered=i>=0,i+n.options.pageHeight/2>=0},axis:"Y"},down:{check:function(e,t){var i=e.bottom;return t.entered=e.bottom<=n.containerRect.bottom,i-n.containerRect.top-n.options.pageHeight/2<=n.options.pageHeight/2},axis:"Y"},right:{check:function(e,t){var i=e.right;return n.movableEle?(t.entered=i<n.movableContainerRect.right,i-n.movableContainerRect.width<=n.movableContainerRect.right):(t.entered=i<n.containerRect.right,i-n.containerRect.width<=n.containerRect.right)},axis:"X"},left:{check:function(e,t){var i=e.left;return t.entered=i>0,n.movableEle?i+n.movableContainerRect.width>=n.movableContainerRect.left:i+n.containerRect.width>=n.containerRect.left},axis:"X"}},this.element=e,this.options=t,this.movableEle=i}return e.prototype.observe=function(e,t){var i=this;this.containerRect=this.options.container.getBoundingClientRect(),w["l"].add(this.options.container,"wheel",function(){return i.fromWheel=!0},this),w["l"].add(this.options.container,"scroll",this.virtualScrollHandler(e,t),this),this.options.movableContainer&&(this.movableContainerRect=this.options.movableContainer.getBoundingClientRect(),w["l"].add(this.options.scrollbar,"wheel",function(){return i.fromWheel=!0},this),w["l"].add(this.options.scrollbar,"scroll",this.virtualScrollHandler(e,t),this))},e.prototype.check=function(e){var t=this.sentinelInfo[e];return!this.movableContainerRect||"left"!==e&&"right"!==e?t.check(this.element.getBoundingClientRect(),t):t.check(this.movableEle.getBoundingClientRect(),t)},e.prototype.virtualScrollHandler=function(e,t){var i=this,n="chrome"===w["d"].info.name?200:100,r=Object(w["D"])(e,n),s=Object(w["D"])(e,50);return this.options.prevTop=this.options.prevLeft=0,function(e){var n=i.options.movableContainer?i.options.container.scrollTop:e.target.scrollTop,a=i.options.movableContainer?i.options.scrollbar.scrollLeft:e.target.scrollLeft,o=i.options.prevTop<n?"down":"up";o=i.options.prevLeft===a?o:i.options.prevLeft<a?"right":"left",i.options.prevTop=n,i.options.prevLeft=a;var l=i.sentinelInfo[o];if(-1!==i.options.axes.indexOf(l.axis)){var d=i.check(o);if(l.entered&&(!i.movableEle||"right"!==o&&"left"!==o?t(i.element,l,o,{top:n,left:a},i.fromWheel,d):t(i.movableEle,l,o,{top:n,left:a},i.fromWheel,d)),d){var c=r;"X"===l.axis&&(c=s),c({direction:o,sentinel:l,offset:{top:n,left:a},focusElement:document.activeElement})}i.fromWheel=!1}}},e.prototype.setPageHeight=function(e){this.options.pageHeight=e},e}(),oh=i("d54e"),lh=function(){function e(e){this.cOffsets={},this.cache={},this.movableCache={},this.frozenRightCache={},this.rowCache={},this.data={},this.groups={},this.currentInfo={},this.parent=e,this.model=this.parent.pageSettings,this.rowModelGenerator=this.parent.allowGrouping?new oh["a"](this.parent):new F["a"](this.parent)}return e.prototype.generateRows=function(e,t){var i=this.parent.isFrozenGrid(),n=!1,r=t.virtualInfo=t.virtualInfo||this.getData(),s=r.sentinelInfo&&"X"===r.sentinelInfo.axis,a=s||!r.loadNext||r.loadSelf?r.page:r.nextInfo.page,o=[],l=this.getBlockIndexes(a),d=[];if(this.currentInfo.blockIndexes&&(l=r.blockIndexes=t.virtualInfo.blockIndexes=this.includePrevPage?this.currentInfo.blockIndexes.slice(1):this.currentInfo.blockIndexes.slice(0,this.currentInfo.blockIndexes.length-1),n=!0),(i&&this.parent.getFrozenMode()!==x["w"]&&!t.renderMovableContent||this.parent.getFrozenMode()===x["w"]&&!t.renderMovableContent&&!t.renderFrozenRightContent||!i)&&this.checkAndResetCache(t.requestType),Object(j["cb"])(this.parent)&&this.parent.vcRows.length){var c=this.parent.vcRows.filter(function(e){return e.isDataRow});if(this.parent.isManualRefresh&&c.length===e["records"].length||!this.parent.isManualRefresh)return this.parent.vcRows}if(this.parent.enableColumnVirtualization)for(var h=0;h<r.blockIndexes.length;h++)if(this.isBlockAvailable(r.blockIndexes[h])&&(this.cache[r.blockIndexes[h]]=this.rowModelGenerator.refreshRows(this.cache[r.blockIndexes[h]])),t.renderMovableContent&&this.isMovableBlockAvailable(r.blockIndexes[h])||t.renderFrozenRightContent&&this.isFrozenRightBlockAvailable(r.blockIndexes[h])){var p=t.renderMovableContent?this.movableCache:this.frozenRightCache;p[r.blockIndexes[h]]=this.rowModelGenerator.refreshRows(p[r.blockIndexes[h]])}var u=r.blockIndexes;for(h=0;h<u.length;h++){if(!this.isBlockAvailable(u[h])){var m=Object(w["T"])(this.startIndex)?this.getStartIndex(u[h],e):this.startIndex,g=this.rowModelGenerator.generateRows(e,{virtualInfo:r,startIndex:m});Object(j["cb"])(this.parent)&&!this.parent.vcRows.length&&(this.parent.vRows=g,this.parent.vcRows=g,this.parent.notify(I["xd"],{}));var f=void 0;Object(j["cb"])(this.parent)?this.getGroupVirtualRecordsByIndex(g):n?this.setBlockForManualRefresh(this.cache,l,g):(f=~~Math.max(g.length,this.model.pageSize)/2,this.isBlockAvailable(l[0])||(this.cache[l[0]]=g.slice(0,f)),this.isBlockAvailable(l[1])||(this.cache[l[1]]=g.slice(f)))}if(this.parent.groupSettings.columns.length&&!s&&this.cache[u[h]]&&(this.cache[u[h]]=this.updateGroupRow(this.cache[u[h]],u[h])),t.renderMovableContent&&!this.isMovableBlockAvailable(u[h])||t.renderFrozenRightContent&&!this.isFrozenRightBlockAvailable(u[h])){p=t.renderMovableContent?this.movableCache:this.frozenRightCache,m=Object(w["T"])(this.startIndex)?this.getStartIndex(u[h],e):this.startIndex,g=this.rowModelGenerator.generateRows(e,{virtualInfo:r,startIndex:m});if(n)this.setBlockForManualRefresh(p,l,g);else{f=~~Math.max(g.length,this.model.pageSize)/2;(t.renderFrozenRightContent&&!this.isFrozenRightBlockAvailable(l[0])||t.renderMovableContent&&!this.isMovableBlockAvailable(l[0]))&&(p[l[0]]=g.slice(0,f)),(t.renderFrozenRightContent&&!this.isFrozenRightBlockAvailable(l[1])||t.renderMovableContent&&!this.isMovableBlockAvailable(l[1]))&&(p[l[1]]=g.slice(f))}}if(t.renderMovableContent||t.renderFrozenRightContent||!this.cache[u[h]]){p=t.renderMovableContent?this.movableCache:this.frozenRightCache;p[u[h]]&&o.push.apply(o,p[u[h]])}else o.push.apply(o,this.cache[u[h]]);this.isBlockAvailable(u[h])&&d.push(u[h])}r.blockIndexes=d;var b="records";return this.parent.allowGrouping&&this.parent.groupSettings.columns.length?this.parent.currentViewData[b]=o.map(function(e){return e.data}):i?(t.renderMovableContent&&("Left"===this.parent.getFrozenMode()||"Right"===this.parent.getFrozenMode()||this.parent.getFrozenColumns())||t.renderFrozenRightContent)&&(this.parent.currentViewData=o.map(function(e){return e.data})):this.parent.currentViewData=o.map(function(e){return e.data}),o},e.prototype.setBlockForManualRefresh=function(e,t,i){var n=this.model.pageSize/2;this.includePrevPage?(e[t[0]-1]=i.slice(0,n),e[t[0]]=i.slice(n,2*n),e[t[1]]=i.slice(2*n,3*n),e[t[2]]=i.slice(3*n,4*n)):(e[t[0]]=i.slice(0,n),e[t[1]]=i.slice(n,2*n),e[t[2]]=i.slice(2*n,3*n),e[t[2]+1]=i.slice(3*n,4*n))},e.prototype.getBlockIndexes=function(e){return[e+(e-1),2*e]},e.prototype.getPage=function(e){return e%2===0?e/2:(e+1)/2},e.prototype.isBlockAvailable=function(e){return e in this.cache},e.prototype.isMovableBlockAvailable=function(e){return e in this.movableCache},e.prototype.isFrozenRightBlockAvailable=function(e){return e in this.frozenRightCache},e.prototype.getData=function(){return{page:this.model.currentPage,blockIndexes:this.getBlockIndexes(this.model.currentPage),direction:"down",columnIndexes:this.parent.getColumnIndexesInView()}},e.prototype.getStartIndex=function(e,t,i){void 0===i&&(i=!0);var n=this.getPage(e),r=e%2===0,s=(n-1)*this.model.pageSize;return i||!r?s:s+~~(this.model.pageSize/2)},e.prototype.getColumnIndexes=function(e){var t=this;void 0===e&&(e=this.parent.getHeaderContent().querySelector("."+x["v"])),this.parent.isFrozenGrid()&&(e=e.querySelector("."+x["y"]));var i=[],n=0|e.scrollLeft,r=Object.keys(this.cOffsets),s=e.getBoundingClientRect().width;n=Math.min(this.cOffsets[r.length-1]-s,n);var a=w["d"].isDevice?2*s:s/2,o=n+s+(0===n?a:0);return r.some(function(e){var r=Number(e),s=t.cOffsets[e],l=n-a<=s&&o+a>=s;return l&&i.push(r),o+a<s}),this.addFrozenIndex(i),i},e.prototype.addFrozenIndex=function(e){if(this.parent.getFrozenColumns()&&this.parent.enableColumnVirtualization&&0===e[0])for(var t=0;t<this.parent.getFrozenColumns();t++)e.push(e[e.length-1]+1)},e.prototype.checkAndResetCache=function(e){var t=["paging","refresh","sorting","filtering","searching","grouping","ungrouping","reorder","save","delete"];this.parent.getFrozenColumns()&&this.parent.frozenRows&&this.parent.enableColumnVirtualization&&"reorder"===e&&t.splice(t.indexOf(e),1);var i=t.some(function(t){return e===t});return i&&(this.cache={},this.data={},this.groups={},this.movableCache={},this.frozenRightCache={}),i},e.prototype.refreshColOffsets=function(){var e=this,t=0;this.cOffsets={};for(var i=this.parent.groupSettings.columns.length,n=this.parent.columns,r=n.length,s=function(t){return t.visible&&(e.parent.groupSettings.showGroupedColumn?t.visible:e.parent.groupSettings.columns.indexOf(t.field)<0)},a=this.parent.groupSettings.columns,o=0;o<a.length;o++)this.cOffsets[o]=30+(0|this.cOffsets[o-1]);for(var l=Array.apply(null,Array(r)).map(function(){return t++}),d=0;d<l.length;d++)l[d]=l[d]+i,this.cOffsets[l[d]]=(0|this.cOffsets[l[d]-1])+(s(n[d])?parseInt(n[d].width,10):0)},e.prototype.updateGroupRow=function(e,t){for(var i=e[0],n=[],r=Object.keys(this.cache),s=0;s<r.length;s++)Number(r[s])<t&&(n=n.concat(this.cache[r[s]]));return i&&i.isDataRow||t%2===0?e:this.iterateGroup(e,n)},e.prototype.iterateGroup=function(e,t){var i=e[0],n=0;if(i&&i.isDataRow)return e;var r=e.some(function(e){return t.some(function(t,i){var r=t&&void 0!==t.data.field&&t.data.field===e.data.field&&t.data.key===e.data.key;return r&&(n=i),r})});return r&&(e.shift(),e=this.iterateGroup(e,t.slice(n))),e},e.prototype.getRows=function(){for(var e=[],t=Object.keys(this.cache),i=0;i<t.length;i++)e=e.concat(this.cache[t[i]]);return e},e.prototype.generateCells=function(e){for(var t=[],i=this.parent.columnModel,n=0;n<i.length;n++)t.push(this.rowModelGenerator.generateCell(i[n],null,null,null,null,e));return t},e.prototype.getGroupVirtualRecordsByIndex=function(e){for(var t=this.parent.contentModule.getGroupedTotalBlocks(),i=this.parent.contentModule.getBlockSize(),n=1;n<=t;n++){var r=0;this.cache[n]=[];for(var s=(n-1)*i;s<e.length;s++){if(r===i)break;this.cache[n].push(e[s]),e[s].isDataRow&&r++}}},e}(),dh=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ch=function(e){function t(t,i){var n=e.call(this,t,i)||this;return n.prevHeight=0,n.startIndex=0,n.preStartIndex=0,n.preventEvent=!1,n.actions=["filtering","searching","grouping","ungrouping"],n.offsets={},n.tmpOffsets={},n.virtualEle=new ph,n.offsetKeys=[],n.isFocused=!1,n.isSelection=!1,n.isBottom=!1,n.rndrCount=0,n.empty=void 0,n.isCancel=!1,n.requestTypes=["beginEdit","cancel","delete","add","save"],n.isNormaledit="Normal"===n.parent.editSettings.mode,n.virtualData={},n.emptyRowData={},n.vfColIndex=[],n.frzIdx=1,n.isContextMenuOpen=!1,n.isSelectionScroll=!1,n.validationCheck=!1,n.locator=i,n.eventListener("on"),n.parent.on(I["qb"],n.setVisible,n),n.vgenerator=n.generator,n}return dh(t,e),t.prototype.renderTable=function(){this.header=this.locator.getService("rendererFactory").getRenderer(A["b"].Header),e.prototype.renderTable.call(this),this.virtualEle.table=this.getTable(),this.virtualEle.content=this.content=this.getPanel().querySelector("."+x["i"]),this.virtualEle.renderWrapper(this.parent.height),this.virtualEle.renderPlaceHolder(),this.virtualEle.wrapper.style.position="absolute";var t=this.parent.dataSource instanceof O["a"]&&!this.parent.dataSource.dataSource.offline,i={container:this.content,pageHeight:2*this.getBlockHeight(),debounceEvent:t,axes:this.parent.enableColumnVirtualization?["X","Y"]:["Y"]};this.observer=new ah(this.virtualEle.wrapper,i)},t.prototype.renderEmpty=function(e){this.getTable().appendChild(e),this.virtualEle.adjustTable(0,0)},t.prototype.getReorderedFrozenRows=function(e){var t=e.virtualInfo.blockIndexes,i=e.virtualInfo.columnIndexes,n=e.virtualInfo.page;e.virtualInfo.blockIndexes=[1,2],e.virtualInfo.page=1,e.renderMovableContent||(e.virtualInfo.columnIndexes=[]);var r=this.parent.getCurrentViewRecords().length,s=this.parent.renderModule.data.dataManager.dataSource.json.slice(0,r),a=this.vgenerator.generateRows(s,e);return e.virtualInfo.blockIndexes=t,e.virtualInfo.columnIndexes=i,e.virtualInfo.page=n,a.splice(0,this.parent.frozenRows)},t.prototype.scrollListener=function(e){if(this.scrollAfterEdit(),this.parent.enablePersistence&&(this.parent.scrollPosition=e.offset),this.preventEvent||this.parent.isDestroyed)this.preventEvent=!1;else{Object(w["T"])(document.activeElement)?this.isFocused=!1:this.isFocused=this.content===Object(w["A"])(document.activeElement,"."+x["i"])||this.content===document.activeElement;var t=e.sentinel,i=this.currentInfo=this.getInfoFromView(e.direction,t,e.offset);if(Object(j["cb"])(this.parent))return i.blockIndexes&&this.prevInfo.blockIndexes.toString()===i.blockIndexes.toString()?void 0:(i.event="refresh-virtual-block",Object(w["T"])(i.offsets)||(i.offsets.top=this.content.scrollTop),this.parent.pageSettings.currentPage=i.page,void this.parent.notify(i.event,{requestType:"virtualscroll",virtualInfo:i,focusElement:e.focusElement}));if(this.prevInfo&&("Y"===t.axis&&this.prevInfo.blockIndexes.toString()===i.blockIndexes.toString()||"X"===t.axis&&this.prevInfo.columnIndexes.toString()===i.columnIndexes.toString()))return w["d"].isIE&&this.parent.hideSpinner(),this.requestType="virtualscroll"===this.requestType?this.empty:this.requestType,void("Y"===t.axis&&this.restoreEdit());this.parent.setColumnIndexesInView(this.parent.enableColumnVirtualization?i.columnIndexes:[]),this.parent.pageSettings.currentPage=i.loadNext&&!i.loadSelf?i.nextInfo.page:i.page,this.requestType="virtualscroll",this.parent.notify(i.event,{requestType:"virtualscroll",virtualInfo:i,focusElement:e.focusElement})}},t.prototype.block=function(e){return this.vgenerator.isBlockAvailable(e)},t.prototype.getInfoFromView=function(e,t,i){var n=!1,r=[],s={direction:e,sentinelInfo:t,offsets:i,startIndex:this.preStartIndex,endIndex:this.preEndIndex};s.page=this.getPageFromTop(i.top,s),s.blockIndexes=r=this.vgenerator.getBlockIndexes(s.page),s.loadSelf=!this.vgenerator.isBlockAvailable(r[s.block]);var a=this.ensureBlocks(s);if("upArrow"===this.activeKey&&s.blockIndexes.toString()!==a.toString()){var o=a[a.length-1];-1===s.blockIndexes.indexOf(o)&&(n=!0)}if(s.blockIndexes=a,s.loadNext=!a.filter(function(e){return-1===r.indexOf(e)}).every(this.block.bind(this)),s.event=s.loadNext||s.loadSelf?I["Nc"]:I["sd"],s.nextInfo=s.loadNext?{page:Math.max(1,s.page+("down"===e?1:-1))}:{},n&&(s.blockIndexes=[s.blockIndexes[0]-1,s.blockIndexes[0],s.blockIndexes[0]+1]),"downArrow"===this.activeKey){var l=Math.ceil(this.rowIndex/this.getBlockSize());1!==l&&(s.blockIndexes[1]!==l||s.blockIndexes.length<3)&&(s.blockIndexes=[l-1,l,l+1])}return s.columnIndexes="X"===t.axis?this.vgenerator.getColumnIndexes():this.parent.getColumnIndexesInView(),this.parent.enableColumnVirtualization&&"X"===t.axis&&(s.event=I["sd"]),s},t.prototype.setKeyboardNavIndex=function(){this.blazorDataLoad=!0,"downArrow"!==this.activeKey&&"upArrow"!==this.activeKey||(this.blzRowIndex="downArrow"===this.activeKey?this.rowIndex+1:this.rowIndex-1,document.activeElement.blur())},t.prototype.ensureBlocks=function(e){var t,i=this,n=e.blockIndexes[e.block],r=n,s=Math.max,a="down"===e.direction?[s(n,1),++n,++n]:[s(n-1,1),n,n+1];return this.parent.enableColumnVirtualization&&this.parent.isFrozenGrid()&&("X"===e.sentinelInfo.axis||"Y"===e.sentinelInfo.axis&&e.page===this.prevInfo.page)&&(a=this.prevInfo.blockIndexes),a=a.filter(function(e,t){return a.indexOf(e)===t}),this.prevInfo.blockIndexes.toString()===a.toString()?a:((e.loadSelf||"down"===e.direction&&this.isEndBlock(r))&&(a=this.vgenerator.getBlockIndexes(e.page)),a.some(function(e,n){var r=e===(Object(j["cb"])(i.parent)?i.getGroupedTotalBlocks():i.getTotalBlocks());return r&&(t=n),r}),void 0!==t&&(a=a.slice(0,t+1),0===e.block&&1===a.length&&this.vgenerator.isBlockAvailable(a[0]-1)&&(a=[a[0]-1,a[0]])),a)},t.prototype.appendContent=function(e,t,i){var n=this,r=this.parent.isFrozenGrid(),s=this.parent.getFrozenColumns()||this.parent.getFrozenLeftColumnsCount(),a=this.parent.enableColumnVirtualization&&r;this.checkFirstBlockColIndexes(i);var o=i.virtualInfo.sentinelInfo&&"Y"===i.virtualInfo.sentinelInfo.axis&&this.currentInfo.page&&this.currentInfo.page!==i.virtualInfo.page?this.currentInfo:i.virtualInfo;this.prevInfo=this.prevInfo||i.virtualInfo;var l=o.columnIndexes[0]-1;a&&o.columnIndexes[0]===s&&(l=o.columnIndexes[0]-s-1);var d,c=this.getColumnOffset(l),h=o.blockIndexes;this.parent.groupSettings.columns.length&&this.refreshOffsets(),"100%"===this.parent.height&&(this.parent.element.style.height="100%");var p,u=this.parent.height.toString().indexOf("%")<0?this.content.getBoundingClientRect().height:this.parent.element.getBoundingClientRect().height;if(!this.requestTypes.some(function(e){return e===n.requestType})){var m=this.getTranslateY(this.content.scrollTop,u,o);this.virtualEle.adjustTable(a?0:c,m),a&&this.virtualEle.adjustMovableTable(c,0)}if(this.parent.enableColumnVirtualization&&(this.header.virtualEle.adjustTable(a?0:c,0),a&&this.header.virtualEle.adjustMovableTable(c,0)),this.parent.enableColumnVirtualization){var g=o.columnIndexes;d=this.getColumnOffset(g[g.length-1])-this.getColumnOffset(g[0]-1)+"",a?this.header.virtualEle.setMovableWrapperWidth(d):this.header.virtualEle.setWrapperWidth(d)}a?this.virtualEle.setMovableWrapperWidth(d,w["d"].isIE||"edge"===w["d"].info.name):this.virtualEle.setWrapperWidth(d,w["d"].isIE||"edge"===w["d"].info.name),Object(w["T"])(e.parentNode)||Object(w["fb"])(e),r?i.renderFrozenRightContent?p=this.parent.getContent().querySelector(".e-frozen-right-content").querySelector(x["D"]):i.renderMovableContent?i.renderMovableContent&&(p=this.parent.getMovableVirtualContent().querySelector(x["D"])):p=this.parent.getFrozenVirtualContent().querySelector(x["D"]):p=this.parent.element.querySelector("."+x["i"]).querySelector(x["D"]),p&&(Object(w["fb"])(p),e=null);var f=this.parent.isReact&&!Object(w["T"])(this.parent.rowTemplate);if(f?e=t:(e=this.parent.createElement(x["D"],{attrs:{role:"rowgroup"}}),e.appendChild(t)),this.parent.frozenRows&&"virtualscroll"===i.requestType&&1===this.parent.pageSettings.currentPage)for(var b=0;b<this.parent.frozenRows;b++)e.children[0].remove();if(r?(i.renderFrozenRightContent?(this.parent.getContent().querySelector(".e-frozen-right-content").querySelector("."+x["C"]).appendChild(e),this.requestType="virtualscroll"===this.requestType?this.empty:this.requestType):i.renderMovableContent?i.renderMovableContent&&(this.parent.getMovableVirtualContent().querySelector("."+x["C"]).appendChild(e),this.parent.getFrozenMode()!==x["w"]&&(this.requestType="virtualscroll"===this.requestType?this.empty:this.requestType)):this.parent.getFrozenVirtualContent().querySelector("."+x["C"]).appendChild(e),this.vfColIndex.length&&(i.virtualInfo.columnIndexes=o.columnIndexes=Object(w["G"])([],this.vfColIndex),this.vfColIndex=i.renderMovableContent?[]:this.vfColIndex)):(this.getTable().appendChild(e),this.requestType="virtualscroll"===this.requestType?this.empty:this.requestType),this.parent.groupSettings.columns.length){if(!Object(j["cb"])(this.parent)&&"up"===o.direction){var v=this.offsets[this.getTotalBlocks()]-this.prevHeight;this.preventEvent=!0;var y=this.content.scrollTop;this.content.scrollTop=y+v}this.setVirtualHeight(),this.observer.setPageHeight(this.getOffset(h[h.length-1])-this.getOffset(h[0]-1))}this.prevInfo=o,this.isFocused&&"downArrow"!==this.activeKey&&"upArrow"!==this.activeKey&&this.content.focus();var C=Math.ceil(this.getTotalBlocks()/2);if(this.isBottom&&(this.isBottom=!1,this.parent.getContent().firstElementChild.scrollTop=this.offsets[this.offsetKeys.length-1]),this.parent.pageSettings.currentPage===C&&1===h.length&&(this.isBottom=!0,this.parent.getContent().firstElementChild.scrollTop=this.offsets[this.offsetKeys.length-2]),this.parent.isFrozenGrid()&&this.parent.pageSettings.currentPage===C-1&&"up"===o.direction&&(this.parent.getContent().firstElementChild.scrollTop=this.offsets[this.offsetKeys.length-3]),"virtualscroll"===i.requestType&&"X"===i.virtualInfo.sentinelInfo.axis&&this.parent.notify(I["g"],{}),this.focusCell(i),this.restoreEdit(i),this.restoreAdd(i),this.ensureSelectedRowPosition(),this.validationScrollLeft(i,r),!this.initialRowTop){var O=this.parent.element.getBoundingClientRect().top;this.initialRowTop=this.parent.getRowByIndex(0).getBoundingClientRect().top-O}var T=i.tableName,k="Left-Right"===this.parent.getFrozenMode()?"frozen-right"===T:"movable"===T;r&&!k||(this.vgenerator.startIndex=null,this.vgenerator.currentInfo={},this.vgenerator.includePrevPage=null)},t.prototype.validationScrollLeft=function(e,t){var i=this.parent.getFrozenColumns(),n=this.parent.getFrozenMode(),r=!t||e&&(i||"Left"===n||"Right"===n?e.renderMovableContent:e.renderFrozenRightContent);if(this.validationCheck&&r)if(this.validationCol){var s=this.vgenerator.cOffsets[this.validationCol.index-this.parent.getVisibleFrozenColumns()-1];this.validationCol=null,this.parent.isFrozenGrid()?this.movableContent.scrollLeft=s:this.content.scrollLeft=s}else this.validationCheck=!1,this.parent.editModule.editFormValidate()},t.prototype.ensureSelectedRowPosition=function(){if(!this.isSelection&&this.isSelectionScroll&&!Object(w["T"])(this.selectRowIndex)){this.isSelectionScroll=!1;var e=this.parent.getRowByIndex(this.selectRowIndex);e&&!this.isRowInView(e)&&this.rowSelected({rowIndex:this.selectRowIndex,row:e},!0)}},t.prototype.checkFirstBlockColIndexes=function(e){if(this.parent.enableColumnVirtualization&&this.parent.isFrozenGrid()&&0===e.virtualInfo.columnIndexes[0]){var t=[],i=this.parent.getFrozenColumns()||this.parent.getFrozenLeftColumnsCount();if(!e.renderMovableContent&&e.virtualInfo.columnIndexes.length>i){this.vfColIndex=e.virtualInfo.columnIndexes;for(var n=0;n<i;n++)t.push(n);e.virtualInfo.columnIndexes=t}else e.renderMovableContent&&(this.vfColIndex.length||(this.vfColIndex=Object(w["G"])([],e.virtualInfo.columnIndexes)),e.virtualInfo.columnIndexes=Object(w["G"])([],this.vfColIndex),e.virtualInfo.columnIndexes.splice(0,i))}},t.prototype.focusCell=function(e){if("upArrow"===this.activeKey||"downArrow"===this.activeKey){var t=this.parent.getRowByIndex(this.rowIndex),i=t.cells[this.cellIndex];i.focus({preventScroll:!0}),this.parent.selectRow(parseInt(t.getAttribute(x["d"]),10)),this.activeKey=this.empty}},t.prototype.restoreEdit=function(e){if(this.isNormaledit){var t=this.parent.getFrozenColumns(),i=e&&this.parent.isFrozenGrid(),n=this.parent.getFrozenMode(),r=e&&(t||"Left"===n||"Right"===n?e.renderMovableContent:e.renderFrozenRightContent);if((!i||i&&r)&&this.parent.editSettings.allowEditing&&this.parent.editModule&&!Object(w["T"])(this.editedRowIndex)){var s=this.getRowByIndex(this.editedRowIndex),a=this.content,o=Object.keys(this.virtualData),l=e&&e.virtualInfo&&"X"===e.virtualInfo.sentinelInfo.axis;if(i&&l&&(s=this.parent.getMovableRowByIndex(this.editedRowIndex),a=this.movableContent),o.length&&s&&!a.querySelector("."+x["l"])){var d=s.getBoundingClientRect().top;(l||d<this.content.offsetHeight&&d>this.parent.getRowHeight())&&(this.parent.isEdit=!1,this.parent.editModule.startEdit(s))}if(s&&this.content.querySelector("."+x["l"])&&!o.length){var c=Object(w["G"])({},this.getRowObjectByIndex(this.editedRowIndex));this.virtualData=this.getVirtualEditedData(c)}}this.restoreAdd(e)}},t.prototype.getVirtualEditedData=function(e){var t=[].slice.call(this.parent.element.getElementsByClassName("e-gridform")),i=this.parent.editModule&&this.parent.editModule.formObj&&this.parent.editModule.formObj.isDestroyed;if(!i)for(var n=0;n<t.length;n++)e=this.parent.editModule.getCurrentEditedData(t[n],e);return e},t.prototype.restoreAdd=function(e){var t=this.parent.getFrozenColumns(),i=e&&this.parent.isFrozenGrid(),n=this.parent.getFrozenMode(),r=e&&e.virtualInfo&&e.virtualInfo.sentinelInfo&&"X"===e.virtualInfo.sentinelInfo.axis,s=r&&i?!(this.parent.getMovableVirtualHeader().querySelector("."+x["b"])||this.parent.getMovableVirtualContent().querySelector("."+x["b"])):!this.parent.element.querySelector("."+x["b"]),a=e&&(t||"Left"===n||"Right"===n?e.renderMovableContent:e.renderFrozenRightContent);if((!i||i&&a)&&this.isNormaledit&&this.isAdd&&s){var o="Top"===this.parent.editSettings.newRowPosition&&this.content.scrollTop<this.parent.getRowHeight(),l="Bottom"===this.parent.editSettings.newRowPosition&&this.parent.pageSettings.currentPage===this.maxPage;(o||l)&&(this.parent.isEdit=!1,this.parent.addRecord())}},t.prototype.onDataReady=function(e){Object(w["T"])(e.count)||(this.count=e.count,this.maxPage=Math.ceil(e.count/this.parent.pageSettings.pageSize)),this.vgenerator.checkAndResetCache(e.requestType),["refresh","filtering","searching","grouping","ungrouping","reorder",void 0].some(function(t){return e.requestType===t})&&this.refreshOffsets(),this.setVirtualHeight(),this.resetScrollPosition(e.requestType)},t.prototype.setVirtualHeight=function(e){var t=this.parent.enableColumnVirtualization?this.getColumnOffset(this.parent.columns.length+this.parent.groupSettings.columns.length-1)+"px":"100%";if(this.parent.isFrozenGrid()){var i=1===this.parent.pageSettings.currentPage&&Object.keys(this.offsets).length<=2?this.offsets[1]:this.offsets[this.getTotalBlocks()-2],n=this.content.clientHeight;i=i>n?i:0,this.virtualEle.setVirtualHeight(i,t)}else{var r=this.offsets[Object(j["cb"])(this.parent)?this.getGroupedTotalBlocks():this.getTotalBlocks()];this.virtualEle.setVirtualHeight(r,t)}this.parent.enableColumnVirtualization&&(this.header.virtualEle.setVirtualHeight(1,t),this.parent.isFrozenGrid()&&(this.virtualEle.setMovableVirtualHeight(1,t),this.header.virtualEle.setMovableVirtualHeight(1,t)))},t.prototype.getPageFromTop=function(e,t){var i=this,n=Object(j["cb"])(this.parent)?this.getGroupedTotalBlocks():this.getTotalBlocks(),r=0;return this.offsetKeys.some(function(s){var a=Number(s),o=e<=i.offsets[s]||a===n&&e>i.offsets[s];return o&&(i.offsetKeys.length%2!==0&&a.toString()===i.offsetKeys[i.offsetKeys.length-2]&&e<=i.offsets[i.offsetKeys.length-1]&&(a+=1),t.block=a%2===0?1:0,r=Math.max(1,Math.min(i.vgenerator.getPage(a),i.maxPage))),o}),r},t.prototype.getTranslateY=function(e,t,i,n){void 0===i&&(i={page:this.getPageFromTop(e,{})},i.blockIndexes=this.vgenerator.getBlockIndexes(i.page));var r=(i.blockIndexes[0]||1)-1,s=this.getOffset(r),a=this.getOffset(i.blockIndexes[i.blockIndexes.length-1]);n&&(i=this.prevInfo);var o=s>e?this.getOffset(r-1):a<e+t?this.getOffset(r+1):s,l=this.offsets[i.blockIndexes[i.blockIndexes.length-1]]-this.tmpOffsets[i.blockIndexes[0]],d=Object(j["cb"])(this.parent)?this.getGroupedTotalBlocks():this.getTotalBlocks();return o+l>this.offsets[d]&&(o-=o+l-this.offsets[d]),o},t.prototype.getOffset=function(e){return Math.min(0|this.offsets[e],0|this.offsets[this.maxBlock])},t.prototype.onEntered=function(){var e=this;return function(t,i,n,r,s,a){w["d"].isIE&&!s&&a&&!e.preventEvent&&e.parent.showSpinner();var o=e.parent.enableColumnVirtualization&&e.parent.isFrozenGrid(),l="X"===i.axis,d=e.prevInfo.offsets?e.prevInfo.offsets.top:null,c=e.content.getBoundingClientRect().height,h=e.getColumnOffset(l?e.vgenerator.getColumnIndexes()[0]-1:e.prevInfo.columnIndexes[0]-1);if(l&&!o){var p=Object.keys(e.vgenerator.cOffsets).length-e.prevInfo.columnIndexes.length,u=e.vgenerator.cOffsets[p-1];h=h>u?u:h}var m=e.getTranslateY(r.top,c,l&&d===r.top?e.prevInfo:void 0,!0);e.virtualEle.adjustTable(o?0:h,Math.min(m,e.offsets[e.maxBlock])),o&&e.virtualEle.adjustMovableTable(h,0),e.parent.enableColumnVirtualization&&(e.header.virtualEle.adjustTable(o?0:h,0),o&&e.header.virtualEle.adjustMovableTable(h,0))}},t.prototype.dataBound=function(){this.parent.notify(I["vd"],{}),this.isSelection&&"upArrow"!==this.activeKey&&"downArrow"!==this.activeKey?this.parent.selectRow(this.selectedRowIndex):this.activeKey=this.empty},t.prototype.rowSelected=function(e,t){if((this.isSelection||t)&&!this.isLastBlockRow(e.rowIndex)){var i=Object(j["S"])(this.content.firstElementChild),n=this.parent.element.getBoundingClientRect().top,r=e.row.getBoundingClientRect().top-n,s=this.content.getBoundingClientRect().height,a=s<r,o=a?r-s:this.initialRowTop-r,l=a?i.height-o:i.height+o;this.virtualEle.adjustTable(i.width,l);var d=this.content.querySelector("tbody").lastElementChild.getBoundingClientRect().top-n;d<s&&(l+=s-(e.row.getBoundingClientRect().top-n),this.virtualEle.adjustTable(i.width,l-this.parent.getRowHeight()/2))}this.isSelection=!1},t.prototype.isLastBlockRow=function(e){var t=this.parent.getContent().firstElementChild,i=Math.floor(t.offsetHeight/this.parent.getRowHeight())-1,n=this.maxPage*this.parent.pageSettings.pageSize-i;return e>=n},t.prototype.refreshMaxPage=function(){this.parent.groupSettings.columns.length&&this.parent.vcRows.length&&(this.maxPage=Math.ceil(this.parent.vcRows.length/this.parent.pageSettings.pageSize))},t.prototype.setVirtualPageQuery=function(e){var t=this.parent.getContent().querySelector(".e-row");if(t&&this.parent.isManualRefresh&&this.currentInfo.blockIndexes&&3===this.currentInfo.blockIndexes.length){this.vgenerator.startIndex=parseInt(t.getAttribute("aria-rowindex"),10),this.vgenerator.currentInfo=Object(w["G"])({},this.currentInfo),this.vgenerator.currentInfo.blockIndexes=this.currentInfo.blockIndexes.slice();var i=this.vgenerator.includePrevPage=this.currentInfo.blockIndexes[0]%2===0;i?(this.vgenerator.startIndex=this.vgenerator.startIndex-this.getBlockSize(),this.vgenerator.currentInfo.blockIndexes.unshift(this.currentInfo.blockIndexes[0]-1)):this.vgenerator.currentInfo.blockIndexes.push(this.currentInfo.blockIndexes[this.currentInfo.blockIndexes.length-1]+1);var n=(this.vgenerator.currentInfo.blockIndexes[0]-1)*this.getBlockSize(),r=this.vgenerator.currentInfo.blockIndexes.length*this.getBlockSize();e.query.skip(n),e.query.take(r),e.skipPage=!0}},t.prototype.eventListener=function(e){var t=this;this.parent[e](I["Bb"],this.onDataReady,this),this.parent.addEventListener(I["Ab"],this.dataBound.bind(this)),this.parent.addEventListener(I["a"],this.actionBegin.bind(this)),this.parent.addEventListener(I["b"],this.actionComplete.bind(this)),this.parent.addEventListener(I["Rd"],this.rowSelected.bind(this)),this.parent[e](I["sd"],this.refreshContentRows,this),this.parent[e](I["ce"],this.selectVirtualRow,this),this.parent[e](I["ve"],this.virtualCellFocus,this),this.parent[e](I["ye"],this.editActionBegin,this),this.parent[e](I["we"],this.addActionBegin,this),this.parent[e](I["xe"],this.restoreEdit,this),this.parent[e](I["Ae"],this.editSuccess,this),this.parent[e](I["td"],this.refreshCache,this),this.parent[e](I["Pb"],this.resetIsedit,this),this.parent[e](I["sc"],this.getVirtualData,this),this.parent[e](I["ze"],this.editCancel,this),this.parent[e](I["xd"],this.refreshMaxPage,this),this.parent[e](I["ie"],this.setVirtualPageQuery,this),this.parent[e](I["be"],this.selectRowOnContextOpen,this),this.parent[e](I["Dd"],this.resetVirtualFocus,this),this.parent[e](I["ud"],this.refreshCells,this),this.parent[e](I["Zd"],this.scrollToEdit,this);for(var i=this.actions,n=0;n<i.length;n++)this.parent[e](i[n]+"-begin",this.onActionBegin,this);var r=function(){t.observer.observe(function(e){return t.scrollListener(e)},t.onEntered());var e=t.parent;if(e.enablePersistence&&e.scrollPosition){t.content.scrollTop=e.scrollPosition.top;var i={direction:"down",sentinel:t.observer.sentinelInfo.down,offset:e.scrollPosition,focusElement:e.element};t.scrollListener(i),e.enableColumnVirtualization&&(t.content.scrollLeft=e.scrollPosition.left)}t.parent.off(I["ub"],r)};this.parent.on(I["ub"],r,this)},t.prototype.scrollToEdit=function(e){var t=this.parent.isFrozenGrid(),i=!0;if(this.validationCheck=!0,this.isAdd&&this.content.scrollTop>0){i=!1;var n=Object.keys(this.offsets);this.content.scrollTop="Top"===this.parent.editSettings.newRowPosition?0:this.offsets[n.length-1]}var r=this.parent.getRowByIndex(this.editedRowIndex);if(!r&&!Object(w["T"])(this.editedRowIndex)&&(!r||!this.isRowInView(r))){var s=this.parent.getRowHeight(),a=this.editedRowIndex*s;Object(w["T"])(a)||(i=!1,this.content.scrollTop=a)}if(e&&i){var o=this.vgenerator.cOffsets[e.index-this.parent.getVisibleFrozenColumns()-1];if(!this.parent.enableColumnVirtualization){var l=this.parent.getHeaderContent().querySelector('.e-headercelldiv[e-mappinguid="'+e.uid+'"]');o=t?l.parentElement.offsetLeft-this.parent.getFrozenVirtualHeader().offsetWidth:l.parentElement.offsetLeft}t?this.parent.getMovableVirtualContent().scrollLeft=this.parent.enableRtl?-Math.abs(o):o:this.content.scrollLeft=this.parent.enableRtl?-Math.abs(o):o}e&&!i&&(this.validationCol=e)},t.prototype.refreshCells=function(e){e.cells=this.vgenerator.generateCells(e.foreignKeyData)},t.prototype.resetVirtualFocus=function(e){this.isCancel=e.isCancel},t.prototype.getVirtualData=function(e){if(this.isNormaledit){var t=this.parent.element.querySelector('.e-griderror:not([style*="display: none"])'),i=Object.keys(this.virtualData);if(e.isScroll=0!==i.length&&this.currentInfo.sentinelInfo&&"X"===this.currentInfo.sentinelInfo.axis,t)return;this.virtualData=i.length?this.virtualData:e.virtualData,this.getVirtualEditedData(this.virtualData),e.virtualData=this.virtualData,e.isAdd=this.isAdd,e.isCancel=this.isCancel}},t.prototype.selectRowOnContextOpen=function(e){this.isContextMenuOpen=e.isOpen},t.prototype.editCancel=function(e){var t=Object(j["E"])(this.parent,e.data);Object(w["T"])(t)||(e.data=this.parent.getCurrentViewRecords()[t])},t.prototype.editSuccess=function(e){this.isNormaledit&&(!this.isAdd&&e.data&&this.updateCurrentViewData(e.data),this.isAdd=!1)},t.prototype.updateCurrentViewData=function(e){var t=Object(j["E"])(this.parent,e);Object(w["T"])(t)||(this.parent.getCurrentViewRecords()[t]=e)},t.prototype.actionBegin=function(e){"virtualscroll"!==e.requestType&&(this.requestType=e.requestType),e.cancel||this.parent.notify(I["wd"],e)},t.prototype.virtualCellFocus=function(e){var t=document.activeElement;if(t.classList.contains(x["B"])&&e&&("upArrow"===e.action||"downArrow"===e.action)){var i=parseInt(t.parentElement.getAttribute(x["d"]),10);if(e&&("downArrow"===e.action||"upArrow"===e.action)){var n=this.parent.getContent().firstElementChild;"downArrow"===e.action?i+=1:i-=1,this.rowIndex=i,this.cellIndex=parseInt(t.getAttribute(x["c"]),10);var r=this.parent.getRowByIndex(i),s=this.parent.pageSettings.currentPage,a=Math.floor(n.offsetHeight/this.parent.getRowHeight())-1,o=!1;Object(w["T"])(r)&&(o=!0,("downArrow"===e.action&&s===this.maxPage-1||"upArrow"===e.action&&1===s)&&(o=!1)),o||Object(j["p"])(r,this.parent)&&"downArrow"===e.action||Object(j["o"])(r,2*this.parent.getRowHeight())&&"upArrow"===e.action?(this.activeKey=e.action,n.scrollTop="downArrow"===e.action?(i-a)*this.parent.getRowHeight():i*this.parent.getRowHeight()):this.activeKey=this.empty,this.parent.selectRow(i)}}},t.prototype.editActionBegin=function(e){this.editedRowIndex=e.index;var t=Object(w["G"])({},this.getRowObjectByIndex(e.index)),i=Object.keys(this.virtualData);e.data=i.length?this.virtualData:t,e.isScroll=0!==i.length&&this.currentInfo.sentinelInfo&&"X"===this.currentInfo.sentinelInfo.axis},t.prototype.refreshCache=function(e){var t=Math.ceil((this.editedRowIndex+1)/this.getBlockSize()),i=this.editedRowIndex-(t-1)*this.getBlockSize();this.vgenerator.cache[t][i].data=e.data,this.vgenerator.movableCache[t]&&(this.vgenerator.movableCache[t][i].data=e.data),this.vgenerator.frozenRightCache[t]&&(this.vgenerator.frozenRightCache[t][i].data=e.data)},t.prototype.actionComplete=function(e){if(this.parent.enableVirtualization){var t=["delete","save","cancel"],i=["sorting","filtering","grouping","refresh","searching","ungrouping","reorder"];t.some(function(t){return t===e.requestType})&&(this.refreshOffsets(),this.parent.isFrozenGrid()?(this.vgenerator.refreshColOffsets(),this.parent.contentModule.virtualRenderer.virtualEle.setVirtualHeight()):this.refreshVirtualElement()),this.isNormaledit&&(i.some(function(t){return t===e.requestType})||t.some(function(t){return t===e.requestType}))&&(this.isCancel=!0,this.isAdd=!1,this.editedRowIndex=this.empty,this.virtualData={},this.parent.editModule&&(this.parent.editModule.editModule.previousData=void 0)),this.parent.enableColumnVirtualization&&"filterafteropen"===e.requestType&&this.currentInfo.columnIndexes&&this.currentInfo.columnIndexes[0]>0&&this.parent.resetFilterDlgPosition(e.columnName)}},t.prototype.resetIsedit=function(){this.parent.enableVirtualization&&this.isNormaledit&&(this.parent.editSettings.allowEditing&&Object.keys(this.virtualData).length||this.parent.editSettings.allowAdding&&this.isAdd)&&(this.parent.isEdit=!0)},t.prototype.scrollAfterEdit=function(){if(this.parent.editModule&&this.parent.editSettings.allowEditing&&this.isNormaledit&&this.parent.element.querySelector(".e-gridform")){var e=this.parent.element.querySelector("."+x["l"]),t=this.parent.element.querySelector("."+x["b"]);if(e||t){var i=e?Object(w["G"])({},this.getRowObjectByIndex(this.editedRowIndex)):Object(w["G"])({},this.emptyRowData),n=Object.keys(this.virtualData);this.virtualData=n.length?this.getVirtualEditedData(this.virtualData):this.getVirtualEditedData(i)}}},t.prototype.createEmptyRowdata=function(){var e=this;this.parent.columnModel.filter(function(t){e.emptyRowData[t.field]=e.empty})},t.prototype.addActionBegin=function(e){if(this.isNormaledit){Object.keys(this.emptyRowData).length||this.createEmptyRowdata(),this.isAdd=!0;var t=this.parent.pageSettings.currentPage;!this.parent.frozenRows&&this.content.scrollTop>0&&"Top"===this.parent.editSettings.newRowPosition&&(this.isAdd=!0,this.onActionBegin(),e.startEdit=!1,this.content.scrollTop=0),t<this.maxPage-1&&"Bottom"===this.parent.editSettings.newRowPosition&&(this.isAdd=!0,this.parent.setProperties({pageSettings:{currentPage:this.maxPage-1}},!0),e.startEdit=!1,this.content.scrollTop=this.offsets[this.offsetKeys.length])}},t.prototype.getRowObjectByIndex=function(e){var t=this.getRowCollection(e,!1,!0);return t},t.prototype.getBlockSize=function(){return this.parent.pageSettings.pageSize>>1},t.prototype.getBlockHeight=function(){return this.getBlockSize()*this.parent.getRowHeight()},t.prototype.isEndBlock=function(e){var t=Object(j["cb"])(this.parent)?this.getGroupedTotalBlocks():this.getTotalBlocks();return e>=t||e===t-1},t.prototype.getGroupedTotalBlocks=function(){var e=this.parent.vcRows;return Math.floor(e.length/this.getBlockSize()<1?1:e.length/this.getBlockSize())},t.prototype.getTotalBlocks=function(){return Math.ceil(this.count/this.getBlockSize())},t.prototype.getColumnOffset=function(e){return 0|this.vgenerator.cOffsets[e]},t.prototype.getModelGenerator=function(){return new lh(this.parent)},t.prototype.resetScrollPosition=function(e){this.actions.some(function(t){return t===e})&&(this.preventEvent=0!==this.content.scrollTop,this.content.scrollTop=0),"virtualscroll"!==e&&(this.isAdd=!1)},t.prototype.onActionBegin=function(e){this.parent.setProperties({pageSettings:{currentPage:1}},!0)},t.prototype.getRows=function(){return this.vgenerator.getRows()},t.prototype.getRowByIndex=function(e){var t;return Object(j["cb"])(this.parent)?t=this.parent.getDataRows()[e]:this.prevInfo&&(t=this.getRowCollection(e,!1)),t},t.prototype.getMovableVirtualRowByIndex=function(e){return this.getRowCollection(e,!0)},t.prototype.getFrozenRightVirtualRowByIndex=function(e){return this.getRowCollection(e,!1,!1,!0)},t.prototype.getRowCollection=function(e,t,i,n){var r=this.prevInfo.blockIndexes,s=(r[0]-1)*this.getBlockSize(),a=t?this.parent.getMovableDataRows():this.parent.getDataRows();a=n?this.parent.getFrozenRightDataRows():a;var o=i?this.parent.getCurrentViewRecords():a;i&&this.parent.allowGrouping&&this.parent.groupSettings.columns.length&&(s=parseInt(this.parent.getRows()[0].getAttribute(x["d"]),10),o=o.filter(function(e){return Object(w["T"])(e.items)}));var l=o[e-s];return this.parent.frozenRows&&this.parent.pageSettings.currentPage>1&&(l=i?e<=this.parent.frozenRows?this.parent.getRowsObject()[e].data:l:e<=this.parent.frozenRows?a[e]:a[e-s+this.parent.frozenRows]),l},t.prototype.getVirtualRowIndex=function(e){var t=this.prevInfo.blockIndexes,i=(t[0]-1)*this.getBlockSize();return i+e},t.prototype.refreshOffsets=function(){var e=this.parent,t=0,i=this.getBlockSize(),n=Object(j["cb"])(this.parent)?this.getGroupedTotalBlocks():this.getTotalBlocks();this.prevHeight=this.offsets[n],this.maxBlock=n%2===0?n-2:n-1,this.offsets={};for(var r=Array.apply(null,Array(n)).map(function(){return++t}),s=0;s<r.length;s++){var a=(this.vgenerator.cache[r[s]]||[]).length,o=Object(j["cb"])(this.parent)?e.vcRows.length%i:this.count%i,l=!Object(j["cb"])(this.parent)&&r[s]in this.vgenerator.cache?a*this.parent.getRowHeight():o&&r[s]===n?o*this.parent.getRowHeight():this.getBlockHeight();this.offsets[r[s]]=(0|this.offsets[r[s]-1])+l,this.tmpOffsets[r[s]]=0|this.offsets[r[s]-1]}this.offsetKeys=Object.keys(this.offsets),Object(j["cb"])(this.parent)&&(this.parent.vGroupOffsets=this.offsets),this.parent.enableColumnVirtualization&&this.vgenerator.refreshColOffsets()},t.prototype.refreshVirtualElement=function(){this.vgenerator.refreshColOffsets(),this.setVirtualHeight()},t.prototype.setVisible=function(e){var t,i,n=this.parent,r=this.parent.getFrozenColumns();r&&(t=[].slice.call(this.parent.getFrozenVirtualContent().querySelectorAll("col")),i=[].slice.call(this.parent.getMovableVirtualContent().querySelectorAll("col")));var s,a=[];a=this.getRows(),a.some(function(e){return e.isDataRow&&(s=e),e.isDataRow});var o=!0;!n.groupSettings.columns.length&&s&&(o=!1);for(var l=n.getDataRows(),d=0,c=e.length;d<c;d++){var h=e[d],p=n.getNormalizedColumnIndex(h.uid),u=!0===h.visible?"":"none",m=void 0;if(t&&i?p>=r?(m=i,l=this.parent.getMovableRows(),p-=r):m=t:m=this.getColGroup().children,-1!==p&&s&&p<s.cells.length&&Object(w["mb"])(m[p],{display:u}),!o){var g=void 0;h.width&&(g=h.visible?this.virtualEle.wrapper.offsetWidth+parseInt(h.width.toString(),10):this.virtualEle.wrapper.offsetWidth-parseInt(h.width.toString(),10)),g>n.width?(this.setDisplayNone(l,p,u,a),this.parent.enableColumnVirtualization&&this.virtualEle.setWrapperWidth(g+""),this.refreshVirtualElement()):o=!0}!this.parent.invokedFromMedia&&h.hideAtMedia&&this.parent.updateMediaColumns(h),this.parent.invokedFromMedia=!1}o||r?this.refreshContentRows({requestType:"refresh"}):this.parent.notify(I["Tc"],{rows:a,args:{isFrozen:!1,rows:a}})},t.prototype.selectVirtualRow=function(e){var t=this;if(e.isAvailable=e.selectedIndex<this.count,e.isAvailable&&!this.isContextMenuOpen&&"upArrow"!==this.activeKey&&"downArrow"!==this.activeKey&&!this.isSelection&&!this.requestTypes.some(function(e){return e===t.requestType})&&!this.parent.selectionModule.isInteracted){var i=this.parent.getRowByIndex(e.selectedIndex),n=this.parent.getRowHeight();if(!i||!this.isRowInView(i)){this.isSelection=!0,this.selectedRowIndex=e.selectedIndex;var r=(e.selectedIndex+1)*n;if(!Object(w["T"])(r)){var s=this.content.scrollTop<r?"down":"up";this.selectRowIndex=e.selectedIndex,this.content.scrollTop=r,this.isSelectionScroll=this.observer.check(s)}}}this.parent.isFrozenGrid()&&this.requestType?this.parent.getTablesCount()===this.frzIdx?(this.requestType=this.empty,this.frzIdx=1):this.frzIdx++:this.requestType=this.empty},t.prototype.isRowInView=function(e){var t=e.getBoundingClientRect().top,i=e.getBoundingClientRect().bottom;return t>=this.content.getBoundingClientRect().top&&i<=this.content.getBoundingClientRect().bottom},t}(rh["a"]),hh=function(e){function t(t,i){var n=e.call(this,t,i)||this;return n.virtualEle=new ph,n.isMovable=!1,n.gen=new lh(n.parent),n.parent.on(I["qb"],n.setVisible,n),n.parent.on(I["sd"],function(e){return"X"===e.virtualInfo.sentinelInfo.axis?n.refreshUI():null},n),n}return dh(t,e),t.prototype.renderTable=function(){this.gen.refreshColOffsets(),this.parent.setColumnIndexesInView(this.gen.getColumnIndexes(this.getPanel().querySelector("."+x["v"]))),e.prototype.renderTable.call(this),this.virtualEle.table=this.getTable(),this.virtualEle.content=this.getPanel().querySelector("."+x["v"]),this.virtualEle.content.style.position="relative",this.virtualEle.renderWrapper(),this.virtualEle.renderPlaceHolder("absolute")},t.prototype.appendContent=function(e){this.isMovable?(this.virtualEle.movableWrapper.appendChild(e),this.isMovable=!1):this.virtualEle.wrapper.appendChild(e)},t.prototype.refreshUI=function(){this.isMovable=this.parent.isFrozenGrid(),this.setFrozenTable(this.parent.getMovableVirtualContent()),this.gen.refreshColOffsets(),this.parent.setColumnIndexesInView(this.gen.getColumnIndexes(this.getPanel().querySelector("."+x["v"]))),e.prototype.refreshUI.call(this),this.setFrozenTable(this.parent.getFrozenVirtualContent())},t.prototype.setVisible=function(e){var t,i,n,r,s,a=this.parent,o=this.parent.getFrozenColumns();o&&(r=[].slice.call(this.parent.getFrozenVirtualHeader().querySelectorAll("col")),s=[].slice.call(this.parent.getMovableVirtualHeader().querySelectorAll("col")));for(var l=0,d=e.length;l<d;l++){var c=e[l];i=a.getNormalizedColumnIndex(c.uid),t=c.visible?"":"none";var h=void 0;if(r&&s?i>=o?(h=s,i-=o):h=r:h=this.getColGroup().children,Object(w["mb"])(h[i],{display:t}),a.enableColumnVirtualization&&!a.groupSettings.columns.length){var p=void 0;p=c.visible?this.virtualEle.wrapper.offsetWidth+parseInt(c.width.toString(),10):this.virtualEle.wrapper.offsetWidth-parseInt(c.width.toString(),10),p>a.width?(this.setDisplayNone(c,t),this.virtualEle.setWrapperWidth(p+""),this.gen.refreshColOffsets()):n=!0}else n=!0;n&&!o&&this.refreshUI()}o&&this.parent.notify(I["nb"],{})},t.prototype.setFrozenTable=function(e){this.parent.isFrozenGrid()&&this.parent.enableColumnVirtualization&&this.parent.contentModule.isXaxis()&&this.parent.contentModule.setTable(e.querySelector("."+x["C"]))},t.prototype.setDisplayNone=function(e,t){var i=this.parent.isFrozenGrid(),n=this.getTable();i&&"movable"===e.getFreezeTableName()&&(n=this.parent.getMovableVirtualHeader().querySelector("."+x["C"]));for(var r=0,s=[].slice.apply(n.querySelectorAll("th.e-headercell"));r<s.length;r++){var a=s[r];if(a.querySelector("[e-mappinguid]")&&a.querySelector("[e-mappinguid]").getAttribute("e-mappinguid")===e.uid){Object(w["mb"])(a,{display:t}),""===t&&Object(w["gb"])([a],"e-hide");break}}},t}(sh["a"]),ph=function(){function e(){}return e.prototype.renderWrapper=function(e){this.wrapper=Object(w["C"])("div",{className:"e-virtualtable",styles:"min-height:"+Object(w["H"])(e)}),this.wrapper.appendChild(this.table),this.content.appendChild(this.wrapper)},e.prototype.renderPlaceHolder=function(e){void 0===e&&(e="relative"),this.placeholder=Object(w["C"])("div",{className:"e-virtualtrack",styles:"position:"+e}),this.content.appendChild(this.placeholder)},e.prototype.renderFrozenWrapper=function(e){this.wrapper=Object(w["C"])("div",{className:"e-virtualtable",styles:"min-height:"+Object(w["H"])(e)+"; display: flex"}),this.content.appendChild(this.wrapper)},e.prototype.renderFrozenPlaceHolder=function(){this.placeholder=Object(w["C"])("div",{className:"e-virtualtrack"}),this.content.appendChild(this.placeholder)},e.prototype.renderMovableWrapper=function(e){this.movableWrapper=Object(w["C"])("div",{className:"e-virtualtable",styles:"min-height:"+Object(w["H"])(e)}),this.movableContent.appendChild(this.movableWrapper)},e.prototype.renderMovablePlaceHolder=function(){this.movablePlaceholder=Object(w["C"])("div",{className:"e-virtualtrack"}),this.movableContent.appendChild(this.movablePlaceholder)},e.prototype.adjustTable=function(e,t){this.wrapper.style.transform="translate("+e+"px, "+t+"px)"},e.prototype.adjustMovableTable=function(e,t){this.movableWrapper.style.transform="translate("+e+"px, "+t+"px)"},e.prototype.setMovableWrapperWidth=function(e,t){this.movableWrapper.style.width=e?e+"px":t?"100%":""},e.prototype.setMovableVirtualHeight=function(e,t){this.movablePlaceholder.style.height=e+"px",this.movablePlaceholder.style.width=t},e.prototype.setWrapperWidth=function(e,t){this.wrapper.style.width=e?e+"px":t?"100%":""},e.prototype.setVirtualHeight=function(e,t){this.placeholder.style.height=Object(w["T"])(e)?"0px":e+"px",this.placeholder.style.width=t},e.prototype.setFreezeWrapperWidth=function(e,t,i){e.style.width=t?t+"px":i?"100%":""},e}(),uh=function(){function e(e,t){this.parent=e,this.locator=t,this.addEventListener()}return e.prototype.getModuleName=function(){return"virtualscroll"},e.prototype.instantiateRenderer=function(){this.parent.log(["limitation","virtual_height"],"virtualization");var e=this.locator.getService("rendererFactory");this.parent.isFrozenGrid()||(this.parent.enableColumnVirtualization&&e.addRenderer(A["b"].Header,new hh(this.parent,this.locator)),e.addRenderer(A["b"].Content,new ch(this.parent,this.locator))),this.ensurePageSize()},e.prototype.ensurePageSize=function(){var e=this.parent.getRowHeight(),t=this.parent.height.toString().indexOf("%")<0?this.parent.height:this.parent.element.getBoundingClientRect().height;this.blockSize=~~(t/e);var i=2*this.blockSize,n=this.parent.pageSettings.pageSize;this.parent.setProperties({pageSettings:{pageSize:n<i?i:n}},!0)},e.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(I["Jc"],this.instantiateRenderer,this),this.parent.on(I["rb"],this.refreshVirtualElement,this),this.parent.on(I["xb"],this.createVirtualValidationForm,this),this.parent.on(I["ue"],this.virtualEditFormValidation,this),this.parent.on(I["Hb"],this.destroy,this))},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(I["Jc"],this.instantiateRenderer),this.parent.off(I["rb"],this.refreshVirtualElement),this.parent.off(I["xb"],this.createVirtualValidationForm),this.parent.off(I["ue"],this.virtualEditFormValidation),this.parent.off(I["Hb"],this.destroy))},e.prototype.getCurrentEditedData=function(e){var t={virtualData:Object(w["G"])({},{},e,!0),isAdd:!1,isScroll:!1,endEdit:!0};return this.parent.notify(I["sc"],t),t.virtualData},e.prototype.createVirtualValidationForm=function(e){var t=this.parent;if(t.enableVirtualization&&"Normal"===t.editSettings.mode){var i=t.columns,n=new Y["a"](this.locator,null,this.parent),r=Object(w["G"])({},{},t.getRowObjectFromUID(e.uid),!0);t.notify(I["ud"],r);var s=e.argsCreator(this.getCurrentEditedData(e.prevData),{},!1);s.isCustomFormValidation=!0,s.row=n.render(r,i),e.renderer.update(s);for(var a={},o=0;o<i.length;o++)i[o].visible&&i[o].validationRules&&Object(j["Bb"])(i[o],0,a,{},{},i.length,!0);s.form.classList.add("e-virtual-validation"),t.editModule.virtualFormObj=t.editModule.createFormObj(s.form,a)}},e.prototype.virtualEditFormValidation=function(e){var t=this.parent,i=t.element.querySelector('.e-griderror:not([style*="display: none"])');if(t.editModule.virtualFormObj)if(i&&"none"!==i.style.display){var n=i.getBoundingClientRect(),r=t.element.querySelectorAll(".e-gridform"),s=r[0],a=t.getContent().getBoundingClientRect().left;if(r.length>1&&(s="Right"!==t.getFrozenMode()?r[1]:r[0],a=t.getMovableVirtualContent().getBoundingClientRect().left),n.left<a||n.right>t.element.offsetWidth){var o=s.querySelector('.e-tooltip-wrap:not([style*="display: none"])');this.scrollToEdit(o,{editIdx:e.editIdx,addIdx:e.addIdx},!0)}}else if(t.editModule.virtualFormObj&&(!i||"none"===i.style.display)){for(var l=t.editModule.virtualFormObj.element.querySelectorAll('.e-tooltip-wrap:not([style*="display: none"])'),d=0;d<l.length;d++)Object(w["fb"])(l[d]);if(this.setEditedDataToValidationForm(t.editModule.virtualFormObj.element,this.getCurrentEditedData(e.prevData)),e.isValid=t.editModule.virtualFormObj.validate(),!e.isValid){o=t.editModule.virtualFormObj.element.querySelector('.e-tooltip-wrap:not([style*="display: none"])');this.scrollToEdit(o,{editIdx:e.editIdx,addIdx:e.addIdx})}}},e.prototype.scrollToEdit=function(e,t,i){var n=this.parent;if(e){var r=n.columnModel,s=Object(j["ub"])(e.id).split("_")[0],a=n.getColumnByField(s),o=this.parent.getContent().firstElementChild.scrollTop,l=n.getRowByIndex(t.editIdx);if(i||!a||!Object(w["T"])(t.addIdx)&&o>0||!Object(w["T"])(t.editIdx)&&!l){for(var d=void 0,c=0;c<r.length&&!a;c++)if(r[c].field===s){d=r[c];break}i&&(d=a),this.parent.notify(I["Zd"],d)}}},e.prototype.setEditedDataToValidationForm=function(e,t){for(var i=[].slice.call(e.getElementsByClassName("e-field")),n=0,r=i.length;n<r;n++){var s=Object(j["A"])(this.parent,i[n].getAttribute("e-mappinguid")),a=Object(w["R"])(s.field,t);a=Object(w["T"])(a)?"":a,i[n].value=a}},e.prototype.refreshVirtualElement=function(e){if(this.parent.enableColumnVirtualization&&"resize"===e.module){var t=this.locator.getService("rendererFactory");t.getRenderer(A["b"].Content).refreshVirtualElement()}},e.prototype.destroy=function(){this.removeEventListener()},e}(),mh=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),gh=function(e){function t(t){var i=e.call(this,t)||this;return i.addEventListener(),i}return mh(t,e),t.prototype.addEventListener=function(){this.parent.on(ke["B"],this.getDatas,this)},t.prototype.getDatas=function(e){this.visualData=e.data},t.prototype.getDataInfo=function(){return e.prototype.getData.call(this)},t.prototype.generateRows=function(t,i){!Object(w["T"])(i.virtualInfo)&&i.virtualInfo.loadNext&&i.virtualInfo.nextInfo.page!==this.parent.pageSettings.currentPage?this.parent.setProperties({pageSettings:{currentPage:i.virtualInfo.nextInfo.page}},!0):Object(w["T"])(i.virtualInfo)||i.virtualInfo.loadNext||i.virtualInfo.page===this.parent.pageSettings.currentPage||this.parent.setProperties({pageSettings:{currentPage:i.virtualInfo.page}},!0);var n=this.getDataInfo();if(Object(w["T"])(i.virtualInfo)||("right"!==i.virtualInfo.direction&&"left"!==i.virtualInfo.direction?i.virtualInfo.blockIndexes=n.blockIndexes:i.virtualInfo.blockIndexes=this.getBlockIndexes(i.virtualInfo.page)),this.parent.dataSource instanceof O["a"]&&void 0!==this.parent.dataSource.dataSource.url&&!this.parent.dataSource.dataSource.offline&&""!==this.parent.dataSource.dataSource.url||Object(Se["g"])(this.parent))return e.prototype.generateRows.call(this,t,i);Object(w["T"])(i.requestType)||"collapseAll"!==i.requestType.toString()||(i.requestType="refresh");for(var r=e.prototype.generateRows.call(this,t,i),s=0;s<r.length;s++)r[s].index=this.visualData.indexOf(r[s].data);return r},t.prototype.checkAndResetCache=function(e){var t=["paging","refresh","sorting","filtering","searching","reorder","save","delete"].some(function(t){return e===t});if(this.parent.dataSource instanceof O["a"]&&void 0!==this.parent.dataSource.dataSource.url&&!this.parent.dataSource.dataSource.offline&&""!==this.parent.dataSource.dataSource.url||Object(Se["g"])(this.parent)){var i="model",n=this[i].currentPage;t?(this.cache={},this.data={},this.groups={}):"virtualscroll"===e&&this.cache[n]&&this.cache[n].length>this.parent.contentModule.getBlockSize()&&delete this.cache[n]}else(t||"virtualscroll"===e)&&(this.cache={},this.data={},this.groups={});return t},t}(lh),fh=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),bh=function(e){function t(t,i){var n=e.call(this,t,i)||this;return n.isExpandCollapse=!1,n.translateY=0,n.maxiPage=0,n.recordAdded=!1,n.startIndex=-1,n.endIndex=-1,n.preTranslate=0,n.isRemoteExpand=!1,n.isDataSourceChanged=!1,n.addEventListener(),n}return fh(t,e),t.prototype.getModelGenerator=function(){return new gh(this.parent)},t.prototype.getRowByIndex=function(e){return this.parent.getDataRows().filter(function(t){return parseInt(t.getAttribute("aria-rowindex"),10)===e})[0]},t.prototype.addEventListener=function(){this.parent.on(ke["fb"],this.virtualOtherAction,this),this.parent.on(ke["I"],this.indexModifier,this)},t.prototype.virtualOtherAction=function(e){e.setTop?(this.translateY=0,this.startIndex=0,this.endIndex=this.parent.pageSettings.pageSize-1):e.isExpandCollapse&&(this.isExpandCollapse=!0)},t.prototype.indexModifier=function(e){var t=this.parent.getContent().querySelector(".e-content");if(this.recordAdded&&this.startIndex>-1&&this.endIndex>-1){if(this.endIndex>e.count-this.parent.pageSettings.pageSize){var i=~~(t.scrollTop/this.parent.getRowHeight()),n=i+this.parent.getRows().length;n>e.count&&(n=i+(e.count-i)),this.startIndex=n-this.parent.getRows().length,this.endIndex=n}else this.startIndex+=1,this.endIndex+=1;this.recordAdded=!1}this.isDataSourceChanged&&(this.startIndex=0,this.endIndex=this.parent.pageSettings.pageSize-1),e.startIndex=this.startIndex,e.endIndex=this.endIndex},t.prototype.eventListener=function(t){var i=this;this.parent.dataSource instanceof O["a"]&&void 0!==this.parent.dataSource.dataSource.url&&this.parent.dataSource.dataSource.offline&&""!==this.parent.dataSource.dataSource.url&&Object(Se["g"])(this.parent)?e.prototype.eventListener.call(this,"on"):(this.parent[t]("data-ready",this.onDataReady,this),this.parent[t]("refresh-virtual-block",this.refreshContentRows,this),this.fn=function(){i.observers.observes(function(e){return i.scrollListeners(e)},i.onEnteredAction()),i.parent.off("content-ready",i.fn)},this.parent.addEventListener("dataBound",this.dataBoundEvent.bind(this)),this.parent.addEventListener("rowSelected",this.rowSelectedEvent.bind(this)),this.parent[t]("select-virtual-Row",this.toSelectVirtualRow,this),this.parent.on("content-ready",this.fn,this),this.parent.addEventListener(ke["b"],this.onActionComplete.bind(this)),this.parent[t]("virtual-scroll-edit-action-begin",this.beginEdit,this),this.parent[t]("virtual-scroll-add-action-begin",this.beginAdd,this),this.parent[t]("virtual-scroll-edit-success",this.virtualEditSuccess,this),this.parent[t]("edit-reset",this.resetIseditValue,this),this.parent[t]("get-virtual-data",this.getData,this),this.parent[t]("virtual-scroll-edit-cancel",this.cancelEdit,this),this.parent[t]("select-row-on-context-open",this.toSelectRowOnContextOpen,this),this.parent[t]("refresh-virtual-editform-cells",this.refreshCell,this),this.parent[t]("virtaul-cell-focus",this.cellFocus,this))},t.prototype.cellFocus=function(t){var i="virtualCellFocus";e.prototype[i].call(this,t)},t.prototype.onDataReady=function(t){e.prototype.onDataReady.call(this,t),this.parent.dataSource instanceof O["a"]&&void 0!==this.parent.dataSource.dataSource.url&&this.parent.dataSource.dataSource.offline&&""!==this.parent.dataSource.dataSource.url&&Object(Se["g"])(this.parent)||(Object(w["T"])(t.count)||(this.totalRecords=t.count,this.parent.enableColumnVirtualization||Object(w["R"])("virtualEle",this).setVirtualHeight(this.parent.getRowHeight()*t.count,"100%")),(!Object(w["T"])(t.requestType)&&"collapseAll"===t.requestType.toString()||this.isDataSourceChanged&&(-1===this.startIndex||0===this.startIndex&&0===this["preStartIndex"]))&&(this.contents.scrollTop=0,this.isDataSourceChanged=!1))},t.prototype.renderTable=function(){e.prototype.renderTable.call(this),this.parent.dataSource instanceof O["a"]&&void 0!==this.parent.dataSource.dataSource.url&&this.parent.dataSource.dataSource.offline&&""!==this.parent.dataSource.dataSource.url&&Object(Se["g"])(this.parent)||(Object(w["R"])("observer",this).options.debounceEvent=!1,this.observers=new vh(Object(w["R"])("observer",this).element,Object(w["R"])("observer",this).options),this.contents=this.getPanel().firstChild)},t.prototype.getTranslateY=function(t,i,n,r){return this.parent.dataSource instanceof O["a"]&&void 0!==this.parent.dataSource.dataSource.url&&!this.parent.dataSource.dataSource.offline&&""!==this.parent.dataSource.dataSource.url||Object(Se["g"])(this.parent)?this.isRemoteExpand?(this.isRemoteExpand=!1,this.preTranslate):(this.preTranslate=e.prototype.getTranslateY.call(this,t,i,n,r),e.prototype.getTranslateY.call(this,t,i,n,r)):e.prototype.getTranslateY.call(this,t,i,n,r)},t.prototype.dataBoundEvent=function(){var t="dataBound",i="initialRowTop";if(this.parent.getRows().length&&!this[i]&&!Object(w["T"])(this.parent.getRowByIndex(0))){var n=this.parent.getRowByIndex(0).getBoundingClientRect().top,r=this.parent.element.getBoundingClientRect().top;this[i]=n>0?this.parent.getRowByIndex(0).getBoundingClientRect().top-r:this.content.getBoundingClientRect().top-this.parent.getRowByIndex(0).getBoundingClientRect().height}e.prototype[t].call(this)},t.prototype.rowSelectedEvent=function(t){var i="rowSelected";e.prototype[i].call(this,t)},t.prototype.toSelectVirtualRow=function(t){if(!this.parent.isEdit){var i="selectVirtualRow",n="containerRect";Object(w["T"])(this.observer[n])&&(this.observer[n]=this.observers[n]),(Object(w["T"])(this.parent["clipboardModule"].treeGridParent.editModule)||0!==t.selectedIndex||Object(w["T"])(this.parent["clipboardModule"].treeGridParent.editModule["addRowIndex"]))&&e.prototype[i].call(this,t)}},t.prototype.refreshCell=function(e){e.cells=this.generateCells()},t.prototype.generateCells=function(){for(var e=[],t=0;t<this.parent.columns.length;t++)e.push(this.generateCell(this.parent.columns[t]));return e},t.prototype.generateCell=function(e,t,i,n,r,s){var a={visible:e.visible,isDataCell:!Object(w["T"])(e.field||e.template),isTemplate:!Object(w["T"])(e.template),rowID:t,column:e,cellType:Object(w["T"])(i)?A["a"].Data:i,colSpan:n,commands:e.commands,isForeignKey:e.isForeignColumn&&e.isForeignColumn(),foreignKeyData:e.isForeignColumn&&e.isForeignColumn()&&Object(w["R"])(e.field,s)};return(a.isDataCell||"checkbox"===a.column.type||a.commands)&&(a.index=r),new re["a"](a)},t.prototype.beginEdit=function(e){var t='.e-row[aria-rowindex="'+e.index+'"]',i=this.parent.getContent().querySelector(t).rowIndex,n=this.parent.getCurrentViewRecords()[i];e.data=n},t.prototype.beginAdd=function(t){var i="addActionBegin",n="isAdd",r={newRowPosition:this.rowPosition,addRowIndex:this.addRowIndex,ariaRowIndex:this.ariaRowIndex};this.parent.notify("get-row-position",r),this.rowPosition=r.newRowPosition,this.addRowIndex=r.addRowIndex,this.ariaRowIndex=r.ariaRowIndex;var s=this.parent.getRows(),a=s.length?+s[0].getAttribute("aria-rowindex"):0,o=s.length?+s[s.length-1].getAttribute("aria-rowindex"):0,l=this.parent.selectedRowIndex>=a&&this.parent.selectedRowIndex<=o;"Top"!==this.rowPosition&&"Bottom"!==this.rowPosition&&(this[n]=!0),"Top"!==this.rowPosition&&"Bottom"!==this.rowPosition&&(this.addRowIndex&&-1!==this.addRowIndex||-1!==this.parent.selectedRowIndex&&l)||e.prototype[i].call(this,t)},t.prototype.restoreEditState=function(){var t="restoreEdit";e.prototype[t].call(this)},t.prototype.resetIseditValue=function(){var t="resetIsedit",i="isAdd";this.parent.notify("reset-edit-props",{}),"Top"!==this.rowPosition&&"Bottom"!==this.rowPosition||!this[i]||e.prototype[t].call(this)},t.prototype.virtualEditSuccess=function(){var e="isAdd",t=this.parent.getContent().querySelector(".e-content");this[e]&&t.querySelector(".e-addedrow")&&(this.recordAdded=!0)},t.prototype.cancelEdit=function(t){var i="editCancel";e.prototype[i].call(this,t)},t.prototype.toSelectRowOnContextOpen=function(t){var i="selectRowOnContextOpen";e.prototype[i].call(this,t)},t.prototype.restoreNewRow=function(){var e="isAdd",t=this.parent.getContent().querySelector(".e-content");this[e]&&!t.querySelector(".e-addedrow")&&(this.parent.isEdit=!1,this.parent.addRecord())},t.prototype.getData=function(t){var i="getVirtualData";e.prototype[i].call(this,t)},t.prototype.onActionComplete=function(t){if("add"===t.requestType){var i={newRowPosition:this.rowPosition,addRowIndex:this.addRowIndex,ariaRowIndex:this.ariaRowIndex};this.parent.notify("get-row-position",i),this.rowPosition=i.newRowPosition,this.addRowIndex=i.addRowIndex,this.ariaRowIndex=i.ariaRowIndex}var n="actionComplete";e.prototype[n].call(this,t)},t.prototype.onEnteredAction=function(){var e=this;return function(t,i,n,r,s,a){var o="directVirtualRender";if(!e.parent[o]){var l="preventEvent";w["d"].isIE&&!s&&a&&!e[l]&&e.parent.showSpinner();var d="X"===i.axis,c=e.getColumnOffset(d?e.vgenerator.getColumnIndexes()[0]-1:e.prevInfo.columnIndexes[0]-1);if(d){var h=Object.keys(e.vgenerator.cOffsets).length-e.prevInfo.columnIndexes.length,p=e.vgenerator.cOffsets[h-1];c=c>p?p:c}e.virtualEle.adjustTable(c,e.translateY),e.parent.enableColumnVirtualization&&e.header.virtualEle.adjustTable(c,0)}}},t.prototype.scrollListeners=function(e){var t=e.sentinel,i=this.parent.pageSettings.pageSize-Math.ceil(this.parent.pageSettings.pageSize/2),n=this.parent.getContent().querySelector(".e-content"),r=i*this.parent.getRowHeight(),s=e.offset.top-this.translateY<0,a=Math.ceil(e.offset.top-this.translateY)>=r,o="selectedRowIndex";if(s&&"right"!==e.direction&&"left"!==e.direction){var l=+(this.parent.height.toString().indexOf("%")<0?this.parent.height:this.parent.element.getBoundingClientRect().height),d=~~(n.scrollTop/this.parent.getRowHeight())+Math.ceil(l/this.parent.getRowHeight())-this.parent.pageSettings.pageSize;if(d=d>0?d:0,Object(w["T"])(this[o])||-1===this[o]||d===this[o]||(d=this[o]),this.startIndex=d,this.endIndex=d+this.parent.pageSettings.pageSize,this.endIndex>this.totalRecords){var c=this.totalRecords-1,h=this.endIndex%c;this.endIndex=c,this.startIndex=this.startIndex-h<0?0:this.startIndex-h}var p=Math.ceil(e.offset.top/this.parent.getRowHeight());p%=this.parent.pageSettings.pageSize;var u=0;if(!Object(w["T"])(this.parent.getRows()[p])&&!Object(w["T"])(this.parent.getContent().querySelectorAll(".e-content tr")[p])){var m=this.parent.getContent().querySelectorAll(".e-content tr")[p].querySelector("td").getAttribute("index");u=+m}if(0===u)this.parent.allowRowDragAndDrop?this.translateY=e.offset.top-2*this.parent.getRowHeight():this.translateY=e.offset.top;else{var g=this.parent.getRowHeight();this.translateY=e.offset.top-i*g>0?e.offset.top-i*g+10:0}}else if(a&&"right"!==e.direction&&"left"!==e.direction){var f=~~(n.scrollTop/this.parent.getRowHeight()),b=!(this[o]+this.parent.pageSettings.pageSize<this.totalRecords);Object(w["T"])(this[o])||-1===this[o]||f===this[o]||b||(f=this[o]);var v=f+this.parent.pageSettings.pageSize;v>this.totalRecords&&(v=f+(this.totalRecords-f)),this.startIndex=b?f:v-this.parent.pageSettings.pageSize,this.endIndex=v,e.offset.top>this.parent.getRowHeight()*this.totalRecords?this.translateY=this.getTranslateY(e.offset.top,n.getBoundingClientRect().height):this.parent.allowRowDragAndDrop?this.translateY=e.offset.top-2*this.parent.getRowHeight():this.translateY=e.offset.top}if(a&&e.offset.top<this.parent.getRowHeight()*this.totalRecords||s||"right"===e.direction||"left"===e.direction){var y=this.currentInfo=Object(w["R"])("getInfoFromView",this).apply(this,[e.direction,t,e.offset]);this.previousInfo=y,this.parent.setColumnIndexesInView(this.parent.enableColumnVirtualization?y.columnIndexes:[]);var C=y.loadNext&&!y.loadSelf?y.nextInfo.page:y.page;this.parent.setProperties({pageSettings:{currentPage:C}},!0),"right"!==e.direction&&"left"!==e.direction&&(y.event="refresh-virtual-block"===y.event?"model-changed":y.event),this.parent.notify(y.event,{requestType:"virtualscroll",virtualInfo:y,focusElement:e.focusElement})}},t.prototype.appendContent=function(t,i,n){if(this.parent.dataSource instanceof O["a"]&&void 0!==this.parent.dataSource.dataSource.url&&!this.parent.dataSource.dataSource.offline&&""!==this.parent.dataSource.dataSource.url||Object(Se["g"])(this.parent))Object(w["R"])("isExpandCollapse",n)&&(this.isRemoteExpand=!0),e.prototype.appendContent.call(this,t,i,n);else{var r=n.virtualInfo.sentinelInfo&&"Y"===n.virtualInfo.sentinelInfo.axis&&Object(w["R"])("currentInfo",this).page&&Object(w["R"])("currentInfo",this).page!==n.virtualInfo.page?Object(w["R"])("currentInfo",this):n.virtualInfo,s=r.columnIndexes[0]-1,a=this.getColumnOffset(s),o=void 0;if(this.parent.enableColumnVirtualization){this.header.virtualEle.adjustTable(a,0);var l=r.columnIndexes;o=this.getColumnOffset(l[l.length-1])-this.getColumnOffset(l[0]-1)+"",this.header.virtualEle.setWrapperWidth(o)}this.virtualEle.setWrapperWidth(o,w["d"].isIE||"edge"===w["d"].info.name),t=this.parent.createElement("tbody"),t.appendChild(i);var d="replaceWith";this.getTable().querySelector("tbody")[d](t),this.isExpandCollapse&&0!==this.translateY?this.isExpandCollapse=!1:(this.translateY=this.translateY<0?0:this.translateY,Object(w["R"])("virtualEle",this).adjustTable(a,this.translateY)),Object(w["ob"])("prevInfo",this.previousInfo?this.previousInfo:r,this),"virtualscroll"===n.requestType&&"X"===n.virtualInfo.sentinelInfo.axis&&this.parent.notify(ke["c"],{});var c="focusCell",h="restoreAdd",p="ensureSelectedRowPosition";e.prototype[c].call(this,n);var u="isAdd";this[u]&&!this.parent.getContent().querySelector(".e-content").querySelector(".e-addedrow")&&"Top"!==this.rowPosition&&"Bottom"!==this.rowPosition&&(this.ariaRowIndex>=this.startIndex?this.restoreNewRow():this.addRowIndex&&this.addRowIndex>-1&&(this[u]=!1,this.parent.isEdit=!1)),this.restoreEditState(),e.prototype[h].call(this),e.prototype[p].call(this)}},t.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off("data-ready",this.onDataReady),this.parent.off("content-ready",this.fn),this.parent.off("select-virtual-Row",this.toSelectVirtualRow),this.parent.off("dataBound",this.dataBoundEvent),this.parent.off("rowSelected",this.rowSelectedEvent),this.parent.off(ke["fb"],this.virtualOtherAction),this.parent.off(ke["I"],this.indexModifier),this.parent.off("virtual-scroll-edit-action-begin",this.beginEdit),this.parent.off("virtual-scroll-add-action-begin",this.beginAdd),this.parent.off("virtual-scroll-edit-success",this.virtualEditSuccess),this.parent.off("edit-reset",this.resetIseditValue),this.parent.off("get-virtual-data",this.getData),this.parent.off("virtual-scroll-edit-cancel",this.cancelEdit),this.parent.off("select-row-on-context-open",this.toSelectRowOnContextOpen),this.parent.off("refresh-virtual-editform-cells",this.refreshCell),this.parent.off("virtaul-cell-focus",this.cellFocus))},t}(ch),vh=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isWheeling=!1,t.newPos=0,t.lastPos=0,t.timer=0,t}return fh(t,e),t.prototype.observes=function(t,i){var n="containerRect";e.prototype[n]=Object(w["R"])("options",this).container.getBoundingClientRect(),w["l"].add(Object(w["R"])("options",this).container,"scroll",this.virtualScrollHandlers(t,i),this)},t.prototype.clear=function(){this.lastPos=null},t.prototype.virtualScrollHandlers=function(e,t){var i=this,n="chrome"===w["d"].info.name?200:100,r="options",s="movableEle",a="element",o="fromWheel",l=Object(w["D"])(e,n),d=Object(w["D"])(e,50);return this[r].prevTop=this[r].prevLeft=0,function(n){var c=i[r].movableContainer?i[r].container.scrollTop:n.target.scrollTop,h=i[r].movableContainer?i[r].scrollbar.scrollLeft:n.target.scrollLeft,p=i[r].prevTop<c?"down":"up";p=i[r].prevLeft===h?p:i[r].prevLeft<h?"right":"left",i[r].prevTop=c,i[r].prevLeft=h;var u=i.sentinelInfo[p],m=0;if(i.newPos=c,null!=i.lastPos&&(m=i.newPos-i.lastPos),i.lastPos=i.newPos,i.timer&&clearTimeout(i.timer),i.timer=setTimeout(i.clear,0),(m>100||m<-100)&&n&&n.preventDefault&&(n.returnValue=!1,n.preventDefault()),-1!==i[r].axes.indexOf(u.axis)){var g=i.check(p);if(u.entered&&"X"===u.axis&&(!i[s]||"right"!==p&&"left"!==p?t(i[a],u,p,{top:c,left:h},i[o],g):t(i[s],u,p,{top:c,left:h},i[o],g)),g){var f=l;"X"===u.axis?(f=d,f({direction:p,sentinel:u,offset:{top:c,left:h},focusElement:document.activeElement})):e({direction:p,sentinel:u,offset:{top:c,left:h},focusElement:document.activeElement})}i[o]=!1}}},t}(ah),yh=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Ch=function(){function e(e){this.prevstartIndex=-1,this.prevendIndex=-1,this.parent=e,E["a"].Inject(wh),this.addEventListener()}return e.prototype.returnVisualData=function(e){e.data=this.visualData},e.prototype.getModuleName=function(){return"virtualScroll"},e.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(ke["L"],this.collapseExpandVirtualchilds,this),this.parent.on(ke["M"],this.virtualPageAction,this),this.parent.on(ke["D"],this.destroy,this))},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(ke["L"],this.collapseExpandVirtualchilds),this.parent.off(ke["M"],this.virtualPageAction),this.parent.off(ke["D"],this.destroy))},e.prototype.collapseExpandVirtualchilds=function(e){this.parent.grid.notify(ke["fb"],{isExpandCollapse:!0}),this.expandCollapseRec=e.record,e.record.expanded="collapse"!==e.action;var t={result:this.parent.flatData,row:e.row,action:e.action,record:e.record,count:this.parent.flatData.length};(this.parent.enableVirtualization&&"Cell"===this.parent.selectionSettings.mode||"Row"===this.parent.selectionSettings.mode&&!this.parent.selectionSettings.persistSelection)&&this.parent.grid.clearSelection();var i=Object(w["R"])("isCollapseAll",this.parent)?"collapseAll":"refresh";Object(w["R"])("grid.renderModule",this.parent).dataManagerSuccess(t,{requestType:i})},e.prototype.virtualPageAction=function(e){var t=this,i=new O["a"](e.result),n=new T["a"]("expanded","notequal",null).or("expanded","notequal",void 0),r=i.executeLocal((new T["b"]).where(n)),s=r.filter(function(e){return Object(Se["c"])(t.parent,e,r)});this.visualData=s,this.parent.grid.notify(ke["B"],{data:s});var a={startIndex:-1,endIndex:-1,count:e.count};this.parent.grid.notify(ke["I"],a);var o=a.startIndex,l=a.endIndex;if(e.count=s.length,-1===o&&-1===l){var d=new T["b"],c=this.parent.grid.pageSettings.pageSize,h=this.parent.grid.pageSettings.currentPage,p=c*(h-1);d=d.skip(p).take(c),i.dataSource.json=s,e.result=i.executeLocal(d)}else{var u=e.actionArgs.requestType;if(("filtering"===u||"collapseAll"===u||"searching"===u||"refresh"===u&&this.parent.enableCollapseAll&&l>s.length)&&(o=0,l=this.parent.grid.pageSettings.pageSize-1,this.parent.grid.getContent().firstElementChild.scrollTop=0,this.parent.grid.notify(ke["fb"],{setTop:!0})),!Object(w["T"])(this.expandCollapseRec)&&("virtualscroll"===e.actionArgs.requestType||"refresh"===e.actionArgs.requestType&&o!==this.prevstartIndex)&&o<this.parent.getRows().length&&l<=o+this.parent.getRows().length&&(o=0),!Object(w["T"])(this.expandCollapseRec)){var m=this.parent.getRows(),g=s.indexOf(this.expandCollapseRec),f=s.slice(g,g+m.length);f.length<m.length&&g>=0&&0!==o?(g=s.length-m.length,g=g>0?g:0,o=g,l=s.length):Object(w["R"])("isCollapseAll",this.parent)&&(o=0,l=this.parent.grid.pageSettings.pageSize-1,this.parent.grid.notify(ke["fb"],{setTop:!0}))}!this.parent.enableCollapseAll&&!this.parent.expandStateMapping||Object(w["T"])(this.expandCollapseRec)||(e.count<this.parent.getRows()[0].getBoundingClientRect().height?o=0:this.parent["isExpandAll"]||(o=-1===this.prevstartIndex?0:this.prevstartIndex)),this.expandCollapseRec=null,e.result=s.slice(o,l),this.prevstartIndex=o,this.prevendIndex=l}this.parent.notify("updateAction",e)},e.prototype.destroy=function(){this.removeEventListener()},e}(),wh=function(e){function t(t,i){var n=e.call(this,t,i)||this;return Object(w["R"])("parent",n).off("initial-load",Object(w["R"])("instantiateRenderer",n),n),Object(w["R"])("parent",n).on("initial-load",n.instantiateRenderers,n),n}return yh(t,e),t.prototype.getModuleName=function(){return"treeVirtualScroll"},t.prototype.instantiateRenderers=function(){var e=Object(w["R"])("parent",this);Object(w["R"])("parent",this).log(["limitation","virtual_height"],"virtualization");var t=Object(w["R"])("locator",this).getService("rendererFactory");e.enableColumnVirtualization&&Object(w["R"])("addRenderer",t).apply(t,[A["b"].Header,new hh(Object(w["R"])("parent",this),Object(w["R"])("locator",this))]),Object(w["R"])("addRenderer",t).apply(t,[A["b"].Content,new bh(Object(w["R"])("parent",this),Object(w["R"])("locator",this))]),this.ensurePageSize()},t.prototype.ensurePageSize=function(){var e=Object(w["R"])("parent",this),t=e.getRowHeight();Object(w["T"])(e.height)||"string"!==typeof e.height||-1===e.height.indexOf("%")||(e.element.style.height=e.height);var i=e.height.toString().indexOf("%")<0?e.height:e.element.getBoundingClientRect().height,n=~~(i/t),r=2*n,s=e.pageSettings.pageSize;e.setProperties({pageSettings:{pageSize:s<r?r:s}},!0)},t}(uh),Oh=function(){function e(e){this.updatedEditFields=null,this.updatedAddFields=null,this.addedRecord=null,this.dialogEditValidationFlag=!1,this.ganttResources=[],this.previousResource=[],this.isResourceUpdate=!1,this.parent=e,this.localeObj=this.parent.localeObj,this.beforeOpenArgs={cancel:!1},this.types=this.getPredecessorType(),this.rowData={},this.editedRecord={},this.inputs={booleanedit:V["a"],dropdownedit:U["a"],datepickeredit:pe["a"],datetimepickeredit:ue["a"],maskededit:eh,numericedit:K["a"],stringedit:X["a"],defaultedit:X["a"]},this.processDialogFields(),this.wireEvents()}return e.prototype.wireEvents=function(){this.parent.on("chartDblClick",this.dblClickHandler,this)},e.prototype.dblClickHandler=function(e){var t=this.parent.ganttChartModule.getRecordByTarget(e);!Object(w["T"])(t)&&this.parent.editModule&&this.parent.editSettings.allowEditing&&this.openEditDialog(t)},e.prototype.processDialogFields=function(){Object(w["T"])(this.parent.editDialogFields)||this.parent.editDialogFields&&0===this.parent.editDialogFields.length?(this.updatedEditFields=this.getDefaultDialogFields(),this.updatedEditFields=this.validateDialogFields(this.updatedEditFields)):this.updatedEditFields=this.validateDialogFields(this.parent.editDialogFields),Object(w["T"])(this.parent.addDialogFields)||this.parent.addDialogFields&&0===this.parent.addDialogFields.length?(this.updatedAddFields=this.getDefaultDialogFields(),this.updatedAddFields=this.validateDialogFields(this.updatedAddFields)):this.updatedAddFields=this.validateDialogFields(this.parent.addDialogFields)},e.prototype.validateDialogFields=function(e){for(var t=[],i=0,n=0;n<e.length;n++){var r=Object(j["v"])(e[n]);"General"!==r.type||!Object(w["T"])(r.fields)&&0!==r.fields.length||(r.fields=this.getGeneralColumnFields()),"Dependency"===r.type&&Object(w["T"])(this.parent.taskFields.dependency)||"Resources"===r.type&&Object(w["T"])(this.parent.taskFields.resourceInfo)||"Notes"===r.type&&Object(w["T"])(this.parent.taskFields.notes)||("Custom"!==r.type||!Object(w["T"])(r.fields)&&0!==r.fields.length||(i+=1,r.fields=this.getCustomColumnFields()),i>1||t.push(r))}return t},e.prototype.getGeneralColumnFields=function(){for(var e=[],t=0,i=Object.keys(this.parent.columnMapping);t<i.length;t++){var n=i[t];"dependency"!==n&&"resourceInfo"!==n&&"notes"!==n&&e.push(this.parent.columnMapping[n])}return e},e.prototype.getCustomColumnFields=function(){for(var e=[],t=0;t<this.parent.customColumns.length;t++)e.push(this.parent.customColumns[t]);return e},e.prototype.getDefaultDialogFields=function(){var e=[],t={},i=this.parent.taskFields,n=this.parent.columnMapping;return 0!==Object.keys(n).length&&(t.type="General",e.push(t)),Object(w["T"])(Object(w["R"])("dependency",n))||(t={},!1!==this.parent.columnByField[n.dependency.valueOf()].visible&&(t.type="Dependency"),e.push(t)),Object(w["T"])(Object(w["R"])("resourceInfo",n))||(t={},!1!==this.parent.columnByField[n.resourceInfo.valueOf()].visible&&(t.type="Resources"),e.push(t)),Object(w["T"])(Object(w["R"])("notes",n))||(t={},!1!==this.parent.columnByField[n.notes.valueOf()].visible&&(t.type="Notes"),e.push(t)),Object(w["T"])(Object(w["R"])("segments",i))||(t={},t.type="Segments",e.push(t)),this.parent.customColumns.length>0&&(t={},t.type="Custom",e.push(t)),e},e.prototype.openAddDialog=function(){this.isEdit=!1,this.editedRecord=this.composeAddRecord(),this.createDialog()},e.prototype.getMinimumStartDate=function(){var e=S["a"].aggregates.min(this.parent.flatData,"ganttProperties.startDate");return e=Object(w["T"])(e)?new Date(this.parent.timelineModule.timelineStartDate.getTime()):new Date(e.getTime()),e=this.parent.dateValidationModule.checkStartDate(e),new Date(e.getTime())},e.prototype.composeAddRecord=function(){for(var e={ganttProperties:{}},t=this.parent.ganttColumns,i=this.parent.taskFields,n=this.parent.editModule.getNewTaskId(),r=0;r<t.length;r++){var s=t[r].field;s===i.id?(e[s]=n,e.ganttProperties.rowUniqueID=e[s]):t[r].field===i.startDate?(Object(w["T"])(e[i.endDate])?e[s]=this.getMinimumStartDate():e[s]=new Date(e[i.endDate]),this.parent.timezone&&(e[s]=this.parent.dateValidationModule.remove(e[s],this.parent.timezone)),e.ganttProperties.startDate=new Date(e[s])):t[r].field===i.endDate?(Object(w["T"])(e[i.startDate])?e[s]=this.getMinimumStartDate():e[s]=new Date(e[i.startDate]),this.parent.timezone&&(e[s]=this.parent.dateValidationModule.remove(e[s],this.parent.timezone)),e.ganttProperties.endDate=new Date(e[s])):t[r].field===i.duration?(e[s]=1,e.ganttProperties.duration=e[s],e.ganttProperties.durationUnit=this.parent.durationUnit.toLocaleLowerCase()):t[r].field===i.name?(e[s]=this.localeObj.getConstant("addDialogTitle")+" "+n,e.ganttProperties.taskName=e[s]):t[r].field===i.progress?(e[s]=0,e.ganttProperties.progress=e[s]):t[r].field===i.work?(e[s]=0,e.ganttProperties.work=e[s]):"taskType"===t[r].field?(e[s]=this.parent.taskType,e.ganttProperties.taskType=e[s]):e[this.parent.ganttColumns[r].field]=""}return e.ganttProperties.isAutoSchedule="Auto"===this.parent.taskMode||"Manual"!==this.parent.taskMode&&!0!==e[i.manual],e},e.prototype.openToolbarEditDialog=function(){var e=this.parent;if(e.editModule&&e.editSettings.allowEditing){this.parent.ganttChartModule.focusedRowIndex>-1&&e.selectionModule&&e.selectionModule.selectRow(this.parent.ganttChartModule.focusedRowIndex,!1,!1);var t=e.selectionModule?"Row"!==e.selectionSettings.mode&&"Both"!==e.selectionSettings.mode||1!==e.selectionModule.selectedRowIndexes.length?"Cell"===e.selectionSettings.mode&&1===e.selectionModule.getSelectedRowCellIndexes().length?e.updatedRecords[e.selectionModule.getSelectedRowCellIndexes()[0].rowIndex].ganttProperties.rowUniqueID:null:e.updatedRecords[e.selectionModule.selectedRowIndexes[0]].ganttProperties.rowUniqueID:null;Object(w["T"])(t)||this.openEditDialog(t)}},e.prototype.openEditDialog=function(e){var t=this.parent;"object"!==typeof e||Object(w["T"])(e)?Object(w["T"])(e)?t.selectedRowIndex>-1&&(this.rowData=t.currentViewData[t.selectedRowIndex],this.rowIndex=t.selectedRowIndex):(this.rowIndex=t.ids.indexOf(e.toString()),this.rowIndex>-1&&(this.rowData=t.flatData[this.rowIndex])):(this.rowIndex=this.parent.currentViewData.indexOf(e),this.rowIndex>-1&&(this.rowData=e)),this.isEdit=!0,"ResourceView"===this.parent.viewType&&0===this.rowData.level||0!==Object.keys(this.rowData).length&&(this.editedRecord=Object(w["G"])({},{},this.rowData,!0),this.createDialog())},e.prototype.createDialog=function(){var e=this,t=this.parent,i={};this.beforeOpenArgs.dialogModel=i,this.beforeOpenArgs.rowData=this.editedRecord,this.beforeOpenArgs.rowIndex=this.rowIndex;var n=this.parent.isAdaptive?"":"600px",r=this.parent.createElement("div",{id:t.element.id+"_dialog",styles:"max-width:"+n});t.element.appendChild(r),i.animationSettings={effect:"None"},i.header=this.localeObj.getConstant(this.isEdit?"editDialogTitle":"addDialogTitle"),i.isModal=!0,i.cssClass="e-gantt-dialog",i.allowDragging=!this.parent.isAdaptive,i.showCloseIcon=!0;var s=this.parent.isAdaptive?{X:"top",Y:"left"}:{X:"center",Y:"center"};i.position=s,i.height=this.parent.isAdaptive?"100%":"auto",i.target=document.body,i.close=this.dialogClose.bind(this),i.closeOnEscape=!0,i.beforeClose=function(e){"escape"==e.closedBy&&"key-pressed"==e.event.name&&"INPUT"==e.event.target.nodeName&&(e.cancel=!0)},i.open=function(t){var i=Object(w["R"])("element",t),n=i.querySelector("#"+e.parent.element.id+"GeneralTabContainer");n&&n.scrollHeight>n.offsetHeight&&n.classList.add("e-scroll"),0===e.tabObj.selectedItem&&e.tabObj.select(0),e.parent.isAdaptive&&(i.style.maxHeight="none"),e.parent.focusModule&&e.parent.focusModule.setActiveElement(i)},i.locale=this.parent.locale,i.buttons=[{buttonModel:{content:this.localeObj.getConstant("saveButton"),cssClass:"e-primary"},click:this.buttonClick.bind(this)},{buttonModel:{cssClass:"e-flat",content:this.localeObj.getConstant("cancel")},click:this.buttonClick.bind(this)}],this.createTab(i,r)},e.prototype.buttonClick=function(e){var t=e.target;t.style.pointerEvents="none",this.localeObj.getConstant("cancel").toLowerCase()===e.target.innerText.trim().toLowerCase()?this.dialog&&!this.dialogObj.isDestroyed&&(this.dialogObj.hide(),this.dialogClose()):(this.initiateDialogSave(),t.style.pointerEvents="auto")},e.prototype.dialogClose=function(){this.dialog&&this.resetValues(),Object(w["T"])(this.parent.focusModule)||Object(w["T"])(this.parent.focusModule.getActiveElement(!0))||this.parent.focusModule.getActiveElement(!0).focus()},e.prototype.resetValues=function(){this.isEdit=!1,this.isAddNewResource=!1,this.editedRecord={},this.rowData={},this.rowIndex=-1,this.addedRecord=null,this.ganttResources=[],this.dialogEditValidationFlag=!1,this.dialog&&!this.dialogObj.isDestroyed&&(this.destroyDialogInnerElements(),this.dialogObj.destroy(),Object(w["fb"])(this.dialog))},e.prototype.destroyDialogInnerElements=function(){for(var e=this.parent,t=this.beforeOpenArgs.tabModel,i=t.items,n=0;n<i.length;n++){var r=i[n].content,s=r.id;if(!Object(w["T"])(s)||""!==s)if(s=s.replace(e.element.id,""),s=s.replace("TabContainer",""),"General"===s)this.destroyCustomField(r);else if("Dependency"===s){var a=r.ej2_instances[0];a.destroy()}else if("Notes"===s){var o=r.ej2_instances[0];o.destroy()}else if("Resources"===s){var l=r.ej2_instances[0];l.destroy()}else-1!==s.indexOf("Custom")&&this.destroyCustomField(r)}},e.prototype.destroyCustomField=function(e){for(var t=e.childNodes,i=this.parent,n=0;n<t.length;n++){var r=t[n],s=r.querySelector('input[id^="'+i.element.id+'"]');if(s){var a=s.id.replace(i.element.id,""),o=r.querySelector("#"+i.element.id+a).ej2_instances[0];if(!Object(w["T"])(o)){var l=i.columnByField[a];if(!Object(w["T"])(l.edit)&&Object(w["T"])(l.edit.params)){var d=l.edit.destroy;"string"===typeof d?(d=Object(j["N"])(d,window),d()):l.edit.destroy()}else o.destroy()}}}},e.prototype.destroy=function(){this.resetValues(),this.parent.isDestroyed||(this.parent.off("chartDblClick",this.dblClickHandler),this.parent.editModule.dialogModule=void 0)},e.prototype.getEditFields=function(){return this.isEdit?this.updatedEditFields:this.updatedAddFields},e.prototype.createTab=function(e,t){var i,n=this,r=this.parent,s={},a=[],o=this.getEditFields(),l=r.taskFields,d=o.length;s.items=a,s.locale=this.parent.locale,this.beforeOpenArgs.tabModel=s;var c=0;if(d>0)for(var h=0;h<d;h++){var p=o[h],u={};if("General"===p.type){if(0===Object.keys(r.columnMapping).length)continue;Object(w["T"])(p.headerText)&&(p.headerText=this.localeObj.getConstant("generalTab")),u.content="General",this.beforeOpenArgs[u.content]=this.getFieldsModel(p.fields)}else if("Segments"===p.type){if(Object(w["T"])(l.segments))continue;Object(w["T"])(p.headerText)&&(p.headerText=this.localeObj.getConstant("segments")),u.content="Segments",this.beforeOpenArgs[u.content]=this.getSegmentsModel(p.fields)}else if("Dependency"===p.type){if(Object(w["T"])(l.dependency))continue;Object(w["T"])(p.headerText)&&(p.headerText=this.localeObj.getConstant("dependency")),u.content="Dependency",this.beforeOpenArgs[u.content]=this.getPredecessorModel(p.fields)}else if("Resources"===p.type){if(Object(w["T"])(l.resourceInfo))continue;Object(w["T"])(p.headerText)&&(p.headerText=this.localeObj.getConstant("resourceName")),u.content="Resources",this.beforeOpenArgs[u.content]=this.getResourcesModel(p.fields)}else if("Notes"===p.type){if(Object(w["T"])(l.notes))continue;Object(w["T"])(p.headerText)&&(p.headerText=this.localeObj.getConstant("notes")),u.content="Notes",this.beforeOpenArgs[u.content]=this.getNotesModel(p.fields)}else{if(Object(w["T"])(p.fields)||0===p.fields.length)continue;Object(w["T"])(p.headerText)&&(p.headerText=this.localeObj.getConstant("customTab"),0),u.content="Custom"+c++,this.beforeOpenArgs[u.content]=this.getFieldsModel(p.fields)}u.header={text:p.headerText},a.push(u)}this.beforeOpenArgs.requestType=this.isEdit?"beforeOpenEditDialog":"beforeOpenAddDialog";this.beforeOpenArgs.rowData,this.beforeOpenArgs.name,this.beforeOpenArgs.requestType,this.beforeOpenArgs.cancel;this.parent.trigger("actionBegin",this.beforeOpenArgs,function(a){if(n.renderTabItems(),!a.cancel){s.selected=n.tabSelectedEvent.bind(n),s.height=n.parent.isAdaptive?"100%":"auto",s.overflowMode="Scrollable",n.tabObj=new Pt(s),n.tabObj.isStringTemplate=!0,i=n.parent.createElement("div",{id:r.element.id+"_Tab"}),n.tabObj.appendTo(i),e.content=i,n.dialog=t,n.dialogObj=new L["a"](e),n.dialogObj.isStringTemplate=!0,n.dialogObj.appendTo(n.dialog);var o={action:"OpenDialog",requestType:n.isEdit?"openEditDialog":"openAddDialog",data:n.beforeOpenArgs.rowData,element:n.dialog,cancel:!1};n.parent.trigger("actionComplete",o,function(e){e.cancel&&n.resetValues()})}})},e.prototype.tabSelectedEvent=function(e){var t=this.parent,i=e.selectedContent.childNodes[0].id;if(this.parent.isAdaptive&&this.responsiveTabContent(i,t),i===t.element.id+"ResourcesTabContainer")this.resourceSelection(i);else if(i===t.element.id+"NotesTabContainer"){document.getElementById(i).ej2_instances[0].refresh();var n=document.querySelector("#"+this.parent.element.id+"NotesTabContainer");n.style.overflow="scroll"}else i===t.element.id+"SegmentsTabContainer"&&(Object(w["T"])(this.beforeOpenArgs.rowData.ganttProperties.startDate)?document.getElementById(i).ej2_instances[0].enableToolbarItems([this.parent.element.id+"SegmentsTabContainer_add"],!1):document.getElementById(i).ej2_instances[0].enableToolbarItems([this.parent.element.id+"SegmentsTabContainer_add"],!0))},e.prototype.responsiveTabContent=function(e,t){var i=document.getElementById(t.element.id+"_dialog_dialog-content"),n=i.clientHeight;n-=i.querySelector(".e-tab-header").offsetHeight;var r=document.querySelector("#"+e);if(r.classList.contains("e-grid")){n-=r.ej2_instances[0].getHeaderContent().offsetHeight;var s=r.querySelector(".e-toolbar");s&&(n-=s.offsetHeight)}r.parentElement.style.height=n+"px"},e.prototype.getFieldsModel=function(e){for(var t={},i=this.parent.columnByField,n=0;n<e.length;n++)if(e[n]!==this.parent.taskFields.dependency&&e[n]!==this.parent.taskFields.resourceInfo&&e[n]!==this.parent.taskFields.notes&&!Object(w["T"])(i[e[n]])){var r=e[n];this.createInputModel(i[r],t)}return t},e.prototype.createInputModel=function(e,t){var i=this,n=this.parent,r=this.parent.locale,s=this.parent.taskFields,a={placeholder:e.headerText,floatLabelType:"Auto"};switch(e.editType){case"booleanedit":var o={label:e.headerText,locale:r};t[e.field]=o;break;case"defaultedit":case"stringedit":var l=a;e.field!==n.columnMapping.duration&&e.field!==n.columnMapping.startDate&&e.field!==n.columnMapping.endDate||(l.change=function(t){i.validateScheduleFields(t,e,n)}),t[e.field]=a;break;case"numericedit":var d=a;s.progress===e.field&&(d.min=0,d.max=100),s.work===e.field&&(d.change=function(t){i.validateScheduleFields(t,e,n)}),t[e.field]=d;break;case"datepickeredit":var c=a;c.format=this.parent.getDateFormat(),c.strictMode=!0,c.firstDayOfWeek=n.timelineModule.customTimelineSettings.weekStartDay,e.field!==n.columnMapping.startDate&&e.field!==n.columnMapping.endDate||(c.renderDayCell=this.parent.renderWorkingDayCell.bind(this.parent),c.change=function(t){i.validateScheduleFields(t,e,n)}),t[e.field]=c;break;case"datetimepickeredit":var h=a;h.format=this.parent.getDateFormat(),h.strictMode=!0,h.firstDayOfWeek=n.timelineModule.customTimelineSettings.weekStartDay,e.field!==n.columnMapping.startDate&&e.field!==n.columnMapping.endDate||(h.renderDayCell=this.parent.renderWorkingDayCell.bind(this.parent),h.change=function(t){i.validateScheduleFields(t,e,n)}),t[e.field]=h;break;case"dropdownedit":if("taskType"===e.field||e.field===n.columnMapping.manual){var p="dataSource",u="fields",m=[{ID:1,Value:"FixedUnit"},{ID:2,Value:"FixedWork"},{ID:3,Value:"FixedDuration"}];a[p]=m,a[u]={value:"Value"};var g=a;g.change=function(t){e.field===s.manual&&(i.editedRecord.ganttProperties.isAutoSchedule=!t.value),i.validateScheduleFields(t,e,n)}}t[e.field]=a;break;case"maskededit":t[e.field]=a;break}return Object(w["T"])(e.edit)||Object(w["T"])(e.edit.params)||Object(w["G"])(t[e.field],e.edit.params),t},e.prototype.validateScheduleFields=function(e,t,i){var n,r=i.editModule.dialogModule.dialog,s=null,a=i.editModule.dialogModule.editedRecord,o=null,l=null;if(Object(w["T"])(e.element)?Object(w["T"])(e.container)?Object(w["T"])(e.event)||Object(w["T"])(e.event.path[1])||(n=e.event.path[1],s=n.querySelector("input").getAttribute("id"),n=n.querySelector("#"+s)):(n=e.container,s=n.querySelector("input").getAttribute("id"),n=n.querySelector("#"+s)):(n=e.element,s=n.getAttribute("id")),Object(w["T"])(n)?(o=e.value,l=t.field):(o=n.value,l=s.replace(i.element.id,"")),0===l.search("Segments"))return l=l.replace("SegmentsTabContainer",""),this.validateSegmentFields(i,l,o,e),!0;this.validateScheduleValuesByCurrentField(l,o,this.editedRecord);var d=a.ganttProperties,c=i.taskFields;return Object(w["T"])(c.startDate)||c.startDate===l||this.updateScheduleFields(r,d,"startDate"),Object(w["T"])(c.endDate)||c.endDate===l||this.updateScheduleFields(r,d,"endDate"),Object(w["T"])(c.duration)||c.duration===l||this.updateScheduleFields(r,d,"duration"),Object(w["T"])(c.work)||c.work===l||this.updateScheduleFields(r,d,"work"),this.dialogEditValidationFlag=!1,!0},e.prototype.updateScheduleFields=function(e,t,i){var n,r=this.parent,s=r.element.id,a=Object(w["R"])(i,r.columnMapping),o=r.columnByField[a],l=this.parent.taskFields;if("stringedit"===o.editType){var d=e.querySelector("#"+s+a).ej2_instances[0];n=Object(w["T"])(o.edit)||Object(w["T"])(o.edit.read)?Object(w["T"])(o.valueAccessor)?this.parent.dataOperation.getDurationString(t.duration,t.durationUnit):o.valueAccessor(a,r.editModule.dialogModule.editedRecord,o):o.edit.read(),d.value!==n.toString()&&l.duration===a?(d.value=n,d.dataBind()):l.startDate!==a&&l.endDate!==a||(d.value=l.startDate===a?t.startDate.toString():t.endDate.toString(),d.dataBind())}else if("datepickeredit"===o.editType||"datetimepickeredit"===o.editType){var c=(o.editType,e.querySelector("#"+s+a).ej2_instances[0]);n=t[i],(Object(w["T"])(c.value)&&!Object(w["T"])(n)||Object(w["T"])(n)&&!Object(w["T"])(c.value)||c.value!==n&&!Object(w["T"])(c.value)&&!Object(w["T"])(n)&&c.value.toString()!==n.toString())&&(c.value=n,c.dataBind())}else if("numericedit"===o.editType){var h=e.querySelector("#"+s+a).ej2_instances[0];n=t[i],Object(w["T"])(n)||h.value===n||(h.value=n,h.dataBind())}},e.prototype.validateDuration=function(e){var t=e.ganttProperties;if(!this.dialogEditValidationFlag){Object(w["T"])(t.duration)?(this.parent.setRecordValue("endDate",null,t,!0),this.parent.setRecordValue("isMilestone",!1,t,!0)):Object(R["h"])(t)||!Object(w["T"])(t.startDate)?(e.ganttProperties.isMilestone&&0!==e.ganttProperties.duration&&this.parent.dateValidationModule.checkStartDate(t.startDate),this.parent.dateValidationModule.calculateEndDate(e)):Object(R["h"])(t)||Object(w["T"])(t.endDate)||this.parent.dateValidationModule.calculateStartDate(e);var i=0===t.duration;this.parent.setRecordValue("isMilestone",i,t,!0),this.dialogEditValidationFlag=!0}},e.prototype.validateStartDate=function(e){var t=e.ganttProperties,i=this.parent.taskFields;this.dialogEditValidationFlag||(Object(w["T"])(t.startDate)?(this.parent.setRecordValue("duration",null,t,!0),this.parent.setRecordValue("isMilestone",!1,t,!0),this.parent.allowUnscheduledTasks&&Object(w["T"])(i.endDate)&&this.parent.setRecordValue("endDate",null,t,!0)):Object(R["h"])(t)?Object(w["T"])(i.duration)?this.parent.dateValidationModule.calculateDuration(e):(Object(w["T"])(i.endDate),this.parent.dateValidationModule.calculateEndDate(e)):Object(w["T"])(t.endDate)?Object(w["T"])(t.duration)||this.parent.dateValidationModule.calculateEndDate(e):this.parent.dateValidationModule.calculateDuration(e),this.dialogEditValidationFlag=!0)},e.prototype.validateEndDate=function(e){var t=e.ganttProperties,i=this.parent.taskFields;this.dialogEditValidationFlag||(Object(w["T"])(t.endDate)?(this.parent.setRecordValue("duration",null,t,!0),this.parent.setRecordValue("isMilestone",!1,t,!0)):Object(R["h"])(t)?Object(w["T"])(i.duration)?this.parent.dateValidationModule.calculateDuration(e):Object(w["T"])(t.startDate)?this.parent.dateValidationModule.calculateStartDate(e):(!Object(w["T"])(t.segments)&&t.segments.length>0&&(t.segments=this.parent.editModule.cellEditModule.validateEndDateWithSegments(t)),this.parent.dateValidationModule.calculateDuration(e)):Object(w["T"])(t.duration)?Object(w["T"])(t.startDate)||this.parent.dateValidationModule.calculateDuration(e):this.parent.dateValidationModule.calculateStartDate(e),this.dialogEditValidationFlag=!0)},e.prototype.validateScheduleValuesByCurrentField=function(e,t,i){var n=this.parent,r=i.ganttProperties,s=n.taskFields;if(s.duration===e&&(Object(w["T"])(t)||""===t?n.allowUnscheduledTasks&&this.parent.setRecordValue("duration",null,r,!0):n.dataOperation.updateDurationValue(t,r),this.validateDuration(i),this.parent.editModule.updateResourceRelatedFields(i,"duration")),s.startDate===e){if(""!==t){var a=this.parent.dateValidationModule.getDateFromFormat(t);a=this.parent.dateValidationModule.checkStartDate(a,r),this.parent.setRecordValue("startDate",a,r,!0)}else n.allowUnscheduledTasks&&!i.hasChildRecords&&this.parent.setRecordValue("startDate",null,r,!0);this.validateStartDate(i)}if(s.endDate===e){if(""!==t){var o=this.parent.dateValidationModule.getDateFromFormat(t);0===o.getHours()&&86400!==n.defaultEndTime&&this.parent.dateValidationModule.setTime(n.defaultEndTime,o),o=this.parent.dateValidationModule.checkEndDate(o,r),(Object(w["T"])(r.startDate)||o.getTime()>r.startDate.getTime())&&this.parent.setRecordValue("endDate",o,r,!0)}else n.allowUnscheduledTasks&&this.parent.setRecordValue("endDate",null,r,!0);this.validateEndDate(i)}return s.work===e&&(Object(w["T"])(t)||""===t||(this.parent.setRecordValue("work",t,r,!0),this.parent.editModule.updateResourceRelatedFields(i,"work"),this.validateDuration(i))),"taskType"===e&&this.parent.setRecordValue("taskType",t,r,!0),s.manual===e&&this.parent.editModule.updateTaskScheduleModes(i),!0},e.prototype.getSegmentsModel=function(e){var t=this,i=this.parent.taskFields;(Object(w["T"])(e)||0===e.length)&&(e=[],Object(w["T"])(i.startDate)||e.push("startDate"),Object(w["T"])(i.endDate)||e.push("endDate"),Object(w["T"])(i.duration)||e.push("duration"));var n={editSettings:{allowEditing:!0,allowAdding:!0,allowDeleting:!0,mode:"Normal",newRowPosition:"Bottom"}};n.locale=this.parent.locale,n.dataSource=[],n.rowHeight=this.parent.isAdaptive?48:null,n.toolbar=[{id:this.parent.element.id+"SegmentsTabContainer_add",prefixIcon:"e-add",tooltipText:this.localeObj.getConstant("add"),align:"Right",text:this.parent.isAdaptive?"":this.localeObj.getConstant("add")},{id:this.parent.element.id+"SegmentsTabContainer_delete",prefixIcon:"e-delete",tooltipText:this.localeObj.getConstant("delete"),align:"Right",text:this.parent.isAdaptive?"":this.localeObj.getConstant("delete")}];for(var r=[],s=function(i){var n={},s="General";switch(e[i]){case"startDate":case"endDate":n={field:e[i],headerText:a.localeObj.getConstant(e[i]),editType:"stringedit",width:"200px",edit:{write:function(n){var r;if(Object(w["T"])(t.beforeOpenArgs[s])){var a=t.getGeneralColumnFields(),o=t.getFieldsModel(a);r=o[t.parent.taskFields[e[i]]]}else r=t.beforeOpenArgs[s][t.parent.taskFields[e[i]]];var l=n.rowData[n.column.field];Object(w["ob"])("value",l,r);var d=new t.inputs[t.parent.columnByField[t.parent.taskFields[e[i]]].editType](r);d.appendTo(n.element)},read:function(e){var t=e.ej2_instances[0];return t.value}},format:a.parent.getDateFormat()},"startDate"===e[i]&&(n.validationRules={required:!0}),r.push(n);break;case"duration":n={field:e[i],headerText:a.localeObj.getConstant(e[i]),editType:"stringedit",width:"100px",edit:{write:function(n){var r;if(Object(w["T"])(t.beforeOpenArgs[s])){var a=t.getGeneralColumnFields(),o=t.getFieldsModel(a);r=o[t.parent.taskFields[e[i]]]}else r=t.beforeOpenArgs[s][t.parent.taskFields[e[i]]];r.floatLabelType="Never";var l=n.rowData[n.column.field];Object(w["T"])(l)?Object(w["ob"])("value",null,r):Object(w["ob"])("value",l,r),Object(w["ob"])("value",l,r);var d=new X["a"](r);d.appendTo(n.element)},read:function(e){var t=e.ej2_instances[0];return t.value.toString()}}},r.push(n);break}},a=this,o=0;o<e.length;o++)s(o);return n.columns=r,n.height=this.parent.isAdaptive?"100%":"153px",n},e.prototype.getGridColumnByField=function(e,t){for(var i,n=0;n<t.length;n++)t[n].field===e&&(i=t[n]);return i},e.prototype.updateSegmentField=function(e,t,i){var n,r=this.parent.editModule.dialogModule.dialog,s=Object(w["R"])("Segments",this.beforeOpenArgs),a=this.getGridColumnByField(e,s.columns),o=this.parent.element.id,l=i[e];"stringedit"===a.editType?n=r.querySelector("#"+o+"SegmentsTabContainer"+e).ej2_instances[0]:"datepickeredit"===a.editType&&(n=r.querySelector("#"+o+"SegmentsTabContainer"+e).ej2_instances[0]),n.value.toString()!==l.toString()&&(n.value=l,n.dataBind())},e.prototype.validateSegmentFields=function(e,t,i,n){var r=this.parent.taskFields;if(!Object(w["T"])(r.duration)&&r.duration.toLowerCase()===t.toLowerCase()&&!Object(w["T"])(i)&&""!==i){this.selectedSegment.duration=Number(i);var s=e.dataOperation.getEndDate(this.selectedSegment.startDate,Number(i),this.editedRecord.ganttProperties.durationUnit,this.editedRecord.ganttProperties,!1);s=e.dataOperation.checkEndDate(s,this.editedRecord.ganttProperties,!1),this.selectedSegment.endDate=s}if(!Object(w["T"])(r.startDate)&&r.startDate.toLowerCase()===t.toLowerCase()&&""!==i){var a=this.parent.dateValidationModule.getDateFromFormat(i);a=this.parent.dateValidationModule.checkStartDate(a),this.selectedSegment.startDate=a,Object(w["T"])(r.endDate)||(this.selectedSegment.endDate=this.parent.dataOperation.getEndDate(a,this.selectedSegment.duration,this.editedRecord.ganttProperties.durationUnit,this.editedRecord.ganttProperties,!1))}if(!Object(w["T"])(r.endDate)&&r.endDate.toLowerCase()===t.toLowerCase()&&""!==i){s=this.parent.dateValidationModule.getDateFromFormat(i);0===s.getHours()&&86400!==e.defaultEndTime&&this.parent.dateValidationModule.setTime(e.defaultEndTime,s),s=this.parent.dateValidationModule.checkEndDate(s,this.editedRecord.ganttProperties),this.selectedSegment.endDate=s,this.selectedSegment.duration=this.parent.dataOperation.getDuration(this.selectedSegment.startDate,this.selectedSegment.endDate,this.editedRecord.ganttProperties.durationUnit,!0,!1,!0)}Object(w["T"])(r.startDate)||this.updateSegmentField("startDate",n,this.selectedSegment),Object(w["T"])(r.endDate)||this.updateSegmentField("endDate",n,this.selectedSegment),Object(w["T"])(r.duration)||this.updateSegmentField("duration",n,this.selectedSegment)},e.prototype.getPredecessorModel=function(e){(Object(w["T"])(e)||0===e.length)&&(e=["ID","Name","Type","Offset","UniqueId"]);var t={editSettings:{allowEditing:!0,allowAdding:!0,allowDeleting:!0,mode:"Normal"}};t.locale=this.parent.locale,t.dataSource=[],t.rowHeight=this.parent.isAdaptive?48:null,t.toolbar=[{id:this.parent.element.id+"DependencyTabContainer_add",prefixIcon:"e-add",tooltipText:this.localeObj.getConstant("add"),align:"Right",text:this.parent.isAdaptive?"":this.localeObj.getConstant("add")},{id:this.parent.element.id+"DependencyTabContainer_delete",prefixIcon:"e-delete",tooltipText:this.localeObj.getConstant("delete"),align:"Right",text:this.parent.isAdaptive?"":this.localeObj.getConstant("delete")}];for(var i=[],n=0;n<e.length;n++){var r={};"id"===e[n].toLowerCase()?(r={field:"id",headerText:this.localeObj.getConstant("id"),allowEditing:!1,width:"70px"},i.push(r)):"name"===e[n].toLowerCase()?(r={field:"name",headerText:this.localeObj.getConstant("name"),editType:"stringedit",width:"250px",validationRules:{required:!0}},i.push(r)):"type"===e[n].toLowerCase()?(r={field:"type",headerText:this.localeObj.getConstant("type"),editType:"dropdownedit",dataSource:this.types,foreignKeyField:"id",foreignKeyValue:"text",defaultValue:"FS",validationRules:{required:!0},width:"150px"},i.push(r)):"offset"===e[n].toLowerCase()?(r={field:"offset",headerText:this.localeObj.getConstant("offset"),editType:"stringedit",defaultValue:this.parent.dataOperation.getDurationString(0,this.beforeOpenArgs.rowData.ganttProperties.durationUnit),validationRules:{required:!0},width:"100px"},i.push(r)):"uniqueid"===e[n].toLowerCase()&&(r={field:"uniqueId",isPrimaryKey:!0,visible:!1,defaultValue:Object(R["e"])().toString()},i.push(r))}return t.columns=i,t.height=this.parent.isAdaptive?"100%":"153px",t},e.prototype.getResourcesModel=function(e){var t=this.parent,i=t.resourceFields;(Object(w["T"])(e)||0===e.length)&&(e=[i.id,i.name,i.unit,i.group]);for(var n={allowFiltering:!0,treeColumnIndex:-1,childMapping:"",editSettings:{allowEditing:!0,mode:"Cell"},locale:this.parent.locale,allowSelection:!0,rowHeight:this.parent.isAdaptive?48:null,filterSettings:{type:"Menu"},selectionSettings:{checkboxOnly:!0,checkboxMode:"Default",persistSelection:!0,type:"Multiple"}},r=[{type:"checkbox",allowEditing:!1,allowSorting:!1,allowFiltering:!1,width:60}],s=0;s<e.length;s++){var a={};e[s]===i.id?(a={field:i.id,headerText:this.localeObj.getConstant("id"),isPrimaryKey:!0,width:"100px",allowEditing:!1},r.push(a)):e[s]===i.name?(a={field:i.name,headerText:this.localeObj.getConstant("name"),allowEditing:!1},r.push(a)):e[s]===i.unit?(a={field:i.unit,headerText:this.localeObj.getConstant("unit"),editType:"numericedit",edit:{params:{min:0}}},r.push(a)):e[s]!==i.group||Object(w["T"])(i.group)||(a={field:i.group,headerText:this.localeObj.getConstant("group"),allowEditing:!1},r.push(a))}return n.columns=r,n.height=this.parent.isAdaptive?"100%":"196px",n},e.prototype.getNotesModel=function(e){(Object(w["T"])(e)||0===e.length)&&(e=["Bold","Italic","Underline","StrikeThrough","FontName","FontSize","FontColor","BackgroundColor","LowerCase","UpperCase","|","Alignments","OrderedList","UnorderedList","Outdent","Indent","|","CreateTable","CreateLink","|","ClearFormat","Print","|","Undo","Redo"]);var t={placeholder:this.localeObj.getConstant("writeNotes"),toolbarSettings:{items:e},height:this.parent.isAdaptive?"100%":"auto",locale:this.parent.locale};return t},e.prototype.createDivElement=function(e,t){return Object(w["C"])("div",{className:e,id:t})},e.prototype.createInputElement=function(e,t,i,n){return Object(w["C"])(n||"input",{className:e,attrs:{type:"text",id:t,name:i,title:i}})},e.prototype.renderTabItems=function(){for(var e=this.beforeOpenArgs.tabModel,t=e.items,i=0,n=0;n<t.length;n++){var r=t[n];r.content instanceof HTMLElement||("General"===r.content?r.content=this.renderGeneralTab(r.content):"Dependency"===r.content?(this.editedRecord.hasChildRecords&&(r.disabled=!0),r.content=this.renderPredecessorTab(r.content)):"Resources"===r.content?r.content=this.renderResourceTab(r.content):r.content==="Custom"+i?(r.content=this.renderCustomTab(r.content),i++):"Notes"===r.content?r.content=this.renderNotesTab(r.content):"Segments"===r.content&&(this.editedRecord.hasChildRecords&&(r.disabled=!0),r.content=this.renderSegmentsTab(r.content)))}},e.prototype.segmentGridActionBegin=function(e){var t=this.parent.taskFields,i="Segments",n=this.beforeOpenArgs[i];if("add"===e.requestType||"beginEdit"===e.requestType||"save"===e.requestType){var r=n.dataSource,s=Object(w["R"])("rowData",e),a=this.beforeOpenArgs.rowData.ganttProperties.startDate;if(!Object(w["T"])(a)&&"add"===e.requestType){var o={},l=Object(w["R"])("startDate",s),d=Object(w["R"])("endDate",s),c=Object(w["R"])("duration",s),h=!Object(w["T"])(r)&&r.length>0?Object(w["T"])(t.endDate)?new Date(Object(w["R"])("startDate",r[0]).getTime()):new Date(Object(w["R"])("endDate",r[0]).getTime()):!Object(w["T"])(this.beforeOpenArgs.rowData.ganttProperties.startDate)&&new Date(this.beforeOpenArgs.rowData.ganttProperties.startDate.getTime());h.setHours(0,0,0,0),!Object(w["T"])(r)&&r.length>0&&h.setDate(h.getDate()+2),l=this.parent.dataOperation.checkStartDate(h),d=this.parent.dateValidationModule.getDateFromFormat(l),0===d.getHours()&&86400!==this.parent.defaultEndTime&&this.parent.dateValidationModule.setTime(this.parent.defaultEndTime,d),d=!Object(w["T"])(t.endDate)&&!Object(w["T"])(r)&&r.length<=0?this.beforeOpenArgs.rowData.ganttProperties.endDate:d,c=!Object(w["T"])(t.duration)&&!Object(w["T"])(r)&&r.length<=0?this.beforeOpenArgs.rowData.ganttProperties.duration:1,o={startDate:l,endDate:d,duration:c},e.rowData=o}this.selectedSegment=e.rowData}},e.prototype.renderSegmentsTab=function(e){var t=this.parent,i=this.beforeOpenArgs[e],n=this.beforeOpenArgs.rowData,r=[];this.isEdit&&(r=Object(w["T"])(n.ganttProperties.segments)?[]:n.ganttProperties.segments),i.dataSource=r,i.actionBegin=this.segmentGridActionBegin.bind(this),E["a"].Inject(Te,Lt["a"],At,Ht);var s=new E["a"](i),a=this.createDivElement("",t.element.id+""+e+"TabContainer");return s.appendTo(a),a},e.prototype.renderGeneralTab=function(e){for(var t=this.parent,i=this.beforeOpenArgs[e],n=this.createDivElement("e-edit-form-row",t.element.id+""+e+"TabContainer"),r=0,s=Object.keys(i);r<s.length;r++){var a=s[r];if(!1!==this.parent.columnByField[a].visible){var o=this.parent.columnByField[a],l=i[a];n.appendChild(this.renderInputElements(l,o))}}return n},e.prototype.isCheckIsDisabled=function(e){var t=!1;return(!1===e.allowEditing||e.isPrimaryKey||this.parent.readOnly)&&(-1!==this.parent.customColumns.indexOf(e.field)?t=!0:e.field!==this.parent.taskFields.id&&e.field!==this.parent.taskFields.name&&e.field!==this.parent.taskFields.duration&&e.field!==this.parent.taskFields.progress&&e.field!==this.parent.taskFields.startDate&&e.field!==this.parent.taskFields.endDate&&e.field!==this.parent.taskFields.baselineStartDate&&e.field!==this.parent.taskFields.baselineEndDate&&e.field!==this.parent.taskFields.work&&"taskType"!==e.field||(t=!0)),this.isEdit&&(e.field===this.parent.taskFields.id&&(t=!0),this.editedRecord.hasChildRecords&&(e.field===this.parent.taskFields.endDate&&(!Object(w["T"])(this.editedRecord["isManual"])&&0==this.editedRecord["isManual"]||"Auto"==this.parent.taskMode)||e.field===this.parent.taskFields.duration||e.field===this.parent.taskFields.progress||e.field===this.parent.taskFields.work||"taskType"===e.field)&&(t=!0)),t},e.prototype.renderPredecessorTab=function(e){var t=this,i=this.parent,n=this.beforeOpenArgs[e],r=this.parent.columnByField[this.parent.taskFields.dependency];(!1===r.allowEditing||r.isPrimaryKey||this.parent.readOnly)&&(n.editSettings.allowEditing=!1,n.editSettings.allowAdding=!1,n.editSettings.allowDeleting=!1);var s=this.beforeOpenArgs.rowData,a=[];this.taskNameCollection(),this.isEdit&&(a=this.predecessorEditCollection(s),this.updatePredecessorDropDownData(s)),n.dataSource=a,n.actionBegin=this.gridActionBegin.bind(this);var o=n.columns;o[1].edit={write:function(e){"add"===Object(w["R"])("requestType",e)&&Object(w["ob"])("rowData.uniqueId",Object(R["e"])(),e);var i="name",n=new th["a"]({dataSource:new O["a"](t.idCollection),popupHeight:"180px",allowCustom:!1,fields:{value:"text"},value:e.rowData[i],change:function(e){var i=Object(w["A"])(e.element,"tr"),n=i.querySelector("#"+t.parent.element.id+"DependencyTabContainerid");n&&(Object(w["T"])(e.itemData)||Object(w["T"])(e.item)?n.value="":n.value=e.itemData.id)},autofill:!0});n.appendTo(e.element)},read:function(e){var t=e.ej2_instances[0];return t.value}},E["a"].Inject(Te,Lt["a"],At,Ht);var l=new E["a"](n),d=this.createDivElement("e-dependent-div",i.element.id+""+e+"TabContainer");return l.appendTo(d),d},e.prototype.gridActionBegin=function(e){var t=this,i="Dependency",n=this.beforeOpenArgs[i];if("add"===e.requestType||"beginEdit"===e.requestType){var r="add"!==e.requestType;this.idCollection=Object(w["G"])([],[],this.preTableCollection,!0);for(var s=n.dataSource,a=function(i){o.idCollection.forEach(function(n,a){if(n.id===Object(w["R"])("id",s[i])){var o=Object(w["R"])("rowData",e);if(r&&Object(w["R"])("id",o)===n.id)return;t.idCollection.splice(t.idCollection.indexOf(n),1)}})},o=this,l=0;l<=s.length;l++)a(l)}},e.prototype.updateResourceCollection=function(e,t){if(!Object(w["T"])(e.data)&&Object.keys(e.data).length){this.parent;var i=document.querySelector("#"+t),n=i.ej2_instances[0];if(!Object(w["T"])(n)&&n.getSelectedRecords().length>0){var r=n.getSelectedRecords(),s=void 0,a=[];for(s=0;s<r.length;s++)a.push(r[s].taskData);this.ganttResources=Object(w["G"])([],a)}else this.ganttResources=[]}else this.ganttResources=[]},e.prototype.renderResourceTab=function(e){var t=this,i=this.parent,n=i.resourceFields,r=this.beforeOpenArgs.rowData,s=r.ganttProperties.resourceInfo,a=this.beforeOpenArgs[e],o=i.element.id+""+e+"TabContainer",l=Object(w["G"])([],[],i.resources,!0);if(this.parent.dataOperation.updateResourceUnit(l),!Object(w["T"])(s)){var d=void 0,c=s.length,h=void 0,p=l.length;for(d=0;d<c;d++)for(h=0;h<p;h++)s[d][n.id]===l[h][n.id]&&(l[h][n.unit]=s[d][n.unit])}a.dataSource=l;var u=r.ganttProperties.resourceInfo;if(this.isEdit&&!Object(w["T"])(u))for(var m=0;m<u.length;m++)this.ganttResources.push(u[m]);a.rowSelected=function(e){t.updateResourceCollection(e,o)},a.rowDeselected=function(e){t.updateResourceCollection(e,o)};var g=this.createDivElement("e-resource-div",o);D["a"].Inject(ih["a"],nh["a"],De,Ch);var f=new D["a"](a),b=this.parent.columnByField[this.parent.taskFields.resourceInfo];return(!1===b.allowEditing||b.isPrimaryKey||this.parent.readOnly)&&(f.allowSelection=!1,f.allowFiltering=!1,f.editSettings.allowEditing=!1),f.dataBound=function(){if(t.parent.editDialogFields.length>=1&&"Resources"===t.parent.editDialogFields[0].type){var e=t.parent.element.id+"ResourcesTabContainer";t.resourceSelection(e)}},f.appendTo(g),g},e.prototype.resourceSelection=function(e){var t=this,i=document.querySelector("#"+e).ej2_instances[0],n=i.getCurrentViewRecords(),r=this.ganttResources;r&&r.length>0&&n.forEach(function(e,n){for(var s=0;s<r.length;s++)e.taskData[t.parent.resourceFields.id]!==r[s][t.parent.resourceFields.id]||Object(w["T"])(i.selectionModule)||-1!==i.getSelectedRowIndexes().indexOf(n)||i.selectRow(n)})},e.prototype.renderCustomTab=function(e){return this.renderGeneralTab(e)},e.prototype.renderNotesTab=function(e){var t=this.parent,i=this.beforeOpenArgs[e],n=this.editedRecord.ganttProperties,r=this.createDivElement("",t.element.id+""+e+"TabContainer");ho.Inject(jl,Pl,Jd,ec,tc),i.value=n.notes;var s=this.parent.columnByField[this.parent.taskFields.notes];(!1===s.allowEditing||s.isPrimaryKey||this.parent.readOnly)&&(i.enabled=!1);var a=new ho(i);return a.appendTo(r),r},e.prototype.renderInputElements=function(e,t){var i,n=this,r=this.parent.element.id,s=this.editedRecord,a=this.createDivElement("e-edit-form-column"),o={column:t,data:s};if(!Object(w["T"])(t.edit)&&Object(w["T"])(t.edit.params)){var l=t.edit.create;"string"===typeof l?(l=Object(j["N"])(l,window),i=l(o)):i=t.edit.create(o),i.className="",i.setAttribute("type","text"),i.setAttribute("id",r+""+t.field),i.setAttribute("name",t.field),i.setAttribute("title",t.field),a.appendChild(i)}else i=this.createInputElement("",r+""+t.field,t.field),a.appendChild(i);if(e.enabled=!this.isCheckIsDisabled(t),t.field===this.parent.taskFields.duration)if(Object(w["T"])(t.valueAccessor)){if(Object(w["T"])(t.edit)){var d=s.ganttProperties;e.value=this.parent.dataOperation.getDurationString(d.duration,d.durationUnit)}}else if("string"===typeof t.valueAccessor){var c=Object(j["N"])(t.valueAccessor,window);e.value=c(t.field,s,t)}else e.value=t.valueAccessor(t.field,s,t);else"booleanedit"===t.editType?!0===s[t.field]?e.checked=!0:e.checked=!1:e.value=s[t.field];if(!Object(w["T"])(t.edit)&&Object(w["T"])(t.edit.params)){var h=t.edit.write,p=void 0;"string"===typeof h?(h=Object(j["N"])(h,window),p=h({column:t,rowData:s,element:i})):p=t.edit.write({column:t,rowData:s,element:i}),t.field===this.parent.taskFields.duration&&(p.change=function(e){n.validateScheduleFields(e,t,n.parent)})}else{p=new this.inputs[t.editType](e);p.appendTo(i)}return a},e.prototype.taskNameCollection=function(){var e=this.parent.flatData;this.preTaskIds=[],this.preTableCollection=[];for(var t=0;t<e.length;t++){var i=e[t];if(!i.hasChildRecords){var n="ResourceView"===this.parent.viewType?i.ganttProperties.taskId.toString():i.ganttProperties.rowUniqueID.toString(),r={id:n,text:n+"-"+i.ganttProperties.taskName,value:n};this.preTaskIds.push(r.id),this.preTableCollection.push(r)}}},e.prototype.predecessorEditCollection=function(e){var t=[],i=e.ganttProperties;if(this.isEdit&&!Object(w["T"])(this.parent.taskFields.dependency)&&!Object(w["T"])(e)&&!Object(w["T"])(i.predecessor))for(var n=i.predecessor,r=this.preTableCollection,s=0;s<n.length;s++){var a=n[s].from.toString(),o={},l="ResourceView"===this.parent.viewType?i.taskId:i.rowUniqueID;if(l.toString()!==a){o.id=a;for(var d=0;d<r.length;d++)if(r[d].value===a){o.name=r[d].text;break}o.type=n[s].type;var c=n[s].offset,h=n[s].offsetUnit;o.offset=this.parent.dataOperation.getDurationString(c,h),o.uniqueId=Object(R["e"])(),t.push(o)}}return t},e.prototype.updatePredecessorDropDownData=function(e){var t=-1,i="ResourceView"===this.parent.viewType?e.ganttProperties.taskId.toString():e.ganttProperties.rowUniqueID.toString();t=this.preTaskIds.indexOf(i),this.preTableCollection.splice(t,1),this.preTaskIds.splice(t,1),this.validSuccessorTasks(e,this.preTaskIds,this.preTableCollection)},e.prototype.validSuccessorTasks=function(e,t,i){var n=this,r=e.ganttProperties;if(r.predecessor&&r.predecessor.length>0){var s=r.predecessor,a="ResourceView"===this.parent.viewType?r.taskId.toString():r.rowUniqueID.toString();s.forEach(function(e){if(e.from.toString()===a){var r=e.to,s=-1;s=t.indexOf(r),s>-1&&(t.splice(s,1),i.splice(s,1));var o=n.parent.connectorLineModule.getRecordByID(r);n.validSuccessorTasks(o,t,i)}})}},e.prototype.getPredecessorType=function(){var e=[this.parent.getPredecessorTextValue("SS"),this.parent.getPredecessorTextValue("SF"),this.parent.getPredecessorTextValue("FS"),this.parent.getPredecessorTextValue("FF")],t=[{id:"FS",text:e[2],value:e[2]},{id:"FF",text:e[3],value:e[3]},{id:"SS",text:e[0],value:e[0]},{id:"SF",text:e[1],value:e[1]}];return t},e.prototype.initiateDialogSave=function(){this.isEdit?this.parent.initiateEditAction(!0):this.addedRecord={};for(var e=this.parent,t=this.beforeOpenArgs.tabModel,i=t.items,n=0;n<i.length;n++){var r=i[n].content,s=r.id;Object(w["T"])(s)&&""===s||(s=s.replace(e.element.id,""),s=s.replace("TabContainer",""),"General"===s?this.updateGeneralTab(r,!1):"Dependency"===s?this.updatePredecessorTab(r):"Notes"===s?this.updateNotesTab(r):"Resources"===s?this.updateResourceTab(r):-1!==s.indexOf("Custom")?this.updateCustomTab(r):"Segments"===s&&this.updateSegmentsData(r,this.beforeOpenArgs.rowData))}if(this.isEdit){this.parent.dataOperation.updateWidthLeft(this.rowData);var a={data:this.rowData,action:"DialogEditing"};this.parent.editModule.initiateUpdateAction(a)}else if("ResourceView"===this.parent.viewType){var o=Object(w["G"])({},this.addedRecord,!0);if(o[this.parent.taskFields.resourceInfo].length)for(n=0;n<o[this.parent.taskFields.resourceInfo].length;n++){s=o[this.parent.taskFields.resourceInfo][n].toString();var l=this.parent.getTaskIds().indexOf("R"+s.toString());if(-1!==l){this.parent.editModule.addRecord(this.addedRecord,"Child",l);break}}else this.parent.editModule.addRecord(this.addedRecord,"Bottom")}else this.parent.editModule.addRecord(this.addedRecord,this.parent.editSettings.newRowPosition);return!0},e.prototype.updateSegmentTaskData=function(e){for(var t=[],i=this.parent.taskFields,n=0;n<e.length;n++){var r={};Object(w["T"])(i.startDate)||(r[this.parent.taskFields.startDate]=e[n].startDate),Object(w["T"])(i.endDate)||(r[this.parent.taskFields.endDate]=e[n].endDate),Object(w["T"])(i.duration)||(r[this.parent.taskFields.duration]=Number(e[n].duration),e[n].duration=r[this.parent.taskFields.duration]),t.push(r)}this.isEdit?(this.rowData.ganttProperties.segments=e,this.parent.setRecordValue("segments",this.parent.dataOperation.setSegmentsInfo(this.rowData,!1),this.rowData.ganttProperties,!0),this.parent.setRecordValue("taskData."+this.parent.taskFields.segments,t,this.rowData),e.length<=0&&this.validateDuration(this.rowData)):this.addedRecord[i.segments]=t},e.prototype.updateSegmentsData=function(e,t){var i=e.ej2_instances[0];i.isEdit&&i.endEdit();var n=i.currentViewData;this.updateSegmentTaskData(n)},e.prototype.updateGeneralTab=function(e,t){var i=this.parent,n=e.childNodes,r={};this.isEdit||(r=this.addedRecord);for(var s=0;s<n.length;s++){var a=n[s],o=a.querySelector('input[id^="'+i.element.id+'"]');if(o){var l=o.id.replace(i.element.id,""),d=a.querySelector("#"+i.element.id+l).ej2_instances[0],c=i.columnByField[l];if(!Object(w["T"])(c.edit)&&Object(w["T"])(c.edit.params)){var h=c.edit.read;"string"===typeof h?(h=Object(j["N"])(h,window),r[l]=h(o,d.value)):r[l]=c.edit.read(o,d.value)}else t&&"booleanedit"===c.editType?!0===o.checked?r[l]=!0:r[l]=!1:r[l]=d.value}}this.isEdit&&(this.updateScheduleProperties(this.editedRecord,this.rowData),i.editModule.validateUpdateValues(r,this.rowData,!0))},e.prototype.updateScheduleProperties=function(e,t){this.parent.setRecordValue("startDate",e.ganttProperties.startDate,t.ganttProperties,!0),this.parent.setRecordValue("endDate",e.ganttProperties.endDate,t.ganttProperties,!0),this.parent.setRecordValue("duration",e.ganttProperties.duration,t.ganttProperties,!0),this.parent.setRecordValue("durationUnit",e.ganttProperties.durationUnit,t.ganttProperties,!0),this.parent.setRecordValue("work",e.ganttProperties.work,t.ganttProperties,!0),Object(w["T"])(this.parent.taskFields.startDate)||this.parent.dataOperation.updateMappingData(this.rowData,this.parent.taskFields.startDate),Object(w["T"])(this.parent.taskFields.endDate)||this.parent.dataOperation.updateMappingData(this.rowData,this.parent.taskFields.endDate),Object(w["T"])(this.parent.taskFields.duration)||(this.parent.dataOperation.updateMappingData(this.rowData,this.parent.taskFields.duration),this.parent.setRecordValue("durationUnit",e.ganttProperties.durationUnit,this.rowData,!0),0===this.rowData.ganttProperties.duration?this.parent.setRecordValue("isMilestone",!0,this.rowData.ganttProperties,!0):this.parent.setRecordValue("isMilestone",!1,this.rowData.ganttProperties,!0)),Object(w["T"])(this.parent.taskFields.work)||this.parent.dataOperation.updateMappingData(this.rowData,this.parent.taskFields.work),Object(w["T"])(this.parent.taskFields.manual)||this.parent.dataOperation.updateMappingData(this.rowData,this.parent.taskFields.manual)},e.prototype.updatePredecessorTab=function(e){var t=e.ej2_instances[0];t.isEdit&&t.endEdit();for(var i=t.dataSource,n=[],r=[],s="",a=[],o=0;o<i.length;o++){var l=i[o],d=l.name.split("-")[0];if(l.id!==d&&(l.id=d),-1===a.indexOf(l.id)){var c=l.id+l.type;l.offset&&-1!==l.offset.indexOf("-")?c+=l.offset:c+="+"+l.offset,n.push(c),a.push(l.id)}}this.isEdit?(n.length>0?(r=this.parent.predecessorModule.calculatePredecessor(n.join(","),this.rowData),this.parent.setRecordValue("predecessor",r,this.rowData.ganttProperties,!0),s=this.parent.predecessorModule.getPredecessorStringValue(this.rowData)):(r=[],this.parent.setRecordValue("predecessor",r,this.rowData.ganttProperties,!0),s=""),this.parent.setRecordValue("predecessorsName",s,this.rowData.ganttProperties,!0),this.parent.setRecordValue("taskData."+this.parent.taskFields.dependency,s,this.rowData),this.parent.setRecordValue(this.parent.taskFields.dependency,s,this.rowData),this.parent.predecessorModule.updateUnscheduledDependency(this.rowData)):this.addedRecord[this.parent.taskFields.dependency]=n.length>0?n.join(","):""},e.prototype.updateResourceTab=function(e){var t=e.ej2_instances[0];t&&t.grid.endEdit();var i=this.ganttResources;"ResourceView"!==this.parent.viewType||Object(w["T"])(this.rowData.ganttProperties)||(JSON.stringify(this.ganttResources)!==JSON.stringify(this.rowData.ganttProperties.resourceInfo)?(this.isResourceUpdate=!0,this.previousResource=Object(w["T"])(this.rowData.ganttProperties.resourceInfo)?[]:this.rowData.ganttProperties.resourceInfo.slice()):this.isResourceUpdate=!1);var n=[];if(this.isEdit)this.parent.setRecordValue("resourceInfo",i,this.rowData.ganttProperties,!0),this.parent.dataOperation.updateMappingData(this.rowData,"resourceInfo"),this.parent.editModule.updateResourceRelatedFields(this.rowData,"resource"),this.validateDuration(this.rowData);else{for(var r=0;r<i.length;r++)n.push(i[r][this.parent.resourceFields.id]),this.isAddNewResource=!0;this.addedRecord[this.parent.taskFields.resourceInfo]=n}},e.prototype.updateNotesTab=function(e){var t=this.parent,i=e.ej2_instances[0];this.isEdit?(t.columnByField[t.taskFields.notes].disableHtmlEncode?this.parent.setRecordValue("notes",i.getHtml(),this.rowData.ganttProperties,!0):this.parent.setRecordValue("notes",i.getText(),this.rowData.ganttProperties,!0),t.dataOperation.updateMappingData(this.rowData,"notes")):this.addedRecord[this.parent.taskFields.notes]=i.getHtml()},e.prototype.updateCustomTab=function(e){this.updateGeneralTab(e,!0)},e}(),Th=i("2aab"),kh=i("9b89"),Sh=i("30bd"),jh="e-icons",Rh="e-frame",Dh="e-check",Eh="e-checkbox-wrapper",Ih="e-stop",xh="e-selectall-parent",Mh="e-input-group-icon e-back-icon e-icons",Ph="e-input-group-icon e-clear-icon e-icons",Lh="e-input-filter",Nh="e-filter-parent",Ah="e-ddl-device-filter",Bh="e-clear-icon",Fh="e-popup-full-page",Hh="e-ddl-device",Vh="e-input-focus",qh=function(){function e(e){this.activeLi=[],this.activeEle=[],this.parent=e,this.removeEventListener(),this.addEventListener()}return e.prototype.getModuleName=function(){return"CheckBoxSelection"},e.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on("updatelist",this.listSelection,this),this.parent.on("listoption",this.listOption,this),this.parent.on("selectAll",this.setSelectAll,this),this.parent.on("checkSelectAll",this.checkSelectAll,this),this.parent.on("searchBox",this.setSearchBox,this),this.parent.on("blur",this.onBlurHandler,this),this.parent.on("targetElement",this.targetElement,this),this.parent.on("deviceSearchBox",this.setDeviceSearchBox,this),this.parent.on("inputFocus",this.getFocus,this),this.parent.on("reOrder",this.setReorder,this),this.parent.on("activeList",this.getActiveList,this),this.parent.on("selectAllText",this.setLocale,this),this.parent.on("filterBarPlaceholder",this.setPlaceholder,this),w["l"].add(document,"mousedown",this.onDocumentClick,this),this.parent.on("addItem",this.checboxCreate,this),this.parent.on("popupFullScreen",this.setPopupFullScreen,this))},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off("updatelist",this.listSelection),this.parent.off("listoption",this.listOption),this.parent.off("selectAll",this.setSelectAll),this.parent.off("checkSelectAll",this.checkSelectAll),this.parent.off("searchBox",this.setSearchBox),this.parent.off("blur",this.onBlurHandler),this.parent.off("targetElement",this.targetElement),this.parent.off("deviceSearchBox",this.setDeviceSearchBox),this.parent.off("inputFocus",this.getFocus),this.parent.off("reOrder",this.setReorder),this.parent.off("activeList",this.getActiveList),this.parent.off("selectAllText",this.setLocale),this.parent.off("filterBarPlaceholder",this.setPlaceholder),this.parent.off("addItem",this.checboxCreate),this.parent.off("popupFullScreen",this.setPopupFullScreen))},e.prototype.listOption=function(e){var t=this;if(Object(w["T"])(this.parent.listCurrentOptions.itemCreated))this.parent.listCurrentOptions.itemCreated=function(e){t.checboxCreate(e)};else{var i=this.parent.listCurrentOptions.itemCreated;this.parent.listCurrentOptions.itemCreated=function(e){t.checboxCreate(e),i.apply(t,[e])}}},e.prototype.setPlaceholder=function(e){Io["a"].setPlaceholder(e.filterBarPlaceholder,this.filterInput)},e.prototype.checboxCreate=function(e){var t;if(t=Object(w["T"])(e.item)?e:e.item,this.parent.enableGroupCheckBox||"e-list-group-item "!==t.className&&"e-list-group-item"!==t.className){var i=Object(kh["a"])(this.parent.createElement,!0),n=Object(w["jb"])("div."+jh,t);return t.insertBefore(i,t.childNodes[Object(w["T"])(n)?0:1]),Object(w["jb"])("."+Rh,i),this.parent.enableGroupCheckBox&&this.parent.popupWrapper.classList.add("e-multiselect-group"),t}return t},e.prototype.setSelectAll=function(){this.parent.showSelectAll?(Object(w["T"])(this.checkAllParent)&&(this.checkAllParent=this.parent.createElement("div",{className:xh}),this.selectAllSpan=this.parent.createElement("span",{className:"e-all-text"}),this.selectAllSpan.textContent="",this.checkAllParent.appendChild(this.selectAllSpan),this.setLocale(),this.checboxCreate(this.checkAllParent),this.parent.headerTemplate&&(Object(w["T"])(this.parent.filterParent)?Object(w["v"])([this.checkAllParent],this.parent.popupWrapper):Object(w["v"])([this.checkAllParent],this.parent.filterParent)),this.parent.headerTemplate||(Object(w["T"])(this.parent.filterParent)?Object(w["cb"])([this.checkAllParent],this.parent.popupWrapper):this.parent.filterParent.parentNode.insertBefore(this.checkAllParent,this.parent.filterParent.nextSibling)),w["l"].add(this.checkAllParent,"mousedown",this.clickHandler,this)),this.parent.list.classList.contains("e-nodata")||this.parent.listData&&this.parent.listData.length<=1&&!this.parent.isDynamicDataChange||this.parent.isDynamicDataChange&&this.parent.listData&&this.parent.listData.length<=1?this.checkAllParent.style.display="none":this.checkAllParent.style.display="block",this.parent.selectAllHeight=this.checkAllParent.getBoundingClientRect().height):Object(w["T"])(this.checkAllParent)||(this.checkAllParent.parentElement.removeChild(this.checkAllParent),this.checkAllParent=null)},e.prototype.destroy=function(){this.removeEventListener(),w["l"].remove(document,"mousedown",this.onDocumentClick)},e.prototype.listSelection=function(e){var t;if(Object(w["T"])(e.e)){var i=e.li.querySelector(".e-checkbox-wrapper");t=i?i.childNodes[1]:e.li.lastElementChild.childNodes[1]}else{e.li.querySelector(".e-checkbox-wrapper .e-frame");t=Object(w["T"])(e.e.target)?e.li.querySelector(".e-checkbox-wrapper").childNodes[1]:e.e.target.classList.contains("e-frame")&&(!this.parent.showSelectAll||this.checkAllParent&&!this.checkAllParent.contains(e.e.target))?e.e.target:e.li.querySelector(".e-checkbox-wrapper").childNodes[1]}if((this.parent.itemTemplate||this.parent.enableGroupCheckBox)&&(t=e.li.firstElementChild.childNodes[1]),Object(w["T"])(t)||(this.checkWrapper=Object(w["A"])(t,"."+Eh)),!Object(w["T"])(this.checkWrapper)){var n=Object(w["jb"])("."+Rh,this.checkWrapper),r=!1;this.validateCheckNode(this.checkWrapper,n.classList.contains(Dh),e.li,e.e,r)}},e.prototype.validateCheckNode=function(e,t,i,n,r){this.changeState(e,t?"uncheck":"check",n,!0,r)},e.prototype.clickHandler=function(e){var t;t=e.currentTarget.classList.contains(this.checkAllParent.className)?e.currentTarget.firstElementChild.lastElementChild:e.currentTarget,this.checkWrapper=Object(w["A"])(t,"."+Eh);var i=!0;if(!Object(w["T"])(this.checkWrapper)){var n=Object(w["jb"])("."+Rh,this.checkWrapper);this.validateCheckNode(this.checkWrapper,n.classList.contains(Dh),null,e,i)}e.preventDefault()},e.prototype.changeState=function(e,t,i,n,r){var s,a=e.getElementsByClassName(Rh)[0];"check"!==t||a.classList.contains(Dh)?"uncheck"===t&&(a.classList.contains(Dh)||a.classList.contains(Ih))?(Object(w["gb"])([a],[Dh,Ih]),s="false",r&&(this.parent.selectAllItems(!1,i),this.setLocale())):"indeterminate"!==t||a.classList.contains(Ih)||(Object(w["gb"])([a],[Dh]),a.classList.add(Ih),s="false",r&&(this.parent.selectAllItems(!1,i),this.setLocale())):(a.classList.remove(Ih),a.classList.add(Dh),s="true",r&&(this.parent.selectAllItems(!0,i),this.setLocale(!0))),s="check"===t?"true":"uncheck"===t?"false":s,Object(w["T"])(s)||e.setAttribute("aria-checked",s)},e.prototype.setSearchBox=function(e){if(Object(w["T"])(this.parent.filterParent)){this.parent.filterParent=this.parent.createElement("span",{className:Nh}),this.filterInput=this.parent.createElement("input",{attrs:{type:"text"},className:Lh}),this.parent.element.parentNode.insertBefore(this.filterInput,this.parent.element);var t=!1;return w["d"].isDevice&&(t=!0,this.parent.mobFilter=!1),this.filterInputObj=Io["a"].createInput({element:this.filterInput,buttons:t?[Mh,Ph]:[Ph],properties:{placeholder:this.parent.filterBarPlaceholder}},this.parent.createElement),Object(w["T"])(this.parent.cssClass)||(-1!==this.parent.cssClass.split(" ").indexOf("e-outline")?Object(w["u"])([this.filterInputObj.container],"e-outline"):-1!==this.parent.cssClass.split(" ").indexOf("e-filled")&&Object(w["u"])([this.filterInputObj.container],"e-filled")),Object(w["v"])([this.filterInputObj.container],this.parent.filterParent),Object(w["cb"])([this.parent.filterParent],e.popupElement),Object(w["w"])(this.filterInput,{"aria-disabled":"false","aria-owns":this.parent.element.id+"_options",role:"listbox","aria-activedescendant":null,autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false"}),this.clearIconElement=this.filterInput.parentElement.querySelector("."+Bh),!w["d"].isDevice&&this.clearIconElement&&(w["l"].add(this.clearIconElement,"mousedown",this.clearText,this),this.clearIconElement.style.visibility="hidden"),w["l"].add(this.filterInput,"input",this.parent.onInput,this.parent),w["l"].add(this.filterInput,"keyup",this.parent.keyUp,this.parent),w["l"].add(this.filterInput,"keydown",this.parent.onKeyDown,this.parent),w["l"].add(this.filterInput,"blur",this.onBlurHandler,this),w["l"].add(this.filterInput,"paste",this.parent.pasteHandler,this.parent),this.parent.searchBoxHeight=this.filterInputObj.container.parentElement.getBoundingClientRect().height,this.filterInputObj}},e.prototype.clickOnBackIcon=function(e){this.parent.hidePopup(),Object(w["gb"])([document.body,this.parent.popupObj.element],Fh),this.parent.inputElement.focus()},e.prototype.clearText=function(e){this.parent.targetInputElement.value="",this.parent.allowFiltering&&""===this.parent.targetInputElement.value&&this.parent.search(null),this.parent.refreshPopup(),this.parent.refreshListItems(null),this.clearIconElement.style.visibility="hidden",this.filterInput.focus(),this.setReorder(e),e.preventDefault()},e.prototype.setDeviceSearchBox=function(){this.parent.popupObj.element.classList.add(Hh),this.parent.popupObj.element.classList.add(Ah),this.parent.popupObj.position={X:0,Y:0},this.parent.popupObj.dataBind(),this.setSearchBoxPosition(),this.backIconElement=this.filterInputObj.container.querySelector(".e-back-icon"),this.clearIconElement=this.filterInputObj.container.querySelector("."+Bh),this.clearIconElement.style.visibility="hidden",w["l"].add(this.backIconElement,"click",this.clickOnBackIcon,this),w["l"].add(this.clearIconElement,"click",this.clearText,this)},e.prototype.setSearchBoxPosition=function(){var e=this.filterInput.parentElement.getBoundingClientRect().height,t=0;this.checkAllParent&&(t=this.checkAllParent.getBoundingClientRect().height),this.parent.popupObj.element.style.maxHeight="100%",this.parent.popupObj.element.style.width="100%",this.parent.list.style.maxHeight=window.innerHeight-e-t+"px",this.parent.list.style.height=window.innerHeight-e-t+"px";var i=this.filterInput.parentElement.querySelector("."+Bh);Object(w["F"])(this.filterInput),i.parentElement.insertBefore(this.filterInput,i)},e.prototype.setPopupFullScreen=function(){Object(w["w"])(this.parent.popupObj.element,{style:"left:0px;right:0px;top:0px;bottom:0px;"}),Object(w["u"])([document.body,this.parent.popupObj.element],Fh),this.parent.popupObj.element.style.maxHeight="100%",this.parent.popupObj.element.style.width="100%"},e.prototype.targetElement=function(){return Object(w["T"])(this.clearIconElement)||(this.parent.targetInputElement=this.filterInput,this.clearIconElement.style.visibility=""===this.parent.targetInputElement.value?"hidden":"visible"),this.parent.targetInputElement.value},e.prototype.onBlurHandler=function(e){if(!this.parent.element.classList.contains("e-listbox")){var t=void 0;if(this.parent.keyAction)return;if(w["d"].isIE&&(t=!Object(w["T"])(e)&&e.target),w["d"].isIE||(t=!Object(w["T"])(e)&&e.relatedTarget),this.parent.popupObj&&document.body.contains(this.parent.popupObj.element)&&this.parent.popupObj.element.contains(t)&&!w["d"].isIE&&this.filterInput)return void this.filterInput.focus();if(this.parent.scrollFocusStatus&&this.filterInput)return e.preventDefault(),this.filterInput.focus(),void(this.parent.scrollFocusStatus=!1);this.parent.popupObj&&document.body.contains(this.parent.popupObj.element)&&!this.parent.popupObj.element.classList.contains("e-popup-close")&&(this.parent.inputFocus=!1,this.parent.updateValueState(e,this.parent.value,this.parent.tempValues),this.parent.dispatchEvent(this.parent.hiddenElement,"change")),this.parent.popupObj&&document.body.contains(this.parent.popupObj.element)&&!this.parent.popupObj.element.classList.contains("e-popup-close")&&(this.parent.inputFocus=!1,this.parent.overAllWrapper.classList.remove(Vh),this.parent.trigger("blur"),this.parent.focused=!0),this.parent.popupObj&&document.body.contains(this.parent.popupObj.element)&&!this.parent.popupObj.element.classList.contains("e-popup-close")&&!w["d"].isDevice&&this.parent.hidePopup()}},e.prototype.onDocumentClick=function(e){if("listbox"!==this.parent.getLocaleName()){var t=e.target;!Object(w["T"])(this.parent.popupObj)&&Object(w["A"])(t,'[id="'+this.parent.popupObj.element.id+'"]')&&(this.filterInput&&""!==this.filterInput.value||e.preventDefault()),!Object(w["T"])(this.parent.popupObj)&&Object(w["A"])(t,'[id="'+this.parent.popupObj.element.id+'"]')||this.parent.overAllWrapper.contains(e.target)?this.parent.scrollFocusStatus=(w["d"].isIE||"edge"===w["d"].info.name)&&document.activeElement===this.filterInput:(this.parent.overAllWrapper.classList.contains(Sh["c"].focus)||this.parent.isPopupOpen())&&(this.parent.inputFocus=!1,this.parent.scrollFocusStatus=!1,this.parent.hidePopup(),this.parent.onBlurHandler(e,!0),this.parent.focused=!0),this.parent.overAllWrapper.contains(e.target)||!this.parent.overAllWrapper.classList.contains("e-input-focus")||this.parent.isPopupOpen()||(w["d"].isIE?this.parent.onBlurHandler():this.parent.onBlurHandler(e)),this.filterInput===t&&this.filterInput.focus()}},e.prototype.getFocus=function(e){this.parent.overAllWrapper.classList.remove(Vh),this.parent.keyAction&&"clear"!==e.value&&"focus"!==e.value?this.parent.keyAction=!1:("focus"===e.value&&(this.filterInput.focus(),this.parent.removeFocus(),w["l"].remove(this.parent.list,"keydown",this.parent.onKeyDown)),"clear"===e.value&&(this.filterInput.value="",this.clearIconElement.style.visibility="hidden"))},e.prototype.checkSelectAll=function(e){"check"===e.value&&"true"!==this.checkAllParent.getAttribute("aria-checked")&&(this.changeState(this.checkAllParent,e.value,null,null,!1),this.setLocale(!0)),"uncheck"===e.value&&(this.changeState(this.checkAllParent,e.value,null,null,!1),this.setLocale()),"indeterminate"===e.value&&(this.changeState(this.checkAllParent,e.value,null,null,!1),this.setLocale())},e.prototype.setLocale=function(e){if("Select All"!==this.parent.selectAllText||"Unselect All"!==this.parent.unSelectAllText){var t=e?this.parent.unSelectAllText:this.parent.selectAllText;this.selectAllSpan.textContent="";for(var i=Object(w["B"])(t),n=e?"unSelectAllText":"selectAllText",r=0,s=i({},this.parent,n,null,!this.parent.isStringTemplate);r<s.length;r++){var a=s[r];this.selectAllSpan.textContent=a.textContent}}else{var o={selectAllText:"Select All",unSelectAllText:"Unselect All"},l=new w["o"](this.parent.getLocaleName(),{},this.parent.locale);""===l.getConstant("selectAllText")&&(l=new w["o"]("dropdowns",o,this.parent.locale)),this.selectAllSpan.textContent=e?l.getConstant("unSelectAllText"):l.getConstant("selectAllText")}},e.prototype.getActiveList=function(e){e.li.classList.contains("e-active")?this.activeLi.push(e.li.cloneNode(!0)):this.activeLi.splice(e.index,1)},e.prototype.setReorder=function(e){if(this.parent.enableSelectionOrder&&!Object(w["T"])(this.parent.value)){var t=this.parent.ulElement.querySelectorAll("li.e-active").length,i=void 0,n=this.parent.createElement("ul",{className:"e-list-parent e-ul e-reorder"});t>0&&(Object(w["v"])(this.parent.ulElement.querySelectorAll("li.e-active"),n),i=this.parent.ulElement.querySelectorAll("li.e-active"),Object(w["u"])(i,"e-reorder-hide"),Object(w["cb"])([n],this.parent.list)),this.parent.focusAtFirstListItem()}},e}(),zh=function(){function e(e){this.validationPredecessor=null,this.confirmPredecessorDialog=null,this.predecessorIndex=null,this.childRecord=null,this.parent=e,this.dateValidateModule=this.parent.dateValidationModule,this.parent.on("initPredessorDialog",this.initPredecessorValidationDialog,this)}return e.prototype.updateConnectorLineEditElement=function(e){var t=this.getConnectorLineHoverElement(e.target);Object(w["R"])("editModule.taskbarEditModule.taskBarEditAction",this.parent)||this.highlightConnectorLineElements(t)},e.prototype.getConnectorLineHoverElement=function(e){var t=Object(R["i"])(e,xe["w"]),i=Object(R["i"])(e,xe["C"]),n=Object(R["i"])(e,xe["A"]);return t||i||n?Object(R["i"])(e,xe["x"]):null},e.prototype.highlightConnectorLineElements=function(e){e?e!==this.connectorLineElement&&(this.removeHighlight(),this.addHighlight(e)):this.removeHighlight()},e.prototype.addHighlight=function(e){this.connectorLineElement=e,Object(w["u"])([e],[xe["z"]]),e.querySelectorAll("."+xe["w"])[0].classList.contains("e-criticalconnector-line")?(Object(w["u"])(e.querySelectorAll("."+xe["w"]),[xe["L"]]),Object(w["u"])(e.querySelectorAll("."+xe["C"]),[xe["N"]]),Object(w["u"])(e.querySelectorAll("."+xe["A"]),[xe["M"]])):(Object(w["u"])(e.querySelectorAll("."+xe["w"]),[xe["y"]]),Object(w["u"])(e.querySelectorAll("."+xe["C"]),[xe["D"]]),Object(w["u"])(e.querySelectorAll("."+xe["A"]),[xe["B"]]))},e.prototype.removeHighlight=function(){Object(w["T"])(this.connectorLineElement)||(Object(w["gb"])([this.connectorLineElement],[xe["z"]]),this.connectorLineElement.querySelectorAll("."+xe["w"])[0].classList.contains(xe["L"])?(Object(w["gb"])(this.connectorLineElement.querySelectorAll("."+xe["w"]),[xe["L"]]),Object(w["gb"])(this.connectorLineElement.querySelectorAll("."+xe["C"]),[xe["N"]]),Object(w["gb"])(this.connectorLineElement.querySelectorAll("."+xe["A"]),[xe["M"]])):(Object(w["gb"])(this.connectorLineElement.querySelectorAll("."+xe["w"]),[xe["y"]]),Object(w["gb"])(this.connectorLineElement.querySelectorAll("."+xe["C"]),[xe["D"]]),Object(w["gb"])(this.connectorLineElement.querySelectorAll("."+xe["A"]),[xe["B"]])),this.connectorLineElement=null)},e.prototype.getEditedConnectorLineString=function(e){for(var t,i,n,r,s,a,o=[],l=[],d="",c=0;c<e.length;c++)if(t=e[c],i=t.ganttProperties.predecessor,i){for(var h=0;h<i.length;h++){n=i[h];var p="from",u="to";if(this.parent.connectorLineModule.removeConnectorLineById("parent"+n[p]+"child"+n[u]),r=this.parent.connectorLineModule.getRecordByID(n[p]),s=this.parent.connectorLineModule.getRecordByID(n[u]),(r&&!0===r.expanded||s&&!0===s.expanded)&&(a=this.parent.predecessorModule.updateConnectorLineObject(r,s,n),!Object(w["T"])(a))){var m=o.indexOf(a.connectorLineId),g=this.parent.connectorLineModule.getConnectorLineTemplate(a);-1!==m?l[m]=g:(o.push(a.connectorLineId),l.push(g))}}d=l.join("")}return d},e.prototype.refreshEditedRecordConnectorLine=function(e){this.parent.connectorLineModule.removePreviousConnectorLines(this.parent.previousRecords),this.parent.connectorLineModule.expandedRecords=this.parent.virtualScrollModule&&this.parent.enableVirtualization?this.parent.updatedRecords:this.parent.getExpandedRecords(this.parent.updatedRecords);var t=this.getEditedConnectorLineString(e);this.parent.connectorLineModule.dependencyViewContainer.innerHTML=this.parent.connectorLineModule.dependencyViewContainer.innerHTML+t},e.prototype.idFromPredecessor=function(e){for(var t=e.split(","),i=[],n=0;n<t.length;n++){for(var r=[],s=0;s<t[n].length;s++){if(Object(w["T"])(t[n].charAt(s))||"NaN"===parseInt(t[n].charAt(s),10).toString())break;r.push(t[n].charAt(s))}i.push(r.join(""))}return i},e.prototype.predecessorValidation=function(e,t){for(var i,n,r=t.rowUniqueID,s=0;s<e.length;s++){i=e[s];var a=[],o=e.slice(0);o.splice(s,1);var l=function(){var e=[];return-1!==a.indexOf(i)?"break":Object(w["T"])(d.parent.connectorLineModule.getRecordByID(i))?{value:!1}:(n=d.parent.connectorLineModule.getRecordByID(i).ganttProperties,!Object(w["T"])(n.predecessor)&&n.predecessor.length>0&&n.predecessor.forEach(function(t){n.rowUniqueID.toString()!==t.from&&e.push(t.from.toString())}),r.toString()===n.rowUniqueID.toString()||-1!==e.indexOf(r.toString())?{value:!1}:(a.push(i),!Object(w["T"])(n.predecessor)&&n.predecessor.length>0?void(i=n.predecessor[0].from):"break"))},d=this;while(null!==i){var c=l();if("object"===typeof c)return c.value;if("break"===c)break}}return!0},e.prototype.validatePredecessorRelation=function(e,t){var i,n,r=!0,s="ResourceView"===this.parent.viewType?e.ganttProperties.taskId:e.ganttProperties.rowUniqueID;if(!Object(w["T"])(t)&&t.length>0){i=this.idFromPredecessor(t);for(var a=function(t){var r=o.checkParentRelation(e,i);if(!r)return{value:!1};var a=i.slice(0),l=[],d=!0;if(a.forEach(function(e){-1===l.indexOf(e)?l.push(e):d=!1}),!d)return{value:!1};n=i[t];var c=[],h=i.slice(0);h.splice(t,1);var p=function(){var t,i,r=[];if(-1!==c.indexOf(n))return"break";if(Object(w["T"])(o.parent.connectorLineModule.getRecordByID(n.toString())))return{value:!1};if(i=o.parent.connectorLineModule.getRecordByID(n.toString()).ganttProperties,!Object(w["T"])(i.predecessor)&&i.predecessor.length>0&&i.predecessor.forEach(function(e,n){i.rowUniqueID.toString()!==e.from&&(r.push(e.from.toString()),t=n)}),s.toString()===i.rowUniqueID.toString()||-1!==r.indexOf(s.toString()))return{value:!1};if(c.push(n),Object(w["T"])(i.predecessor)||!(i.predecessor.length>0))return"break";var a=void 0;return r.length>1?a=o.predecessorValidation(r,e.ganttProperties):1===r.length&&(n=i.predecessor[t].from),!1===a?{value:!1}:void 0};while(null!==n){var u=p();if("object"===typeof u)return u;if("break"===u)break}},o=this,l=0;l<i.length;l++){var d=a(l);if("object"===typeof d)return d.value}}return r},e.prototype.addPredecessor=function(e,t){var i=Object(w["T"])(e.ganttProperties.predecessorsName)||""===e.ganttProperties.predecessorsName?t:e.ganttProperties.predecessorsName+","+t;this.updatePredecessorHelper(e,i)},e.prototype.removePredecessor=function(e){this.updatePredecessorHelper(e,null)},e.prototype.updatePredecessor=function(e,t,i){return this.updatePredecessorHelper(e,t,i)},e.prototype.updatePredecessorHelper=function(e,t,i){if(Object(w["X"])(t)||this.validatePredecessorRelation(e,t)){this.parent.isOnEdit=!0;var n=[];Object(w["T"])(t)||""===t||(n=this.parent.predecessorModule.calculatePredecessor(t,e)),this.parent.setRecordValue("predecessor",n,e.ganttProperties,!0);var r=this.parent.predecessorModule.getPredecessorStringValue(e);this.parent.setRecordValue("predecessorsName",r,e.ganttProperties,!0),this.parent.setRecordValue("taskData."+this.parent.taskFields.dependency,r,e),this.parent.setRecordValue(this.parent.taskFields.dependency,r,e);var s={};return s.action=i&&i.action&&"CellEditing"===i.action?i.action:"DrawConnectorLine",s.data=e,this.parent.editModule.initiateUpdateAction(s),!0}return!1},e.prototype.checkParentRelation=function(e,t){var i=e,n=!0;if(i&&i.parentItem&&-1!==t.indexOf(i.parentItem.taskId.toString()))return!1;for(var r=function(e){var i=s.parent.currentViewData.filter(function(i){return i&&i.ganttProperties.rowUniqueID.toString()===t[e].toString()});if(i[0]&&i[0].hasChildRecords)return{value:!1}},s=this,a=0;a<t.length;a++){var o=r(a);if("object"===typeof o)return o.value}return n},e.prototype.initPredecessorValidationDialog=function(){if(this.parent.taskFields.dependency&&this.parent.isInPredecessorValidation){var e=Object(w["C"])("div",{id:this.parent.element.id+"_dialogValidationRule"});this.parent.element.appendChild(e),this.renderValidationDialog()}},e.prototype.renderValidationDialog=function(){var e=new L["a"]({header:"Validate Editing",isModal:!0,visible:!1,width:"50%",showCloseIcon:!0,close:this.validationDialogClose.bind(this),content:"",buttons:[{click:this.validationDialogOkButton.bind(this),buttonModel:{content:this.parent.localeObj.getConstant("okText"),isPrimary:!0}},{click:this.validationDialogCancelButton.bind(this),buttonModel:{content:this.parent.localeObj.getConstant("cancel")}}],target:this.parent.element,animationSettings:{effect:"None"}});document.getElementById(this.parent.element.id+"_dialogValidationRule").innerHTML="",e.isStringTemplate=!0,e.appendTo("#"+this.parent.element.id+"_dialogValidationRule"),this.parent.validationDialogElement=e},e.prototype.validationDialogOkButton=function(){var e=this.parent.currentEditedArgs;e.validateMode.preserveLinkWithEditing=document.getElementById(this.parent.element.id+"_ValidationAddlineOffset").checked,e.validateMode.removeLink=document.getElementById(this.parent.element.id+"_ValidationRemoveline").checked,e.validateMode.respectLink=document.getElementById(this.parent.element.id+"_ValidationCancel").checked,this.applyPredecessorOption(),this.parent.validationDialogElement.hide()},e.prototype.validationDialogCancelButton=function(){this.parent.currentEditedArgs.validateMode.respectLink=!0,this.applyPredecessorOption(),this.parent.validationDialogElement.hide()},e.prototype.validationDialogClose=function(e){Object(w["R"])("isInteraction",e)&&(this.parent.currentEditedArgs.validateMode.respectLink=!0,this.applyPredecessorOption())},e.prototype.applyPredecessorOption=function(){var e=this.parent.currentEditedArgs,t=e.data;e.validateMode.respectLink?(this.parent.editModule.reUpdatePreviousRecords(),this.parent.chartRowsModule.refreshRecords([e.data])):e.validateMode.removeLink?(this.removePredecessors(t,this.validationPredecessor),this.parent.editModule.updateEditedTask(e.editEventArgs)):e.validateMode.preserveLinkWithEditing&&(this.calculateOffset(t),this.parent.editModule.updateEditedTask(e.editEventArgs))},e.prototype.calculateOffset=function(e){for(var t=Object(w["G"])([],e.ganttProperties.predecessor,[],!0),i=this.parent.predecessorModule.getValidPredecessor(e),n=0;n<i.length;n++){var r=i[n],s=this.parent.connectorLineModule.getRecordByID(r.from),a=void 0;if(Object(R["h"])(s.ganttProperties)&&Object(R["h"])(e.ganttProperties)){var o=void 0,l=void 0,d=void 0,c=void 0;switch(r.type){case"FS":o=new Date(s.ganttProperties.endDate.getTime()),l=new Date(e.ganttProperties.startDate.getTime());break;case"SS":o=new Date(s.ganttProperties.startDate.getTime()),l=new Date(e.ganttProperties.startDate.getTime());break;case"SF":o=new Date(s.ganttProperties.startDate.getTime()),l=new Date(e.ganttProperties.endDate.getTime());break;case"FF":o=new Date(s.ganttProperties.endDate.getTime()),l=new Date(e.ganttProperties.endDate.getTime());break}if(o.getTime()<l.getTime())o=this.dateValidateModule.checkStartDate(o),l=this.dateValidateModule.checkEndDate(l,null),c=!1;else{var h=new Date(o.getTime());o=this.dateValidateModule.checkStartDate(l),l=this.dateValidateModule.checkEndDate(h,null),c=!0}o.getTime()<l.getTime()?(d=this.dateValidateModule.getDuration(o,l,r.offsetUnit,!0,!1),a=c?-1*d:d):a=0}else a=0;var p=Object(R["b"])(r,"from",t,"to");t[p].offset=a;var u=Object(w["G"])([],s.ganttProperties.predecessor,[],!0),m=Object(R["b"])(r,"from",u,"to");u[m].offset=a,this.parent.setRecordValue("predecessor",u,s.ganttProperties,!0)}this.parent.setRecordValue("predecessor",t,e.ganttProperties,!0);var g=this.parent.predecessorModule.getPredecessorStringValue(e);this.parent.setRecordValue("taskData."+this.parent.taskFields.dependency,g,e),this.parent.setRecordValue(this.parent.taskFields.dependency,g,e),this.parent.setRecordValue("predecessorsName",g,e.ganttProperties,!0)},e.prototype.removePredecessors=function(e,t){for(var i=Object(w["G"])([],[],e.ganttProperties.predecessor,!0),n=t.length,r=0;r<n;r++){var s=this.parent.connectorLineModule.getRecordByID(t[r].from),a=Object(w["G"])([],[],s.ganttProperties.predecessor,!0),o=Object(R["b"])(t[r],"from",i,"to");i.splice(o,1);var l=Object(R["b"])(t[r],"from",a,"to");a.splice(l,1),this.parent.setRecordValue("predecessor",a,s.ganttProperties,!0)}if(i.length!==e.ganttProperties.predecessor.length){this.parent.setRecordValue("predecessor",i,e.ganttProperties,!0);var d=this.parent.predecessorModule.getPredecessorStringValue(e);this.parent.setRecordValue("predecessorsName",d,e.ganttProperties,!0),this.parent.setRecordValue("taskData."+this.parent.taskFields.dependency,d,e),this.parent.setRecordValue(this.parent.taskFields.dependency,d,e)}},e.prototype.openValidationDialog=function(e){var t=this.validationDialogTemplate(e);this.parent.validationDialogElement.setProperties({content:t}),this.parent.validationDialogElement.show()},e.prototype.validationDialogTemplate=function(e){var t,i=this.parent.element.id,n=Object(w["C"])("div",{className:"e-ValidationContent"}),r=Object(w["R"])("task",e),s=Object(w["R"])("parentTask",e),a=Object(w["R"])("violationType",e),o=r.ganttProperties.taskName,l=this.parent.getFormatedDate(r.ganttProperties.startDate,"MM/dd/yyyy"),d=s.ganttProperties.taskName,c=[o,d];"taskBeforePredecessor_FS"===a?t=this.parent.localeObj.getConstant("taskBeforePredecessor_FS"):"taskAfterPredecessor_FS"===a?t=this.parent.localeObj.getConstant("taskAfterPredecessor_FS"):"taskBeforePredecessor_SS"===a?t=this.parent.localeObj.getConstant("taskBeforePredecessor_SS"):"taskAfterPredecessor_SS"===a?t=this.parent.localeObj.getConstant("taskAfterPredecessor_SS"):"taskBeforePredecessor_FF"===a?t=this.parent.localeObj.getConstant("taskBeforePredecessor_FF"):"taskAfterPredecessor_FF"===a?t=this.parent.localeObj.getConstant("taskAfterPredecessor_FF"):"taskBeforePredecessor_SF"===a?t=this.parent.localeObj.getConstant("taskBeforePredecessor_SF"):"taskAfterPredecessor_SF"===a&&(t=this.parent.localeObj.getConstant("taskAfterPredecessor_SF")),t=Object(R["a"])(t,c);var h='<div id="'+i+'_ValidationText">'+t+"<div>",p='<table><tr><td><input type="radio" id="'+i+'_ValidationCancel" name="ValidationRule" checked/><label for="'+i+'_ValidationCancel" id= "'+i+'_cancelLink">Cancel, keep the existing link</label></td></tr><tr><td><input type="radio" id="'+i+'_ValidationRemoveline" name="ValidationRule"/><label for="'+i+'_ValidationRemoveline" id="'+i+'_removeLink">Remove the link and move <b>'+o+"</b> to start on <b>"+l+'</b>.</label></td></tr><tr><td><input type="radio" id="'+i+'_ValidationAddlineOffset" name="ValidationRule"/><label for="'+i+'_ValidationAddlineOffset" id="'+i+'_preserveLink">Move the <b>'+o+"</b> to start on <b>"+l+"</b> and keep the link.</label></td></tr></table>";return n.innerHTML=h+p,n},e.prototype.validateTypes=function(e){var t,i,n,r=this.parent.predecessorModule.getValidPredecessor(e);this.validationPredecessor=[];for(var s=this.parent.predecessorModule.getPredecessorDate(e,r),a=e.ganttProperties,o=this.parent.allowUnscheduledTasks&&Object(w["T"])(s)?a.endDate:this.dateValidateModule.getEndDate(s,a.duration,a.durationUnit,a,!1),l=0;l<r.length;l++){t=this.parent.connectorLineModule.getRecordByID(r[l].from);var d=null;"FS"===r[l].type?a.startDate<s?(this.validationPredecessor.push(r[l]),d="taskBeforePredecessor_FS"):a.startDate>s&&(this.validationPredecessor.push(r[l]),d="taskAfterPredecessor_FS"):"SS"===r[l].type?a.startDate<s?(this.validationPredecessor.push(r[l]),d="taskBeforePredecessor_SS"):a.startDate>s&&(this.validationPredecessor.push(r[l]),d="taskAfterPredecessor_SS"):"FF"===r[l].type?o<=t.ganttProperties.endDate?(this.validationPredecessor.push(r[l]),d="taskBeforePredecessor_FF"):o>t.ganttProperties.endDate&&(this.validationPredecessor.push(r[l]),d="taskAfterPredecessor_FF"):"SF"===r[l].type&&(o<t.ganttProperties.startDate?(this.validationPredecessor.push(r[l]),d="taskBeforePredecessor_SF"):o>=t.ganttProperties.startDate&&(this.validationPredecessor.push(r[l]),d="taskAfterPredecessor_SF")),!Object(w["T"])(d)&&Object(w["T"])(n)&&(i=t,n=d)}var c={parentTask:i,task:e,violationType:n};return c},e.prototype.addRemovePredecessor=function(e){var t=this.parent.previousRecords[e.uniqueID],i=e.ganttProperties.predecessor.slice();if(t&&t.ganttProperties&&t.ganttProperties.hasOwnProperty("predecessor")){var n=t.ganttProperties.predecessor;if(!Object(w["T"])(n))for(var r=0;r<n.length;r++){var s=this.parent.connectorLineModule.getRecordByID(n[r].from);if(s===e)e.ganttProperties.predecessor.push(n[r]);else{var a=Object(w["G"])([],[],s.ganttProperties.predecessor,!0),o=Object(R["b"])(n[r],"from",a,"to");-1!==o&&(a.splice(o,1),this.parent.setRecordValue("predecessor",a,s.ganttProperties,!0))}}if(!Object(w["T"])(i))for(var l=0;l<i.length;l++){s=this.parent.connectorLineModule.getRecordByID(i[l].from),a=Object(w["G"])([],[],s.ganttProperties.predecessor,!0);a.push(i[l]),this.parent.setRecordValue("predecessor",a,s.ganttProperties,!0)}}},e.prototype.removePredecessorByIndex=function(e,t){var i=e.ganttProperties.predecessor,n=i.splice(t,1),r=this.parent.connectorLineModule.getRecordByID(n[0].from),s=r.ganttProperties.predecessor,a=Object(R["b"])(n[0],"from",s,"to");s.splice(a,1);var o=this.parent.predecessorModule.getPredecessorStringValue(e);i.push(n[0]),this.parent.connectorLineEditModule.updatePredecessor(e,o)},e.prototype.renderPredecessorDeleteConfirmDialog=function(){this.confirmPredecessorDialog=new L["a"]({width:"320px",isModal:!0,content:this.parent.localeObj.getConstant("confirmPredecessorDelete"),buttons:[{click:this.confirmOkDeleteButton.bind(this),buttonModel:{content:this.parent.localeObj.getConstant("okText"),isPrimary:!0}},{click:this.confirmCloseDialog.bind(this),buttonModel:{content:this.parent.localeObj.getConstant("cancel")}}],target:this.parent.element,animationSettings:{effect:"None"}});var e=Object(w["C"])("div",{id:this.parent.element.id+"_deletePredecessorConfirmDialog"});this.parent.element.appendChild(e),this.confirmPredecessorDialog.isStringTemplate=!0,this.confirmPredecessorDialog.appendTo(e)},e.prototype.confirmCloseDialog=function(){this.confirmPredecessorDialog.destroy()},e.prototype.confirmOkDeleteButton=function(){this.removePredecessorByIndex(this.childRecord,this.predecessorIndex),this.confirmPredecessorDialog.destroy()},e}(),_h=function(){function e(e){if(this.isFromDeleteMethod=!1,this.targetedRecords=[],this.updateParentRecords=[],this.isaddtoBottom=!1,this.confirmDialog=null,this.taskbarMoved=!1,this.predecessorUpdated=!1,this.isBreakLoop=!1,this.deletedTaskDetails=[],this.parent=e,this.validatedChildItems=[],this.parent.editSettings.allowEditing&&"Auto"===this.parent.editSettings.mode&&(this.cellEditModule=new Ee(this.parent)),this.parent.taskFields.dependency&&(this.parent.connectorLineEditModule=new zh(this.parent)),(this.parent.editSettings.allowAdding||this.parent.editSettings.allowEditing&&("Dialog"===this.parent.editSettings.mode||"Auto"===this.parent.editSettings.mode))&&(this.dialogModule=new Oh(this.parent)),this.parent.editSettings.allowTaskbarEditing&&(this.taskbarEditModule=new Ae(this.parent)),this.parent.editSettings.allowDeleting){var t=Object(w["C"])("div",{id:this.parent.element.id+"_deleteConfirmDialog"});this.parent.element.appendChild(t),this.renderDeleteConfirmDialog()}this.parent.treeGrid.recordDoubleClick=this.recordDoubleClick.bind(this),this.parent.treeGrid.editSettings.allowAdding=this.parent.editSettings.allowAdding,this.parent.treeGrid.editSettings.allowDeleting=this.parent.editSettings.allowDeleting,this.parent.treeGrid.editSettings.showDeleteConfirmDialog=this.parent.editSettings.showDeleteConfirmDialog,this.parent.treeGrid.editSettings.allowNextRowEdit=this.parent.editSettings.allowNextRowEdit,this.updateDefaultColumnEditors()}return e.prototype.getModuleName=function(){return"edit"},e.prototype.updateDefaultColumnEditors=function(){for(var e=[this.parent.taskFields.id,this.parent.taskFields.progress,this.parent.taskFields.resourceInfo,"taskType"],t=0;t<e.length;t++)if(!Object(w["T"])(e[t])&&e[t].length>0){var i=this.parent.getColumnByField(e[t],this.parent.treeGridModule.treeGridColumns);i&&(i.field===this.parent.taskFields.id?this.updateIDColumnEditParams(i):i.field===this.parent.taskFields.progress?this.updateProgessColumnEditParams(i):i.field===this.parent.taskFields.resourceInfo?this.updateResourceColumnEditor(i):"taskType"===i.field&&this.updateTaskTypeColumnEditor(i))}},e.prototype.updateIDColumnEditParams=function(e){var t={min:0,decimals:0,validateDecimalOnType:!0,format:"n0",showSpinButton:!1};this.updateEditParams(e,t)},e.prototype.updateProgessColumnEditParams=function(e){var t={min:0,decimals:0,validateDecimalOnType:!0,max:100,format:"n0"};this.updateEditParams(e,t)},e.prototype.updateEditParams=function(e,t){Object(w["T"])(e.edit)?(e.edit={},e.edit.params={}):Object(w["T"])(e.edit.params)&&(e.edit.params={}),Object(w["G"])(t,e.edit.params),e.edit.params=t;var i=this.parent.getColumnByField(e.field,this.parent.ganttColumns);i.edit=e.edit},e.prototype.updateResourceColumnEditor=function(e){if(this.parent.editSettings.allowEditing&&Object(w["T"])(e.edit)&&"Auto"===this.parent.editSettings.mode){e.editType="dropdownedit",e.edit=this.getResourceEditor();var t=this.parent.getColumnByField(e.field,this.parent.ganttColumns);t.editType="dropdownedit",t.edit=e.edit}},e.prototype.getResourceEditor=function(){var e,t=this,i=this.parent.resourceFields,n={};return Th["a"].Inject(qh),n.write=function(n){t.parent.treeGridModule.currentEditRow={},e=new Th["a"]({dataSource:new O["a"](t.parent.resources),fields:{text:i.name,value:i.id},mode:"CheckBox",showDropDownIcon:!0,popupHeight:"350px",delimiterChar:",",value:t.parent.treeGridModule.getResourceIds(n.rowData)}),e.appendTo(n.element)},n.read=function(e){var n=e.ej2_instances[0].value,r=[];Object(w["T"])(n)&&(n=[]);for(var s=0;s<n.length;s++)for(var a=0;a<t.parent.resources.length;a++)if(t.parent.resources[a][i.id]===n[s]){r.push(t.parent.resources[a][i.name]);break}return t.parent.treeGridModule.currentEditRow[t.parent.taskFields.resourceInfo]=n,r.join(",")},n.destroy=function(){e&&e.destroy()},n},e.prototype.updateTaskTypeColumnEditor=function(e){if(this.parent.editSettings.allowEditing&&Object(w["T"])(e.edit)&&"Auto"===this.parent.editSettings.mode){e.editType="dropdownedit",e.edit=this.getTaskTypeEditor();var t=this.parent.getColumnByField(e.field,this.parent.ganttColumns);t.editType="dropdownedit",t.edit=e.edit}},e.prototype.getTaskTypeEditor=function(){var e,t=this,i={},n=[{ID:1,Value:"FixedUnit"},{ID:2,Value:"FixedWork"},{ID:3,Value:"FixedDuration"}];return i.write=function(i){t.parent.treeGridModule.currentEditRow={},e=new U["a"]({dataSource:new O["a"](n),fields:{value:"Value"},popupHeight:"350px",value:Object(w["R"])("taskType",i.rowData.ganttProperties)}),e.appendTo(i.element)},i.read=function(e){var i=e.ej2_instances[0].value,n="taskType";return t.parent.treeGridModule.currentEditRow[n]=i,i},i.destroy=function(){e&&e.destroy()},i},e.prototype.reUpdateEditModules=function(){var e=this.parent.editSettings;if(e.allowEditing?(this.parent.editModule.cellEditModule&&"Dialog"===e.mode?(this.cellEditModule.destroy(),this.parent.treeGrid.recordDoubleClick=this.recordDoubleClick.bind(this)):Object(w["T"])(this.parent.editModule.cellEditModule)&&"Auto"===e.mode&&(this.cellEditModule=new Ee(this.parent)),this.parent.editModule.dialogModule&&"Auto"===e.mode?this.parent.treeGrid.recordDoubleClick=void 0:Object(w["T"])(this.parent.editModule.dialogModule)&&(this.dialogModule=new Oh(this.parent))):(this.cellEditModule&&this.cellEditModule.destroy(),this.dialogModule&&this.dialogModule.destroy()),e.allowDeleting&&e.showDeleteConfirmDialog){if(Object(w["T"])(this.confirmDialog)){var t=Object(w["C"])("div",{id:this.parent.element.id+"_deleteConfirmDialog"});this.parent.element.appendChild(t),this.renderDeleteConfirmDialog()}}else e.allowDeleting&&e.showDeleteConfirmDialog||this.confirmDialog&&!this.confirmDialog.isDestroyed&&this.confirmDialog.destroy();e.allowTaskbarEditing?Object(w["T"])(this.parent.editModule.taskbarEditModule)&&(this.taskbarEditModule=new Ae(this.parent)):this.taskbarEditModule&&this.taskbarEditModule.destroy()},e.prototype.recordDoubleClick=function(e){if(this.parent.editSettings.allowEditing&&"Dialog"===this.parent.editSettings.mode){var t=void 0;if(e.row){var i=Object(w["R"])("rowIndex",e.row);t=this.parent.currentViewData[i]}Object(w["T"])(t)||this.dialogModule.openEditDialog(t)}this.parent.ganttChartModule.recordDoubleClick(e)},e.prototype.destroy=function(){this.cellEditModule&&this.cellEditModule.destroy(),this.taskbarEditModule&&this.taskbarEditModule.destroy(),this.dialogModule&&this.dialogModule.destroy(),this.confirmDialog&&!this.confirmDialog.isDestroyed&&this.confirmDialog.destroy()},e.prototype.updateRecordByID=function(e){if(!this.parent.readOnly){var t=this.parent.taskFields;if(Object(w["T"])(e)||Object(w["T"])(e[t.id]))return;var i="ResourceView"===this.parent.viewType?this.parent.flatData[this.parent.getTaskIds().indexOf("T"+e[t.id])]:this.parent.getRecordByID(e[t.id]);if(!Object(w["T"])(this.parent.editModule)&&i){this.parent.isOnEdit=!0,this.validateUpdateValues(e,i,!0),e[this.parent.taskFields.resourceInfo]&&(0===i.ganttProperties.duration&&this.parent.dataOperation.updateWorkWithDuration(i),this.updateResourceRelatedFields(i,"resource"),this.parent.dateValidationModule.calculateEndDate(i));var n=Object.keys(e);if(-1===n.indexOf(t.startDate)&&-1===n.indexOf(t.endDate)&&-1===n.indexOf(t.duration)||this.parent.dataOperation.calculateScheduledValues(i,i.taskData,!1),this.parent.dataOperation.updateWidthLeft(i),Object(w["X"])(e[this.parent.taskFields.dependency])||e[this.parent.taskFields.dependency]===i.ganttProperties.predecessorsName){var r={};r.data=i,"ResourceView"===this.parent.viewType&&(r.action="methodUpdate"),this.parent.editModule.initiateUpdateAction(r)}else this.parent.connectorLineEditModule.updatePredecessor(i,e[this.parent.taskFields.dependency])}}},e.prototype.validateUpdateValues=function(e,t,i){for(var n=this.parent,r=n.taskFields,s=Object(R["c"])(n.columnMapping),a=[],o=!1,l=0,d=Object.keys(e);l<d.length;l++){var c=d[l];if(-1!==[r.startDate,r.endDate,r.duration].indexOf(c)){if(Object(w["T"])(e[c])&&!n.allowUnscheduledTasks)continue;if(i)if(r.duration===c)n.dataOperation.updateDurationValue(e[c],t.ganttProperties),t.ganttProperties.duration>0&&t.ganttProperties.isMilestone&&this.parent.setRecordValue("isMilestone",!1,t.ganttProperties,!0),n.dataOperation.updateMappingData(t,s[c]);else{var h="string"===typeof e[c]?new Date(e[c]):e[c];n.setRecordValue(s[c],h,t.ganttProperties,!0),n.dataOperation.updateMappingData(t,s[c])}else a.push(c),o=!0}else if(r.resourceInfo===c){var p=n.dataOperation.setResourceInfo(e);"ResourceView"===this.parent.viewType&&(JSON.stringify(p)!==JSON.stringify(t.ganttProperties.resourceInfo)?(this.parent.editModule.dialogModule.isResourceUpdate=!0,this.parent.editModule.dialogModule.previousResource=Object(w["T"])(t.ganttProperties.resourceInfo)?[]:t.ganttProperties.resourceInfo.slice()):this.parent.editModule.dialogModule.isResourceUpdate=!1),t.ganttProperties.resourceInfo=p,n.dataOperation.updateMappingData(t,"resourceInfo")}else if(r.dependency===c);else if(-1!==[r.progress,r.notes,r.durationUnit,r.expandState,r.milestone,r.name,r.baselineStartDate,r.baselineEndDate,r.id,r.segments].indexOf(c)){var u=n.columnByField[c],m=e[c];Object(w["T"])(u)||"datepickeredit"!==u.editType&&"datetimepickeredit"!==u.editType||(m=n.dataOperation.getDateFromFormat(m));var g=s[c];if(c===r.id)g="taskId";else if(c===r.name)g="taskName";else if(c===r.segments&&(g="segments",e&&!Object(w["T"])(e[this.parent.taskFields.segments])&&e[this.parent.taskFields.segments].length>0)){for(var f=0,b=0;b<t.ganttProperties.segments.length;b++)f+=t.ganttProperties.segments[b].duration;var v=t.ganttProperties.startDate,y=this.parent.dataOperation.getEndDate(v,f,t.ganttProperties.durationUnit,t.ganttProperties,!1);n.setRecordValue("endDate",n.dataOperation.getDateFromFormat(y),t.ganttProperties,!0)}Object(w["T"])(g)||n.setRecordValue(g,m,t.ganttProperties,!0),(c===r.baselineStartDate||c===r.baselineEndDate)&&t.ganttProperties.baselineStartDate&&t.ganttProperties.baselineEndDate&&(n.setRecordValue("baselineStartDate",n.dataOperation.checkBaselineStartDate(t.ganttProperties.baselineStartDate),t.ganttProperties,!0),n.dataOperation.setTime(this.parent.defaultEndTime,t.ganttProperties.baselineEndDate),n.setRecordValue("baselineEndDate",n.dataOperation.checkBaselineEndDate(t.ganttProperties.baselineEndDate),t.ganttProperties,!0),n.setRecordValue("baselineLeft",n.dataOperation.calculateBaselineLeft(t.ganttProperties),t.ganttProperties,!0),n.setRecordValue("baselineWidth",n.dataOperation.calculateBaselineWidth(t.ganttProperties),t.ganttProperties,!0)),n.setRecordValue("taskData."+c,m,t),c===r.segments&&e&&!Object(w["T"])(e[this.parent.taskFields.segments])&&e[this.parent.taskFields.segments].length>0&&n.dataOperation.setSegmentsInfo(t,!0),n.setRecordValue(c,m,t)}else if(r.indicators===c){m=e[c];n.setRecordValue("indicators",m,t.ganttProperties,!0),n.setRecordValue("taskData."+c,m,t),n.setRecordValue(c,m,t)}else if(r.work===c)n.setRecordValue("work",e[c],t.ganttProperties,!0),this.parent.dataOperation.updateMappingData(t,"work"),this.parent.dataOperation.updateMappingData(t,"duration"),this.parent.dataOperation.updateMappingData(t,"endDate");else if("taskType"===c)n.setRecordValue("taskType",e[c],t.ganttProperties,!0);else if(-1!==n.customColumns.indexOf(c)){u=n.columnByField[c],m=e[c];Object(w["T"])(u.edit)&&("datepickeredit"!==u.editType&&"datetimepickeredit"!==u.editType||(m=n.dataOperation.getDateFromFormat(m))),n.setRecordValue("taskData."+c,m,t),n.setRecordValue(c,m,t)}else r.manual===c&&(n.setRecordValue("isAutoSchedule",!e[c],t.ganttProperties,!0),this.parent.setRecordValue(c,e[c],t),this.updateTaskScheduleModes(t))}o&&this.validateScheduleValues(a,t,e)},e.prototype.updateResourceRelatedFields=function(e,t){var i,n=e.ganttProperties,r=n.taskType,s=n.isAutoSchedule;if(!Object(w["T"])(n.resourceInfo))if(n.work>0||"work"===t)switch(r){case"FixedUnit":if(0===n.resourceInfo.length)return;s&&n.resourceInfo.length&&("work"===t||"resource"===t)?this.parent.dataOperation.updateDurationWithWork(e):s||"work"!==t?this.parent.dataOperation.updateWorkWithDuration(e):this.parent.dataOperation.updateUnitWithWork(e);break;case"FixedWork":if(0===n.resourceInfo.length)return;s?"duration"===t||"endDate"===t?(this.parent.dataOperation.updateUnitWithWork(e),0===n.duration&&(this.parent.setRecordValue("work",0,n,!0),Object(w["T"])(this.parent.taskFields.work)||this.parent.dataOperation.updateMappingData(e,"work"))):this.parent.dataOperation.updateDurationWithWork(e):"work"===t?this.parent.dataOperation.updateUnitWithWork(e):this.parent.dataOperation.updateWorkWithDuration(e);break;case"FixedDuration":n.resourceInfo.length&&("work"===t||s&&i&&"resource"===t)?this.parent.dataOperation.updateUnitWithWork(e):this.parent.dataOperation.updateWorkWithDuration(e);break}else this.parent.dataOperation.updateWorkWithDuration(e)},e.prototype.validateScheduleValues=function(e,t,i){var n=this.parent;e.length>2?n.dataOperation.calculateScheduledValues(t,i,!1):e.length>1?this.validateScheduleByTwoValues(i,e,t):this.dialogModule.validateScheduleValuesByCurrentField(e[0],i[e[0]],t)},e.prototype.validateScheduleByTwoValues=function(e,t,i){var n,r,s,a=this.parent,o=a.taskFields,l=i.ganttProperties,d=a.allowUnscheduledTasks;-1!==t.indexOf(o.startDate)&&(n=e[o.startDate]),-1!==t.indexOf(o.endDate)&&(r=e[o.endDate]),-1!==t.indexOf(o.duration)&&(s=e[o.duration]),n&&r||d&&-1!==t.indexOf(o.startDate)&&-1!==t.indexOf(o.endDate)?(a.setRecordValue("startDate",a.dataOperation.getDateFromFormat(n),l,!0),a.setRecordValue("endDate",a.dataOperation.getDateFromFormat(r),l,!0),a.dataOperation.calculateDuration(i)):r&&s||d&&-1!==t.indexOf(o.endDate)&&-1!==t.indexOf(o.duration)?(a.setRecordValue("endDate",a.dataOperation.getDateFromFormat(r),l,!0),a.dataOperation.updateDurationValue(s,l)):(n&&s||d&&-1!==t.indexOf(o.startDate)&&-1!==t.indexOf(o.duration))&&(a.setRecordValue("startDate",a.dataOperation.getDateFromFormat(n),l,!0),a.dataOperation.updateDurationValue(s,l))},e.prototype.isTaskbarMoved=function(e){var t=!1,i=e.ganttProperties,n=this.parent.previousRecords&&this.parent.previousRecords[e.uniqueID];if(n&&n.ganttProperties){var r=Object(w["R"])("ganttProperties.startDate",n),s=Object(w["R"])("ganttProperties.endDate",n),a=Object(w["R"])("ganttProperties.duration",n),o=Object(w["R"])("ganttProperties.durationUnit",n),l=Object.keys(n.ganttProperties);-1===l.indexOf("startDate")&&-1===l.indexOf("endDate")&&-1===l.indexOf("duration")&&-1===l.indexOf("durationUnit")||(Object(w["T"])(r)&&!Object(w["T"])(i.startDate)||Object(w["T"])(s)&&!Object(w["T"])(i.endDate)||Object(w["T"])(i.startDate)&&!Object(w["T"])(r)||Object(w["T"])(i.endDate)&&!Object(w["T"])(s)||r&&r.getTime()!==i.startDate.getTime()||s&&s.getTime()!==i.endDate.getTime()||!Object(w["T"])(a)&&a!==i.duration||!Object(w["T"])(a)&&a===i.duration&&o!==i.durationUnit)&&(t=!0)}return t},e.prototype.isPredecessorUpdated=function(e){var t=!1,i=this.parent.previousRecords[e.uniqueID];return i&&i.ganttProperties&&i.ganttProperties.hasOwnProperty("predecessor")&&(e.ganttProperties.predecessorsName!==i.ganttProperties.predecessorsName?t=!0:this.parent.setRecordValue("predecessor",i.ganttProperties.predecessor,e.ganttProperties,!0)),t},e.prototype.isCheckPredecessor=function(e){var t=!1,i=this.parent.previousRecords[e.uniqueID];return i&&this.parent.taskFields.dependency&&this.parent.isInPredecessorValidation&&this.parent.predecessorModule.getValidPredecessor(e).length>0&&this.isTaskbarMoved(e)&&(t=!0),t},e.prototype.updateGanttProperties=function(e,t){var i=["taskId","uniqueID","rowUniqueID","parentId"];Object.keys(e.ganttProperties).forEach(function(n){-1===i.indexOf(n)&&(t.ganttProperties[n]=e.ganttProperties[n])})},e.prototype.initiateUpdateAction=function(e){var t=this.isCheckPredecessor(e.data);this.taskbarMoved=this.isTaskbarMoved(e.data),this.predecessorUpdated=this.isPredecessorUpdated(e.data),this.predecessorUpdated&&(this.parent.isConnectorLineUpdate=!0,this.parent.connectorLineEditModule.addRemovePredecessor(e.data));var i={};if(t)if(i=this.parent.connectorLineEditModule.validateTypes(e.data),this.parent.isConnectorLineUpdate=!0,Object(w["T"])(Object(w["R"])("violationType",i)))this.updateEditedTask(e);else{var n=this.validateTaskEvent(e);!1===n.validateMode.preserveLinkWithEditing&&!1===n.validateMode.removeLink&&!1===n.validateMode.respectLink?this.parent.connectorLineEditModule.openValidationDialog(i):this.parent.connectorLineEditModule.applyPredecessorOption()}else this.taskbarMoved&&(this.parent.isConnectorLineUpdate=!0),this.updateEditedTask(e)},e.prototype.validateTaskEvent=function(e){var t={};return this.resetValidateArgs(),this.parent.currentEditedArgs=t,t.cancel=!1,t.data=e.data,t.requestType="validateLinkedTask",t.validateMode=this.parent.dialogValidateMode,t.editEventArgs=e,this.parent.actionBeginTask(t),t},e.prototype.resetValidateArgs=function(){this.parent.dialogValidateMode.preserveLinkWithEditing=!0,this.parent.dialogValidateMode.removeLink=!1,this.parent.dialogValidateMode.respectLink=!1},e.prototype.updateEditedTask=function(e){var t=e.data;if(this.updateParentChildRecord(t),this.parent.isConnectorLineUpdate){for(var i=0;i<this.validatedChildItems.length;i++){var n=this.validatedChildItems[i];n.ganttProperties.predecessor&&n.ganttProperties.predecessor.length>0&&(this.parent.editedTaskBarItem=n,this.parent.predecessorModule.validatePredecessor(n,[],""))}t.ganttProperties.predecessor&&(this.parent.isMileStoneEdited=t.ganttProperties.isMilestone,this.taskbarMoved&&(this.parent.editedTaskBarItem=t),this.parent.predecessorModule.validatePredecessor(t,[],"")),this.updateParentItemOnEditing()}t.parentItem&&this.parent.dataOperation.updateParentItems(t,!0),this.initiateSaveAction(e)},e.prototype.updateParentItemOnEditing=function(){for(var e=Object(w["R"])("parentRecord",this.parent.predecessorModule),t=0;t<e.length;t++)this.parent.dataOperation.updateParentItems(e[t]);Object(w["ob"])("parentRecord",[],this.parent.predecessorModule),Object(w["ob"])("parentIds",[],this.parent.predecessorModule)},e.prototype.updateParentChildRecord=function(e){var t=e;t.hasChildRecords&&this.taskbarMoved&&"Auto"===this.parent.taskMode&&!Object(w["T"])(this.parent.editModule.cellEditModule)&&!this.parent.editModule.cellEditModule.isResourceCellEdited&&this.updateChildItems(t),Object(w["T"])(this.parent.editModule.cellEditModule)||(this.parent.editModule.cellEditModule.isResourceCellEdited=!1)},e.prototype.updateTaskScheduleModes=function(e){var t=e[this.parent.taskFields.startDate],i=e.ganttProperties;if(e.hasChildRecords&&i.isAutoSchedule)this.parent.setRecordValue("startDate",i.autoStartDate,i,!0),this.parent.setRecordValue("endDate",i.autoEndDate,i,!0),this.parent.setRecordValue("width",this.parent.dataOperation.calculateWidth(e,!0),i,!0),this.parent.setRecordValue("left",this.parent.dataOperation.calculateLeft(i,!0),i,!0),this.parent.setRecordValue("progressWidth",this.parent.dataOperation.getProgressWidth(i.width,i.progress),i,!0),this.parent.dataOperation.calculateDuration(e);else if(e.hasChildRecords&&!i.isAutoSchedule)this.parent.dataOperation.updateWidthLeft(e),this.parent.dataOperation.calculateDuration(e),this.parent.setRecordValue("autoStartDate",i.startDate,i,!0),this.parent.setRecordValue("autoEndDate",i.endDate,i,!0),this.parent.setRecordValue("autoDuration",this.parent.dataOperation.calculateAutoDuration(e),i,!0),this.parent.dataOperation.updateAutoWidthLeft(e);else{var n=this.parent.dateValidationModule.checkStartDate(t,e.ganttProperties);this.parent.setRecordValue("startDate",n,e.ganttProperties,!0),this.parent.dataOperation.updateMappingData(e,"startDate"),this.parent.dateValidationModule.calculateEndDate(e),this.parent.setRecordValue("taskData."+this.parent.taskFields.manual,e[this.parent.taskFields.manual],e),this.parent.dataOperation.updateWidthLeft(e)}},e.prototype.calculateDateByRoundOffDuration=function(e,t){var i=e,n=i.ganttProperties,r=new Date(t.getTime());if(!Object(w["T"])(n.endDate)&&Object(w["T"])(n.startDate)){var s=this.parent.dateValidationModule.checkStartDate(r,n,null);this.parent.setRecordValue("endDate",this.parent.dateValidationModule.checkEndDate(s,i.ganttProperties),n,!0)}else this.parent.setRecordValue("startDate",this.parent.dateValidationModule.checkStartDate(r,n,!1),n,!0),Object(w["T"])(n.duration)||this.parent.dateValidationModule.calculateEndDate(i);this.parent.dataOperation.updateWidthLeft(e),this.parent.dataOperation.updateTaskData(i)},e.prototype.updateParentProgress=function(e){var t=0,i=this.parent.getParentTask(e),n=i.childRecords,r=n?n.length:0,s=0,a=0,o=0,l=0,d={};if(n){for(var c=0;c<r;c++)n[c].ganttProperties.isMilestone&&!n[c].hasChildRecords||!Object(R["h"])(n[c].ganttProperties)?a+=1:(d=this.parent.dataOperation.getParentProgress(n[c]),s+=Object(w["R"])("totalProgress",d),l+=Object(w["R"])("totalDuration",d));o=r-a,t=o>0?Math.round(s/l):0,isNaN(t)&&(t=0),this.parent.setRecordValue("progressWidth",this.parent.dataOperation.getProgressWidth(i.ganttProperties.isAutoSchedule?i.ganttProperties.width:i.ganttProperties.autoWidth,t),i.ganttProperties,!0),this.parent.setRecordValue("progress",Math.floor(t),i.ganttProperties,!0),this.parent.setRecordValue("totalProgress",s,i.ganttProperties,!0),this.parent.setRecordValue("totalDuration",l,i.ganttProperties,!0)}this.parent.dataOperation.updateTaskData(i),i.parentItem&&this.updateParentProgress(i.parentItem)},e.prototype.revertCellEdit=function(e){this.parent.editModule.reUpdatePreviousRecords(!1,!0),this.resetEditProperties()},e.prototype.reUpdatePreviousRecords=function(e,t){for(var i=this.parent.previousRecords,n=Object.keys(i),r=0;r<n.length;r++){var s=n[r],a=i[s],o=this.parent.getTaskByUniqueID(s);this.copyTaskData(o.taskData,a.taskData),delete a.taskData,this.copyTaskData(o.ganttProperties,a.ganttProperties),delete a.ganttProperties,this.copyTaskData(o,a);var l=this.parent.currentViewData.indexOf(o);if(e&&this.parent.chartRowsModule.refreshRow(l),t){var d="ProjectView"===this.parent.viewType?o.ganttProperties.taskId:o.ganttProperties.rowUniqueID;this.parent.treeGrid.grid.setRowData(d,o);var c=this.parent.treeGrid.grid.getRowObjectFromUID(this.parent.treeGrid.grid.getDataRows()[l].getAttribute("data-uid"));c.data=o}}},e.prototype.copyTaskData=function(e,t){Object(w["T"])(t)||Object(w["G"])(e,t)},e.prototype.updateScheduleDatesOnEditing=function(e){},e.prototype.updateChildItems=function(e){var t,i=this.parent.previousRecords[e.uniqueID];t=Object(w["T"])(i)||Object(w["T"])(i)&&!Object(w["T"])(i.ganttProperties)?new Date(e.ganttProperties.startDate.getTime()):new Date(i.ganttProperties.startDate.getTime());var n,r,s,a,o,l=e.ganttProperties.startDate,d=[];if(this.getUpdatableChildRecords(e,d),0!==d.length){t.getTime()>l.getTime()?(n=this.parent.dateValidationModule.checkStartDate(l),r=this.parent.dateValidationModule.checkEndDate(t,e.ganttProperties),a=!1):(n=this.parent.dateValidationModule.checkStartDate(t),r=this.parent.dateValidationModule.checkEndDate(l,e.ganttProperties),a=!0),o=n.getTime()>=r.getTime()?0:this.parent.dateValidationModule.getDuration(n,r,"minute",!0,!1);for(var c=0;c<d.length;c++)if(d[c].ganttProperties.isAutoSchedule)if(o>0){var h=Object(R["h"])(d[c].ganttProperties)?d[c].ganttProperties.startDate:d[c].ganttProperties.startDate?d[c].ganttProperties.startDate:d[c].ganttProperties.endDate?d[c].ganttProperties.endDate:new Date(t.toString());s=a?this.parent.dateValidationModule.getEndDate(this.parent.dateValidationModule.checkStartDate(h,d[c].ganttProperties,d[c].ganttProperties.isMilestone),o,"minute",d[c].ganttProperties,!1):this.parent.dateValidationModule.getStartDate(this.parent.dateValidationModule.checkEndDate(h,d[c].ganttProperties),o,"minute",d[c].ganttProperties),this.calculateDateByRoundOffDuration(d[c],s),this.parent.isOnEdit&&-1===this.validatedChildItems.indexOf(d[c])&&this.validatedChildItems.push(d[c])}else Object(w["T"])(i)&&(s=t,this.calculateDateByRoundOffDuration(d[c],s),this.parent.isOnEdit&&-1===this.validatedChildItems.indexOf(d[c])&&this.validatedChildItems.push(d[c]));d.length&&this.parent.dataOperation.updateParentItems(e,!0)}},e.prototype.getUpdatableChildRecords=function(e,t){for(var i=e.childRecords,n=0;n<i.length;n++)i[n].ganttProperties.isAutoSchedule&&(t.push(i[n]),i[n].hasChildRecords&&this.getUpdatableChildRecords(i[n],t))},e.prototype.initiateSaveAction=function(e){var t=this;this.parent.showSpinner();var i={requestType:"beforeSave"};i.data=e.data,i.cancel=!1,i.modifiedRecords=this.parent.editedRecords,Object(w["T"])(e.target)||(i.target=e.target),i.modifiedTaskData=Object(R["d"])(this.parent.editedRecords,!0),e.action&&"DrawConnectorLine"===e.action&&(i.action="DrawConnectorLine"),this.parent.trigger("actionBegin",i,function(n){if(n.cancel)t.reUpdatePreviousRecords(),t.parent.chartRowsModule.refreshRecords([e.data]),t.resetEditProperties(i);else if(n.modifiedTaskData=Object(R["d"])(n.modifiedRecords,null,null,t.parent),Object(R["g"])(t.parent.dataSource)){var r=t.parent.dataSource,s={changedRecords:n.modifiedTaskData},a=t.parent.query instanceof T["b"]?t.parent.query:new T["b"],o=null,l=r.adaptor;if(l instanceof k["h"]&&l instanceof k["d"]&&!r.dataSource.batchUrl){var d="changedRecords";o=r.update(t.parent.taskFields.id,s[d],null,a)}else o=r.saveChanges(s,t.parent.taskFields.id,null,a);o.then(function(i){return t.dmSuccess(i,e)}).catch(function(i){return t.dmFailure(i,e)})}else t.saveSuccess(e)})},e.prototype.dmSuccess=function(e,t){this.saveSuccess(t)},e.prototype.dmFailure=function(e,t){if(this.deletedTaskDetails.length){for(var i=this.deletedTaskDetails,n=0;n<i.length;n++)i[n].isDelete=!1;this.deletedTaskDetails=[]}this.reUpdatePreviousRecords(!0,!0),this.resetEditProperties(),this.parent.trigger("actionFailure",{error:e})},e.prototype.updateSharedTask=function(e){for(var t=e.ganttProperties.sharedTaskUniqueIds,i=0;i<t.length;i++){var n=this.parent.flatData[this.parent.ids.indexOf(t[i].toString())];n.uniqueID!==e.uniqueID&&(this.updateGanttProperties(e,n),this.parent.setRecordValue("taskData",e.taskData,n,!0),this.parent.dataOperation.updateTaskData(n),this.parent.dataOperation.updateResourceName(n),Object(w["T"])(n.parentItem)||this.parent.dataOperation.updateParentItems(n.parentItem))}},e.prototype.saveSuccess=function(e){var t={};if(this.parent.timelineSettings.updateTimescaleView){var i=this.parent.editedRecords;this.parent.timelineModule.updateTimeLineOnEditing([i],e.action)}if("ResourceView"===this.parent.viewType){"TaskbarEditing"===e.action?this.updateSharedTask(e.data):"DialogEditing"!==e.action&&"CellEditing"!==e.action&&"methodUpdate"!==e.action||(this.parent.editModule.dialogModule.isResourceUpdate?(this.updateResoures(this.parent.editModule.dialogModule.previousResource,e.data.ganttProperties.resourceInfo,e.data),this.updateSharedTask(e.data),this.isTreeGridRefresh=!0):this.updateSharedTask(e.data));for(var n=0;n<this.updateParentRecords.length;n++)this.parent.dataOperation.updateParentItems(this.updateParentRecords[n]);this.updateParentRecords=[],this.parent.editModule.dialogModule.isResourceUpdate=!1,this.parent.editModule.dialogModule.previousResource=[]}if(this.isTreeGridRefresh||(this.parent.chartRowsModule.refreshRecords(this.parent.editedRecords),this.parent.isConnectorLineUpdate&&!Object(w["T"])(this.parent.connectorLineEditModule)&&(this.parent.updatedConnectorLineCollection=[],this.parent.connectorLineIds=[],this.parent.connectorLineEditModule.refreshEditedRecordConnectorLine(this.parent.editedRecords),this.updateScheduleDatesOnEditing(e))),!this.parent.editSettings.allowTaskbarEditing||this.parent.editSettings.allowTaskbarEditing&&!this.taskbarEditModule.dependencyCancel){if(t.requestType="save",t.data=e.data,t.modifiedRecords=this.parent.editedRecords,t.modifiedTaskData=Object(R["d"])(this.parent.editedRecords,null,null,this.parent),Object(w["T"])(e.action)||Object(w["ob"])("action",e.action,t),"TaskbarEditing"===e.action&&(t.taskBarEditAction=e.taskBarEditAction),this.endEditAction(e),this.parent.enableCriticalPath){var r=this.parent.criticalPathModule;r.showCriticalPath(!0),r.criticalConnectorLine(r.criticalPathCollection,r.detailPredecessorCollection,!0,r.predecessorCollectionTaskIds)}this.parent.trigger("actionComplete",t)}else this.taskbarEditModule.dependencyCancel=!1,this.resetEditProperties();"ResourceView"===this.parent.viewType&&this.isTreeGridRefresh&&(this.parent.treeGrid.parentData=[],this.parent.treeGrid.refresh(),this.isTreeGridRefresh=!1)},e.prototype.updateResoures=function(e,t,i){var n=this.parent.flatData,r=t?t.length:0,s=e?e.length:0;if(0!==r||0!==s){for(var a=0;a<r;a++){for(var o=[],l=parseInt(t[a][this.parent.resourceFields.id],10),d=0;d<e.length;d++)if(parseInt(e[d][this.parent.resourceFields.id],10)===l){o.push(d);break}if(0===o.length){var c=n[this.parent.getTaskIds().indexOf("R"+l)];c&&this.addNewRecord(i,c)}else e.splice(parseInt(o[0].toString(),10),1)}var h=e?e.length:0;for(a=0;a<h;a++)for(var p=i.ganttProperties.taskId,u=(l=e[a][this.parent.resourceFields.id],n[this.parent.getTaskIds().indexOf("R"+l)]),m=0;m<u.childRecords.length;m++)u.childRecords[m].ganttProperties.taskId===p&&this.removeChildRecord(u.childRecords[m]);if(r>0){var g=this.parent.getParentTask(i.parentItem);g&&g.ganttProperties.taskName===this.parent.localeObj.getConstant("unassignedTask")&&this.removeChildRecord(i)}0===r&&this.checkWithUnassignedTask(i)}},e.prototype.checkWithUnassignedTask=function(e){for(var t=null,i=0;i<this.parent.flatData.length;i++)this.parent.flatData[i].ganttProperties.taskName===this.parent.localeObj.getConstant("unassignedTask")&&(t=this.parent.flatData[i]);if(Object(w["T"])(t)){var n={};n[this.parent.taskFields.id]=0,n[this.parent.taskFields.name]=this.parent.localeObj.getConstant("unassignedTask");var r=this.parent.isOnEdit;this.parent.isOnEdit=!1;var s=this.parent.dataOperation.createRecord(n,0);this.parent.isOnEdit=r,this.addRecordAsBottom(s);var a=this.parent.flatData[this.parent.flatData.length-1];this.addNewRecord(e,a)}else this.addNewRecord(e,t)},e.prototype.addRecordAsBottom=function(e){var t=this.parent.flatData.length;this.parent.currentViewData.splice(t+1,0,e),this.parent.flatData.splice(t+1,0,e),this.parent.ids.splice(t+1,0,e.ganttProperties.rowUniqueID.toString());var i=0===e.level?"R"+e.ganttProperties.taskId:"T"+e.ganttProperties.taskId;this.parent.getTaskIds().splice(t+1,0,i),this.updateTreeGridUniqueID(e,"add")},e.prototype.addNewRecord=function(e,t){var i=null;i=Object(w["G"])({},{},e,!0),this.parent.setRecordValue("uniqueID",Object(j["T"])(this.parent.element.id+"_data_"),i),this.parent.setRecordValue("uniqueID",i.uniqueID,i.ganttProperties,!0);var n=i.uniqueID.replace(this.parent.element.id+"_data_","");this.parent.setRecordValue("rowUniqueID",n,i),this.parent.setRecordValue("rowUniqueID",n,i.ganttProperties,!0),this.parent.setRecordValue("level",1,i),this.parent.taskFields.parentID&&this.parent.setRecordValue("parentId",t.ganttProperties.taskId,i.ganttProperties,!0),this.parent.setRecordValue("parentItem",this.parent.dataOperation.getCloneParent(t),i);var r=i.parentItem?i.parentItem.uniqueID:null;this.parent.setRecordValue("parentUniqueID",r,i),e.ganttProperties.sharedTaskUniqueIds.push(n),i.ganttProperties.sharedTaskUniqueIds=e.ganttProperties.sharedTaskUniqueIds,this.addRecordAsChild(t,i)},e.prototype.removeChildRecord=function(e){var t=this.parent,i=[];i=this.parent.dataSource instanceof O["a"]&&this.parent.dataSource.dataSource.json.length>0?this.parent.dataSource.dataSource.json:this.parent.currentViewData;var n=this.parent.dataSource,r=e,s=this.parent.getParentTask(r.parentItem);if(r){if(r.parentItem){var a=s?s.childRecords:[],o=0;a&&a.length>0&&(1===a.length&&(this.parent.isOnDelete=!0,a[0].isDelete=!0,this.parent.dataOperation.updateParentItems(s),this.parent.isOnDelete=!1,a[0].isDelete=!1),o=a.indexOf(r),s.childRecords.splice(o,1),this.updateParentRecords.push(s))}if(r.ganttProperties.sharedTaskUniqueIds.length){var l=r.ganttProperties.sharedTaskUniqueIds.indexOf(r.ganttProperties.rowUniqueID);r.ganttProperties.sharedTaskUniqueIds.splice(l,1)}if(this.updateTreeGridUniqueID(r,"delete"),!this.parent.taskFields.parentID){var d=[];d.push(r.ganttProperties.rowUniqueID.toString()),this.parent.editModule.removeFromDataSource(d)}var c=this.parent.flatData.indexOf(r);if(t.taskFields.parentID){for(var h=void 0,p=this.parent.currentViewData,u=0;u<p.length;u++)p[u].ganttProperties.rowUniqueID===r.ganttProperties.rowUniqueID&&(h=u);-1!==h&&(n.length>0&&n.splice(h,1),i.splice(h,1),this.parent.flatData.splice(c,1),this.parent.ids.splice(c,1),this.parent.getTaskIds().splice(c,1))}var m=i.indexOf(r);if(!t.taskFields.parentID){var g=this.parent.editModule.getChildCount(r,0);i.splice(m,g+1),this.parent.flatData.splice(c,g+1),this.parent.ids.splice(c,g+1),this.parent.getTaskIds().splice(c,g+1)}r.parentItem&&s&&s.childRecords&&!s.childRecords.length&&(this.parent.setRecordValue("expanded",!1,s),this.parent.setRecordValue("hasChildRecords",!1,s))}},e.prototype.addRecordAsChild=function(e,t){var i,n=this.parent,r=this.parent.flatData.indexOf(e),s=this.parent.editModule.getChildCount(e,0);if(!Object(w["T"])(this.addRowIndex)&&this.addRowPosition&&e.childRecords&&"Child"!==this.addRowPosition){var a=e.childRecords[this.addRowIndex],o="Above"===this.addRowPosition||"Below"===this.addRowPosition?this.addRowPosition:"Child";i=a?this.addRowIndex+r+1:s+r+1,i="Above"===o?i:i+1}else i=Object(w["T"])(s)||0===s?r+1:s+r+1;this.parent.currentViewData.splice(i,0,t),this.parent.flatData.splice(i,0,t),this.parent.ids.splice(i,0,t.ganttProperties.rowUniqueID.toString()),this.updateTreeGridUniqueID(t,"add");var l=0===t.level?"R"+t.ganttProperties.taskId:"T"+t.ganttProperties.taskId;this.parent.getTaskIds().splice(i,0,l),e.hasChildRecords||(this.parent.setRecordValue("hasChildRecords",!0,e),this.parent.setRecordValue("expanded",!0,e),e.childRecords.length||(e.childRecords=[],!n.taskFields.parentID&&Object(w["T"])(e.taskData[this.parent.taskFields.child])&&(e.taskData[this.parent.taskFields.child]=[]))),e.childRecords.splice(e.childRecords.length,0,t),Object(w["T"])(t)||this.parent.taskFields.parentID||Object(w["T"])(e.taskData[this.parent.taskFields.child])||e.taskData[this.parent.taskFields.child].splice(e.childRecords.length,0,t.taskData),Object(w["T"])(t.parentItem)||this.updateParentRecords.push(e)},e.prototype.resetEditProperties=function(e){this.parent.currentEditedArgs={},this.resetValidateArgs(),this.parent.editedTaskBarItem=null,this.parent.isOnEdit=!1,this.validatedChildItems=[],this.parent.isConnectorLineUpdate=!1,this.parent.editedTaskBarItem=null,this.taskbarMoved=!1,this.predecessorUpdated=!1,Object(w["T"])(this.dialogModule)||!Object(w["T"])(e)&&(Object(w["T"])(e)||"beforeSave"!==e["requestType"]||e["cancel"])||(this.dialogModule.dialog&&!this.dialogModule.dialogObj.isDestroyed&&this.dialogModule.dialogObj.hide(),this.dialogModule.dialogClose()),this.parent.hideSpinner(),this.parent.initiateEditAction(!1)},e.prototype.endEditAction=function(e){this.resetEditProperties(),"TaskbarEditing"===e.action?this.parent.trigger("taskbarEdited",e):"CellEditing"===e.action?this.parent.trigger("endEdit",e):"DialogEditing"===e.action&&(this.dialogModule.dialog&&!this.dialogModule.dialogObj.isDestroyed&&this.dialogModule.dialogObj.hide(),this.dialogModule.dialogClose())},e.prototype.saveFailed=function(e){this.reUpdatePreviousRecords(),this.parent.hideSpinner()},e.prototype.renderDeleteConfirmDialog=function(){var e=new L["a"]({width:"320px",isModal:!0,visible:!1,content:this.parent.localeObj.getConstant("confirmDelete"),buttons:[{click:this.confirmDeleteOkButton.bind(this),buttonModel:{content:this.parent.localeObj.getConstant("okText"),isPrimary:!0}},{click:this.closeConfirmDialog.bind(this),buttonModel:{content:this.parent.localeObj.getConstant("cancel")}}],target:this.parent.element,animationSettings:{effect:"None"}});e.appendTo("#"+this.parent.element.id+"_deleteConfirmDialog"),this.confirmDialog=e},e.prototype.closeConfirmDialog=function(){this.confirmDialog.hide()},e.prototype.confirmDeleteOkButton=function(){this.deleteSelectedItems(),this.confirmDialog.hide();var e=this.parent.element.querySelector(".e-treegrid");e.focus()},e.prototype.startDeleteAction=function(){if(this.parent.editSettings.allowDeleting&&!this.parent.readOnly)if(this.parent.editSettings.showDeleteConfirmDialog)this.confirmDialog.show();else{this.deleteSelectedItems();var e=this.parent.element.querySelector(".e-treegrid");e.focus()}},e.prototype.deleteResourceRecords=function(e){for(var t=[],i=0;i<e.length;i++)if(e[i].parentItem)for(var n=e[i],r=n.ganttProperties.sharedTaskUniqueIds,s=0;s<r.length;s++)t.push(this.parent.flatData[this.parent.ids.indexOf(r[s].toString())]);this.deleteRow(t)},e.prototype.deleteSelectedItems=function(){if(this.isFromDeleteMethod)this.targetedRecords.length&&("ResourceView"===this.parent.viewType?this.deleteResourceRecords(this.targetedRecords):this.deleteRow(this.targetedRecords)),this.isFromDeleteMethod=!1;else{var e=[];"Cell"!==this.parent.selectionSettings.mode?e=this.parent.selectionModule.getSelectedRecords():"Cell"===this.parent.selectionSettings.mode&&(e=this.parent.selectionModule.getCellSelectedRecords()),"ResourceView"===this.parent.viewType?this.deleteResourceRecords(e):this.deleteRow(e)}},e.prototype.deleteRecord=function(e){this.isFromDeleteMethod=!0;var t=typeof e;switch(this.targetedRecords=[],t){case"number":case"string":var i=e.toString();"ResourceView"===this.parent.viewType?Object(w["T"])(i)||-1===this.parent.getTaskIds().indexOf("T"+i)||this.targetedRecords.push(this.parent.flatData[this.parent.getTaskIds().indexOf("T"+i)]):Object(w["T"])(i)||-1===this.parent.ids.indexOf(i)||this.targetedRecords.push(this.parent.getRecordByID(i));break;case"object":Array.isArray(e)?this.updateTargetedRecords(e):this.targetedRecords.push(e.valueOf());break;default:}this.startDeleteAction()},e.prototype.updateTargetedRecords=function(e){if(e.length){var t=typeof e[0];if("object"===t)this.targetedRecords=e;else for(var i=0;i<e.length;i++){var n=e[i].toString();"ResourceView"===this.parent.viewType?Object(w["T"])(n)||-1===this.parent.getTaskIds().indexOf("T"+n)||this.targetedRecords.push(this.parent.flatData[this.parent.getTaskIds().indexOf("T"+n)]):Object(w["T"])(n)||-1===this.parent.ids.indexOf(n)||this.targetedRecords.push(this.parent.getRecordByID(n))}}},e.prototype.deleteRow=function(e){var t=e&&e.length?e:this.parent.selectionModule.getSelectedRecords();if(this.parent.addDeleteRecord=!0,t.length){this.parent.isOnDelete=!0,t.forEach(function(e){e.isDelete=!0}),"ResourceView"!==this.parent.viewType||e.length||(t=[]);for(var i=0;i<t.length;i++){var n=t[i];if(-1===this.deletedTaskDetails.indexOf(n)){if(n.parentItem){var r=this.parent.getParentTask(n.parentItem).childRecords,s=1===r.length?r:r.filter(function(e){return!e.isDelete});s.length>0&&this.parent.dataOperation.updateParentItems(n.parentItem)}var a=n.ganttProperties.predecessor;a&&a.length&&this.removePredecessorOnDelete(n),this.deletedTaskDetails.push(n),n.hasChildRecords&&this.deleteChildRecords(n)}}this.parent.selectionModule&&this.parent.allowSelection&&this.parent.selectionModule.clearSelection();var o={};o.deletedRecordCollection=this.deletedTaskDetails,o.updatedRecordCollection=this.parent.editedRecords,o.cancel=!1,o.action="delete",this.initiateDeleteAction(o),this.parent.isOnDelete=!1}Object(w["T"])(this.parent.toolbarModule)||this.parent.toolbarModule.refreshToolbarItems()},e.prototype.removePredecessorOnDelete=function(e){for(var t=e.ganttProperties.predecessor,i=0;i<t.length;i++){var n=t[i],r="ResourceView"===this.parent.viewType?e.ganttProperties.taskId:e.ganttProperties.rowUniqueID;if(n.from.toString()===r.toString()){var s=this.parent.connectorLineModule.getRecordByID(n.to.toString());if(!Object(w["T"])(s)){for(var a=Object(w["G"])([],[],s.ganttProperties.predecessor,!0),o=void 0,l=0;l<a.length;l++){var d="ResourceView"===this.parent.viewType?s.ganttProperties.taskId:s.ganttProperties.rowUniqueID;if(a[l].to.toString()===d.toString()&&a[l].from.toString()===r.toString()){o=l;break}}a.splice(o,1),this.updatePredecessorValues(s,a)}}else if(n.to.toString()===r.toString()){var c=this.parent.connectorLineModule.getRecordByID(n.from.toString());if(!Object(w["T"])(c)){var h=Object(w["G"])([],[],c.ganttProperties.predecessor,!0);for(o=void 0,l=0;l<h.length;l++){var p="ResourceView"===this.parent.viewType?c.ganttProperties.taskId:c.ganttProperties.rowUniqueID;if(h[l].from.toString()===p.toString()&&h[l].to.toString()===r.toString()){o=l;break}}h.splice(o,1),this.updatePredecessorValues(c,h)}}}},e.prototype.updatePredecessorValues=function(e,t){this.parent.setRecordValue("predecessor",t,e.ganttProperties,!0);var i=this.parent.predecessorModule.getPredecessorStringValue(e);this.parent.setRecordValue("predecessorsName",i,e.ganttProperties,!0),this.parent.setRecordValue("taskData."+this.parent.taskFields.dependency,i,e),this.parent.setRecordValue(this.parent.taskFields.dependency,i,e)},e.prototype.updateTaskId=function(e,t){if(!this.parent.readOnly){var i="number"===typeof e?e.toString():e,n="number"===typeof t?t.toString():t,r=this.parent.ids;if(!Object(w["T"])(i)&&!Object(w["T"])(n)){var s=r.indexOf(i),a=r.indexOf(n);if(-1===s||a>-1)return;var o=this.parent.flatData[s];if(o.ganttProperties.taskId=o.ganttProperties.rowUniqueID=n,o.taskData[this.parent.taskFields.id]=n,o[this.parent.taskFields.id]=n,r[s]=n,o.hasChildRecords&&this.parent.taskFields.parentID)for(var l=o.childRecords,d=0;d<l.length;d++){var c=l[d];c[this.parent.taskFields.parentID]=t,this.parent.chartRowsModule.refreshRecords([c])}if(this.parent.taskFields.dependency&&!Object(w["T"])(o.ganttProperties.predecessor))for(var h=o.ganttProperties.predecessor,p=void 0,u=0;u<h.length;u++){var m=h[u];m.to===i?p=this.parent.flatData[r.indexOf(m.from)]:m.from===i&&(p=this.parent.flatData[r.indexOf(m.to)]),this.updatePredecessorOnUpdateId(p,i,n)}this.parent.treeGrid.parentData=[],this.parent.treeGrid.refresh()}}},e.prototype.updatePredecessorOnUpdateId=function(e,t,i){if(this.parent.flatData.indexOf(e)>-1)for(var n=e.ganttProperties.predecessor,r=0;r<n.length;r++){var s=n[r];s.to===t?s.to=i:s.from===t&&(s.from=i)}this.updatePredecessorValues(e,e.ganttProperties.predecessor)},e.prototype.deleteChildRecords=function(e){for(var t=e.childRecords,i=0;i<t.length;i++){var n=t[i];if(-1===this.deletedTaskDetails.indexOf(n)){var r=n.ganttProperties.predecessor;r&&r.length&&this.removePredecessorOnDelete(n),this.deletedTaskDetails.push(n),n.hasChildRecords&&this.deleteChildRecords(n)}}},e.prototype.removeFromDataSource=function(e){var t;t=this.parent.dataSource instanceof O["a"]?this.parent.dataSource.dataSource.json:this.parent.dataSource,this.removeData(t,e),this.isBreakLoop=!1},e.prototype.removeData=function(e,t){for(var i=0;i<e.length;i++){if(this.isBreakLoop)break;if(-1!==t.indexOf(Object(w["R"])(this.parent.taskFields.id,e[i]).toString())){if(e[i][this.parent.taskFields.child]){var n=e[i][this.parent.taskFields.child];this.removeData(n,t)}if(t.splice(t.indexOf(Object(w["R"])(this.parent.taskFields.id,e[i]).toString()),1),e.splice(i,1),0===t.length){this.isBreakLoop=!0;break}}else if(e[i][this.parent.taskFields.child]){n=e[i][this.parent.taskFields.child];this.removeData(n,t)}}},e.prototype.initiateDeleteAction=function(e){var t=this;this.parent.showSpinner();var i={requestType:"beforeDelete"};i.data=e.deletedRecordCollection,i.modifiedRecords=e.updatedRecordCollection,i.modifiedTaskData=Object(R["d"])(e.updatedRecordCollection,null,null,this.parent),this.parent.trigger("actionBegin",i,function(i){if(i.cancel){for(var n=t.deletedTaskDetails,r=0;r<n.length;r++)n[r].isDelete=!1;t.deletedTaskDetails=[],t.reUpdatePreviousRecords(),t.parent.initiateEditAction(!1),t.parent.hideSpinner()}else if(Object(R["g"])(t.parent.dataSource)){var s=t.parent.dataSource;t.parent.timezone&&Object(R["j"])(i.modifiedTaskData,t.parent);var a={deletedRecords:Object(R["d"])(i.data,null,null,t.parent),changedRecords:i.modifiedTaskData},o=s.adaptor,l=t.parent.query instanceof T["b"]?t.parent.query:new T["b"];if(o instanceof k["h"]&&o instanceof k["d"]&&!s.dataSource.batchUrl){for(var d="deletedRecords",c=null,h=0;h<a[d].length;h++)c=s.remove(t.parent.taskFields.id,a[d][h],null,l);c.then(function(){var i="changedRecords",n=s.update(t.parent.taskFields.id,a[i],null,l);n.then(function(){return t.deleteSuccess(e)}).catch(function(i){return t.dmFailure(i,e)})}).catch(function(i){return t.dmFailure(i,e)})}else{var p=s.saveChanges(a,t.parent.taskFields.id,null,l);p.then(function(){return t.deleteSuccess(e)}).catch(function(i){return t.dmFailure(i,e)})}}else t.deleteSuccess(e)})},e.prototype.deleteSuccess=function(e){var t=this.parent.flatData,i=this.parent.currentViewData,n=this.parent.getRecordFromFlatdata(e.deletedRecordCollection),r=[];n.length>0&&(this.parent.selectedRowIndex=n[n.length-1].index);for(var s=0;s<n.length;s++){var a=n[s],o=i.indexOf(a),l=t.indexOf(a),d=this.parent.treeGrid.parentData.indexOf(a),c=Object(w["R"])("dataOperation.dataArray",this.parent),h=c.indexOf(a.taskData),p=void 0;if(-1!==o&&i.splice(o,1),-1!==l&&t.splice(l,1),-1!==h&&c.splice(h,1),!Object(w["T"])(a)){if(r.push(a.ganttProperties.taskId.toString()),-1!==l&&(this.parent.ids.splice(l,1),"ResourceView"===this.parent.viewType&&this.parent.getTaskIds().splice(l,1)),0===a.level&&-1!==d&&this.parent.treeGrid.parentData.splice(d,1),a.parentItem){var u=this.parent.getParentTask(a.parentItem);if(u){var m=u.childRecords;p=m.indexOf(a),-1!==p&&m.splice(p,1),m.length||this.parent.setRecordValue("hasChildRecords",!1,u)}}this.updateTreeGridUniqueID(a,"delete")}}r.length>0&&this.removeFromDataSource(r);var g={};this.parent.updatedConnectorLineCollection=[],this.parent.connectorLineIds=[],this.parent.predecessorModule.createConnectorLinesCollection(this.parent.flatData),this.parent.treeGrid.parentData=[],this.parent.treeGrid.refresh(),this.parent.enableImmutableMode&&this.refreshRecordInImmutableMode(),g.requestType="delete",g.data=e.deletedRecordCollection,g.modifiedRecords=e.updatedRecordCollection,g.modifiedTaskData=Object(R["d"])(e.updatedRecordCollection,null,null,this.parent),Object(w["ob"])("action",e.action,g),this.parent.trigger("actionComplete",g),this.deletedTaskDetails=[],this.parent.initiateEditAction(!1),this.parent.hideSpinner()},e.prototype.getNewTaskId=function(){var e=S["a"].aggregates.max(this.parent.flatData,this.parent.taskFields.id);return Object(w["T"])(e)?1:parseInt(e.toString(),10)+1},e.prototype.prepareNewlyAddedData=function(e,t){var i,n=this.parent.taskFields,r=this.parent.ids;if(e[n.id]&&(-1!==r.indexOf(e[n.id].toString())?e[n.id]=null:e[n.id]=Object(w["T"])(e[n.id])?null:parseInt(e[n.id],10)),e[n.id]||(i=this.getNewTaskId(),e[n.id]=i),this.parent.allowUnscheduledTasks||e[n.startDate]||(e[n.startDate]=this.parent.projectStartDate),!this.parent.allowUnscheduledTasks&&n.duration&&Object(w["T"])(e[n.duration])&&(e[n.endDate]||(e[n.duration]="5")),n.progress&&(e[n.progress]=e[n.progress]?e[n.progress]>100?100:e[n.progress]:0),!this.parent.allowUnscheduledTasks&&!e[n.endDate]&&n.endDate&&!e[n.duration]){var s=this.parent.dataOperation.getDateFromFormat(this.parent.projectStartDate);s.setDate(s.getDate()+4),e[n.endDate]=this.parent.getFormatedDate(s,this.parent.getDateFormat())}},e.prototype.updateNewlyAddedDataBeforeAjax=function(e,t,i,n){var r=this.parent.dataOperation.createRecord(e,t);if(r.index=parseInt(r.ganttProperties.rowUniqueID.toString(),10)-1,!Object(w["T"])(n)){this.parent.setRecordValue("parentItem",this.parent.dataOperation.getCloneParent(n),r);var s=r.parentItem?r.parentItem.index:null;this.parent.setRecordValue("parentIndex",s,r);var a=r.parentItem?r.parentItem.uniqueID:null;this.parent.setRecordValue("parentUniqueID",a,r),Object(w["T"])(this.parent.taskFields.id)||Object(w["T"])(this.parent.taskFields.parentID)||!r.parentItem||("ProjectView"===this.parent.viewType&&this.parent.setRecordValue(this.parent.taskFields.parentID,r.parentItem.taskId,r.taskData,!0),this.parent.setRecordValue("parentId",r.parentItem.taskId,r.ganttProperties,!0),this.parent.setRecordValue(this.parent.taskFields.parentID,r.parentItem.taskId,r,!0))}return this.parent.isOnEdit=!0,this.backUpAndPushNewlyAddedRecord(r,i,n),this.parent.taskFields.dependency&&r.ganttProperties.predecessorsName&&(this.parent.predecessorModule.ensurePredecessorCollectionHelper(r,r.ganttProperties),this.parent.predecessorModule.updatePredecessorHelper(r),this.parent.predecessorModule.validatePredecessorDates(r)),r.parentItem&&this.parent.getParentTask(r.parentItem).ganttProperties.isAutoSchedule&&this.parent.dataOperation.updateParentItems(r.parentItem),this.parent.isOnEdit=!1,r},e.prototype.getChildCount=function(e,t){var i;if(!e.hasChildRecords)return 0;for(var n=0;n<e.childRecords.length;n++)i=e.childRecords[n],t++,i.hasChildRecords&&(t=this.getChildCount(i,t));return t},e.prototype.getVisibleChildRecordCount=function(e,t,i){var n,r;if(e.hasChildRecords){n=e.childRecords,r=n.length;for(var s=0;s<r;s++)-1!==i.indexOf(n[s])&&t++,n[s].hasChildRecords&&(t=this.getVisibleChildRecordCount(n[s],t,i))}else-1!==i.indexOf(e)&&t++;return t},e.prototype.updatePredecessorOnIndentOutdent=function(e){for(var t,i,n=e.ganttProperties.predecessor.length,r=e.ganttProperties,s=r.predecessor,a=[],o=0;o<n;o++)if(s[o].to===r.rowUniqueID.toString()){t=this.parent.getRecordByID(s[o].from),i=Object(R["b"])(s[o],"from",t.ganttProperties.predecessor,"to");var l=Object(w["G"])([],t.ganttProperties.predecessor,[],!0);l.splice(i,1),this.parent.setRecordValue("predecessor",l,t.ganttProperties,!0)}else if(s[o].from===r.rowUniqueID.toString()){t=this.parent.getRecordByID(s[o].to);var d=t.ganttProperties.predecessorsName.toString().split(","),c=s[o].from+s[o].type,h=d.indexOf(c);d.splice(h,1),this.parent.setRecordValue("predecessorsName",d.join(","),t.ganttProperties,!0),this.parent.setRecordValue(this.parent.taskFields.dependency,d.join(","),t),i=Object(R["b"])(s[o],"from",t.ganttProperties.predecessor,"to");var p=Object(w["G"])([],t.ganttProperties.predecessor,[],!0);p.splice(i,1),this.parent.setRecordValue("predecessor",p,t.ganttProperties,!0),this.parent.predecessorModule.validatePredecessorDates(t)}this.parent.setRecordValue("predecessor",a,e.ganttProperties,!0),this.parent.setRecordValue("predecessorsName","",e.ganttProperties,!0)},e.prototype.predecessorToString=function(e,t){var i=[],n=0,r=e.length;for(n;n<r;n++)if(t.ganttProperties.rowUniqueID.toString()!==e[n].from){var s=e[n].from+e[n].type;e[n].offset=isNaN(e[n].offset)?0:e[n].offset,0!==e[n].offset&&(e[n].offset<0?s+=e[n].offset.toString()+"d":e[n].offset>0&&(s+="+"+e[n].offset.toString()+"d")),i.push(s)}return i.join(",")},e.prototype.backUpAndPushNewlyAddedRecord=function(e,t,i){var n,r,s,a,o=this.parent.flatData,l=this.parent.currentViewData,d=this.parent.ids;switch(t){case"Top":o.splice(0,0,e),l.splice(0,0,e),d.splice(0,0,e.ganttProperties.rowUniqueID.toString());break;case"Bottom":if(o.push(e),l.push(e),d.push(e.ganttProperties.rowUniqueID.toString()),"ResourceView"===this.parent.viewType){var c=0===e.level?"R"+e.ganttProperties.taskId:"T"+e.ganttProperties.taskId;this.parent.getTaskIds().push(c)}break;case"Above":r=o.indexOf(this.addRowSelectedItem),s=l.indexOf(this.addRowSelectedItem),this.recordCollectionUpdate(a,r,s,e,i,t);break;case"Below":if(n=o.indexOf(this.addRowSelectedItem),this.addRowSelectedItem.hasChildRecords){var h=this.getChildCount(this.addRowSelectedItem,0);r=n+h+1,s=l.indexOf(this.addRowSelectedItem)+this.getVisibleChildRecordCount(this.addRowSelectedItem,0,l)+1}else r=n+1,s=l.indexOf(this.addRowSelectedItem)+1;this.recordCollectionUpdate(a+1,r,s,e,i,t);break;case"Child":if(n=o.indexOf(this.addRowSelectedItem),this.addRowSelectedItem.hasChildRecords){h=this.getChildCount(this.addRowSelectedItem,0);r=n+h+1,this.addRowSelectedItem.expanded||this.parent.enableMultiTaskbar||this.parent.expandByID(Number(this.addRowSelectedItem.ganttProperties.rowUniqueID)),s=l.indexOf(this.addRowSelectedItem)+this.getVisibleChildRecordCount(this.addRowSelectedItem,0,l)+1}else this.parent.setRecordValue("hasChildRecords",!0,this.addRowSelectedItem),this.parent.setRecordValue("isMilestone",!1,this.addRowSelectedItem.ganttProperties,!0),this.parent.setRecordValue("expanded",!0,this.addRowSelectedItem),this.parent.setRecordValue("childRecords",[],this.addRowSelectedItem),r=n+1,s=l.indexOf(this.addRowSelectedItem)+1,this.addRowSelectedItem.ganttProperties.predecessor&&this.updatePredecessorOnIndentOutdent(this.addRowSelectedItem),Object(w["T"])(this.addRowSelectedItem.ganttProperties.segments)||(this.addRowSelectedItem.ganttProperties.segments=null);this.recordCollectionUpdate(a+1,r,s,e,i,t);break}this.newlyAddedRecordBackup=e},e.prototype.recordCollectionUpdate=function(e,t,i,n,r,s){var a=this.parent.flatData,o=this.parent.currentViewData,l=this.parent.ids;if(a.splice(t,0,n),o.splice(i,0,n),l.splice(t,0,n.ganttProperties.rowUniqueID.toString()),"ResourceView"===this.parent.viewType){var d=0===n.level?"R"+n.ganttProperties.taskId:"T"+n.ganttProperties.taskId;this.parent.getTaskIds().splice(t,0,d)}if(!Object(w["T"])(r)&&(e="Above"==s?r.childRecords.indexOf(this.addRowSelectedItem):"Below"==s?r.childRecords.indexOf(this.addRowSelectedItem)+1:r.childRecords.length,r.childRecords.splice(e,0,n),this.parent.dataSource instanceof O["a"]&&Object(w["T"])(r.taskData[this.parent.taskFields.parentID])||!Object(w["T"])(this.parent.dataSource))){var c=this.parent.taskFields.child;r.taskData[c]&&r.taskData[c].length>0?"Above"===s||"Below"===s?r.taskData[c].splice(e,0,n.taskData):r.taskData[c].push(n.taskData):(r.taskData[c]=[],r.taskData[c].push(n.taskData))}},e.prototype.constructTaskAddedEventArgs=function(e,t,i){var n={};if(n.action=n.requestType=i,e.length>1){n.data=[],n.newTaskData=[],n.recordIndex=[];for(var r=0;r<e.length;r++)n.data[r]=e[r],n.newTaskData[r]=Object(R["d"])([e[r]],n.data[r],n,this.parent),n.recordIndex[r]=e[r].index}else if(1===e.length)for(r=0;r<e.length;r++)n.data=e[r],n.newTaskData=Object(R["d"])([e[r]],n.data,n,this.parent),n.recordIndex=e[r].index;return n.modifiedRecords=t,n.modifiedTaskData=Object(R["d"])(t,null,null,this.parent),n},e.prototype.addSuccess=function(e){this.parent.treeGrid.parentData=[],this.parent.addDeleteRecord=!0,this.parent.selectedRowIndex=0,this.parent.treeGrid.refresh(),this.parent.enableImmutableMode&&(this.parent.modifiedRecords=e.modifiedRecords,this.parent.modifiedRecords.push(e.data),this.refreshRecordInImmutableMode())},e.prototype.refreshRecordInImmutableMode=function(e,t){if(!t&&!Object(w["T"])(e))for(var i=e[0].index+1;i<this.parent.currentViewData.length;i++){if(!(e[0].level<this.parent.currentViewData[i].level))break;this.parent.modifiedRecords.push(this.parent.currentViewData[i])}var n,r=function(e){var t=s.parent.modifiedRecords[e],i=s.parent.allowRowDragAndDrop?1:0,r=s.parent.taskFields.id;n=s.parent.currentViewData.findIndex(function(e){return e[r]==t[r]}),s.parent.treeGrid.getRows()[n]&&(s.parent.treeGrid.renderModule.cellRender({data:t,cell:s.parent.treeGrid.getRows()[n].cells[s.parent.treeColumnIndex+i],column:s.parent.treeGrid.grid.getColumns()[s.parent.treeColumnIndex],requestType:"rowDragAndDrop"}),s.parent.treeGrid.renderModule.RowModifier({data:t,row:s.parent.treeGrid.getRows()[n],rowHeight:s.parent.rowHeight}))},s=this;for(i=0;i<this.parent.modifiedRecords.length;i++)r(i)},e.prototype.updateRealDataSource=function(e,t){var i=this.parent.taskFields,n=Object(R["f"])(this.parent)?Object(w["R"])("result",this.parent.dataSource):this.parent.dataSource;this.parent.dataSource instanceof O["a"]&&(n=this.parent.dataSource.dataSource.json);for(var r=0;r<e.length;r++)(Object(w["T"])(t)||Object(w["T"])(this.addRowSelectedItem))&&(t="Bottom"===t?"Bottom":"Top"),"Top"===t?n.splice(0,0,e[r].taskData):"Bottom"===t?n.push(e[r].taskData):Object(w["T"])(i.id)||Object(w["T"])(i.parentID)?this.addDataInRealDataSource(n,e[r].taskData,t):n.push(e[r].taskData),this.isBreakLoop=!1},e.prototype.addDataInRealDataSource=function(e,t,i){for(var n=0;n<e.length;n++){var r=this.parent.taskFields.child;if(this.isBreakLoop)break;if(Object(w["R"])(this.parent.taskFields.id,e[n]).toString()===this.addRowSelectedItem.ganttProperties.rowUniqueID.toString()){"Above"===i?e.splice(n,0,t):"Below"===i?e.splice(n+1,0,t):"Child"===i&&(e[n][r]&&e[n][r].length>0?e[n][r].push(t):(e[n][r]=[],e[n][r].push(t))),this.isBreakLoop=!0;break}if(e[n][r]){var s=e[n][r];this.addDataInRealDataSource(s,t,i)}}},e.prototype.addRecord=function(e,t,i){var n=this;if(this.parent.editModule&&this.parent.editSettings.allowAdding){this.parent.isDynamicData=!0;var r=[];if(Object(w["T"])(e))this.validateTaskPosition(e,t,i,r);else if(e instanceof Array)for(var s=0;s<e.length;s++)this.validateTaskPosition(e[s],t,i,r);else{if("object"!=typeof e)return;this.validateTaskPosition(e,t,i,r)}var a={};a=this.constructTaskAddedEventArgs(r,this.parent.editedRecords,"beforeAdd"),this.parent.showSpinner(),this.parent.trigger("actionBegin",a,function(e){if(e.cancel)e=e,n.removeAddedRecord(),n.reUpdatePreviousRecords(),n._resetProperties();else if(Object(R["g"])(n.parent.dataSource)){var i=n.parent.dataSource,s={addedRecords:[e.newTaskData],changedRecords:e.modifiedTaskData},a=e.data.ganttProperties.taskId.toString(),o=n.parent.query instanceof T["b"]?n.parent.query:new T["b"],l=i.adaptor;if(l instanceof k["h"]&&l instanceof k["d"]&&!i.dataSource.batchUrl){var d="addedRecords",c=i.insert(s[d],null,o);c.then(function(t){var l,d="changedRecords";l=Object(w["T"])(t[0])?s["addedRecords"][0]:t[0];var c=i.update(n.parent.taskFields.id,s[d],null,o);c.then(function(){if(n.parent.taskFields.id&&!Object(w["T"])(l[n.parent.taskFields.id])&&l[n.parent.taskFields.id].toString()!==a){n.parent.setRecordValue("taskId",l[n.parent.taskFields.id],e.data.ganttProperties,!0),n.parent.setRecordValue("taskData."+n.parent.taskFields.id,l[n.parent.taskFields.id],e.data),n.parent.setRecordValue(n.parent.taskFields.id,l[n.parent.taskFields.id],e.data),n.parent.setRecordValue("rowUniqueID",l[n.parent.taskFields.id].toString(),e.data.ganttProperties,!0);var t=n.parent.ids.indexOf(a);-1!==t&&(n.parent.ids[t]=l[n.parent.taskFields.id].toString())}n.updateNewRecord(r,e)}).catch(function(t){n.removeAddedRecord(),n.dmFailure(t,e),n._resetProperties()})}).catch(function(t){n.removeAddedRecord(),n.dmFailure(t,e),n._resetProperties()})}else{var h=i.saveChanges(s,n.parent.taskFields.id,null,o);h.then(function(t){if(n.parent.taskFields.id&&!Object(w["T"])(t.addedRecords[0][n.parent.taskFields.id])&&t.addedRecords[0][n.parent.taskFields.id].toString()!==a){n.parent.setRecordValue("taskId",t.addedRecords[0][n.parent.taskFields.id],e.data.ganttProperties,!0),n.parent.setRecordValue("taskData."+n.parent.taskFields.id,t.addedRecords[0][n.parent.taskFields.id],e.data),n.parent.setRecordValue(n.parent.taskFields.id,t.addedRecords[0][n.parent.taskFields.id],e.data),n.parent.setRecordValue("rowUniqueID",t.addedRecords[0][n.parent.taskFields.id].toString(),e.data.ganttProperties,!0);var i=n.parent.ids.indexOf(a);-1!==i&&(n.parent.ids[i]=t.addedRecords[0][n.parent.taskFields.id].toString())}n.updateNewRecord(r,e)}).catch(function(t){n.removeAddedRecord(),n.dmFailure(t,e),n._resetProperties()})}}else{if("ProjectView"===n.parent.viewType){if("Top"===t||"Bottom"===t||("Above"===t||"Below"===t||"Child"===t)&&!e.data.parentItem)if(e.data instanceof Array)n.updateRealDataSource(e.data,t);else{var p=[];p.push(e.data),n.updateRealDataSource(p,t)}}else{var u=Object(R["f"])(n.parent)?Object(w["R"])("result",n.parent.dataSource):n.parent.dataSource;u.push(e.data.taskData)}0===r.level&&n.parent.treeGrid.parentData.splice(0,0,r),n.updateTreeGridUniqueID(r,"add"),n.refreshNewlyAddedRecord(e,r),n._resetProperties()}})}},e.prototype.createNewRecord=function(){for(var e={},t=this.parent.ganttColumns,i=this.parent.taskFields,n=this.parent.editModule.getNewTaskId(),r=0;r<t.length;r++){var s=t[r].field;s===i.id?e[s]=n:t[r].field===i.startDate?(Object(w["T"])(e[i.endDate])?e[s]=this.parent.editModule.dialogModule.getMinimumStartDate():e[s]=new Date(e[i.endDate]),this.parent.timezone&&(e[s]=this.parent.dateValidationModule.remove(e[s],this.parent.timezone))):t[r].field===i.endDate?(Object(w["T"])(e[i.startDate])?e[s]=this.parent.editModule.dialogModule.getMinimumStartDate():e[s]=new Date(e[i.startDate]),this.parent.timezone&&(e[s]=this.parent.dateValidationModule.remove(e[s],this.parent.timezone))):t[r].field===i.duration?e[s]=1:t[r].field===i.name?e[s]=this.parent.editModule.dialogModule["localeObj"].getConstant("addDialogTitle")+" "+n:t[r].field===i.progress?e[s]=0:t[r].field===i.work?e[s]=0:"taskType"===t[r].field?e[s]=this.parent.taskType:e[this.parent.ganttColumns[r].field]=""}return e},e.prototype.validateTaskPosition=function(e,t,i,n){var r=Object(w["T"])(i)||isNaN(parseInt(i.toString(),10))?this.parent.selectionModule?"Row"!==this.parent.selectionSettings.mode&&"Both"!==this.parent.selectionSettings.mode||1!==this.parent.selectionModule.selectedRowIndexes.length?"Cell"===this.parent.selectionSettings.mode&&1===this.parent.selectionModule.getSelectedRowCellIndexes().length?this.parent.selectionModule.getSelectedRowCellIndexes()[0].rowIndex:null:this.parent.selectionModule.selectedRowIndexes[0]:null:i;this.addRowSelectedItem=Object(w["T"])(r)?null:this.parent.updatedRecords[r],t=Object(w["T"])(t)?this.parent.editSettings.newRowPosition:t,e=Object(w["T"])(e)?this.createNewRecord():e,((Object(w["T"])(r)||r<0||Object(w["T"])(this.addRowSelectedItem))&&("Above"===t||"Below"===t||"Child"===t)||!t||"Above"!==t&&"Below"!==t&&"Child"!==t&&"Top"!==t&&"Bottom"!==t)&&(t="Top");var s,a=0;switch(t){case"Top":case"Bottom":a="ResourceView"===this.parent.viewType?1:0;break;case"Above":case"Below":a=this.addRowSelectedItem.level,s=this.parent.getParentTask(this.addRowSelectedItem.parentItem);break;case"Child":a=this.addRowSelectedItem.level+1,s=this.addRowSelectedItem;break}this.prepareNewlyAddedData(e,t);var o=this.updateNewlyAddedDataBeforeAjax(e,a,t,s);n.push(o)},e.prototype.updateNewRecord=function(e,t){if(0===e.level){this.parent.treeGrid.parentData.splice(0,0,e);var i=Object(w["R"])("dataOperation.dataArray",this.parent);i.splice(0,0,e.taskData)}this.updateTreeGridUniqueID(e,"add"),this.refreshNewlyAddedRecord(t,e),this._resetProperties()},e.prototype._resetProperties=function(){this.parent.isOnEdit=!1,this.parent.hideSpinner(),this.addRowSelectedItem=null,this.newlyAddedRecordBackup=null,this.isBreakLoop=!1,this.parent.element.tabIndex=0,this.parent.initiateEditAction(!1)},e.prototype.updateTreeGridUniqueID=function(e,t){"add"===t?Object(w["ob"])("uniqueIDCollection."+e.uniqueID,e,this.parent.treeGrid):"delete"===t&&Object(w["E"])(Object(w["R"])("uniqueIDCollection",this.parent.treeGrid),e.uniqueID)},e.prototype.refreshNewlyAddedRecord=function(e,t){if(this.parent.selectionModule&&this.parent.allowSelection&&("Row"===this.parent.selectionSettings.mode||"Both"===this.parent.selectionSettings.mode)&&(this.parent.staticSelectedRowIndex=this.parent.currentViewData.indexOf(e.data)),this.parent.timelineSettings.updateTimescaleView){var i=[];e.modifiedRecords.length>0?(i=e.data.length>0?e.data:[e.data],i.push.apply(i,e.modifiedRecords)):i=e.data.length>0?e.data:[e.data],this.parent.timelineModule.updateTimeLineOnEditing([i],e.action)}if(this.addSuccess(e),e=this.constructTaskAddedEventArgs(t,e.modifiedRecords,"add"),this.dialogModule.isAddNewResource&&!this.parent.isEdit&&this.parent.taskFields.work&&this.parent.dataOperation.updateWorkWithDuration(t[0]),this.parent.trigger("actionComplete",e),this.dialogModule.dialog&&!this.dialogModule.dialogObj.isDestroyed&&this.dialogModule.dialogObj.hide(),this.dialogModule.dialogClose(),"ResourceView"===this.parent.viewType)if(t.length>1)for(var n=0;n<t.length;n++){if(e.data[n].ganttProperties.sharedTaskUniqueIds.push(e.data[n].ganttProperties.rowUniqueID),e.data[n].ganttProperties.resourceInfo){var r=Object(w["G"])([],[],e.data[n].ganttProperties.resourceInfo,!0);r.splice(0,1),this.updateResoures([],r,e.data[n])}else this.removeChildRecord(e.data[n]),this.parent.editModule.checkWithUnassignedTask(e.data[n]);for(var s=0;s<this.updateParentRecords.length;s++)this.parent.dataOperation.updateParentItems(this.updateParentRecords[s]);this.updateParentRecords=[]}else{if(e.data.ganttProperties.sharedTaskUniqueIds.push(e.data.ganttProperties.rowUniqueID),e.data.ganttProperties.resourceInfo&&e.data.ganttProperties.resourceInfo.length){if(e.data.ganttProperties.resourceInfo.length>1){r=Object(w["G"])([],[],e.data.ganttProperties.resourceInfo,!0);r.splice(0,1),this.updateResoures([],r,e.data)}}else this.removeChildRecord(e.data),this.parent.editModule.checkWithUnassignedTask(e.data);for(s=0;s<this.updateParentRecords.length;s++)this.parent.dataOperation.updateParentItems(this.updateParentRecords[s]);this.updateParentRecords=[]}},e.prototype.removeAddedRecord=function(){var e=this.parent.flatData,t=this.parent.currentViewData,i=this.parent.ids,n=e.indexOf(this.newlyAddedRecordBackup),r=t.indexOf(this.newlyAddedRecordBackup),s=i.indexOf(this.newlyAddedRecordBackup.ganttProperties.rowUniqueID.toString());if(Object(w["E"])(this.parent.previousRecords,e[n].uniqueID),this.newlyAddedRecordBackup.parentItem){var a=this.parent.getParentTask(this.newlyAddedRecordBackup.parentItem),o=a.childRecords.indexOf(this.newlyAddedRecordBackup);a.childRecords.splice(o,1)}e.splice(n,1),t.splice(r,1),i.splice(s,1)},e.prototype.getPrevRecordIndex=function(){var e=this.parent.updatedRecords[this.parent.selectionModule.getSelectedRowIndexes()[0]-1],t=this.parent.selectionModule.getSelectedRecords()[0],i=this.parent.getRootParent(e,t.level),n=this.parent.updatedRecords.indexOf(i);return n},e.prototype.indent=function(){var e,t=this.parent.selectedRowIndex,i=!!this.parent.selectionModule&&(1===this.parent.selectionModule.selectedRowIndexes.length||1===this.parent.selectionModule.getSelectedRowCellIndexes().length),n=this.parent.updatedRecords[this.parent.selectionModule.getSelectedRowIndexes()[0]-1],r=this.parent.selectionModule.getSelectedRecords()[0];this.parent.editSettings.allowEditing&&0!==t&&-1!==t&&i&&"ResourceView"!==this.parent.viewType&&this.parent.updatedRecords[t].level-n.level!==1&&(e=n.level-r.level===0?this.parent.selectionModule.getSelectedRowIndexes()[0]-1:this.getPrevRecordIndex(),this.indentOutdentRow([this.parent.selectionModule.getSelectedRowIndexes()[0]],e,"child"))},e.prototype.outdent=function(){var e,t=this.parent.selectionModule.getSelectedRowIndexes()[0],i=!!this.parent.selectionModule&&(1===this.parent.selectionModule.selectedRowIndexes.length||1===this.parent.selectionModule.getSelectedRowCellIndexes().length);if(this.parent.editSettings.allowEditing&&-1!==t&&0!==t&&i&&"ResourceView"!==this.parent.viewType&&0!==this.parent.updatedRecords[t].level){var n=this.parent.getTaskByUniqueID(this.parent.selectionModule.getSelectedRecords()[0].parentItem.uniqueID);e=this.parent.updatedRecords.indexOf(n),this.indentOutdentRow([t],e,"below")}},e.prototype.indentOutdentRow=function(e,t,i){var n=this;e[0],"above"===i&&(this.dropPosition="topSegment"),"below"===i&&(this.dropPosition="bottomSegment"),"child"===i&&(this.dropPosition="middleSegment");for(var r=void 0,s=[],a=0;a<e.length;a++)s[a]=this.parent.updatedRecords[e[a]];var o=!0,l={data:s,dropIndex:t,dropPosition:this.dropPosition};"middleSegment"===this.dropPosition?r="indenting":"bottomSegment"===this.dropPosition&&(r="outdenting");var d={action:r,data:s[0],cancel:!1};this.parent.trigger("actionBegin",d,function(e){e.cancel||n.reArrangeRows(l,o)})},e.prototype.reArrangeRows=function(e,t){if(this.dropPosition=e.dropPosition,"Invalid"!==e.dropPosition&&this.parent.editModule){var i=this.parent,n=void 0;this.droppedRecord=i.updatedRecords[e.dropIndex];var r=[],s=this.droppedRecord;e.data[0]?r=e.data:r.push(e.data);for(var a=0,o=r.length,l=0;l<o;l++){if(this.parent.isOnEdit=!0,n=r[l],this.draggedRecord=n,"Invalid"!==this.dropPosition){t&&this.deleteDragRow();var d=this.treeGridData.indexOf(s);if("bottomSegment"===this.dropPosition){if(s.hasChildRecords){a=this.parent.editModule.getChildCount(s,0),this.parent.taskFields.parentID&&this.ganttData.length>0&&this.ganttData.splice(d+a+1,0,this.draggedRecord.taskData),this.treeGridData.splice(d+a+1,0,this.draggedRecord),this.parent.ids.splice(d+a+1,0,this.draggedRecord.ganttProperties.rowUniqueID.toString());var c=this.parent.ids.indexOf(this.draggedRecord[this.parent.taskFields.id].toString());c!==d+a+1&&(this.parent.ids.splice(c,1),this.parent.ids.splice(d+a+1,0,this.draggedRecord[this.parent.taskFields.id].toString()))}else this.parent.taskFields.parentID&&this.ganttData.length>0&&this.ganttData.splice(d+1,0,this.draggedRecord.taskData),this.treeGridData.splice(d+1,0,this.draggedRecord),this.parent.ids.splice(d+1,0,this.draggedRecord.ganttProperties.rowUniqueID.toString());if(this.parent.setRecordValue("parentItem",this.treeGridData[d].parentItem,n),this.parent.setRecordValue("parentUniqueID",this.treeGridData[d].parentUniqueID,n),this.parent.setRecordValue("level",this.treeGridData[d].level,n),n.hasChildRecords){var h=1;this.updateChildRecordLevel(n,h),this.updateChildRecord(n,d+a+1)}if(s.parentItem){var p=this.parent.getParentTask(s.parentItem).childRecords,u=p,m=u.indexOf(s)+1;u.splice(m,0,n)}}"middleSegment"===this.dropPosition&&this.dropMiddle(d),Object(w["T"])(n.parentItem&&-1!==this.updateParentRecords.indexOf(n.parentItem))||this.updateParentRecords.push(n.parentItem)}if(Object(w["T"])(n.parentItem)){var g=this.parent.treeGrid.parentData,f=g.indexOf(this.droppedRecord);"bottomSegment"===this.dropPosition&&g.splice(f+1,0,n)}this.refreshDataSource()}"middleSegment"===this.dropPosition&&(s.ganttProperties.predecessor&&(this.parent.editModule.removePredecessorOnDelete(s),s.ganttProperties.predecessor=null,s.ganttProperties.predecessorsName=null,s[this.parent.taskFields.dependency]=null,s.taskData[this.parent.taskFields.dependency]=null),s.ganttProperties.isMilestone&&(this.parent.setRecordValue("isMilestone",!1,s.ganttProperties,!0),Object(w["T"])(s.taskData[this.parent.taskFields.milestone])||!0===s.taskData[this.parent.taskFields.milestone]&&(s.taskData[this.parent.taskFields.milestone]=!1)));for(var b=0;b<this.updateParentRecords.length;b++)this.parent.dataOperation.updateParentItems(this.updateParentRecords[b]);this.updateParentRecords=[],this.parent.isOnEdit=!1}this.refreshRecord(e)},e.prototype.refreshRecord=function(e,t){var i=this;if(Object(R["g"])(this.parent.dataSource)){var n=this.parent.dataSource,r={changedRecords:Object(R["d"])(this.parent.editedRecords,null,null,this.parent)},s=this.parent.query instanceof T["b"]?this.parent.query:new T["b"],a=null,o=n.adaptor;if(o instanceof k["h"]&&o instanceof k["d"]&&!n.dataSource.batchUrl){var l="changedRecords";a=n.update(this.parent.taskFields.id,r[l],null,s)}else a=n.saveChanges(r,this.parent.taskFields.id,null,s);a.then(function(n){return i.indentSuccess(n,e,t)}).catch(function(e){return i.indentFailure(e)})}else this.indentOutdentSuccess(e,t)},e.prototype.indentSuccess=function(e,t,i){this.indentOutdentSuccess(t,i)},e.prototype.indentFailure=function(e){this.parent.trigger("actionFailure",{error:e})},e.prototype.indentOutdentSuccess=function(e,t){if(this.parent.treeGrid.parentData=[],this.parent.treeGrid.refresh(),this.parent.enableImmutableMode&&this.refreshRecordInImmutableMode(e.data,t),t?e.requestType="rowDropped":"middleSegment"===this.dropPosition?e.requestType="indented":"bottomSegment"===this.dropPosition&&(e.requestType="outdented"),e.modifiedRecords=this.parent.editedRecords,this.parent.timezone)for(var i=0;i<e.modifiedRecords.length;i++)Object(R["j"])(e.modifiedRecords[i],this.parent);this.parent.trigger("actionComplete",e),this.parent.editedRecords=[]},e.prototype.refreshDataSource=function(){var e,t,i=this.draggedRecord,n=this.droppedRecord,r=this.parent;if(e=this.parent.dataSource instanceof O["a"]?Object(w["R"])("dataOperation.dataArray",this.parent):r.dataSource,e.length>0&&!Object(w["T"])(n)&&!n.parentItem){for(var s=0;s<Object.keys(e).length;s++)e[s][this.parent.taskFields.child]===n.taskData[this.parent.taskFields.child]&&(t=s);"topSegment"===this.dropPosition?this.parent.taskFields.parentID||e.splice(t,0,i.taskData):"bottomSegment"===this.dropPosition&&(this.parent.taskFields.parentID||e.splice(t+1,0,i.taskData))}else if(!this.parent.taskFields.parentID&&!Object(w["T"])(n)&&n.parentItem&&("topSegment"===this.dropPosition||"bottomSegment"===this.dropPosition)){var a="topSegment"===this.dropPosition?"Above":"Below";this.parent.editModule.addRowSelectedItem=n,this.parent.editModule.updateRealDataSource(i,a),delete this.parent.editModule.addRowSelectedItem}this.parent.taskFields.parentID&&(i.parentItem?"topSegment"===this.dropPosition||"bottomSegment"===this.dropPosition?(i[this.parent.taskFields.parentID]=n[this.parent.taskFields.parentID],i.taskData[this.parent.taskFields.parentID]=n[this.parent.taskFields.parentID],i.ganttProperties["parentId"]=n[this.parent.taskFields.parentID]):(i[this.parent.taskFields.parentID]=n[this.parent.taskFields.id],i.taskData[this.parent.taskFields.parentID]=n[this.parent.taskFields.id],i.ganttProperties["parentId"]=n[this.parent.taskFields.id]):(i[this.parent.taskFields.parentID]=null,i.taskData[this.parent.taskFields.parentID]=null,i.ganttProperties["parentId"]=null))},e.prototype.deleteDragRow=function(){this.parent.dataSource instanceof O["a"]?this.ganttData=Object(w["R"])("dataOperation.dataArray",this.parent):this.ganttData=Object(R["f"])(this.parent)?Object(w["R"])("result",this.parent.dataSource):this.parent.dataSource,this.treeGridData=Object(R["f"])(this.parent)?Object(w["R"])("result",this.parent.treeGrid.dataSource):this.parent.treeGrid.dataSource;var e=this.parent.getTaskByUniqueID(this.draggedRecord.uniqueID);this.removeRecords(e)},e.prototype.updateIndentedChildRecords=function(e){for(var t={uniqueID:e.uniqueID,expanded:e.expanded,level:e.level,index:e.index,taskId:e.ganttProperties.rowUniqueID},i=0;i<e.childRecords.length;i++)this.parent.setRecordValue("parentItem",t,e.childRecords[i]),this.parent.setRecordValue("parentUniqueID",e.uniqueID,e.childRecords[i]);if(e.hasChildRecords){e=e.childRecords;for(var n=0;n<e["length"];n++)this.updateIndentedChildRecords(e[n])}},e.prototype.dropMiddle=function(e){var t=this.parent,i=this.parent.editModule.getChildCount(this.droppedRecord,0),n=Object(w["T"])(i)||0===i?e+1:i+e+1;if("middleSegment"===this.dropPosition){if(t.taskFields.parentID&&this.ganttData.length>0&&this.ganttData.splice(n,0,this.draggedRecord.taskData),this.treeGridData.splice(n,0,this.draggedRecord),this.parent.ids.splice(n,0,this.draggedRecord[this.parent.taskFields.id].toString()),this.recordLevel(),this.draggedRecord.hasChildRecords&&(this.updateChildRecord(this.draggedRecord,n,this.droppedRecord.expanded),this.parent.enableImmutableMode)){var r=this.draggedRecord;this.updateIndentedChildRecords(r)}Object(w["T"])(this.draggedRecord.parentItem&&-1!==this.updateParentRecords.indexOf(this.draggedRecord.parentItem))&&this.updateParentRecords.push(this.draggedRecord.parentItem)}},e.prototype.updateChildRecordLevel=function(e,t){var i,n=0;if(t++,!e.hasChildRecords)return 0;n=e.childRecords.length;for(var r=0;r<n;r++){i=e.childRecords[r];var s=void 0;if(e.parentItem){var a="uniqueIDCollection";s=this.parent.treeGrid[a][e.parentItem.uniqueID]}i.level=e.parentItem?s.level+t:e.level+1,i.hasChildRecords&&(t--,t=this.updateChildRecordLevel(i,t))}return t},e.prototype.updateChildRecord=function(e,t,i){var n,r=this.parent,s=0;if(!e.hasChildRecords)return 0;s=e.childRecords.length;for(var a=0;a<s;a++)n=e.childRecords[a],t++,r.flatData.splice(t,0,n),this.parent.ids.splice(t,0,n.ganttProperties.rowUniqueID.toString()),r.taskFields.parentID&&this.ganttData.length>0&&this.ganttData.splice(t,0,n.taskData),n.hasChildRecords&&(t=this.updateChildRecord(n,t));return t},e.prototype.removeRecords=function(e){var t,i=this.parent;t=this.parent.dataSource instanceof O["a"]?Object(w["R"])("dataOperation.dataArray",this.parent):this.parent.dataSource;var n=e,r=this.parent.getParentTask(n.parentItem);if(n){if(n.parentItem){var s=r?r.childRecords:[],a=0;s&&s.length>0&&(a=s.indexOf(n),r.childRecords.splice(a,1),this.parent.taskFields.parentID||r.taskData[this.parent.taskFields.child].splice(a,1),this.updateParentRecords.push(r))}if(i.taskFields.parentID){n.hasChildRecords&&n.childRecords.length>0&&this.removeChildItem(n);for(var o=void 0,l=t.length>0?t:this.parent.currentViewData,d=0;d<l.length;d++)l[d][this.parent.taskFields.id]===n.taskData[this.parent.taskFields.id]&&(o=d);if(-1!==o){t.length>0&&t.splice(o,1);var c=void 0;for(d=0;d<this.treeGridData.length;d++)this.treeGridData[d][this.parent.taskFields.id]===n.taskData[this.parent.taskFields.id]&&(c=d);this.treeGridData.splice(c,1),this.parent.ids.splice(c,1),-1!==this.parent.treeGrid.parentData.indexOf(n)&&this.parent.treeGrid.parentData.splice(this.parent.treeGrid.parentData.indexOf(n),1)}}var h=this.treeGridData.indexOf(n);if(!i.taskFields.parentID){var p=this.getChildCount(n,0);this.treeGridData.splice(h,p+1),this.parent.ids.splice(h,p+1);var u=this.ganttData.indexOf(n.taskData);-1!==u&&(this.ganttData.splice(u,1),this.parent.treeGrid.parentData.splice(u,1))}n.parentItem&&r&&r.childRecords&&!r.childRecords.length&&(this.parent.setRecordValue("expanded",!1,r),this.parent.setRecordValue("hasChildRecords",!1,r))}},e.prototype.removeChildItem=function(e){for(var t,i,n=0;n<e.childRecords.length;n++){t=e.childRecords[n];var r=void 0;r=this.parent.dataSource instanceof O["a"]?Object(w["R"])("dataOperation.dataArray",this.parent):this.parent.dataSource;for(var s=0;s<r.length;s++)r[s][this.parent.taskFields.id]===t.taskData[this.parent.taskFields.id]&&(i=s);if(-1!==i){r.length>0&&r.splice(i,1);for(var a=void 0,o=0;o<this.treeGridData.length;o++)this.treeGridData[o][this.parent.taskFields.id]===t.taskData[this.parent.taskFields.id]&&(a=o);this.treeGridData.splice(a,1),this.parent.ids.splice(a,1)}t.hasChildRecords&&this.removeChildItem(t)}},e.prototype.recordLevel=function(){var e=this.parent,t=this.draggedRecord,i=this.droppedRecord,n=e.taskFields.child;if(i.hasChildRecords||(i.hasChildRecords=!0,i.childRecords.length||(i.childRecords=[],!e.taskFields.parentID&&Object(w["T"])(i.taskData[n])&&(i.taskData[n]=[]))),"middleSegment"===this.dropPosition){var r=Object(w["G"])({},i);delete r.childRecords;var s={uniqueID:r.uniqueID,expanded:r.expanded,level:r.level,index:r.index,taskId:r.ganttProperties.rowUniqueID};if(this.parent.setRecordValue("parentItem",s,t),this.parent.setRecordValue("parentUniqueID",i.uniqueID,t),i.childRecords.splice(i.childRecords.length,0,t),Object(w["T"])(t)||e.taskFields.parentID||Object(w["T"])(i.taskData[n])||i.taskData[e.taskFields.child].splice(i.childRecords.length,0,t.taskData),!Object(w["T"])(i.ganttProperties.segments)&&i.ganttProperties.segments.length>0&&(i.ganttProperties.segments=null,i.taskData[e.taskFields.segments]=null),t.hasChildRecords){var a=1;t.level=i.level+1,this.updateChildRecordLevel(t,a)}else t.level=i.level+1;i.expanded=!0}},e}(),Uh=i("3bae"),Gh=function(){function e(e){var t=this;this.selectedRows=[],this.isOverflowBorder=!0,this.selectedRowColls=[],this.isRefresh=!0,this.isReplaceDragEle=!0,this.istargetGrid=!1,this.helper=function(e){var i=t.parent,n=t.draggable.currentStateTarget,r=t.parent.createElement("div",{className:"e-cloneproperties e-draganddrop e-grid e-dragclone",styles:'height:"auto", z-index:2, width:'+i.element.offsetWidth}),s=t.parent.createElement("table",{styles:"width:"+i.element.offsetWidth,attrs:{role:"grid"}}),a=t.parent.createElement(x["D"],{attrs:{role:"rowgroup"}});if(document.getElementsByClassName("e-griddragarea").length||i.rowDropSettings.targetID&&(!n.classList.contains("e-selectionbackground")&&"Single"!==i.selectionSettings.type||!Object(j["hb"])(n,"e-rowcell"))||!i.rowDropSettings.targetID&&!Object(j["hb"])(n,"e-rowdragdrop"))return!1;i.rowDropSettings.targetID&&"Row"===i.selectionSettings.mode&&"Single"===i.selectionSettings.type&&i.selectRow(parseInt(t.draggable.currentStateTarget.parentElement.getAttribute(x["d"]),10)),t.startedRow=Object(w["A"])(n,"tr").cloneNode(!0);var o=t.parent.isFrozenGrid();if(o){var l=parseInt(Object(w["A"])(n,"tr").getAttribute(x["d"]),10);t.startedRow.innerHTML="",t.startedRow.innerHTML+=i.getRowByIndex(l).innerHTML,t.startedRow.innerHTML+=i.getMovableRowByIndex(l).innerHTML,i.getFrozenMode()===x["w"]&&(t.startedRow.innerHTML+=i.getFrozenRightRowByIndex(l).innerHTML)}t.processArgs(n);var d={selectedRow:t.rows,dragelement:n,cloneElement:r,cancel:!1,data:t.rowData},c=i.getSelectedRows();i.trigger(I["Nd"],d);var h="cancel";if(d[h])return!1;Object(j["ob"])(t.startedRow,".e-indentcell"),Object(j["ob"])(t.startedRow,".e-detailrowcollapse"),Object(j["ob"])(t.startedRow,".e-detailrowexpand"),t.removeCell(t.startedRow,x["r"]);var p=new RegExp("e-active","g");if(t.startedRow.innerHTML=t.startedRow.innerHTML.replace(p,""),a.appendChild(t.startedRow),i.getSelectedRowIndexes().length>1&&t.startedRow.hasAttribute("aria-selected")){var u=i.getFrozenMode()===x["w"]?3:2,m=t.parent.createElement("span",{className:"e-dropitemscount",innerHTML:o?""+c.length/u:""+c.length});r.appendChild(m)}var g=Object(w["A"])(n,"tr").querySelector(".e-icon-rowdragicon");return g&&g.classList.add("e-dragstartrow"),s.appendChild(a),r.appendChild(s),i.element.appendChild(r),r},this.dragStart=function(e){var i=t.parent;if(document.body.classList.add("e-prevent-select"),!document.getElementsByClassName("e-griddragarea").length){var n=e.target,r=t.parent.element.querySelector(".e-dropitemscount");t.parent.getSelectedRecords().length>1&&r&&(r.style.left=t.parent.element.querySelector(".e-cloneproperties table").offsetWidth-5+"px"),t.processArgs(n),i.trigger(I["Md"],{rows:t.rows,target:e.target,draggableType:"rows",fromIndex:parseInt(t.rows[0].getAttribute(x["d"]),10),data:Object.keys(t.rowData[0]).length>0?t.rowData:t.currentViewData()}),t.dragStartData=t.rowData;var s=document.getElementById(i.rowDropSettings.targetID);i.rowDropSettings.targetID&&s&&s.ej2_instances&&"grid"===s.ej2_instances[0].getModuleName()&&s.ej2_instances[0].getContent().classList.add("e-allowRowDrop")}},this.drag=function(e){var i=t.parent;if(t.isDropGrid=t.parent,t.istargetGrid=!1,t.parent.rowDropSettings.targetID){var n=document.getElementById(i.rowDropSettings.targetID);t.isDropGrid=n.ej2_instances[0],Object(j["hb"])(e.target,"e-grid")&&(t.istargetGrid=t.parent.rowDropSettings.targetID===Object(j["hb"])(e.target,"e-grid").id)}var r=t.parent.element.querySelector(".e-cloneproperties"),s=t.getElementFromPosition(r,e.event);Object(w["y"])(r,["e-defaultcur"],["e-notallowedcur","e-movecur","e-grabcur"]),t.isOverflowBorder=!0,t.hoverState=i.enableHover;var a=Object(j["hb"])(s,"e-grid")?Object(w["A"])(e.target,"tr"):null;if(e.target){t.processArgs(s);var o={rows:t.rows,target:s,draggableType:"rows",data:t.rowData,originalEvent:e,cancel:!1};if(i.trigger(I["Kd"],o),t.stopTimer(),!o.cancel){if(i.element.classList.add("e-rowdrag"),t.dragTarget=a&&(Object(j["hb"])(s,"e-grid").id===r.parentElement.id||Object(j["hb"])(s,"e-grid").id)?t.isDropGrid.element.querySelector(".e-emptyrow")?0:parseInt(a.getAttribute(x["d"]),10):parseInt(t.startedRow.getAttribute(x["d"]),10),i.rowDropSettings.targetID)Object(j["hb"])(s,"e-grid")&&Object(j["hb"])(r.parentElement,"e-grid").id!==Object(j["hb"])(s,"e-grid").id?Object(w["y"])(r,["e-grabcur"],["e-notallowedcur"]):Object(w["y"])(r,["e-notallowedcur"],["e-defaultcur"]);else{var l=Object(j["hb"])(s,"e-grid");l&&l.id===r.parentElement.id?Object(w["y"])(r,["e-movecur"],["e-defaultcur"]):Object(w["y"])(r,["e-notallowedcur"],["e-movecur"])}if(Object(j["hb"])(t.isDropGrid.element,"e-grid")){if((!t.isDropGrid.groupSettings.columns.length||e.target.classList.contains("e-selectionbackground"))&&!t.isDropGrid.element.querySelector(".e-emptyrow"))if(Object(j["hb"])(s,"e-grid")&&Object(j["hb"])(s,"e-grid").id===t.isDropGrid.element.id&&t.updateScrollPostion(e.event),(t.isOverflowBorder||t.parent.frozenRows>t.dragTarget)&&(parseInt(t.startedRow.getAttribute(x["d"]),10)!==t.dragTarget||t.istargetGrid)||t.istargetGrid&&a&&t.isDropGrid.getRowByIndex(t.isDropGrid.getCurrentViewRecords().length-1).getAttribute("data-uid")===a.getAttribute("data-uid"))t.moveDragRows(e,t.startedRow,a);else{var d=void 0;if(t.parent.enableVirtualization)d=a&&parseInt(a.getAttribute(x["d"]),10)===t.parent.renderModule.data.dataManager.dataSource.json.length-1;else{var c=t.parent.getRowByIndex(t.parent.getCurrentViewRecords().length-1).getAttribute("data-uid");d=a&&c===a.getAttribute("data-uid")&&c!==t.startedRow.getAttribute("data-uid")}if(d&&!t.parent.rowDropSettings.targetID){var h=t.parent.createElement("div",{className:"e-lastrow-dragborder"}),p=t.parent.getContent();h.style.width=t.parent.element.offsetWidth-t.getScrollWidth()+"px",t.parent.enableVirtualization&&(h.style.zIndex="1"),p.getElementsByClassName("e-lastrow-dragborder").length||(p.classList.add("e-grid-relative"),p.appendChild(h),h.style.bottom=t.getScrollWidth()+"px")}t.removeBorder(a)}if(s&&s.classList.contains(x["i"])&&!t.isDropGrid.element.querySelector(".e-emptyrow")&&t.istargetGrid){t.removeBorder(a);var u=t.isDropGrid.getCurrentViewRecords().length-1,m=".e-rowcell,.e-rowdragdrop,.e-detailrowcollapse",g=[];g=[].slice.call(t.isDropGrid.getRowByIndex(u).querySelectorAll(m)),t.isDropGrid.isFrozenGrid()&&(g=t.borderRowElement(u,m)),g.length>0&&Object(j["c"])(g,!0,"e-dragborder")}}}}},this.dragStop=function(e){document.body.classList.remove("e-prevent-select"),Object(j["Y"])(t.parent)?t.parent.notify(I["Yc"],{instance:t,handler:t.processDragStop,arg1:e}):t.processDragStop(e)},this.processDragStop=function(e){var i=t.parent;if(!t.parent.isDestroyed){var n=t.getElementFromPosition(e.helper,e.event),r=n&&!n.classList.contains("e-dlg-overlay")?n:e.target;i.element.classList.remove("e-rowdrag");var s=document.getElementById(i.rowDropSettings.targetID);if(i.rowDropSettings.targetID&&s&&s.ej2_instances&&"grid"===s.ej2_instances[0].getModuleName()&&s.ej2_instances[0].getContent().classList.remove("e-allowRowDrop"),Object(j["hb"])(t.isDropGrid.element,"e-grid")){t.stopTimer(),t.isDropGrid.enableHover=t.hoverState,t.isDropGrid.getContent().classList.remove("e-grid-relative"),t.removeBorder(n);var a=t.isDropGrid.element.querySelector(".e-dragstartrow");a&&a.classList.remove("e-dragstartrow")}t.processArgs(r);var o={target:r,draggableType:"rows",cancel:!1,fromIndex:parseInt(t.rows[0].getAttribute(x["d"]),10),dropIndex:t.dragTarget,rows:t.rows,data:Object.keys(t.dragStartData[0]).length>0?t.dragStartData:t.currentViewData()};i.trigger(I["Od"],o,function(){if(!(Object(j["hb"])(r,x["A"])||Object(j["hb"])(r,"e-emptyrow")||Object(j["hb"])(r,x["s"]))||o.cancel)return t.dragTarget=null,void Object(w["fb"])(e.helper);t.isRefresh=!1;var n=t.parent.getSelectedRowIndexes();i.isRowDragable()&&(!t.parent.rowDropSettings.targetID&&t.startedRow.querySelector("td.e-selectionbackground")&&n.length>1&&n.length!==t.parent.getCurrentViewRecords().length?t.reorderRows(n,o.dropIndex):t.reorderRows([parseInt(t.startedRow.getAttribute(x["d"]),10)],t.dragTarget),t.dragTarget=null,i.rowDropSettings.targetID||(Object(w["fb"])(e.helper),i.enableVirtualization?i.refresh():t.rowOrder(o))),t.isRefresh=!0})}},this.removeCell=function(e,t){return[].slice.call(e.querySelectorAll("td")).filter(function(i){i.classList.contains(t)&&e.deleteCell(i.cellIndex)})},this.parent=e,this.parent.isDestroyed||(this.parent.on(I["Ic"],this.initializeDrag,this),this.parent.on(I["kb"],this.columnDrop,this),this.parent.on(I["Ld"],this.onActionComplete,this),this.onDataBoundFn=this.onDataBound.bind(this),this.parent.addEventListener(I["Ab"],this.onDataBoundFn),this.parent.on(I["qe"],this.enableAfterRender,this),this.parent.on(I["Hb"],this.destroy,this))}return e.prototype.refreshRow=function(e,t,i,n,r,s,a){var o,l,d,c,h=this.parent,p=h.isFrozenGrid(),u=h.getFrozenMode()===x["w"],m=h.getContentTable().querySelector(x["D"]),g=h.getHeaderTable().querySelector(x["D"]);p&&(o=h.getMovableHeaderTbody(),l=h.getMovableContentTbody(),u&&(d=h.getFrozenRightHeaderTbody(),c=h.getFrozenRightContentTbody()));for(var f=h.getFrozenMode()===x["w"]?3:2,b=0,v=e.rows.length;b<v;b++)p?b%f===0?t.insertBefore(e.rows[b],r):b%f===1?i.insertBefore(e.rows[b],s):n.insertBefore(e.rows[b],a):t.insertBefore(e.rows[b],r);var y,C,w=[].slice.call(t.getElementsByClassName(x["A"]));if(p&&(y=[].slice.call(i.getElementsByClassName(x["A"])),u&&(C=[].slice.call(n.getElementsByClassName(x["A"])))),this.refreshData(w,y,C),this.parent.frozenRows){var O=function(e,t){e<T.parent.frozenRows?Object(j["zb"])(g,o,d,w,y,C,function(t,i){t.appendChild(i[e])}):Object(j["zb"])(m,l,c,w,y,C,function(t,i){t.appendChild(i[e])})},T=this;for(b=0,v=w.length;b<v;b++)O(b,v)}},e.prototype.updateFrozenRowreOrder=function(e){var t,i,n,r,s=this.parent,a=this.parent.isFrozenGrid(),o=s.getFrozenMode()===x["w"],l=s.getContentTable().querySelector(x["D"]),d=s.getHeaderTable().querySelector(x["D"]);a&&(t=s.getMovableHeaderTbody(),i=s.getMovableContentTbody(),o&&(n=s.getFrozenRightHeaderTbody(),r=s.getFrozenRightContentTbody()));var c,h,p=[].slice.call(d.getElementsByClassName(x["A"])).concat([].slice.call(l.getElementsByClassName(x["A"])));a&&(c=[].slice.call(t.getElementsByClassName(x["A"])).concat([].slice.call(i.getElementsByClassName(x["A"]))),o&&(h=[].slice.call(n.getElementsByClassName(x["A"])).concat([].slice.call(r.getElementsByClassName(x["A"])))));var u=s.createElement(x["D"],{attrs:{role:"rowgroup"}}),m=s.createElement(x["D"],{attrs:{role:"rowgroup"}}),g=s.createElement(x["D"],{attrs:{role:"rowgroup"}});this.parent.clearSelection();for(var f=this.refreshRowTarget(e),b=0,v=p.length;b<v;b++)u.appendChild(p[b]),a&&(m.appendChild(c[b]),o&&g.appendChild(h[b]));this.refreshRow(e,u,m,g,f.target,f.mTarget,f.frTarget)},e.prototype.refreshRowTarget=function(e){var t,i,n=this.parent,r=parseInt(e.target.parentElement.getAttribute(x["d"]),10);(e.fromIndex<e.dropIndex||e.fromIndex===e.dropIndex)&&(r+=1);var s=n.getRowByIndex(r);n.isFrozenGrid()&&(t=n.getMovableRowByIndex(r),n.getFrozenMode()===x["w"]&&(i=n.getFrozenRightRowByIndex(r)));var a={target:s,mTarget:t,frTarget:i};return a},e.prototype.updateFrozenColumnreOrder=function(e){var t,i,n=this.parent,r=this.parent.isFrozenGrid(),s=n.getContentTable().querySelector(x["D"]);r&&(t=n.getMovableContentTbody(),n.getFrozenMode()===x["w"]&&(i=n.getFrozenRightContentTbody())),this.parent.clearSelection();var a=this.refreshRowTarget(e);this.refreshRow(e,s,t,i,a.target,a.mTarget,a.frTarget)},e.prototype.refreshData=function(e,t,i){for(var n={},r={},s={},a={},o=this.parent.getRowsObject(),l=this.parent.getMovableRowsObject(),d=this.parent.getFrozenRightRowsObject(),c=this.parent.getCurrentViewRecords(),h=0,p=e.length;h<p;h++){var u=parseInt(e[h].getAttribute(x["d"]),10);n[h]=o[u],a[h]=c[u],this.parent.isFrozenGrid()&&(r[h]=l[u],i&&(s[h]=d[u]))}var m,g,f=this.parent.getRows();this.parent.isFrozenGrid()&&(m=this.parent.getMovableRows(),i&&(g=this.parent.getFrozenRightRows()));for(h=0,p=e.length;h<p;h++)f[h]=e[h],o[h]=n[h],c[h]=a[h],this.parent.isFrozenGrid()&&(m[h]=t[h],l[h]=r[h],i&&(g[h]=i[h],d[h]=s[h]));Object(j["rb"])(this.parent,o,e),this.parent.isFrozenGrid()&&(Object(j["rb"])(this.parent,l,t),i&&Object(j["rb"])(this.parent,d,i))},e.prototype.rowOrder=function(e){if(e.dropIndex!==e.fromIndex&&!isNaN(e.dropIndex)){if(this.parent.isDetail()){this.parent.detailCollapseAll();var t=[].slice.call(this.parent.getContentTable().querySelector(x["D"]).children),i=this.parent.getRowsObject();t.filter(function(e){e.classList.contains("e-detailrow")&&e.remove()});for(var n=0,r=i.length;n<r;n++){if(!i[n])break;i[n].isDetailRow&&(this.parent.getRowsObject().splice(n,1),n--)}}if((e.target.classList.contains("e-rowcelldrag")||e.target.classList.contains("e-dtdiagonalright")||e.target.classList.contains("e-dtdiagonaldown"))&&(e.target=e.target.parentElement),!e.target.classList.contains("e-rowcell")&&Object(j["hb"])(e.target,"e-rowcell")&&(e.target=Object(j["hb"])(e.target,"e-rowcell")),this.parent.frozenRows?this.updateFrozenRowreOrder(e):this.updateFrozenColumnreOrder(e),this.selectedRowColls.length>0){this.parent.selectRows(this.selectedRowColls);var s=[];if(this.parent.filterSettings.columns.length||this.parent.sortSettings.columns.length){for(n=0,r=e.rows.length;n<r;n++)s.push(parseInt(e.rows[n].getAttribute(x["d"]),10));this.selectedRowColls=s}this.selectedRowColls=[]}}},e.prototype.currentViewData=function(){for(var e=this.parent.getSelectedRowIndexes(),t=[],i=parseInt(this.startedRow.getAttribute(x["d"]),10),n=0,r=e.length;n<r;n++){var s="currentViewData";t[n]=this.parent[s][e[n]]}return this.parent.rowDropSettings.targetID||0!==e.length||(t[0]=this.parent.currentViewData[i]),t},e.prototype.saveChange=function(e,t){var i=this;this.parent.getDataModule().saveChanges(e,this.parent.getPrimaryKeyFieldNames()[0],{},t).then(function(){i.parent.notify(I["Nc"],{type:I["a"],requestType:"rowdraganddrop"})}).catch(function(e){var t="error",n="message";Object(w["T"])(e[t])||Object(w["T"])(e[t][n])||(e[t]=e[t][n]),i.parent.trigger(I["c"],e)})},e.prototype.reorderRows=function(e,t){for(var i=this.parent.getSelectedRowIndexes(),n=[],r=[],s=this.parent.renderModule.data.dataManager.dataSource.json,a=this.parent.allowPaging?this.parent.pageSettings.currentPage*this.parent.pageSettings.pageSize-this.parent.pageSettings.pageSize:0,o=t+a,l=e[0]+a,d=0,c=e.length;d<c;d++)r[d]=s[e[d]+a];for(d=0,c=i.length;d<c;d++)n[d]=s[i[d]+a];for(d=0,c=r.length;d<c;d++){if(0!==d){for(var h=0,p=s.length;h<p;h++)if(JSON.stringify(this.parent.renderModule.data.dataManager.dataSource.json[h])===JSON.stringify(r[d])){l=h;break}for(h=0,p=s.length;h<p;h++)if(JSON.stringify(this.parent.renderModule.data.dataManager.dataSource.json[h])===JSON.stringify(r[d-1])){l>h&&(o=h+1);break}}this.reorderRow(l-a,o-a)}this.isRefresh&&this.parent.notify(I["Nc"],{type:I["a"],requestType:"rowdraganddrop"});for(d=0,c=n.length;d<c;d++)for(h=0,p=s.length;h<p;h++)if(JSON.stringify(this.parent.renderModule.data.dataManager.dataSource.json[h])===JSON.stringify(n[d])){i[d]=h-a;break}this.selectedRowColls=i},e.prototype.stopTimer=function(){window.clearInterval(this.timer)},e.prototype.onActionComplete=function(e){this.parent.trigger(I["b"],Object(w["G"])(e,{type:I["b"],requestType:"rowdraganddrop"}))},e.prototype.initializeDrag=function(){var e=this.parent;this.draggable=new w["i"](e.element,{dragTarget:".e-rowcelldrag, .e-rowdragdrop, .e-rowcell",distance:5,helper:this.helper,dragStart:this.dragStart,drag:this.drag,dragStop:this.dragStop,isReplaceDragEle:this.isReplaceDragEle,isPreventSelect:!1})},e.prototype.updateScrollPostion=function(e){var t=this,i=Object(j["O"])(e).y,n=this.isDropGrid.getContent().getBoundingClientRect(),r=this.isDropGrid.getRowHeight()-15,s=this.isDropGrid.getContent().firstElementChild,a=this.parent.enableVirtualization?20:0;if(n.top>=i){var o=-this.isDropGrid.getRowHeight();this.isOverflowBorder=!1,this.timer=window.setInterval(function(){t.setScrollDown(s,o)},200)}else if(n.top+this.isDropGrid.getContent().clientHeight-r-33-a<=i){var l=this.isDropGrid.getRowHeight();this.isOverflowBorder=!1,this.timer=window.setInterval(function(){t.setScrollDown(s,l)},200)}},e.prototype.setScrollDown=function(e,t){e.scrollTop=e.scrollTop+t},e.prototype.moveDragRows=function(e,t,i){var n=this.parent.element.querySelector(".e-cloneproperties"),r=Object(w["A"])(e.target,"tr");if(Object(j["hb"])(r,"e-grid")&&(Object(j["hb"])(n.parentElement,"e-grid").id===Object(j["hb"])(r,"e-grid").id||this.istargetGrid)){var s=r||this.startedRow;this.setBorder(s,e.event,t,i)}},e.prototype.setBorder=function(e,t,i,n){var r=this.parent.element;this.istargetGrid&&(r=this.isDropGrid.element);var s=this.parent.element.querySelector(".e-cloneproperties");if(this.removeFirstRowBorder(e),this.removeLastRowBorder(e),Object(j["hb"])(e,"e-grid")&&e.classList.contains(x["A"])&&(!this.parent.rowDropSettings.targetID&&Object(j["hb"])(s.parentElement,"e-grid").id===Object(j["hb"])(e,"e-grid").id||this.istargetGrid)){Object(w["gb"])(r.querySelectorAll(".e-rowcell,.e-rowdragdrop,.e-detailrowcollapse"),["e-dragborder"]);var a=[],o=parseInt(n.getAttribute(x["d"]),10);if(n&&0===o){var l=this.parent.createElement("div",{className:"e-firstrow-dragborder"}),d=this.isDropGrid.getHeaderContent();d.classList.add("e-grid-relative"),l.style.width=r.offsetWidth-this.getScrollWidth()+"px",d.getElementsByClassName("e-firstrow-dragborder").length||d.appendChild(l)}else this.parent.rowDropSettings.targetID&&n?(e=this.isDropGrid.getRowByIndex(o-1),a=[].slice.call(e.querySelectorAll(".e-rowcell,.e-rowdragdrop,.e-detailrowcollapse"))):n&&parseInt(i.getAttribute(x["d"]),10)>o?(e=this.parent.getRowByIndex(o-1),a=[].slice.call(e.querySelectorAll(".e-rowcell,.e-rowdragdrop,.e-detailrowcollapse"))):a=[].slice.call(e.querySelectorAll(".e-rowcell,.e-rowdragdrop,.e-detailrowcollapse"));var c=this.parent.isFrozenGrid();if(n&&0!==o&&c){var h=parseInt(e.getAttribute(x["d"]),10),p=".e-rowcell,.e-rowdragdrop,.e-detailrowcollapse";a=this.borderRowElement(h,p)}a.length>0&&Object(j["c"])(a,!0,"e-dragborder")}},e.prototype.borderRowElement=function(e,t){var i=[];return i=[].slice.call(this.isDropGrid.getRowByIndex(e).querySelectorAll(t)).concat([].slice.call(this.isDropGrid.getMovableRowByIndex(e).querySelectorAll(t))),this.isDropGrid.getFrozenMode()===x["w"]&&(i=i.concat([].slice.call(this.isDropGrid.getFrozenRightRowByIndex(e).querySelectorAll(t)))),i},e.prototype.getScrollWidth=function(){var e=this.parent.getContent().firstElementChild;return e.scrollWidth>e.offsetWidth?Uh["a"].getScrollBarWidth():0},e.prototype.removeFirstRowBorder=function(e){this.isDropGrid.element.getElementsByClassName("e-firstrow-dragborder").length>0&&e&&0!==e.rowIndex&&Object(w["fb"])(this.isDropGrid.element.getElementsByClassName("e-firstrow-dragborder")[0])},e.prototype.removeLastRowBorder=function(e){var t;t=this.parent.enableVirtualization?e&&parseInt(e.getAttribute(x["d"]),10)!==this.parent.renderModule.data.dataManager.dataSource.json.length-1:e&&this.parent.getRowByIndex(this.parent.getCurrentViewRecords().length-1).getAttribute("data-uid")!==e.getAttribute("data-uid"),this.parent.element.getElementsByClassName("e-lastrow-dragborder").length>0&&e&&t&&Object(w["fb"])(this.parent.element.getElementsByClassName("e-lastrow-dragborder")[0])},e.prototype.removeBorder=function(e){if(this.removeFirstRowBorder(e),this.parent.rowDropSettings.targetID||this.removeLastRowBorder(e),e=(this.isDropGrid.isFrozenGrid()?this.isDropGrid.getMovableRows():this.isDropGrid.getRows()).filter(function(e){return e.querySelector("td.e-dragborder")})[0],e){var t=[].slice.call(e.getElementsByClassName("e-dragborder"));if(this.parent.isFrozenGrid()){var i=parseInt(e.getAttribute(x["d"]),10),n=".e-dragborder";t=this.borderRowElement(i,n)}Object(j["c"])(t,!1,"e-dragborder")}},e.prototype.getElementFromPosition=function(e,t){var i=Object(j["O"])(t);e.style.display="none";var n=document.elementFromPoint(i.x,i.y);return e.style.display="",n},e.prototype.onDataBound=function(){this.selectedRowColls.length>0&&this.parent.enableVirtualization&&(this.parent.selectRows(this.selectedRowColls),this.selectedRowColls=[])},e.prototype.getTargetIdx=function(e){return e?parseInt(e.getAttribute(x["d"]),10):0},e.prototype.singleRowDrop=function(e){var t=Object(w["A"])(e.target,"tr"),i=e.droppedElement.parentElement.ej2_instances[0],n=t?t.rowIndex:i.currentViewData.length-1;this.reorderRow(this.startedRowIndex,n)},e.prototype.columnDrop=function(e){var t=this.parent;if("grouping"!==e.droppedElement.getAttribute("action")&&(Object(j["hb"])(e.target,x["A"])||Object(j["hb"])(e.target,"e-emptyrow")||Object(j["hb"])(e.target,x["s"]))){var i=Object(w["A"])(e.target,"tr"),n=void 0;if("true"!==e.droppedElement.querySelector("tr").getAttribute("single-dragrow")&&e.droppedElement.parentElement.id===t.element.id||"true"===e.droppedElement.querySelector("tr").getAttribute("single-dragrow")&&e.droppedElement.parentElement.id!==t.element.id)return;if(e.droppedElement.parentElement.id!==t.element.id)n=e.droppedElement.parentElement.ej2_instances[0];else if(this.isSingleRowDragDrop||"true"===e.droppedElement.querySelector("tr").getAttribute("single-dragrow"))return void this.singleRowDrop(e);if(n.element.id!==t.element.id&&n.rowDropSettings.targetID!==t.element.id)return;var r=n.getSelectedRecords(),s=this.getTargetIdx(i);isNaN(s)&&(s=0),t.allowPaging&&(s=s+t.pageSettings.currentPage*t.pageSettings.pageSize-t.pageSettings.pageSize),t.notify(I["Ud"],{toIndex:s,records:r}),t.notify(I["Nc"],{type:I["a"],requestType:"rowdraganddrop"});var a=n.getSelectedRowIndexes(),o=n.allowPaging?n.pageSettings.currentPage*n.pageSettings.pageSize-n.pageSettings.pageSize:0;this.selectedRows=[];for(var l=0,d=r.length;l<d;l++)this.selectedRows.push(o+a[l]);n.notify(I["Vd"],{indexes:this.selectedRows,records:r}),n.notify(I["Nc"],{type:I["a"],requestType:"rowdraganddrop"})}},e.prototype.reorderRow=function(e,t){var i=this.parent;if(!i.sortSettings.columns.length&&!i.groupSettings.columns.length&&!i.filterSettings.columns.length){var n=i.allowPaging?i.pageSettings.currentPage*i.pageSettings.pageSize-i.pageSettings.pageSize:0;t+=n,this.selectedRows=i.getSelectedRowIndexes(),i.notify(I["Qd"],{fromIndex:e+n,toIndex:t})}},e.prototype.enableAfterRender=function(e){e.module===this.getModuleName()&&e.enable&&this.initializeDrag()},e.prototype.destroy=function(){var e=this.parent.element;!this.parent.isDestroyed&&e&&(e.querySelector("."+x["u"])||e.querySelector("."+x["s"]))&&(this.draggable.destroy(),this.parent.off(I["Ic"],this.initializeDrag),this.parent.off(I["kb"],this.columnDrop),this.parent.off(I["Ld"],this.onActionComplete),this.parent.removeEventListener(I["Ab"],this.onDataBoundFn),this.parent.off(I["qe"],this.enableAfterRender),this.parent.off(I["Hb"],this.destroy))},e.prototype.getModuleName=function(){return"rowDragAndDrop"},e.prototype.processArgs=function(e){var t=this.parent,i=parseInt(this.startedRow.getAttribute(x["d"]),10);t.getSelectedRecords().length>0&&!1===this.startedRow.cells[0].classList.contains("e-selectionbackground")||0===t.getSelectedRecords().length?(this.parent.enableVirtualization?this.rows=[this.startedRow]:(this.rows=[this.parent.getRowByIndex(i)],t.isFrozenGrid()&&(this.rows=[t.getRowByIndex(i),t.getMovableRowByIndex(i)],t.getFrozenMode()===x["w"]&&(this.rows=[t.getRowByIndex(i),t.getMovableRowByIndex(i),t.getFrozenRightRowByIndex(i)]))),this.rowData=[this.parent.getRowInfo(this.startedRow.querySelector("."+x["B"])).rowData]):(this.rows=t.getSelectedRows(),this.rowData=t.getSelectedRecords())},e}(),Wh=function(){function e(e){this.canDrop=!0,this.isDraggedWithChild=!1,this.modifiedRecords="modifiedRecords",this.selectedRecords="selectedRecords",this.selectedRows="selectedRows",this.hasDropItem=!0,this.isaddtoBottom=!1,E["a"].Inject(Gh),this.parent=e,this.addEventListener()}return e.prototype.getChildrecordsByParentID=function(e){var t;t=this.parent.dataSource instanceof O["a"]&&Object(Se["j"])(this.parent)?this.parent.grid.dataSource.dataSource.json:this.parent.grid.dataSource;var i=t.filter(function(t){return t.uniqueID===e});return i},e.prototype.addEventListener=function(){this.parent.on(ke["bb"],this.Rowdraging,this),this.parent.on(ke["Y"],this.rowDropped,this),this.parent.on(ke["cb"],this.rowsAdded,this),this.parent.on(ke["db"],this.rowsRemoved,this)},e.prototype.reorderRows=function(e,t,i){var n=this.parent,r="action",s="dropPosition",a="updateRowAndCellElements";if(e[0]!==t&&-1!==["above","below","child"].indexOf(i)){"above"===i&&(this.dropPosition="topSegment"),"below"===i&&(this.dropPosition="bottomSegment"),"child"===i&&(this.dropPosition="middleSegment"),this.parent[s]=this.dropPosition;for(var o=[],l=0;l<e.length;l++){var d=this.parent.getRowByIndex(e[l]).rowIndex;o[l]=this.parent.getCurrentViewRecords()[d]}var c=!0,h={data:o,dropIndex:t};if(Object(Se["g"])(this.parent)||this.dropRows(h,c),n.isLocalData&&(n.flatData=this.orderToIndex(n.flatData)),"outdenting"===this.parent[r]&&(Object(w["T"])(o[0].parentItem)||(o[0].level=o[0].parentItem.level+1)),this.parent.grid.refresh(),this.parent.enableImmutableMode&&"middleSegment"===this.dropPosition){d=void 0;this.parent.allowRowDragAndDrop?d=this.parent.treeColumnIndex+1:"indenting"===this.parent[r]&&(d=this.parent.treeColumnIndex);var p=this.parent.getRows()[e[0]],u=h.data[0],m=[],g=[];m.push(u),g.push(p);var f="parentUniqueID",b=Object(Se["d"])(this.parent,h.data[0][f]),v=this.parent.getRows()[t];m.push(b),g.push(v),this.parent[a](m,g,d)}if(this.parent.enableImmutableMode&&"outdenting"===this.parent[r]){d=void 0;this.parent.allowRowDragAndDrop?d=this.parent.treeColumnIndex+1:"outdenting"===this.parent[r]&&(d=this.parent.treeColumnIndex);var y=h.data[0];p=this.parent.getRows()[e[0]],m=[],g=[];m.push(y),g.push(p),this.parent[a](m,g,d)}}},e.prototype.indentOutdentAction=function(e,t){var i=this.parent,n="action",r="dropIndex",s=-1;if(!Object(w["T"])(e)||-1!==this.parent.selectedRowIndex){this.parent.enableVirtualization&&-1!==this.parent.selectedRowIndex?s=this.parent.getSelectedRows()[0].rowIndex:-1!==this.parent.selectedRowIndex&&(s=this.parent.selectedRowIndex),this.selectedItem=Object(w["T"])(e)?i.getCurrentViewRecords()[s]:e;var a=this.parent.getPrimaryKeyFieldNames()[0],o=this.parent.grid.getRowIndexByPrimaryKey(this.selectedItem[a]);if(this.selectedRow=this.parent[this.selectedRows]=-1!==s?this.parent.getSelectedRows()[0]:this.parent.grid.getRowByIndex(o),this.selectedRecord=this.parent[this.selectedRecords]=-1!==s?i.getCurrentViewRecords()[s]:this.selectedItem,"indent"===t){var l=i.getCurrentViewRecords()[this.selectedRow.rowIndex-1],d=void 0;if(0===this.selectedRow.rowIndex||-1===this.selectedRow.rowIndex||i.getCurrentViewRecords()[this.selectedRow.rowIndex].level-l.level===1)return;if(l.level>this.selectedRecord.level)for(var c=0;c<i.getCurrentViewRecords().length;c++)i.getCurrentViewRecords()[c].taskData===l.parentItem.taskData&&(d=c);else d=this.selectedRow.rowIndex-1;this.parent.enableVirtualization&&this.parent.allowRowDragAndDrop&&this.selectedRecord&&(d=parseInt(this.selectedRow.getAttribute("aria-rowindex"),10)-1),i[n]="indenting",i[r]=d,this.eventTrigger("indenting",d)}else if("outdent"===t){if(-1===this.selectedRow.rowIndex||0===this.selectedRow.rowIndex||0===i.getCurrentViewRecords()[this.selectedRow.rowIndex].level)return;d=void 0;var h=this.selectedRecord.parentItem;for(c=0;c<i.getCurrentViewRecords().length;c++)i.getCurrentViewRecords()[c].taskData===h.taskData&&(d=c);this.parent.enableVirtualization&&this.parent.allowRowDragAndDrop&&this.selectedRecord&&(d=parseInt(this.parent.getRows()[d].getAttribute("aria-rowindex"),10)),i[n]="outdenting",i[r]=d,this.eventTrigger("outdenting",d)}}},e.prototype.eventTrigger=function(e,t){var i=this,n={action:e,cancel:!1,data:[this.parent[this.selectedRecords]],row:this.parent[this.selectedRows]};this.parent.trigger(ke["a"],n,function(e){e.cancel||("indenting"===e.action?i.parent.enableVirtualization&&i.parent.allowRowDragAndDrop?i.reorderRows([parseInt(i.selectedRow.getAttribute("aria-rowindex"),10)],t,"child"):i.reorderRows([i.selectedRow.rowIndex],t,"child"):"outdenting"===e.action&&(i.parent.enableVirtualization&&i.parent.allowRowDragAndDrop?i.reorderRows([parseInt(i.selectedRow.getAttribute("aria-rowindex"),10)],t,"below"):i.reorderRows([i.selectedRow.rowIndex],t,"below")))})},e.prototype.orderToIndex=function(e){for(var t=0;t<e.length;t++)if(e[t].index=t,!Object(w["T"])(e[t].parentItem)){var i=Object(w["R"])("uniqueIDCollection."+e[t].parentUniqueID,this.parent);e[t].parentItem.index=i.index}return e},e.prototype.rowsAdded=function(e){for(var t,i=e.records,n=e.records.length-1;n>-1;n--)if(t=i[n],t.parentUniqueID){var r=i.filter(function(e){return e.uniqueID===t.parentUniqueID});if(r.length){var s=r[0].childRecords.indexOf(t),a=r[0];-1!==s&&(Object(w["T"])(this.parent.idMapping)&&(a.childRecords.splice(s,1),a.childRecords.length||(a.hasChildRecords=!1,a.hasFilteredChildRecords=!1)),this.isDraggedWithChild=!0)}}if(Object(w["T"])(this.parent.dataSource)||!this.parent.dataSource.length){var o,l=this.parent,d=e.records,c=e.records.length;for(n=c-1;n>-1;n--){o=d[n],!n&&o.hasChildRecords&&(o.taskData[this.parent.parentIdMapping]=null);var h=0;if(Object(w["T"])(l.parentIdMapping)||(l.childMapping=null),Object(w["T"])(o.taskData)||Object(w["T"])(l.childMapping)||Object.prototype.hasOwnProperty.call(o.taskData,l.childMapping)||(o.taskData[l.childMapping]=[]),Object.prototype.hasOwnProperty.call(o,l.childMapping)&&o[l.childMapping].length&&!this.isDraggedWithChild&&!Object(w["T"])(l.parentIdMapping))for(var p=o[l.childMapping],u=0;u<p.length;u++)-1===d.indexOf(p[u])&&(d.splice(u,0,p[u]),p[u].taskData=Object(w["G"])({},p[u]),n+=1);Object.prototype.hasOwnProperty.call(o,l.parentIdMapping)&&null!==o[l.parentIdMapping]&&!this.isDraggedWithChild&&(o.taskData[l.parentIdMapping]=null,delete o.parentItem,delete o.parentUniqueID),Object(w["T"])(l.dataSource)&&(l.dataSource=[]),l.dataSource.splice(h,0,o.taskData)}l.setProperties({dataSource:l.dataSource},!1)}else{for(n=0;n<i.length;n++)Object(w["ob"])("uniqueIDCollection."+i[n].uniqueID,i[n],this.parent);var m={data:e.records,dropIndex:e.toIndex};this.parent.dataSource instanceof O["a"]?(this.treeGridData=this.parent.dataSource.dataSource.json,this.treeData=this.parent.dataSource.dataSource.json):(this.treeGridData=this.parent.grid.dataSource,this.treeData=this.parent.dataSource),Object(w["T"])(this.dropPosition)&&(this.dropPosition="bottomSegment",m.dropIndex=this.parent.getCurrentViewRecords().length>1?this.parent.getCurrentViewRecords().length-1:m.dropIndex,m.data=m.data.map(function(e){return e.hasChildRecords&&Object(w["T"])(e.parentItem)?(e.level=0,e):(delete e.parentItem,delete e.parentUniqueID,e.level=0,e)})),this.dropRows(m)}},e.prototype.rowsRemoved=function(e){for(var t=0;t<e.records.length;t++)this.draggedRecord=e.records[t],(this.draggedRecord.hasChildRecords||this.draggedRecord.parentItem&&-1!==this.parent.grid.dataSource.indexOf(this.getChildrecordsByParentID(this.draggedRecord.parentUniqueID)[0])||0===this.draggedRecord.level)&&this.deleteDragRow()},e.prototype.refreshGridDataSource=function(){var e,t,i=this.draggedRecord,n=this.droppedRecord,r=this.parent;if(e=this.parent.dataSource instanceof O["a"]&&Object(Se["j"])(this.parent)?r.dataSource.dataSource.json:r.dataSource,!e||Object(w["T"])(n)||n.parentItem||Object(w["T"])(n.taskData)){if(!this.parent.parentIdMapping&&!Object(w["T"])(n)&&n.parentItem&&("topSegment"===this.dropPosition||"bottomSegment"===this.dropPosition)){var s=this.getChildrecordsByParentID(n.parentUniqueID)[0],a=s.childRecords;for(l=0;l<a.length;l++)n.parentItem.taskData[this.parent.childMapping][l]=a[l].taskData}}else{for(var o=Object.keys(e),l=0;l<o.length;l++)e[l][this.parent.childMapping]===n.taskData[this.parent.childMapping]&&(t=l);"topSegment"===this.dropPosition?this.parent.idMapping||e.splice(t,0,i.taskData):"bottomSegment"===this.dropPosition&&(this.parent.idMapping||e.splice(t+1,0,i.taskData))}this.parent.parentIdMapping&&(i.parentItem?"topSegment"===this.dropPosition||"bottomSegment"===this.dropPosition?(i[this.parent.parentIdMapping]=n[this.parent.parentIdMapping],i.taskData[this.parent.parentIdMapping]=n[this.parent.parentIdMapping]):(i[this.parent.parentIdMapping]=n[this.parent.idMapping],i.taskData[this.parent.parentIdMapping]=n[this.parent.idMapping]):(i.taskData[this.parent.parentIdMapping]=null,i[this.parent.parentIdMapping]=null))},e.prototype.removeFirstrowBorder=function(e){var t="bottomSegment"===this.dropPosition;this.parent.element.getElementsByClassName("e-firstrow-border").length>0&&e&&(0!==e.rowIndex||t)&&this.parent.element.getElementsByClassName("e-firstrow-border")[0].remove()},e.prototype.removeLastrowBorder=function(e){var t,i=e&&(e.classList.contains("e-emptyrow")||e.classList.contains("e-columnheader")||e.classList.contains("e-detailrow"));t=this.parent.enableVirtualization?e&&!i&&this.parent.getRows()[this.parent.getCurrentViewRecords().length-1].getAttribute("data-uid")!==e.getAttribute("data-uid"):e&&!i&&this.parent.getRowByIndex(this.parent.getCurrentViewRecords().length-1).getAttribute("data-uid")!==e.getAttribute("data-uid");var n=t||"topSegment"===this.dropPosition;this.parent.element.getElementsByClassName("e-lastrow-border").length>0&&e&&(t||n)&&this.parent.element.getElementsByClassName("e-lastrow-border")[0].remove()},e.prototype.updateIcon=function(e,t,i){var n=i.target?Object(w["A"])(i.target,"tr"):null;this.dropPosition=void 0;var r=0;this.removeFirstrowBorder(n),this.removeLastrowBorder(n);for(var s=0;s<i.rows.length;s++)(Object(w["T"])(n)||n.getAttribute("data-uid")!==i.rows[s].getAttribute("data-uid"))&&Object(j["hb"])(i.target,"e-gridcontent")||(this.dropPosition="Invalid",this.addErrorElem());var a=this.parent,o=0,l=0,d=a.toolbar&&a.toolbar.length?document.getElementById(a.element.id+"_gridcontrol_toolbarItems").offsetHeight:0,c=this.getOffset(a.element),h=a.getHeaderContent().offsetHeight+c.top+d,p=a.getContent().firstElementChild.scrollTop;Object(w["T"])(n)||(r=n.offsetTop-p),o=this.parent.enableVirtualization?n.getBoundingClientRect().top:r+h+l;var u=o+e[0].offsetHeight,m=u-o,g=m/3,f=o+g,b=f+g,v=b+g,y=Object(j["N"])("originalEvent.event",i),C=Object(j["N"])("originalEvent.event",i),O="mousemove"===y.type?y.pageY:Object(w["T"])(C)||Object(w["T"])(C.changedTouches)?null:C.changedTouches[0].pageY,T=O<=f,k=O>f&&O<=b,S=O>b&&O<=v;if(T||k||S){if(T&&"Invalid"!==this.dropPosition&&(this.removeChildBorder(),this.dropPosition="topSegment",this.removetopOrBottomBorder(),this.addFirstrowBorder(n),this.removeErrorElem(),this.removeLastrowBorder(n),this.topOrBottomBorder(i.target)),k&&"Invalid"!==this.dropPosition){this.removetopOrBottomBorder();var R=[],D=Object(w["A"])(i.target,"tr");R=[].slice.call(D.querySelectorAll(".e-rowcell,.e-rowdragdrop,.e-detailrowcollapse")),R.length>0&&this.addRemoveClasses(R,!0,"e-childborder"),this.addLastRowborder(n),this.addFirstrowBorder(n),this.dropPosition="middleSegment"}S&&"Invalid"!==this.dropPosition&&(this.removeErrorElem(),this.removetopOrBottomBorder(),this.removeChildBorder(),this.dropPosition="bottomSegment",this.addLastRowborder(n),this.removeFirstrowBorder(n),this.topOrBottomBorder(i.target))}return this.dropPosition},e.prototype.removeChildBorder=function(){var e=[];e=[].slice.call(this.parent.element.querySelectorAll(".e-childborder")),e.length>0&&this.addRemoveClasses(e,!1,"e-childborder")},e.prototype.addFirstrowBorder=function(e){var t=this.parent.element,i=this.parent;if(e&&0===e.rowIndex&&!e.classList.contains("e-emptyrow")){var n=this.parent.createElement("div",{className:"e-firstrow-border"}),r=this.parent.getHeaderContent(),s=0;i.toolbar&&(s=i.toolbarModule.getToolbar().offsetHeight);var a=!Object(w["T"])(this.parent.rowDropSettings.targetID);a&&(n.style.top=this.parent.grid.element.getElementsByClassName("e-gridheader")[0].offsetHeight+s+"px"),n.style.width=a?t.offsetWidth+"px":t.offsetWidth-this.getScrollWidth()+"px",r.querySelectorAll(".e-firstrow-border").length||r.appendChild(n)}},e.prototype.addLastRowborder=function(e){var t=e&&(e.classList.contains("e-emptyrow")||e.classList.contains("e-columnheader")||e.classList.contains("e-detailrow"));if(e&&!t&&this.parent.getRows()[this.parent.getCurrentViewRecords().length-1].getAttribute("data-uid")===e.getAttribute("data-uid")){var i=this.parent.createElement("div",{className:"e-lastrow-border"}),n=this.parent.getContent();i.style.width=this.parent.element.offsetWidth-this.getScrollWidth()+"px",n.querySelectorAll(".e-lastrow-border").length||(n.classList.add("e-treegrid-relative"),n.appendChild(i),i.style.bottom=this.getScrollWidth()+"px")}},e.prototype.getScrollWidth=function(){var e=this.parent.getContent().firstElementChild;return e.scrollWidth>e.offsetWidth?Uh["a"].getScrollBarWidth():0},e.prototype.addErrorElem=function(){var e=document.getElementsByClassName("e-cloneproperties")[0],t=e.querySelectorAll(".e-errorelem").length;if(!t&&!this.parent.rowDropSettings.targetID){var i=document.createElement("div");Object(w["y"])(i,["e-errorcontainer"],[]),Object(w["y"])(i,["e-icons","e-errorelem"],[]);var n=e.querySelector(".errorValue"),r=e.querySelector(".e-rowcell").innerHTML;n&&(r=n.innerHTML,n.parentNode.removeChild(n)),e.querySelector(".e-rowcell").innerHTML="";var s=document.createElement("span");s.className="errorValue",s.style.paddingLeft="16px",s.innerHTML=r,e.querySelector(".e-rowcell").appendChild(i),e.querySelector(".e-rowcell").appendChild(s);var a=document.querySelector(".e-dropitemscount");if(this.hasDropItem&&a){var o=parseInt(a.style.left,10)+i.offsetWidth+16,l=this.parent.enableRtl?0:o;a.style.left=l+"px",this.hasDropItem=!1}}},e.prototype.removeErrorElem=function(){var e=document.querySelector(".e-errorelem"),t=document.querySelector(".errorValue"),i=document.querySelector(".e-dropitemscount");if(e){if(i){var n=parseInt(i.style.left,10)-e.offsetWidth-16;Object(w["mb"])(t,{paddingLeft:"0px"}),this.parent.enableRtl||Object(w["mb"])(i,{left:n+"px"})}e.remove()}this.hasDropItem=!0},e.prototype.topOrBottomBorder=function(e){var t=[],i=Object(w["A"])(e,"tr");t=i?[].slice.call(i.querySelectorAll(".e-rowcell,.e-rowdragdrop,.e-detailrowcollapse")):[],t.length&&("topSegment"===this.dropPosition&&(this.addRemoveClasses(t,!0,"e-droptop"),this.parent.element.getElementsByClassName("e-lastrow-dragborder").length>0&&this.parent.element.getElementsByClassName("e-lastrow-dragborder")[0].remove()),"bottomSegment"===this.dropPosition&&this.addRemoveClasses(t,!0,"e-dropbottom"))},e.prototype.removetopOrBottomBorder=function(){var e=[];e=[].slice.call(this.parent.element.querySelectorAll(".e-dropbottom, .e-droptop")),e.length&&(this.addRemoveClasses(e,!1,"e-dropbottom"),this.addRemoveClasses(e,!1,"e-droptop"))},e.prototype.addRemoveClasses=function(e,t,i){for(var n=0,r=e.length;n<r;n++)t?e[n].classList.add(i):e[n].classList.remove(i)},e.prototype.getOffset=function(e){var t=e.getBoundingClientRect(),i=document.body,n=document.documentElement,r=window.pageYOffset||n.scrollTop||i.scrollTop,s=window.pageXOffset||n.scrollLeft||i.scrollLeft,a=n.clientTop||i.clientTop||0,o=n.clientLeft||i.clientLeft||0,l=t.top+r-a,d=t.left+s-o;return{top:Math.round(l),left:Math.round(d)}},e.prototype.Rowdraging=function(e){var t=this.parent,i=this.parent.element.querySelector(".e-cloneproperties");i.style.cursor="";var n=e.target?Object(w["A"])(e.target,"tr"):null,r=n?n.rowIndex:-1,s=[],a=t.getCurrentViewRecords()[r];if(this.removeErrorElem(),this.canDrop=!0,e.data[0]?s=e.data:s.push(e.data),-1!==r?this.ensuredropPosition(s,a):(this.canDrop=!1,this.addErrorElem()),!t.rowDropSettings.targetID&&this.canDrop&&t.rowDragAndDropModule.updateIcon(e.rows,r,e),t.rowDropSettings.targetID){var o=Object(j["hb"])(e.target,"e-treegrid");if(o&&o.id===this.parent.rowDropSettings.targetID){var l=o.ej2_instances[0];l.rowDragAndDropModule.updateIcon(e.rows,r,e)}}if(e.target&&Object(w["A"])(e.target,"#"+t.rowDropSettings.targetID)){o=Object(j["hb"])(e.target,"e-treegrid");o||(i.style.cursor="default")}},e.prototype.rowDropped=function(e){var t=this.parent,i="parentItem";if(t.rowDropSettings.targetID?(e.target&&Object(w["A"])(e.target,"#"+t.rowDropSettings.targetID)||Object(j["hb"])(e.target,"e-treegrid")&&Object(j["hb"])(e.target,"e-treegrid").id===t.rowDropSettings.targetID||e.target&&document.getElementById(t.rowDropSettings.targetID))&&(Object(w["ob"])("dropPosition",this.dropPosition,e),t.trigger(ke["X"],e),!e.cancel&&t.rowDropSettings.targetID&&(this.dragDropGrid(e),t.isLocalData&&(t.flatData=this.orderToIndex(t.flatData)))):Object(j["hb"])(e.target,"e-content")&&(this.parent.element.querySelector(".e-errorelem")&&(this.dropPosition="Invalid"),Object(w["ob"])("dropPosition",this.dropPosition,e),e.dropIndex=e.dropIndex===e.fromIndex?this.getTargetIdx(e.target.parentElement):e.dropIndex,t.trigger(ke["X"],e),e.cancel||(Object(Se["g"])(this.parent)||this.dropRows(e),t.isLocalData&&(t.flatData=this.orderToIndex(t.flatData)),t.grid.refresh(),Object(w["T"])(t.getHeaderContent().querySelector(".e-firstrow-border"))||t.getHeaderContent().querySelector(".e-firstrow-border").remove())),this.removetopOrBottomBorder(),this.removeChildBorder(),Object(w["T"])(this.parent.element.getElementsByClassName("e-firstrow-border")[0])?Object(w["T"])(this.parent.element.getElementsByClassName("e-lastrow-border")[0])||this.parent.element.getElementsByClassName("e-lastrow-border")[0].remove():this.parent.element.getElementsByClassName("e-firstrow-border")[0].remove(),this.parent.enableImmutableMode&&!this.parent.allowPaging&&!Object(w["T"])(e.data[0][i])){var n=this.parent.treeColumnIndex;n+=1;var r=this.parent.getPrimaryKeyFieldNames()[0],s=this.parent.grid.getRowIndexByPrimaryKey(e.data[0][r]),a=this.parent.getRows()[s],o=e.data[0];if("middleSegment"===this.dropPosition){var l=[],d=[];l.push(o),d.push(a);var c="parentUniqueID";o=Object(Se["d"])(this.parent,e.data[0][c]),s=this.parent.grid.getRowIndexByPrimaryKey(o[r]);var h=this.parent.getRows()[s];l.push(o),d.push(h);for(var p=0;p<l.length;p++)this.parent.renderModule.cellRender({data:l[p],cell:d[p].cells[n],column:this.parent.grid.getColumns()[this.parent.treeColumnIndex],requestType:"rowDragAndDrop"});var u=h.getElementsByClassName("e-treegridcollapse")[0];Object(w["T"])(u)||(Object(w["gb"])([u],"e-treegridcollapse"),Object(w["u"])([u],"e-treegridexpand"))}else this.parent.renderModule.cellRender({data:o,cell:a.cells[n],column:this.parent.grid.getColumns()[this.parent.treeColumnIndex],requestType:"rowDragAndDrop"})}},e.prototype.dragDropGrid=function(e){var t,i=this.parent,n=Object(w["A"])(e.target,"tr"),r=isNaN(this.getTargetIdx(n))?0:this.getTargetIdx(n),s=Object(j["hb"])(e.target,"e-treegrid");if(s&&s.id===this.parent.rowDropSettings.targetID&&!Object(Se["k"])(this.parent)&&!Object(Se["g"])(this.parent)){t=s.ej2_instances[0];for(var a=i.getSelectedRecords(),o=[],l=0;l<a.length;l++)o[l]=a[l].index;var d=t.dataSource;if(null!==this.parent.idMapping&&(Object(w["T"])(this.dropPosition)||"bottomSegment"===this.dropPosition||"Invalid"===this.dropPosition)&&!d.length){var c=[];for(l=0;l<a.length;l++)if(a[l].hasChildRecords){c.push(a[l]);for(var h=Object(Se["b"])(a[l]),p=0;p<h.length;p++)c.push(h[p])}c.length&&(a=c)}i.notify(ke["db"],{indexes:o,records:a}),t.notify(ke["cb"],{toIndex:r,records:a});var u=t.rowDragAndDropModule.treeGridData;if(!Object(w["T"])(u))for(l=0;l<u.length;l++)if(u[l].index=l,!Object(w["T"])(u[l].parentItem)){var m=Object(w["R"])("uniqueIDCollection."+u[l].parentUniqueID+".index",t);u[l].parentItem.index=m}i.grid.refresh(),t.grid.refresh(),t.grid.dataSource.length>1&&(t.grid.refresh(),Object(w["T"])(t.getHeaderContent().querySelector(".e-firstrow-border"))||t.getHeaderContent().querySelector(".e-firstrow-border").remove(),Object(w["T"])(t.getContent().querySelector(".e-lastrow-border"))||t.getContent().querySelector(".e-lastrow-border").remove())}Object(Se["g"])(this.parent)&&(t=s.ej2_instances[0],i.grid.refresh(),t.grid.refresh())},e.prototype.getTargetIdx=function(e){return e?parseInt(e.getAttribute("aria-rowindex"),10):0},e.prototype.getParentData=function(e,t){var i=e.parentItem,n=-1;if(this.parent.enableVirtualization&&-1!==this.parent.selectedRowIndex?n=this.parent.getSelectedRows()[0].rowIndex:-1!==this.parent.selectedRowIndex&&(n=this.parent.selectedRowIndex),"bottomSegment"===this.dropPosition){var r=this.parent.getPrimaryKeyFieldNames()[0],s=-1===n?this.parent.grid.getRowIndexByPrimaryKey(t[0][r]):this.parent.getSelectedRowIndexes()[0],a=this.parent.getCurrentViewRecords()[s];this.droppedRecord=Object(Se["d"])(this.parent,a.parentItem.uniqueID)}if("middleSegment"===this.dropPosition){var o=this.parent.getCurrentViewRecords()[n].level;o===i.level?this.droppedRecord=Object(Se["d"])(this.parent,i.uniqueID):this.getParentData(i)}},e.prototype.dropRows=function(e,t){if("Invalid"!==this.dropPosition&&!Object(Se["k"])(this.parent)){var i,n=this.parent,r=void 0;if(Object(w["T"])(e.dropIndex)){var s=this.parent.getPrimaryKeyFieldNames()[0],a=-1===n.selectedRowIndex?this.parent.grid.getRowIndexByPrimaryKey(e.data[0][s])-1:n.getSelectedRowIndexes()[0]-1,o=n.getCurrentViewRecords()[a];this.getParentData(o,e.data)}else if(e.dropIndex=e.dropIndex===e.fromIndex?this.getTargetIdx(e.target.parentElement):e.dropIndex,this.parent.enableVirtualization){var l=this.parent.getRowByIndex(e.dropIndex).rowIndex;this.droppedRecord=n.getCurrentViewRecords()[l]}else this.droppedRecord=n.getCurrentViewRecords()[e.dropIndex];var d=[];r=this.droppedRecord,e.data[0]?d=e.data:d.push(e.data),this.parent[this.modifiedRecords].push(e.data[0],r);var c=0,h=this.parent.rowDropSettings.targetID;this.isMultipleGrid=h,h?this.isaddtoBottom=h&&this.isDraggedWithChild:this.ensuredropPosition(d,r);var p=d.length;Object(w["T"])(this.parent.idMapping)||d.reverse();for(var u=function(s){if(i=d[s],m.draggedRecord=i,"Invalid"!==m.dropPosition){if(n.rowDropSettings.targetID&&!t||m.deleteDragRow(),m.draggedRecord===m.droppedRecord){var a=m.getTargetIdx(e.target.offsetParent.parentElement);isNaN(a)&&(a=m.getTargetIdx(e.target.parentElement)),e.dropIndex=a,r=m.droppedRecord=m.parent.getCurrentViewRecords()[e.dropIndex]}if(r.parentItem||"middleSegment"===m.dropPosition){var o=n.parentData,l=o.indexOf(m.draggedRecord);-1!==l&&o.splice(l,1)}var h=m.treeGridData.indexOf(r);if(m.dropAtTop(h),"bottomSegment"===m.dropPosition){if(r.hasChildRecords?(c=m.getChildCount(r,0),m.parent.parentIdMapping&&m.treeData.splice(h+c+1,0,m.draggedRecord.taskData),m.treeGridData.splice(h+c+1,0,m.draggedRecord)):(m.parent.parentIdMapping&&m.treeData.splice(h+1,0,m.draggedRecord.taskData),m.treeGridData.splice(h+1,0,m.draggedRecord)),Object(w["T"])(r.parentItem)&&(delete i.parentItem,delete i.parentUniqueID,i.level=0,m.parent.parentIdMapping&&(i[m.parent.parentIdMapping]=null)),r.parentItem){var p=m.getChildrecordsByParentID(r.parentUniqueID),u=p[0].childRecords,g=u.indexOf(r)+1;u.splice(g,0,i),i.parentItem=r.parentItem,i.parentUniqueID=r.parentUniqueID,i.level=r.level,m.parent.parentIdMapping&&(i[m.parent.parentIdMapping]=r[m.parent.parentIdMapping],i.parentItem=r.parentItem,i.level=r.level)}if(i.hasChildRecords){var f=1;m.updateChildRecordLevel(i,f),m.updateChildRecord(i,h+c+1)}}m.dropMiddle(h)}if(Object(w["T"])(i.parentItem)){o=n.parentData,l=o.indexOf(m.droppedRecord);var b=0;o.filter(function(e){i.uniqueID===e.uniqueID&&b++}),"bottomSegment"===m.dropPosition&&0===b?o.splice(l+1,0,i):"topSegment"===m.dropPosition&&0===b&&o.splice(l,0,i)}n.rowDragAndDropModule.refreshGridDataSource()},m=this,g=0;g<p;g++)u(g)}},e.prototype.dropMiddle=function(e){var t=this.parent,i=Object(Se["b"])(this.droppedRecord),n=Object(w["T"])(i)||0===i.length?e+1:i.length+e+1;"middleSegment"===this.dropPosition&&(t.parentIdMapping?(this.treeData.splice(n,0,this.draggedRecord.taskData),this.treeGridData.splice(n,0,this.draggedRecord)):this.treeGridData.splice(n,0,this.draggedRecord),this.recordLevel(),this.draggedRecord.hasChildRecords&&this.updateChildRecord(this.draggedRecord,n))},e.prototype.dropAtTop=function(e){var t=this.parent;if("topSegment"===this.dropPosition){if(t.parentIdMapping&&this.treeData.splice(e,0,this.draggedRecord.taskData),this.draggedRecord.parentItem=this.treeGridData[e].parentItem,this.draggedRecord.parentUniqueID=this.treeGridData[e].parentUniqueID,this.draggedRecord.level=this.treeGridData[e].level,this.treeGridData.splice(e,0,this.draggedRecord),this.draggedRecord.hasChildRecords){var i=1;this.updateChildRecord(this.draggedRecord,e),this.updateChildRecordLevel(this.draggedRecord,i)}if(this.droppedRecord.parentItem){var n=this.getChildrecordsByParentID(this.droppedRecord.parentUniqueID),r=n[0].childRecords,s=r.indexOf(this.droppedRecord);r.splice(s,0,this.draggedRecord)}}},e.prototype.recordLevel=function(){var e=this.parent,t=this.draggedRecord,i=this.droppedRecord,n=e.childMapping;if(i.hasChildRecords||(i.hasChildRecords=!0,i.hasFilteredChildRecords=!0,(Object(w["T"])(i.childRecords)||0===i.childRecords.length)&&(i.childRecords=[],!e.parentIdMapping&&Object(w["T"])(i.taskData[n])&&(i.taskData[n]=[]))),"middleSegment"===this.dropPosition){var r=Object(w["G"])({},i);delete r.childRecords,t.parentItem=r,t.parentUniqueID=i.uniqueID,i.childRecords.splice(i.childRecords.length,0,t);var s="isSelfReference";if(e[s]&&(i[e.childMapping]=[],i[e.childMapping].splice(i[e.childMapping].length,0,t)),Object(w["T"])(t)||e.parentIdMapping||Object(w["T"])(i.taskData[n])||i.taskData[e.childMapping].splice(i.childRecords.length,0,t.taskData),t.hasChildRecords){var a=1;t.level=i.level+1,this.updateChildRecordLevel(t,a)}else t.level=i.level+1;i.expanded=!0}},e.prototype.deleteDragRow=function(){this.parent.dataSource instanceof O["a"]&&Object(Se["j"])(this.parent)?(this.treeGridData=this.parent.grid.dataSource.dataSource.json,this.treeData=this.parent.dataSource.dataSource.json):(this.treeGridData=this.parent.grid.dataSource,this.treeData=this.parent.dataSource);var e=Object(Se["d"])(this.parent,this.draggedRecord.uniqueID);!Object(w["T"])(e.childRecords)&&e.childRecords.length&&(e.hasChildRecords=!0),this.removeRecords(e)},e.prototype.updateChildRecord=function(e,t){var i,n=this.parent,r=0;if(!e.hasChildRecords)return 0;r=e.childRecords.length;for(var s=0;s<r;s++)i=Object(w["R"])("uniqueIDCollection."+e.childRecords[s].uniqueID,n),t++,n.flatData.splice(t,0,i),Object(w["ob"])("uniqueIDCollection."+i.uniqueID,i,this.parent),n.parentIdMapping&&this.treeData.splice(t,0,i.taskData),i.hasChildRecords&&(t=this.updateChildRecord(i,t));return t},e.prototype.updateChildRecordLevel=function(e,t){var i,n=0;if(t++,!e.hasChildRecords)return 0;n=e.childRecords.length;for(var r=0;r<n;r++){i=Object(w["R"])("uniqueIDCollection."+e.childRecords[r].uniqueID,this.parent);var s=void 0;e.parentItem&&(s=Object(Se["d"])(this.parent,e.parentItem.uniqueID)),Object(w["T"])(s)&&!Object(w["T"])(e.parentItem)&&(s=e.parentItem),i.level=e.parentItem?s.level+t:e.level+1,i.hasChildRecords&&(t--,t=this.updateChildRecordLevel(i,t))}return t},e.prototype.removeRecords=function(e){var t,i=this.parent;t=this.parent.dataSource instanceof O["a"]&&Object(Se["j"])(this.parent)?this.parent.dataSource.dataSource.json:this.parent.dataSource;var n=e,r=!Object(w["T"])(i.parentIdMapping),s=this.getChildrecordsByParentID(n.parentUniqueID)[0];if(n){if(n.parentItem){var a=s?s.childRecords:[],o=0;a&&a.length>0&&(o=a.indexOf(n),s.childRecords.splice(o,1),this.parent.parentIdMapping&&!i.enableImmutableMode||Object(je["a"])({value:n,action:"delete"},this.parent,r,n.index,n.index))}if(i.parentIdMapping){n.hasChildRecords&&n.childRecords.length>0&&this.removeChildItem(n);for(var l=void 0,d=void 0,c=t,h=0;h<c.length;h++)c[h][this.parent.idMapping]===n.taskData[this.parent.idMapping]&&(l=h);for(h=0;h<this.treeGridData.length;h++)this.treeGridData[h][this.parent.idMapping]===n.taskData[this.parent.idMapping]&&(d=h);-1===l||Object(w["T"])(l)||t.splice(l,1),-1===d||Object(w["T"])(d)||this.treeGridData.splice(d,1)}var p=this.treeGridData.indexOf(n);if(!i.parentIdMapping){var u=this.parent.parentData.indexOf(n);-1!==u&&(i.parentData.splice(u,1),t.splice(u,1))}if(-1===p&&!i.parentIdMapping)for(var m=i.getPrimaryKeyFieldNames()[0],g=0;g<this.treeGridData.length;g++)this.treeGridData[g][m]===n[m]&&(p=g);if(!i.parentIdMapping){var f=this.getChildCount(n,0);this.treeGridData.splice(p,f+1)}n.parentItem&&s&&s.childRecords&&!s.childRecords.length&&(s.expanded=!1,s.hasChildRecords=!1,s.hasFilteredChildRecords=!1),-1!==this.parent[this.modifiedRecords].indexOf(s)||Object(w["T"])(s)||this.parent[this.modifiedRecords].push(s),Object(w["T"])(s)||this.updateModifiedRecords(s)}},e.prototype.updateModifiedRecords=function(e){var t=Object(Se["d"])(this.parent,e.parentUniqueID);Object(w["T"])(t)||(this.parent[this.modifiedRecords].push(t),this.updateModifiedRecords(t))},e.prototype.removeChildItem=function(e){var t,i,n,r;r=this.parent.dataSource instanceof O["a"]&&Object(Se["j"])(this.parent)?this.parent.dataSource.dataSource.json:this.parent.dataSource;for(var s=0;s<e.childRecords.length;s++){t=e.childRecords[s],!Object(w["T"])(t.childRecords)&&t.childRecords.length&&(t.hasChildRecords=!0);var a=void 0;a=this.parent.dataSource instanceof O["a"]&&Object(Se["j"])(this.parent)?this.parent.dataSource.dataSource.json:this.parent.dataSource;for(var o=0;o<a.length;o++)a[o][this.parent.idMapping]===t.taskData[this.parent.idMapping]&&(i=o);for(var l=0;l<this.treeGridData.length;l++)if(this.treeGridData[l][this.parent.idMapping]===t.taskData[this.parent.idMapping]){n=l;break}-1===i||Object(w["T"])(i)||r.splice(i,1),-1===n||Object(w["T"])(n)||this.treeGridData.splice(n,1),t.hasChildRecords&&this.removeChildItem(t)}},e.prototype.getChildCount=function(e,t){var i;if(!e.hasChildRecords)return 0;for(var n=0;n<e.childRecords.length;n++)i=e.childRecords[n],t++,i.hasChildRecords&&(t=this.getChildCount(i,t));return t},e.prototype.ensuredropPosition=function(e,t){var i=this;e.filter(function(e){if(e.hasChildRecords&&!Object(w["T"])(e.childRecords)){var n=e.childRecords.indexOf(t);if(-1!==n)return i.dropPosition="Invalid",i.addErrorElem(),void(i.canDrop=!1);i.ensuredropPosition(e.childRecords,t)}})},e.prototype.destroy=function(){this.removeEventListener()},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(ke["bb"],this.Rowdraging),this.parent.off(ke["Y"],this.rowDropped),this.parent.off(ke["cb"],this.rowsAdded),this.parent.off(ke["db"],this.rowsRemoved))},e.prototype.getModuleName=function(){return"rowDragAndDrop"},e}(),Kh=function(){function e(e){this.isTest=!1,this.updateParentRecords=[],this.isaddtoBottom=!1,this.isSharedTask=!1,this.canDrop=!0,this.parent=e,D["a"].Inject(Wh),this.parent.treeGrid.allowRowDragAndDrop=this.parent.allowRowDragAndDrop,this.bindEvents()}return e.prototype.getModuleName=function(){return"rowDragAndDrop"},e.prototype.destroy=function(){},e.prototype.bindEvents=function(){this.parent.treeGrid.rowDragStart=this.rowDragStart.bind(this),this.parent.treeGrid.rowDragStartHelper=this.rowDragStartHelper.bind(this),this.parent.treeGrid.rowDrag=this.rowDrag.bind(this),this.parent.treeGrid.rowDrop=this.rowDrop.bind(this)},e.prototype.rowDragStart=function(e){this.parent.trigger("rowDragStart",e),this.parent.element.style.position="relative"},e.prototype.addErrorElem=function(){var e=document.getElementsByClassName("e-ganttdrag")[0],t=e.querySelectorAll(".e-errorelem").length;if(!t){var i=document.createElement("div");Object(w["y"])(i,["e-errorcontainer"],[]),Object(w["y"])(i,["e-icons","e-errorelem"],[]);var n=e.querySelector(".errorValue"),r=e.querySelector(".e-rowcell").innerHTML;n&&(r=n.innerHTML,n.parentNode.removeChild(n)),e.querySelector(".e-rowcell").innerHTML="";var s=document.createElement("span");s.className="errorValue",s.style.paddingLeft="16px",s.innerHTML=r,e.querySelector(".e-rowcell").appendChild(i),e.querySelector(".e-rowcell").appendChild(s)}},e.prototype.removeErrorElem=function(){var e=document.querySelector(".e-errorelem");e&&e.remove()},e.prototype.rowDrag=function(e){var t=this.parent.element.querySelector(".e-cloneproperties");t.style.display="none";var i=t.cloneNode(!0);i.classList.add("e-ganttdrag"),i.style.display="",this.parent.element.querySelectorAll(".e-cloneproperties").length<=1?this.parent.element.appendChild(i):document.getElementsByClassName("e-cloneproperties")[0].querySelectorAll(".e-errorelem").length?this.addErrorElem():this.removeErrorElem(),"Both"===this.parent.gridLines&&Object(w["u"])(this.parent.element.querySelectorAll(".e-ganttdrag .e-rowcell"),["e-bothganttlines"]);var n=this.parent.element.querySelector(".e-ganttdrag"),r=this.parent.element.getClientRects()[0].top,s=this.parent.element.getClientRects()[0].left,a=Object(w["R"])("event",e.originalEvent).clientX-s,o=Object(w["R"])("event",e.originalEvent).clientY-r;n.style.left=a+20+"px",n.style.top=o+20+"px",this.parent.trigger("rowDrag",e)},e.prototype.rowDragStartHelper=function(e){this.parent.trigger("rowDragStartHelper",e),(this.parent.readOnly||this.parent.filterSettings.columns.length>0)&&(e.cancel=!0),"ResourceView"===this.parent.viewType&&0===Object(w["R"])("level",e.data[0])&&(e.cancel=!0)},e.prototype.rowDrop=function(e){var t=document.querySelector(".e-ganttdrag");t&&t.remove();var i=Object(w["A"])(e.target,".e-row"),n=i?parseInt(i.getAttribute("aria-rowindex"),10):e.dropIndex;e.dropIndex=n,e.dropRecord=this.parent.updatedRecords[e.dropIndex],this.parent.trigger("rowDrop",e),"ResourceView"===this.parent.viewType&&("middleSegment"===e.dropPosition&&(1!==e.dropRecord.level&&e.dropRecord.uniqueID!==Object(w["R"])("parentItem",e.data[0]).uniqueID||(e.cancel=!0)),"middleSegment"!==e.dropPosition&&(0!==e.dropRecord.level&&Object(w["R"])("parentItem",e.data[0]).uniqueID!==e.dropRecord.parentItem.uniqueID||(e.cancel=!0))),e.cancel||(e.requestType="beforeDrop",this.parent.trigger("actionBegin",e),e.cancel||(this.dropRows(e,!0),e.cancel=!0))},e.prototype.dropRows=function(e,t){if(!this.parent.readOnly){if(this.dropPosition=e.dropPosition,"Invalid"!==e.dropPosition&&this.parent.editModule){var i=this.parent,n=void 0;this.droppedRecord=i.updatedRecords[e.dropIndex];var r=[],s=this.droppedRecord;e.data[0]?r=e.data:r.push(e.data);for(var a=0,o=r.length,l=function(e){if(d.parent.isOnEdit=!0,n=r[e],d.draggedRecord=n,"Invalid"!==d.dropPosition){if("ResourceView"===d.parent.viewType&&(d.checkisSharedTask(),d.previousParent=d.draggedRecord.parentItem.uniqueID),d.isSharedTask)return{value:void 0};t&&d.deleteDragRow();var o=d.treeGridData.indexOf(s);if("topSegment"===d.dropPosition&&d.dropAtTop(o),"bottomSegment"===d.dropPosition&&!d.isSharedTask){if(s.hasChildRecords){if(a=d.parent.editModule.getChildCount(s,0),d.parent.taskFields.parentID&&d.ganttData.length>0&&d.ganttData.splice(o+a+1,0,d.draggedRecord.taskData),d.treeGridData.splice(o+a+1,0,d.draggedRecord),d.parent.ids.splice(o+a+1,0,d.draggedRecord.ganttProperties.rowUniqueID.toString()),"ResourceView"===d.parent.viewType){var l=0===d.draggedRecord.level?"R"+d.draggedRecord.ganttProperties.taskId:"T"+d.draggedRecord.ganttProperties.taskId;d.parent.getTaskIds().splice(o+a+1,0,l)}}else if(d.parent.taskFields.parentID&&d.ganttData.length>0&&d.ganttData.splice(o+1,0,d.draggedRecord.taskData),d.treeGridData.splice(o+1,0,d.draggedRecord),d.parent.ids.splice(o+1,0,d.draggedRecord.ganttProperties.rowUniqueID.toString()),"ResourceView"===d.parent.viewType){var c=0===d.draggedRecord.level?"R"+d.draggedRecord.ganttProperties.taskId:"T"+d.draggedRecord.ganttProperties.taskId;d.parent.getTaskIds().splice(o+1,0,c)}if(d.parent.setRecordValue("parentItem",d.treeGridData[o].parentItem,n),d.parent.setRecordValue("parentUniqueID",d.treeGridData[o].parentUniqueID,n),d.parent.setRecordValue("level",d.treeGridData[o].level,n),n.hasChildRecords){var h=1;d.updateChildRecordLevel(n,h),d.updateChildRecord(n,o+a+1)}if(s.parentItem){var p=d.parent.getParentTask(s.parentItem).childRecords,u=p,m=u.indexOf(s)+1;u.splice(m,0,n)}}"middleSegment"===d.dropPosition&&(d.dropMiddle(o),s.childRecords.length>0&&(delete s.ganttProperties.segments,delete s.taskData[d.parent.taskFields.segments])),Object(w["T"])(n.parentItem&&-1!==d.updateParentRecords.indexOf(n.parentItem))||d.updateParentRecords.push(n.parentItem)}if(!d.parent.enableVirtualization){var g=i.flatData,f=void 0,b=void 0,v=d.parent.dataSource,y=d.parent.taskFields.id;if(n.index<s.index){f=n.index;for(var C=function(e){var t=d.parent.currentViewData.filter(function(t){return t[y]===v[e][y]})[0];if(t.index>s.index)return b=t.index,"break"},O=0;O<v.length;O++){var T=C(O);if("break"===T)break}}else{f=s.index;for(var k=function(e){var t=d.parent.currentViewData.filter(function(t){return t[y]===v[e][y]})[0];if(t.index>n.index)return b=t.index,"break"},S=0;S<v.length;S++){var j=k(S);if("break"===j)break}}for(var R=function(e){if(!Object(w["T"])(g[e])&&(g[e].index=e,!Object(w["T"])(g[e].parentItem))){var t=g.filter(function(t){return t.uniqueID===g[e].parentUniqueID})[0];g[e].parentItem.index=t.index}},D=f;D<=b;D++)R(D)}i.rowDragAndDropModule.refreshDataSource()},d=this,c=0;c<o;c++){var h=l(c);if("object"===typeof h)return h.value}if("middleSegment"===this.dropPosition&&(s.ganttProperties.predecessor&&(this.parent.editModule.removePredecessorOnDelete(s),s.ganttProperties.predecessor=null,s.ganttProperties.predecessorsName=null,s[this.parent.taskFields.dependency]=null,s.taskData[this.parent.taskFields.dependency]=null),s.ganttProperties.isMilestone&&(this.parent.setRecordValue("isMilestone",!1,s.ganttProperties,!0),Object(w["T"])(s.taskData[this.parent.taskFields.milestone])||!0===s.taskData[this.parent.taskFields.milestone]&&(s.taskData[this.parent.taskFields.milestone]=!1))),"ResourceView"===this.parent.viewType&&!this.isSharedTask){var p=void 0;p="middleSegment"===this.dropPosition?this.droppedRecord.uniqueID:this.droppedRecord.parentItem.uniqueID;var u=this.parent.getTaskByUniqueID(p),m={};m[this.parent.taskFields.resourceInfo]=[],m[this.parent.taskFields.resourceInfo].push(u.ganttProperties.taskId),this.removeExistingResources();var g=this.parent.dataOperation.setResourceInfo(m),f=this.draggedRecord;Object(w["T"])(f.ganttProperties.resourceInfo)&&(f.ganttProperties.resourceInfo=[]),"Unassigned Task"===u.ganttProperties.taskName?(f.ganttProperties.resourceInfo=[],f.ganttProperties.sharedTaskUniqueIds=[f.ganttProperties.rowUniqueID]):f.ganttProperties.resourceInfo.push(g[0]),this.updateCurrentTask(f),"Unassigned Task"===u.ganttProperties.taskName?this.deleteSharedResourceTask():this.updateSharedResourceTask()}for(var b=0;b<this.updateParentRecords.length;b++)this.parent.dataOperation.updateParentItems(this.updateParentRecords[b]);this.updateParentRecords=[],this.parent.isOnEdit=!1}Object(w["T"])(this.parent.editModule)||this.parent.editModule.refreshRecord(e,!0)}},e.prototype.updateCurrentTask=function(e){this.parent.dataOperation.updateMappingData(e,"resourceInfo"),this.parent.editModule.updateResourceRelatedFields(e,"resource"),this.parent.editModule.dialogModule.dialogEditValidationFlag=!1,this.parent.editModule.dialogModule.validateDuration(e),this.parent.dataOperation.updateWidthLeft(e),this.parent.dataOperation.updateTaskData(e)},e.prototype.deleteSharedResourceTask=function(){for(var e=0;e<this.parent.getTaskIds().length;e++)this.parent.getTaskIds()[e]==="T"+this.draggedRecord.ganttProperties.taskId&&("Unassigned Task"!==this.parent.getTaskByUniqueID(this.parent.currentViewData[e].parentItem.uniqueID).ganttProperties.taskName&&this.removeRecords(this.parent.currentViewData[e]),Object(w["T"])(this.parent.currentViewData[e].parentItem&&-1!==this.updateParentRecords.indexOf(this.parent.currentViewData[e].parentItem))||this.updateParentRecords.push(this.parent.currentViewData[e].parentItem))},e.prototype.removeExistingResources=function(){var e=this.parent.getTaskByUniqueID(this.previousParent);if(this.draggedRecord.ganttProperties.resourceInfo)for(var t=0;t<this.draggedRecord.ganttProperties.resourceInfo.length;t++)if(this.draggedRecord.ganttProperties.resourceInfo[t][this.parent.resourceFields.id]===e.ganttProperties.taskId){this.draggedRecord.ganttProperties.resourceInfo.splice(t,1);break}},e.prototype.updateSharedResourceTask=function(){for(var e=0;e<this.parent.getTaskIds().length;e++)this.parent.getTaskIds()[e]==="T"+this.draggedRecord.ganttProperties.taskId&&(this.parent.editModule.updateGanttProperties(this.draggedRecord,this.parent.flatData[e]),this.parent.dataOperation.updateTaskData(this.parent.flatData[e]),Object(w["T"])(this.parent.flatData[e].parentItem&&-1!==this.updateParentRecords.indexOf(this.parent.currentViewData[e].parentItem))||this.updateParentRecords.push(this.parent.flatData[e].parentItem))},e.prototype._getExistingTaskWithID=function(e){for(var t=[],i=0;i<this.parent.getTaskIds().length;i++)this.parent.getTaskIds()[i]==="T"+e.ganttProperties.taskId&&t.push(this.parent.flatData[i]);return t},e.prototype.removeResourceInfo=function(e){var t=this.parent.getTaskByUniqueID(this.draggedRecord.parentItem.uniqueID);if(e.ganttProperties.resourceInfo&&e.ganttProperties.resourceInfo.length>1){var i=this._getExistingTaskWithID(e),n=void 0;if(null==i)return;for(var r=0;r<i.length;r++){n=i[r];for(var s=n.ganttProperties.resourceInfo,a=0;a<s.length;a++)if(s[a][this.parent.resourceFields.id]===t.ganttProperties.taskId){s.splice(a,1),this.parent.setRecordValue("resourceInfo",s,n.ganttProperties,!0),this.updateCurrentTask(n),Object(w["T"])(n.parentItem&&-1!==this.updateParentRecords.indexOf(n.parentItem))||this.updateParentRecords.push(n.parentItem);break}}}},e.prototype.refreshDataSource=function(){var e,t,i=this.draggedRecord,n=this.droppedRecord,r=this.parent,s=this.parent.taskFields;if(e=this.parent.dataSource instanceof O["a"]?Object(w["R"])("dataOperation.dataArray",this.parent):r.dataSource,e.length>0&&!Object(w["T"])(n)&&!n.parentItem){for(var a=0;a<Object.keys(e).length;a++)Object(w["T"])(n.taskData[s.child])||e[a][s.child]!==n.taskData[s.child]?Object(w["T"])(n.taskData[s.child])&&n.taskData[s.id]===e[a][s.id]&&(t=a):t=a;"topSegment"===this.dropPosition?this.parent.taskFields.parentID||e.splice(t,0,i.taskData):"bottomSegment"===this.dropPosition&&(this.parent.taskFields.parentID||e.splice(t+1,0,i.taskData))}else if(!this.parent.taskFields.parentID&&!Object(w["T"])(n)&&n.parentItem&&("topSegment"===this.dropPosition||"bottomSegment"===this.dropPosition)){var o="topSegment"===this.dropPosition?"Above":"Below";this.parent.editModule.addRowSelectedItem=n,this.parent.editModule.updateRealDataSource([i],o),delete this.parent.editModule.addRowSelectedItem}if(this.parent.taskFields.parentID)if(i.parentItem){var l="middleSegment"===this.dropPosition?this.parent.taskFields.id:this.parent.taskFields.parentID;i[this.parent.taskFields.parentID]=n[l],i.ganttProperties.parentId=n[l],("ResourceView"===this.parent.viewType&&"middleSegment"!==this.dropPosition||"ProjectView"===this.parent.viewType)&&(i.taskData[this.parent.taskFields.parentID]=n.taskData[l])}else i[this.parent.taskFields.parentID]=null,i.taskData[this.parent.taskFields.parentID]=null,i.ganttProperties.parentId=null},e.prototype.dropMiddle=function(e){var t=this.parent,i=this.parent.editModule.getChildCount(this.droppedRecord,0),n=Object(w["T"])(i)||0===i?e+1:i+e+1;if("middleSegment"===this.dropPosition&&!this.isSharedTask){if(t.taskFields.parentID&&this.ganttData.length>0&&this.ganttData.splice(n,0,this.draggedRecord.taskData),this.treeGridData.splice(n,0,this.draggedRecord),this.parent.ids.splice(n,0,this.draggedRecord.ganttProperties.rowUniqueID.toString()),"ResourceView"===this.parent.viewType){var r=0===this.draggedRecord.level?"R"+this.draggedRecord.ganttProperties.taskId:"T"+this.draggedRecord.ganttProperties.taskId;this.parent.getTaskIds().splice(n,0,r)}this.draggedRecord.hasChildRecords&&this.updateChildRecord(this.draggedRecord,n,this.droppedRecord.expanded),this.recordLevel(),Object(w["T"])(this.draggedRecord.parentItem&&-1!==this.updateParentRecords.indexOf(this.draggedRecord.parentItem))&&this.updateParentRecords.push(this.draggedRecord.parentItem)}},e.prototype.recordLevel=function(){var e=this.parent,t=this.draggedRecord,i=this.droppedRecord,n=e.taskFields.child;if(i.hasChildRecords||(i.hasChildRecords=!0,i.childRecords.length||(i.childRecords=[],!e.taskFields.parentID&&Object(w["T"])(i.taskData[n])&&(i.taskData[n]=[]))),"middleSegment"===this.dropPosition){var r=Object(w["G"])({},i);delete r.childRecords;var s={uniqueID:r.uniqueID,expanded:r.expanded,level:r.level,index:r.index,taskId:r.ganttProperties.rowUniqueID};if(this.parent.setRecordValue("parentItem",s,t),this.parent.setRecordValue("parentUniqueID",i.uniqueID,t),i.childRecords.splice(i.childRecords.length,0,t),Object(w["T"])(t)||e.taskFields.parentID||Object(w["T"])(i.taskData[n])||i.taskData[e.taskFields.child].splice(i.childRecords.length,0,t.taskData),t.hasChildRecords){var a=1;t.level=i.level+1,this.parent.setRecordValue("level",this.draggedRecord.level,this.draggedRecord),this.updateChildRecordLevel(t,a)}else t.level=i.level+1;i.expanded=!0}},e.prototype.deleteDragRow=function(){this.treeGridData=Object(R["f"])(this.parent)?Object(w["R"])("result",this.parent.treeGrid.dataSource):this.parent.treeGrid.dataSource,this.parent.dataSource instanceof O["a"]?this.ganttData=Object(w["R"])("dataOperation.dataArray",this.parent):this.ganttData=Object(R["f"])(this.parent)?Object(w["R"])("result",this.parent.dataSource):this.parent.dataSource;var e=this.parent.getTaskByUniqueID(this.draggedRecord.uniqueID);this.removeRecords(e)},e.prototype.checkisSharedTask=function(){this.isSharedTask=!1;for(var e=null,t=0===this.droppedRecord.level?this.droppedRecord.uniqueID:this.droppedRecord.parentItem.uniqueID,i=this.parent.getTaskByUniqueID(t),n=i.childRecords,r=0;r<n.length;r++)"T"+this.draggedRecord.ganttProperties.taskId==="T"+n[r].ganttProperties.taskId&&(this.isSharedTask=!0,e=n[r]);this.isSharedTask&&this.removeResourceInfo(e)},e.prototype.dropAtTop=function(e){var t=this.parent;if(!this.isSharedTask){if(t.taskFields.parentID&&this.ganttData.length>0&&this.ganttData.splice(e,0,this.draggedRecord.taskData),this.treeGridData.splice(e,0,this.draggedRecord),this.parent.ids.splice(e,0,this.draggedRecord.ganttProperties.rowUniqueID.toString()),this.parent.setRecordValue("parentItem",this.droppedRecord.parentItem,this.draggedRecord),this.parent.setRecordValue("parentUniqueID",this.droppedRecord.parentUniqueID,this.draggedRecord),this.parent.setRecordValue("level",this.droppedRecord.level,this.draggedRecord),"ResourceView"===this.parent.viewType){var i=0===this.draggedRecord.level?"R"+this.draggedRecord.ganttProperties.taskId:"T"+this.draggedRecord.ganttProperties.taskId;this.parent.getTaskIds().splice(e,0,i)}if(this.draggedRecord.hasChildRecords){var n=1;this.updateChildRecord(this.draggedRecord,e),this.updateChildRecordLevel(this.draggedRecord,n)}if(this.droppedRecord.parentItem){var r=this.parent.getParentTask(this.droppedRecord.parentItem).childRecords,s=r,a=s.indexOf(this.droppedRecord);s.splice(a,0,this.draggedRecord)}Object(w["T"])(this.draggedRecord.parentItem&&-1!==this.updateParentRecords.indexOf(this.draggedRecord.parentItem))||this.updateParentRecords.push(this.draggedRecord.parentItem)}},e.prototype.updateChildRecordLevel=function(e,t){var i,n=0;if(t++,!e.hasChildRecords)return 0;n=e.childRecords.length;for(var r=0;r<n;r++){i=e.childRecords[r];var s=void 0;if(e.parentItem){var a="uniqueIDCollection";s=this.parent.treeGrid[a][e.parentItem.uniqueID]}i.level=e.parentItem?s.level+t:e.level+1,this.parent.setRecordValue("level",i.level,i),i.hasChildRecords&&(t--,t=this.updateChildRecordLevel(i,t))}return t},e.prototype.updateChildRecord=function(e,t,i){var n,r=this.parent,s=0;if(!e.hasChildRecords)return 0;s=e.childRecords.length;for(var a=0;a<s;a++)n=e.childRecords[a],t++,r.flatData.splice(t,0,n),this.parent.ids.splice(t,0,n.ganttProperties.rowUniqueID.toString()),r.taskFields.parentID&&r.dataSource.length>0&&this.ganttData.splice(t,0,n.taskData),n.hasChildRecords&&(t=this.updateChildRecord(n,t));return t},e.prototype.removeRecords=function(e){var t,i=this.parent;t=this.parent.dataSource instanceof O["a"]?Object(w["R"])("dataOperation.dataArray",this.parent):this.parent.dataSource;var n=e,r=this.parent.getParentTask(n.parentItem);if(n){if(n.parentItem){var s=r?r.childRecords:[],a=0;s&&s.length>0&&("ResourceView"===this.parent.viewType&&1===s.length&&(this.parent.isOnDelete=!0,s[0].isDelete=!0,this.parent.dataOperation.updateParentItems(r),this.parent.isOnDelete=!1,s[0].isDelete=!1),a=s.indexOf(n),r.childRecords.splice(a,1),!this.parent.taskFields.parentID&&r.taskData[this.parent.taskFields.child]&&r.taskData[this.parent.taskFields.child].splice(a,1),this.updateParentRecords.push(r))}if(!this.parent.taskFields.parentID){var o=[];o.push(n.ganttProperties.taskId.toString()),("ProjectView"===this.parent.viewType||"ResourceView"===this.parent.viewType&&"middleSegment"!==this.dropPosition)&&this.parent.editModule.removeFromDataSource(o)}if(i.taskFields.parentID){n.hasChildRecords&&n.childRecords.length>0&&this.removeChildItem(n);for(var l=void 0,d=t.length>0&&"ResourceView"!==this.parent.viewType?t:this.parent.updatedRecords,c=0;c<d.length;c++)"ResourceView"===this.parent.viewType?d[c].ganttProperties.rowUniqueID===n.ganttProperties.rowUniqueID&&(l=c):d[c][this.parent.taskFields.id]===n.taskData[this.parent.taskFields.id]&&(l=c);if(-1!==l){t.length>0&&t.splice(l,1);var h=this.treeGridData.indexOf(n);this.treeGridData.splice(h,1),this.parent.ids.splice(h,1),-1!==this.parent.treeGrid.parentData.indexOf(n)&&this.parent.treeGrid.parentData.splice(this.parent.treeGrid.parentData.indexOf(n),1),"ResourceView"===this.parent.viewType&&this.parent.getTaskIds().splice(l,1)}}var p=this.treeGridData.indexOf(n);if(!i.taskFields.parentID){var u=this.parent.editModule.getChildCount(n,0);this.treeGridData.splice(p,u+1),this.parent.ids.splice(p,u+1);var m=this.ganttData.indexOf(n.taskData);-1!==m&&(this.ganttData.splice(m,1),this.parent.treeGrid.parentData.splice(m,1)),"ResourceView"===this.parent.viewType&&this.parent.getTaskIds().splice(p,u+1)}n.parentItem&&r&&r.childRecords&&!r.childRecords.length&&(r.expanded=!1,r.hasChildRecords=!1)}},e.prototype.removeChildItem=function(e){for(var t,i,n=0;n<e.childRecords.length;n++){t=e.childRecords[n];var r=void 0;r=this.parent.dataSource instanceof O["a"]?Object(w["R"])("dataOperation.dataArray",this.parent):this.parent.dataSource;for(var s=0;s<r.length;s++)r[s][this.parent.taskFields.id]===t.taskData[this.parent.taskFields.id]&&(i=s);if(-1!==i){r.length>0&&r.splice(i,1);var a=this.treeGridData.indexOf(t);this.treeGridData.splice(a,1),this.parent.ids.splice(a,1),"ResourceView"===this.parent.viewType&&this.parent.getTaskIds().splice(i,1)}t.hasChildRecords&&this.removeChildItem(t)}},e.prototype.reorderRows=function(e,t,i){if(!this.parent.readOnly){e[0],"above"===i&&(this.dropPosition="topSegment"),"below"===i&&(this.dropPosition="bottomSegment"),"child"===i&&(this.dropPosition="middleSegment");for(var n=[],r=0;r<e.length;r++)n[r]=this.parent.updatedRecords[e[r]];var s=!0,a={data:n,dropIndex:t,dropPosition:this.dropPosition};this.dropRows(a,s)}},e}(),$h=i("7fdb"),Xh=i("d515"),Jh=i("ece1"),Qh=i("70ea"),Yh=i("7897"),Zh=i("506d"),ep=i("7ddb"),tp=i("b866"),ip=i("a583"),np=i("db21"),rp=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),sp=function(e,t,i,n){var r,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var o=e.length-1;o>=0;o--)(r=e[o])&&(a=(s<3?r(a):s>3?r(t,i,a):r(t,i))||a);return s>3&&a&&Object.defineProperty(t,i,a),a},ap=["isLazyUpdate","plugins","allowEdit","calendarMode","cssClass","dayHeaderFormat","depth","enableMask","enablePersistence","enableRtl","enabled","firstDayOfWeek","floatLabelType","format","htmlAttributes","isMultiSelection","keyConfigs","locale","maskPlaceholder","max","min","openOnFocus","placeholder","readonly","serverTimezoneOffset","showClearButton","showTodayButton","start","strictMode","value","values","weekNumber","weekRule","width","zIndex","blur","change","cleared","close","created","destroyed","focus","navigated","open","renderDayCell"],op=["value"],lp=Object(np["d"])({props:ap}),dp=(lp[0],lp[1]),cp=Object.keys(dp);cp.push("modelchanged");for(var hp=0,pp=op;hp<pp.length;hp++){var up=pp[hp];cp.push("update:"+up)}var mp,gp,fp,bp=!np["e"],vp=function(e){function t(){var t=e.call(this,arguments)||this;return t.propKeys=ap,t.models=op,t.hasChildDirective=!1,t.hasInjectedModules=!0,t.tagMapper={},t.tagNameMapper={},t.isVue3=!bp,t.ej2Instances=new pe["a"]({}),t.ej2Instances._trigger=t.ej2Instances.trigger,t.ej2Instances.trigger=t.trigger,t.bindProperties(),t.ej2Instances._setProperties=t.ej2Instances.setProperties,t.ej2Instances.setProperties=t.setProperties,t.ej2Instances.clearTemplate=t.clearTemplate,t.updated=t.updated,t}return rp(t,e),t.prototype.clearTemplate=function(e){if(e||(e=Object.keys(this.templateCollection||{})),e.length&&this.templateCollection)for(var t=0,i=e;t<i.length;t++){var n=i[t],r=this.templateCollection[n];if(r&&r.length){for(var s=0,a=r;s<a.length;s++){var o=a[s],l=Object(w["R"])("__vue__.$destroy",o);l&&o.__vue__.$destroy(),o.innerHTML&&(o.innerHTML="")}delete this.templateCollection[n]}}},t.prototype.setProperties=function(e,t){var i=this;this.isVue3&&(this.models=this.models?this.models:this.ej2Instances.referModels),this.ej2Instances&&this.ej2Instances._setProperties&&this.ej2Instances._setProperties(e,t),e&&this.models&&this.models.length&&Object.keys(e).map(function(t){i.models.map(function(n){t!==n||/datasource/i.test(t)||(i.isVue3?i.ej2Instances.vueInstance.$emit("update:"+t,e[t]):(i.$emit("update:"+t,e[t]),i.$emit("modelchanged",e[t])))})})},t.prototype.trigger=function(e,t,i){if(bp||(this.models=this.models?this.models:this.ej2Instances.referModels),"change"!==e&&"input"!==e||!this.models||0===this.models.length){if("actionBegin"===e&&"dateNavigate"===t.requestType&&this.models&&0!==this.models.length){n=this.models.toString().match(/currentView|selectedDate/)||[],r=n[0];t&&n&&!Object(w["X"])(t[r])&&(bp?(this.$emit("update:"+r,t[r]),this.$emit("modelchanged",t[r])):(this.ej2Instances.vueInstance.$emit("update:"+r,t[r]),this.ej2Instances.vueInstance.$emit("modelchanged",t[r])))}}else{var n=this.models.toString().match(/checked|value/)||[],r=n[0];t&&n&&!Object(w["X"])(t[r])&&(bp?("change"===e||this.$props&&!this.$props.isLazyUpdate)&&(this.$emit("update:"+r,t[r]),this.$emit("modelchanged",t[r])):(this.ej2Instances.vueInstance.$emit("update:"+r,t[r]),this.ej2Instances.vueInstance.$emit("modelchanged",t[r]),this.ej2Instances.vueInstance.$emit("update:modelValue",t[r])))}this.ej2Instances&&this.ej2Instances._trigger&&this.ej2Instances._trigger(e,t,i)},t.prototype.render=function(e){var t=np["e"]||e,i=null;return Object(w["T"])(this.$slots.default)||(i=np["e"]?this.$slots.default():this.$slots.default),t("input",i)},t.prototype.custom=function(){this.updated()},t.prototype.addDate=function(e){return this.ej2Instances.addDate(e)},t.prototype.createContent=function(){return this.ej2Instances.createContent()},t.prototype.currentView=function(){return this.ej2Instances.currentView()},t.prototype.focusIn=function(e){return this.ej2Instances.focusIn(e)},t.prototype.focusOut=function(){return this.ej2Instances.focusOut()},t.prototype.hide=function(e){return this.ej2Instances.hide(e)},t.prototype.navigateTo=function(e,t){return this.ej2Instances.navigateTo(e,t)},t.prototype.removeDate=function(e){return this.ej2Instances.removeDate(e)},t.prototype.requiredModules=function(){return this.ej2Instances.requiredModules()},t.prototype.show=function(e,t){return this.ej2Instances.show(e,t)},t=sp([Object(np["b"])({props:ap,model:{event:"modelchanged"}},bp)],t),t}(np["a"]);b["default"].use(C["a"]);var yp={name:"gantt",data:function(){var e=this;return{isTouchDevice:!1,translateURL:"about:blank",alertModalMessage:"",alertModalSize:"md",confirmModalFunction:function(){},confirmModalMessage:"",confirmModalSize:"md",confirmModalParam1:"",confirmModalParam2:"",confirmModalNavigationGuard:!1,confirmModalCancelFunction:void 0,promptModalFunction:function(){},promptModalMessage:"",promptModalSize:"md",promptModalParam1:"",exportOption:{pdf:!0,header:"None",footer:"Powered by: onlinegantt.com",columns:"Task ID and Task Name",timeline:"Zoom to fit",expandCollapse:"Expand All",resolution:1,sort:"None"},addingTask:!1,selectTime:0,refresh:!1,refreshData:[],refreshSplitter:!1,refreshSplitterPosition:0,collapsedTasks:[],debugText:"",subscribed:!0,trial:!0,reinitializeGantt:!1,allDisabled:!1,sectionDisabled:!1,moreDisabled:!1,currentUser:{cognitoUser:null,email:"",role:"",company:"",token:""},permissionUserList:[],userList:[],adminAdvancedUserList:[],guestUserList:[],userSelected:"",userIndex:0,allProjectNames:[],dbProjectList:[],projectSelectionOptions:[],projectSelected:"",undoProjectChanged:"",projectName:"",revisionNotes:"",exportPdf:!1,exportImage:!1,importExcel:!1,revisionItems:[],revisionFields:{timestamp:{label:"Date",thStyle:{width:"200px"}},author:{label:"Author",thStyle:{width:"200px"}},revision_note:{label:"Revision Notes",thStyle:{width:"500px"}},id:{label:"",thStyle:{minWidth:"100px",width:"100px"}}},revisionCurrentPage:1,revisionPerPage:50,columnTableFields:{name:{label:"",thStyle:{width:"200px"}},width:{label:"Width",thStyle:{width:"100px"}},show:{label:"Show/Hide",thStyle:{width:"100px"}}},publicLinkSelect:0,permissionItems:[],permissionFields:{email:{label:"User",thStyle:{width:"500px"}},access:{label:"Access",thStyle:{width:"500px"}},id:{label:"",thStyle:{width:"50px"},thClass:"x-left-of-hidden-column",tdClass:"x-left-of-hidden-column"},x:{label:"",thClass:"x-hidden-column",tdClass:"x-hidden-column"}},holidayItems:[],holidayFields:{from:{label:"From"},to:{label:"To"}},workTimeItems:[{from:8,to:12},{from:13,to:17}],workTimeFields:{from:{label:"From"},to:{label:"To"}},workTimeOptions:[],workTime24HourOptions:[{value:-1,text:""},{value:0,text:"00:00"},{value:.5,text:"00:30"},{value:1,text:"01:00"},{value:1.5,text:"01:30"},{value:2,text:"02:00"},{value:2.5,text:"02:30"},{value:3,text:"03:00"},{value:3.5,text:"03:30"},{value:4,text:"04:00"},{value:4.5,text:"04:30"},{value:5,text:"05:00"},{value:5.5,text:"05:30"},{value:6,text:"06:00"},{value:6.5,text:"06:30"},{value:7,text:"07:00"},{value:7.5,text:"07:30"},{value:8,text:"08:00"},{value:8.5,text:"08:30"},{value:9,text:"09:00"},{value:9.5,text:"09:30"},{value:10,text:"10:00"},{value:10.5,text:"10:30"},{value:11,text:"11:00"},{value:11.5,text:"11:30"},{value:12,text:"12:00"},{value:12.5,text:"12:30"},{value:13,text:"13:00"},{value:13.5,text:"13:30"},{value:14,text:"14:00"},{value:14.5,text:"14:30"},{value:15,text:"15:00"},{value:15.5,text:"15:30"},{value:16,text:"16:00"},{value:16.5,text:"16:30"},{value:17,text:"17:00"},{value:17.5,text:"17:30"},{value:18,text:"18:00"},{value:18.5,text:"18:30"},{value:19,text:"19:00"},{value:19.5,text:"19:30"},{value:20,text:"20:00"},{value:20.5,text:"20:30"},{value:21,text:"21:00"},{value:21.5,text:"21:30"},{value:22,text:"22:00"},{value:22.5,text:"22:30"},{value:23,text:"23:00"},{value:23.5,text:"23:30"}],workTime12HourOptions:[{value:-1,text:""},{value:0,text:"12:00 AM"},{value:.5,text:"12:30 AM"},{value:1,text:"01:00 AM"},{value:1.5,text:"01:30 AM"},{value:2,text:"02:00 AM"},{value:2.5,text:"02:30 AM"},{value:3,text:"03:00 AM"},{value:3.5,text:"03:30 AM"},{value:4,text:"04:00 AM"},{value:4.5,text:"04:30 AM"},{value:5,text:"05:00 AM"},{value:5.5,text:"05:30 AM"},{value:6,text:"06:00 AM"},{value:6.5,text:"06:30 AM"},{value:7,text:"07:00 AM"},{value:7.5,text:"07:30 AM"},{value:8,text:"08:00 AM"},{value:8.5,text:"08:30 AM"},{value:9,text:"09:00 AM"},{value:9.5,text:"09:30 AM"},{value:10,text:"10:00 AM"},{value:10.5,text:"10:30 AM"},{value:11,text:"11:00 AM"},{value:11.5,text:"11:30 AM"},{value:12,text:"12:00 PM"},{value:12.5,text:"12:30 PM"},{value:13,text:"01:00 PM"},{value:13.5,text:"01:30 PM"},{value:14,text:"02:00 PM"},{value:14.5,text:"02:30 PM"},{value:15,text:"03:00 PM"},{value:15.5,text:"03:30 PM"},{value:16,text:"04:00 PM"},{value:16.5,text:"04:30 PM"},{value:17,text:"05:00 PM"},{value:17.5,text:"05:30 PM"},{value:18,text:"06:00 PM"},{value:18.5,text:"06:30 PM"},{value:19,text:"07:00 PM"},{value:19.5,text:"07:30 PM"},{value:20,text:"08:00 PM"},{value:20.5,text:"08:30 PM"},{value:21,text:"09:00 PM"},{value:21.5,text:"09:30 PM"},{value:22,text:"10:00 PM"},{value:22.5,text:"10:30 PM"},{value:23,text:"11:00 PM"},{value:23.5,text:"11:30 PM"}],resourceListItems:[],resourceListFields:{resourceName:{label:"Resources"}},viewOptions:[{value:"Project View",text:"Project View"},{value:"Resource View",text:"Resource View"},{value:"Edit Resources",text:"Edit Resources"},{value:"Edit Settings",text:"Edit Settings"},{value:"Share",text:"Share"},{value:"Revisions",text:"Revisions"}],viewSelected:"Project View",presetFilterOptions:[{value:"All Tasks",text:"All Tasks"},{value:"Remaining Tasks",text:"Remaining Tasks"},{value:"Overdue Tasks",text:"Overdue Tasks"}],presetFilterSelected:"All Tasks",alertMessage:{show:0,variant:"success",message:""},ganttHeight:"300",showGantt:!0,showGrid:!0,parentUpdateTaskId:0,resourceUpdateString:"",resourceUpdateCount:0,indentTask:0,currentView:"Gantt",dbProjectName:"",dbData:[],dbResources:[],dbAdvanced:{columns:[{name:"Task ID",width:"70",show:!0},{name:"Task Name",width:"350",show:!0},{name:"Start Date",width:"130",show:!1},{name:"End Date",width:"130",show:!1},{name:"Duration",width:"130",show:!1},{name:"Progress %",width:"150",show:!1},{name:"Dependency",width:"150",show:!1},{name:"Resources",width:"200",show:!1},{name:"Color",width:"100",show:!1}],zoomLevel:0,timezone:"",timezoneOffset:0,dependencyConflict:"Add Offset to Dependency",dateFormat:"yyyy-MM-dd",timeFormat:"HH:mm",firstDayOfWeek:0,workWeek:["Monday","Tuesday","Wednesday","Thursday","Friday"],workTime:[{from:8,to:12},{from:13,to:17}],holidays:[]},dbPermissions:[],permissions:[],advanced:{columns:document.documentElement.clientWidth>1e3?[{name:"Task ID",width:"70",show:!0},{name:"Task Name",width:"350",show:!0},{name:"Start Date",width:"130",show:!1},{name:"End Date",width:"130",show:!1},{name:"Duration",width:"130",show:!1},{name:"Progress %",width:"150",show:!1},{name:"Dependency",width:"150",show:!1},{name:"Resources",width:"200",show:!1},{name:"Color",width:"100",show:!1}]:[{name:"Task ID",width:"70",show:!1},{name:"Task Name",width:"200",show:!0},{name:"Start Date",width:"130",show:!1},{name:"End Date",width:"130",show:!1},{name:"Duration",width:"130",show:!1},{name:"Progress %",width:"150",show:!1},{name:"Dependency",width:"150",show:!1},{name:"Resources",width:"200",show:!1},{name:"Color",width:"100",show:!1}],zoomLevel:0,timezone:"",timezoneOffset:0,dependencyConflict:"Add Offset to Dependency",dateFormat:"yyyy-MM-dd",timeFormat:"HH:mm",firstDayOfWeek:0,workWeek:["Monday","Tuesday","Wednesday","Thursday","Friday"],workTime:[{from:8,to:12},{from:13,to:17}],holidays:[]},data:[{TaskID:1,TaskName:"Example",StartDate:this.getMondayDateString(0,8),EndDate:this.getMondayDateString(18,17),Duration:15,Predecessor:null,resources:[],Progress:50,color:"",info:"<p><br></p>",DurationUnit:"day",subtasks:[{TaskID:2,TaskName:"Example Task 1",StartDate:this.getMondayDateString(0,8),EndDate:this.getMondayDateString(4,17),Duration:5,Predecessor:"",resources:[{resourceId:"Team Member 1",resourceName:"Team Member 1",unit:100}],Progress:80,color:"121",info:"<p><br></p>",DurationUnit:"day"},{TaskID:3,TaskName:"Example Task 2",StartDate:this.getMondayDateString(7,8),EndDate:this.getMondayDateString(11,17),Duration:5,Predecessor:"2FS",resources:[{resourceId:"Team Member 2",resourceName:"Team Member 2",unit:100}],Progress:50,color:"211",info:"<p><br></p>",DurationUnit:"day"},{TaskID:4,TaskName:"Example Task 3",StartDate:this.getMondayDateString(14,8),EndDate:this.getMondayDateString(18,17),Duration:5,Predecessor:"3FS",resources:[{resourceId:"Team Member 3",resourceName:"Team Member 3",unit:100}],Progress:20,color:"301",info:"<p><br></p>",DurationUnit:"day"},{TaskID:5,TaskName:"Example Milestone",StartDate:this.getMondayDateString(18,17),EndDate:this.getMondayDateString(18,17),Duration:0,Predecessor:"4FS",resources:[{resourceId:"Team Member 3",resourceName:"Team Member 3",unit:100}],Progress:0,color:"",info:"<p><br></p>",DurationUnit:"day"}]}],resources:[{resourceId:"Team Member 1",resourceName:"Team Member 1"},{resourceId:"Team Member 2",resourceName:"Team Member 2"},{resourceId:"Team Member 3",resourceName:"Team Member 3"}],projectStartDate:null,projectEndDate:null,contextMenuItemsReadWrite:["AutoFitAll","AutoFit","SortAscending","SortDescending","TaskInformation","DeleteTask",{text:"Add Task",target:".e-content",id:"customaddtask",iconCss:"e-icons e-add",items:[{text:"Above this row",target:".e-content",id:"customaddtaskabove"},{text:"Below this row",target:".e-content",id:"customaddtaskbelow"},{text:"Subtask",target:".e-content",id:"customaddtasksub"},{text:"Milestone",target:".e-content",id:"customaddtaskmilestone"}]},{text:"Duplicate Task",target:".e-content",id:"duplicatetask"},"DeleteDependency","Convert"],contextMenuItemsReadOnly:["AutoFitAll","AutoFit","SortAscending","SortDescending","TaskInformation"],contextMenuItems:["AutoFitAll","AutoFit","SortAscending","SortDescending","TaskInformation","DeleteTask",{text:"Add Task",target:".e-content",id:"customaddtask",iconCss:"e-icons e-add",items:[{text:"Above this row",target:".e-content",id:"customaddtaskabove"},{text:"Below this row",target:".e-content",id:"customaddtaskbelow"},{text:"Subtask",target:".e-content",id:"customaddtasksub"},{text:"Milestone",target:".e-content",id:"customaddtaskmilestone"}]},{text:"Duplicate Task",target:".e-content",id:"duplicatetask"},"DeleteDependency","Convert"],viewType:"ProjectView",dateFormat:"yyyy-MM-dd",taskFields:{id:"TaskID",name:"TaskName",startDate:"StartDate",endDate:"EndDate",duration:"Duration",durationUnit:"DurationUnit",progress:"Progress",dependency:"Predecessor",child:"subtasks",notes:"info",resourceInfo:"resources",color:"color"},editSettings:{allowAdding:!0,allowEditing:!0,allowDeleting:!0,allowTaskbarEditing:!0,showDeleteConfirmDialog:!0,newRowPosition:"Bottom"},toolbar:["Add","Edit","Delete","Indent","Outdent","ExpandAll","CollapseAll","ZoomIn","ZoomOut","ZoomToFit","Search"],gridLines:"Both",resourceFields:{id:"resourceId",name:"resourceName"},highlightWeekends:!0,timelineSettings:{topTier:{unit:"Week",format:"yyyy-MM-dd"},bottomTier:{unit:"Day",format:"d"},weekStartDay:0},IDNameColumns:[{field:"TaskID",width:"70"},{field:"TaskName",width:"350",headerText:"Task Name",clipMode:"EllipsisWithTooltip"},{field:"StartDate",width:"130",headerText:"Start"},{field:"EndDate",width:"130",headerText:"End"},{field:"Duration",width:"130"},{field:"Progress",width:"150",headerText:"Progress %"},{field:"Predecessor",width:"150"},{field:"resources",width:"200",headerText:"Resources",clipMode:"EllipsisWithTooltip"},{field:"color",width:"100",headerText:"Color",editType:"dropdownedit",edit:{create:function(){return mp=document.createElement("input"),mp},read:function(){return gp.value},destroy:function(){gp.destroy()},write:function(){gp=new U["a"]({dataSource:[{color:""},{color:"31"},{color:"61"},{color:"91"},{color:"121"},{color:"151"},{color:"181"},{color:"211"},{color:"241"},{color:"271"},{color:"301"},{color:"331"}],fields:{value:"color"},valueTemplate:'<div style="width:100%;height:100%;">&nbsp;&nbsp;&nbsp;&nbsp;<img style="margin-top:1px;" src="img/color/color${color}.png" height="26px" width="26px"/></div>',itemTemplate:'<div style="width:100%;height:100%;"><img src="img/color/color${color}.png" height="26px" width="26px"/></div>',floatLabelType:"Always",placeholder:"Color"}),gp.value=fp,gp.appendTo(mp)}},template:'<div style="width:100%;height:100%;"><img src="img/color/color${color}.png" height="26px" width="26px"/></div>'}],columns:document.documentElement.clientWidth>1e3?[{field:"TaskID",width:"70"},{field:"TaskName",width:"350",headerText:"Task Name",clipMode:"EllipsisWithTooltip"},{field:"StartDate",width:"130",headerText:"Start"},{field:"EndDate",width:"130",headerText:"End"},{field:"Duration",width:"130"},{field:"Progress",width:"150",headerText:"Progress %"},{field:"Predecessor",width:"150"},{field:"resources",width:"200",headerText:"Resources",clipMode:"EllipsisWithTooltip"},{field:"color",width:"100",headerText:"Color",editType:"dropdownedit",edit:{create:function(){return mp=document.createElement("input"),mp},read:function(){return gp.value},destroy:function(){gp.destroy()},write:function(){gp=new U["a"]({dataSource:[{color:""},{color:"31"},{color:"61"},{color:"91"},{color:"121"},{color:"151"},{color:"181"},{color:"211"},{color:"241"},{color:"271"},{color:"301"},{color:"331"}],fields:{value:"color"},valueTemplate:'<div style="width:100%;height:100%;">&nbsp;&nbsp;&nbsp;&nbsp;<img style="margin-top:1px;" src="img/color/color${color}.png" height="26px" width="26px"/></div>',itemTemplate:'<div style="width:100%;height:100%;"><img src="img/color/color${color}.png" height="26px" width="26px"/></div>',floatLabelType:"Always",placeholder:"Color"}),gp.value=fp,gp.appendTo(mp)}},template:'<div style="width:100%;height:100%;"><img src="img/color/color${color}.png" height="26px" width="26px"/></div>'}]:[{field:"TaskName",width:"200",headerText:"Task Name",clipMode:"EllipsisWithTooltip"},{field:"TaskID",width:"70"},{field:"StartDate",width:"130",headerText:"Start"},{field:"EndDate",width:"130",headerText:"End"},{field:"Duration",width:"130"},{field:"Progress",width:"150",headerText:"Progress %"},{field:"Predecessor",width:"150"},{field:"resources",width:"200",headerText:"Resources",clipMode:"EllipsisWithTooltip"},{field:"color",width:"100",headerText:"Color",editType:"dropdownedit",edit:{create:function(){return mp=document.createElement("input"),mp},read:function(){return gp.value},destroy:function(){gp.destroy()},write:function(){gp=new U["a"]({dataSource:[{color:""},{color:"31"},{color:"61"},{color:"91"},{color:"121"},{color:"151"},{color:"181"},{color:"211"},{color:"241"},{color:"271"},{color:"301"},{color:"331"}],fields:{value:"color"},valueTemplate:'<div style="width:100%;height:100%;">&nbsp;&nbsp;&nbsp;&nbsp;<img style="margin-top:1px;" src="img/color/color${color}.png" height="26px" width="26px"/></div>',itemTemplate:'<div style="width:100%;height:100%;"><img src="img/color/color${color}.png" height="26px" width="26px"/></div>',floatLabelType:"Always",placeholder:"Color"}),gp.value=fp,gp.appendTo(mp)}},template:'<div style="width:100%;height:100%;"><img src="img/color/color${color}.png" height="26px" width="26px"/></div>'}],dpParams:{create:function(){return mp=document.createElement("input"),mp},read:function(){return gp.value},destroy:function(){gp.destroy()},write:function(){gp=new U["a"]({dataSource:[{color:""},{color:"31"},{color:"61"},{color:"91"},{color:"121"},{color:"151"},{color:"181"},{color:"211"},{color:"241"},{color:"271"},{color:"301"},{color:"331"}],fields:{value:"color"},valueTemplate:'<div style="width:100%;height:100%;">&nbsp;&nbsp;&nbsp;&nbsp;<img style="margin-top:1px;" src="img/color/color${color}.png" height="26px" width="26px"/></div>',itemTemplate:'<div style="width:100%;height:100%;"><img src="img/color/color${color}.png" height="26px" width="26px"/></div>',floatLabelType:"Always",placeholder:"Color"}),gp.value=fp,gp.appendTo(mp)}},treeColumnIndex:document.documentElement.clientWidth>1e3?1:0,eventMarkers:[],exportEventMarkers:[],labelSettings:{},addDialogFields:[{type:"General",headerText:"General",fields:["TaskID","TaskName","StartDate","EndDate","Duration","Progress","color"]},{type:"Dependency"},{type:"Resources",fields:["resourceId","resourceName"]},{type:"Notes"}],editDialogFields:[{type:"General",headerText:"General",fields:["TaskID","TaskName","StartDate","EndDate","Duration","Progress","color"]},{type:"Dependency"},{type:"Resources",fields:["resourceId","resourceName"]},{type:"Notes"}],selectionSettings:{mode:"Row",type:"Single",enableToggle:!0},splitterSettings:{columnIndex:document.documentElement.clientWidth>1e3?2:1},filterSettings:{hierarchyMode:"None"},searchSettings:{hierarchyMode:"None"},ganttReadOnly:!1,ganttVirtualization:!1,queryTaskbarInfo:function(e){null!=e.data.color&&""!=e.data.color?(e.taskbarBgColor="hsl("+e.data.color+", 100%, 50%)",e.taskbarBorderColor="hsl("+e.data.color+", 100%, 35%)",e.progressBarBgColor="hsl("+e.data.color+", 100%, 35%)",e.milestoneColor="hsl("+e.data.color+", 100%, 35%)"):e.data.hasChildRecords?(e.taskbarBgColor="hsl(208, 7%, 46%)",e.taskbarBorderColor="hsl(210, 9%, 31%)",e.progressBarBgColor="hsl(210, 9%, 31%)",e.milestoneColor="hsl(210, 9%, 31%)"):(e.taskbarBgColor="hsl(211, 100%, 50%)",e.taskbarBorderColor="hsl(211, 100%, 35%)",e.progressBarBgColor="hsl(211, 100%, 35%)",e.milestoneColor="hsl(210, 9%, 31%)")},ganttActionComplete:function(t){if("outdented"===t.requestType&&(e.refresh=!0),"add"===t.requestType||"save"===t.requestType)try{var i=e.getEarliestDate(this.dataSource),n=e.getLatestDate(this.dataSource);n.setDate(n.getDate()+14),e.$refs.gantt.ej2Instances.updateProjectDates(i,n,!0),document.getElementById("GanttContainerGanttChart").querySelector(".e-chart-scroll-container").scrollLeft-=1}catch(t){e.projectStartDate=null,e.projectEndDate=null}if("save"===t.requestType&&(e.data=this.dataSource),"refresh"===t.requestType){if(e.refreshSplitter){e.$refs.gantt.ej2Instances.setSplitterPosition(e.refreshSplitterPosition+"px","position"),e.refreshSplitter=!1,e.refreshSplitterPosition=0;try{i=e.getEarliestDate(this.dataSource),n=e.getLatestDate(this.dataSource);n.setDate(n.getDate()+14),e.$refs.gantt.ej2Instances.updateProjectDates(i,n,!0),document.getElementById("GanttContainerGanttChart").querySelector(".e-chart-scroll-container").scrollLeft-=1}catch(t){e.projectStartDate=null,e.projectEndDate=null}e.collapseTasks(e.$refs.gantt.ej2Instances,e.collapsedTasks),e.collapsedTasks=[]}e.refresh&&(e.collapsedTasks=e.getCollapsedTasks(this.dataSource),this.dataSource=JSON.parse(JSON.stringify(e.refreshData)),e.refreshData=[],e.refresh=!1,e.refreshSplitter=!0),e.data=this.dataSource,e.resourceUpdateString.length>0&&e.$refs.resourceUpdate.click();try{e.indentTask>0?(e.$refs.gantt.ej2Instances.clearSelection(),e.$refs.gantt.ej2Instances.selectRow(e.getIndexByID(e.indentTask)),e.delay(100).then(function(t){e.indentTask=0}).catch(function(e){})):(e.$refs.gantt.ej2Instances.clearSelection(),e.delay(100).then(function(t){e.addingTask=!1}).catch(function(e){}))}catch(e){}}try{if("openEditDialog"===t.requestType){if(t.data.hasChildRecords){var r=document.getElementById("GanttContainerStartDate");r.setAttribute("disabled","disabled"),r.classList.add("e-disabled"),r.parentNode.classList.add("e-disabled"),r.parentNode.querySelector(".e-date-icon").style.pointerEvents="none",r.parentNode.querySelector(".e-date-icon").style.touchAction="none"}if(e.$refs.gantt.ej2Instances.readOnly){var s=document.getElementById("GanttContainercolor");s.setAttribute("disabled","disabled"),s.classList.add("e-disabled"),s.parentNode.classList.add("e-disabled");var a=t.data.resources.split(","),o=new MutationObserver(function(){document.getElementById("GanttContainerResourcesTabContainer_gridcontrol").classList.add("e-disabled"),document.getElementById("DialogResourceEdit").parentNode.classList.add("e-overlay");var e=!0,t=!1,i=void 0;try{for(var n,r=document.getElementById("GanttContainerResourcesTabContainer_gridcontrol_content_table").getElementsByTagName("tbody")[0].getElementsByTagName("tr")[Symbol.iterator]();!(e=(n=r.next()).done);e=!0){var s=n.value,o=s.getElementsByTagName("td");o.length>=3&&a.includes(o[2].innerHTML)&&(o[0].querySelector(".e-checkbox-wrapper").querySelector(".e-frame").classList.remove("e-uncheck"),o[0].querySelector(".e-checkbox-wrapper").querySelector(".e-frame").classList.add("e-check"))}}catch(e){t=!0,i=e}finally{try{e||null==r.return||r.return()}finally{if(t)throw i}}});o.observe(document.getElementById("GanttContainer_Tab"),{childList:!0,subtree:!0})}}if("openAddDialog"!==t.requestType&&"openEditDialog"!==t.requestType||(document.getElementById("GanttContainer_dialog").getElementsByClassName("e-footer-content")[0].children[0].innerHTML="OK",document.documentElement.clientWidth>600&&(document.getElementById("label_GanttContainerDuration").innerHTML='Duration <span style="font-size: 65%;">(excludes non-working days)</span>')),"openAddDialog"===t.requestType&&!e.isMobileApp()){var l=document.getElementById("GanttContainer_dialog").getElementsByClassName("e-footer-content")[0],d=document.createElement("small");d.innerHTML=-1!==navigator.userAgent.indexOf("Mac OS")?'Tip: You can use the "Control-I" keyboard shortcut to add new task without this popup':'Tip: You can use the "Insert" keyboard shortcut to add new task without this popup',d.style.float="left",d.style.lineHeight="3",l.insertBefore(d,l.children[0])}"indented"===t.requestType&&(e.indentTask=t.data[0].taskData.TaskID),"AfterZoomIn"!==t.requestType&&"AfterZoomOut"!==t.requestType&&"AfterZoomToProject"!==t.requestType||e.removeHeaderText("GanttContainerGanttChart"),"columnstate"!==t.requestType&&"reorder"!==t.requestType||document.querySelectorAll(".e-headertext").forEach(function(e){"ID"==e.innerHTML&&e.classList.add("notranslate")})}catch(e){}},ganttTaskbarEditing:function(e){"ParentDrag"==e.taskBarEditAction&&(e.cancel=!0)},ganttCellEdit:function(e){"StartDate"==e.columnName&&e.rowData.hasChildRecords&&(e.cancel=!0),"color"==e.columnName&&(fp=e.rowData.color)},ganttRowSelecting:function(t){if(e.isTouchDevice){var i=new Date,n=e.selectTime,r=i.getTime();r-n<50&&0==e.indentTask&&(t.cancel=!0,e.selectTime=r)}},ganttRowSelected:function(t){if(e.isTouchDevice){var i=new Date;e.selectTime=i.getTime()}},ganttRowDeselecting:function(t){if(e.isTouchDevice){var i=new Date,n=e.selectTime,r=i.getTime();r-n<50&&0==e.indentTask&&!e.addingTask&&(t.cancel=!0,e.selectTime=r)}},ganttRowDeselected:function(t){if(e.isTouchDevice){var i=new Date;e.selectTime=i.getTime()}},ganttActionBegin:function(t){"outdenting"===t.action&&(e.refreshData=JSON.parse(JSON.stringify(e.outdentTask(JSON.parse(JSON.stringify(e.data)),t.data.TaskID))),e.refreshSplitterPosition=document.getElementById("treeGridGanttContainer_gridcontrol").clientWidth),"beforeZoomIn"!==t.requestType&&"beforeZoomOut"!==t.requestType&&"beforeZoomToProject"!==t.requestType||(t.timeline.weekStartDay=this.timelineSettings.weekStartDay),"beforeOpenEditDialog"!=t.requestType&&"beforeOpenAddDialog"!=t.requestType||(t.Resources.columns[1].visible=!1,fp=t.rowData.color,t.Resources.toolbar=[{text:"Edit",id:"DialogResourceEdit",prefixIcon:"e-edit",align:"Right"}],t.Resources.toolbarClick=function(){e.$root.$emit("bv::show::modal","dialogResourceEditModal")}),"beforeAdd"==t.requestType&&(e.addingTask=!0),"validateLinkedTask"==t.requestType&&("Cancel Move"==e.advanced.dependencyConflict?(t.validateMode.respectLink=!0,t.validateMode.removeLink=!1,t.validateMode.preserveLinkWithEditing=!1):"Remove Dependency"==e.advanced.dependencyConflict?(t.validateMode.respectLink=!1,t.validateMode.removeLink=!0,t.validateMode.preserveLinkWithEditing=!1):(t.validateMode.respectLink=!1,t.validateMode.removeLink=!1,t.validateMode.preserveLinkWithEditing=!0))},ganttCreated:function(t){e.initializeGantt();try{-1!==navigator.userAgent.indexOf("Mac OS")&&(e.macInsert=function(e){"i"!=e.key&&"I"!=e.key||!e.ctrlKey||e.altKey||e.metaKey||e.shiftKey||document.getElementById("GanttContainer").dispatchEvent(new KeyboardEvent("keydown",{key:"Insert",keyCode:45,which:45}))},document.getElementById("GanttContainer").addEventListener("keydown",e.macInsert))}catch(e){}try{"safari"===w["d"].info.name&&(document.getElementById("treeGridGanttContainer_gridcontrol_content_table").style.borderCollapse="collapse")}catch(e){}try{e.$refs.gantt.ej2Instances.zoomingLevels[3].topTier.format="yyyy",e.$refs.gantt.ej2Instances.zoomingLevels[4].topTier.format="yyyy",e.$refs.gantt.ej2Instances.zoomingLevels[5].topTier.format="yyyy","yyyy MMM dd"==e.advanced.dateFormat||"dd MMM yyyy"==e.advanced.dateFormat||"MMM dd, yyyy"==e.advanced.dateFormat?e.$refs.gantt.ej2Instances.zoomingLevels[7].bottomTier.format="MMM":e.$refs.gantt.ej2Instances.zoomingLevels[7].bottomTier.format="MM",e.$refs.gantt.ej2Instances.zoomingLevels[8].topTier.format=e.advanced.dateFormat.replace(/-dd|\/dd|.dd| dd/g,"").replace(/dd-|dd\/|dd.|dd /g,"").replace(/\,/g,""),e.$refs.gantt.ej2Instances.zoomingLevels[9].topTier.format=e.advanced.dateFormat.replace(/-dd|\/dd|.dd| dd/g,"").replace(/dd-|dd\/|dd.|dd /g,"").replace(/\,/g,""),e.$refs.gantt.ej2Instances.zoomingLevels[9].bottomTier.format="dd",e.$refs.gantt.ej2Instances.zoomingLevels[10].topTier.format=e.advanced.dateFormat.replace(/-dd|\/dd|.dd| dd/g,"").replace(/dd-|dd\/|dd.|dd /g,"").replace(/\,/g,""),e.$refs.gantt.ej2Instances.zoomingLevels[10].bottomTier.format="dd",e.$refs.gantt.ej2Instances.zoomingLevels[11].topTier.format=e.advanced.dateFormat,e.$refs.gantt.ej2Instances.zoomingLevels[12].topTier.format=e.advanced.dateFormat,e.$refs.gantt.ej2Instances.zoomingLevels[13].topTier.format=e.advanced.dateFormat,e.$refs.gantt.ej2Instances.zoomingLevels[14].topTier.format=e.advanced.dateFormat,e.$refs.gantt.ej2Instances.zoomingLevels[14].bottomTier.format=e.advanced.timeFormat,e.$refs.gantt.ej2Instances.zoomingLevels[15].topTier.format=e.advanced.dateFormat,e.$refs.gantt.ej2Instances.zoomingLevels[15].bottomTier.format=e.advanced.timeFormat,e.$refs.gantt.ej2Instances.zoomingLevels[16].topTier.format=e.advanced.dateFormat,e.$refs.gantt.ej2Instances.zoomingLevels[16].bottomTier.format=e.advanced.timeFormat,e.$refs.gantt.ej2Instances.zoomingLevels[17].topTier.format=e.advanced.dateFormat,e.$refs.gantt.ej2Instances.zoomingLevels[17].bottomTier.format=e.advanced.timeFormat,e.$refs.gantt.ej2Instances.zoomingLevels[18].topTier.format=e.advanced.dateFormat,e.$refs.gantt.ej2Instances.zoomingLevels[18].bottomTier.format=e.advanced.timeFormat,e.$refs.gantt.ej2Instances.zoomingLevels[19].topTier.format=e.advanced.dateFormat,e.$refs.gantt.ej2Instances.zoomingLevels[19].bottomTier.format=e.advanced.timeFormat,e.$refs.gantt.ej2Instances.zoomingLevels[20].topTier.format=e.advanced.dateFormat,e.$refs.gantt.ej2Instances.zoomingLevels[20].bottomTier.format=e.advanced.timeFormat,e.$refs.gantt.ej2Instances.zoomingLevels[21].topTier.format=e.advanced.dateFormat,e.$refs.gantt.ej2Instances.zoomingLevels[21].bottomTier.format=e.advanced.timeFormat,e.$refs.gantt.ej2Instances.zoomingLevels[22].topTier.count=2,e.$refs.gantt.ej2Instances.zoomingLevels[22].topTier.format=e.advanced.dateFormat+" "+e.advanced.timeFormat,e.$refs.gantt.ej2Instances.zoomingLevels[23].topTier.format=e.advanced.dateFormat+" "+e.advanced.timeFormat,e.$refs.gantt.ej2Instances.zoomingLevels[24].topTier.format=e.advanced.dateFormat+" "+e.advanced.timeFormat,document.querySelectorAll(".e-timeline-header-container").forEach(function(e){return e.classList.add("notranslate")}),document.querySelectorAll("#treeGridGanttContainer_gridcontrol_content_table").forEach(function(e){return e.classList.add("notranslate")}),document.querySelectorAll(".e-headertext").forEach(function(e){"ID"==e.innerHTML&&e.classList.add("notranslate")}),document.querySelectorAll("#treeGridGanttContainer_gridcontrol_columnmenu").forEach(function(e){return e.removeAttribute("aria-label")});var i=new MutationObserver(function(){document.querySelectorAll(".e-datepicker.e-popup-wrapper").forEach(function(e){return e.classList.add("notranslate")})});i.observe(document.body,{childList:!0})}catch(e){}e.delay(0).then(function(t){if(e.advanced.zoomLevel<0)for(var i=0;i>e.advanced.zoomLevel;i--)e.$refs.gantt.ej2Instances.zoomIn();else for(i=0;i<e.advanced.zoomLevel;i++)e.$refs.gantt.ej2Instances.zoomOut()}).catch(function(e){})},ganttDestroyed:function(t){try{-1!==navigator.userAgent.indexOf("Mac OS")&&document.getElementById("GanttContainer").removeEventListener("keydown",e.macInsert)}catch(e){}},exportGanttDataBound:function(t){if(t.hasOwnProperty("isGanttCreated")){try{e.$refs.exportGantt.ej2Instances.zoomingLevels[3].topTier.format="yyyy",e.$refs.exportGantt.ej2Instances.zoomingLevels[4].topTier.format="yyyy",e.$refs.exportGantt.ej2Instances.zoomingLevels[5].topTier.format="yyyy","yyyy MMM dd"==e.advanced.dateFormat||"dd MMM yyyy"==e.advanced.dateFormat||"MMM dd, yyyy"==e.advanced.dateFormat?e.$refs.exportGantt.ej2Instances.zoomingLevels[7].bottomTier.format="MMM":e.$refs.exportGantt.ej2Instances.zoomingLevels[7].bottomTier.format="MM",e.$refs.exportGantt.ej2Instances.zoomingLevels[8].topTier.format=e.advanced.dateFormat.replace(/-dd|\/dd|.dd| dd/g,"").replace(/dd-|dd\/|dd.|dd /g,"").replace(/\,/g,""),e.$refs.exportGantt.ej2Instances.zoomingLevels[9].topTier.format=e.advanced.dateFormat.replace(/-dd|\/dd|.dd| dd/g,"").replace(/dd-|dd\/|dd.|dd /g,"").replace(/\,/g,""),e.$refs.exportGantt.ej2Instances.zoomingLevels[9].bottomTier.format="dd",e.$refs.exportGantt.ej2Instances.zoomingLevels[10].topTier.format=e.advanced.dateFormat.replace(/-dd|\/dd|.dd| dd/g,"").replace(/dd-|dd\/|dd.|dd /g,"").replace(/\,/g,""),e.$refs.exportGantt.ej2Instances.zoomingLevels[10].bottomTier.format="dd",e.$refs.exportGantt.ej2Instances.zoomingLevels[11].topTier.format=e.advanced.dateFormat,e.$refs.exportGantt.ej2Instances.zoomingLevels[12].topTier.format=e.advanced.dateFormat,e.$refs.exportGantt.ej2Instances.zoomingLevels[13].topTier.format=e.advanced.dateFormat,e.$refs.exportGantt.ej2Instances.zoomingLevels[14].topTier.format=e.advanced.dateFormat,e.$refs.exportGantt.ej2Instances.zoomingLevels[14].bottomTier.format=e.advanced.timeFormat,e.$refs.exportGantt.ej2Instances.zoomingLevels[15].topTier.format=e.advanced.dateFormat,e.$refs.exportGantt.ej2Instances.zoomingLevels[15].bottomTier.format=e.advanced.timeFormat,e.$refs.exportGantt.ej2Instances.zoomingLevels[16].topTier.format=e.advanced.dateFormat,e.$refs.exportGantt.ej2Instances.zoomingLevels[16].bottomTier.format=e.advanced.timeFormat,e.$refs.exportGantt.ej2Instances.zoomingLevels[17].topTier.format=e.advanced.dateFormat,e.$refs.exportGantt.ej2Instances.zoomingLevels[17].bottomTier.format=e.advanced.timeFormat,e.$refs.exportGantt.ej2Instances.zoomingLevels[18].topTier.format=e.advanced.dateFormat,e.$refs.exportGantt.ej2Instances.zoomingLevels[18].bottomTier.format=e.advanced.timeFormat,e.$refs.exportGantt.ej2Instances.zoomingLevels[19].topTier.format=e.advanced.dateFormat,e.$refs.exportGantt.ej2Instances.zoomingLevels[19].bottomTier.format=e.advanced.timeFormat,e.$refs.exportGantt.ej2Instances.zoomingLevels[20].topTier.format=e.advanced.dateFormat,e.$refs.exportGantt.ej2Instances.zoomingLevels[20].bottomTier.format=e.advanced.timeFormat,e.$refs.exportGantt.ej2Instances.zoomingLevels[21].topTier.format=e.advanced.dateFormat,e.$refs.exportGantt.ej2Instances.zoomingLevels[21].bottomTier.format=e.advanced.timeFormat,e.$refs.exportGantt.ej2Instances.zoomingLevels[22].topTier.count=2,e.$refs.exportGantt.ej2Instances.zoomingLevels[22].topTier.format=e.advanced.dateFormat+" "+e.advanced.timeFormat,e.$refs.exportGantt.ej2Instances.zoomingLevels[23].topTier.format=e.advanced.dateFormat+" "+e.advanced.timeFormat,e.$refs.exportGantt.ej2Instances.zoomingLevels[24].topTier.format=e.advanced.dateFormat+" "+e.advanced.timeFormat,document.querySelectorAll(".e-timeline-header-container").forEach(function(e){return e.classList.add("notranslate")}),document.querySelectorAll("#treeGridexportGanttContainer_gridcontrol_content_table").forEach(function(e){return e.classList.add("notranslate")}),document.querySelectorAll(".e-headertext").forEach(function(e){"ID"==e.innerHTML&&e.classList.add("notranslate")}),e.exportEventMarkers=JSON.parse(JSON.stringify(e.eventMarkers))}catch(e){}e.delay(1e3).then(function(t){e.exportFunction()}).catch(function(e){})}}}},provide:{gantt:[_h,Kh,$h["a"],Xh["a"],Jh["a"],Qh["a"],Yh["a"],Zh["a"],ep["a"],tp["a"],ip["a"]]},computed:{name:function(){return this.$route.name},list:function(){return this.$route.matched.filter(function(e){return e.name||e.meta.label})}},mounted:function(){var e=this;this.resourceListItems=JSON.parse(JSON.stringify(this.resources)),this.resourceListItems.push({resourceId:"",resourceName:""});for(var t=0;t<7-this.resources.length;t++)this.resourceListItems.push({resourceId:"",resourceName:""});this.holidayItems=[{from:null,to:null}],this.workTimeOptions=this.workTime24HourOptions,this.$watch(function(){return e.$route},function(t,i){e.initializeUser(),e.welcome()}),this.initializeUser(),this.welcome();try{this.isTouchDevice="ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0}catch(e){}},updated:function(){0==this.showGantt&&(this.showGantt=!0),0==this.showGrid&&(this.showGrid=!0),""!=this.resourceListItems[this.resourceListItems.length-1].resourceName&&this.resourceListItems.push({resourceId:"",resourceName:""}),null==this.holidayItems[this.holidayItems.length-1].from&&null==this.holidayItems[this.holidayItems.length-1].to||this.holidayItems.push({from:null,to:null}),this.permissionItems.length>0&&""!=this.permissionItems[this.permissionItems.length-1].email&&this.permissionItems.push({email:"",access:"read",id:""}),""!=this.undoProjectChanged&&(this.projectSelected=this.undoProjectChanged,this.undoProjectChanged=""),this.reinitializeGantt&&(this.initializeGantt(),this.reinitializeGantt=!1)},beforeMount:function(){this.updateGanttHeight()},created:function(){this.updateGanttHeight();var e=this;this.debouncedResize=y()(function(){var t=document.documentElement.clientHeight,i=e.ganttHeight;e.$route.params.hasOwnProperty("cloud")?e.ganttHeight=t<=510?300:t-210:e.ganttHeight=t<=510?290:t-220,i==e.ganttHeight&&(e.ganttHeight=e.ganttHeight+1),e.$nextTick(function(){try{var e=Math.max(document.getElementById("GanttContainerGanttChart").querySelector(".e-chart-scroll-container").clientHeight,36*document.getElementById("GanttContainerGanttTaskTableBody").childElementCount);document.getElementById("GanttContainerGanttChart").querySelector(".e-chart-rows-container").style.height=e+"px",document.getElementById("GanttContainerline-container").style.height=e+"px";try{document.getElementById("GanttContainerGanttChart").querySelector(".e-weekend-container").style.height=e+"px"}catch(e){}try{document.getElementById("GanttContainerGanttChart").querySelector(".e-holiday-container").style.height=e+"px"}catch(e){}}catch(e){}})},100),window.addEventListener("resize",this.debouncedResize),window.onbeforeunload=function(){return e.$route.params.hasOwnProperty("cloud")&&e.unsaved()?"Leave this page and discard unsaved changes?":null};var t=new Date;this.advanced.timezoneOffset=t.getTimezoneOffset(),this.dbAdvanced.timezoneOffset=t.getTimezoneOffset();try{this.advanced.timezone=Intl.DateTimeFormat().resolvedOptions().timeZone,this.dbAdvanced.timezone=Intl.DateTimeFormat().resolvedOptions().timeZone}catch(e){}},beforeDestroy:function(){window.removeEventListener("resize",this.debouncedResize)},beforeRouteLeave:function(e,t,i){this.$route.params.hasOwnProperty("cloud")&&this.unsaved()?this.showConfirmModal(i,"Discard unsaved changes?","sm","","",!0):i()},components:{"ejs-datepicker":vp},methods:{updateGanttHeight:function(){var e=document.documentElement.clientHeight;this.$route.params.hasOwnProperty("cloud")?this.ganttHeight=e<=510?300:e-210:this.ganttHeight=e<=510?290:e-220},unsaved:function(){return"Project View"!=this.viewSelected&&"Resource View"!=this.viewSelected&&(this.saveResourceListItems(),this.saveHolidayItems(),this.savePermissionItems()),JSON.stringify(this.data)!=JSON.stringify(this.dbData)||JSON.stringify(this.resources)!=JSON.stringify(this.dbResources)||JSON.stringify(this.advanced)!=JSON.stringify(this.dbAdvanced)||this.projectName!=this.dbProjectName||JSON.stringify(this.permissions)!=JSON.stringify(this.dbPermissions)},newGantt:function(){this.data=[],this.resources=[],this.showGrid=!1,this.resourceListItems=JSON.parse(JSON.stringify(this.resources)),this.resourceListItems.push({resourceId:"",resourceName:""});for(var e=0;e<7-this.resources.length;e++)this.resourceListItems.push({resourceId:"",resourceName:""});for(this.projectStartDate=null,this.projectEndDate=null,document.documentElement.clientWidth>1e3?this.advanced.columns=[{name:"Task ID",width:"70",show:!0},{name:"Task Name",width:"350",show:!0},{name:"Start Date",width:"130",show:!1},{name:"End Date",width:"130",show:!1},{name:"Duration",width:"130",show:!1},{name:"Progress %",width:"150",show:!1},{name:"Dependency",width:"150",show:!1},{name:"Resources",width:"200",show:!1},{name:"Color",width:"100",show:!1}]:this.advanced.columns=[{name:"Task ID",width:"70",show:!1},{name:"Task Name",width:"200",show:!0},{name:"Start Date",width:"130",show:!1},{name:"End Date",width:"130",show:!1},{name:"Duration",width:"130",show:!1},{name:"Progress %",width:"150",show:!1},{name:"Dependency",width:"150",show:!1},{name:"Resources",width:"200",show:!1},{name:"Color",width:"100",show:!1}],this.saveColumns(),this.advanced.zoomLevel=0,this.advanced.dependencyConflict="Add Offset to Dependency",this.advanced.dateFormat="yyyy-MM-dd",this.advanced.timeFormat="HH:mm",this.dateFormat="yyyy-MM-dd",this.timelineSettings.topTier.format="yyyy-MM-dd",this.advanced.firstDayOfWeek=0,this.timelineSettings.weekStartDay=0,this.advanced.workWeek=["Monday","Tuesday","Wednesday","Thursday","Friday"],this.advanced.workTime=[{from:8,to:12},{from:13,to:17}],this.workTimeItems=[{from:8,to:12},{from:13,to:17}],this.updateWorkTimeOptions("HH:mm"),this.advanced.holidays=[],this.holidayItems=[{from:null,to:null}],this.permissions=[],this.permissionItems=[{email:"",access:"read",id:""}],e=this.adminAdvancedUserList.length-1;e>=0;e--)this.permissionItems.unshift({email:this.adminAdvancedUserList[e],access:"read/write",id:""});this.publicLinkSelect=0,this.dbData=[],this.dbResources=[],document.documentElement.clientWidth>1e3?this.dbAdvanced.columns=[{name:"Task ID",width:"70",show:!0},{name:"Task Name",width:"350",show:!0},{name:"Start Date",width:"130",show:!1},{name:"End Date",width:"130",show:!1},{name:"Duration",width:"130",show:!1},{name:"Progress %",width:"150",show:!1},{name:"Dependency",width:"150",show:!1},{name:"Resources",width:"200",show:!1},{name:"Color",width:"100",show:!1}]:this.dbAdvanced.columns=[{name:"Task ID",width:"70",show:!1},{name:"Task Name",width:"200",show:!0},{name:"Start Date",width:"130",show:!1},{name:"End Date",width:"130",show:!1},{name:"Duration",width:"130",show:!1},{name:"Progress %",width:"150",show:!1},{name:"Dependency",width:"150",show:!1},{name:"Resources",width:"200",show:!1},{name:"Color",width:"100",show:!1}],this.dbAdvanced.zoomLevel=0,this.dbAdvanced.dependencyConflict="Add Offset to Dependency",this.dbAdvanced.dateFormat="yyyy-MM-dd",this.dbAdvanced.timeFormat="HH:mm",this.dbAdvanced.firstDayOfWeek=0,this.dbAdvanced.workWeek=["Monday","Tuesday","Wednesday","Thursday","Friday"],this.dbAdvanced.workTime=[{from:8,to:12},{from:13,to:17}],this.dbAdvanced.holidays=[],this.dbProjectName="",this.dbPermissions=[],this.viewSelected="Project View",this.presetFilterSelected="All Tasks",this.showGantt=!1,this.currentView="Gantt",this.viewType="ProjectView"},newClicked:function(e){e.target.blur(),this.showConfirmModal(this.newGantt,"Discard unsaved changes?","sm")},openClicked:function(e){e.target.blur(),!this.$route.params.hasOwnProperty("cloud")||this.unsaved()?this.showConfirmModal(this.openClickedConfirmed,"Discard unsaved changes?","sm"):this.openClickedConfirmed()},openClickedConfirmed:function(){this.$refs.fileInput.click()},fileChanged:function(e){var t=this.$refs.fileInput.files,i={},n=this;t.length>0&&("gantt"==t.item(0).name.split(".").pop().toLowerCase()?t.item(0).text().then(function(e){i=JSON.parse(e),n.resources=JSON.parse(JSON.stringify(i.resources)),n.showGrid=!1,n.resourceListItems=JSON.parse(JSON.stringify(i.resources)),n.resourceListItems.push({resourceId:"",resourceName:""});for(var t=0;t<7-i.resources.length;t++)n.resourceListItems.push({resourceId:"",resourceName:""});if(n.data=JSON.parse(JSON.stringify(i.data)),n.projectStartDate=null,n.projectEndDate=null,n.viewSelected="Project View",n.presetFilterSelected="All Tasks",n.showGantt=!1,n.currentView="Gantt",n.viewType="ProjectView",i.hasOwnProperty("advanced"))if(i.advanced.hasOwnProperty("columns")?(n.advanced.columns=JSON.parse(JSON.stringify(i.advanced.columns)),n.advanced.columns.length<9&&n.advanced.columns.push({name:"Color",width:"100",show:!1}),n.saveColumns()):(n.advanced.columns=[{name:"Task ID",width:"70",show:!0},{name:"Task Name",width:"350",show:!0},{name:"Start Date",width:"130",show:!1},{name:"End Date",width:"130",show:!1},{name:"Duration",width:"130",show:!1},{name:"Progress %",width:"150",show:!1},{name:"Dependency",width:"150",show:!1},{name:"Resources",width:"200",show:!1},{name:"Color",width:"100",show:!1}],n.saveColumns()),i.advanced.hasOwnProperty("zoomLevel")?n.advanced.zoomLevel=JSON.parse(JSON.stringify(i.advanced.zoomLevel)):n.advanced.zoomLevel=0,i.advanced.hasOwnProperty("dependencyConflict")?n.advanced.dependencyConflict=JSON.parse(JSON.stringify(i.advanced.dependencyConflict)):n.advanced.dependencyConflict="Add Offset to Dependency",i.advanced.hasOwnProperty("timezone")&&n.advanced.timezone!=i.advanced.timezone&&""!=n.advanced.timezone&&""!=i.advanced.timezone&&n.updateTimezoneOffsetByDate(n.data,i.advanced.timezone,n.advanced.timezone),i.advanced.hasOwnProperty("dateFormat")?(n.advanced.dateFormat=JSON.parse(JSON.stringify(i.advanced.dateFormat)),n.dateFormat=JSON.parse(JSON.stringify(i.advanced.dateFormat)),n.timelineSettings.topTier.format=JSON.parse(JSON.stringify(i.advanced.dateFormat))):(n.advanced.dateFormat="yyyy-MM-dd",n.dateFormat="yyyy-MM-dd",n.timelineSettings.topTier.format="yyyy-MM-dd"),i.advanced.hasOwnProperty("timeFormat")?n.advanced.timeFormat=JSON.parse(JSON.stringify(i.advanced.timeFormat)):n.advanced.timeFormat="HH:mm",i.advanced.hasOwnProperty("firstDayOfWeek")?(n.advanced.firstDayOfWeek=JSON.parse(JSON.stringify(i.advanced.firstDayOfWeek)),n.timelineSettings.weekStartDay=JSON.parse(JSON.stringify(i.advanced.firstDayOfWeek))):(n.advanced.firstDayOfWeek=0,n.timelineSettings.weekStartDay=0),i.advanced.hasOwnProperty("workWeek")?n.advanced.workWeek=JSON.parse(JSON.stringify(i.advanced.workWeek)):n.advanced.workWeek=["Monday","Tuesday","Wednesday","Thursday","Friday"],i.advanced.hasOwnProperty("workTime")?n.advanced.workTime=JSON.parse(JSON.stringify(i.advanced.workTime)):n.advanced.workTime=[{from:8,to:12},{from:13,to:17}],n.workTimeItems=JSON.parse(JSON.stringify(n.advanced.workTime)),1==n.workTimeItems.length&&n.workTimeItems.push({from:-1,to:-1}),24==n.workTimeItems[0].to&&(n.workTimeItems[0].to=0),24==n.workTimeItems[1].to&&(n.workTimeItems[1].to=0),n.updateWorkTimeOptions(n.advanced.timeFormat),i.advanced.hasOwnProperty("holidays")){for(n.advanced.holidays=JSON.parse(JSON.stringify(i.advanced.holidays)),n.holidayItems=[],t=0;t<i.advanced.holidays.length;t++){var r=new Date(i.advanced.holidays[t].from),s=new Date(i.advanced.holidays[t].to);n.holidayItems.push({from:r.toISOString(),to:s.toISOString()})}n.holidayItems.push({from:null,to:null})}else n.advanced.holidays=[],n.holidayItems=[{from:null,to:null}];else n.advanced.columns=[{name:"Task ID",width:"70",show:!0},{name:"Task Name",width:"350",show:!0},{name:"Start Date",width:"130",show:!1},{name:"End Date",width:"130",show:!1},{name:"Duration",width:"130",show:!1},{name:"Progress %",width:"150",show:!1},{name:"Dependency",width:"150",show:!1},{name:"Resources",width:"200",show:!1},{name:"Color",width:"100",show:!1}],n.saveColumns(),n.advanced.zoomLevel=0,n.advanced.dependencyConflict="Add Offset to Dependency",n.advanced.dateFormat="yyyy-MM-dd",n.advanced.timeFormat="HH:mm",n.dateFormat="yyyy-MM-dd",n.timelineSettings.topTier.format="yyyy-MM-dd",n.advanced.firstDayOfWeek=0,n.timelineSettings.weekStartDay=0,n.advanced.workWeek=["Monday","Tuesday","Wednesday","Thursday","Friday"],n.advanced.workTime=[{from:8,to:12},{from:13,to:17}],n.workTimeItems=[{from:8,to:12},{from:13,to:17}],n.updateWorkTimeOptions("HH:mm"),n.advanced.holidays=[],n.holidayItems=[{from:null,to:null}];n.$refs.fileInput.value=""}).catch(function(e){n.showAlertModal("Invalid file, please select a different file","sm"),n.$refs.fileInput.value=""}):(n.showAlertModal("Invalid file, please select a .gantt file","sm"),n.$refs.fileInput.value=""))},excelFileChanged:function(e){var t=this.$refs.excelFileInput.files,i=this;t.length>0&&("csv"==t.item(0).name.split(".").pop().toLowerCase()?(i.importExcel=!0,t.item(0).text().then(function(e){function t(e,t){for(var i=[],n=!1,r=0,s=0,a=0;a<e.length;a++){var o=e[a],l=e[a+1];i[r]=i[r]||[],i[r][s]=i[r][s]||"",'"'==o&&n&&'"'==l?(i[r][s]+=o,++a):'"'!=o?o!=t||n?"\r"!=o||"\n"!=l||n?("\n"!=o||n)&&("\r"!=o||n)?i[r][s]+=o:(++r,s=0):(++r,s=0,++a):++s:n=!n}return i}function n(e,t,i,r){return t===i+1?(r.subtasks||(r.subtasks=[]),r.subtasks.push(e),e):n(e,t,i-1,j[i-1])}for(var r=e.substring(0,e.search(/\r|\n/)),s=r.split(","),a=r.split(";"),o=",",l="",d=!1,c=0;c<s.length;c++)l=s[c].trim().replace(/\"/g,"").replace(/\s/g,"").replace(/\_/g,"").replace(/\-/g,"").toLowerCase(),"name"!=l&&"taskname"!=l&&"task"!=l||(d=!0);if(!d)for(c=0;c<a.length;c++)l=a[c].trim().replace(/\"/g,"").replace(/\s/g,"").replace(/\_/g,"").replace(/\-/g,"").toLowerCase(),"name"!=l&&"taskname"!=l&&"task"!=l||(o=";");var h=t(e,o),p=h[0],u="",m=-1,g=-1,f=-1,b=-1,v=-1,y=-1,C=-1,w=-1,O=-1,T=-1,k=-1;for(c=0;c<p.length;c++)u=p[c].trim().replace(/\"/g,"").replace(/\s/g,"").replace(/\_/g,"").replace(/\-/g,"").toLowerCase(),"outlinelevel"==u||"level"==u?m=c:"id"==u||"taskid"==u?g=c:"name"==u||"taskname"==u||"task"==u?f=c:"start"==u||"startdate"==u?b=c:"finish"==u||"finishdate"==u||"end"==u||"enddate"==u?v=c:"duration"==u?y=c:"%complete"==u||"percentcomplete"==u||"progress"==u||"%progress"==u||"percentprogress"==u||"progress%"==u||"progresspercent"==u?C=c:"predecessor"==u||"predecessors"==u||"dependency"==u||"dependencies"==u?w=c:"resource"==u||"resources"==u||"resourcename"==u||"resourcenames"==u?O=c:"color"==u||"colour"==u?T=c:"note"!=u&&"notes"!=u&&"comment"!=u&&"comments"!=u&&"info"!=u&&"information"!=u||(k=c);if(-1==f)throw"Invalid .csv file: Column 'Name' must be included.";if(-1==b)throw"Invalid .csv file: Column 'Start' must be included.";if(-1==y&&-1==v)throw"Invalid .csv file: Column 'Finish' or 'Duration' must be included.";h.shift();var S=[],j=[null],R=1,D=[],E=[];h.forEach(function(e){if(e.length>1){if(-1==m)var t=1;else{t=parseInt(e[m],10);if(isNaN(t))throw"Invalid .csv file: Column 'Outline Level' must be integers."}if(-1==g){if(-1!=w)throw"Invalid .csv file: Column 'ID' must be included if column 'Predecessors' is included.";var r=R++}else{r=parseInt(e[g],10);if(isNaN(r)||r<=0)throw"Invalid .csv file: Column 'ID' must be unique positive integers.";for(var s=0;s<D.length;s++)if(D[s]==r)throw"Invalid .csv file: Column 'ID' must be unique positive integers.";D.push(r)}var a=e[f];try{if("-"!=e[b].trim().substring(4,5)||"-"!=e[b].trim().substring(7,8)||isNaN(parseInt(e[b].trim().substring(9,10),10)))throw"Invalid .csv file: Column 'Start' must be a valid date (YYYY-MM-DD).\n\nIn Excel, specify the date format by right clicking on the cells and selecting 'Format Cells -> Number -> Date -> YYYY-MM-DD'.";var o=new Date(e[b]);o.setMinutes(o.getMinutes()+o.getTimezoneOffset());var l=o.toISOString()}catch(e){throw"Invalid .csv file: Column 'Start' must be a valid date (YYYY-MM-DD).\n\nIn Excel, specify the date format by right clicking on the cells and selecting 'Format Cells -> Number -> Date -> YYYY-MM-DD'."}try{if(-1!=y){var d=e[y].trim().split(" "),c=parseFloat(d[0]);if(isNaN(c))throw"Invalid .csv file: Column 'Duration' must be a number, a space, and a unit (day or hour) (e.g. 5 days).";if(d.length>1){var h=d[1].trim().toLowerCase();if("?"==h.substring(h.length-1)&&(h=h.substring(0,h.length-1)),"s"==h.substring(h.length-1)&&(h=h.substring(0,h.length-1)),""==h&&(h="day"),"day"!=h&&"hour"!=h&&"minute"!=h)throw"Invalid .csv file: Column 'Duration' must be a number, a space, and a unit (day or hour) (e.g. 5 days)."}else h="day"}}catch(e){throw"Invalid .csv file: Column 'Duration' must be a number, a space, and a unit (day or hour) (e.g. 5 days)."}if(-1==v){var p=new Date(o.toISOString());"hour"==h?p.setHours(p.getHours()+c):"minute"==h?p.setMinutes(p.getMinutes()+c):p.setDate(p.getDate()+c)}else try{if("-"!=e[v].trim().substring(4,5)||"-"!=e[v].trim().substring(7,8)||isNaN(parseInt(e[v].trim().substring(9,10),10)))throw"Invalid .csv file: Column 'Finish' must be a valid date (YYYY-MM-DD).\n\nIn Excel, specify the date format by right clicking on the cells and selecting 'Format Cells -> Number -> Date -> YYYY-MM-DD'.";p=new Date(e[v]);p.setMinutes(p.getMinutes()+p.getTimezoneOffset());var u=p.toISOString()}catch(e){throw"Invalid .csv file: Column 'Finish' must be a valid date (YYYY-MM-DD).\n\nIn Excel, specify the date format by right clicking on the cells and selecting 'Format Cells -> Number -> Date -> YYYY-MM-DD'."}if(-1==y)c=i.getDurationDays(o,p),h="day";if(-1==C)var I=0;else{I=parseFloat(e[C]);isNaN(I)&&(I=0),I<0?I=0:I>100&&(I=100)}if(-1==w)var x="";else{var M=-1,P=(x="",e[w].split(","));for(s=0;s<P.length;s++)M=parseInt(P[s],10),M==r||isNaN(M)||(x+=0==s?P[s].trim():","+P[s].trim())}if(-1==O)var L=[];else{L=[];var N="",A=e[O].split(",");for(s=0;s<A.length;s++)if(N=A[s].trim(),N.length>0){L.push({resourceId:N,resourceName:N,unit:100});for(var B=!1,F=0;F<E.length;F++)E[F].resourceId==N&&(B=!0);B||E.push({resourceId:N,resourceName:N})}}if(-1==T)var H="";else{H="";var V=parseInt(e[T],10);V>0&&V<=31?H="31":V>31&&V<=61?H="61":V>61&&V<=91?H="91":V>91&&V<=121?H="121":V>121&&V<=151?H="151":V>151&&V<=181?H="181":V>181&&V<=211?H="211":V>211&&V<=241?H="241":V>241&&V<=271?H="271":V>271&&V<=301?H="301":V>301&&(H="331")}if(-1==k)var q="";else q=e[k];var z={TaskID:r,TaskName:a,StartDate:l,EndDate:u,Duration:c,DurationUnit:h,Progress:I,Predecessor:x,resources:L,color:H,info:q};if(1===t)S.push(z),j[1]=z;else{var _=n(z,t,j.length-1,j[j.length-1]);j[t]=_}}}),i.importExcel=!1,i.resources=JSON.parse(JSON.stringify(E)),i.showGrid=!1,i.resourceListItems=JSON.parse(JSON.stringify(E)),i.resourceListItems.push({resourceId:"",resourceName:""});for(c=0;c<7-E.length;c++)i.resourceListItems.push({resourceId:"",resourceName:""});i.data=JSON.parse(JSON.stringify(S)),i.projectStartDate=null,i.projectEndDate=null,i.viewSelected="Project View",i.presetFilterSelected="All Tasks",i.showGantt=!1,i.currentView="Gantt",i.viewType="ProjectView",i.$refs.excelFileInput.value=""}).catch(function(e){i.importExcel=!1,"Invalid .csv file:"==String(e).substring(0,18)?i.showAlertModal(String(e).replace(/\n/g,"<br>")+"<br><br>Please select a different .csv file. You can try exporting a file to view the required file format."):i.showAlertModal("Invalid .csv file.<br><br>Please select a different .csv file. You can try exporting a file to view the required file format."),i.$refs.excelFileInput.value=""})):(i.showAlertModal("Invalid file, please select a .csv file","sm"),i.$refs.excelFileInput.value=""))},resourceUpdated:function(e){try{this.data=JSON.parse(this.resourceUpdateString),this.resourceUpdateCount--,this.resourceUpdateCount<=0&&(this.resourceUpdateString="")}catch(e){this.showAlertModal("Invalid file, please select a different file","sm"),this.resourceUpdateCount=0,this.resourceUpdateString=""}},saveClicked:function(e){e.target.blur(),"Project View"!=this.viewSelected&&"Resource View"!=this.viewSelected&&(this.saveResourceListItems(),this.saveHolidayItems(),this.savePermissionItems());var t={data:this.data,resources:this.resources,projectStartDate:null,projectEndDate:null,advanced:this.advanced},i=document.createElement("a"),n=new Blob([JSON.stringify(t).replace(/\,\"subtasks\"\:\[\]/g,"")],{type:"text/plain"});i.href=URL.createObjectURL(n),i.download=this.filename()+".gantt",i.click()},saveCloudClicked:function(e){if(e.target.blur(),"Project View"!=this.viewSelected&&"Resource View"!=this.viewSelected&&(this.saveResourceListItems(),this.saveHolidayItems(),this.savePermissionItems()),this.projectName=this.projectName.trim(),this.subscribed||this.trial)if(""==this.projectName)this.alertMessage.show=!1,this.alertMessage.message="Project Name cannot be empty.",this.alertMessage.variant="danger",this.alertMessage.show=!0;else if(this.allProjectNames.includes(this.projectName)&&this.projectName!=this.dbProjectName)this.alertMessage.show=!1,this.alertMessage.message="Project Name '"+this.projectName+"' is already in use. Please enter a different name.",this.alertMessage.variant="danger",this.alertMessage.show=!0;else if(this.unsaved()){this.setAccess(!1,"none"),this.alertMessage.show=!1,this.alertMessage.variant="success",this.alertMessage.message="";t=this;m.a.put("/gantt/gantt",{token:t.currentUser.token,gantt:{project_id:t.projectSelected,project_name:t.projectName,revision_note:t.revisionNotes,gantt_data:JSON.stringify(t.data).replace(/\,\"subtasks\"\:\[\]/g,""),gantt_resources:JSON.stringify(t.resources),gantt_settings:JSON.stringify(t.advanced)},permissions:t.permissions}).then(function(e){if(t.revisionNotes="",t.dbData=JSON.parse(JSON.stringify(t.data)),t.dbResources=JSON.parse(JSON.stringify(t.resources)),t.dbAdvanced=JSON.parse(JSON.stringify(t.advanced)),t.dbProjectName=t.projectName,t.dbPermissions=t.permissions,t.projectSelected==t.projectSelectionOptions[0].value)t.dbProjectList.push({project_id:t.projectSelected,project_name:t.projectName,access:"read/write"}),t.projectSelectionOptions.push({value:t.projectSelected,text:t.projectName}),t.projectSelectionOptions[0].value=f()(),t.allProjectNames.push(t.projectName);else{for(var i="",n=0;n<t.dbProjectList.length;n++)t.dbProjectList[n].project_id==t.projectSelected&&(t.dbProjectList[n].project_name=t.projectName);for(n=0;n<t.projectSelectionOptions.length;n++)t.projectSelectionOptions[n].value==t.projectSelected&&(i=t.projectSelectionOptions[n].text,t.projectSelectionOptions[n].text=t.projectName);for(n=0;n<t.allProjectNames.length;n++)t.allProjectNames[n]==i&&(t.allProjectNames[n]=t.projectName)}t.alertMessage.message='Project "'+t.projectName+'" saved successfully.',t.alertMessage.variant="success",t.alertMessage.show=!0,t.setAccess(!1,"read/write"),m.a.get("/gantt/revision-list",{params:{token:t.currentUser.token,project_id:t.projectSelected}}).then(function(e){t.revisionItems=JSON.parse(JSON.stringify(e.data))}).catch(function(e){})}).catch(function(e){t.alertMessage.message="Failed to save project. Please try again later.",t.alertMessage.variant="danger",t.alertMessage.show=!0,t.setAccess(!1,"read/write")})}else this.alertMessage.show=!1,this.alertMessage.message="No unsaved changes.",this.alertMessage.variant="success",this.alertMessage.show=!0;else{this.alertMessage.show=!1;var t=this;this.delay(500).then(function(e){t.alertMessage.message='You do not have an active subscription. You cannot save new changes and your data is subject to deletion. <a href="#/subscriptions/cloud">Subscribe Now</a>',t.alertMessage.variant="danger",t.alertMessage.show=!0}).catch(function(e){t.alertMessage.message='You do not have an active subscription. You cannot save new changes and your data is subject to deletion. <a href="#/subscriptions/cloud">Subscribe Now</a>',t.alertMessage.variant="danger",t.alertMessage.show=!0})}},macOSSpace:function(){try{-1!==navigator.userAgent.indexOf("Mac OS")&&(w["l"].remove(this.$refs.gantt.ej2Instances.treeGrid.grid.element,"keydown",this.$refs.gantt.ej2Instances.treeGrid.grid.selectionModule.keyDownHandler),this.$refs.gantt.ej2Instances.treeGrid.grid.selectionModule.keyDownHandler=function(e){(("chrome"===w["d"].info.name||"safari"===w["d"].info.name)&&(91===e.keyCode||93===e.keyCode)||"opera"===w["d"].info.name&&17===e.keyCode||"mozilla"===w["d"].info.name&&224===e.keyCode)&&(this.cmdKeyPressed=!0)},w["l"].add(this.$refs.gantt.ej2Instances.treeGrid.grid.element,"keydown",this.$refs.gantt.ej2Instances.treeGrid.grid.selectionModule.keyDownHandler,this.$refs.gantt.ej2Instances.treeGrid.grid.selectionModule))}catch(e){}},duplicateCloudClicked:function(e){e.target.blur(),this.showPromptModal(this.duplicateCloudClickedPrompted,"Please enter new name for the duplicated project:")},duplicateCloudClickedPrompted:function(){var e=this.promptModalParam1;if(e=e.trim(),""==e)this.alertMessage.show=!1,this.alertMessage.message="Project Name cannot be empty.",this.alertMessage.variant="danger",this.alertMessage.show=!0;else if(this.allProjectNames.includes(e))this.alertMessage.show=!1,this.alertMessage.message="Project Name '"+this.projectName+"' is already in use. Please enter a different name.",this.alertMessage.variant="danger",this.alertMessage.show=!0;else{this.alertMessage.show=!1,this.alertMessage.variant="success",this.alertMessage.message="";var t=this,i=f()();m.a.put("/gantt/gantt",{token:t.currentUser.token,gantt:{project_id:i,project_name:e,revision_note:"duplicated from '"+t.dbProjectName+"'",gantt_data:JSON.stringify(t.dbData),gantt_resources:JSON.stringify(t.dbResources),gantt_settings:JSON.stringify(t.dbAdvanced)},permissions:t.dbPermissions}).then(function(n){t.dbProjectList.push({project_id:i,project_name:e,access:"read/write"}),t.projectSelectionOptions.push({value:i,text:e}),t.allProjectNames.push(e),t.alertMessage.message='Project "'+e+'" saved successfully.',t.alertMessage.variant="success",t.alertMessage.show=!0}).catch(function(e){t.alertMessage.message="Failed to save project. Please try again later.",t.alertMessage.variant="danger",t.alertMessage.show=!0})}},cancelCloudClicked:function(e){e.target.blur(),this.unsaved()?this.showConfirmModal(this.cancelCloudClickedConfirmed,"Discard unsaved changes?","sm"):this.cancelCloudClickedConfirmed()},cancelCloudClickedConfirmed:function(){this.data=JSON.parse(JSON.stringify(this.dbData)),this.resources=JSON.parse(JSON.stringify(this.dbResources)),this.advanced=JSON.parse(JSON.stringify(this.dbAdvanced)),this.saveColumns(),this.timelineSettings.weekStartDay=JSON.parse(JSON.stringify(this.dbAdvanced.firstDayOfWeek)),this.dateFormat=this.dbAdvanced.dateFormat,this.timelineSettings.topTier.format=this.dbAdvanced.dateFormat,this.projectName=this.dbProjectName,this.revisionNotes="",this.permissions=JSON.parse(JSON.stringify(this.dbPermissions)),this.showGrid=!1,this.resourceListItems=JSON.parse(JSON.stringify(this.dbResources)),this.resourceListItems.push({resourceId:"",resourceName:""});for(var e=0;e<7-this.dbResources.length;e++)this.resourceListItems.push({resourceId:"",resourceName:""});for(this.projectStartDate=null,this.projectEndDate=null,this.workTimeItems=JSON.parse(JSON.stringify(this.dbAdvanced.workTime)),1==this.workTimeItems.length&&this.workTimeItems.push({from:-1,to:-1}),24==this.workTimeItems[0].to&&(this.workTimeItems[0].to=0),24==this.workTimeItems[1].to&&(this.workTimeItems[1].to=0),this.updateWorkTimeOptions(this.dbAdvanced.timeFormat),this.holidayItems=[],e=0;e<this.dbAdvanced.holidays.length;e++){var t=new Date(this.dbAdvanced.holidays[e].from),i=new Date(this.dbAdvanced.holidays[e].to);this.holidayItems.push({from:t.toISOString(),to:i.toISOString()})}for(this.holidayItems.push({from:null,to:null}),this.permissionItems=[],this.publicLinkSelect=0,e=0;e<this.dbPermissions.length;e++)"public-link"==this.dbPermissions[e].email?this.publicLinkSelect=1:this.permissionItems.push(this.dbPermissions[e]);for(this.permissionItems.push({email:"",access:"read",id:""}),e=this.adminAdvancedUserList.length-1;e>=0;e--)this.permissionItems.unshift({email:this.adminAdvancedUserList[e],access:"read/write",id:""});this.viewSelected="Project View",this.presetFilterSelected="All Tasks",this.showGantt=!1,this.currentView="Gantt",this.viewType="ProjectView"},deleteCloudClicked:function(e){e.target.blur(),this.showConfirmModal(this.deleteCloudClickedConfirmed,"Permanently delete this project and all its revisions?")},deleteCloudClickedConfirmed:function(){this.setAccess(!1,"none"),this.alertMessage.show=!1,this.alertMessage.variant="success",this.alertMessage.message="";var e=this;m.a.delete("/gantt/project",{data:{token:e.currentUser.token,project_id:e.projectSelected}}).then(function(t){for(var i="",n=0;n<e.projectSelectionOptions.length;n++)e.projectSelectionOptions[n].value==e.projectSelected&&(i=e.projectSelectionOptions[n].text,e.projectSelectionOptions.splice(n,1));for(var r=0;r<e.allProjectNames.length;r++)e.allProjectNames[r]==i&&e.allProjectNames.splice(r,1);e.projectSelected=e.projectSelectionOptions[0].value,e.newGantt(),e.projectName="",e.revisionNotes="",e.revisionItems=[],e.revisionCurrentPage=1,e.alertMessage.message="Project deleted successfully.",e.alertMessage.variant="success",e.alertMessage.show=!0,e.setAccess(!0,"read/write")}).catch(function(t){e.alertMessage.message="Failed to delete project. Please try again later.",e.alertMessage.variant="danger",e.alertMessage.show=!0,e.setAccess(!1,"read/write")})},importExcelClicked:function(e){e.target.blur(),!this.$route.params.hasOwnProperty("cloud")||this.unsaved()?this.showConfirmModal(this.importExcelClickedConfirmed,"Discard unsaved changes?","sm"):this.importExcelClickedConfirmed()},importExcelClickedConfirmed:function(){this.$refs.excelFileInput.click()},excelClicked:function(e){function t(e,i,n){var r="";if(null!=e.resources)for(var s=0;s<e.resources.length;s++)s>0&&(r+=","),r+=e.resources[s].resourceName.replace(/\"/g,'""');var a=new Date(e.StartDate),o=new Date(e.EndDate);if(a.setMinutes(a.getMinutes()-a.getTimezoneOffset()),o.setMinutes(o.getMinutes()-o.getTimezoneOffset()),n.push(i+","+e.TaskID+',"'+e.TaskName.replace(/\"/g,'""')+'",'+a.toISOString().substring(0,10)+","+o.toISOString().substring(0,10)+","+e.Duration+" "+e.DurationUnit+","+e.Progress+',"'+(null==e.Predecessor?"":e.Predecessor)+'","'+r+'",'+e.color+',"'+(null==e.info?"":e.info.replace(/\"/g,'""'))+'"'),e.subtasks&&e.subtasks.length>0)for(s=0;s<e.subtasks.length;s++)t(e.subtasks[s],i+1,n)}this.showAlertModal('Your data will be exported to a .csv file.<br><br>For some non-English regions, Microsoft Excel may open this file as a single column. If so, do not save, and:<br>1. Open a blank workbook<br>2. Select Data -> Get External Data -> From Text<br>3. Select the .csv file<br>4. Finish the Text Import Wizard with default values, except in Step 2, select "Comma" as the only delimiter');for(var i="Outline Level,ID,Name,Start,Finish,Duration,% Complete,Predecessors,Resource Names,Color,Notes\r\n",n=[],r=JSON.parse(JSON.stringify(this.data)),s=0;s<r.length;s++)t(r[s],1,n);i+=n.join("\r\n");var a=document.createElement("a"),o=new Blob([i],{type:"text/plain"});a.href=URL.createObjectURL(o),a.download=this.filename()+".csv",a.click()},pdfClicked:function(e){this.exportOption.pdf=!0,this.$route.params.hasOwnProperty("cloud")&&(this.subscribed||this.trial)?(this.exportOption.header="Project Name",this.exportOption.footer="None",this.exportOption.columns="Use 'Default Column Settings'",this.exportOption.timeline="Zoom to fit",this.exportOption.expandCollapse="Expand All",this.exportOption.resolution=1,this.exportOption.sort="None"):(this.exportOption.header="None",this.exportOption.footer="Powered by: onlinegantt.com",this.exportOption.columns="Task ID and Task Name",this.exportOption.timeline="Zoom to fit",this.exportOption.expandCollapse="Expand All",this.exportOption.resolution=1,this.exportOption.sort="None"),this.$root.$emit("bv::show::modal","exportModal")},imageClicked:function(e){this.exportOption.pdf=!1,this.$route.params.hasOwnProperty("cloud")&&(this.subscribed||this.trial)?(this.exportOption.header="Project Name",this.exportOption.footer="None",this.exportOption.columns="Use 'Default Column Settings'",this.exportOption.timeline="Zoom to fit",this.exportOption.expandCollapse="Expand All",this.exportOption.resolution=1,this.exportOption.sort="None"):(this.exportOption.header="None",this.exportOption.footer="Powered by: onlinegantt.com",this.exportOption.columns="Task ID and Task Name",this.exportOption.timeline="Zoom to fit",this.exportOption.expandCollapse="Expand All",this.exportOption.resolution=1,this.exportOption.sort="None"),this.$root.$emit("bv::show::modal","exportModal")},exportFunction:function(){try{if("Remaining Tasks"==this.presetFilterSelected)this.$refs.exportGantt.ej2Instances.sortModule.sortColumn("EndDate","Ascending",!1),this.$refs.exportGantt.ej2Instances.filterByColumn("Progress","lessthan",100,"and");else if("Overdue Tasks"==this.presetFilterSelected){var e=new Date;this.$refs.exportGantt.ej2Instances.sortModule.sortColumn("EndDate","Ascending",!1),this.$refs.exportGantt.ej2Instances.filterByColumn("Progress","lessthan",100,"and"),this.$refs.exportGantt.ej2Instances.filterByColumn("EndDate","lessthan",e,"and")}}catch(e){}try{if("Use Current Sorting"==this.exportOption.sort){this.$refs.exportGantt.ej2Instances.clearSorting();for(var t=0;t<this.$refs.gantt.ej2Instances.properties.sortSettings.columns.length;t++)this.$refs.exportGantt.ej2Instances.sortModule.sortColumn(this.$refs.gantt.ej2Instances.properties.sortSettings.columns[t].field,this.$refs.gantt.ej2Instances.properties.sortSettings.columns[t].direction,!0)}}catch(e){}try{"Use Current Expanded/Collapsed States"==this.exportOption.expandCollapse&&this.collapseTasks(this.$refs.exportGantt.ej2Instances,this.getCollapsedTasks(this.data))}catch(e){}try{if("Zoom to fit"==this.exportOption.timeline)this.$refs.exportGantt.fitToProject();else if(this.advanced.zoomLevel<0)for(t=0;t>this.advanced.zoomLevel;t--)this.$refs.exportGantt.ej2Instances.zoomIn();else for(t=0;t<this.advanced.zoomLevel;t++)this.$refs.exportGantt.ej2Instances.zoomOut()}catch(e){}try{"safari"===w["d"].info.name&&(document.getElementById("treeGridexportGanttContainer_gridcontrol_content_table").style.borderCollapse="collapse")}catch(e){}try{this.removeHeaderText("exportGanttContainerGanttChart")}catch(e){}var n=this,r=document.getElementById("exportGanttContainer");try{var s=36*this.$refs.exportGantt.ej2Instances.treeGrid.getVisibleRecords().length,a=(s+64).toString()+"px",o=s.toString()+"px";r.style.height=a,r.querySelector(".e-gantt-splitter").style.height=a,r.querySelector("#treeGridexportGanttContainer_gridcontrol").querySelector(".e-gridcontent").querySelector(".e-content").style.height=o,r.querySelector("#treeGridexportGanttContainer_gridcontrol").querySelector(".e-gridcontent").querySelector(".e-content").style.setProperty("overflow","hidden","important"),r.querySelector("#exportGanttContainerGanttChart").querySelector(".e-chart-root-container").querySelector(".e-content").style.height=o,r.querySelector("#exportGanttContainerGanttChart").querySelector(".e-chart-root-container").querySelector(".e-content").style.setProperty("overflow","hidden","important"),r.querySelector("#exportGanttContainerline-container").style.height=o,r.querySelector("#exportGanttContainerline-container").style.top="0px"}catch(e){}try{r.querySelector("#exportGanttContainerGanttChart").querySelector(".e-chart-root-container").querySelector(".e-content").querySelector(".e-nonworking-day-container").querySelector(".e-weekend-container").style.height=o,r.querySelector("#exportGanttContainerGanttChart").querySelector(".e-chart-root-container").querySelector(".e-content").querySelector(".e-nonworking-day-container").querySelector(".e-weekend-container").style.top="0px"}catch(e){}try{r.querySelector("#exportGanttContainerGanttChart").querySelector(".e-chart-root-container").querySelector(".e-content").querySelector(".e-nonworking-day-container").querySelector(".e-holiday-container").style.height=o,r.querySelector("#exportGanttContainerGanttChart").querySelector(".e-chart-root-container").querySelector(".e-content").querySelector(".e-nonworking-day-container").querySelector(".e-holiday-container").style.top="0px"}catch(e){}try{r.querySelector("#exportGanttContainerGanttChart").querySelector(".e-event-markers").style.setProperty("border-left-width","3px","important")}catch(e){}try{if("Zoom to fit"!=this.exportOption.timeline){var l=r.querySelector(".e-chart-rows-container").clientWidth,d=r.querySelector("#exportGanttContainerGanttChart").clientWidth,c=document.getElementById("exportGanttContainerHiddenDiv").clientWidth,h=Number(l)-Number(d)+Number(c);if("Task ID and Task Name"==this.exportOption.columns)var p=420;else p=this.getSplitterPosition()-30;this.$refs.exportGantt.setSplitterPosition(p*Number(c)/Number(h)+"px","position"),document.getElementById("exportGanttContainerHiddenDiv").style.width=h+"px"}}catch(e){}this.delay(1e3).then(function(e){n.exportPdf&&i.e("chunk-2d0d619d").then(i.t.bind(null,"70b0",7)).then(function(e){i.e("chunk-ab62a6d8").then(i.bind(null,"e198")).then(function(t){var i=document.getElementById("exportGanttContainerDiv"),r=1;Math.max(i.offsetHeight*n.exportOption.resolution,i.offsetWidth*n.exportOption.resolution)>14400&&(r=14400/Math.max(i.offsetHeight*n.exportOption.resolution,i.offsetWidth*n.exportOption.resolution));var s={height:i.offsetHeight*n.exportOption.resolution*r,width:i.offsetWidth*n.exportOption.resolution*r,style:{transform:"scale("+n.exportOption.resolution*r+")",transformOrigin:"top left",width:i.offsetWidth+"px",height:i.offsetHeight+"px"}};e.toBlob(i,s).then(function(e){n.exportPdf=!1,n.exportEventMarkers=[];var i=URL.createObjectURL(e);fetch(i).then(function(e){return e.arrayBuffer()}).then(function(e){t.PDFDocument.create().then(function(t){t.embedPng(e).then(function(e){var i=t.addPage();i.setHeight(e.height),i.setWidth(e.width),i.drawImage(e,{}),t.save().then(function(e){var t=new Blob([e],{type:"application/pdf"}),i=document.createElement("a");i.href=URL.createObjectURL(t),i.download=n.filename()+".pdf",i.click()})})})})}).catch(function(e){n.exportPdf=!1,n.exportEventMarkers=[],"mozilla"===w["d"].info.name?n.showAlertModal("Export failed, if you are using Firefox please try a different web browser such as Chrome or Edge"):"safari"===w["d"].info.name?n.showAlertModal("Export failed, if you are using Safari please try a different web browser such as Chrome"):n.showAlertModal("Export failed","sm")})})}),n.exportImage&&i.e("chunk-2d0d619d").then(i.t.bind(null,"70b0",7)).then(function(e){var t=document.getElementById("exportGanttContainerDiv"),i={height:t.offsetHeight*n.exportOption.resolution,width:t.offsetWidth*n.exportOption.resolution,style:{transform:"scale("+n.exportOption.resolution+")",transformOrigin:"top left",width:t.offsetWidth+"px",height:t.offsetHeight+"px"}};e.toBlob(t,i).then(function(e){n.exportImage=!1,n.exportEventMarkers=[];var t=document.createElement("a");t.href=URL.createObjectURL(e),t.download=n.filename()+".png",t.click()}).catch(function(e){n.exportImage=!1,n.exportEventMarkers=[],"mozilla"===w["d"].info.name?n.showAlertModal("Export failed, if you are using Firefox please try a different web browser such as Chrome or Edge"):"safari"===w["d"].info.name?n.showAlertModal("Export failed, if you are using Safari please try a different web browser such as Chrome"):n.showAlertModal("Export failed","sm")})})}).catch(function(e){})},projectChanged:function(e,t){document.getElementById("projectSelection").blur(),""==this.undoProjectChanged&&(this.unsaved()?this.showConfirmModal(this.projectChangedConfirmed,"Discard unsaved changes?","sm",t,e,!1,this.projectChangedCancelled):(this.confirmModalParam1=t,this.projectChangedConfirmed()))},projectChangedConfirmed:function(){var e=this.confirmModalParam1;if(e==this.projectSelectionOptions[0].value)this.newGantt(),this.projectName="",this.revisionNotes="",this.revisionItems=[],this.revisionCurrentPage=1,this.setAccess(!0,"guest (free)"==this.currentUser.role?"read":"read/write");else{this.revisionItems=[],this.revisionCurrentPage=1,this.setAccess(!1,"none");var t=this;m.a.get("/gantt/gantt",{params:{token:t.currentUser.token,project_id:e}}).then(function(i){t.data=JSON.parse(i.data.gantt_data),t.resources=JSON.parse(i.data.gantt_resources);var n=JSON.parse(i.data.gantt_settings);n.hasOwnProperty("columns")?n.columns.length<9&&n.columns.push({name:"Color",width:"100",show:!1}):n.columns=[{name:"Task ID",width:"70",show:!0},{name:"Task Name",width:"350",show:!0},{name:"Start Date",width:"130",show:!1},{name:"End Date",width:"130",show:!1},{name:"Duration",width:"130",show:!1},{name:"Progress %",width:"150",show:!1},{name:"Dependency",width:"150",show:!1},{name:"Resources",width:"200",show:!1},{name:"Color",width:"100",show:!1}],n.hasOwnProperty("firstDayOfWeek")||(n.firstDayOfWeek=0),n.hasOwnProperty("zoomLevel")||(n.zoomLevel=0),n.hasOwnProperty("dependencyConflict")||(n.dependencyConflict="Add Offset to Dependency"),n.hasOwnProperty("timezone")||(n.timezone=t.advanced.timezone),n.timezone!=t.advanced.timezone&&(""!=n.timezone&&""!=t.advanced.timezone&&t.updateTimezoneOffsetByDate(t.data,n.timezone,t.advanced.timezone),n.timezone=t.advanced.timezone),n.hasOwnProperty("timezoneOffset")||(n.timezoneOffset=t.advanced.timezoneOffset),n.timezoneOffset!=t.advanced.timezoneOffset&&(n.timezoneOffset=t.advanced.timezoneOffset),n.hasOwnProperty("dateFormat")||(n.dateFormat="yyyy-MM-dd"),n.hasOwnProperty("timeFormat")||(n.timeFormat="HH:mm"),n.hasOwnProperty("workTime")||(n.workTime=[{from:8,to:12},{from:13,to:17}]),t.advanced=JSON.parse(JSON.stringify(n)),t.saveColumns(),t.timelineSettings.weekStartDay=n.firstDayOfWeek,t.dateFormat=n.dateFormat,t.timelineSettings.topTier.format=n.dateFormat,t.projectName=i.data.project_name,t.revisionNotes="",t.showGrid=!1,t.resourceListItems=JSON.parse(i.data.gantt_resources);var r=t.resourceListItems.length;t.resourceListItems.push({resourceId:"",resourceName:""});for(var s=0;s<7-r;s++)t.resourceListItems.push({resourceId:"",resourceName:""});for(t.projectStartDate=null,t.projectEndDate=null,t.workTimeItems=JSON.parse(JSON.stringify(t.advanced.workTime)),1==t.workTimeItems.length&&t.workTimeItems.push({from:-1,to:-1}),24==t.workTimeItems[0].to&&(t.workTimeItems[0].to=0),24==t.workTimeItems[1].to&&(t.workTimeItems[1].to=0),t.updateWorkTimeOptions(t.advanced.timeFormat),t.holidayItems=[],s=0;s<t.advanced.holidays.length;s++){var a=new Date(t.advanced.holidays[s].from),o=new Date(t.advanced.holidays[s].to);t.holidayItems.push({from:a.toISOString(),to:o.toISOString()})}t.holidayItems.push({from:null,to:null}),t.dbData=JSON.parse(JSON.stringify(t.data)),t.dbResources=JSON.parse(i.data.gantt_resources),t.dbAdvanced=JSON.parse(JSON.stringify(n)),t.dbProjectName=i.data.project_name,t.viewSelected="Project View",t.presetFilterSelected="All Tasks",t.showGantt=!1,t.currentView="Gantt",t.viewType="ProjectView";var l="read";for(s=0;s<t.dbProjectList.length;s++)e==t.dbProjectList[s].project_id&&(l=t.dbProjectList[s].access);t.setAccess(!1,l)}).catch(function(e){t.newGantt(),t.projectName="",t.revisionNotes="",t.alertMessage.show=!1,t.alertMessage.message="Failed to open project. Please try again later.",t.alertMessage.variant="danger",t.alertMessage.show=!0,console.log(e),console.log(t.advanced.timezone)}),m.a.get("/gantt/permissions",{params:{token:t.currentUser.token,project_id:e}}).then(function(e){for(var i=[],n=0;n<e.data.length;n++)for(var r=0;r<t.permissionUserList.length;r++)e.data[n].email==t.permissionUserList[r].value&&i.push(e.data[n]);for(n=0;n<i.length;n++)for(r=0;r<t.guestUserList.length;r++)i[n].email==t.guestUserList[r]&&(i[n].access="read");for(t.permissionItems=JSON.parse(JSON.stringify(i)),t.permissionItems.push({email:"",access:"read",id:""}),n=t.adminAdvancedUserList.length-1;n>=0;n--)t.permissionItems.unshift({email:t.adminAdvancedUserList[n],access:"read/write",id:""});for(t.publicLinkSelect=0,n=0;n<e.data.length;n++)"public-link"==e.data[n].email&&(t.publicLinkSelect=1);1==t.publicLinkSelect&&i.push({email:"public-link",access:"read",id:""}),t.permissions=JSON.parse(JSON.stringify(i)),t.dbPermissions=JSON.parse(JSON.stringify(i))}).catch(function(e){t.alertMessage.show=!1,t.alertMessage.message="Failed to open project. Please try again later.",t.alertMessage.variant="danger",t.alertMessage.show=!0}),m.a.get("/gantt/revision-list",{params:{token:t.currentUser.token,project_id:e}}).then(function(e){t.revisionItems=JSON.parse(JSON.stringify(e.data))}).catch(function(e){})}},projectChangedCancelled:function(){var e=this.confirmModalParam2;this.undoProjectChanged=e},viewChanged:function(e){document.getElementById("view").blur(),"Project View"==e?(this.presetFilterSelected="All Tasks",this.showGantt=!1,this.currentView="Gantt",this.viewType="ProjectView",this.saveResourceListItems(),this.saveHolidayItems(),this.savePermissionItems(),this.ganttReadOnly?this.contextMenuItems=this.contextMenuItemsReadOnly:this.contextMenuItems=this.contextMenuItemsReadWrite):"Resource View"==e?(this.presetFilterSelected="All Tasks",this.showGantt=!1,this.currentView="Gantt",this.viewType="ResourceView",this.saveResourceListItems(),this.saveHolidayItems(),this.savePermissionItems(),this.data=JSON.parse(JSON.stringify(this.data).replace(/\,\"subtasks\"\:\[\]/g,"")),this.contextMenuItems=this.contextMenuItemsReadOnly):"Edit Resources"==e?(this.presetFilterSelected="All Tasks",this.currentView="Resource List",this.saveHolidayItems(),this.savePermissionItems()):"Edit Settings"==e?(this.presetFilterSelected="All Tasks",this.currentView="Advanced",this.saveResourceListItems(),this.savePermissionItems()):"Share"==e?(this.presetFilterSelected="All Tasks",this.currentView="Permission",this.saveResourceListItems(),this.saveHolidayItems()):"Revisions"==e&&(this.presetFilterSelected="All Tasks",this.currentView="Revision",this.saveResourceListItems(),this.saveHolidayItems(),this.savePermissionItems())},presetFilterChanged:function(e){if(document.getElementById("presetFilter").blur(),"All Tasks"==e)this.$refs.gantt.ej2Instances.clearSorting(),this.$refs.gantt.ej2Instances.clearFiltering(),this.$refs.gantt.ej2Instances.searchSettings.key="";else if("Remaining Tasks"==e)this.$refs.gantt.ej2Instances.clearSorting(),this.$refs.gantt.ej2Instances.clearFiltering(),this.$refs.gantt.ej2Instances.searchSettings.key="",this.$refs.gantt.ej2Instances.sortModule.sortColumn("EndDate","Ascending",!1),this.$refs.gantt.ej2Instances.filterByColumn("Progress","lessthan",100,"and");else if("Overdue Tasks"==e){this.$refs.gantt.ej2Instances.clearSorting(),this.$refs.gantt.ej2Instances.clearFiltering(),this.$refs.gantt.ej2Instances.searchSettings.key="";var t=new Date;this.$refs.gantt.ej2Instances.sortModule.sortColumn("EndDate","Ascending",!1),this.$refs.gantt.ej2Instances.filterByColumn("Progress","lessthan",100,"and"),this.$refs.gantt.ej2Instances.filterByColumn("EndDate","lessthan",t,"and")}},todayChanged:function(e){if(e){var t=this.todayFullDateString();this.eventMarkers=[{day:t}],this.$refs.gantt.ej2Instances.scrollToDate(t)}else this.eventMarkers=[]},updateDataResources:function(e,t){var i=0;if(e.hasOwnProperty("resources")){var n=[];for(i=0;i<e.resources.length;i++)e.resources[i].hasOwnProperty("resourceName")&&t.includes(e.resources[i].resourceName)&&n.push(e.resources[i]);e.resources=n}if(e.hasOwnProperty("subtasks"))for(i=0;i<e.subtasks.length;i++)this.updateDataResources(e.subtasks[i],t)},saveResourceListItems:function(){var e=[],t=0;for(t=0;t<this.resourceListItems.length;t++)this.resourceListItems[t].resourceName=this.resourceListItems[t].resourceName.trim(),""==this.resourceListItems[t].resourceName||e.includes(this.resourceListItems[t].resourceName)||e.push(this.resourceListItems[t].resourceName);e.sort();var i=[],n=0;for(t=0;t<e.length;t++){for(n=0;n<this.resources.length;n++)if(this.resources[n].resourceName.trim()==e[t])break;n>=this.resources.length?i.push({resourceId:e[t],resourceName:e[t]}):i.push({resourceId:this.resources[n].resourceId,resourceName:e[t]})}for(t=0;t<this.data.length;t++)this.updateDataResources(this.data[t],e);for(this.resources=JSON.parse(JSON.stringify(i)),this.showGrid=!1,i.push({resourceId:"",resourceName:""}),t=0;t<7-this.resources.length;t++)i.push({resourceId:"",resourceName:""});this.resourceListItems=JSON.parse(JSON.stringify(i))},saveHolidayItems:function(){var e=[],t=0;for(t=0;t<this.holidayItems.length;t++)null!=this.holidayItems[t].from&&null!=this.holidayItems[t].to&&this.holidayItems[t].from<=this.holidayItems[t].to&&e.push(this.holidayItems[t]);for(e.sort(function(e,t){return e.from>=t.from?1:-1}),this.holidayItems=JSON.parse(JSON.stringify(e)),this.holidayItems.push({from:null,to:null}),t=0;t<e.length;t++){var i=new Date(e[t].from),n=new Date(e[t].to);e[t].from=i.toISOString(),e[t].to=n.toISOString()}this.advanced.holidays=JSON.parse(JSON.stringify(e)),(this.workTimeItems[0].from>=this.workTimeItems[0].to||-1==this.workTimeItems[0].from||-1==this.workTimeItems[0].to)&&(this.workTimeItems[0].from=-1,this.workTimeItems[0].to=-1),(this.workTimeItems[1].from>=this.workTimeItems[1].to||-1==this.workTimeItems[1].from||-1==this.workTimeItems[1].to)&&(this.workTimeItems[1].from=-1,this.workTimeItems[1].to=-1),-1==this.workTimeItems[0].from&&-1==this.workTimeItems[0].to&&(this.workTimeItems[0].from=this.workTimeItems[1].from,this.workTimeItems[0].to=this.workTimeItems[1].to,this.workTimeItems[1].from=-1,this.workTimeItems[1].to=-1),-1!=this.workTimeItems[0].from&&-1!=this.workTimeItems[0].to&&-1!=this.workTimeItems[1].from&&-1!=this.workTimeItems[1].to&&Math.min(this.workTimeItems[0].to,this.workTimeItems[1].to)>=Math.max(this.workTimeItems[0].from,this.workTimeItems[1].from)&&(this.workTimeItems[0].from=Math.min(this.workTimeItems[0].from,this.workTimeItems[1].from),this.workTimeItems[0].to=Math.max(this.workTimeItems[0].to,this.workTimeItems[1].to),this.workTimeItems[1].from=-1,this.workTimeItems[1].to=-1),-1==this.workTimeItems[0].from&&-1==this.workTimeItems[0].to&&-1==this.workTimeItems[1].from&&-1==this.workTimeItems[1].to&&(this.workTimeItems=[{from:8,to:12},{from:13,to:17}]),-1==this.workTimeItems[1].from?this.advanced.workTime=[{from:this.workTimeItems[0].from,to:this.workTimeItems[0].to}]:this.advanced.workTime=[{from:this.workTimeItems[0].from,to:this.workTimeItems[0].to},{from:this.workTimeItems[1].from,to:this.workTimeItems[1].to}],24==this.workTimeItems[0].to&&(this.workTimeItems[0].to=0),24==this.workTimeItems[1].to&&(this.workTimeItems[1].to=0),this.timelineSettings.weekStartDay=this.advanced.firstDayOfWeek,this.dateFormat=this.advanced.dateFormat,this.timelineSettings.topTier.format=this.advanced.dateFormat,this.saveColumns()},savePermissionItems:function(){var e=[],t=0;for(t=this.adminAdvancedUserList.length;t<this.permissionItems.length;t++)""==this.permissionItems[t].email||e.includes(this.permissionItems[t].email)||e.push(this.permissionItems[t].email);var i=[],n=0;for(t=0;t<this.adminAdvancedUserList.length;t++)i.push({email:this.permissionItems[t].email,access:"read/write",id:""});for(t=0;t<this.userList.length;t++)if(e.includes(this.userList[t].value))for(i.push({email:this.userList[t].value,access:"read",id:""}),n=0;n<this.permissionItems.length;n++)this.permissionItems[n].email!=this.userList[t].value||"read/write"!=this.permissionItems[n].access||this.guestUserList.includes(this.permissionItems[n].email)||(i[i.length-1].access="read/write");this.permissionItems=JSON.parse(JSON.stringify(i)),this.permissionItems.push({email:"",access:"read",id:""}),this.publicLinkSelect&&i.push({email:"public-link",access:"read",id:""}),this.permissions=JSON.parse(JSON.stringify(i.slice(this.adminAdvancedUserList.length)))},saveColumns:function(){var e=[];this.advanced.columns[0].show&&e.push({field:"TaskID",width:this.advanced.columns[0].width}),this.advanced.columns[1].show&&e.push({field:"TaskName",width:this.advanced.columns[1].width,headerText:"Task Name",clipMode:"EllipsisWithTooltip"}),this.advanced.columns[2].show&&e.push({field:"StartDate",width:this.advanced.columns[2].width,headerText:"Start"}),this.advanced.columns[3].show&&e.push({field:"EndDate",width:this.advanced.columns[3].width,headerText:"End"}),this.advanced.columns[4].show&&e.push({field:"Duration",width:this.advanced.columns[4].width}),this.advanced.columns[5].show&&e.push({field:"Progress",width:this.advanced.columns[5].width,headerText:"Progress %"}),this.advanced.columns[6].show&&e.push({field:"Predecessor",width:this.advanced.columns[6].width}),this.advanced.columns[7].show&&e.push({field:"resources",width:this.advanced.columns[7].width,headerText:"Resources",clipMode:"EllipsisWithTooltip"}),this.advanced.columns[8].show&&(e.push({field:"color",width:this.advanced.columns[8].width,headerText:"Color",editType:"dropdownedit",template:'<div style="width:100%;height:100%;"><img src="img/color/color${color}.png" height="26px" width="26px"/></div>'}),e[e.length-1].edit=this.dpParams),this.advanced.columns[0].show||e.push({field:"TaskID",width:this.advanced.columns[0].width}),this.advanced.columns[1].show||e.push({field:"TaskName",width:this.advanced.columns[1].width,headerText:"Task Name",clipMode:"EllipsisWithTooltip"}),this.advanced.columns[2].show||e.push({field:"StartDate",width:this.advanced.columns[2].width,headerText:"Start"}),this.advanced.columns[3].show||e.push({field:"EndDate",width:this.advanced.columns[3].width,headerText:"End"}),this.advanced.columns[4].show||e.push({field:"Duration",width:this.advanced.columns[4].width}),this.advanced.columns[5].show||e.push({field:"Progress",width:this.advanced.columns[5].width,headerText:"Progress %"}),this.advanced.columns[6].show||e.push({field:"Predecessor",width:this.advanced.columns[6].width}),this.advanced.columns[7].show||e.push({field:"resources",width:this.advanced.columns[7].width,headerText:"Resources",clipMode:"EllipsisWithTooltip"}),this.advanced.columns[8].show||(e.push({field:"color",width:this.advanced.columns[8].width,headerText:"Color",editType:"dropdownedit",template:'<div style="width:100%;height:100%;"><img src="img/color/color${color}.png" height="26px" width="26px"/></div>'}),e[e.length-1].edit=this.dpParams),this.columns=e;for(var t=0,i=0;i<this.advanced.columns.length;i++)this.advanced.columns[i].show&&t++;this.splitterSettings.columnIndex=t,this.advanced.columns[0].show&&this.advanced.columns[1].show?this.treeColumnIndex=1:!this.advanced.columns[0].show&&this.advanced.columns[1].show?this.treeColumnIndex=0:this.advanced.columns[0].show?this.treeColumnIndex=t:this.treeColumnIndex=t+1},getSplitterPosition:function(){for(var e=0,t=0;t<this.advanced.columns.length;t++)this.advanced.columns[t].show&&(e+=Number(this.advanced.columns[t].width));return e+=30,e},filename:function(){var e=new Date,t=e.getFullYear(),i=t.toString(),n=e.getMonth()+1;if(n<10)var r="0"+n.toString();else r=n.toString();var s=e.getDate();if(s<10)var a="0"+s.toString();else a=s.toString();return this.$route.params.hasOwnProperty("cloud")?this.filenameValidString(this.projectName)+" "+i+r+a:"Online Gantt "+i+r+a},filenameValidString:function(e){return e.replace(/\</g,"").replace(/\>/g,"").replace(/\:/g,"").replace(/\"/g,"").replace(/\//g,"").replace(/\\/g,"").replace(/\|/g,"").replace(/\?/g,"").replace(/\*/g,"")},todayDateString:function(){var e=new Date,t=e.getFullYear(),i=t.toString(),n=e.getMonth()+1;if(n<10)var r="0"+n.toString();else r=n.toString();var s=e.getDate();if(s<10)var a="0"+s.toString();else a=s.toString();return i+"-"+r+"-"+a},todayFullDateString:function(){var e=new Date(this.todayDateString());return e.setMinutes(e.getMinutes()+e.getTimezoneOffset()),e.toISOString()},todaySlashDateString:function(){var e=new Date,t=e.getFullYear(),i=t.toString(),n=e.getMonth()+1;if(n<10)var r="0"+n.toString();else r=n.toString();var s=e.getDate();if(s<10)var a="0"+s.toString();else a=s.toString();return r+"/"+a+"/"+i},getMondayDateString:function(e,t){var i=new Date;i.setDate(i.getDate()-(0==i.getDay()?6:i.getDay()-1)+e);var n=new Date(i.getFullYear()+"-"+(i.getMonth()<9?"0":"")+(i.getMonth()+1)+"-"+(i.getDate()<10?"0":"")+i.getDate());return n.setMinutes(n.getMinutes()+60*t+n.getTimezoneOffset()),n.toISOString()},getTuesdayDateString:function(){var e=new Date;return e.setDate(e.getDate()-(e.getDay()<=1?e.getDay()+5:e.getDay()-2)),e.getFullYear()+"-"+(e.getMonth()<9?"0":"")+(e.getMonth()+1)+"-"+(e.getDate()<10?"0":"")+e.getDate()},getEarliestDate:function(e){for(var t,i,n=new Date("2100-01-01T00:00:00.000Z"),r=0;r<e.length;r++)e[r].hasOwnProperty("StartDate")&&(t=e[r].StartDate instanceof Date?e[r].StartDate:new Date(e[r].StartDate),t<n&&(n=t),e[r].hasOwnProperty("subtasks")&&e[r].subtasks.length>0&&(i=this.getEarliestDate(e[r].subtasks),i<n&&(n=i)));return n},getLatestDate:function(e){for(var t,i,n=new Date("1970-01-01T00:00:00.000Z"),r=0;r<e.length;r++)e[r].hasOwnProperty("EndDate")&&(t=e[r].EndDate instanceof Date?e[r].EndDate:new Date(e[r].EndDate),t>n&&(n=t),e[r].hasOwnProperty("subtasks")&&e[r].subtasks.length>0&&(i=this.getLatestDate(e[r].subtasks),i>n&&(n=i)));return n},getDurationDays:function(e,t){for(var i=0,n=864e5,r=!1,s=!1,a=!1,o=!1,l=!1,d=!1,c=!1,h=0;h<this.advanced.workWeek.length;h++)"Monday"==this.advanced.workWeek[h]&&(r=!0),"Tuesday"==this.advanced.workWeek[h]&&(s=!0),"Wednesday"==this.advanced.workWeek[h]&&(a=!0),"Thursday"==this.advanced.workWeek[h]&&(o=!0),"Friday"==this.advanced.workWeek[h]&&(l=!0),"Saturday"==this.advanced.workWeek[h]&&(d=!0),"Sunday"==this.advanced.workWeek[h]&&(c=!0);h=e.getTime();for(var p,u=t.getTime();h<=u;h+=n)p=new Date(h).getDay(),0===p&&c?i++:1===p&&r?i++:2===p&&s?i++:3===p&&a?i++:4===p&&o?i++:5===p&&l?i++:6===p&&d&&i++;return p=t.getDay(),(0===p&&!c||1===p&&!r||2===p&&!s||3===p&&!a||4===p&&!o||5===p&&!l||6===p&&!d)&&i++,i},getCollapsedTasks:function(e){for(var t=[],i=0;i<e.length;i++)this.$refs.gantt.ej2Instances.getRecordByID(e[i].TaskID).expanded||t.push(e[i].TaskID),e[i].hasOwnProperty("subtasks")&&t.push.apply(t,c(this.getCollapsedTasks(e[i].subtasks)));return t},collapseTasks:function(e,t){for(var i=0;i<t.length;i++)e.collapseByID(t[i])},delay:function(e){return new Promise(function(t){return setTimeout(t,e)})},initializeGantt:function(){try{var e=this.getSplitterPosition().toString()+"px";this.$refs.gantt.ej2Instances.setSplitterPosition(e,"position"),this.ganttReadOnly||this.macOSSpace()}catch(e){}},initializeUser:function(){if(this.$route.params.hasOwnProperty("cloud")){document.title="Online Gantt Chart Software";var e=f()();this.projectSelectionOptions=[{value:e,text:"Create New Project"},{value:e,text:"Please wait..."}],this.projectSelected=e,this.newGantt(),this.projectName="",this.revisionNotes="",this.revisionItems=[],this.revisionCurrentPage=1,this.setAccess(!0,"none");var t=this;i.e("chunk-2229c078").then(i.bind(null,"4c44")).then(function(e){var i=new e.CognitoUserPool(p["a"]),n=i.getCurrentUser();null!=n&&n.getSession(function(e,i){i.isValid()&&(t.currentUser.cognitoUser=n,t.currentUser.token=i.getIdToken().getJwtToken(),n.getUserAttributes(function(e,i){if(!e){for(var n=0;n<i.length;n++)"family_name"==i[n].getName()?t.currentUser.company=i[n].getValue():"given_name"==i[n].getName()?t.currentUser.role=i[n].getValue():"email"==i[n].getName()&&(t.currentUser.email=i[n].getValue());t.setAccess(!0,"guest (free)"==t.currentUser.role?"read":"read/write"),"guest (free)"==t.currentUser.role&&(t.showGantt=!1),m.a.get("/gantt/project-list",{params:{token:t.currentUser.token}}).then(function(e){t.dbProjectList=JSON.parse(JSON.stringify(e.data));for(var i=0;i<t.dbProjectList.length;i++)t.projectSelectionOptions.push({value:e.data[i].project_id,text:e.data[i].project_name});t.projectSelectionOptions.splice(1,1),0!=e.data.length||"standard"!=t.currentUser.role&&"guest (free)"!=t.currentUser.role||t.alertMessage.show||(t.alertMessage.show=!1,t.alertMessage.message='Note you cannot access your team\'s projects until they share with you (they can select "Share" in the menu to the upper right of the gantt chart).',t.alertMessage.variant="info",t.alertMessage.show=!0)}).catch(function(e){}),m.a.get("/user-admin/employees",{params:{token:t.currentUser.token}}).then(function(e){for(var i=[],n=[],r=[],s=[],a=0;a<e.data.length;a++)i.push({value:e.data[a].email,text:e.data[a].name}),"administrator"==e.data[a].role||"advanced"==e.data[a].role?r.push(e.data[a].email):(n.push({value:e.data[a].email,text:e.data[a].name}),"guest (free)"==e.data[a].role&&s.push(e.data[a].email));for(t.userList=JSON.parse(JSON.stringify(i)),t.permissionUserList=JSON.parse(JSON.stringify(n)),t.permissionUserList.unshift({value:"",text:""}),t.adminAdvancedUserList=JSON.parse(JSON.stringify(r)),t.guestUserList=JSON.parse(JSON.stringify(s)),t.permissionItems=[{email:"",access:"read",id:""}],a=t.adminAdvancedUserList.length-1;a>=0;a--)t.permissionItems.unshift({email:t.adminAdvancedUserList[a],access:"read/write",id:""})}).catch(function(e){}),m.a.get("/gantt/all-project-names",{params:{token:t.currentUser.token}}).then(function(e){for(var i=0;i<e.data.length;i++)t.allProjectNames.push(e.data[i].project_name)}).catch(function(e){}),m.a.get("/user-admin/stripe-subscription",{params:{token:t.currentUser.token}}).then(function(e){t.subscribed=e.data.subscribed,t.subscribed||m.a.get("/user-admin/stripe-trial",{params:{token:t.currentUser.token}}).then(function(e){t.trial=e.data.trial,t.trial||(t.alertMessage.show=!1,t.alertMessage.message='You do not have an active subscription. You cannot save new changes and your data is subject to deletion. <a href="#/subscriptions/cloud">Subscribe Now</a>',t.alertMessage.variant="danger",t.alertMessage.show=!0)}).catch(function(e){t.trial=!0})}).catch(function(e){t.subscribed=!0})}}))})})}else this.currentUser.cognitoUser=null,this.currentUser.token="",this.currentUser.company="",this.currentUser.role="",this.currentUser.email="",this.subscribed=!0,this.trial=!0},welcome:function(){if(this.$route.params.hasOwnProperty("cloud"))for(var e,t=document.cookie.split(";"),i=0;i<t.length;i++)if(e=t[i].split("="),"onlinegantt_welcome"==e[0].trim()&&"1"==e[1].trim()){document.cookie="onlinegantt_welcome=0; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/",this.$root.$emit("bv::show::modal","welcomeModal");break}},getIndexByID:function(e){for(var t=this.$refs.gantt.ej2Instances.treeGrid.getCurrentViewRecords(),i=0;i<t.length;i++)if(t[i].TaskID==e)return i;return-1},contextMenuOpen:function(e){},contextMenuClick:function(e){"customaddtaskabove"!==e.item.id&&"customaddtaskbelow"!==e.item.id&&"customaddtasksub"!==e.item.id&&"customaddtaskmilestone"!==e.item.id&&"duplicatetask"!==e.item.id||(this.collapsedTasks=this.getCollapsedTasks(this.data),this.data=this.customAddTask(this.data,e.rowData.ganttProperties.taskId,e.item.id),this.refreshSplitterPosition=document.getElementById("treeGridGanttContainer_gridcontrol").clientWidth,this.refreshSplitter=!0)},resetClicked:function(e){e.target.blur(),this.showConfirmModal(this.resetClickedConfirmed,"This will reset all task IDs for this project to be in sequential order, continue?")},resetClickedConfirmed:function(){var e=JSON.parse(JSON.stringify(this.data)),t=1,i={};function n(e){i[e.TaskID]=t,e.TaskID=t++,e.subtasks&&e.subtasks.length>0&&e.subtasks.forEach(n)}function r(e){if(e.Predecessor){var t=e.Predecessor.split(","),n=t.map(function(e){var t=e.match(/^(\d+)(.*)/),n=t[1],r=t[2];return i[n]+r});e.Predecessor=n.join(",")}e.subtasks&&e.subtasks.length>0&&e.subtasks.forEach(r)}e.forEach(n),e.forEach(r),this.data=JSON.parse(JSON.stringify(e)),this.$route.params.hasOwnProperty("cloud")?this.showAlertModal("Reset completed. Make sure you save the changes."):this.showAlertModal("Reset completed.","sm")},timeFormatChanged:function(e){this.updateWorkTimeOptions(e)},updateWorkTimeOptions:function(e){this.workTimeOptions="HH:mm"==e?this.workTime24HourOptions:this.workTime12HourOptions},revisionDownloadClicked:function(e,t){e.target.blur();var i=(this.revisionCurrentPage-1)*this.revisionPerPage+t,n=this.revisionItems[i].timestamp.replace(/-/g,"").replace(/:/g,"").replace("T"," ").replace(".000Z","");this.alertMessage.show=!1,this.alertMessage.variant="success",this.alertMessage.message="";var r=this;m.a.get("/gantt/revision",{params:{token:r.currentUser.token,project_id:r.projectSelected,id:r.revisionItems[i].id}}).then(function(e){var t={data:JSON.parse(e.data.gantt_data),resources:JSON.parse(e.data.gantt_resources),projectStartDate:null,projectEndDate:null,advanced:JSON.parse(e.data.gantt_settings)},i=document.createElement("a"),s=new Blob([JSON.stringify(t)],{type:"text/plain"});i.href=URL.createObjectURL(s),i.download=r.filenameValidString(e.data.project_name)+" "+n+".gantt",i.click()}).catch(function(e){r.alertMessage.message="Failed to download revision. Please try again later.",r.alertMessage.variant="danger",r.alertMessage.show=!0})},revisionDeleteClicked:function(e,t){e.target.blur(),this.showConfirmModal(this.revisionDeleteClickedConfirmed,"Permanently delete this revision?","sm",t)},revisionDeleteClickedConfirmed:function(){var e=this.confirmModalParam1,t=(this.revisionCurrentPage-1)*this.revisionPerPage+e;this.setAccess(!1,"none"),this.alertMessage.show=!1,this.alertMessage.variant="success",this.alertMessage.message="";var i=this;m.a.delete("/gantt/revision",{data:{token:i.currentUser.token,project_id:i.projectSelected,id:i.revisionItems[t].id}}).then(function(e){i.revisionItems.splice(t,1),i.alertMessage.message="Revision deleted successfully.",i.alertMessage.variant="success",i.alertMessage.show=!0,i.setAccess(!1,"read/write")}).catch(function(e){i.alertMessage.message="Failed to delete revision. Please try again later.",i.alertMessage.variant="danger",i.alertMessage.show=!0,i.setAccess(!1,"read/write")})},permissionDeleteClicked:function(e,t){this.permissionItems.splice(t,1),e.target.blur()},resourceListDeleteClicked:function(e,t){this.resourceListItems.splice(t,1),e.target.blur()},selectUserClicked:function(e,t){e.target.blur(),this.userIndex=t;var i=this.getUserEmail(this.resourceListItems[t].resourceName);""==i&&this.userList.length>0&&(i=this.userList[0].value),this.userSelected=i,this.$root.$emit("bv::show::modal","selectUserModal")},selectUserSaveClicked:function(){var e=this.getUserName(this.userSelected);this.resourceListItems[this.userIndex].resourceId=e,this.resourceListItems[this.userIndex].resourceName=e,this.$root.$emit("bv::hide::modal","selectUserModal")},selectUserCancelClicked:function(){this.$root.$emit("bv::hide::modal","selectUserModal")},getUserName:function(e){for(var t=0;t<this.userList.length;t++)if(this.userList[t].value==e)return this.userList[t].text;return e},getUserEmail:function(e){for(var t=0;t<this.userList.length;t++)if(this.userList[t].text==e)return this.userList[t].value;return""},setAccess:function(e,t){"read/write"==t?(document.getElementById("saveButton").disabled=!1,document.getElementById("cancelButton").disabled=!1,this.moreDisabled=e,document.getElementById("projectNameInput").disabled=!1,document.getElementById("revisionNotesInput").disabled=!1,document.getElementById("importDropdownItem").style.display="",document.getElementById("importExcelDropdownItem").style.display="",this.ganttReadOnly=!1,this.sectionDisabled=!1,this.allDisabled=!1,"Project View"==this.viewSelected&&(this.contextMenuItems=this.contextMenuItemsReadWrite)):"read"==t?(document.getElementById("saveButton").disabled=!0,document.getElementById("cancelButton").disabled=!0,this.moreDisabled=!0,document.getElementById("projectNameInput").disabled=!0,document.getElementById("revisionNotesInput").disabled=!0,document.getElementById("importDropdownItem").style.display="none",document.getElementById("importExcelDropdownItem").style.display="none",this.ganttReadOnly=!0,this.sectionDisabled=!0,this.allDisabled=!1,this.contextMenuItems=this.contextMenuItemsReadOnly):(document.getElementById("saveButton").disabled=!0,document.getElementById("cancelButton").disabled=!0,this.moreDisabled=!0,document.getElementById("projectNameInput").disabled=!0,document.getElementById("revisionNotesInput").disabled=!0,document.getElementById("importDropdownItem").style.display="none",document.getElementById("importExcelDropdownItem").style.display="none",this.sectionDisabled=!0,this.allDisabled=!0),this.reinitializeGantt=!0},columnWidthMinMax:function(e,t){Number(this.advanced.columns[t].width)<50?this.advanced.columns[t].width="50":Number(this.advanced.columns[t].width)>1e3&&(this.advanced.columns[t].width="1000")},removeHeaderText:function(e){for(var t=document.getElementById(e).querySelectorAll(".e-gantt-top-cell-text"),i=0;i<t.length;i++)Number(t[i].style.width.substring(0,t[i].style.width.length-2))<50&&(t[i].innerHTML="");for(t=document.getElementById(e).querySelectorAll(".e-header-cell-label"),i=0;i<t.length;i++)Number(t[i].style.width.substring(0,t[i].style.width.length-2))<20&&(t[i].innerHTML="");for(t=document.getElementById(e).querySelectorAll(".e-timeline-top-header-cell"),i=0;i<t.length;i++)Number(t[i].style.width.substring(0,t[i].style.width.length-2))<6&&(t[i].style.paddingLeft="0px",t[i].style.paddingRight="0px")},outdentTask:function(e,t){function i(t,n,r){for(var s=0;s<t.length;s++){var o=t[s];if(o.TaskID===n){var l=function(){if(0===r.length)return{v:!1};var i=t.splice(s,1)[0],n=r.pop(),a=r.length?r[r.length-1].subtasks:e,o=a.findIndex(function(e){return e.TaskID===n.TaskID});return a.splice(o+1,0,i),{v:!0}}();if("object"===a(l))return l.v}if(o.subtasks&&o.subtasks.length&&i(o.subtasks,n,c(r).concat([o])))return!0}return!1}return i(e,t,[]),e},deleteTasks:function(e,t){function i(e){return e?e.filter(function(e){return!t.includes(e.TaskID)&&(e.subtasks=i(e.subtasks),!0)}):[]}var n=e.filter(function(e){return!t.includes(e.TaskID)&&(e.subtasks=i(e.subtasks),!0)});return n},customAddTask:function(e,t,i){for(var n=JSON.parse(JSON.stringify(e)),r=this.getNextTaskID(e),s=0,a=0;a<this.advanced.workTime.length;a++)s+=this.advanced.workTime[a].to-this.advanced.workTime[a].from;function o(e){for(var n=0;n<e.length;n++){if(e[n].TaskID==t){var a={TaskID:r,TaskName:"New Task "+r.toString(),StartDate:e[n].StartDate,EndDate:e[n].EndDate,Duration:e[n].Duration,Predecessor:"",resources:[],Progress:0,color:"",info:"<p><br></p>",DurationUnit:"day"};if("customaddtaskabove"===i||"customaddtaskbelow"===i){var l=new Date(a.StartDate);l.setMinutes(l.getMinutes()+60*s),a.EndDate=l.toISOString(),a.Duration=1}else if("customaddtaskmilestone"===i)a.EndDate=a.StartDate,a.Duration=0;else if("duplicatetask"===i){var d;(function(){var t=function e(t,i){for(var n=0;n<t.length;n++)s[t[n].TaskID]=i,t[n].TaskID=i,t[n].hasOwnProperty("subtasks")?i=e(t[n].subtasks,i+1):i++;return i},i=function e(t){if(t.Predecessor){var i=t.Predecessor.split(","),n=i.map(function(e){var t=e.match(/^(\d+)(.*)/),i=t[1],n=t[2];return s[i]+n});t.Predecessor=n.join(",")}t.subtasks&&t.subtasks.length>0&&t.subtasks.forEach(e)};d=[],d.push(JSON.parse(JSON.stringify(e[n])));var s={};t(d,r),d.forEach(i),a=d[0]})()}"customaddtaskabove"===i?e.splice(n,0,a):"customaddtasksub"===i?(e[n].hasOwnProperty("subtasks")||(e[n].subtasks=[]),e[n].subtasks.splice(e[n].subtasks.length,0,a)):e.splice(n+1,0,a);break}e[n].hasOwnProperty("subtasks")&&o(e[n].subtasks)}}return o(n),n},getNextTaskID:function(e){for(var t=1,i=0;i<e.length;i++)t=Math.max(t,e[i].TaskID+1),e[i].hasOwnProperty("subtasks")&&(t=Math.max(t,this.getNextTaskID(e[i].subtasks)));return t},updateTimezoneOffset:function(e,t){for(var i,n,r=0;r<e.length;r++)i=new Date(e[r].StartDate),n=new Date(e[r].EndDate),i.setMinutes(i.getMinutes()+t),n.setMinutes(n.getMinutes()+t),e[r].StartDate=i.toISOString(),e[r].EndDate=n.toISOString(),e[r].hasOwnProperty("subtasks")&&this.updateTimezoneOffset(e[r].subtasks,t)},getTimezoneOffsetByDate:function(e,t){var i=e.toLocaleString("en-CA",{timeZone:t,hour12:!1}).replace(", ","T");i+="."+e.getMilliseconds().toString().padStart(3,"0");var n=new Date(i+"Z");return-(n-e)/60/1e3},updateTimezoneOffsetByDate:function(e,t,i){for(var n,r,s=0,a=0,o=0,l=0;l<e.length;l++)n=new Date(e[l].StartDate),a=this.getTimezoneOffsetByDate(n,t),o=this.getTimezoneOffsetByDate(n,i),s=o-a,n.setMinutes(n.getMinutes()+s),r=new Date(e[l].EndDate),a=this.getTimezoneOffsetByDate(r,t),o=this.getTimezoneOffsetByDate(r,i),s=o-a,r.setMinutes(r.getMinutes()+s),e[l].StartDate=n.toISOString(),e[l].EndDate=r.toISOString(),e[l].hasOwnProperty("subtasks")&&this.updateTimezoneOffsetByDate(e[l].subtasks,t,i)},showAlertModal:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"md";this.alertModalMessage=e,this.alertModalSize=t,this.$root.$emit("bv::show::modal","alertModalElement")},showConfirmModal:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"md",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],a=arguments.length>6?arguments[6]:void 0;this.confirmModalFunction=e,this.confirmModalMessage=t,this.confirmModalSize=i,this.confirmModalParam1=n,this.confirmModalParam2=r,this.confirmModalNavigationGuard=s,this.confirmModalCancelFunction=a,this.$root.$emit("bv::show::modal","confirmModalElement")},showPromptModal:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"md";this.promptModalFunction=e,this.promptModalMessage=t,this.promptModalSize=i,this.promptModalParam1="",this.$root.$emit("bv::show::modal","promptModalElement")},confirmModalOKClicked:function(){this.confirmModalFunction(),this.$root.$emit("bv::hide::modal","confirmModalElement")},confirmModalCancelClicked:function(){this.confirmModalNavigationGuard&&this.confirmModalFunction(!1),void 0!=this.confirmModalCancelFunction&&this.confirmModalCancelFunction(),this.$root.$emit("bv::hide::modal","confirmModalElement")},isMobileApp:function(){return navigator.userAgent.indexOf("onlineganttmobileapp")>-1}}},Cp=yp,wp=(i("5e88"),i("2877")),Op=Object(wp["a"])(Cp,n,r,!1,null,null,null);Op.options.__file="Gantt.vue";t["default"]=Op.exports},afb1:function(e,t,i){},c64e:function(e,t,i){var n=i("e1f4"),r=i("2366");function s(e,t,i){var s=t&&i||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null),e=e||{};var a=e.random||(e.rng||n)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t)for(var o=0;o<16;++o)t[s+o]=a[o];return t||r(a)}e.exports=s},e1f4:function(e,t){var i="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(i){var n=new Uint8Array(16);e.exports=function(){return i(n),n}}else{var r=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0===(3&t)&&(e=4294967296*Math.random()),r[t]=e>>>((3&t)<<3)&255;return r}}}}]);