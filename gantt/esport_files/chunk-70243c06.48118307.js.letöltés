(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-70243c06"],{"2e08":function(t,e,i){var r=i("9def"),n=i("9744"),o=i("be13");t.exports=function(t,e,i,s){var a=String(o(t)),h=a.length,l=void 0===i?" ":String(i),u=r(e);if(u<=h||""==l)return a;var c=u-h,p=n.call(l,Math.ceil(c/l.length));return p.length>c&&(p=p.slice(0,c)),s?p+a:a+p}},"70ea":function(t,e,i){"use strict";var r=i("cc2f"),n=i("73ba"),o=i("9c37"),s=i("7de8"),a=i("f7e0"),h=i("ccf4"),l=i("efb1"),u=i("af93"),c=i("d769"),p=i("2375"),d=i("e29d"),f=function(){function t(t){this.streamWriter=t}return Object.defineProperty(t.prototype,"document",{get:function(){return this.pdfDocument},set:function(t){this.pdfDocument=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"position",{get:function(){return this.streamWriter.buffer.size},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"length",{get:function(){return this.streamWriter.buffer.size},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"stream",{get:function(){var t=this.streamWriter;return t},enumerable:!0,configurable:!0}),t.prototype.write=function(t){var e=t;this.streamWriter.write(e)},t}();function g(t){return"[object String]"===Object.prototype.toString.call(t)?"$s"+t:"$o"+t.toString()}var m,y=function(){function t(t){this.table={},this.nElements=0,this.toStr=t||g}return t.prototype.getValue=function(t){var e=this.table["$"+this.toStr(t)];if("undefined"!==typeof e)return e.value},t.prototype.setValue=function(t,e){var i,r="$"+this.toStr(t);this.table[r];return this.nElements++,i=void 0,this.table[r]={key:t,value:e},i},t.prototype.remove=function(t){var e="$"+this.toStr(t),i=this.table[e];return delete this.table[e],this.nElements--,i.value},t.prototype.keys=function(){for(var t=[],e=Object.keys(this.table),i=0;i<e.length;i++){var r=this.table[e[i]];t.push(r.key)}return t},t.prototype.values=function(){for(var t=[],e=Object.keys(this.table),i=0;i<e.length;i++){var r=this.table[e[i]];t.push(r.value)}return t},t.prototype.containsKey=function(t){var e=!0;return e="undefined"===typeof this.getValue(t),!e},t.prototype.clear=function(){this.table={},this.nElements=0},t.prototype.size=function(){return this.nElements},t}();(function(t){t[t["None"]=0]="None",t[t["Registered"]=1]="Registered"})(m||(m={}));var b=function(){function t(){this.objectCollections=[],this.mainObjectCollection=new y,this.primitiveObjectCollection=new y}return Object.defineProperty(t.prototype,"count",{get:function(){return this.objectCollections.length},enumerable:!0,configurable:!0}),t.prototype.items=function(t){return this.objectCollections[t]},Object.defineProperty(t.prototype,"outIsNew",{get:function(){return this.isNew},enumerable:!0,configurable:!0}),t.prototype.add=function(t){var e=new w(t);this.objectCollections.push(e),this.primitiveObjectCollection.containsKey(t)||this.primitiveObjectCollection.setValue(t,this.objectCollections.length-1),t.position=this.index=this.objectCollections.length-1,t.status=m.Registered},t.prototype.lookFor=function(t){var e=-1;if(-1!==t.position)return t.position;if(this.primitiveObjectCollection.containsKey(t)&&this.count===this.primitiveObjectCollection.size())e=this.primitiveObjectCollection.getValue(t);else for(var i=this.count-1;i>=0;i--){var r=this.objectCollections[i];if(r.object===t){e=i;break}}return e},t.prototype.getReference=function(t,e){var i;this.index=this.lookFor(t),this.isNew=!1;var r=this.objectCollections[this.index];i=r.reference;var n={reference:i,wasNew:e};return n},t.prototype.trySetReference=function(t,e,i){var r=!0;this.index=this.lookFor(t);var n=this.objectCollections[this.index];return n.setReference(e),r},t.prototype.destroy=function(){for(var t=0,e=this.objectCollections;t<e.length;t++){var i=e[t];void 0!==i&&(i.pdfObject.position=-1,i.pdfObject.isSaving=void 0,i.pdfObject.objectCollectionIndex=void 0,i.pdfObject.position=void 0)}this.objectCollections=[],this.mainObjectCollection=new y,this.primitiveObjectCollection=new y},t}(),w=function(){function t(t,e){this.pdfObject=t,this.pdfReference=e}return Object.defineProperty(t.prototype,"object",{get:function(){return this.pdfObject},set:function(t){this.pdfObject=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"reference",{get:function(){return this.pdfReference},enumerable:!0,configurable:!0}),t.prototype.setReference=function(t){this.pdfReference=t},t}(),v=function(){function t(t){this.emitBOM=!0,this.encodingType="Ansi",this.initBOM(t)}return Object.defineProperty(t.prototype,"includeBom",{get:function(){return this.emitBOM},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){return this.encodingType},set:function(t){this.encodingType=t},enumerable:!0,configurable:!0}),t.prototype.initBOM=function(t){this.emitBOM=void 0===t||null===t||t},t.prototype.getByteCount=function(t){if(S(t,"string"),""===t){var e=this.utf8Len(t.charCodeAt(0));return e}return null!==this.type&&void 0!==this.type||(this.type="Ansi"),this.getByteCountInternal(t,0,t.length)},t.prototype.utf8Len=function(t){var e=t<=127?1:t<=2047?2:t<=65535?3:t<=2097151?4:0;return e},t.prototype.isHighSurrogate=function(t){return t>=55296&&t<=56319},t.prototype.toCodepoint=function(t,e){t=(1023&t)<<10;var i=t|1023&e;return i+65536},t.prototype.getByteCountInternal=function(t,e,i){var r=0;if("Utf8"===this.encodingType||"Unicode"===this.encodingType){for(var n="Utf8"===this.encodingType,o=0;o<i;o++){var s=t.charCodeAt(n?e:e++);if(this.isHighSurrogate(s))if(n){var a=s,h=t.charCodeAt(++e);r+=this.utf8Len(this.toCodepoint(a,h))}else r+=4,++o;else r+=n?this.utf8Len(s):2;n&&e++}return r}return r=i,r},t.prototype.getBytes=function(t,e,i){if(S(t,"string"),S(e,"charIndex"),S(i,"charCount"),e<0||i<0)throw new RangeError("Argument Out Of Range Exception: charIndex or charCount is less than zero");if(t.length-e<i)throw new RangeError("Argument Out Of Range Exception: charIndex and charCount do not denote a valid range in string");var r;if(""===t)return r=new ArrayBuffer(0),r;null!==this.type&&void 0!==this.type||(this.type="Ansi");var n=this.getByteCountInternal(t,e,i);switch(this.type){case"Utf8":return r=this.getBytesOfUtf8Encoding(n,t,e,i),r;case"Unicode":return r=this.getBytesOfUnicodeEncoding(n,t,e,i),r;default:return r=this.getBytesOfAnsiEncoding(n,t,e,i),r}},t.prototype.getString=function(t,e,i){if(S(t,"bytes"),S(e,"index"),S(i,"count"),e<0||i<0)throw new RangeError("Argument Out Of Range Exception: index or count is less than zero");if(t.byteLength-e<i)throw new RangeError("Argument Out Of Range Exception: index and count do not denote a valid range in bytes");if(0===t.byteLength||0===i)return"";null!==this.type&&void 0!==this.type||(this.type="Ansi");var r="",n=new Uint8Array(t);switch(this.type){case"Utf8":var o=this.getStringOfUtf8Encoding(n,e,i);return o;case"Unicode":var s=new Uint16Array(t);return r=this.getStringofUnicodeEncoding(s,e,i),r;default:for(var a=e,h=0;h<i;h++){var l=n[a];r+=String.fromCharCode(l),a++}return r}},t.prototype.getBytesOfAnsiEncoding=function(t,e,i,r){for(var n=new ArrayBuffer(t),o=new Uint8Array(n),s=0,a=0;a<r;a++){var h=e.charCodeAt(i++);o[s]=h<2048?h:63,s++}return n},t.prototype.getBytesOfUtf8Encoding=function(t,e,i,r){for(var n=new ArrayBuffer(t),o=new Uint8Array(n),s=i,a=0,h=0;h<r;h++){var l=e.charCodeAt(s);l<=127?o[a]=l:l<2048?(o[a]=192|l>>6,o[++a]=128|63&l):l<55296||l>=57344?(o[a]=224|l>>12,o[++a]=128|l>>6&63,o[++a]=128|63&l):(o[a]=239,o[++a]=191,o[++a]=189),++a,++s}return n},t.prototype.getBytesOfUnicodeEncoding=function(t,e,i,r){for(var n=new ArrayBuffer(t),o=new Uint16Array(n),s=0;s<r;s++){var a=e.charCodeAt(s);o[s]=a}return n},t.prototype.getStringOfUtf8Encoding=function(t,e,i){var r=0,n=e,o="";for(r;r<i;r++){var s=t[n++];while(n>t.length)return o;s>127&&(s>191&&s<224&&n<i?s=(31&s)<<6|63&t[n]:s>223&&s<240&&n<t.byteLength?s=(15&s)<<12|(63&t[n])<<6|63&t[++n]:s>239&&s<248&&n<t.byteLength&&(s=(7&s)<<18|(63&t[n])<<12|(63&t[++n])<<6|63&t[++n]),++n),o+=String.fromCharCode(s)}return o},t.prototype.getStringofUnicodeEncoding=function(t,e,i){if(i>t.length)throw new RangeError("ArgumentOutOfRange_Count");for(var r=new Uint16Array(i),n="",o=0;o<i&&o<t.length;o++)r[o]=t[e++];return n=String.fromCharCode.apply(null,r),n},t.prototype.destroy=function(){this.emitBOM=void 0,this.encodingType=void 0},t}();function S(t,e){if(null===t||void 0===t)throw new Error("ArgumentException: "+e+" cannot be null or undefined")}var C,x=function(){function t(){}return t.save=function(t,e){if(null===t||void 0===t||""===t)throw new Error("ArgumentException: fileName cannot be undefined, null or empty");var i=t.substring(t.lastIndexOf(".")+1,t.length),r=this.getMimeType(i);if(""!==r&&(e=new Blob([e],{type:r})),this.isMicrosoftBrowser)navigator.msSaveBlob(e,t);else{var n=document.createElementNS("http://www.w3.org/1999/xhtml","a");this.saveInternal(t,i,e,n,"download"in n)}},t.saveInternal=function(t,e,i,r,n){if(n){r.download=t;var o=window.URL.createObjectURL(i);r.href=o;var s=document.createEvent("MouseEvent");s.initEvent("click",!0,!0),r.dispatchEvent(s),setTimeout(function(){window.URL.revokeObjectURL(o),o=void 0})}else if("docx"!==e&&"xlsx"!==e){var a=window.URL.createObjectURL(i),h=window.open(a,"_blank");h||(window.location.href=a)}else{var l=new FileReader;l.onloadend=function(){var t=window.open(l.result,"_blank");t||(window.location.href=l.result)},l.readAsDataURL(i)}},t.getMimeType=function(t){var e="";switch(t){case"html":e="text/html";break;case"pdf":e="application/pdf";break;case"docx":e="application/vnd.openxmlformats-officedocument.wordprocessingml.document";break;case"xlsx":e="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";break;case"txt":e="text/plain";break}return e},t}(),P=function(){function t(t){this.bufferBlob=new Blob([""]),this.bufferText="",this.init(t),x.isMicrosoftBrowser=!!navigator.msSaveBlob}return Object.defineProperty(t.prototype,"buffer",{get:function(){return this.flush(),this.bufferBlob},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"encoding",{get:function(){return this.enc},enumerable:!0,configurable:!0}),t.prototype.init=function(t){null===t||void 0===t?(this.enc=new v(!1),this.enc.type="Utf8"):(this.enc=t,this.setBomByte())},t.prototype.setBomByte=function(){if(this.encoding.includeBom)switch(this.encoding.type){case"Unicode":var t=new ArrayBuffer(2),e=new Uint8Array(t);e[0]=255,e[1]=254,this.bufferBlob=new Blob([t]);break;case"Utf8":var i=new ArrayBuffer(3),r=new Uint8Array(i);r[0]=239,r[1]=187,r[2]=191,this.bufferBlob=new Blob([i]);break;default:this.bufferBlob=new Blob([""]);break}},t.prototype.save=function(t){""!==this.bufferText&&this.flush(),x.save(t,this.buffer)},t.prototype.write=function(t){if(void 0===this.encoding)throw new Error("Object Disposed Exception: current writer is disposed");S(t,"string"),this.bufferText+=t,this.bufferText.length>=10240&&this.flush()},t.prototype.flush=function(){if(void 0!==this.bufferText&&null!==this.bufferText&&0!==this.bufferText.length){var t=this.encoding.getBytes(this.bufferText,0,this.bufferText.length);this.bufferText="",this.bufferBlob=new Blob([this.bufferBlob,t])}},t.prototype.writeLine=function(t){if(void 0===this.encoding)throw new Error("Object Disposed Exception: current writer is disposed");S(t,"string"),this.bufferText=this.bufferText+t+"\r\n",this.bufferText.length>=10240&&this.flush()},t.prototype.destroy=function(){this.bufferBlob=void 0,this.bufferText=void 0,this.enc instanceof v&&this.enc.destroy(),this.enc=void 0},t}(),O=function(){function t(t){this.isStreamCopied=!1,t instanceof ki&&(this.document=t)}return Object.defineProperty(t.prototype,"pdfObjects",{get:function(){return this.objects},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"crossTable",{get:function(){return this.pdfCrossTable},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentSavingObj",{get:function(){return this.currentSavingObject},set:function(t){this.currentSavingObject=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"catalog",{get:function(){return this.pdfCatalog},set:function(t){this.pdfCatalog=t},enumerable:!0,configurable:!0}),t.prototype.setMainObjectCollection=function(t){this.objects=t},t.prototype.setCrossTable=function(t){this.pdfCrossTable=t},t.prototype.setCatalog=function(t){this.pdfCatalog=t},t.prototype.save=function(t){var e=this,i=new v(!0),r=new P(i);if("undefined"===typeof t){var n=new v(!0),o=new P(n);return new Promise(function(t,i){var r={};r.blobData=new Blob([e.document.docSave(o,!0)],{type:"application/pdf"}),t(r)})}this.document.docSave(r,t,!0)},t.prototype.clone=function(){return this.document},t}(),T=function(){function t(t){this.stringStartMark="/",this.internalValue="",this.isSaving6=!1,this.position6=-1,this.internalValue=this.normalizeValue(t)}return Object.defineProperty(t.prototype,"status",{get:function(){return this.status6},set:function(t){this.status6=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isSaving",{get:function(){return this.isSaving6},set:function(t){this.isSaving6=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"objectCollectionIndex",{get:function(){return this.index6},set:function(t){this.index6=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"position",{get:function(){return this.position6},set:function(t){this.position6=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"clonedObject",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this.internalValue},set:function(t){var e=t;null!==t&&t.length>0?(e=t,this.internalValue=this.normalizeValue(e)):this.internalValue=e},enumerable:!0,configurable:!0}),t.prototype.save=function(t){t.write(this.toString())},t.prototype.toString=function(){return this.stringStartMark+this.escapeString(this.value)},t.prototype.clone=function(e){var i=new t;return i.value=this.internalValue,i},t.prototype.escapeString=function(e){for(var i="",r=0,n=e.length;r<n;r++){var o=e[r];t.delimiters.indexOf(o);i+=o}return i},t.prototype.normalizeValue=function(t,e){return t},t.delimiters="()<>[]{}/%}",t.replacements=[" ","\t","\n","\r"],t}(),L=function(){function t(){this.forTest="test",this.forTest=t.obj}return t.obj="obj",t.endObj="endobj",t.r="R",t.whiteSpace=" ",t.slash="/",t.newLine="\r\n",t.stream="stream",t.endStream="endstream",t.xref="xref",t.f="f",t.n="n",t.trailer="trailer",t.startxref="startxref",t.eof="%%EOF",t.header="%PDF-1.5",t.beginText="BT",t.endText="ET",t.beginPath="m",t.appendLineSegment="l",t.stroke="S",t.fill="f",t.fillEvenOdd="f*",t.fillStroke="B",t.fillStrokeEvenOdd="B*",t.appendbeziercurve="c",t.appendRectangle="re",t.saveState="q",t.restoreState="Q",t.paintXObject="Do",t.modifyCtm="cm",t.modifyTM="Tm",t.setLineWidth="w",t.setLineCapStyle="J",t.setLineJoinStyle="j",t.setDashPattern="d",t.setFlatnessTolerance="i",t.closePath="h",t.closeStrokePath="s",t.closeFillStrokePath="b",t.setCharacterSpace="Tc",t.setWordSpace="Tw",t.setHorizontalScaling="Tz",t.setTextLeading="TL",t.setFont="Tf",t.setRenderingMode="Tr",t.setTextRise="Ts",t.setTextScaling="Tz",t.setCoords="Td",t.goToNextLine="T*",t.setText="Tj",t.setTextWithFormatting="TJ",t.setTextOnNewLine="'",t.selectcolorspaceforstroking="CS",t.selectcolorspacefornonstroking="cs",t.setrbgcolorforstroking="RG",t.setrbgcolorfornonstroking="rg",t.setcmykcolorforstroking="K",t.setcmykcolorfornonstroking="k",t.setgraycolorforstroking="G",t.setgraycolorfornonstroking="g",t.clipPath="W",t.clipPathEvenOdd="W*",t.endPath="n",t.setGraphicsState="gs",t.comment="%",t.evenOdd="*",t.setMiterLimit="M",t.setColorAndPattern="scn",t.setColorAndPatternStroking="SCN",t}(),j=function(){function t(){this.pages="Pages",this.kids="Kids",this.count="Count",this.resources="Resources",this.type="Type",this.size="Size",this.mediaBox="MediaBox",this.parent="Parent",this.root="Root",this.decodeParms="DecodeParms",this.filter="Filter",this.font="Font",this.type1="Type1",this.baseFont="BaseFont",this.encoding="Encoding",this.subtype="Subtype",this.contents="Contents",this.procset="ProcSet",this.colorSpace="ColorSpace",this.extGState="ExtGState",this.pattern="Pattern",this.xObject="XObject",this.length="Length",this.width="Width",this.height="Height",this.bitsPerComponent="BitsPerComponent",this.image="Image",this.dctdecode="DCTDecode",this.columns="Columns",this.blackIs1="BlackIs1",this.k="K",this.s="S",this.predictor="Predictor",this.deviceRgb="DeviceRGB",this.next="Next",this.action="Action",this.link="Link",this.a="A",this.annot="Annot",this.p="P",this.c="C",this.rect="Rect",this.uri="URI",this.annots="Annots",this.ca="ca",this.CA="CA",this.xyz="XYZ",this.fit="Fit",this.dest="Dest",this.BM="BM",this.flatedecode="FlateDecode",this.rotate="Rotate",this.bBox="BBox",this.form="Form",this.w="W",this.cIDFontType2="CIDFontType2",this.cIDToGIDMap="CIDToGIDMap",this.identity="Identity",this.dw="DW",this.fontDescriptor="FontDescriptor",this.cIDSystemInfo="CIDSystemInfo",this.fontName="FontName",this.flags="Flags",this.fontBBox="FontBBox",this.missingWidth="MissingWidth",this.stemV="StemV",this.italicAngle="ItalicAngle",this.capHeight="CapHeight",this.ascent="Ascent",this.descent="Descent",this.leading="Leading",this.avgWidth="AvgWidth",this.fontFile2="FontFile2",this.maxWidth="MaxWidth",this.xHeight="XHeight",this.stemH="StemH",this.registry="Registry",this.ordering="Ordering",this.supplement="Supplement",this.type0="Type0",this.identityH="Identity-H",this.toUnicode="ToUnicode",this.descendantFonts="DescendantFonts",this.background="Background",this.shading="Shading",this.matrix="Matrix",this.antiAlias="AntiAlias",this.function="Function",this.extend="Extend",this.shadingType="ShadingType",this.coords="Coords",this.domain="Domain",this.range="Range",this.functionType="FunctionType",this.bitsPerSample="BitsPerSample",this.patternType="PatternType",this.paintType="PaintType",this.tilingType="TilingType",this.xStep="XStep",this.yStep="YStep"}return t}(),B=function(){function t(t){if(this.position7=-1,this.primitiveItems=new y,this.prefix="<<",this.suffix=">>",this.resources=[],this.object=null,this.archive=!0,this.isFont=!1,"undefined"===typeof t)this.primitiveItems=new y,this.encrypt=!0,this.dictionaryProperties=new j;else{this.primitiveItems=new y;for(var e=t.items.keys(),i=t.items.values(),r=0;r<t.items.size();r++)this.primitiveItems.setValue(e[r],i[r]);this.status=t.status,this.freezeChanges(this),this.encrypt=!0,this.dictionaryProperties=new j}}return Object.defineProperty(t.prototype,"items",{get:function(){return this.primitiveItems},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"status",{get:function(){return this.status7},set:function(t){this.status7=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isSaving",{get:function(){return this.isSaving7},set:function(t){this.isSaving7=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"objectCollectionIndex",{get:function(){return this.index7},set:function(t){this.index7=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"clonedObject",{get:function(){return this.object},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"position",{get:function(){return this.position7},set:function(t){this.position7=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Count",{get:function(){return this.primitiveItems.size()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Dictionary",{get:function(){return this},enumerable:!0,configurable:!0}),t.prototype.getArchive=function(){return this.archive},t.prototype.setArchive=function(t){this.archive=t},t.prototype.setEncrypt=function(t){this.encrypt=t,this.modify()},t.prototype.getEncrypt=function(){return this.encrypt},t.prototype.freezeChanges=function(t){this.bChanged=!1},t.prototype.clone=function(e){var i=new t;return i},t.prototype.modify=function(){this.bChanged=!0},t.prototype.remove=function(t){"string"!==typeof t?(this.primitiveItems.remove(t.value),this.modify()):this.remove(new T(t))},t.prototype.containsKey=function(t){var e=!1;return e=this.primitiveItems.containsKey(t.toString()),e},t.prototype.onBeginSave=function(){this.beginSave.sender.beginSave()},t.prototype.onFontDictionaryBeginSave=function(){this.fontDictionaryBeginSave.sender.fontDictionaryBeginSave()},t.prototype.onDescendantFontBeginSave=function(){this.descendantFontBeginSave.sender.descendantFontBeginSave()},t.prototype.onTemplateBeginSave=function(){this.pageBeginDrawTemplate.sender.pageBeginSave()},t.prototype.onBeginAnnotationSave=function(){this.annotationBeginSave.sender.beginSave()},t.prototype.onSectionBeginSave=function(t){var e=this.sectionBeginSave;e.sender.beginSave(e.state,t)},t.prototype.save=function(t,e){"undefined"===typeof e?this.save(t,!0):(t.write(this.prefix),"undefined"!==typeof this.beginSave&&this.onBeginSave(),"undefined"!==typeof this.descendantFontBeginSave&&this.onDescendantFontBeginSave(),"undefined"!==typeof this.fontDictionaryBeginSave&&this.onFontDictionaryBeginSave(),"undefined"!==typeof this.annotationBeginSave&&this.onBeginAnnotationSave(),"undefined"!==typeof this.sectionBeginSave&&this.onSectionBeginSave(t),"undefined"!==typeof this.pageBeginDrawTemplate&&this.onTemplateBeginSave(),this.Count>0&&this.saveItems(t),t.write(this.suffix),t.write(L.newLine))},t.prototype.saveItems=function(t){t.write(L.newLine);for(var e=this.primitiveItems.keys(),i=this.primitiveItems.values(),r=0;r<e.length;r++){var n=e[r],o=new T(n);o.save(t),t.write(L.whiteSpace);var s=i[r];s.save(t),t.write(L.newLine)}},t}(),I=function(){function t(t){this.sender=t}return t}(),R=function(){function t(t){this.sender=t}return t}(),k=function(){function t(t){this.sender=t}return t}(),F=function(){function t(t){this.sender=t}return t}(),M=function(){function t(t,e){this.sender=t,this.state=e}return t}(),A=function(){function t(t){this.sender=t}return t}(),E=function(){function t(t){this.position5=-1,this.value=t}return Object.defineProperty(t.prototype,"intValue",{get:function(){return this.value},set:function(t){this.value=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isInteger",{get:function(){return this.integer},set:function(t){this.integer=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"status",{get:function(){return this.status5},set:function(t){this.status5=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isSaving",{get:function(){return this.isSaving5},set:function(t){this.isSaving5=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"objectCollectionIndex",{get:function(){return this.index5},set:function(t){this.index5=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"position",{get:function(){return this.position5},set:function(t){this.position5=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"clonedObject",{get:function(){var t=null;return t},enumerable:!0,configurable:!0}),t.prototype.save=function(t){t.write(this.intValue.toString())},t.prototype.clone=function(e){var i=new t(this.value);return i},t.floatToString=function(t){var e=t.toFixed(2);return"0.00"===e&&(e=".00"),e},t.min=function(t,e,i){var r=Math.min(t,e);return Math.min(i,r)},t}(),N=function(){function t(e){if(this.startMark="[",this.endMark="]",this.position9=-1,this.clonedObject9=null,this.isFont=!1,"undefined"===typeof e)this.internalElements=[];else if("undefined"===typeof e||e instanceof t){var i=e;this.internalElements=[];for(n=0;n<i.elements.length;n++)this.internalElements.push(i.elements[n])}else for(var r=e,n=0;n<r.length;n++){var o=new E(r[n]);this.add(o)}}return t.prototype.items=function(t){return this.internalElements[t]},Object.defineProperty(t.prototype,"count",{get:function(){return this.internalElements.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"status",{get:function(){return this.status9},set:function(t){this.status9=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isSaving",{get:function(){return this.isSaving9},set:function(t){this.isSaving9=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"clonedObject",{get:function(){return this.clonedObject9},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"position",{get:function(){return this.position9},set:function(t){this.position9=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"objectCollectionIndex",{get:function(){return this.index9},set:function(t){this.index9=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"CrossTable",{get:function(){return this.pdfCrossTable},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"elements",{get:function(){return this.internalElements},enumerable:!0,configurable:!0}),t.prototype.add=function(t){"undefined"===typeof this.internalElements&&(this.internalElements=[]),this.internalElements.push(t),this.markedChange()},t.prototype.markedChange=function(){this.bChanged=!0},t.prototype.contains=function(t){for(var e=!1,i=0;i<this.internalElements.length;i++){var r=this.internalElements[i],n=t;if(null!=r&&"undefined"!==typeof r&&null!=n&&"undefined"!==typeof n&&r.value===n.value)return!0}return e},t.prototype.getItems=function(t){return this.internalElements[t]},t.prototype.save=function(t){t.write(this.startMark);for(var e=0,i=this.count;e<i;e++)this.getItems(e).save(t),e+1!==i&&t.write(L.whiteSpace);t.write(this.endMark)},t.prototype.clone=function(e){this.clonedObject9=null;for(var i=new t,r=0;r<this.internalElements.length;r++){var n=this.internalElements[r];i.add(n.clone(e))}return i.pdfCrossTable=e,this.clonedObject9=i,i},t.fromRectangle=function(e){var i=[e.x,e.y,e.width,e.height],r=new t(i);return r},t.prototype.insert=function(t,e){if(t<this.internalElements.length&&t>0){for(var i=[],r=0;r<t;r++)i.push(this.internalElements[r]);i.push(e);for(r=t;r<this.internalElements.length;r++)i.push(this.internalElements[r]);this.internalElements=i}else this.internalElements.push(e);this.markChanged()},t.prototype.indexOf=function(t){return this.internalElements.indexOf(t)},t.prototype.remove=function(t){var e=this.internalElements.indexOf(t);this.internalElements[e]=null,this.markChanged()},t.prototype.removeAt=function(t){if(this.internalElements.length>t){for(var e=[],i=0;i<t;i++)e.push(this.internalElements[i]);for(i=t+1;i<this.internalElements.length;i++)e.push(this.internalElements[i]);this.internalElements=e}this.markChanged()},t.prototype.clear=function(){this.internalElements=[],this.markChanged()},t.prototype.markChanged=function(){this.bChanged=!0},t}(),D=new Int16Array(286),V=new Uint8Array(286),z=new Int16Array(30),G=new Uint8Array(30),W=function(){function t(e){this.pendingBuffer=new Uint8Array(65536),this.pendingBufLength=0,this.pendingBufCache=0,this.pendingBufBitsInCache=0,this.bufferPosition=0,this.extraBits=0,this.currentHash=0,this.matchStart=0,this.matchLength=0,this.matchPrevAvail=!1,this.blockStart=0,this.stringStart=0,this.lookAhead=0,this.totalBytesIn=0,this.inputOffset=0,this.inputEnd=0,this.windowSize=32768,this.windowMask=this.windowSize-1,this.hashSize=32768,this.hashMask=this.hashSize-1,this.hashShift=Math.floor(17/3),this.maxDist=this.windowSize-262,this.checkSum=1,this.noWrap=!1,t.isHuffmanTreeInitiated||(t.initHuffmanTree(),t.isHuffmanTreeInitiated=!0),this.treeLiteral=new H(this,286,257,15),this.treeDistances=new H(this,30,1,15),this.treeCodeLengths=new H(this,19,4,7),this.arrDistances=new Uint16Array(16384),this.arrLiterals=new Uint8Array(16384),this.stream=[],this.dataWindow=new Uint8Array(2*this.windowSize),this.hashHead=new Int16Array(this.hashSize),this.hashPrevious=new Int16Array(this.windowSize),this.blockStart=this.stringStart=1,this.noWrap=e,e||this.writeZLibHeader()}return Object.defineProperty(t.prototype,"compressedData",{get:function(){return this.stream},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"getCompressedString",{get:function(){var t="";if(void 0!==this.stream)for(var e=0;e<this.stream.length;e++)t+=String.fromCharCode.apply(null,this.stream[e]);return t},enumerable:!0,configurable:!0}),t.prototype.write=function(t,e,i){if(void 0===t||null===t)throw new Error("ArgumentException: data cannot null or undefined");var r=e+i;if(0>e||e>r||r>t.length)throw new Error("ArgumentOutOfRangeException: Offset or length is incorrect");if("string"===typeof t){var n=new v(!1);n.type="Utf8",t=new Uint8Array(n.getBytes(t,0,t.length)),r=e+t.length}this.inputBuffer=t,this.inputOffset=e,this.inputEnd=r,this.noWrap||(this.checkSum=_.checksumUpdate(this.checkSum,this.inputBuffer,this.inputOffset,r));while(this.inputEnd!==this.inputOffset||0!==this.pendingBufLength)this.pendingBufferFlush(),this.compressData(!1)},t.prototype.writeZLibHeader=function(){var t=30720;t|=64,t+=31-t%31,this.pendingBufferWriteShortBytes(t)},t.prototype.pendingBufferWriteShortBytes=function(t){this.pendingBuffer[this.pendingBufLength++]=t>>8,this.pendingBuffer[this.pendingBufLength++]=t},t.prototype.compressData=function(t){var e;do{this.fillWindow();var i=t&&this.inputEnd===this.inputOffset;e=this.compressSlow(i,t)}while(0===this.pendingBufLength&&e);return e},t.prototype.compressSlow=function(t,e){if(this.lookAhead<262&&!t)return!1;while(this.lookAhead>=262||t){if(0===this.lookAhead)return this.lookAheadCompleted(e);this.stringStart>=2*this.windowSize-262&&this.slideWindow();var i=this.matchStart,r=this.matchLength;if(this.lookAhead>=3&&this.discardMatch(),r>=3&&this.matchLength<=r?r=this.matchPreviousBest(i,r):this.matchPreviousAvailable(),this.bufferPosition>=16384)return this.huffmanIsFull(e)}return!0},t.prototype.discardMatch=function(){var t=this.insertString();0!==t&&this.stringStart-t<=this.maxDist&&this.findLongestMatch(t)&&this.matchLength<=5&&3===this.matchLength&&this.stringStart-this.matchStart>4096&&(this.matchLength=2)},t.prototype.matchPreviousAvailable=function(){this.matchPrevAvail&&this.huffmanTallyLit(255&this.dataWindow[this.stringStart-1]),this.matchPrevAvail=!0,this.stringStart++,this.lookAhead--},t.prototype.matchPreviousBest=function(t,e){this.huffmanTallyDist(this.stringStart-1-t,e),e-=2;do{this.stringStart++,this.lookAhead--,this.lookAhead>=3&&this.insertString()}while(--e>0);return this.stringStart++,this.lookAhead--,this.matchPrevAvail=!1,this.matchLength=2,e},t.prototype.lookAheadCompleted=function(t){return this.matchPrevAvail&&this.huffmanTallyLit(255&this.dataWindow[this.stringStart-1]),this.matchPrevAvail=!1,this.huffmanFlushBlock(this.dataWindow,this.blockStart,this.stringStart-this.blockStart,t),this.blockStart=this.stringStart,!1},t.prototype.huffmanIsFull=function(t){var e=this.stringStart-this.blockStart;this.matchPrevAvail&&e--;var i=t&&0===this.lookAhead&&!this.matchPrevAvail;return this.huffmanFlushBlock(this.dataWindow,this.blockStart,e,i),this.blockStart+=e,!i},t.prototype.fillWindow=function(){this.stringStart>=this.windowSize+this.maxDist&&this.slideWindow();while(this.lookAhead<262&&this.inputOffset<this.inputEnd){var t=2*this.windowSize-this.lookAhead-this.stringStart;t>this.inputEnd-this.inputOffset&&(t=this.inputEnd-this.inputOffset),this.dataWindow.set(this.inputBuffer.subarray(this.inputOffset,this.inputOffset+t),this.stringStart+this.lookAhead),this.inputOffset+=t,this.totalBytesIn+=t,this.lookAhead+=t}this.lookAhead>=3&&this.updateHash()},t.prototype.slideWindow=function(){this.dataWindow.set(this.dataWindow.subarray(this.windowSize,this.windowSize+this.windowSize),0),this.matchStart-=this.windowSize,this.stringStart-=this.windowSize,this.blockStart-=this.windowSize;for(var t=0;t<this.hashSize;++t){var e=65535&this.hashHead[t];this.hashHead[t]=e>=this.windowSize?e-this.windowSize:0}for(t=0;t<this.windowSize;t++){e=65535&this.hashPrevious[t];this.hashPrevious[t]=e>=this.windowSize?e-this.windowSize:0}},t.prototype.insertString=function(){var t,e=(this.currentHash<<this.hashShift^this.dataWindow[this.stringStart+2])&this.hashMask;return this.hashPrevious[this.stringStart&this.windowMask]=t=this.hashHead[e],this.hashHead[e]=this.stringStart,this.currentHash=e,65535&t},t.prototype.findLongestMatch=function(t){var e,i=4096,r=258,n=this.stringStart,o=this.stringStart+this.matchLength,s=Math.max(this.matchLength,2),a=Math.max(this.stringStart-this.maxDist,0),h=this.stringStart+258-1,l=this.dataWindow[o-1],u=this.dataWindow[o],c=this.dataWindow;s>=32&&(i>>=2),r>this.lookAhead&&(r=this.lookAhead);do{if(c[t+s]===u&&c[t+s-1]===l&&c[t]===c[n]&&c[t+1]===c[n+1]){e=t+2,n+=2;while(c[++n]===c[++e]&&c[++n]===c[++e]&&c[++n]===c[++e]&&c[++n]===c[++e]&&c[++n]===c[++e]&&c[++n]===c[++e]&&c[++n]===c[++e]&&c[++n]===c[++e]&&n<h);if(n>o){if(this.matchStart=t,o=n,s=n-this.stringStart,s>=r)break;l=c[o-1],u=c[o]}n=this.stringStart}}while((t=65535&this.hashPrevious[t&this.windowMask])>a&&0!==--i);return this.matchLength=Math.min(s,this.lookAhead),this.matchLength>=3},t.prototype.updateHash=function(){this.currentHash=this.dataWindow[this.stringStart]<<this.hashShift^this.dataWindow[this.stringStart+1]},t.prototype.huffmanTallyLit=function(t){return this.arrDistances[this.bufferPosition]=0,this.arrLiterals[this.bufferPosition++]=t,this.treeLiteral.codeFrequencies[t]++,this.bufferPosition>=16384},t.prototype.huffmanTallyDist=function(t,e){this.arrDistances[this.bufferPosition]=t,this.arrLiterals[this.bufferPosition++]=e-3;var i=this.huffmanLengthCode(e-3);this.treeLiteral.codeFrequencies[i]++,i>=265&&i<285&&(this.extraBits+=Math.floor((i-261)/4));var r=this.huffmanDistanceCode(t-1);return this.treeDistances.codeFrequencies[r]++,r>=4&&(this.extraBits+=Math.floor(r/2-1)),this.bufferPosition>=16384},t.prototype.huffmanFlushBlock=function(t,e,i,r){this.treeLiteral.codeFrequencies[256]++,this.treeLiteral.buildTree(),this.treeDistances.buildTree(),this.treeLiteral.calculateBLFreq(this.treeCodeLengths),this.treeDistances.calculateBLFreq(this.treeCodeLengths),this.treeCodeLengths.buildTree();for(var n=4,o=18;o>n;o--)this.treeCodeLengths.codeLengths[H.huffCodeLengthOrders[o]]>0&&(n=o+1);var s=14+3*n+this.treeCodeLengths.getEncodedLength()+this.treeLiteral.getEncodedLength()+this.treeDistances.getEncodedLength()+this.extraBits,a=this.extraBits;for(o=0;o<286;o++)a+=this.treeLiteral.codeFrequencies[o]*V[o];for(o=0;o<30;o++)a+=this.treeDistances.codeFrequencies[o]*G[o];s>=a&&(s=a),e>=0&&i+4<s>>3?this.huffmanFlushStoredBlock(t,e,i,r):s==a?(this.pendingBufferWriteBits(2+(r?1:0),3),this.treeLiteral.setStaticCodes(D,V),this.treeDistances.setStaticCodes(z,G),this.huffmanCompressBlock(),this.huffmanReset()):(this.pendingBufferWriteBits(4+(r?1:0),3),this.huffmanSendAllTrees(n),this.huffmanCompressBlock(),this.huffmanReset())},t.prototype.huffmanFlushStoredBlock=function(t,e,i,r){this.pendingBufferWriteBits(0+(r?1:0),3),this.pendingBufferAlignToByte(),this.pendingBufferWriteShort(i),this.pendingBufferWriteShort(~i),this.pendingBufferWriteByteBlock(t,e,i),this.huffmanReset()},t.prototype.huffmanLengthCode=function(t){if(255===t)return 285;var e=257;while(t>=8)e+=4,t>>=1;return e+t},t.prototype.huffmanDistanceCode=function(t){var e=0;while(t>=4)e+=2,t>>=1;return e+t},t.prototype.huffmanSendAllTrees=function(t){this.treeCodeLengths.buildCodes(),this.treeLiteral.buildCodes(),this.treeDistances.buildCodes(),this.pendingBufferWriteBits(this.treeLiteral.treeLength-257,5),this.pendingBufferWriteBits(this.treeDistances.treeLength-1,5),this.pendingBufferWriteBits(t-4,4);for(var e=0;e<t;e++)this.pendingBufferWriteBits(this.treeCodeLengths.codeLengths[H.huffCodeLengthOrders[e]],3);this.treeLiteral.writeTree(this.treeCodeLengths),this.treeDistances.writeTree(this.treeCodeLengths)},t.prototype.huffmanReset=function(){this.bufferPosition=0,this.extraBits=0,this.treeLiteral.reset(),this.treeDistances.reset(),this.treeCodeLengths.reset()},t.prototype.huffmanCompressBlock=function(){for(var t=0;t<this.bufferPosition;t++){var e=255&this.arrLiterals[t],i=this.arrDistances[t];if(0!==i--){var r=this.huffmanLengthCode(e);this.treeLiteral.writeCodeToStream(r);var n=Math.floor((r-261)/4);n>0&&n<=5&&this.pendingBufferWriteBits(e&(1<<n)-1,n);var o=this.huffmanDistanceCode(i);this.treeDistances.writeCodeToStream(o),n=Math.floor(o/2-1),n>0&&this.pendingBufferWriteBits(i&(1<<n)-1,n)}else this.treeLiteral.writeCodeToStream(e)}this.treeLiteral.writeCodeToStream(256)},t.prototype.pendingBufferWriteBits=function(t,e){var i=new Uint32Array(1);i[0]=this.pendingBufCache|t<<this.pendingBufBitsInCache,this.pendingBufCache=i[0],this.pendingBufBitsInCache+=e,this.pendingBufferFlushBits()},t.prototype.pendingBufferFlush=function(t){if(this.pendingBufferFlushBits(),this.pendingBufLength>0){var e=new Uint8Array(this.pendingBufLength);e.set(this.pendingBuffer.subarray(0,this.pendingBufLength),0),this.stream.push(e)}this.pendingBufLength=0},t.prototype.pendingBufferFlushBits=function(){var t=0;while(this.pendingBufBitsInCache>=8&&this.pendingBufLength<65536)this.pendingBuffer[this.pendingBufLength++]=this.pendingBufCache,this.pendingBufCache>>=8,this.pendingBufBitsInCache-=8,t++;return t},t.prototype.pendingBufferWriteByteBlock=function(t,e,i){var r=t.subarray(e,e+i);this.pendingBuffer.set(r,this.pendingBufLength),this.pendingBufLength+=i},t.prototype.pendingBufferWriteShort=function(t){this.pendingBuffer[this.pendingBufLength++]=t,this.pendingBuffer[this.pendingBufLength++]=t>>8},t.prototype.pendingBufferAlignToByte=function(){this.pendingBufBitsInCache>0&&(this.pendingBuffer[this.pendingBufLength++]=this.pendingBufCache),this.pendingBufCache=0,this.pendingBufBitsInCache=0},t.initHuffmanTree=function(){var t=0;while(t<144)D[t]=H.bitReverse(48+t<<8),V[t++]=8;while(t<256)D[t]=H.bitReverse(256+t<<7),V[t++]=9;while(t<280)D[t]=H.bitReverse(-256+t<<9),V[t++]=7;while(t<286)D[t]=H.bitReverse(-88+t<<8),V[t++]=8;for(t=0;t<30;t++)z[t]=H.bitReverse(t<<11),G[t]=5},t.prototype.close=function(){do{this.pendingBufferFlush(!0),this.compressData(!0)||(this.pendingBufferFlush(!0),this.pendingBufferAlignToByte(),this.noWrap||(this.pendingBufferWriteShortBytes(this.checkSum>>16),this.pendingBufferWriteShortBytes(65535&this.checkSum)),this.pendingBufferFlush(!0))}while(this.inputEnd!==this.inputOffset||0!==this.pendingBufLength)},t.prototype.destroy=function(){this.stream=[],this.stream=void 0,this.pendingBuffer=void 0,this.treeLiteral=void 0,this.treeDistances=void 0,this.treeCodeLengths=void 0,this.arrLiterals=void 0,this.arrDistances=void 0,this.hashHead=void 0,this.hashPrevious=void 0,this.dataWindow=void 0,this.inputBuffer=void 0,this.pendingBufLength=void 0,this.pendingBufCache=void 0,this.pendingBufBitsInCache=void 0,this.bufferPosition=void 0,this.extraBits=void 0,this.currentHash=void 0,this.matchStart=void 0,this.matchLength=void 0,this.matchPrevAvail=void 0,this.blockStart=void 0,this.stringStart=void 0,this.lookAhead=void 0,this.totalBytesIn=void 0,this.inputOffset=void 0,this.inputEnd=void 0,this.windowSize=void 0,this.windowMask=void 0,this.hashSize=void 0,this.hashMask=void 0,this.hashShift=void 0,this.maxDist=void 0,this.checkSum=void 0,this.noWrap=void 0},t.isHuffmanTreeInitiated=!1,t}(),H=function(){function t(t,e,i,r){this.writer=t,this.codeMinCount=i,this.maxLength=r,this.codeFrequency=new Uint16Array(e),this.lengthCount=new Int32Array(r)}return Object.defineProperty(t.prototype,"treeLength",{get:function(){return this.codeCount},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"codeLengths",{get:function(){return this.codeLength},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"codeFrequencies",{get:function(){return this.codeFrequency},enumerable:!0,configurable:!0}),t.prototype.setStaticCodes=function(t,e){var i=new Int16Array(t.length);i.set(t,0),this.codes=i;var r=new Uint8Array(e.length);r.set(e,0),this.codeLength=r},t.prototype.reset=function(){for(var t=0;t<this.codeFrequency.length;t++)this.codeFrequency[t]=0;this.codes=void 0,this.codeLength=void 0},t.prototype.writeCodeToStream=function(t){this.writer.pendingBufferWriteBits(65535&this.codes[t],this.codeLength[t])},t.prototype.buildCodes=function(){var e=new Int32Array(this.maxLength);this.codes=new Int16Array(this.codeCount);for(var i=0,r=0;r<this.maxLength;r++)e[r]=i,i+=this.lengthCount[r]<<15-r;for(var n=0;n<this.codeCount;n++){var o=this.codeLength[n];o>0&&(this.codes[n]=t.bitReverse(e[o-1]),e[o-1]+=1<<16-o)}},t.bitReverse=function(e){return t.reverseBits[15&e]<<12|t.reverseBits[e>>4&15]<<8|t.reverseBits[e>>8&15]<<4|t.reverseBits[e>>12]},t.prototype.getEncodedLength=function(){for(var t=0,e=0;e<this.codeFrequency.length;e++)t+=this.codeFrequency[e]*this.codeLength[e];return t},t.prototype.calculateBLFreq=function(t){var e,i,r,n=-1,o=0;while(o<this.codeCount){r=1;var s=this.codeLength[o];0===s?(e=138,i=3):(e=6,i=3,n!==s&&(t.codeFrequency[s]++,r=0)),n=s,o++;while(o<this.codeCount&&n===this.codeLength[o])if(o++,++r>=e)break;r<i?t.codeFrequency[n]+=r:0!==n?t.codeFrequency[16]++:r<=10?t.codeFrequency[17]++:t.codeFrequency[18]++}},t.prototype.writeTree=function(t){var e,i,r,n=-1,o=0;while(o<this.codeCount){r=1;var s=this.codeLength[o];0===s?(e=138,i=3):(e=6,i=3,n!==s&&(t.writeCodeToStream(s),r=0)),n=s,o++;while(o<this.codeCount&&n===this.codeLength[o])if(o++,++r>=e)break;if(r<i)while(r-- >0)t.writeCodeToStream(n);else 0!==n?(t.writeCodeToStream(16),this.writer.pendingBufferWriteBits(r-3,2)):r<=10?(t.writeCodeToStream(17),this.writer.pendingBufferWriteBits(r-3,3)):(t.writeCodeToStream(18),this.writer.pendingBufferWriteBits(r-11,7))}},t.prototype.buildTree=function(){for(var t=this.codeFrequency.length,e=new Int32Array(t),i=0,r=0,n=0;n<t;n++){var o=this.codeFrequency[n];if(0!==o){var s=i++,a=0;while(s>0&&this.codeFrequency[e[a=Math.floor((s-1)/2)]]>o)e[s]=e[a],s=a;e[s]=n,r=n}}while(i<2)e[i++]=r<2?++r:0;this.codeCount=Math.max(r+1,this.codeMinCount);for(var h=i,l=h,u=new Int32Array(4*i-2),c=new Int32Array(2*i-1),p=0;p<i;p++){var d=e[p],f=2*p;u[f]=d,u[f+1]=-1,c[p]=this.codeFrequency[d]<<8,e[p]=p}this.constructHuffmanTree(e,i,c,l,u),this.buildLength(u)},t.prototype.constructHuffmanTree=function(t,e,i,r,n){do{var o=t[0],s=t[--e],a=i[s],h=0,l=1;while(l<e)l+1<e&&i[t[l]]>i[t[l+1]]&&l++,t[h]=t[l],h=l,l=2*h+1;while((l=h)>0&&i[t[h=Math.floor((l-1)/2)]]>a)t[l]=t[h];t[l]=s;var u=t[0];s=r++,n[2*s]=o,n[2*s+1]=u;var c=Math.min(255&i[o],255&i[u]);i[s]=a=i[o]+i[u]-c+1,h=0,l=1;while(l<e)l+1<e&&i[t[l]]>i[t[l+1]]&&l++,t[h]=t[l],h=l,l=2*h+1;while((l=h)>0&&i[t[h=Math.floor((l-1)/2)]]>a)t[l]=t[h];t[l]=s}while(e>1)},t.prototype.buildLength=function(t){this.codeLength=new Uint8Array(this.codeFrequency.length);for(var e=Math.floor(t.length/2),i=Math.floor((e+1)/2),r=0,n=0;n<this.maxLength;n++)this.lengthCount[n]=0;if(r=this.calculateOptimalCodeLength(t,r,e),0!==r){var o=this.maxLength-1;do{while(0===this.lengthCount[--o]);do{this.lengthCount[o]--,this.lengthCount[++o]++,r-=1<<this.maxLength-1-o}while(r>0&&o<this.maxLength-1)}while(r>0);this.recreateTree(t,r,i)}},t.prototype.recreateTree=function(t,e,i){this.lengthCount[this.maxLength-1]+=e,this.lengthCount[this.maxLength-2]-=e;for(var r=2*i,n=this.maxLength;0!==n;n--){var o=this.lengthCount[n-1];while(o>0){var s=2*t[r++];-1===t[s+1]&&(this.codeLength[t[s]]=n,o--)}}},t.prototype.calculateOptimalCodeLength=function(t,e,i){var r=new Int32Array(i);r[i-1]=0;for(var n=i-1;n>=0;n--){var o=2*n+1;if(-1!==t[o]){var s=r[n]+1;s>this.maxLength&&(s=this.maxLength,e++),r[t[o-1]]=r[t[o]]=s}else{s=r[n];this.lengthCount[s-1]++,this.codeLength[t[o-1]]=r[n]}}return e},t.reverseBits=[0,8,4,12,2,10,6,14,1,9,5,13,3,11,7,15],t.huffCodeLengthOrders=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],t}(),_=function(){function t(){}return t.checksumUpdate=function(e,i,r,n){var o=new Uint32Array(1);o[0]=e;var s=o[0],a=o[0]=65535&s,h=o[0]=s>>t.checkSumBitOffset;while(n>0){var l=Math.min(n,t.checksumIterationCount);n-=l;while(--l>=0)a+=o[0]=255&i[r++],h+=a;a%=t.checksumBase,h%=t.checksumBase}return s=h<<t.checkSumBitOffset|a,s},t.checkSumBitOffset=16,t.checksumBase=65521,t.checksumIterationCount=3800,t}(),U=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},t(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),q=function(t){function e(e,i){var r=t.call(this,e)||this;return r.dicPrefix="stream",r.dicSuffix="endstream",r.clonedObject2=null,r.bCompress=!0,r.isImageStream=!1,r.isFontStream=!1,"undefined"!==typeof e||"undefined"!==typeof i?(r.dataStream2=[],r.dataStream2=i,r.bCompress2=!1):(r.dataStream2=[],r.bCompress2=!0),r}return U(e,t),Object.defineProperty(e.prototype,"internalStream",{get:function(){return this.dataStream2},set:function(t){this.dataStream2=[],this.dataStream2=t,this.modify()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isImage",{get:function(){return this.isImageStream},set:function(t){this.isImageStream=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isFont",{get:function(){return this.isFontStream},set:function(t){this.isFontStream=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"compress",{get:function(){return this.bCompress},set:function(t){this.bCompress=t,this.modify()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this.dataStream2},set:function(t){this.dataStream2=[],this.dataStream2=t,this.modify()},enumerable:!0,configurable:!0}),e.prototype.clearStream=function(){this.internalStream=[],this.items.containsKey(this.dictionaryProperties.filter)&&this.remove(this.dictionaryProperties.filter),this.bCompress=!0,this.modify()},e.prototype.write=function(t){if(null==t)throw new Error("ArgumentNullException:text");if(t.length<=0)throw new Error("ArgumentException: Can not write an empty string, text");this.dataStream2.push(t),this.modify()},e.prototype.writeBytes=function(t){if(null===t)throw new Error("ArgumentNullException:data");if(t.length<=0)throw new Error("ArgumentException: Can not write an empty bytes, data");for(var e="",i=0;i<t.length;i++)e+=String.fromCharCode(t[i]);this.dataStream2.push(e),this.modify()},e.prototype.onCmapBeginSave=function(){this.cmapBeginSave.sender.cmapBeginSave()},e.prototype.onFontProgramBeginSave=function(){this.fontProgramBeginSave.sender.fontProgramBeginSave()},e.prototype.compressContent=function(t,e){if(this.bCompress){for(var i=[],r=0;r<t.length;r++)i.push(t.charCodeAt(r));var n=new Uint8Array(i),o=new W;o.write(n,0,n.length),o.close(),t=o.getCompressedString,this.addFilter(this.dictionaryProperties.flatedecode)}return t},e.prototype.addFilter=function(t){var e=this.items.getValue(this.dictionaryProperties.filter);if(e instanceof Z){var i=e;e=i.object}var r=e,n=e;null!=n&&(r=new N,r.insert(0,n),this.items.setValue(this.dictionaryProperties.filter,r)),n=new T(t),null==r?this.items.setValue(this.dictionaryProperties.filter,n):r.insert(0,n)},e.prototype.save=function(e){"undefined"!==typeof this.cmapBeginSave&&this.onCmapBeginSave(),"undefined"!==typeof this.fontProgramBeginSave&&this.onFontProgramBeginSave();for(var i="",r=0;r<this.data.length;r++)i+=this.data[r];i.length>1&&!this.isImage&&!this.isFont&&(i="q\r\n"+i+"Q\r\n"),i=this.compressContent(i,e);var n=i.length;this.items.setValue(this.dictionaryProperties.length,new E(n)),t.prototype.save.call(this,e,!1),e.write(this.dicPrefix),e.write(L.newLine),i.length>0&&e.write(i),e.write(L.newLine),e.write(this.dicSuffix),e.write(L.newLine)},e.bytesToString=function(t){for(var e="",i=0;i<t.length;i++)e+=String.fromCharCode(t[i]);return e},e}(B),K=function(){function t(t){this.sender=t}return t}(),X=function(){function t(t){this.sender=t}return t}();(function(t){var e;(function(t){t[t["None"]=0]="None",t[t["Ascii"]=1]="Ascii",t[t["Unicode"]=2]="Unicode"})(t.ForceEncoding||(t.ForceEncoding={})),function(t){t[t["StringValue"]=0]="StringValue",t[t["ByteBuffer"]=1]="ByteBuffer"}(e||(e={}))})(C||(C={}));var J,Y=function(){function t(t){if(this.bHex=!1,this.position1=-1,this.clonedObject1=null,this.bDecrypted=!1,this.isParentDecrypted=!1,this.isPacked=!1,this.isFormField=!1,this.isColorSpace=!1,this.isHexString=!0,"undefined"===typeof t)this.bHex=!1;else if(!(t.length>0&&"0xfeff"===t[0])){this.stringValue=t,this.data=[];for(var e=0;e<t.length;++e)this.data.push(t.charCodeAt(e))}}return Object.defineProperty(t.prototype,"hex",{get:function(){return this.bHex},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this.stringValue},set:function(t){this.stringValue=t,this.data=null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"status",{get:function(){return this.status1},set:function(t){this.status1=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isSaving",{get:function(){return this.isSaving1},set:function(t){this.isSaving1=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"objectCollectionIndex",{get:function(){return this.index1},set:function(t){this.index1=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"clonedObject",{get:function(){return this.clonedObject1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"position",{get:function(){return this.position1},set:function(t){this.position1=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"CrossTable",{get:function(){return this.crossTable},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"converted",{get:function(){return this.bConverted},set:function(t){this.bConverted=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"encode",{get:function(){return this.bForceEncoding},set:function(t){this.bForceEncoding=t},enumerable:!0,configurable:!0}),t.bytesToHex=function(t){if(null==t)return"";var e="";return e},t.prototype.save=function(e){if(null===e)throw new Error("ArgumentNullException : writer");void 0!==this.encode&&this.encode===C.ForceEncoding.Ascii?e.write(this.pdfEncode()):e.write(t.stringMark[0]+this.value+t.stringMark[1])},t.prototype.pdfEncode=function(){var e="";if(void 0!==this.encode&&this.encode===C.ForceEncoding.Ascii){for(var i=this.escapeSymbols(this.value),r=0;r<i.length;r++)e+=String.fromCharCode(i[r]);e=t.stringMark[0]+e+t.stringMark[1]}else e=this.value;return e},t.prototype.escapeSymbols=function(t){for(var e=[],i=0;i<t.length;i++){var r=t.charCodeAt(i);switch(r){case 40:case 41:e.push(92),e.push(r);break;case 13:e.push(92),e.push(114);break;case 92:e.push(92),e.push(r);break;default:e.push(r);break}}return e},t.prototype.clone=function(e){if(null!==this.clonedObject1&&this.clonedObject1.CrossTable===e)return this.clonedObject1;this.clonedObject1=null;var i=new t(this.stringValue);return i.bHex=this.bHex,i.crossTable=e,i.isColorSpace=this.isColorSpace,this.clonedObject1=i,i},t.toUnicodeArray=function(t,e){if(null==t)throw new Error("Argument Null Exception : value");for(var i=[],r=0;r<t.length;r++){var n=t.charCodeAt(r);i.push(n/256>>>0),i.push(255&n)}return i},t.byteToString=function(t){if(null==t)throw new Error("Argument Null Exception : stream");for(var e="",i=0;i<t.length;++i)e+=String.fromCharCode(t[i]);return e},t.stringMark="()",t.hexStringMark="<>",t.hexFormatPattern="{0:X2}",t}(),Q=function(){function t(t,e){this.index3=-1,this.position3=-1,this.objNumber=0,this.genNumber=0,"number"===typeof t&&"number"===typeof e?(this.objNumber=t,this.genNumber=e):(this.objNumber=Number(t),this.genNumber=Number(e))}return Object.defineProperty(t.prototype,"status",{get:function(){return this.status3},set:function(t){this.status3=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isSaving",{get:function(){return this.isSaving3},set:function(t){this.isSaving3=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"objectCollectionIndex",{get:function(){return this.index3},set:function(t){this.index3=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"position",{get:function(){return this.position3},set:function(t){this.position3=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"clonedObject",{get:function(){var t=null;return t},enumerable:!0,configurable:!0}),t.prototype.save=function(t){t.write(this.toString())},t.prototype.toString=function(){return this.objNumber.toString()+" "+this.genNumber.toString()+" R"},t.prototype.clone=function(t){return null},t}(),Z=function(){function t(t,e){this.index4=-1,this.position4=-1,this.objectIndex=-1,this.dictionaryProperties=new j,this.initialize(t)}return Object.defineProperty(t.prototype,"status",{get:function(){return this.status4},set:function(t){this.status4=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isSaving",{get:function(){return this.isSaving4},set:function(t){this.isSaving4=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"objectCollectionIndex",{get:function(){return this.index4},set:function(t){this.index4=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"position",{get:function(){return this.position4},set:function(t){this.position4=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"clonedObject",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"object",{get:function(){return this.primitiveObject},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"reference",{get:function(){return this.pdfReference},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"index",{get:function(){return this.objectIndex},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"element",{get:function(){return this.primitiveObject},enumerable:!0,configurable:!0}),t.prototype.initialize=function(t){if(t instanceof N||t instanceof B||t instanceof T||t instanceof E||t instanceof q||t instanceof Q||t instanceof Y)this.primitiveObject=t;else{var e=t;this.initialize(e.element)}},t.prototype.save=function(t){t.position;var e=t.document.crossTable;this.object.isSaving=!0;var i=null;i=e.getReference(this.object),i.save(t)},t.prototype.clone=function(t){return null},t}();(function(t){t[t["Free"]=0]="Free",t[t["Normal"]=1]="Normal",t[t["Packed"]=2]="Packed"})(J||(J={}));var $,tt,et,it,rt,nt,ot=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},t(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),st=function(t){function e(){var e=t.call(this)||this;return e.sections=null,e.tempDictionaryProperties=new j,e.items.setValue((new j).type,new T("Catalog")),e}return ot(e,t),Object.defineProperty(e.prototype,"pages",{get:function(){return this.sections},set:function(t){t.element;this.sections=t,this.items.setValue(this.tempDictionaryProperties.pages,new Z(t))},enumerable:!0,configurable:!0}),e}(B),at=function(){function t(){this.objects=new y,this.maxGenNumIndex=0,this.objectCount=0,this.dictionaryProperties=new j}return Object.defineProperty(t.prototype,"isMerging",{get:function(){return this.merging},set:function(t){this.merging=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"trailer",{get:function(){return null==this.internalTrailer&&(this.internalTrailer=new q),this.internalTrailer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"document",{get:function(){return this.pdfDocument},set:function(t){this.pdfDocument=t,this.items=this.pdfDocument.pdfObjects},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pdfObjects",{get:function(){return this.items},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"objectCollection",{get:function(){return this.pdfDocument.pdfObjects},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"count",{get:function(){return this.objectCount},set:function(t){this.objectCount=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nextObjNumber",{get:function(){return this.count=this.count+1,this.count},enumerable:!0,configurable:!0}),t.prototype.save=function(t,e){this.saveHead(t);this.mappedReferences=null,this.objects.clear(),this.markTrailerReferences(),this.saveObjects(t);var i=this.count,r=t.position;this.registerObject(0,new Q(0,-1),!0);var n=0;t.write(L.xref),t.write(L.newLine),this.saveSections(t),this.saveTrailer(t,this.count,n),this.saveTheEndess(t,r),this.count=i;for(var o=0;o<this.objectCollection.count;++o){var s=this.objectCollection.items(o);s.object.isSaving=!1}if("undefined"===typeof e)return t.stream.buffer;t.stream.save(e)},t.prototype.saveTheEndess=function(t,e){t.write(L.newLine+L.startxref+L.newLine),t.write(e.toString()+L.newLine),t.write(L.eof+L.newLine)},t.prototype.saveTrailer=function(t,e,i){t.write(L.trailer+L.newLine);var r=this.trailer;r.items.setValue(this.dictionaryProperties.size,new E(this.objectCount+1)),r=new B(r),r.setEncrypt(!1),r.save(t)},t.prototype.saveSections=function(t){var e=0,i=0;do{i=this.prepareSubsection(e),this.saveSubsection(t,e,i),e+=i}while(0!==i)},t.prototype.saveSubsection=function(t,e,i){if(!(i<=0||e>=this.count)){t.write(e+" "+(i+1)+L.newLine);for(var r=e;r<=e+i;++r){var n=this.objects.getValue(r),o="";o=n.type===J.Free?this.getItem(n.offset,65535,!0):this.getItem(n.offset,n.generation,!1),t.write(o)}}},t.prototype.getItem=function(t,e,i){var r="",n=10-t.toString().length;e<=0&&(e=0);for(var o=5-e.toString().length<=0?0:5-e.toString().length,s=0;s<n;s++)r+="0";r=r+t.toString()+" ";for(s=0;s<o;s++)r+="0";return r=r+e.toString()+" ",r=r+(i?L.f:L.n)+L.newLine,r},t.prototype.prepareSubsection=function(t){for(var e,i=0,r=this.count,n=0;n<this.document.pdfObjects.count;n++){var o=this.document.pdfObjects.items(n).reference,s=o.toString();s.split(" ")}if(t>=r)return i;for(e=t;e<r;++e)break;for(t=e;e<r;++e)++i;return i},t.prototype.markTrailerReferences=function(){this.trailer.items.keys(),this.trailer.items.values()},t.prototype.saveHead=function(t){var e=this.generateFileVersion(t.document);t.write("%PDF-"+e),t.write(L.newLine)},t.prototype.generateFileVersion=function(t){var e=4,i="1."+e.toString();return i},t.prototype.getReference=function(t,e){if("undefined"===typeof e){var i=!1;return this.getReference(t,i)}return this.getSubReference(t,e)},t.prototype.getSubReference=function(t,e){var i,r=!1,n=null;if(this.items.count>0&&t.objectCollectionIndex>0&&this.items.count>t.objectCollectionIndex-1){var o=this.document.pdfObjects.getReference(t,i);n=o.reference,i=o.wasNew}if(i=null==n&&t.status!==m.Registered,null==n){var s=this.nextObjNumber;n=new Q(s,0);var a=void 0;if(i){this.document.pdfObjects.add(t),this.document.pdfObjects.trySetReference(t,n,a);var h=this.document.pdfObjects.count-1,l=this.document.pdfObjects.objectCollections[h].reference.objNumber,u=this.document.pdfObjects.objectCollections[this.document.pdfObjects.count-1];this.document.pdfObjects.mainObjectCollection.setValue(l,u),t.position=-1}else this.document.pdfObjects.trySetReference(t,n,a);t.objectCollectionIndex=n.objNumber,t.status=m.None,r=!0}return r||this.bForceNew,n},t.prototype.saveObjects=function(t){for(var e=this.objectCollection,i=0;i<e.count;++i){var r=e.items(i),n=r.object;n.isSaving=!0,this.saveIndirectObject(n,t)}},t.prototype.saveIndirectObject=function(t,e){var i=this.getReference(t);t instanceof st&&this.trailer.items.setValue(this.dictionaryProperties.root,i),this.pdfDocument.currentSavingObj=i;t.getArchive();this.registerObject(e.position,i),this.doSaveObject(t,i,e)},t.prototype.doSaveObject=function(t,e,i){i.length;i.write(e.objNumber.toString()),i.write(L.whiteSpace),i.write(e.genNumber.toString()),i.write(L.whiteSpace),i.write(L.obj),i.write(L.newLine),t.save(i);i.stream;i.write(L.endObj),i.write(L.newLine)},t.prototype.registerObject=function(t,e,i){"boolean"===typeof i?(this.objects.setValue(e.objNumber,new ht(t,e,i)),this.maxGenNumIndex=Math.max(this.maxGenNumIndex,e.genNumber)):"undefined"===typeof i&&(this.objects.setValue(e.objNumber,new ht(t,e)),this.maxGenNumIndex=Math.max(this.maxGenNumIndex,e.genNumber))},t.dereference=function(t){var e=t;return null!=e&&(t=e.object),t},t}(),ht=function(){function t(t,e,i){var r=t;this.offsetNumber=r;var n=e;this.generation=n.genNumber,this.object=n.objNumber,this.type="undefined"===typeof i?J.Normal:J.Free}return Object.defineProperty(t.prototype,"objectNumber",{get:function(){return this.object},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"offset",{get:function(){var t;return t=this.offsetNumber,t},enumerable:!0,configurable:!0}),t}(),lt=function(){function t(t,e){"undefined"===typeof t?(this.x=0,this.y=0):(this.x=null!==t?t:0,this.y=null!==e?e:0)}return t}(),ut=function(){function t(t,e){"undefined"===typeof e?(this.height=0,this.width=0):(this.height=null!==e?e:0,this.width=null!==t?t:0)}return t}(),ct=function(){function t(t,e,i,r){if(typeof t===typeof t&&"undefined"===typeof t)this.x=0,this.y=0,this.height=0,this.width=0;else if(t instanceof lt&&e instanceof ut&&"undefined"===typeof i){var n=t;this.x=n.x,this.y=n.y;var o=e;this.height=o.height,this.width=o.width}else{var s=t,a=e,h=i,l=r;this.x=s,this.y=a,this.height=l,this.width=h}}return t}(),pt=function(){function t(t,e,i,r){this.left=t,this.top=e,this.right=i,this.bottom=r}return Object.defineProperty(t.prototype,"width",{get:function(){return this.right-this.left},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.bottom-this.top},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topLeft",{get:function(){return new lt(this.left,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return new ut(this.width,this.height)},enumerable:!0,configurable:!0}),t.prototype.toString=function(){return this.topLeft+"x"+this.size},t}(),dt=function(){function t(){}return t.letter=new ut(612,792),t.note=new ut(540,720),t.legal=new ut(612,1008),t.a0=new ut(2380,3368),t.a1=new ut(1684,2380),t.a2=new ut(1190,1684),t.a3=new ut(842,1190),t.a4=new ut(595,842),t.a5=new ut(421,595),t.a6=new ut(297,421),t.a7=new ut(210,297),t.a8=new ut(148,210),t.a9=new ut(105,148),t.a10=new ut(74,105),t.b0=new ut(2836,4008),t.b1=new ut(2004,2836),t.b2=new ut(1418,2004),t.b3=new ut(1002,1418),t.b4=new ut(709,1002),t.b5=new ut(501,709),t.archE=new ut(2592,3456),t.archD=new ut(1728,2592),t.archC=new ut(1296,1728),t.archB=new ut(864,1296),t.archA=new ut(648,864),t.flsa=new ut(612,936),t.halfLetter=new ut(396,612),t.letter11x17=new ut(792,1224),t.ledger=new ut(1224,792),t}();(function(t){t[t["Portrait"]=0]="Portrait",t[t["Landscape"]=1]="Landscape"})($||($={})),function(t){t[t["RotateAngle0"]=0]="RotateAngle0",t[t["RotateAngle90"]=1]="RotateAngle90",t[t["RotateAngle180"]=2]="RotateAngle180",t[t["RotateAngle270"]=3]="RotateAngle270"}(tt||(tt={})),function(t){t[t["None"]=0]="None",t[t["Numeric"]=1]="Numeric",t[t["LowerLatin"]=2]="LowerLatin",t[t["LowerRoman"]=3]="LowerRoman",t[t["UpperLatin"]=4]="UpperLatin",t[t["UpperRoman"]=5]="UpperRoman"}(et||(et={})),function(t){t[t["None"]=0]="None",t[t["Bottom"]=1]="Bottom",t[t["Top"]=2]="Top",t[t["Left"]=3]="Left",t[t["Right"]=4]="Right",t[t["Fill"]=5]="Fill"}(it||(it={})),function(t){t[t["None"]=0]="None",t[t["TopLeft"]=1]="TopLeft",t[t["TopCenter"]=2]="TopCenter",t[t["TopRight"]=3]="TopRight",t[t["MiddleLeft"]=4]="MiddleLeft",t[t["MiddleCenter"]=5]="MiddleCenter",t[t["MiddleRight"]=6]="MiddleRight",t[t["BottomLeft"]=7]="BottomLeft",t[t["BottomCenter"]=8]="BottomCenter",t[t["BottomRight"]=9]="BottomRight"}(rt||(rt={})),function(t){t[t["None"]=0]="None",t[t["Top"]=1]="Top",t[t["Bottom"]=2]="Bottom",t[t["Left"]=3]="Left",t[t["Right"]=4]="Right"}(nt||(nt={}));var ft,gt,mt,yt,bt,wt,vt,St,Ct,xt,Pt,Ot,Tt,Lt,jt,Bt,It,Rt,kt,Ft,Mt,At,Et,Nt,Dt,Vt,zt=function(){function t(){this.pdfMargin=40,this.setMargins(this.pdfMargin)}return Object.defineProperty(t.prototype,"left",{get:function(){return this.leftMargin},set:function(t){this.leftMargin=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.topMargin},set:function(t){this.topMargin=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.rightMargin},set:function(t){this.rightMargin=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.bottomMargin},set:function(t){this.bottomMargin=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"all",{set:function(t){this.setMargins(t)},enumerable:!0,configurable:!0}),t.prototype.setMargins=function(t,e,i,r){"undefined"===typeof e?this.leftMargin=this.topMargin=this.rightMargin=this.bottomMargin=t:"undefined"===typeof i?(this.leftMargin=this.rightMargin=t,this.bottomMargin=this.topMargin=e):(this.leftMargin=t,this.topMargin=e,this.rightMargin=i,this.bottomMargin=r)},t.prototype.clone=function(){return this},t}(),Gt=function(){function t(t){this.pageMargins=new zt,this.pageSize=dt.a4,this.rotateAngle=tt.RotateAngle0,this.pageOrientation=$.Portrait,this.pageOrigin=new lt(0,0),this.isRotation=!1,"number"===typeof t&&this.pageMargins.setMargins(t)}return Object.defineProperty(t.prototype,"size",{get:function(){return this.pageSize},set:function(t){this.setSize(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"orientation",{get:function(){return this.pageOrientation},set:function(t){this.pageOrientation!==t&&(this.pageOrientation=t,this.updateSize(t))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"margins",{get:function(){return this.pageMargins},set:function(t){this.pageMargins=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.pageSize.width},set:function(t){this.pageSize.width=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.pageSize.height},set:function(t){this.pageSize.height=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"origin",{get:function(){return this.pageOrigin},set:function(t){this.pageOrigin=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rotate",{get:function(){return this.rotateAngle},set:function(t){this.rotateAngle=t,this.isRotation=!0},enumerable:!0,configurable:!0}),t.prototype.updateSize=function(t){var e=Math.min(this.pageSize.width,this.pageSize.height),i=Math.max(this.pageSize.width,this.pageSize.height);switch(t){case $.Portrait:this.pageSize=new ut(e,i);break;case $.Landscape:this.pageSize=new ut(i,e);break}},t.prototype.clone=function(){var t=this;return t.pageMargins=this.pageMargins.clone(),t},t.prototype.getActualSize=function(){var t=this.width-(this.margins.left+this.margins.right),e=this.height-(this.margins.top+this.margins.bottom),i=new ut(t,e);return i},t.prototype.setSize=function(t){var e=Math.min(t.width,t.height),i=Math.max(t.width,t.height);this.orientation===$.Portrait?this.pageSize=new ut(e,i):this.pageSize=new ut(i,e)},t}();(function(t){t[t["Left"]=0]="Left",t[t["Center"]=1]="Center",t[t["Right"]=2]="Right"})(ft||(ft={})),function(t){t[t["Top"]=0]="Top",t[t["Middle"]=1]="Middle",t[t["Bottom"]=2]="Bottom"}(gt||(gt={})),function(t){t[t["Left"]=0]="Left",t[t["Center"]=1]="Center",t[t["Right"]=2]="Right",t[t["Justify"]=3]="Justify"}(mt||(mt={})),function(t){t[t["Fill"]=0]="Fill",t[t["Stroke"]=1]="Stroke",t[t["FillStroke"]=2]="FillStroke",t[t["None"]=3]="None",t[t["ClipFlag"]=4]="ClipFlag",t[t["ClipFill"]=4]="ClipFill",t[t["ClipStroke"]=5]="ClipStroke",t[t["ClipFillStroke"]=6]="ClipFillStroke",t[t["Clip"]=7]="Clip"}(yt||(yt={})),function(t){t[t["Miter"]=0]="Miter",t[t["Round"]=1]="Round",t[t["Bevel"]=2]="Bevel"}(bt||(bt={})),function(t){t[t["Flat"]=0]="Flat",t[t["Round"]=1]="Round",t[t["Square"]=2]="Square"}(wt||(wt={})),function(t){t[t["Solid"]=0]="Solid",t[t["Dash"]=1]="Dash",t[t["Dot"]=2]="Dot",t[t["DashDot"]=3]="DashDot",t[t["DashDotDot"]=4]="DashDotDot",t[t["Custom"]=5]="Custom"}(vt||(vt={})),function(t){t[t["Winding"]=0]="Winding",t[t["Alternate"]=1]="Alternate"}(St||(St={})),function(t){t[t["Rgb"]=0]="Rgb",t[t["Cmyk"]=1]="Cmyk",t[t["GrayScale"]=2]="GrayScale",t[t["Indexed"]=3]="Indexed"}(Ct||(Ct={})),function(t){t[t["Normal"]=0]="Normal",t[t["Multiply"]=1]="Multiply",t[t["Screen"]=2]="Screen",t[t["Overlay"]=3]="Overlay",t[t["Darken"]=4]="Darken",t[t["Lighten"]=5]="Lighten",t[t["ColorDodge"]=6]="ColorDodge",t[t["ColorBurn"]=7]="ColorBurn",t[t["HardLight"]=8]="HardLight",t[t["SoftLight"]=9]="SoftLight",t[t["Difference"]=10]="Difference",t[t["Exclusion"]=11]="Exclusion",t[t["Hue"]=12]="Hue",t[t["Saturation"]=13]="Saturation",t[t["Color"]=14]="Color",t[t["Luminosity"]=15]="Luminosity"}(xt||(xt={})),function(t){t[t["Centimeter"]=0]="Centimeter",t[t["Pica"]=1]="Pica",t[t["Pixel"]=2]="Pixel",t[t["Point"]=3]="Point",t[t["Inch"]=4]="Inch",t[t["Document"]=5]="Document",t[t["Millimeter"]=6]="Millimeter"}(Pt||(Pt={})),function(t){t[t["Fit"]=0]="Fit",t[t["Center"]=1]="Center",t[t["Stretch"]=2]="Stretch",t[t["Tile"]=3]="Tile"}(Ot||(Ot={})),function(t){t[t["None"]=0]="None",t[t["LeftToRight"]=1]="LeftToRight",t[t["RightToLeft"]=2]="RightToLeft"}(Tt||(Tt={})),function(t){t[t["Regular"]=0]="Regular",t[t["Bold"]=1]="Bold",t[t["Italic"]=2]="Italic",t[t["Underline"]=4]="Underline",t[t["Strikeout"]=8]="Strikeout"}(Lt||(Lt={})),function(t){t[t["Helvetica"]=0]="Helvetica",t[t["Courier"]=1]="Courier",t[t["TimesRoman"]=2]="TimesRoman",t[t["Symbol"]=3]="Symbol",t[t["ZapfDingbats"]=4]="ZapfDingbats"}(jt||(jt={})),function(t){t[t["Standard"]=0]="Standard",t[t["TrueType"]=1]="TrueType",t[t["TrueTypeEmbedded"]=2]="TrueTypeEmbedded"}(Bt||(Bt={})),function(t){t[t["None"]=0]="None",t[t["Word"]=1]="Word",t[t["WordOnly"]=2]="WordOnly",t[t["Character"]=3]="Character"}(It||(It={})),function(t){t[t["None"]=0]="None",t[t["SuperScript"]=1]="SuperScript",t[t["SubScript"]=2]="SubScript"}(Rt||(Rt={})),function(t){t[t["Unknown"]=0]="Unknown",t[t["StandardEncoding"]=1]="StandardEncoding",t[t["MacRomanEncoding"]=2]="MacRomanEncoding",t[t["MacExpertEncoding"]=3]="MacExpertEncoding",t[t["WinAnsiEncoding"]=4]="WinAnsiEncoding",t[t["PdfDocEncoding"]=5]="PdfDocEncoding",t[t["IdentityH"]=6]="IdentityH"}(kt||(kt={})),function(t){t[t["Apple"]=0]="Apple",t[t["Microsoft"]=4]="Microsoft",t[t["Trimmed"]=6]="Trimmed"}(Ft||(Ft={})),function(t){t[t["Unknown"]=0]="Unknown",t[t["Symbol"]=1]="Symbol",t[t["Unicode"]=2]="Unicode",t[t["Macintosh"]=3]="Macintosh"}(Mt||(Mt={})),function(t){t[t["AppleUnicode"]=0]="AppleUnicode",t[t["Macintosh"]=1]="Macintosh",t[t["Iso"]=2]="Iso",t[t["Microsoft"]=3]="Microsoft"}(At||(At={})),function(t){t[t["Undefined"]=0]="Undefined",t[t["Unicode"]=1]="Unicode"}(Et||(Et={})),function(t){t[t["Roman"]=0]="Roman",t[t["Japanese"]=1]="Japanese",t[t["Chinese"]=2]="Chinese"}(Nt||(Nt={})),function(t){t[t["FixedPitch"]=1]="FixedPitch",t[t["Serif"]=2]="Serif",t[t["Symbolic"]=4]="Symbolic",t[t["Script"]=8]="Script",t[t["Nonsymbolic"]=32]="Nonsymbolic",t[t["Italic"]=64]="Italic",t[t["ForceBold"]=262144]="ForceBold"}(Dt||(Dt={})),function(t){t[t["Arg1And2AreWords"]=1]="Arg1And2AreWords",t[t["ArgsAreXyValues"]=2]="ArgsAreXyValues",t[t["RoundXyToGrid"]=4]="RoundXyToGrid",t[t["WeHaveScale"]=8]="WeHaveScale",t[t["Reserved"]=16]="Reserved",t[t["MoreComponents"]=32]="MoreComponents",t[t["WeHaveAnXyScale"]=64]="WeHaveAnXyScale",t[t["WeHaveTwoByTwo"]=128]="WeHaveTwoByTwo",t[t["WeHaveInstructions"]=256]="WeHaveInstructions",t[t["UseMyMetrics"]=512]="UseMyMetrics"}(Vt||(Vt={}));var Wt,Ht=function(){function t(t){if(null==t)throw new Error("ArgumentNullException:stream");this.stream=t}return t.prototype.clear=function(){this.stream.clearStream()},t.prototype.setGraphicsState=function(t){t instanceof T?(this.stream.write(t.toString()),this.stream.write(L.whiteSpace),this.writeOperator(L.setGraphicsState)):(this.stream.write(L.slash),this.stream.write(t),this.stream.write(L.whiteSpace),this.writeOperator(L.setGraphicsState))},t.prototype.executeObject=function(t){this.stream.write(t.toString()),this.stream.write(L.whiteSpace),this.writeOperator(L.paintXObject),this.stream.write(L.newLine)},t.prototype.closePath=function(){this.writeOperator(L.closePath)},t.prototype.clipPath=function(t){this.stream.write(L.clipPath),t&&this.stream.write(L.evenOdd),this.stream.write(L.whiteSpace),this.stream.write(L.endPath),this.stream.write(L.newLine)},t.prototype.closeFillStrokePath=function(t){this.stream.write(L.closeFillStrokePath),t?(this.stream.write(L.evenOdd),this.stream.write(L.newLine)):this.stream.write(L.newLine)},t.prototype.fillStrokePath=function(t){this.stream.write(L.fillStroke),t?(this.stream.write(L.evenOdd),this.stream.write(L.newLine)):this.stream.write(L.newLine)},t.prototype.fillPath=function(t){this.stream.write(L.fill),t?(this.stream.write(L.evenOdd),this.stream.write(L.newLine)):this.stream.write(L.newLine)},t.prototype.endPath=function(){this.writeOperator(L.n)},t.prototype.closeFillPath=function(t){this.writeOperator(L.closePath),this.stream.write(L.fill),t?(this.stream.write(L.evenOdd),this.stream.write(L.newLine)):this.stream.write(L.newLine)},t.prototype.closeStrokePath=function(){this.writeOperator(L.closeStrokePath)},t.prototype.setTextScaling=function(t){this.stream.write(E.floatToString(t)),this.stream.write(L.whiteSpace),this.writeOperator(L.setTextScaling)},t.prototype.strokePath=function(){this.writeOperator(L.stroke)},t.prototype.restoreGraphicsState=function(){this.writeOperator(L.restoreState)},t.prototype.saveGraphicsState=function(){this.writeOperator(L.saveState)},t.prototype.startNextLine=function(t,e){"undefined"===typeof t?this.writeOperator(L.goToNextLine):t instanceof lt?(this.writePoint(t),this.writeOperator(L.setCoords)):(this.writePoint(t,e),this.writeOperator(L.setCoords))},t.prototype.showText=function(t){this.checkTextParam(t),this.writeText(t),this.writeOperator(L.setText)},t.prototype.setLeading=function(t){this.stream.write(E.floatToString(t)),this.stream.write(L.whiteSpace),this.writeOperator(L.setTextLeading)},t.prototype.beginPath=function(t,e){this.writePoint(t,e),this.writeOperator(L.beginPath)},t.prototype.beginText=function(){this.writeOperator(L.beginText)},t.prototype.endText=function(){this.writeOperator(L.endText)},t.prototype.appendRectangle=function(t,e,i,r){t instanceof ct?this.appendRectangle(t.x,t.y,t.width,t.height):(this.writePoint(t,e),this.writePoint(i,r),this.writeOperator(L.appendRectangle))},t.prototype.appendLineSegment=function(t,e){t instanceof lt?this.appendLineSegment(t.x,t.y):(this.writePoint(t,e),this.writeOperator(L.appendLineSegment))},t.prototype.setTextRenderingMode=function(t){this.stream.write(t.toString()),this.stream.write(L.whiteSpace),this.writeOperator(L.setRenderingMode)},t.prototype.setCharacterSpacing=function(t){this.stream.write(E.floatToString(t)),this.stream.write(L.whiteSpace),this.stream.write(L.setCharacterSpace),this.stream.write(L.newLine)},t.prototype.setWordSpacing=function(t){this.stream.write(E.floatToString(t)),this.stream.write(L.whiteSpace),this.writeOperator(L.setWordSpace)},t.prototype.showNextLineText=function(t,e){t instanceof Y?(this.checkTextParam(t),this.writeText(t),this.writeOperator(L.setTextOnNewLine)):(this.checkTextParam(t),this.writeText(t,e),this.writeOperator(L.setTextOnNewLine))},t.prototype.setColorSpace=function(t,e){if(t instanceof T&&"boolean"===typeof e){var i=t,r=e,n=r?L.selectcolorspaceforstroking:L.selectcolorspacefornonstroking;this.stream.write(i.toString()),this.stream.write(L.whiteSpace),this.stream.write(n),this.stream.write(L.newLine)}else{i=t,r=e;this.setColorSpace(new T(i),r)}},t.prototype.modifyCtm=function(t){if(null==t)throw new Error("ArgumentNullException:matrix");this.stream.write(t.toString()),this.stream.write(L.whiteSpace),this.writeOperator(L.modifyCtm)},t.prototype.setFont=function(t,e,i){if("string"===typeof e)this.setFont(t,new T(e),i);else{if(null==t)throw new Error("ArgumentNullException:font");this.stream.write(e.toString()),this.stream.write(L.whiteSpace),this.stream.write(E.floatToString(i)),this.stream.write(L.whiteSpace),this.writeOperator(L.setFont)}},t.prototype.writeOperator=function(t){this.stream.write(t),this.stream.write(L.newLine)},t.prototype.checkTextParam=function(t){if(null==t)throw new Error("ArgumentNullException:text");if("string"===typeof t&&""===t)throw new Error("ArgumentException:The text can not be an empty string, text")},t.prototype.writeText=function(t,e){if(t instanceof Y&&"undefined"===typeof e)this.stream.write(t.pdfEncode());else{var i=void 0,r=void 0;e?(i=Y.hexStringMark[0],r=Y.hexStringMark[1]):(i=Y.stringMark[0],r=Y.stringMark[1]),this.stream.write(i),this.stream.write(t),this.stream.write(r)}},t.prototype.writePoint=function(t,e){if(t instanceof lt&&"undefined"===typeof e)this.writePoint(t.x,t.y);else{var i=t;this.stream.write(E.floatToString(i)),this.stream.write(L.whiteSpace),e=this.updateY(e),this.stream.write(E.floatToString(e)),this.stream.write(L.whiteSpace)}},t.prototype.updateY=function(t){return-t},t.prototype.write=function(t){var e="";e+=t,e+=L.newLine,this.writeOperator(e)},t.prototype.writeComment=function(t){if(!(null!=t&&t.length>0))throw new Error("Invalid comment");var e="";e+=L.comment,e+=L.whiteSpace,e+=t,this.writeOperator(e)},t.prototype.setColorAndSpace=function(t,e,i){t.isEmpty||(this.stream.write(t.toString(e,i)),this.stream.write(L.newLine))},t.prototype.setLineDashPattern=function(t,e){this.setLineDashPatternHelper(t,e)},t.prototype.setLineDashPatternHelper=function(t,e){var i="[";if(t.length>1)for(var r=0;r<t.length;r++)r===t.length-1?i+=t[r].toString():i+=t[r].toString()+" ";i+="] ",i+=e.toString(),i+=" "+L.setDashPattern,this.stream.write(i),this.stream.write(L.newLine)},t.prototype.setMiterLimit=function(t){this.stream.write(E.floatToString(t)),this.stream.write(L.whiteSpace),this.writeOperator(L.setMiterLimit)},t.prototype.setLineWidth=function(t){this.stream.write(E.floatToString(t)),this.stream.write(L.whiteSpace),this.writeOperator(L.setLineWidth)},t.prototype.setLineCap=function(t){this.stream.write(t.toString()),this.stream.write(L.whiteSpace),this.writeOperator(L.setLineCapStyle)},t.prototype.setLineJoin=function(t){this.stream.write(t.toString()),this.stream.write(L.whiteSpace),this.writeOperator(L.setLineJoinStyle)},Object.defineProperty(t.prototype,"position",{get:function(){return this.stream.position},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"length",{get:function(){var t=0;if(0!==this.stream.data.length&&-1!==this.stream.data.length)for(var e=0;e<this.stream.data.length;e++)t+=this.stream.data[e].length;return t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"document",{get:function(){return null},enumerable:!0,configurable:!0}),t.prototype.appendBezierSegment=function(t,e,i,r,n,o){t instanceof lt&&e instanceof lt&&i instanceof lt?(this.writePoint(t.x,t.y),this.writePoint(e.x,e.y),this.writePoint(i.x,i.y)):(this.writePoint(t,e),this.writePoint(i,r),this.writePoint(n,o)),this.writeOperator(L.appendbeziercurve)},t.prototype.setColourWithPattern=function(t,e,i){if(null!=t){var r=t.length,n=0;for(n=0;n<r;++n)this.stream.write(t[n].toString()),this.stream.write(L.whiteSpace)}null!=e&&(this.stream.write(e.toString()),this.stream.write(L.whiteSpace)),i?this.writeOperator(L.setColorAndPatternStroking):this.writeOperator(L.setColorAndPattern)},t}(),_t=function(){function t(e,i,r,n){"undefined"===typeof e?"undefined"!==typeof i&&"undefined"!==typeof r&&"undefined"!==typeof n?this.assignRGB(i,r,n):this.filled=!1:e instanceof t?(this.redColor=e.r,this.greenColor=e.g,this.blueColor=e.b,this.grayColor=e.gray,this.alpha=e.alpha,this.filled=0!==this.alpha):"number"===typeof e&&"undefined"===typeof i&&"undefined"===typeof r&&"undefined"===typeof n?(e<0&&(e=0),e>1&&(e=1),this.redColor=e*t.maxColourChannelValue,this.greenColor=e*t.maxColourChannelValue,this.blueColor=e*t.maxColourChannelValue,this.cyanColor=e,this.magentaColor=e,this.yellowColor=e,this.blackColor=e,this.grayColor=e,this.alpha=t.maxColourChannelValue,this.filled=!0):"undefined"===typeof n?this.assignRGB(e,i,r):this.assignRGB(i,r,n,e)}return t.prototype.assignRGB=function(e,i,r,n){"undefined"===typeof e||"undefined"===typeof i||"undefined"===typeof r?this.filled=!1:(this.cyanColor=0,this.magentaColor=0,this.yellowColor=0,this.blackColor=0,this.grayColor=0,this.redColor=e,this.greenColor=i,this.blueColor=r,this.alpha="undefined"===typeof n?t.maxColourChannelValue:n,this.filled=!0,this.assignCMYK(e,i,r))},t.prototype.assignCMYK=function(e,i,r){var n=e/t.maxColourChannelValue,o=i/t.maxColourChannelValue,s=r/t.maxColourChannelValue,a=E.min(1-n,1-o,1-s),h=1===a?0:(1-n-a)/(1-a),l=1===a?0:(1-o-a)/(1-a),u=1===a?0:(1-s-a)/(1-a);this.blackColor=a,this.cyanColor=h,this.magentaColor=l,this.yellowColor=u},Object.defineProperty(t.prototype,"r",{get:function(){return this.redColor},set:function(t){this.redColor=t,this.assignCMYK(this.redColor,this.greenColor,this.blueColor),this.filled=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"red",{get:function(){return this.r/t.maxColourChannelValue},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"b",{get:function(){return this.blueColor},set:function(t){this.blueColor=t,this.assignCMYK(this.redColor,this.greenColor,this.blueColor),this.filled=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"blue",{get:function(){return this.b/t.maxColourChannelValue},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"c",{get:function(){return this.cyanColor},set:function(t){this.cyanColor=t<0?0:t>1?1:t,this.assignRGB(this.cyanColor,this.magentaColor,this.yellowColor,this.blackColor),this.filled=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"k",{get:function(){return this.blackColor},set:function(t){this.blackColor=t<0?0:t>1?1:t,this.assignRGB(this.cyanColor,this.magentaColor,this.yellowColor,this.blackColor),this.filled=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"m",{get:function(){return this.magentaColor},set:function(t){this.magentaColor=t<0?0:t>1?1:t,this.assignRGB(this.cyanColor,this.magentaColor,this.yellowColor,this.blackColor),this.filled=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.yellowColor},set:function(t){this.yellowColor=t<0?0:t>1?1:t,this.assignRGB(this.cyanColor,this.magentaColor,this.yellowColor,this.blackColor),this.filled=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"g",{get:function(){return this.greenColor},set:function(t){this.greenColor=t,this.assignCMYK(this.redColor,this.greenColor,this.blueColor),this.filled=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"green",{get:function(){return this.g/t.maxColourChannelValue},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"gray",{get:function(){return(this.redColor+this.greenColor+this.blueColor)/(3*t.maxColourChannelValue)},set:function(e){this.grayColor=e<0?0:e>1?1:e,this.r=this.grayColor*t.maxColourChannelValue,this.g=this.grayColor*t.maxColourChannelValue,this.b=this.grayColor*t.maxColourChannelValue,this.assignCMYK(this.redColor,this.greenColor,this.blueColor),this.filled=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isEmpty",{get:function(){return!this.filled},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"a",{get:function(){return this.alpha},set:function(t){this.alpha=t<0?0:t,this.filled=!0},enumerable:!0,configurable:!0}),t.prototype.toString=function(t,e){if(this.isEmpty)return"";var i="";switch(t){case Ct.Rgb:i=this.rgbToString(e);break;case Ct.GrayScale:i=this.grayScaleToString(e);break;case Ct.Cmyk:i=this.cmykToString(e);break}return i},t.prototype.grayScaleToString=function(e){var i=this.gray,r="",n=null;return n=e?t.grayStringsSroke.containsKey(i)?t.grayStringsSroke.getValue(i):null:t.grayStringsFill.containsKey(i)?t.grayStringsFill.getValue(i):null,null==n?e&&(r=i.toString()+" G",t.grayStringsSroke.setValue(i,r)):r=n.toString(),r+L.newLine},t.prototype.rgbToString=function(e){var i=this.r,r=this.g,n=this.b,o=(i<<16)+(r<<8)+n;e&&(o+=1<<24);var s="",a=null;if(t.rgbStrings.containsKey(o)&&(a=t.rgbStrings.getValue(o)),null==a){var h=i/t.maxColourChannelValue,l=r/t.maxColourChannelValue,u=n/t.maxColourChannelValue;s=e?h.toString()+" "+l.toString()+" "+u.toString()+" RG":h.toString()+" "+l.toString()+" "+u.toString()+" rg",t.rgbStrings.setValue(o,s)}else s=a.toString();return s+L.newLine},t.prototype.cmykToString=function(t){var e=this.c,i=this.m,r=this.y,n=this.b,o="";return o=e.toString()+" "+i.toString()+" "+r.toString()+" "+n.toString()+" K",o+L.newLine},t.prototype.toArray=function(t){var e=new N;switch(t){case Ct.Rgb:e.add(new E(this.red)),e.add(new E(this.green)),e.add(new E(this.blue));break}return e},t.rgbStrings=new y,t.grayStringsSroke=new y,t.grayStringsFill=new y,t.maxColourChannelValue=255,t}(),Ut=function(){function t(){}return t.prototype.clone=function(){return this},t}(),qt=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},t(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Kt=function(t){function e(e){var i=t.call(this)||this;return i.pdfColor=e,i}return qt(e,t),Object.defineProperty(e.prototype,"color",{get:function(){return this.pdfColor},set:function(t){this.pdfColor=t},enumerable:!0,configurable:!0}),e.prototype.monitorChanges=function(t,e,i,r,n){if(null==e)throw new Error("ArgumentNullException:streamWriter");var o=!1;if(null==t)return o=!0,e.setColorAndSpace(this.pdfColor,n,!1),o;return o=!0,e.setColorAndSpace(this.pdfColor,n,!1),o},e.prototype.resetChanges=function(t){t.setColorAndSpace(new _t(0,0,0),Ct.Rgb,!1)},e}(Ut),Xt=function(){function t(t,e){this.pdfColor=new _t(0,0,0),this.dashOffsetValue=0,this.penDashPattern=[0],this.pdfDashStyle=vt.Solid,this.pdfLineCap=0,this.pdfLineJoin=0,this.penWidth=1,this.internalMiterLimit=0,this.colorSpace=Ct.Rgb,t instanceof Ut?this.setBrush(t):t instanceof _t&&(this.color=t),"number"===typeof e&&(this.width=e)}return Object.defineProperty(t.prototype,"color",{get:function(){return this.pdfColor},set:function(t){this.pdfColor=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dashOffset",{get:function(){return"undefined"===typeof this.dashOffsetValue||null==this.dashOffsetValue?0:this.dashOffsetValue},set:function(t){this.dashOffsetValue=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dashPattern",{get:function(){return this.penDashPattern},set:function(t){this.penDashPattern=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dashStyle",{get:function(){return this.pdfDashStyle},set:function(t){if(this.pdfDashStyle!==t)switch(this.pdfDashStyle=t,this.pdfDashStyle){case vt.Custom:break;case vt.Dash:this.penDashPattern=[3,1];break;case vt.Dot:this.penDashPattern=[1,1];break;case vt.DashDot:this.penDashPattern=[3,1,1,1];break;case vt.DashDotDot:this.penDashPattern=[3,1,1,1,1,1];break;case vt.Solid:break;default:this.pdfDashStyle=vt.Solid,this.penDashPattern=[0];break}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lineCap",{get:function(){return this.pdfLineCap},set:function(t){this.pdfLineCap=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lineJoin",{get:function(){return this.pdfLineJoin},set:function(t){this.pdfLineJoin=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"miterLimit",{get:function(){return this.internalMiterLimit},set:function(t){this.internalMiterLimit=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.penWidth},set:function(t){this.penWidth=t},enumerable:!0,configurable:!0}),t.prototype.clone=function(){var t=this;return t},t.prototype.setBrush=function(t){var e=t;null!=e&&e instanceof Kt&&(this.color=e.color,this.pdfBrush=e),this.color=e.color,this.pdfBrush=e},t.prototype.monitorChanges=function(t,e,i,r,n,o){var s=!1;r=!0,null==t&&(s=!0),s=this.dashControl(t,r,e),e.setLineWidth(this.width),e.setLineJoin(this.lineJoin),e.setLineCap(this.lineCap);var a=this.miterLimit;a>0&&(e.setMiterLimit(a),s=!0);this.pdfBrush;return e.setColorAndSpace(this.color,n,!0),s=!0,s},t.prototype.dashControl=function(t,e,i){e=!0;var r=this.width,n=this.getPattern();return i.setLineDashPattern(n,this.dashOffset*r),e},t.prototype.getPattern=function(){for(var t=this.dashPattern,e=0;e<t.length;++e)t[e]*=this.width;return t},t}(),Jt=function(){function t(t,e){this.scalingFactor=100,this.wordWrapType=It.Word,this.internalLineLimit=!0,this.wordWrapType=It.Word,"undefined"!==typeof t&&"string"!==typeof t&&(this.textAlignment=t),"undefined"!==typeof e&&(this.verticalAlignment=e)}return Object.defineProperty(t.prototype,"alignment",{get:function(){return this.textAlignment},set:function(t){this.textAlignment=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"textDirection",{get:function(){return this.direction},set:function(t){this.direction=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lineAlignment",{get:function(){return"undefined"===typeof this.verticalAlignment||null==this.verticalAlignment?gt.Top:this.verticalAlignment},set:function(t){this.verticalAlignment=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rightToLeft",{get:function(){return"undefined"!==typeof this.isRightToLeft&&null!=this.isRightToLeft&&this.isRightToLeft},set:function(t){this.isRightToLeft=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"characterSpacing",{get:function(){return"undefined"===typeof this.internalCharacterSpacing||null==this.internalCharacterSpacing?0:this.internalCharacterSpacing},set:function(t){this.internalCharacterSpacing=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"wordSpacing",{get:function(){return"undefined"===typeof this.internalWordSpacing||null==this.internalWordSpacing?0:this.internalWordSpacing},set:function(t){this.internalWordSpacing=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lineSpacing",{get:function(){return"undefined"===typeof this.leading||null==this.leading?0:this.leading},set:function(t){this.leading=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"clipPath",{get:function(){return"undefined"!==typeof this.clip&&null!=this.clip&&this.clip},set:function(t){this.clip=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"subSuperScript",{get:function(){return"undefined"===typeof this.pdfSubSuperScript||null==this.pdfSubSuperScript?Rt.None:this.pdfSubSuperScript},set:function(t){this.pdfSubSuperScript=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"paragraphIndent",{get:function(){return"undefined"===typeof this.internalParagraphIndent||null==this.internalParagraphIndent?0:this.internalParagraphIndent},set:function(t){this.internalParagraphIndent=t,this.firstLineIndent=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lineLimit",{get:function(){return this.internalLineLimit},set:function(t){this.internalLineLimit=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"measureTrailingSpaces",{get:function(){return"undefined"!==typeof this.trailingSpaces&&null!=this.trailingSpaces&&this.trailingSpaces},set:function(t){this.trailingSpaces=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"noClip",{get:function(){return"undefined"!==typeof this.isNoClip&&null!=this.isNoClip&&this.isNoClip},set:function(t){this.isNoClip=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"wordWrap",{get:function(){return this.wordWrapType},set:function(t){this.wordWrapType=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"horizontalScalingFactor",{get:function(){return this.scalingFactor},set:function(t){if(t<=0)throw new Error("ArgumentOutOfRangeException:The scaling factor cant be less of equal to zero, ScalingFactor");this.scalingFactor=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"firstLineIndent",{get:function(){return"undefined"===typeof this.initialLineIndent||null==this.initialLineIndent?0:this.initialLineIndent},set:function(t){this.initialLineIndent=t},enumerable:!0,configurable:!0}),t.prototype.clone=function(){var t=this;return t},t}(),Yt=function(){function t(t){if(this.currentPosition=0,null==t)throw new Error("ArgumentNullException:text");this.text=t}return Object.defineProperty(t.prototype,"length",{get:function(){return this.text.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"end",{get:function(){return this.currentPosition===this.text.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"position",{get:function(){return this.currentPosition},set:function(t){this.currentPosition=t},enumerable:!0,configurable:!0}),t.getCharsCount=function(t,e){if("string"===typeof e){if(null==t)throw new Error("ArgumentNullException:wholeText");for(var i=0,r=0;;){if(r=t.indexOf(e,r),-1===r)break;i++,r++}return i}if(null==t)throw new Error("ArgumentNullException:text");if(null==e)throw new Error("ArgumentNullException:symbols");for(var n=0,o=0,s=t.length;o<s;o++){var a=t[o];this.contains(e,a)&&n++}return n},t.prototype.readLine=function(){var t=this.currentPosition;while(t<this.length){var e=this.text[t];switch(e){case"\r":case"\n":var i=this.text.substr(this.currentPosition,t-this.currentPosition);return this.currentPosition=t+1,"\r"===e&&this.currentPosition<this.length&&"\n"===this.text[this.currentPosition]&&this.currentPosition++,i}t++}if(t>this.currentPosition){var r=this.text.substr(this.currentPosition,t-this.currentPosition);return this.currentPosition=t,r}return null},t.prototype.peekLine=function(){var t=this.currentPosition,e=this.readLine();return this.currentPosition=t,e},t.prototype.readWord=function(){var t=this.currentPosition;while(t<this.length){var e=this.text[t];switch(e){case"\r":case"\n":var i=this.text.substr(this.currentPosition,t-this.currentPosition);return this.currentPosition=t+1,"\r"===e&&this.currentPosition<this.length&&"\n"===this.text[this.currentPosition]&&this.currentPosition++,i;case" ":case"\t":t===this.currentPosition&&t++;var r=this.text.substr(this.currentPosition,t-this.currentPosition);return this.currentPosition=t,r}t++}if(t>this.currentPosition){var n=this.text.substr(this.currentPosition,t-this.currentPosition);return this.currentPosition=t,n}return null},t.prototype.peekWord=function(){var t=this.currentPosition,e=this.readWord();return this.currentPosition=t,e},t.prototype.read=function(t){if("undefined"===typeof t){var e="0";return this.end||(e=this.text[this.currentPosition],this.currentPosition++),e}var i=0,r="";while(!this.end&&i<t){e=this.read();r+=e,i++}return r},t.prototype.peek=function(){var t="0";return this.end||(t=this.text[this.currentPosition]),t},t.prototype.close=function(){this.text=null},t.prototype.readToEnd=function(){var t;return t=0===this.currentPosition?this.text:this.text.substr(this.currentPosition,this.length-this.currentPosition),this.currentPosition=this.length,t},t.contains=function(t,e){for(var i=!1,r=0;r<t.length;r++)if(t[r]===e){i=!0;break}return i},t.whiteSpace=" ",t.tab="\t",t.spaces=[t.whiteSpace,t.tab],t.whiteSpacePattern="^[ \t]+$",t}(),Qt=function(){function t(){this.isOverloadWithPosition=!1}return t.prototype.layout=function(t,e,i,r,n,o,s){if(r instanceof ct){this.initialize(t,e,i,r,n),this.isOverloadWithPosition=o,this.clientSize=s;var a=this.doLayout();return this.clear(),a}this.initialize(t,e,i,r),this.isOverloadWithPosition=n,this.clientSize=o;a=this.doLayout();return this.clear(),a},t.prototype.initialize=function(t,e,i,r,n){if("number"===typeof n){if(null==t)throw new Error("ArgumentNullException:text");if(null==e)throw new Error("ArgumentNullException:font");this.text=t,this.font=e,this.format=i,this.size=new ut(r.width,r.height),this.rectangle=r,this.pageHeight=n,this.reader=new Yt(t)}else this.initialize(t,e,i,new ct(new lt(0,0),r),0)},t.prototype.clear=function(){this.font=null,this.format=null,this.reader.close(),this.reader=null,this.text=null},t.prototype.doLayout=function(){var t=new Zt,e=new Zt,i=[],r=this.reader.peekLine(),n=this.getLineIndent(!0);while(null!=r){if(e=this.layoutLine(r,n),null!==e||"undefined"!==typeof e){var o=0,s=this.copyToResult(t,e,i,o),a=s.success;if(o=s.numInserted,!a){this.reader.read(o);break}}this.reader.readLine(),r=this.reader.peekLine(),n=this.getLineIndent(!1)}return this.finalizeResult(t,i),t},t.prototype.getLineIndent=function(t){var e=0;return null!=this.format&&(e=t?this.format.firstLineIndent:this.format.paragraphIndent,e=this.size.width>0?Math.min(this.size.width,e):e),e},t.prototype.getLineHeight=function(){var t=this.font.height;return null!=this.format&&0!==this.format.lineSpacing&&(t=this.format.lineSpacing+this.font.height),t},t.prototype.getLineWidth=function(t){var e=this.font.getLineWidth(t,this.format);return e},t.prototype.layoutLine=function(t,e){var i=new Zt;i.layoutLineHeight=this.getLineHeight();var r=[],n=this.size.width,o=this.getLineWidth(t)+e,s=Wt.FirstParagraphLine,a=!0;if(n<=0||Math.round(o)<=Math.round(n))this.addToLineResult(i,r,t,o,Wt.NewLineBreak|s);else{var h="",l="";o=e;var u=e,c=new Yt(t),p=c.peekWord();p.length!==c.length&&" "===p&&(l+=p,h+=p,c.position+=1,p=c.peekWord());while(null!=p){l+=p;var d=this.getLineWidth(l.toString())+u;if(" "===l.toString()&&(l="",d=0),d>n){if(this.getWrapType()===It.None)break;if(l.length===p.length){if(this.getWrapType()===It.WordOnly){i.textRemainder=t.substring(c.position);break}if(1===l.length){h+=p;break}a=!1,l="",p=c.peek().toString();continue}if(this.getLineWidth(p.toString())>n?this.format.wordWrap=It.Character:"undefined"!==typeof this.format&&null!==this.format&&(this.format.wordWrap=It.Word),this.getWrapType()===It.Character&&a)a=!1,l="",l+=h.toString(),p=c.peek().toString();else{var f=h.toString();" "!==f&&this.addToLineResult(i,r,f,o,Wt.LayoutBreak|s),this.isOverloadWithPosition&&(n=this.clientSize.width),l="",h="",o=0,u=0,d=0,s=Wt.None,p=a?p:c.peekWord(),a=!0}}else h+=p,o=d,a?(c.readWord(),p=c.peekWord()):(c.read(),p=c.peek().toString())}if(h.length>0){f=h.toString();this.addToLineResult(i,r,f,o,Wt.NewLineBreak|Wt.LastParagraphLine)}c.close()}i.layoutLines=[];for(var g=0;g<r.length;g++)i.layoutLines.push(r[g]);return r=[],i},t.prototype.addToLineResult=function(t,e,i,r,n){var o=new $t;o.text=i,o.width=r,o.lineType=n,e.push(o);var s=t.actualSize;s.height+=this.getLineHeight(),s.width=Math.max(s.width,r),t.size=s},t.prototype.copyToResult=function(t,e,i,r){var n=!0,o=null!=this.format&&!this.format.lineLimit,s=t.actualSize.height,a=this.size.height;if(this.pageHeight>0&&a+this.rectangle.y>this.pageHeight&&(a=this.rectangle.y-this.pageHeight,a=Math.max(a,-a)),r=0,null!=e.lines)for(var h=0,l=e.lines.length;h<l;h++){var u=s+e.lineHeight;if(!(u<=a||a<=0||o)){n=!1;break}var c=e.lines[h];r+=c.text.length,c=this.trimLine(c,0===i.length),i.push(c);var p=t.actualSize;p.width=Math.max(p.width,c.width),t.size=p,s=u}if(s!=t.size.height){var d=t.actualSize;d.height=s,t.size=d}return{success:n,numInserted:r}},t.prototype.finalizeResult=function(t,e){t.layoutLines=[];for(var i=0;i<e.length;i++)t.layoutLines.push(e[i]);t.layoutLineHeight=this.getLineHeight(),this.reader.end||(t.textRemainder=this.reader.readToEnd()),e=[]},t.prototype.trimLine=function(t,e){var i=t.text,r=t.width;t.lineType,Wt.FirstParagraphLine,null==this.format||this.format.rightToLeft,Yt.spaces;return i=i.trim(),i.length!==t.text.length&&(r=this.getLineWidth(i),(t.lineType&Wt.FirstParagraphLine)>0&&(r+=this.getLineIndent(e))),t.text=i,t.width=r,t},t.prototype.getWrapType=function(){var t=null!=this.format?this.format.wordWrap:It.Word;return t},t}(),Zt=function(){function t(){}return Object.defineProperty(t.prototype,"remainder",{get:function(){return this.textRemainder},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"actualSize",{get:function(){return"undefined"===typeof this.size&&(this.size=new ut(0,0)),this.size},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lines",{get:function(){return this.layoutLines},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lineHeight",{get:function(){return this.layoutLineHeight},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return null==this.layoutLines||0===this.layoutLines.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lineCount",{get:function(){var t=this.empty?0:this.layoutLines.length;return t},enumerable:!0,configurable:!0}),t}(),$t=function(){function t(){}return Object.defineProperty(t.prototype,"lineType",{get:function(){return this.type},set:function(t){this.type=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this.content},set:function(t){this.content=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.lineWidth},set:function(t){this.lineWidth=t},enumerable:!0,configurable:!0}),t}();(function(t){t[t["None"]=0]="None",t[t["NewLineBreak"]=1]="NewLineBreak",t[t["LayoutBreak"]=2]="LayoutBreak",t[t["FirstParagraphLine"]=4]="FirstParagraphLine",t[t["LastParagraphLine"]=8]="LastParagraphLine"})(Wt||(Wt={}));var te,ee,ie,re=function(){function t(t,e){this.fontStyle=Lt.Regular,"number"===typeof t&&"undefined"===typeof e?this.fontSize=t:(this.fontSize=t,this.setStyle(e))}return Object.defineProperty(t.prototype,"name",{get:function(){return this.metrics.name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.fontSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.metrics.getHeight(null)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"style",{get:function(){return this.fontStyle},set:function(t){this.fontStyle=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bold",{get:function(){return(this.style&Lt.Bold)>0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"italic",{get:function(){return(this.style&Lt.Italic)>0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"strikeout",{get:function(){return(this.style&Lt.Strikeout)>0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"underline",{get:function(){return(this.style&Lt.Underline)>0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"metrics",{get:function(){return this.fontMetrics},set:function(t){this.fontMetrics=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"element",{get:function(){return this.pdfFontInternals},enumerable:!0,configurable:!0}),t.prototype.measureString=function(t,e,i,r,n){if("string"===typeof t&&"undefined"===typeof e)return this.measureString(t,null);if("string"===typeof t&&(e instanceof Jt||null==e)&&"undefined"===typeof i&&"undefined"===typeof r){var o=e,s=0,a=0;return this.measureString(t,o,s,a)}if("string"===typeof t&&(e instanceof Jt||null==e)&&"number"===typeof i&&"number"===typeof r){o=e;return this.measureString(t,0,o,i,r)}if("string"===typeof t&&"number"===typeof e&&(i instanceof Jt||null==i)&&"number"===typeof r&&"number"===typeof n){var h=new ut(e,0),l=i;return this.measureString(t,h,l,r,n)}if(null==t)throw Error('ArgumentNullException("text")');o=e,l=i;var u=new Qt,c=u.layout(t,this,l,o,!1,new ut(0,0));return r=t.length,n=c.empty?0:c.lines.length,c.actualSize},t.prototype.equalsTo=function(t){var e=this.equalsToFont(t);return e},t.prototype.getInternals=function(){return this.pdfFontInternals},t.prototype.setInternals=function(t){if(null==t)throw new Error("ArgumentNullException:internals");this.pdfFontInternals=t},t.prototype.setStyle=function(t){this.fontStyle=t},t.prototype.applyFormatSettings=function(t,e,i){var r=i;if(null!=e&&i>0&&(0!==e.characterSpacing&&(r+=(t.length-1)*e.characterSpacing),0!==e.wordSpacing)){var n=Yt.spaces,o=Yt.getCharsCount(t,n);r+=o*e.wordSpacing}return r},t.charSizeMultiplier=.001,t.syncObject=new Object,t}(),ne=function(){function t(t){this.radDegFactor=180/Math.PI,this.transformationMatrix=new oe(1,0,0,"undefined"===typeof t?1:-1,0,0)}return Object.defineProperty(t.prototype,"matrix",{get:function(){return this.transformationMatrix},set:function(t){this.transformationMatrix=t},enumerable:!0,configurable:!0}),t.prototype.translate=function(t,e){this.transformationMatrix.translate(t,e)},t.prototype.scale=function(t,e){this.transformationMatrix.elements[0]=t,this.transformationMatrix.elements[3]=e},t.prototype.rotate=function(t){t=t*Math.PI/180,this.transformationMatrix.elements[0]=Math.cos(t),this.transformationMatrix.elements[1]=Math.sin(t),this.transformationMatrix.elements[2]=-Math.sin(t),this.transformationMatrix.elements[3]=Math.cos(t)},t.prototype.toString=function(){for(var t="",e=" ",i=0,r=this.transformationMatrix.elements.length;i<r;i++){this.matrix.elements[i];t+=E.floatToString(this.transformationMatrix.elements[i]),t+=e}return t},t.prototype.multiply=function(t){this.transformationMatrix.multiply(t.matrix)},t.degreesToRadians=function(t){return this.degRadFactor*t},t.prototype.radiansToDegrees=function(t){return this.radDegFactor*t},t.prototype.clone=function(){return this},t.degRadFactor=Math.PI/180,t}(),oe=function(){function t(t,e,i,r,n,o){"undefined"===typeof t?this.metrixElements=[]:"number"===typeof t?(this.metrixElements=[],this.metrixElements.push(t),this.metrixElements.push(e),this.metrixElements.push(i),this.metrixElements.push(r),this.metrixElements.push(n),this.metrixElements.push(o)):this.metrixElements=t}return Object.defineProperty(t.prototype,"elements",{get:function(){return this.metrixElements},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"offsetX",{get:function(){return this.metrixElements[4]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"offsetY",{get:function(){return this.metrixElements[5]},enumerable:!0,configurable:!0}),t.prototype.translate=function(t,e){this.metrixElements[4]=t,this.metrixElements[5]=e},t.prototype.transform=function(t){var e=t.x,i=t.y,r=e*this.elements[0]+i*this.elements[2]+this.offsetX,n=e*this.elements[1]+i*this.elements[3]+this.offsetY;return new lt(r,n)},t.prototype.multiply=function(t){var e=[];e.push(this.elements[0]*t.elements[0]+this.elements[1]*t.elements[2]),e[1]=this.elements[0]*t.elements[1]+this.elements[1]*t.elements[3],e[2]=this.elements[2]*t.elements[0]+this.elements[3]*t.elements[2],e[3]=this.elements[2]*t.elements[1]+this.elements[3]*t.elements[3],e[4]=this.offsetX*t.elements[0]+this.offsetY*t.elements[2]+t.offsetX,e[5]=this.offsetX*t.elements[1]+this.offsetY*t.elements[3]+t.offsetY;for(var i=0;i<e.length;i++)this.elements[i]=e[i]},t.prototype.dispose=function(){this.metrixElements=null},t.prototype.clone=function(){var e=new t(this.metrixElements);return e},t}(),se=function(){function t(){this.pdf="PDF",this.text="Text",this.imageB="ImageB",this.imageC="ImageC",this.imageI="ImageI"}return t}(),ae=function(){function t(){this.mKeys=[],this.mValues=[]}return t.prototype.size=function(){return this.mKeys.length},t.prototype.add=function(t,e){if(void 0===t||null===t||void 0===e||null===e)throw new ReferenceError("Provided key or value is not valid.");var i=this.mKeys.indexOf(t);if(i<0)return this.mKeys.push(t),this.mValues.push(e),1;throw new RangeError("An item with the same key has already been added.")},t.prototype.keys=function(){return this.mKeys},t.prototype.values=function(){return this.mValues},t.prototype.getValue=function(t){if(void 0===t||null===t)throw new ReferenceError("Provided key is not valid.");var e=this.mKeys.indexOf(t);if(e<0)throw new RangeError("No item with the specified key has been added.");return this.mValues[e]},t.prototype.setValue=function(t,e){if(void 0===t||null===t)throw new ReferenceError("Provided key is not valid.");var i=this.mKeys.indexOf(t);i<0?(this.mKeys.push(t),this.mValues.push(e)):this.mValues[i]=e},t.prototype.remove=function(t){if(void 0===t||null===t)throw new ReferenceError("Provided key is not valid.");var e=this.mKeys.indexOf(t);if(e<0)throw new RangeError("No item with the specified key has been added.");return this.mKeys.splice(e,1),this.mValues.splice(e,1),!0},t.prototype.containsKey=function(t){if(void 0===t||null===t)throw new ReferenceError("Provided key is not valid.");var e=this.mKeys.indexOf(t);return!(e<0)},t.prototype.clear=function(){this.mKeys=[],this.mValues=[]},t}(),he=function(){function t(t,e,i){this.dictionary=new B,this.dictionaryProperties=new j,this.dictionary.items.setValue(this.dictionaryProperties.CA,new E(t)),this.dictionary.items.setValue(this.dictionaryProperties.ca,new E(e)),this.dictionary.items.setValue(this.dictionaryProperties.BM,new T(i.toString()))}return Object.defineProperty(t.prototype,"element",{get:function(){return this.dictionary},enumerable:!0,configurable:!0}),t}(),le=function(){function t(){this.automaticFieldsInformation=[]}return Object.defineProperty(t.prototype,"automaticFields",{get:function(){return this.automaticFieldsInformation},enumerable:!0,configurable:!0}),t.prototype.add=function(t){return this.automaticFields.push(t)},t}(),ue=function(){function t(){}return t.prototype.drawHelper=function(t,e,i){var r=0!==e||0!==i,n=null;r&&(n=t.save(),t.translateTransform(e,i)),this.drawInternal(t),r&&t.restore(n)},t}(),ce=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},t(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),pe=function(t){function e(){var e=t.call(this)||this;return e.internalBounds=new ct(0,0,0,0),e.internalTemplateSize=new ut(0,0),e}return ce(e,t),Object.defineProperty(e.prototype,"bounds",{get:function(){return this.internalBounds},set:function(t){this.internalBounds=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return new ut(this.bounds.width,this.bounds.height)},set:function(t){this.bounds.width=t.width,this.bounds.height=t.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"location",{get:function(){return new lt(this.bounds.x,this.bounds.y)},set:function(t){this.bounds.x=t.x,this.bounds.y=t.y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"font",{get:function(){return this.internalFont},set:function(t){this.internalFont=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"brush",{get:function(){return this.internalBrush},set:function(t){this.internalBrush=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pen",{get:function(){return this.internalPen},set:function(t){this.internalPen=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stringFormat",{get:function(){return this.internalStringFormat},set:function(t){this.internalStringFormat=t},enumerable:!0,configurable:!0}),e.prototype.performDrawHelper=function(t,e,i,r){if(0===this.bounds.height||0===this.bounds.width){var n=this.getValue(t);this.internalTemplateSize=this.getFont().measureString(n,this.size,this.stringFormat)}},e.prototype.draw=function(t,e,i){if("undefined"===typeof e){var r=new lt(0,0);this.draw(t,r)}else if(e instanceof lt)this.draw(t,e.x,e.y);else{this.drawHelper(t,e,i);var n=new de(this,new lt(e,i));t.automaticFields.add(n)}},e.prototype.getSize=function(){return 0===this.bounds.height||0===this.bounds.width?this.internalTemplateSize:this.size},e.prototype.drawInternal=function(t){},e.prototype.getBrush=function(){return"undefined"===typeof this.internalBrush||null==this.internalBrush?new Kt(new _t(0,0,0)):this.internalBrush},e.prototype.getFont=function(){return"undefined"===typeof this.internalFont||null==this.internalFont?ki.defaultFont:this.internalFont},e.prototype.getPageFromGraphics=function(t){if("undefined"!==typeof t.page&&null!==t.page){var e=t.page;return e}e=t.currentPage;return e},e}(ue),de=function(){function t(e,i,r,n){this.pageNumberFieldLocation=new lt,this.pageNumberField=null,this.scaleX=1,this.scaleY=1,"undefined"===typeof i&&e instanceof t?(this.pageNumberField=e.field,this.pageNumberFieldLocation=e.location,this.scaleX=e.scalingX,this.scaleY=e.scalingY):"undefined"===typeof r&&i instanceof lt&&e instanceof pe?(this.pageNumberField=e,this.pageNumberFieldLocation=i):(this.pageNumberField=e,this.pageNumberFieldLocation=i,this.scaleX=r,this.scaleY=n)}return Object.defineProperty(t.prototype,"location",{get:function(){return this.pageNumberFieldLocation},set:function(t){this.pageNumberFieldLocation=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"field",{get:function(){return this.pageNumberField},set:function(t){this.pageNumberField=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scalingX",{get:function(){return this.scaleX},set:function(t){this.scaleX=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scalingY",{get:function(){return this.scaleY},set:function(t){this.scaleY=t},enumerable:!0,configurable:!0}),t}(),fe=function(){function t(t){this.mPosition=0,this.buffer=new Uint8Array(t),this.dataView=new DataView(this.buffer.buffer)}return Object.defineProperty(t.prototype,"position",{get:function(){return this.mPosition},set:function(t){this.mPosition=t},enumerable:!0,configurable:!0}),t.prototype.read=function(t,e,i){for(var r=e;r<i;r++){var n=this.position;t.buffer[r]=this.readByte(n),this.position++}},t.prototype.getBuffer=function(t){return this.buffer[t]},t.prototype.writeFromBase64String=function(t){var e=this.encodedString(t);this.buffer=e},t.prototype.encodedString=function(t){var e,i,r,n,o,s,a,h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",l=0,u=0;t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");var c=3*t.length/4;t.charAt(t.length-1)===h.charAt(64)&&c--;var p=new Uint8Array(0|c);while(l<t.length)n=h.indexOf(t.charAt(l++)),o=h.indexOf(t.charAt(l++)),s=h.indexOf(t.charAt(l++)),a=h.indexOf(t.charAt(l++)),e=n<<2|o>>4,i=(15&o)<<4|s>>2,r=(3&s)<<6|a,p[u++]=e,p[u++]=i,p[u++]=r;return p},t.prototype.readByte=function(t){return this.buffer[t]},Object.defineProperty(t.prototype,"internalBuffer",{get:function(){return this.buffer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"count",{get:function(){return this.buffer.byteLength},enumerable:!0,configurable:!0}),t.prototype.readNextTwoBytes=function(t){var e=t.readByte(this.position);return this.position++,e<<=8,e|=t.readByte(this.position),this.position++,e},t}(),ge=function(){function t(){}return Object.defineProperty(t.prototype,"empty",{get:function(){var t=this.offset===this.length&&this.length===this.checksum&&0===this.checksum;return t},enumerable:!0,configurable:!0}),t}(),me=function(){function t(){}return t}(),ye=function(){function t(){}return t}(),be=function(){function t(){}return t}(),we=function(){function t(){}return Object.defineProperty(t.prototype,"isItalic",{get:function(){return 0!==(2&this.macStyle)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isBold",{get:function(){return 0!==(1&this.macStyle)},enumerable:!0,configurable:!0}),t}(),ve=function(){function t(){}return t}(),Se=function(){function t(){}return t}(),Ce=function(){function t(){}return t}(),xe=function(){function t(){}return t}(),Pe=function(){function t(){}return t}(),Oe=function(){function t(){}return t}(),Te=function(){function t(){}return Object.defineProperty(t.prototype,"empty",{get:function(){var t=this.index===this.width&&this.width===this.charCode&&0===this.charCode;return t},enumerable:!0,configurable:!0}),t.prototype.compareTo=function(t){var e=t;return this.index-e.index},t}(),Le=function(){function t(){}return t}(),je=function(){function t(){}return t}(),Be=function(){function t(){}return t}(),Ie=function(){function t(){}return t}(),Re=function(){function t(){}return t}(),ke=function(){function t(t){this.int32Size=4,this.int16Size=2,this.int64Size=8,this.bufferLength=t,this.buffer=[]}return Object.defineProperty(t.prototype,"data",{get:function(){if(this.buffer.length<this.bufferLength)for(var t=this.bufferLength-this.buffer.length,e=0;e<t;e++)this.buffer.push(0);return this.buffer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"position",{get:function(){return void 0!==this.internalPosition&&null!==this.internalPosition||(this.internalPosition=0),this.internalPosition},enumerable:!0,configurable:!0}),t.prototype.writeShort=function(t){var e=[(65280&t)>>8,255&t];this.flush(e)},t.prototype.writeInt=function(t){var e=(4278190080&t)>>24;e=e<0?256+e:e;var i=(16711680&t)>>16;i=i<0?256+i:i;var r=(65280&t)>>8;r=r<0?256+r:r;var n=255&t;n=n<0?256+n:n;var o=[(4278190080&t)>>24,(16711680&t)>>16,(65280&t)>>8,255&t];this.flush(o)},t.prototype.writeUInt=function(t){var e=[(4278190080&t)>>24,(16711680&t)>>16,(65280&t)>>8,255&t];this.flush(e)},t.prototype.writeString=function(t){if(null==t)throw new Error("Argument Null Exception : value");for(var e=[],i=0;i<t.length;i++)e.push(t.charCodeAt(i));this.flush(e)},t.prototype.writeBytes=function(t){this.flush(t)},t.prototype.flush=function(t){if(null===t)throw new Error("Argument Null Exception : buff");for(var e=this.position,i=0;i<t.length;i++)this.buffer[e]=t[i],e++;this.internalPosition+=t.length},t}(),Fe=function(){function t(t){this.int32Size=4,this.isTtcFont=!1,this.isMacTtf=!1,this.metricsName="",this.isMacTTF=!1,this.missedGlyphs=0,this.tableNames=["cvt ","fpgm","glyf","head","hhea","hmtx","loca","maxp","prep"],this.entrySelectors=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4],this.fontData=t,this.initialize()}return Object.defineProperty(t.prototype,"macintosh",{get:function(){return null!==this.macintoshDictionary&&void 0!==this.macintoshDictionary||(this.macintoshDictionary=new y),this.macintoshDictionary},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"microsoft",{get:function(){return null!==this.microsoftDictionary&&void 0!==this.microsoftDictionary||(this.microsoftDictionary=new y),this.microsoftDictionary},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"macintoshGlyphs",{get:function(){return null!==this.internalMacintoshGlyphs&&void 0!==this.internalMacintoshGlyphs||(this.internalMacintoshGlyphs=new y),this.internalMacintoshGlyphs},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"microsoftGlyphs",{get:function(){return null!==this.internalMicrosoftGlyphs&&void 0!==this.internalMicrosoftGlyphs||(this.internalMicrosoftGlyphs=new y),this.internalMicrosoftGlyphs},enumerable:!0,configurable:!0}),t.prototype.initialize=function(){void 0===this.metrics&&(this.metrics=new we),this.readFontDictionary();var t=this.readNameTable(),e=this.readHeadTable();this.initializeFontName(t),this.metrics.macStyle=e.macStyle},t.prototype.readFontDictionary=function(){this.offset=0;this.checkPreambula();var t=this.readInt16(this.offset);this.readInt16(this.offset),this.readInt16(this.offset),this.readInt16(this.offset);void 0===this.tableDirectory&&(this.tableDirectory=new y);for(var e=0;e<t;++e){var i=new ge,r=this.readString(this.int32Size);i.checksum=this.readInt32(this.offset),i.offset=this.readInt32(this.offset),i.length=this.readInt32(this.offset),this.tableDirectory.setValue(r,i)}this.lowestPosition=this.offset,this.isTtcFont||this.fixOffsets()},t.prototype.fixOffsets=function(){for(var t=Number.MAX_VALUE,e=this.tableDirectory.keys(),i=0;i<e.length;i++){var r=this.tableDirectory.getValue(e[i]),n=r.offset;if(t>n&&(t=n,t<=this.lowestPosition))break}var o=t-this.lowestPosition;if(0!==o){var s=new y;for(i=0;i<e.length;i++){r=this.tableDirectory.getValue(e[i]);r.offset-=o,s.setValue(e[i],r)}this.tableDirectory=s}},t.prototype.checkPreambula=function(){var t=this.readInt32(this.offset);if(this.isMacTtf=1953658213===t,65536!==t&&1953658213!==t&&1330926671!==t){this.isTtcFont=!0,this.offset=0;var e=this.readString(4);if("ttcf"!==e)throw new Error("Can not read TTF font data");this.offset+=4;var i=this.readInt32(this.offset);if(i<0)throw new Error("Can not read TTF font data");this.offset=this.readInt32(this.offset),t=this.readInt32(this.offset)}return t},t.prototype.readNameTable=function(){var t=this.getTable("name");this.offset=t.offset;var e=new me;e.formatSelector=this.readUInt16(this.offset),e.recordsCount=this.readUInt16(this.offset),e.offset=this.readUInt16(this.offset),e.nameRecords=[];for(var i=12,r=this.offset,n=0;n<e.recordsCount;n++){this.offset=r;var o=new ye;o.platformID=this.readUInt16(this.offset),o.encodingID=this.readUInt16(this.offset),o.languageID=this.readUInt16(this.offset),o.nameID=this.readUInt16(this.offset),o.length=this.readUInt16(this.offset),o.offset=this.readUInt16(this.offset),this.offset=t.offset+e.offset+o.offset;var s=0===o.platformID||3===o.platformID;o.name=this.readString(o.length,s),e.nameRecords[n]=o,r+=i}return e},t.prototype.readHeadTable=function(){var t=this.getTable("head");this.offset=t.offset;var e=new be;return e.version=this.readFixed(this.offset),e.fontRevision=this.readFixed(this.offset),e.checkSumAdjustment=this.readUInt32(this.offset),e.magicNumber=this.readUInt32(this.offset),e.flags=this.readUInt16(this.offset),e.unitsPerEm=this.readUInt16(this.offset),e.created=this.readInt64(this.offset),e.modified=this.readInt64(this.offset),e.xMin=this.readInt16(this.offset),e.yMin=this.readInt16(this.offset),e.xMax=this.readInt16(this.offset),e.yMax=this.readInt16(this.offset),e.macStyle=this.readUInt16(this.offset),e.lowestReadableSize=this.readUInt16(this.offset),e.fontDirectionHint=this.readInt16(this.offset),e.indexToLocalFormat=this.readInt16(this.offset),e.glyphDataFormat=this.readInt16(this.offset),e},t.prototype.readHorizontalHeaderTable=function(){var t=this.getTable("hhea");this.offset=t.offset;var e=new ve;return e.version=this.readFixed(this.offset),e.ascender=this.readInt16(this.offset),e.descender=this.readInt16(this.offset),e.lineGap=this.readInt16(this.offset),e.advanceWidthMax=this.readUInt16(this.offset),e.minLeftSideBearing=this.readInt16(this.offset),e.minRightSideBearing=this.readInt16(this.offset),e.xMaxExtent=this.readInt16(this.offset),e.caretSlopeRise=this.readInt16(this.offset),e.caretSlopeRun=this.readInt16(this.offset),this.offset+=10,e.metricDataFormat=this.readInt16(this.offset),e.numberOfHMetrics=this.readUInt16(this.offset),e},t.prototype.readOS2Table=function(){var t=this.getTable("OS/2");this.offset=t.offset;var e=new Se;return e.version=this.readUInt16(this.offset),e.xAvgCharWidth=this.readInt16(this.offset),e.usWeightClass=this.readUInt16(this.offset),e.usWidthClass=this.readUInt16(this.offset),e.fsType=this.readInt16(this.offset),e.ySubscriptXSize=this.readInt16(this.offset),e.ySubscriptYSize=this.readInt16(this.offset),e.ySubscriptXOffset=this.readInt16(this.offset),e.ySubscriptYOffset=this.readInt16(this.offset),e.ySuperscriptXSize=this.readInt16(this.offset),e.ySuperscriptYSize=this.readInt16(this.offset),e.ySuperscriptXOffset=this.readInt16(this.offset),e.ySuperscriptYOffset=this.readInt16(this.offset),e.yStrikeoutSize=this.readInt16(this.offset),e.yStrikeoutPosition=this.readInt16(this.offset),e.sFamilyClass=this.readInt16(this.offset),e.panose=this.readBytes(10),e.ulUnicodeRange1=this.readUInt32(this.offset),e.ulUnicodeRange2=this.readUInt32(this.offset),e.ulUnicodeRange3=this.readUInt32(this.offset),e.ulUnicodeRange4=this.readUInt32(this.offset),e.vendorIdentifier=this.readBytes(4),e.fsSelection=this.readUInt16(this.offset),e.usFirstCharIndex=this.readUInt16(this.offset),e.usLastCharIndex=this.readUInt16(this.offset),e.sTypoAscender=this.readInt16(this.offset),e.sTypoDescender=this.readInt16(this.offset),e.sTypoLineGap=this.readInt16(this.offset),e.usWinAscent=this.readUInt16(this.offset),e.usWinDescent=this.readUInt16(this.offset),e.ulCodePageRange1=this.readUInt32(this.offset),e.ulCodePageRange2=this.readUInt32(this.offset),e.version>1?(e.sxHeight=this.readInt16(this.offset),e.sCapHeight=this.readInt16(this.offset),e.usDefaultChar=this.readUInt16(this.offset),e.usBreakChar=this.readUInt16(this.offset),e.usMaxContext=this.readUInt16(this.offset)):(e.sxHeight=0,e.sCapHeight=0,e.usDefaultChar=0,e.usBreakChar=0,e.usMaxContext=0),e},t.prototype.readPostTable=function(){var t=this.getTable("post");this.offset=t.offset;var e=new Ce;return e.formatType=this.readFixed(this.offset),e.italicAngle=this.readFixed(this.offset),e.underlinePosition=this.readInt16(this.offset),e.underlineThickness=this.readInt16(this.offset),e.isFixedPitch=this.readUInt32(this.offset),e.minType42=this.readUInt32(this.offset),e.maxType42=this.readUInt32(this.offset),e.minType1=this.readUInt32(this.offset),e.maxType1=this.readUInt32(this.offset),e},t.prototype.readWidthTable=function(t,e){var i=this.getTable("hmtx");this.offset=i.offset;for(var r=[],n=0;n<t;n++){var o=new xe;o.advanceWidth=this.readUInt16(this.offset),o.lsb=this.readInt16(this.offset);var s=1e3*o.advanceWidth/e;r.push(Math.floor(s))}return r},t.prototype.readCmapTable=function(){var t=this.getTable("cmap");this.offset=t.offset;var e=new Oe;e.version=this.readUInt16(this.offset),e.tablesCount=this.readUInt16(this.offset);for(var i=this.offset,r=[],n=0;n<e.tablesCount;n++){this.offset=i;var o=new Pe;o.platformID=this.readUInt16(this.offset),o.encodingID=this.readUInt16(this.offset),o.offset=this.readUInt32(this.offset),i=this.offset,this.readCmapSubTable(o),r[n]=o}return r},t.prototype.readCmapSubTable=function(t){var e=this.getTable("cmap");this.offset=e.offset+t.offset;var i=this.readUInt16(this.offset),r=this.getCmapEncoding(t.platformID,t.encodingID);r===Mt.Macintosh?At.Macintosh:At.Microsoft;if(r!==Mt.Unknown)switch(i){case Ft.Apple:this.readAppleCmapTable(t,r);break;case Ft.Microsoft:this.readMicrosoftCmapTable(t,r);break;case Ft.Trimmed:this.readTrimmedCmapTable(t,r);break}},t.prototype.readAppleCmapTable=function(t,e){var i=this.getTable("cmap");this.offset=i.offset+t.offset;var r=new je;r.format=this.readUInt16(this.offset),r.length=this.readUInt16(this.offset),r.version=this.readUInt16(this.offset),null!==this.maxMacIndex&&void 0!==this.maxMacIndex||(this.maxMacIndex=0);for(var n=0;n<256;++n){var o=new Te;o.index=this.readByte(this.offset),o.width=this.getWidth(o.index),o.charCode=n,this.macintosh.setValue(n,o),this.addGlyph(o,e),this.maxMacIndex=Math.max(n,this.maxMacIndex)}},t.prototype.readMicrosoftCmapTable=function(t,e){var i=this.getTable("cmap");this.offset=i.offset+t.offset;var r=e===Mt.Unicode?this.microsoft:this.macintosh,n=new Be;n.format=this.readUInt16(this.offset),n.length=this.readUInt16(this.offset),n.version=this.readUInt16(this.offset),n.segCountX2=this.readUInt16(this.offset),n.searchRange=this.readUInt16(this.offset),n.entrySelector=this.readUInt16(this.offset),n.rangeShift=this.readUInt16(this.offset);var o=n.segCountX2/2;n.endCount=this.readUshortArray(o),n.reservedPad=this.readUInt16(this.offset),n.startCount=this.readUshortArray(o),n.idDelta=this.readUshortArray(o),n.idRangeOffset=this.readUshortArray(o);var s=n.length/2-8-4*o;n.glyphID=this.readUshortArray(s);for(var a=0,h=0,l=0;l<o;l++)for(var u=n.startCount[l];u<=n.endCount[l]&&65535!==u;u++){if(0===n.idRangeOffset[l])a=u+n.idDelta[l]&65535;else{if(h=l+n.idRangeOffset[l]/2-o+u-n.startCount[l],h>=n.glyphID.length)continue;a=n.glyphID[h]+n.idDelta[l]&65535}var c=new Te;c.index=a,c.width=this.getWidth(c.index);var p=e===Mt.Symbol&&61440===(65280&u)?255&u:u;c.charCode=p,r.setValue(p,c),this.addGlyph(c,e)}},t.prototype.readTrimmedCmapTable=function(t,e){var i=this.getTable("cmap");this.offset=i.offset+t.offset;var r=new Ie;r.format=this.readUInt16(this.offset),r.length=this.readUInt16(this.offset),r.version=this.readUInt16(this.offset),r.firstCode=this.readUInt16(this.offset),r.entryCount=this.readUInt16(this.offset);for(var n=0;n<r.entryCount;++n){var o=new Te;o.index=this.readUInt16(this.offset),o.width=this.getWidth(o.index),o.charCode=n+r.firstCode,this.macintosh.setValue(n,o),this.addGlyph(o,e),this.maxMacIndex=Math.max(n,this.maxMacIndex)}},t.prototype.initializeFontName=function(t){for(var e=0;e<t.recordsCount;e++){var i=t.nameRecords[e];if(1===i.nameID?this.metrics.fontFamily=i.name:6===i.nameID&&(this.metrics.postScriptName=i.name),null!==this.metrics.fontFamily&&void 0!==this.metrics.fontFamily&&null!==this.metrics.postScriptName&&void 0!==this.metrics.postScriptName)break}},t.prototype.getTable=function(t){var e,i=new ge;return this.tableDirectory.containsKey(t)&&(e=this.tableDirectory.getValue(t)),null!==e&&void 0!==e&&(i=e),i},t.prototype.getWidth=function(t){return t=t<this.width.length?t:this.width.length-1,this.width[t]},t.prototype.getCmapEncoding=function(t,e){var i=Mt.Unknown;return t==At.Microsoft&&e==Et.Undefined?i=Mt.Symbol:t==At.Microsoft&&e==Et.Unicode?i=Mt.Unicode:t==At.Macintosh&&e==Nt.Roman&&(i=Mt.Macintosh),i},t.prototype.addGlyph=function(t,e){var i=null;switch(e){case Mt.Unicode:i=this.microsoftGlyphs;break;case Mt.Macintosh:case Mt.Symbol:i=this.macintoshGlyphs;break}i.setValue(t.index,t)},t.prototype.initializeMetrics=function(t,e,i,r,n,o){this.initializeFontName(t);for(var s=!1,a=0;a<o.length;a++){var h=o[a],l=this.getCmapEncoding(h.platformID,h.encodingID);if(l===Mt.Symbol){s=!0;break}}this.metrics.isSymbol=s,this.metrics.macStyle=e.macStyle,this.metrics.isFixedPitch=0!==n.isFixedPitch,this.metrics.italicAngle=n.italicAngle;var u=1e3/e.unitsPerEm;this.metrics.winAscent=r.sTypoAscender*u,this.metrics.macAscent=i.ascender*u,this.metrics.capHeight=0!==r.sCapHeight?r.sCapHeight:.7*e.unitsPerEm*u,this.metrics.winDescent=r.sTypoDescender*u,this.metrics.macDescent=i.descender*u,this.metrics.leading=(r.sTypoAscender-r.sTypoDescender+r.sTypoLineGap)*u,this.metrics.lineGap=Math.ceil(i.lineGap*u);var c=e.xMin*u,p=Math.ceil(this.metrics.macAscent+this.metrics.lineGap),d=e.xMax*u,f=this.metrics.macDescent;this.metrics.fontBox=new pt(c,p,d,f),this.metrics.stemV=80,this.metrics.widthTable=this.updateWidth(),this.metrics.contains=this.tableDirectory.containsKey("CFF"),this.metrics.subScriptSizeFactor=e.unitsPerEm/r.ySubscriptYSize,this.metrics.superscriptSizeFactor=e.unitsPerEm/r.ySuperscriptYSize},t.prototype.updateWidth=function(){var t=256,e=[];if(this.metrics.isSymbol)for(var i=0;i<t;i++){var r=this.getGlyph(String.fromCharCode(i));e[i]=r.empty?0:r.width}else{var n=[],o="?",s=String.fromCharCode(32);for(i=0;i<t;i++){n[0]=i;var a=this.getString(n,0,n.length),h=a.length>0?a[0]:o;r=this.getGlyph(h);r.empty?(r=this.getGlyph(s),e[i]=r.empty?0:r.width):e[i]=r.width}}return e},t.prototype.getDefaultGlyph=function(){var t=this.getGlyph(Yt.whiteSpace);return t},t.prototype.getString=function(t,e,i){for(var r="",n=0;n<i;n++)r+=String.fromCharCode(t[n+e]);return r},t.prototype.readLocaTable=function(t){var e=this.getTable("loca");this.offset=e.offset;var i=new Le,r=null;if(t){var n=e.length/2;r=[];for(var o=0;o<n;o++)r[o]=2*this.readUInt16(this.offset)}else{n=e.length/4;r=[];for(o=0;o<n;o++)r[o]=this.readUInt32(this.offset)}return i.offsets=r,i},t.prototype.updateGlyphChars=function(t,e){t.containsKey(0)||t.setValue(0,0);for(var i=new y,r=t.keys(),n=0;n<r.length;n++)i.setValue(r[n],t.getValue(r[n]));for(n=0;n<r.length;n++){var o=r[n];this.processCompositeGlyph(t,o,e)}},t.prototype.processCompositeGlyph=function(t,e,i){if(e<i.offsets.length-1){var r=i.offsets[e];if(r!==i.offsets[e+1]){var n=this.getTable("glyf");this.offset=n.offset+r;var o=new Re;if(o.numberOfContours=this.readInt16(this.offset),o.xMin=this.readInt16(this.offset),o.yMin=this.readInt16(this.offset),o.xMax=this.readInt16(this.offset),o.yMax=this.readInt16(this.offset),o.numberOfContours<0){var s=0,a=!0;while(a){var h=this.readUInt16(this.offset),l=this.readUInt16(this.offset);if(t.containsKey(l)||t.setValue(l,0),0===(h&Vt.MoreComponents))break;s=0!==(h&Vt.Arg1And2AreWords)?4:2,0!==(h&Vt.WeHaveScale)?s+=2:0!==(h&Vt.WeHaveAnXyScale)?s+=4:0!==(h&Vt.WeHaveTwoByTwo)&&(s+=8),this.offset+=s}}}}},t.prototype.generateGlyphTable=function(t,e,i,r){i=[];var n=t.keys();n.sort(function(t,e){return t-e});for(var o=0,s=0;s<n.length;s++){var a=n[s];e.offsets.length>0&&(o+=e.offsets[a+1]-e.offsets[a])}var h=this.align(o);r=[];for(s=0;s<h;s++)r.push(0);var l=0,u=0,c=this.getTable("glyf");for(s=0;s<e.offsets.length;s++)if(i.push(l),u<n.length&&n[u]===s){++u,i[s]=l;var p=e.offsets[s],d=e.offsets[s+1]-p;if(d>0){this.offset=c.offset+p;var f=this.read(r,l,d);r=f.buffer,l+=d}}return{glyphTableSize:o,newLocaTable:i,newGlyphTable:r}},t.prototype.updateLocaTable=function(t,e,i){if(null===t)throw new Error("Argument Null Exception : newLocaTable");for(var r=e?2*t.length:4*t.length,n=this.align(r),o=new ke(n),s=0;s<t.length;s++){var a=t[s];e?(a/=2,o.writeShort(a)):o.writeInt(a)}return{newLocaUpdated:o.data,newLocaSize:r}},t.prototype.align=function(t){return t+3&-4},t.prototype.getFontProgram=function(t,e,i,r){if(null===t)throw new Error("Argument Null Exception : newLocaTableOut");if(null===e)throw new Error("Argument Null Exception : newGlyphTable");this.tableNames;var n=this.getFontProgramLength(t,e,0),o=n.fontProgramLength,s=n.numTables,a=new ke(o);a.writeInt(65536),a.writeShort(s);var h=this.entrySelectors[s];return a.writeShort(16*(1<<(31&h))),a.writeShort(h),a.writeShort(16*(s-(1<<(31&h)))),this.writeCheckSums(a,s,t,e,i,r),this.writeGlyphs(a,t,e),a.data},t.prototype.getFontProgramLength=function(t,e,i){if(null===t)throw new Error("Argument Null Exception : newLocaTableOut");if(null===e)throw new Error("Argument Null Exception : newGlyphTable");i=2;for(var r=this.tableNames,n=0,o=0;o<r.length;o++){var s=r[o];if("glyf"!==s&&"loca"!==s){var a=this.getTable(s);a.empty||(++i,n+=this.align(a.length))}}n+=t.length,n+=e.length;var h=16*i+12;return n+=h,{fontProgramLength:n,numTables:i}},t.prototype.writeCheckSums=function(t,e,i,r,n,o){if(null===t)throw new Error("Argument Null Exception : writer");if(null===i)throw new Error("Argument Null Exception : newLocaTableOut");if(null===r)throw new Error("Argument Null Exception : newGlyphTable");for(var s=this.tableNames,a=16*e+12,h=0,l=0;l<s.length;l++){var u=s[l],c=this.getTable(u);if(!c.empty){if(t.writeString(u),"glyf"===u){var p=this.calculateCheckSum(r);t.writeInt(p),h=n}else if("loca"===u){p=this.calculateCheckSum(i);t.writeInt(p),h=o}else t.writeInt(c.checksum),h=c.length;t.writeUInt(a),t.writeUInt(h),a+=this.align(h)}}},t.prototype.calculateCheckSum=function(t){if(null===t)throw new Error("Argument Null Exception : bytes");for(var e=0,i=0,r=0,n=0,o=0,s=0;s<(t.length+1)/4;s++)o+=255&t[e++],n+=255&t[e++],r+=255&t[e++],i+=255&t[e++];var a=i;return a+=r<<8,a+=n<<16,a+=o<<24,a},t.prototype.writeGlyphs=function(t,e,i){if(null===t)throw new Error("Argument Null Exception : writer");if(null===e)throw new Error("Argument Null Exception : newLocaTableOut");if(null===i)throw new Error("Argument Null Exception : newGlyphTable");for(var r=this.tableNames,n=0;n<r.length;n++){var o=r[n],s=this.getTable(o);if(!s.empty)if("glyf"===o)t.writeBytes(i);else if("loca"===o)t.writeBytes(e);else{for(var a=this.align(s.length),h=[],l=0;l<a;l++)h.push(0);this.offset=s.offset;var u=this.read(h,0,s.length);t.writeBytes(u.buffer)}}},t.prototype.setOffset=function(t){this.offset=t},t.prototype.createInternals=function(){this.metrics=new we;var t=this.readNameTable(),e=this.readHeadTable();this.bIsLocaShort=0===e.indexToLocalFormat;var i=this.readHorizontalHeaderTable(),r=this.readOS2Table(),n=this.readPostTable();this.width=this.readWidthTable(i.numberOfHMetrics,e.unitsPerEm);var o=this.readCmapTable();this.initializeMetrics(t,e,i,r,n,o)},t.prototype.getGlyph=function(t){if("number"===typeof t){var e=null;this.metrics.isSymbol||null==this.microsoftGlyphs?this.metrics.isSymbol&&null!=this.macintoshGlyphs&&this.macintoshGlyphs.containsKey(t)&&(e=this.macintoshGlyphs.getValue(t)):this.microsoftGlyphs.containsKey(t)&&(e=this.microsoftGlyphs.getValue(t));var i=null!=e?e:this.getDefaultGlyph();return i}var r=null,n=t.charCodeAt(0);this.metrics.isSymbol||null===this.microsoft?(this.metrics.isSymbol&&null!==this.macintosh||this.isMacTTF)&&(0!==this.maxMacIndex?n%=this.maxMacIndex+1:n=61440===(65280&n)?255&n:n,this.macintosh.containsKey(n)&&(r=this.macintosh.getValue(n),this.isFontPresent=!0)):this.microsoft.containsKey(n)?(r=this.microsoft.getValue(n),n!==Yt.whiteSpace.charCodeAt(0)&&(this.isFontPresent=!0)):n!==Yt.whiteSpace.charCodeAt(0)&&(this.isFontPresent=!1),t===Yt.whiteSpace&&null===r&&(r=new Te);i=null!==r?r:this.getDefaultGlyph();return i},t.prototype.getGlyphChars=function(t){if(null===t||void 0===t)throw new Error("Argument Null Exception : chars");for(var e=new y,i=t.keys(),r=0;r<i.length;r++){var n=i[r],o=this.getGlyph(n);o.empty||e.setValue(o.index,n.charCodeAt(0))}return e},t.prototype.getAllGlyphs=function(){for(var t=[],e=new Te,i=0,r=0;r<this.width.length;r++){var n=this.width[r];e.index=i,e.width=n,t.push(e),i++}return t},t.prototype.readFontProgram=function(t){var e=this.getGlyphChars(t),i=this.readLocaTable(this.bIsLocaShort);e.size()<t.size()&&(this.missedGlyphs=t.size()-e.size()),this.updateGlyphChars(e,i);var r=this.generateGlyphTable(e,i,null,null),n=r.glyphTableSize,o=r.newLocaTable,s=r.newGlyphTable,a=this.updateLocaTable(o,this.bIsLocaShort,null),h=a.newLocaSize,l=a.newLocaUpdated,u=this.getFontProgram(l,s,n,h);return u},t.prototype.convertString=function(t){if(null===t)throw new Error("Argument Null Exception : text");for(var e="",i=0;i<t.length;i++){var r=t[i],n=this.getGlyph(r);n.empty||(e+=String.fromCharCode(n.index),0)}return e},t.prototype.getCharWidth=function(t){var e=this.getGlyph(t);e=e.empty?this.getDefaultGlyph():e;var i=e.empty?0:e.width;return i},t.prototype.readString=function(t,e){if(void 0===e)return this.readString(t,!1);var i="";if(e)for(var r=0;r<t;r++)r%2!==0&&(i+=String.fromCharCode(this.fontData[this.offset])),this.offset+=1;else for(r=0;r<t;r++)i+=String.fromCharCode(this.fontData[this.offset]),this.offset+=1;return i},t.prototype.readFixed=function(t){var e=this.readInt16(t),i=this.readInt16(t+2),r=i/16384;return e+r},t.prototype.readInt32=function(t){var e=this.fontData[t+3],i=this.fontData[t+2],r=this.fontData[t+1],n=this.fontData[t];return this.offset+=4,e+(i<<8)+(r<<16)+(n<<24)},t.prototype.readUInt32=function(t){var e=this.fontData[t+3],i=this.fontData[t+2],r=this.fontData[t+1],n=this.fontData[t];return this.offset+=4,e|i<<8|r<<16|n<<24},t.prototype.readInt16=function(t){var e=(this.fontData[t]<<8)+this.fontData[t+1];return e=32768&e?e-65536:e,this.offset+=2,e},t.prototype.readInt64=function(t){var e=this.readInt32(t+4),i=4294967296*this.readInt32(t)+e;return e<0&&(i+=4294967296),i},t.prototype.readUInt16=function(t){var e=this.fontData[t]<<8|this.fontData[t+1];return this.offset+=2,e},t.prototype.readUshortArray=function(t){for(var e=[],i=0;i<t;i++)e[i]=this.readUInt16(this.offset);return e},t.prototype.readBytes=function(t){for(var e=[],i=0;i<t;i++)e.push(this.fontData[this.offset]),this.offset+=1;return e},t.prototype.readByte=function(t){var e=this.fontData[t];return this.offset+=1,e},t.prototype.read=function(t,e,i){if(null===t)throw new Error("Argument Null Exception : buffer");var r=0,n=0;do{for(var o=0;o<i-r&&this.offset+o<this.fontData.length;o++)t[e+o]=this.fontData[this.offset+o];n=i-r,this.offset+=n,r+=n}while(r<i);return{buffer:t,written:r}},t}(),Me=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},t(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Ae=function(){function t(){this.lineGap=0}return t.prototype.getAscent=function(t){var e=this.ascent*re.charSizeMultiplier*this.getSize(t);return e},t.prototype.getDescent=function(t){var e=this.descent*re.charSizeMultiplier*this.getSize(t);return e},t.prototype.getLineGap=function(t){var e=this.lineGap*re.charSizeMultiplier*this.getSize(t);return e},t.prototype.getHeight=function(t){for(var e,i=["cambria","candara","constantia","corbel","cariadings"],r=[],n=0;n<i.length;n++){var o=i[n];r.push(o)}return e=this.getDescent(t)<0?this.getAscent(t)-this.getDescent(t)+this.getLineGap(t):this.getAscent(t)+this.getDescent(t)+this.getLineGap(t),e},t.prototype.getSize=function(t){var e=this.size;if(null!=t)switch(t.subSuperScript){case Rt.SubScript:e/=this.subScriptSizeFactor;break;case Rt.SuperScript:e/=this.superscriptSizeFactor;break}return e},t.prototype.clone=function(){var t=this;return t.widthTable=Ee.clone(),t},Object.defineProperty(t.prototype,"widthTable",{get:function(){return this.internalWidthTable},set:function(t){this.internalWidthTable=t},enumerable:!0,configurable:!0}),t}(),Ee=function(){function t(){}return t.clone=function(){return null},t}(),Ne=function(t){function e(e){var i=t.call(this)||this;if(null==e)throw new Error("ArgumentNullException:widths");return i.widths=e,i}return Me(e,t),e.prototype.items=function(t){if(t<0||t>=this.widths.length)throw new Error("ArgumentOutOfRangeException:index, The character is not supported by the font.");var e=this.widths[t];return e},Object.defineProperty(e.prototype,"length",{get:function(){return this.widths.length},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=this;return t.widths=this.widths,t},e.prototype.toArray=function(){var t=new N(this.widths);return t},e}(Ee),De=function(){function t(t,e){if(this.nameString="ABCDEFGHIJKLMNOPQRSTUVWXYZ",this.dictionaryProperties=new j,this.isCompress=!1,this.isEmbedFont=!1,this.cmapPrefix="/CIDInit /ProcSet findresource begin\n12 dict begin\nbegincmap"+L.newLine+"/CIDSystemInfo << /Registry (Adobe)/Ordering (UCS)/Supplement 0>> def\n/CMapName /Adobe-Identity-UCS def\n/CMapType 2 def\n1 begincodespacerange"+L.newLine,this.cmapEndCodespaceRange="endcodespacerange"+L.newLine,this.cmapBeginRange="beginbfrange"+L.newLine,this.cmapEndRange="endbfrange"+L.newLine,this.cmapSuffix="endbfrange\nendcmap\nCMapName currentdict /CMap defineresource pop\nend end"+L.newLine,null===t||void 0===t)throw new Error("ArgumentNullException:base64String");this.fontSize=e,this.fontString=t,this.Initialize()}return t.prototype.getCharWidth=function(t){var e=this.ttfReader.getCharWidth(t);return e},t.prototype.getLineWidth=function(t){for(var e=0,i=0,r=t.length;i<r;i++){var n=t[i],o=this.getCharWidth(n);e+=o}return e},t.prototype.Initialize=function(){var t=new fe(this.fontString.length);t.writeFromBase64String(this.fontString),this.fontData=t.internalBuffer,this.ttfReader=new Fe(this.fontData),this.ttfMetrics=this.ttfReader.metrics},t.prototype.createInternals=function(){this.fontDictionary=new B,this.fontProgram=new q,this.cmap=new q,this.descendantFont=new B,this.metrics=new Ae,this.ttfReader.createInternals(),this.ttfMetrics=this.ttfReader.metrics,this.initializeMetrics(),this.subsetName=this.getFontName(),this.createDescendantFont(),this.createCmap(),this.createFontDictionary(),this.createFontProgram()},t.prototype.getInternals=function(){return this.fontDictionary},t.prototype.initializeMetrics=function(){var t=this.ttfReader.metrics;this.metrics.ascent=t.macAscent,this.metrics.descent=t.macDescent,this.metrics.height=t.macAscent-t.macDescent+t.lineGap,this.metrics.name=t.fontFamily,this.metrics.postScriptName=t.postScriptName,this.metrics.size=this.fontSize,this.metrics.widthTable=new Ne(t.widthTable),this.metrics.lineGap=t.lineGap,this.metrics.subScriptSizeFactor=t.subScriptSizeFactor,this.metrics.superscriptSizeFactor=t.superscriptSizeFactor,this.metrics.isBold=t.isBold},t.prototype.getFontName=function(){for(var t,e="",i=0;i<6;i++){var r=Math.floor(26*Math.random())+0;e+=this.nameString[r]}return e+="+",e+=this.ttfReader.metrics.postScriptName,t=e.toString(),t=this.formatName(t),t},t.prototype.formatName=function(t){var e=t.replace("(","#28");return e=e.replace(")","#29"),e=e.replace("[","#5B"),e=e.replace("]","#5D"),e=e.replace("<","#3C"),e=e.replace(">","#3E"),e=e.replace("{","#7B"),e=e.replace("}","#7D"),e=e.replace("/","#2F"),e=e.replace("%","#25"),e.replace(" ","#20")},t.prototype.createDescendantFont=function(){this.descendantFont.isFont=!0,this.descendantFont.descendantFontBeginSave=new R(this),this.descendantFont.items.setValue(this.dictionaryProperties.type,new T(this.dictionaryProperties.font)),this.descendantFont.items.setValue(this.dictionaryProperties.subtype,new T(this.dictionaryProperties.cIDFontType2)),this.descendantFont.items.setValue(this.dictionaryProperties.baseFont,new T(this.subsetName)),this.descendantFont.items.setValue(this.dictionaryProperties.cIDToGIDMap,new T(this.dictionaryProperties.identity)),this.descendantFont.items.setValue(this.dictionaryProperties.dw,new E(1e3)),this.fontDescriptor=this.createFontDescriptor(),this.descendantFont.items.setValue(this.dictionaryProperties.fontDescriptor,new Z(this.fontDescriptor));var t=this.createSystemInfo();this.descendantFont.items.setValue(this.dictionaryProperties.cIDSystemInfo,t)},t.prototype.createFontDescriptor=function(){var t=new B,e=this.ttfReader.metrics;return t.isFont=!0,t.items.setValue(this.dictionaryProperties.type,new T(this.dictionaryProperties.fontDescriptor)),t.items.setValue(this.dictionaryProperties.fontName,new T(this.subsetName)),t.items.setValue(this.dictionaryProperties.flags,new E(this.getDescriptorFlags())),t.items.setValue(this.dictionaryProperties.fontBBox,N.fromRectangle(this.getBoundBox())),t.items.setValue(this.dictionaryProperties.missingWidth,new E(e.widthTable[32])),t.items.setValue(this.dictionaryProperties.stemV,new E(e.stemV)),t.items.setValue(this.dictionaryProperties.italicAngle,new E(e.italicAngle)),t.items.setValue(this.dictionaryProperties.capHeight,new E(e.capHeight)),t.items.setValue(this.dictionaryProperties.ascent,new E(e.winAscent)),t.items.setValue(this.dictionaryProperties.descent,new E(e.winDescent)),t.items.setValue(this.dictionaryProperties.leading,new E(e.leading)),t.items.setValue(this.dictionaryProperties.avgWidth,new E(e.widthTable[32])),t.items.setValue(this.dictionaryProperties.fontFile2,new Z(this.fontProgram)),t.items.setValue(this.dictionaryProperties.maxWidth,new E(e.widthTable[32])),t.items.setValue(this.dictionaryProperties.xHeight,new E(0)),t.items.setValue(this.dictionaryProperties.stemH,new E(0)),t},t.prototype.createCmap=function(){this.cmap.cmapBeginSave=new K(this)},t.prototype.createFontDictionary=function(){this.fontDictionary.isFont=!0,this.fontDictionary.fontDictionaryBeginSave=new k(this),this.fontDictionary.items.setValue(this.dictionaryProperties.type,new T(this.dictionaryProperties.font)),this.fontDictionary.items.setValue(this.dictionaryProperties.baseFont,new T(this.subsetName)),this.fontDictionary.items.setValue(this.dictionaryProperties.subtype,new T(this.dictionaryProperties.type0)),this.fontDictionary.items.setValue(this.dictionaryProperties.encoding,new T(this.dictionaryProperties.identityH));var t=new N,e=new Z(this.descendantFont);t.isFont=!0,t.add(e),this.fontDictionary.items.setValue(this.dictionaryProperties.descendantFonts,t)},t.prototype.createFontProgram=function(){this.fontProgram.fontProgramBeginSave=new X(this)},t.prototype.createSystemInfo=function(){var t=new B;return t.items.setValue(this.dictionaryProperties.registry,new Y("Adobe")),t.items.setValue(this.dictionaryProperties.ordering,new Y(this.dictionaryProperties.identity)),t.items.setValue(this.dictionaryProperties.supplement,new E(0)),t},t.prototype.descendantFontBeginSave=function(){if(null!==this.usedChars&&void 0!==this.usedChars&&this.usedChars.size()>0){var t=this.getDescendantWidth();null!==t&&this.descendantFont.items.setValue(this.dictionaryProperties.w,t)}},t.prototype.cmapBeginSave=function(){this.generateCmap()},t.prototype.fontDictionaryBeginSave=function(){null!==this.usedChars&&void 0!==this.usedChars&&this.usedChars.size()>0&&!this.fontDictionary.containsKey(this.dictionaryProperties.toUnicode)&&this.fontDictionary.items.setValue(this.dictionaryProperties.toUnicode,new Z(this.cmap))},t.prototype.fontProgramBeginSave=function(){this.isCompress=!0,this.generateFontProgram()},t.prototype.getDescendantWidth=function(){var t=new N;if(null!==this.usedChars&&void 0!==this.usedChars&&this.usedChars.size()>0){for(var e=[],i=this.usedChars.keys(),r=0;r<i.length;r++){var n=i[r],o=this.ttfReader.getGlyph(n);o.empty||e.push(o)}e.sort(function(t,e){return t.index-e.index});var s=0,a=0,h=!1,l=new N;for(r=0;r<e.length;r++){o=e[r];h||(h=!0,s=o.index,a=o.index-1),(a+1!==o.index||r+1===e.length)&&e.length>1&&(t.add(new E(s)),0!==r&&t.add(l),s=o.index,l=new N),l.add(new E(o.width)),r+1===e.length&&(t.add(new E(s)),t.add(l)),a=o.index}}return t},t.prototype.generateCmap=function(){if(null!==this.usedChars&&void 0!==this.usedChars&&this.usedChars.size()>0){var t=this.ttfReader.getGlyphChars(this.usedChars);if(t.size()>0){var e=t.keys().sort(),i=e[0],r=e[e.length-1],n=this.toHexString(i,!1)+this.toHexString(r,!1)+L.newLine,o="";o+=this.cmapPrefix,o+=n,o+=this.cmapEndCodespaceRange;for(var s=0,a=0;a<e.length;a++){0===s&&(0!==a&&(o+=this.cmapEndRange),s=Math.min(100,e.length-a),o+=s,o+=L.whiteSpace,o+=this.cmapBeginRange),s-=1;var h=e[a];o+=this.toHexString(h,!0)+this.toHexString(h,!0)+this.toHexString(t.getValue(h),!0)+"\n"}o+=this.cmapSuffix,this.cmap.clearStream(),this.cmap.isFont=!0,this.cmap.write(o)}}},t.prototype.generateFontProgram=function(){var t=null;this.usedChars=null===this.usedChars||void 0===this.usedChars?new y:this.usedChars,this.ttfReader.setOffset(0),t=this.ttfReader.readFontProgram(this.usedChars),this.fontProgram.clearStream(),this.fontProgram.isFont=!0,this.fontProgram.writeBytes(t)},t.prototype.getDescriptorFlags=function(){var t=0,e=this.ttfReader.metrics;return e.isFixedPitch&&(t|=Dt.FixedPitch),e.isSymbol?t|=Dt.Symbolic:t|=Dt.Nonsymbolic,e.isItalic&&(t|=Dt.Italic),e.isBold&&(t|=Dt.ForceBold),t},t.prototype.getBoundBox=function(){var t=this.ttfReader.metrics.fontBox,e=Math.abs(t.right-t.left),i=Math.abs(t.top-t.bottom),r=new ct(t.left,t.bottom,e,i);return r},t.prototype.toHexString=function(t,e){var i=t.toString(16);return e&&(i=i.toUpperCase()),"<0000".substring(0,5-i.length)+i+">"},t.prototype.setSymbols=function(t){if(null===t)throw new Error("Argument Null Exception : text");null!==this.usedChars&&void 0!==this.usedChars||(this.usedChars=new y);for(var e=0;e<t.length;e++){var i=t[e];this.usedChars.setValue(i,String.fromCharCode(0))}!1===this.isEmbedFont&&this.getDescendantWidth()},t}(),Ve=function(){function t(){this.arabicCharTable=[["ء","ﺀ"],["آ","ﺁ","ﺂ"],["أ","ﺃ","ﺄ"],["ؤ","ﺅ","ﺆ"],["إ","ﺇ","ﺈ"],["ئ","ﺉ","ﺊ","ﺋ","ﺌ"],["ا","ﺍ","ﺎ"],["ب","ﺏ","ﺐ","ﺑ","ﺒ"],["ة","ﺓ","ﺔ"],["ت","ﺕ","ﺖ","ﺗ","ﺘ"],["ث","ﺙ","ﺚ","ﺛ","ﺜ"],["ج","ﺝ","ﺞ","ﺟ","ﺠ"],["ح","ﺡ","ﺢ","ﺣ","ﺤ"],["خ","ﺥ","ﺦ","ﺧ","ﺨ"],["د","ﺩ","ﺪ"],["ذ","ﺫ","ﺬ"],["ر","ﺭ","ﺮ"],["ز","ﺯ","ﺰ"],["س","ﺱ","ﺲ","ﺳ","ﺴ"],["ش","ﺵ","ﺶ","ﺷ","ﺸ"],["ص","ﺹ","ﺺ","ﺻ","ﺼ"],["ض","ﺽ","ﺾ","ﺿ","ﻀ"],["ط","ﻁ","ﻂ","ﻃ","ﻄ"],["ظ","ﻅ","ﻆ","ﻇ","ﻈ"],["ع","ﻉ","ﻊ","ﻋ","ﻌ"],["غ","ﻍ","ﻎ","ﻏ","ﻐ"],["ـ","ـ","ـ","ـ","ـ"],["ف","ﻑ","ﻒ","ﻓ","ﻔ"],["ق","ﻕ","ﻖ","ﻗ","ﻘ"],["ك","ﻙ","ﻚ","ﻛ","ﻜ"],["ل","ﻝ","ﻞ","ﻟ","ﻠ"],["م","ﻡ","ﻢ","ﻣ","ﻤ"],["ن","ﻥ","ﻦ","ﻧ","ﻨ"],["ه","ﻩ","ﻪ","ﻫ","ﻬ"],["و","ﻭ","ﻮ"],["ى","ﻯ","ﻰ","ﯨ","ﯩ"],["ي","ﻱ","ﻲ","ﻳ","ﻴ"],["ٱ","ﭐ","ﭑ"],["ٹ","ﭦ","ﭧ","ﭨ","ﭩ"],["ٺ","ﭞ","ﭟ","ﭠ","ﭡ"],["ٻ","ﭒ","ﭓ","ﭔ","ﭕ"],["پ","ﭖ","ﭗ","ﭘ","ﭙ"],["ٿ","ﭢ","ﭣ","ﭤ","ﭥ"],["ڀ","ﭚ","ﭛ","ﭜ","ﭝ"],["ڃ","ﭶ","ﭷ","ﭸ","ﭹ"],["ڄ","ﭲ","ﭳ","ﭴ","ﭵ"],["چ","ﭺ","ﭻ","ﭼ","ﭽ"],["ڇ","ﭾ","ﭿ","ﮀ","ﮁ"],["ڈ","ﮈ","ﮉ"],["ڌ","ﮄ","ﮅ"],["ڍ","ﮂ","ﮃ"],["ڎ","ﮆ","ﮇ"],["ڑ","ﮌ","ﮍ"],["ژ","ﮊ","ﮋ"],["ڤ","ﭪ","ﭫ","ﭬ","ﭭ"],["ڦ","ﭮ","ﭯ","ﭰ","ﭱ"],["ک","ﮎ","ﮏ","ﮐ","ﮑ"],["ڭ","ﯓ","ﯔ","ﯕ","ﯖ"],["گ","ﮒ","ﮓ","ﮔ","ﮕ"],["ڱ","ﮚ","ﮛ","ﮜ","ﮝ"],["ڳ","ﮖ","ﮗ","ﮘ","ﮙ"],["ں","ﮞ","ﮟ"],["ڻ","ﮠ","ﮡ","ﮢ","ﮣ"],["ھ","ﮪ","ﮫ","ﮬ","ﮭ"],["ۀ","ﮤ","ﮥ"],["ہ","ﮦ","ﮧ","ﮨ","ﮩ"],["ۅ","ﯠ","ﯡ"],["ۆ","ﯙ","ﯚ"],["ۇ","ﯗ","ﯘ"],["ۈ","ﯛ","ﯜ"],["ۉ","ﯢ","ﯣ"],["ۋ","ﯞ","ﯟ"],["ی","ﯼ","ﯽ","ﯾ","ﯿ"],["ې","ﯤ","ﯥ","ﯦ","ﯧ"],["ے","ﮮ","ﮯ"],["ۓ","ﮰ","ﮱ"]],this.alef="ا",this.alefHamza="أ",this.alefHamzaBelow="إ",this.alefMadda="آ",this.lam="ل",this.hamza="ء",this.zeroWidthJoiner="‍",this.hamzaAbove="ٔ",this.hamzaBelow="ٕ",this.wawHamza="ؤ",this.yehHamza="ئ",this.waw="و",this.alefMaksura="ى",this.yeh="ي",this.farsiYeh="ی",this.shadda="ّ",this.madda="ٓ",this.lwa="ﻻ",this.lwawh="ﻷ",this.lwawhb="ﻹ",this.lwawm="ﻵ",this.bwhb="ۓ",this.fathatan="ً",this.superScriptalef="ٰ",this.vowel=1,this.arabicMapTable=new y;for(var t=0;t<this.arabicCharTable.length;t++)this.arabicMapTable.setValue(this.arabicCharTable[t][0],this.arabicCharTable[t])}return t.prototype.getCharacterShape=function(t,e){if(t>=this.hamza&&t<=this.bwhb){var i=[];if(this.arabicMapTable.getValue(t))return i=this.arabicMapTable.getValue(t),i[e+1]}else if(t>=this.lwawm&&t<=this.lwa)return t;return t},t.prototype.shape=function(t,e){for(var i="",r="",n=0;n<t.length;n++){var o=t[n];if(o>="؀"&&o<="ۿ")r+=o;else{if(r.length>0){var s=this.doShape(r.toString(),0);i+=s,r=""}i+=o}}if(r.length>0){s=this.doShape(r.toString(),0);i+=s}return i.toString()},t.prototype.doShape=function(t,e){var i="",r=0,n=0,o=0,s="",a=new ze,h=new ze;while(o<t.length)if(s=t[o++],r=this.ligature(s,h),0===r){var l=this.getShapeCount(s);n=1===l?0:2,a.Shapes>2&&(n+=1),n%=h.Shapes,h.Value=this.getCharacterShape(h.Value,n),i=this.append(i,a,e),a=h,h=new ze,h.Value=s,h.Shapes=l,h.Ligature++}return n=a.Shapes>2?1:0,n%=h.Shapes,h.Value=this.getCharacterShape(h.Value,n),i=this.append(i,a,e),i=this.append(i,h,e),i.toString()},t.prototype.append=function(t,e,i){return""!==e.Value&&(t+=e.Value,e.Ligature-=1,""!==e.Type&&(0===(i&this.vowel)?(t+=e.Type,e.Ligature-=1):e.Ligature-=1),""!==e.vowel&&(0===(i&this.vowel)?(t+=e.vowel,e.Ligature-=1):e.Ligature-=1)),t},t.prototype.ligature=function(t,e){if(""!==e.Value){var i=0;if(t>=this.fathatan&&t<=this.hamzaBelow||t===this.superScriptalef){if(i=1,""!==e.vowel&&t!==this.shadda&&(i=2),t===this.shadda){if(null!=e.Type)return 0;e.Type=this.shadda}else t===this.hamzaBelow?e.Value===this.alef?(e.Value=this.alefHamzaBelow,i=2):t===this.lwa?(e.Value=this.lwawhb,i=2):e.Type=this.hamzaBelow:t===this.hamzaAbove?e.Value===this.alef?(e.Value=this.alefHamza,i=2):e.Value===this.lwa?(e.Value=this.lwawh,i=2):e.Value===this.waw?(e.Value=this.wawHamza,i=2):e.Value===this.yeh||e.Value===this.alefMaksura||e.Value===this.farsiYeh?(e.Value=this.yehHamza,i=2):e.Type=this.hamzaAbove:t===this.madda?e.Value===this.alef&&(e.Value=this.alefMadda,i=2):e.vowel=t;return 1===i&&e.Ligature++,i}return""!==e.vowel?0:(e.Value===this.lam&&(t===this.alef?(e.Value=this.lwa,e.Shapes=2,i=3):t===this.alefHamza?(e.Value=this.lwawh,e.Shapes=2,i=3):t===this.alefHamzaBelow?(e.Value=this.lwawhb,e.Shapes=2,i=3):t===this.alefMadda&&(e.Value=this.lwawm,e.Shapes=2,i=3)),i)}return 0},t.prototype.getShapeCount=function(t){if(t>=this.hamza&&t<=this.bwhb&&!(t>=this.fathatan&&t<=this.hamzaBelow||t===this.superScriptalef)){var e=[];if(this.arabicMapTable.getValue(t))return e=this.arabicMapTable.getValue(t),e.length-1}else if(t===this.zeroWidthJoiner)return 4;return 1},t}(),ze=function(){function t(){this.shapeValue="",this.shapeType="",this.shapeVowel="",this.shapeLigature=0,this.shapeShapes=1}return Object.defineProperty(t.prototype,"Value",{get:function(){return this.shapeValue},set:function(t){this.shapeValue=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Type",{get:function(){return this.shapeType},set:function(t){this.shapeType=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"vowel",{get:function(){return this.shapeVowel},set:function(t){this.shapeVowel=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Ligature",{get:function(){return this.shapeLigature},set:function(t){this.shapeLigature=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Shapes",{get:function(){return this.shapeShapes},set:function(t){this.shapeShapes=t},enumerable:!0,configurable:!0}),t}(),Ge=function(){function t(){this.indexes=[],this.indexLevels=[],this.mirroringShapeCharacters=new y,this.update()}return t.prototype.doMirrorShaping=function(t){for(var e=[],i=0;i<t.length;i++)1===(1&this.indexLevels[i])&&this.mirroringShapeCharacters.containsKey(t[i].charCodeAt(0))?e[i]=String.fromCharCode(this.mirroringShapeCharacters.getValue(t[i].charCodeAt(0))):e[i]=t[i].toString();for(var r="",n=0;n<e.length;n++)r+=e[n];return r},t.prototype.getLogicalToVisualString=function(t,e){var i=new We;this.indexLevels=i.getVisualOrder(t,e),this.setDefaultIndexLevel(),this.doOrder(0,this.indexLevels.length-1);for(var r=this.doMirrorShaping(t),n="",o=0;o<this.indexes.length;o++){var s=this.indexes[o];n+=r[s]}return n.toString()},t.prototype.setDefaultIndexLevel=function(){for(var t=0;t<this.indexLevels.length;t++)this.indexes[t]=t},t.prototype.doOrder=function(t,e){for(var i=this.indexLevels[t],r=i,n=i,o=i,s=t+1;s<=e;++s){var a=this.indexLevels[s];a>i?i=a:a<r&&(r=a),n&=a,o|=a}if(0!==(1&o))if(1!==(1&n)){r|=1;while(i>=r){var h=t;while(1){while(h<=e){if(this.indexLevels[h]>=i)break;h+=1}if(h>e)break;var l=h+1;while(l<=e){if(this.indexLevels[l]<i)break;l+=1}this.reArrange(h,l),h=l+1}i-=1}}else this.reArrange(t,e+1)},t.prototype.reArrange=function(t,e){var i=(t+e)/2;for(--e;t<i;++t,--e){var r=this.indexes[t];this.indexes[t]=this.indexes[e],this.indexes[e]=r}},t.prototype.update=function(){this.mirroringShapeCharacters.setValue(40,41),this.mirroringShapeCharacters.setValue(41,40),this.mirroringShapeCharacters.setValue(60,62),this.mirroringShapeCharacters.setValue(62,60),this.mirroringShapeCharacters.setValue(91,93),this.mirroringShapeCharacters.setValue(93,91),this.mirroringShapeCharacters.setValue(123,125),this.mirroringShapeCharacters.setValue(125,123),this.mirroringShapeCharacters.setValue(171,187),this.mirroringShapeCharacters.setValue(187,171),this.mirroringShapeCharacters.setValue(8249,8250),this.mirroringShapeCharacters.setValue(8250,8249),this.mirroringShapeCharacters.setValue(8261,8262),this.mirroringShapeCharacters.setValue(8262,8261),this.mirroringShapeCharacters.setValue(8317,8318),this.mirroringShapeCharacters.setValue(8318,8317),this.mirroringShapeCharacters.setValue(8333,8334),this.mirroringShapeCharacters.setValue(8334,8333),this.mirroringShapeCharacters.setValue(8712,8715),this.mirroringShapeCharacters.setValue(8713,8716),this.mirroringShapeCharacters.setValue(8714,8717),this.mirroringShapeCharacters.setValue(8715,8712),this.mirroringShapeCharacters.setValue(8716,8713),this.mirroringShapeCharacters.setValue(8717,8714),this.mirroringShapeCharacters.setValue(8725,10741),this.mirroringShapeCharacters.setValue(8764,8765),this.mirroringShapeCharacters.setValue(8765,8764),this.mirroringShapeCharacters.setValue(8771,8909),this.mirroringShapeCharacters.setValue(8786,8787),this.mirroringShapeCharacters.setValue(8787,8786),this.mirroringShapeCharacters.setValue(8788,8789),this.mirroringShapeCharacters.setValue(8789,8788),this.mirroringShapeCharacters.setValue(8804,8805),this.mirroringShapeCharacters.setValue(8805,8804),this.mirroringShapeCharacters.setValue(8806,8807),this.mirroringShapeCharacters.setValue(8807,8806),this.mirroringShapeCharacters.setValue(8808,8809),this.mirroringShapeCharacters.setValue(8809,8808),this.mirroringShapeCharacters.setValue(8810,8811),this.mirroringShapeCharacters.setValue(8811,8810),this.mirroringShapeCharacters.setValue(8814,8815),this.mirroringShapeCharacters.setValue(8815,8814),this.mirroringShapeCharacters.setValue(8816,8817),this.mirroringShapeCharacters.setValue(8817,8816),this.mirroringShapeCharacters.setValue(8818,8819),this.mirroringShapeCharacters.setValue(8819,8818),this.mirroringShapeCharacters.setValue(8820,8821),this.mirroringShapeCharacters.setValue(8821,8820),this.mirroringShapeCharacters.setValue(8822,8823),this.mirroringShapeCharacters.setValue(8823,8822),this.mirroringShapeCharacters.setValue(8824,8825),this.mirroringShapeCharacters.setValue(8825,8824),this.mirroringShapeCharacters.setValue(8826,8827),this.mirroringShapeCharacters.setValue(8827,8826),this.mirroringShapeCharacters.setValue(8828,8829),this.mirroringShapeCharacters.setValue(8829,8828),this.mirroringShapeCharacters.setValue(8830,8831),this.mirroringShapeCharacters.setValue(8831,8830),this.mirroringShapeCharacters.setValue(8832,8833),this.mirroringShapeCharacters.setValue(8833,8832),this.mirroringShapeCharacters.setValue(8834,8835),this.mirroringShapeCharacters.setValue(8835,8834),this.mirroringShapeCharacters.setValue(8836,8837),this.mirroringShapeCharacters.setValue(8837,8836),this.mirroringShapeCharacters.setValue(8838,8839),this.mirroringShapeCharacters.setValue(8839,8838),this.mirroringShapeCharacters.setValue(8840,8841),this.mirroringShapeCharacters.setValue(8841,8840),this.mirroringShapeCharacters.setValue(8842,8843),this.mirroringShapeCharacters.setValue(8843,8842),this.mirroringShapeCharacters.setValue(8847,8848),this.mirroringShapeCharacters.setValue(8848,8847),this.mirroringShapeCharacters.setValue(8849,8850),this.mirroringShapeCharacters.setValue(8850,8849),this.mirroringShapeCharacters.setValue(8856,10680),this.mirroringShapeCharacters.setValue(8866,8867),this.mirroringShapeCharacters.setValue(8867,8866),this.mirroringShapeCharacters.setValue(8870,10974),this.mirroringShapeCharacters.setValue(8872,10980),this.mirroringShapeCharacters.setValue(8873,10979),this.mirroringShapeCharacters.setValue(8875,10981),this.mirroringShapeCharacters.setValue(8880,8881),this.mirroringShapeCharacters.setValue(8881,8880),this.mirroringShapeCharacters.setValue(8882,8883),this.mirroringShapeCharacters.setValue(8883,8882),this.mirroringShapeCharacters.setValue(8884,8885),this.mirroringShapeCharacters.setValue(8885,8884),this.mirroringShapeCharacters.setValue(8886,8887),this.mirroringShapeCharacters.setValue(8887,8886),this.mirroringShapeCharacters.setValue(8905,8906),this.mirroringShapeCharacters.setValue(8906,8905),this.mirroringShapeCharacters.setValue(8907,8908),this.mirroringShapeCharacters.setValue(8908,8907),this.mirroringShapeCharacters.setValue(8909,8771),this.mirroringShapeCharacters.setValue(8912,8913),this.mirroringShapeCharacters.setValue(8913,8912),this.mirroringShapeCharacters.setValue(8918,8919),this.mirroringShapeCharacters.setValue(8919,8918),this.mirroringShapeCharacters.setValue(8920,8921),this.mirroringShapeCharacters.setValue(8921,8920),this.mirroringShapeCharacters.setValue(8922,8923),this.mirroringShapeCharacters.setValue(8923,8922),this.mirroringShapeCharacters.setValue(8924,8925),this.mirroringShapeCharacters.setValue(8925,8924),this.mirroringShapeCharacters.setValue(8926,8927),this.mirroringShapeCharacters.setValue(8927,8926),this.mirroringShapeCharacters.setValue(8928,8929),this.mirroringShapeCharacters.setValue(8929,8928),this.mirroringShapeCharacters.setValue(8930,8931),this.mirroringShapeCharacters.setValue(8931,8930),this.mirroringShapeCharacters.setValue(8932,8933),this.mirroringShapeCharacters.setValue(8933,8932),this.mirroringShapeCharacters.setValue(8934,8935),this.mirroringShapeCharacters.setValue(8935,8934),this.mirroringShapeCharacters.setValue(8936,8937),this.mirroringShapeCharacters.setValue(8937,8936),this.mirroringShapeCharacters.setValue(8938,8939),this.mirroringShapeCharacters.setValue(8939,8938),this.mirroringShapeCharacters.setValue(8940,8941),this.mirroringShapeCharacters.setValue(8941,8940),this.mirroringShapeCharacters.setValue(8944,8945),this.mirroringShapeCharacters.setValue(8945,8944),this.mirroringShapeCharacters.setValue(8946,8954),this.mirroringShapeCharacters.setValue(8947,8955),this.mirroringShapeCharacters.setValue(8948,8956),this.mirroringShapeCharacters.setValue(8950,8957),this.mirroringShapeCharacters.setValue(8951,8958),this.mirroringShapeCharacters.setValue(8954,8946),this.mirroringShapeCharacters.setValue(8955,8947),this.mirroringShapeCharacters.setValue(8956,8948),this.mirroringShapeCharacters.setValue(8957,8950),this.mirroringShapeCharacters.setValue(8958,8951),this.mirroringShapeCharacters.setValue(8968,8969),this.mirroringShapeCharacters.setValue(8969,8968),this.mirroringShapeCharacters.setValue(8970,8971),this.mirroringShapeCharacters.setValue(8971,8970),this.mirroringShapeCharacters.setValue(9001,9002),this.mirroringShapeCharacters.setValue(9002,9001),this.mirroringShapeCharacters.setValue(10088,10089),this.mirroringShapeCharacters.setValue(10089,10088),this.mirroringShapeCharacters.setValue(10090,10091),this.mirroringShapeCharacters.setValue(10091,10090),this.mirroringShapeCharacters.setValue(10092,10093),this.mirroringShapeCharacters.setValue(10093,10092),this.mirroringShapeCharacters.setValue(10094,10095),this.mirroringShapeCharacters.setValue(10095,10094),this.mirroringShapeCharacters.setValue(10096,10097),this.mirroringShapeCharacters.setValue(10097,10096),this.mirroringShapeCharacters.setValue(10098,10099),this.mirroringShapeCharacters.setValue(10099,10098),this.mirroringShapeCharacters.setValue(10100,10101),this.mirroringShapeCharacters.setValue(10101,10100),this.mirroringShapeCharacters.setValue(10197,10198),this.mirroringShapeCharacters.setValue(10198,10197),this.mirroringShapeCharacters.setValue(10205,10206),this.mirroringShapeCharacters.setValue(10206,10205),this.mirroringShapeCharacters.setValue(10210,10211),this.mirroringShapeCharacters.setValue(10211,10210),this.mirroringShapeCharacters.setValue(10212,10213),this.mirroringShapeCharacters.setValue(10213,10212),this.mirroringShapeCharacters.setValue(10214,10215),this.mirroringShapeCharacters.setValue(10215,10214),this.mirroringShapeCharacters.setValue(10216,10217),this.mirroringShapeCharacters.setValue(10217,10216),this.mirroringShapeCharacters.setValue(10218,10219),this.mirroringShapeCharacters.setValue(10219,10218),this.mirroringShapeCharacters.setValue(10627,10628),this.mirroringShapeCharacters.setValue(10628,10627),this.mirroringShapeCharacters.setValue(10629,10630),this.mirroringShapeCharacters.setValue(10630,10629),this.mirroringShapeCharacters.setValue(10631,10632),this.mirroringShapeCharacters.setValue(10632,10631),this.mirroringShapeCharacters.setValue(10633,10634),this.mirroringShapeCharacters.setValue(10634,10633),this.mirroringShapeCharacters.setValue(10635,10636),this.mirroringShapeCharacters.setValue(10636,10635),this.mirroringShapeCharacters.setValue(10637,10640),this.mirroringShapeCharacters.setValue(10638,10639),this.mirroringShapeCharacters.setValue(10639,10638),this.mirroringShapeCharacters.setValue(10640,10637),this.mirroringShapeCharacters.setValue(10641,10642),this.mirroringShapeCharacters.setValue(10642,10641),this.mirroringShapeCharacters.setValue(10643,10644),this.mirroringShapeCharacters.setValue(10644,10643),this.mirroringShapeCharacters.setValue(10645,10646),this.mirroringShapeCharacters.setValue(10646,10645),this.mirroringShapeCharacters.setValue(10647,10648),this.mirroringShapeCharacters.setValue(10648,10647),this.mirroringShapeCharacters.setValue(10680,8856),this.mirroringShapeCharacters.setValue(10688,10689),this.mirroringShapeCharacters.setValue(10689,10688),this.mirroringShapeCharacters.setValue(10692,10693),this.mirroringShapeCharacters.setValue(10693,10692),this.mirroringShapeCharacters.setValue(10703,10704),this.mirroringShapeCharacters.setValue(10704,10703),this.mirroringShapeCharacters.setValue(10705,10706),this.mirroringShapeCharacters.setValue(10706,10705),this.mirroringShapeCharacters.setValue(10708,10709),this.mirroringShapeCharacters.setValue(10709,10708),this.mirroringShapeCharacters.setValue(10712,10713),this.mirroringShapeCharacters.setValue(10713,10712),this.mirroringShapeCharacters.setValue(10714,10715),this.mirroringShapeCharacters.setValue(10715,10714),this.mirroringShapeCharacters.setValue(10741,8725),this.mirroringShapeCharacters.setValue(10744,10745),this.mirroringShapeCharacters.setValue(10745,10744),this.mirroringShapeCharacters.setValue(10748,10749),this.mirroringShapeCharacters.setValue(10749,10748),this.mirroringShapeCharacters.setValue(10795,10796),this.mirroringShapeCharacters.setValue(10796,10795),this.mirroringShapeCharacters.setValue(10797,10796),this.mirroringShapeCharacters.setValue(10798,10797),this.mirroringShapeCharacters.setValue(10804,10805),this.mirroringShapeCharacters.setValue(10805,10804),this.mirroringShapeCharacters.setValue(10812,10813),this.mirroringShapeCharacters.setValue(10813,10812),this.mirroringShapeCharacters.setValue(10852,10853),this.mirroringShapeCharacters.setValue(10853,10852),this.mirroringShapeCharacters.setValue(10873,10874),this.mirroringShapeCharacters.setValue(10874,10873),this.mirroringShapeCharacters.setValue(10877,10878),this.mirroringShapeCharacters.setValue(10878,10877),this.mirroringShapeCharacters.setValue(10879,10880),this.mirroringShapeCharacters.setValue(10880,10879),this.mirroringShapeCharacters.setValue(10881,10882),this.mirroringShapeCharacters.setValue(10882,10881),this.mirroringShapeCharacters.setValue(10883,10884),this.mirroringShapeCharacters.setValue(10884,10883),this.mirroringShapeCharacters.setValue(10891,10892),this.mirroringShapeCharacters.setValue(10892,10891),this.mirroringShapeCharacters.setValue(10897,10898),this.mirroringShapeCharacters.setValue(10898,10897),this.mirroringShapeCharacters.setValue(10899,10900),this.mirroringShapeCharacters.setValue(10900,10899),this.mirroringShapeCharacters.setValue(10901,10902),this.mirroringShapeCharacters.setValue(10902,10901),this.mirroringShapeCharacters.setValue(10903,10904),this.mirroringShapeCharacters.setValue(10904,10903),this.mirroringShapeCharacters.setValue(10905,10906),this.mirroringShapeCharacters.setValue(10906,10905),this.mirroringShapeCharacters.setValue(10907,10908),this.mirroringShapeCharacters.setValue(10908,10907),this.mirroringShapeCharacters.setValue(10913,10914),this.mirroringShapeCharacters.setValue(10914,10913),this.mirroringShapeCharacters.setValue(10918,10919),this.mirroringShapeCharacters.setValue(10919,10918),this.mirroringShapeCharacters.setValue(10920,10921),this.mirroringShapeCharacters.setValue(10921,10920),this.mirroringShapeCharacters.setValue(10922,10923),this.mirroringShapeCharacters.setValue(10923,10922),this.mirroringShapeCharacters.setValue(10924,10925),this.mirroringShapeCharacters.setValue(10925,10924),this.mirroringShapeCharacters.setValue(10927,10928),this.mirroringShapeCharacters.setValue(10928,10927),this.mirroringShapeCharacters.setValue(10931,10932),this.mirroringShapeCharacters.setValue(10932,10931),this.mirroringShapeCharacters.setValue(10939,10940),this.mirroringShapeCharacters.setValue(10940,10939),this.mirroringShapeCharacters.setValue(10941,10942),this.mirroringShapeCharacters.setValue(10942,10941),this.mirroringShapeCharacters.setValue(10943,10944),this.mirroringShapeCharacters.setValue(10944,10943),this.mirroringShapeCharacters.setValue(10945,10946),this.mirroringShapeCharacters.setValue(10946,10945),this.mirroringShapeCharacters.setValue(10947,10948),this.mirroringShapeCharacters.setValue(10948,10947),this.mirroringShapeCharacters.setValue(10949,10950),this.mirroringShapeCharacters.setValue(10950,10949),this.mirroringShapeCharacters.setValue(10957,10958),this.mirroringShapeCharacters.setValue(10958,10957),this.mirroringShapeCharacters.setValue(10959,10960),this.mirroringShapeCharacters.setValue(10960,10959),this.mirroringShapeCharacters.setValue(10961,10962),this.mirroringShapeCharacters.setValue(10962,10961),this.mirroringShapeCharacters.setValue(10963,10964),this.mirroringShapeCharacters.setValue(10964,10963),this.mirroringShapeCharacters.setValue(10965,10966),this.mirroringShapeCharacters.setValue(10966,10965),this.mirroringShapeCharacters.setValue(10974,8870),this.mirroringShapeCharacters.setValue(10979,8873),this.mirroringShapeCharacters.setValue(10980,8872),this.mirroringShapeCharacters.setValue(10981,8875),this.mirroringShapeCharacters.setValue(10988,10989),this.mirroringShapeCharacters.setValue(10989,10988),this.mirroringShapeCharacters.setValue(10999,11e3),this.mirroringShapeCharacters.setValue(11e3,10999),this.mirroringShapeCharacters.setValue(11001,11002),this.mirroringShapeCharacters.setValue(11002,11001),this.mirroringShapeCharacters.setValue(12296,12297),this.mirroringShapeCharacters.setValue(12297,12296),this.mirroringShapeCharacters.setValue(12298,12299),this.mirroringShapeCharacters.setValue(12299,12298),this.mirroringShapeCharacters.setValue(12300,12301),this.mirroringShapeCharacters.setValue(12301,12300),this.mirroringShapeCharacters.setValue(12302,12303),this.mirroringShapeCharacters.setValue(12303,12302),this.mirroringShapeCharacters.setValue(12304,12305),this.mirroringShapeCharacters.setValue(12305,12304),this.mirroringShapeCharacters.setValue(12308,12309),this.mirroringShapeCharacters.setValue(12309,12308),this.mirroringShapeCharacters.setValue(12310,12311),this.mirroringShapeCharacters.setValue(12311,12310),this.mirroringShapeCharacters.setValue(12312,12313),this.mirroringShapeCharacters.setValue(12313,12312),this.mirroringShapeCharacters.setValue(12314,12315),this.mirroringShapeCharacters.setValue(12315,12314),this.mirroringShapeCharacters.setValue(65288,65289),this.mirroringShapeCharacters.setValue(65289,65288),this.mirroringShapeCharacters.setValue(65308,65310),this.mirroringShapeCharacters.setValue(65310,65308),this.mirroringShapeCharacters.setValue(65339,65341),this.mirroringShapeCharacters.setValue(65341,65339),this.mirroringShapeCharacters.setValue(65371,65373),this.mirroringShapeCharacters.setValue(65373,65371),this.mirroringShapeCharacters.setValue(65375,65376),this.mirroringShapeCharacters.setValue(65376,65375),this.mirroringShapeCharacters.setValue(65378,65379),this.mirroringShapeCharacters.setValue(65379,65378)},t}(),We=function(){function t(){this.types=[],this.textOrder=-1,this.rtlCharacterTypes=new Array(65536),this.L=0,this.LRE=1,this.LRO=2,this.R=3,this.AL=4,this.RLE=5,this.RLO=6,this.PDF=7,this.EN=8,this.ES=9,this.ET=10,this.AN=11,this.CS=12,this.NSM=13,this.BN=14,this.B=15,this.S=16,this.WS=17,this.ON=18,this.charTypes=[this.L,this.EN,this.BN,this.ES,this.ES,this.S,this.ET,this.ET,this.B,this.AN,this.AN,this.S,this.CS,this.CS,this.WS,this.NSM,this.NSM,this.B,this.BN,27,this.BN,28,30,this.B,31,31,this.S,32,32,this.WS,33,34,this.ON,35,37,this.ET,38,42,this.ON,43,43,this.ET,44,44,this.CS,45,45,this.ET,46,46,this.CS,47,47,this.CS,48,57,this.EN,58,58,this.CS,59,64,this.ON,65,90,this.L,91,96,this.ON,97,122,this.L,123,126,this.ON,127,132,this.BN,133,133,this.B,134,159,this.BN,160,160,this.CS,161,161,this.ON,162,165,this.ET,166,169,this.ON,170,170,this.L,171,175,this.ON,176,177,this.ET,178,179,this.EN,180,180,this.ON,181,181,this.L,182,184,this.ON,185,185,this.EN,186,186,this.L,187,191,this.ON,192,214,this.L,215,215,this.ON,216,246,this.L,247,247,this.ON,248,696,this.L,697,698,this.ON,699,705,this.L,706,719,this.ON,720,721,this.L,722,735,this.ON,736,740,this.L,741,749,this.ON,750,750,this.L,751,767,this.ON,768,855,this.NSM,856,860,this.L,861,879,this.NSM,880,883,this.L,884,885,this.ON,886,893,this.L,894,894,this.ON,895,899,this.L,900,901,this.ON,902,902,this.L,903,903,this.ON,904,1013,this.L,1014,1014,this.ON,1015,1154,this.L,1155,1158,this.NSM,1159,1159,this.L,1160,1161,this.NSM,1162,1417,this.L,1418,1418,this.ON,1419,1424,this.L,1425,1441,this.NSM,1442,1442,this.L,1443,1465,this.NSM,1466,1466,this.L,1467,1469,this.NSM,1470,1470,this.R,1471,1471,this.NSM,1472,1472,this.R,1473,1474,this.NSM,1475,1475,this.R,1476,1476,this.NSM,1477,1487,this.L,1488,1514,this.R,1515,1519,this.L,1520,1524,this.R,1525,1535,this.L,1536,1539,this.AL,1540,1547,this.L,1548,1548,this.CS,1549,1549,this.AL,1550,1551,this.ON,1552,1557,this.NSM,1558,1562,this.L,1563,1563,this.AL,1564,1566,this.L,1567,1567,this.AL,1568,1568,this.L,1569,1594,this.AL,1595,1599,this.L,1600,1610,this.AL,1611,1624,this.NSM,1625,1631,this.L,1632,1641,this.AN,1642,1642,this.ET,1643,1644,this.AN,1645,1647,this.AL,1648,1648,this.NSM,1649,1749,this.AL,1750,1756,this.NSM,1757,1757,this.AL,1758,1764,this.NSM,1765,1766,this.AL,1767,1768,this.NSM,1769,1769,this.ON,1770,1773,this.NSM,1774,1775,this.AL,1776,1785,this.EN,1786,1805,this.AL,1806,1806,this.L,1807,1807,this.BN,1808,1808,this.AL,1809,1809,this.NSM,1810,1839,this.AL,1840,1866,this.NSM,1867,1868,this.L,1869,1871,this.AL,1872,1919,this.L,1920,1957,this.AL,1958,1968,this.NSM,1969,1969,this.AL,1970,2304,this.L,2305,2306,this.NSM,2307,2363,this.L,2364,2364,this.NSM,2365,2368,this.L,2369,2376,this.NSM,2377,2380,this.L,2381,2381,this.NSM,2382,2384,this.L,2385,2388,this.NSM,2389,2401,this.L,2402,2403,this.NSM,2404,2432,this.L,2433,2433,this.NSM,2434,2491,this.L,2492,2492,this.NSM,2493,2496,this.L,2497,2500,this.NSM,2501,2508,this.L,2509,2509,this.NSM,2510,2529,this.L,2530,2531,this.NSM,2532,2545,this.L,2546,2547,this.ET,2548,2560,this.L,2561,2562,this.NSM,2563,2619,this.L,2620,2620,this.NSM,2621,2624,this.L,2625,2626,this.NSM,2627,2630,this.L,2631,2632,this.NSM,2633,2634,this.L,2635,2637,this.NSM,2638,2671,this.L,2672,2673,this.NSM,2674,2688,this.L,2689,2690,this.NSM,2691,2747,this.L,2748,2748,this.NSM,2749,2752,this.L,2753,2757,this.NSM,2758,2758,this.L,2759,2760,this.NSM,2761,2764,this.L,2765,2765,this.NSM,2766,2785,this.L,2786,2787,this.NSM,2788,2800,this.L,2801,2801,this.ET,2802,2816,this.L,2817,2817,this.NSM,2818,2875,this.L,2876,2876,this.NSM,2877,2878,this.L,2879,2879,this.NSM,2880,2880,this.L,2881,2883,this.NSM,2884,2892,this.L,2893,2893,this.NSM,2894,2901,this.L,2902,2902,this.NSM,2903,2945,this.L,2946,2946,this.NSM,2947,3007,this.L,3008,3008,this.NSM,3009,3020,this.L,3021,3021,this.NSM,3022,3058,this.L,3059,3064,this.ON,3065,3065,this.ET,3066,3066,this.ON,3067,3133,this.L,3134,3136,this.NSM,3137,3141,this.L,3142,3144,this.NSM,3145,3145,this.L,3146,3149,this.NSM,3150,3156,this.L,3157,3158,this.NSM,3159,3259,this.L,3260,3260,this.NSM,3261,3275,this.L,3276,3277,this.NSM,3278,3392,this.L,3393,3395,this.NSM,3396,3404,this.L,3405,3405,this.NSM,3406,3529,this.L,3530,3530,this.NSM,3531,3537,this.L,3538,3540,this.NSM,3541,3541,this.L,3542,3542,this.NSM,3543,3632,this.L,3633,3633,this.NSM,3634,3635,this.L,3636,3642,this.NSM,3643,3646,this.L,3647,3647,this.ET,3648,3654,this.L,3655,3662,this.NSM,3663,3760,this.L,3761,3761,this.NSM,3762,3763,this.L,3764,3769,this.NSM,3770,3770,this.L,3771,3772,this.NSM,3773,3783,this.L,3784,3789,this.NSM,3790,3863,this.L,3864,3865,this.NSM,3866,3892,this.L,3893,3893,this.NSM,3894,3894,this.L,3895,3895,this.NSM,3896,3896,this.L,3897,3897,this.NSM,3898,3901,this.ON,3902,3952,this.L,3953,3966,this.NSM,3967,3967,this.L,3968,3972,this.NSM,3973,3973,this.L,3974,3975,this.NSM,3976,3983,this.L,3984,3991,this.NSM,3992,3992,this.L,3993,4028,this.NSM,4029,4037,this.L,4038,4038,this.NSM,4039,4140,this.L,4141,4144,this.NSM,4145,4145,this.L,4146,4146,this.NSM,4147,4149,this.L,4150,4151,this.NSM,4152,4152,this.L,4153,4153,this.NSM,4154,4183,this.L,4184,4185,this.NSM,4186,5759,this.L,5760,5760,this.WS,5761,5786,this.L,5787,5788,this.ON,5789,5905,this.L,5906,5908,this.NSM,5909,5937,this.L,5938,5940,this.NSM,5941,5969,this.L,5970,5971,this.NSM,5972,6001,this.L,6002,6003,this.NSM,6004,6070,this.L,6071,6077,this.NSM,6078,6085,this.L,6086,6086,this.NSM,6087,6088,this.L,6089,6099,this.NSM,6100,6106,this.L,6107,6107,this.ET,6108,6108,this.L,6109,6109,this.NSM,6110,6127,this.L,6128,6137,this.ON,6138,6143,this.L,6144,6154,this.ON,6155,6157,this.NSM,6158,6158,this.WS,6159,6312,this.L,6313,6313,this.NSM,6314,6431,this.L,6432,6434,this.NSM,6435,6438,this.L,6439,6443,this.NSM,6444,6449,this.L,6450,6450,this.NSM,6451,6456,this.L,6457,6459,this.NSM,6460,6463,this.L,6464,6464,this.ON,6465,6467,this.L,6468,6469,this.ON,6470,6623,this.L,6624,6655,this.ON,6656,8124,this.L,8125,8125,this.ON,8126,8126,this.L,8127,8129,this.ON,8130,8140,this.L,8141,8143,this.ON,8144,8156,this.L,8157,8159,this.ON,8160,8172,this.L,8173,8175,this.ON,8176,8188,this.L,8189,8190,this.ON,8191,8191,this.L,8192,8202,this.WS,8203,8205,this.BN,8206,8206,this.L,8207,8207,this.R,8208,8231,this.ON,8232,8232,this.WS,8233,8233,this.B,8234,8234,this.LRE,8235,8235,this.RLE,8236,8236,this.PDF,8237,8237,this.LRO,8238,8238,this.RLO,8239,8239,this.WS,8240,8244,this.ET,8245,8276,this.ON,8277,8278,this.L,8279,8279,this.ON,8280,8286,this.L,8287,8287,this.WS,8288,8291,this.BN,8292,8297,this.L,8298,8303,this.BN,8304,8304,this.EN,8305,8307,this.L,8308,8313,this.EN,8314,8315,this.ET,8316,8318,this.ON,8319,8319,this.L,8320,8329,this.EN,8330,8331,this.ET,8332,8334,this.ON,8335,8351,this.L,8352,8369,this.ET,8370,8399,this.L,8400,8426,this.NSM,8427,8447,this.L,8448,8449,this.ON,8450,8450,this.L,8451,8454,this.ON,8455,8455,this.L,8456,8457,this.ON,8458,8467,this.L,8468,8468,this.ON,8469,8469,this.L,8470,8472,this.ON,8473,8477,this.L,8478,8483,this.ON,8484,8484,this.L,8485,8485,this.ON,8486,8486,this.L,8487,8487,this.ON,8488,8488,this.L,8489,8489,this.ON,8490,8493,this.L,8494,8494,this.ET,8495,8497,this.L,8498,8498,this.ON,8499,8505,this.L,8506,8507,this.ON,8508,8511,this.L,8512,8516,this.ON,8517,8521,this.L,8522,8523,this.ON,8524,8530,this.L,8531,8543,this.ON,8544,8591,this.L,8592,8721,this.ON,8722,8723,this.ET,8724,9013,this.ON,9014,9082,this.L,9083,9108,this.ON,9109,9109,this.L,9110,9168,this.ON,9169,9215,this.L,9216,9254,this.ON,9255,9279,this.L,9280,9290,this.ON,9291,9311,this.L,9312,9371,this.EN,9372,9449,this.L,9450,9450,this.EN,9451,9751,this.ON,9752,9752,this.L,9753,9853,this.ON,9854,9855,this.L,9856,9873,this.ON,9874,9887,this.L,9888,9889,this.ON,9890,9984,this.L,9985,9988,this.ON,9989,9989,this.L,9990,9993,this.ON,9994,9995,this.L,9996,10023,this.ON,10024,10024,this.L,10025,10059,this.ON,10060,10060,this.L,10061,10061,this.ON,10062,10062,this.L,10063,10066,this.ON,10067,10069,this.L,10070,10070,this.ON,10071,10071,this.L,10072,10078,this.ON,10079,10080,this.L,10081,10132,this.ON,10133,10135,this.L,10136,10159,this.ON,10160,10160,this.L,10161,10174,this.ON,10175,10191,this.L,10192,10219,this.ON,10220,10223,this.L,10224,11021,this.ON,11022,11903,this.L,11904,11929,this.ON,11930,11930,this.L,11931,12019,this.ON,12020,12031,this.L,12032,12245,this.ON,12246,12271,this.L,12272,12283,this.ON,12284,12287,this.L,12288,12288,this.WS,12289,12292,this.ON,12293,12295,this.L,12296,12320,this.ON,12321,12329,this.L,12330,12335,this.NSM,12336,12336,this.ON,12337,12341,this.L,12342,12343,this.ON,12344,12348,this.L,12349,12351,this.ON,12352,12440,this.L,12441,12442,this.NSM,12443,12444,this.ON,12445,12447,this.L,12448,12448,this.ON,12449,12538,this.L,12539,12539,this.ON,12540,12828,this.L,12829,12830,this.ON,12831,12879,this.L,12880,12895,this.ON,12896,12923,this.L,12924,12925,this.ON,12926,12976,this.L,12977,12991,this.ON,12992,13003,this.L,13004,13007,this.ON,13008,13174,this.L,13175,13178,this.ON,13179,13277,this.L,13278,13279,this.ON,13280,13310,this.L,13311,13311,this.ON,13312,19903,this.L,19904,19967,this.ON,19968,42127,this.L,42128,42182,this.ON,42183,64284,this.L,64285,64285,this.R,64286,64286,this.NSM,64287,64296,this.R,64297,64297,this.ET,64298,64310,this.R,64311,64311,this.L,64312,64316,this.R,64317,64317,this.L,64318,64318,this.R,64319,64319,this.L,64320,64321,this.R,64322,64322,this.L,64323,64324,this.R,64325,64325,this.L,64326,64335,this.R,64336,64433,this.AL,64434,64466,this.L,64467,64829,this.AL,64830,64831,this.ON,64832,64847,this.L,64848,64911,this.AL,64912,64913,this.L,64914,64967,this.AL,64968,65007,this.L,65008,65020,this.AL,65021,65021,this.ON,65022,65023,this.L,65024,65039,this.NSM,65040,65055,this.L,65056,65059,this.NSM,65060,65071,this.L,65072,65103,this.ON,65104,65104,this.CS,65105,65105,this.ON,65106,65106,this.CS,65107,65107,this.L,65108,65108,this.ON,65109,65109,this.CS,65110,65118,this.ON,65119,65119,this.ET,65120,65121,this.ON,65122,65123,this.ET,65124,65126,this.ON,65127,65127,this.L,65128,65128,this.ON,65129,65130,this.ET,65131,65131,this.ON,65132,65135,this.L,65136,65140,this.AL,65141,65141,this.L,65142,65276,this.AL,65277,65278,this.L,65279,65279,this.BN,65280,65280,this.L,65281,65282,this.ON,65283,65285,this.ET,65286,65290,this.ON,65291,65291,this.ET,65292,65292,this.CS,65293,65293,this.ET,65294,65294,this.CS,65295,65295,this.ES,65296,65305,this.EN,65306,65306,this.CS,65307,65312,this.ON,65313,65338,this.L,65339,65344,this.ON,65345,65370,this.L,65371,65381,this.ON,65382,65503,this.L,65504,65505,this.ET,65506,65508,this.ON,65509,65510,this.ET,65511,65511,this.L,65512,65518,this.ON,65519,65528,this.L,65529,65531,this.BN,65532,65533,this.ON,65534,65535,this.L];for(var t=0;t<this.charTypes.length;++t){var e=this.charTypes[t],i=this.charTypes[++t],r=this.charTypes[++t];while(e<=i)this.rtlCharacterTypes[e++]=r}}return t.prototype.getVisualOrder=function(t,e){this.types=this.getCharacterCode(t),this.textOrder=e?this.LRE:this.L,this.doVisualOrder();for(var i=[],r=0;r<this.levels.length;r++)i[r]=this.levels[r];return i},t.prototype.getCharacterCode=function(t){for(var e=[],i=0;i<t.length;i++)e[i]=this.rtlCharacterTypes[t[i].charCodeAt(0)];return e},t.prototype.setDefaultLevels=function(){for(var t=0;t<this.length;t++)this.levels[t]=this.textOrder},t.prototype.setLevels=function(){this.setDefaultLevels();for(var t=0;t<this.length;++t){var e=this.levels[t];0!==(128&e)&&(e&=127,this.result[t]=0===(1&e)?this.L:this.R),this.levels[t]=e}},t.prototype.updateLevels=function(t,e,i){if(0===(1&e))for(var r=t;r<i;++r)this.result[r]===this.R?this.levels[r]+=1:this.result[r]!==this.L&&(this.levels[r]+=2);else for(r=t;r<i;++r)this.result[r]!==this.R&&(this.levels[r]+=1)},t.prototype.doVisualOrder=function(){this.length=this.types.length,this.result=this.types,this.levels=[],this.setLevels(),this.length=this.getEmbeddedCharactersLength();var t=this.textOrder,e=0;while(e<this.length){var i=this.levels[e],r=0===(1&Math.max(t,i))?this.L:this.R,n=e+1;while(n<this.length&&this.levels[n]===i)++n;var o=n<this.length?this.levels[n]:this.textOrder,s=0===(1&Math.max(o,i))?this.L:this.R;this.checkNSM(e,n,i,r,s),this.updateLevels(e,i,n),t=i,e=n}this.checkEmbeddedCharacters(this.length)},t.prototype.getEmbeddedCharactersLength=function(){for(var t=0,e=0;e<this.length;++e)this.types[e]!==this.LRE&&this.types[e]!==this.RLE&&this.types[e]!==this.LRO&&this.types[e]!==this.RLO&&this.types[e]!==this.PDF&&this.types[e]!==this.BN&&(this.result[t]=this.result[e],this.levels[t]=this.levels[e],t++);return t},t.prototype.checkEmbeddedCharacters=function(t){for(var e=this.types.length-1;e>=0;--e)this.types[e]===this.LRE||this.types[e]===this.RLE||this.types[e]===this.LRO||this.types[e]===this.RLO||this.types[e]===this.PDF||this.types[e]===this.BN?(this.result[e]=this.types[e],this.levels[e]=-1):(t-=1,this.result[e]=this.result[t],this.levels[e]=this.levels[t]);for(e=0;e<this.types.length;e++)-1===this.levels[e]&&(this.levels[e]=0===e?this.textOrder:this.levels[e-1])},t.prototype.checkNSM=function(t,e,i,r,n){for(var o=r,s=t;s<e;++s)this.result[s]===this.NSM?this.result[s]=o:o=this.result[s];this.checkEuropeanDigits(t,e,i,r,n)},t.prototype.checkEuropeanDigits=function(t,e,i,r,n){for(var o=t;o<e;++o)if(this.result[o]===this.EN)for(var s=o-1;s>=t;--s)if(this.result[s]===this.L||this.result[s]===this.R||this.result[s]===this.AL){this.result[s]===this.AL&&(this.result[o]=this.AN);break}this.checkArabicCharacters(t,e,i,r,n)},t.prototype.checkArabicCharacters=function(t,e,i,r,n){for(var o=t;o<e;++o)this.result[o]===this.AL&&(this.result[o]=this.R);this.checkEuropeanNumberSeparator(t,e,i,r,n)},t.prototype.checkEuropeanNumberSeparator=function(t,e,i,r,n){for(var o=t+1;o<e-1;++o)if(this.result[o]===this.ES||this.result[o]===this.CS){var s=this.result[o-1],a=this.result[o+1];s===this.EN&&a===this.EN?this.result[o]=this.EN:this.result[o]===this.CS&&s===this.AN&&a===this.AN&&(this.result[o]=this.AN)}this.checkEuropeanNumberTerminator(t,e,i,r,n)},t.prototype.checkEuropeanNumberTerminator=function(t,e,i,r,n){for(var o=t;o<e;++o)if(this.result[o]===this.ET){var s=o,a=[];a.push(this.ET);var h=this.getLength(s,e,a),l=s===t?r:this.result[s-1];if(l!==this.EN&&(l=h===e?n:this.result[h]),l===this.EN)for(var u=s;u<h;++u)this.result[u]=this.EN;o=h}this.checkOtherNeutrals(t,e,i,r,n)},t.prototype.checkOtherNeutrals=function(t,e,i,r,n){for(var o=t;o<e;++o)this.result[o]!==this.ES&&this.result[o]!==this.ET&&this.result[o]!==this.CS||(this.result[o]=this.ON);this.checkOtherCharacters(t,e,i,r,n)},t.prototype.checkOtherCharacters=function(t,e,i,r,n){for(var o=t;o<e;++o)if(this.result[o]===this.EN){for(var s=r,a=o-1;a>=t;--a)if(this.result[a]===this.L||this.result[a]===this.R){s=this.result[a];break}s===this.L&&(this.result[o]=this.L)}this.checkCommanCharacters(t,e,i,r,n)},t.prototype.getLength=function(t,e,i){--t;while(++t<e){for(var r=this.result[t],n=0;n<i.length;++n)r===i[n]&&(t=this.getLength(++t,e,i));return t}return e},t.prototype.checkCommanCharacters=function(t,e,i,r,n){for(var o=t;o<e;++o)if(this.result[o]===this.WS||this.result[o]===this.ON||this.result[o]===this.B||this.result[o]===this.S){var s=o,a=[this.B,this.S,this.WS,this.ON],h=this.getLength(s,e,a),l=0,u=0,c=0;s===t?l=r:(l=this.result[s-1],l===this.AN?l=this.R:l===this.EN&&(l=this.R)),h===e?u=n:(u=this.result[h],u===this.AN?u=this.R:u===this.EN&&(u=this.R)),c=l===u?l:0===(1&i)?this.L:this.R;for(var p=s;p<h;++p)this.result[p]=c;o=h}},t}(),He=function(){function t(){this.openBracket="(",this.closeBracket=")"}return t.prototype.layout=function(t,e,i,r,n){if(null==t)throw new Error("ArgumentNullException : line");if(null==e)throw new Error("ArgumentNullException : font");var o=[];return e.Unicode?o=this.customLayout(t,i,n,e,r):(o=[],o[0]=t),o},t.prototype.splitLayout=function(t,e,i,r,n){if(null==t)throw new Error("ArgumentNullException : line");if(null==e)throw new Error("ArgumentNullException : font");var o=[],s=!1;return s&&null!=o||(o=this.customSplitLayout(t,e,i,r,n)),o},t.prototype.getGlyphIndex=function(t,e,i,r,n){var o=!0,s=!1;if(null==t)throw new Error("ArgumentNullException : line");if(null==e)throw new Error("ArgumentNullException : font");if(r=null,0===t.length)return{success:s,glyphs:r};var a=new Ve,h=a.shape(t,0),l=e.fontInternal,u=l.ttfReader;r=new Uint16Array(h.length);for(var c=0,p=0,d=h.length;p<d;p++){var f=h[p],g=u.getGlyph(f);null!==g&&"undefined"!==typeof g&&(r[c++]=g.index)}return{success:o,glyphs:r}},t.prototype.customLayout=function(t,e,i,r,n){if(null===n||"undefined"===typeof n){if(null==t)throw new Error("ArgumentNullException : line");var o=null;if(null!==i&&"undefined"!==typeof i&&i.textDirection!==Tt.None){var s=new Ge;o=s.getLogicalToVisualString(t,e)}return o}if(null==t)throw new Error("ArgumentNullException : line");if(null==r)throw new Error("ArgumentNullException : font");var a=null;if(null!==i&&"undefined"!==typeof i&&i.textDirection!==Tt.None){var h=new Ve,l=h.shape(t,0);a=this.customLayout(l,e,i)}o=[];if(n){for(var u=a.split(""),c=u.length,p=0;p<c;p++)u[p]=this.addChars(r,u[p]);o=u}else o=[],o[0]=this.addChars(r,a);return o},t.prototype.addChars=function(t,e){var i=e;if(null==t)throw new Error("ArgumentNullException : font");if(null==i)throw new Error("ArgumentNullException : line");var r=i,n=t.fontInternal,o=n.ttfReader;t.setSymbols(r),r=o.convertString(r);var s=Y.toUnicodeArray(r,!1);return r=Y.byteToString(s),r},t.prototype.customSplitLayout=function(t,e,i,r,n){if(null==t)throw new Error("ArgumentNullException : line");if(null==e)throw new Error("ArgumentNullException : font");var o=this.customLayout(t,i,n),s=o.split("");return s},t}();(function(t){t[t["Paginate"]=0]="Paginate",t[t["OnePage"]=1]="OnePage"})(te||(te={})),function(t){t[t["FitPage"]=0]="FitPage",t[t["FitElement"]=1]="FitElement",t[t["FitColumnsToPage"]=2]="FitColumnsToPage"}(ee||(ee={})),function(t){t[t["Start"]=0]="Start",t[t["Line"]=1]="Line",t[t["Bezier3"]=3]="Bezier3",t[t["Bezier"]=3]="Bezier",t[t["PathTypeMask"]=7]="PathTypeMask",t[t["DashMode"]=16]="DashMode",t[t["PathMarker"]=32]="PathMarker",t[t["CloseSubpath"]=128]="CloseSubpath"}(ie||(ie={}));var _e,Ue=function(){function t(t){this.currentPosition=-1,this.value=t}return Object.defineProperty(t.prototype,"status",{get:function(){return this.objectStatus},set:function(t){this.objectStatus=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isSaving",{get:function(){return this.saving},set:function(t){this.saving=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"objectCollectionIndex",{get:function(){return this.index},set:function(t){this.index=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"position",{get:function(){return this.currentPosition},set:function(t){this.currentPosition=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"clonedObject",{get:function(){var t=null;return t},enumerable:!0,configurable:!0}),t.prototype.save=function(t){t.write(this.boolToStr(this.value))},t.prototype.clone=function(e){var i=new t(this.value);return i},t.prototype.boolToStr=function(t){return t?"true":"false"},t}(),qe=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},t(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Ke=function(t){function e(e){var i=t.call(this)||this;return i.mbackground=new _t(255,255,255),i.mbStroking=!1,i.mfunction=null,i.dictionaryProperties=new j,i.mpatternDictionary=new B,i.mpatternDictionary.items.setValue(i.dictionaryProperties.type,new T(i.dictionaryProperties.pattern)),i.mpatternDictionary.items.setValue(i.dictionaryProperties.patternType,new E(2)),i.shading=e,i.colorSpace=Ct.Rgb,i}return qe(e,t),Object.defineProperty(e.prototype,"background",{get:function(){return this.mbackground},set:function(t){this.mbackground=t;var e=this.shading;t.isEmpty?e.remove(this.dictionaryProperties.background):e.items.setValue(this.dictionaryProperties.background,t.toArray(this.colorSpace))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"antiAlias",{get:function(){var t=this.shading,e=t.items.getValue(this.dictionaryProperties.antiAlias);return e.value},set:function(t){var e=this.shading,i=e.items.getValue(this.dictionaryProperties.antiAlias);null==i&&"undefined"===typeof i?(i=new Ue(t),e.items.setValue(this.dictionaryProperties.antiAlias,i)):i.value=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"function",{get:function(){return this.mfunction},set:function(t){this.mfunction=t,null!=t&&"undefined"!==typeof t?this.shading.items.setValue(this.dictionaryProperties.function,new Z(this.mfunction)):this.shading.remove(this.dictionaryProperties.function)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bBox",{get:function(){var t=this.shading,e=t.items.getValue(this.dictionaryProperties.bBox);return e},set:function(t){var e=this.shading;null==t&&"undefined"===typeof t?e.remove(this.dictionaryProperties.bBox):e.items.setValue(this.dictionaryProperties.bBox,t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"colorSpace",{get:function(){return this.mcolorSpace},set:function(t){var e=this.shading.items.getValue(this.dictionaryProperties.colorSpace);if(t!==this.mcolorSpace||null==e){this.mcolorSpace=t;var i=this.colorSpaceToDeviceName(t);this.shading.items.setValue(this.dictionaryProperties.colorSpace,new T(i))}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stroking",{get:function(){return this.mbStroking},set:function(t){this.mbStroking=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"patternDictionary",{get:function(){return null==this.mpatternDictionary&&(this.mpatternDictionary=new B),this.mpatternDictionary},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shading",{get:function(){return this.mshading},set:function(t){if(null==t)throw new Error("ArgumentNullException : Shading");t!==this.mshading&&(this.mshading=t,this.patternDictionary.items.setValue(this.dictionaryProperties.shading,new Z(this.mshading)))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"matrix",{get:function(){return this.mmatrix},set:function(t){if(null==t)throw new Error("ArgumentNullException : Matrix");if(t!==this.mmatrix){this.mmatrix=t.clone();var e=new N(this.mmatrix.matrix.elements);this.mpatternDictionary.items.setValue(this.dictionaryProperties.matrix,e)}},enumerable:!0,configurable:!0}),e.prototype.monitorChanges=function(t,i,r,n,o){var s=!1;if(t instanceof e){this.colorSpace!==o&&(this.colorSpace=o,this.resetFunction()),i.setColorSpace("Pattern",this.mbStroking);var a=r.getResources(),h=a.getName(this);i.setColourWithPattern(null,h,this.mbStroking),s=!0}return s},e.prototype.resetChanges=function(t){},e.prototype.colorSpaceToDeviceName=function(t){var e;switch(t){case Ct.Rgb:e="DeviceRGB";break}return e},e.prototype.resetPatternDictionary=function(t){this.mpatternDictionary=t},e.prototype.cloneAntiAliasingValue=function(t){if(null==t)throw new Error("ArgumentNullException : brush");var e=this.shading,i=e.items.getValue(this.dictionaryProperties.antiAlias);null!=i&&t.shading.items.setValue(this.dictionaryProperties.antiAlias,new Ue(i.value))},e.prototype.cloneBackgroundValue=function(t){var e=this.background;e.isEmpty||(t.background=e)},Object.defineProperty(e.prototype,"element",{get:function(){return this.patternDictionary},enumerable:!0,configurable:!0}),e}(Ut),Xe=function(){function t(t,e){if(this.dictionaryProperties=new j,this.writeTransformation=!0,"undefined"===typeof t);else if(t instanceof ut&&"undefined"===typeof e){this.content=new q;var i=new ut(t.width,t.height);this.setSize(i),this.initialize()}else this.content=new q,this.setSize(new ut(t,e)),this.initialize()}return Object.defineProperty(t.prototype,"size",{get:function(){return this.templateSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.size.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.size.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"graphics",{get:function(){if(null==this.pdfGraphics||"undefined"===typeof this.pdfGraphics){var t=new ai(this),e=new si(this.size,t,this.content);this.pdfGraphics=e,this.pdfGraphics.initializeCoordinates()}return this.pdfGraphics},enumerable:!0,configurable:!0}),t.prototype.getResources=function(){return null==this.resources&&(this.resources=new ii,this.content.items.setValue(this.dictionaryProperties.resources,this.resources)),this.resources},t.prototype.initialize=function(){this.addType(),this.addSubType()},t.prototype.addType=function(){var t=new T(this.dictionaryProperties.xObject);this.content.items.setValue(this.dictionaryProperties.type,t)},t.prototype.addSubType=function(){var t=new T(this.dictionaryProperties.form);this.content.items.setValue(this.dictionaryProperties.subtype,t)},t.prototype.reset=function(t){"undefined"===typeof t?(null!=this.resources&&(this.resources=null,this.content.remove(this.dictionaryProperties.resources)),null!=this.graphics&&this.graphics.reset(this.size)):(this.setSize(t),this.reset())},t.prototype.setSize=function(t){var e=new ct(new lt(0,0),t),i=N.fromRectangle(e);this.content.items.setValue(this.dictionaryProperties.bBox,i),this.templateSize=t},Object.defineProperty(t.prototype,"element",{get:function(){return this.content},enumerable:!0,configurable:!0}),t}();(function(t){t[t["Unknown"]=0]="Unknown",t[t["Bmp"]=1]="Bmp",t[t["Emf"]=2]="Emf",t[t["Gif"]=3]="Gif",t[t["Jpeg"]=4]="Jpeg",t[t["Png"]=5]="Png",t[t["Wmf"]=6]="Wmf",t[t["Icon"]=7]="Icon"})(_e||(_e={}));var Je,Ye=function(){function t(t){this.sof1Marker=193,this.sof2Marker=194,this.sof3Marker=195,this.sof5Marker=197,this.sof6Marker=198,this.sof7Marker=199,this.sof9Marker=201,this.sof10Marker=202,this.sof11Marker=203,this.sof13Marker=205,this.sof14Marker=206,this.sof15Marker=207,this.mFormat=_e.Unknown,this.mbitsPerComponent=8,this.dictionaryProperties=new j,this.mStream=t,this.initialize()}return Object.defineProperty(t.prototype,"height",{get:function(){return this.mHeight},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.mWidth},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bitsPerComponent",{get:function(){return this.mbitsPerComponent},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.mImageData.count},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageData",{get:function(){return this.mImageData},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageDataAsNumberArray",{get:function(){return this.mImageData.internalBuffer.buffer},enumerable:!0,configurable:!0}),t.prototype.initialize=function(){this.mFormat===_e.Unknown&&this.checkIfJpeg()&&(this.mFormat=_e.Jpeg,this.parseJpegImage()),this.reset(),this.mImageData=new fe(this.mStream.count),this.mStream.read(this.mImageData,0,this.mImageData.count)},t.prototype.reset=function(){this.mStream.position=0},t.prototype.parseJpegImage=function(){this.reset();var t=new fe(this.mStream.count);this.mStream.read(t,0,t.count);var e=4,i=!1,r=256*t.getBuffer(e)+t.getBuffer(e+1);while(e<t.count){if(e+=r,!(e<t.count)){i=!0;break}if(192===t.getBuffer(e+1))return this.mHeight=256*t.getBuffer(e+5)+t.getBuffer(e+6),void(this.mWidth=256*t.getBuffer(e+7)+t.getBuffer(e+8));e+=2,r=256*t.getBuffer(e)+t.getBuffer(e+1)}i&&(this.mStream.position=0,this.skip(this.mStream,2),this.readExceededJPGImage(this.mStream))},Object.defineProperty(t.prototype,"format",{get:function(){return this.mFormat},enumerable:!0,configurable:!0}),t.prototype.checkIfJpeg=function(){this.reset();for(var e=0;e<t.mJpegHeader.length;e++){if(t.mJpegHeader[e]!==this.mStream.readByte(e))return!1;this.mStream.position++}return!0},t.prototype.getImageDictionary=function(){if(this.mFormat===_e.Jpeg){this.imageData.internalBuffer.length;this.imageStream=new q,this.imageStream.isImage=!0;for(var t="",e="",i=0;i<this.imageDataAsNumberArray.byteLength;i++)t+=String.fromCharCode(null,this.mStream.readByte(i));for(i=0;i<t.length;i++)i%2!==0&&(e+=t[i]);return this.imageStream.data=[e],this.imageStream.compress=!1,this.imageStream.items.setValue(this.dictionaryProperties.type,new T(this.dictionaryProperties.xObject)),this.imageStream.items.setValue(this.dictionaryProperties.subtype,new T(this.dictionaryProperties.image)),this.imageStream.items.setValue(this.dictionaryProperties.width,new E(this.width)),this.imageStream.items.setValue(this.dictionaryProperties.height,new E(this.height)),this.imageStream.items.setValue(this.dictionaryProperties.bitsPerComponent,new E(this.bitsPerComponent)),this.imageStream.items.setValue(this.dictionaryProperties.filter,new T(this.dictionaryProperties.dctdecode)),this.imageStream.items.setValue(this.dictionaryProperties.colorSpace,new T(this.getColorSpace())),this.imageStream.items.setValue(this.dictionaryProperties.decodeParms,this.getDecodeParams()),this.imageStream}return this.imageStream},t.prototype.getColorSpace=function(){return this.dictionaryProperties.deviceRgb},t.prototype.getDecodeParams=function(){var t=new B;return t.items.setValue(this.dictionaryProperties.columns,new E(this.width)),t.items.setValue(this.dictionaryProperties.blackIs1,new Ue(!0)),t.items.setValue(this.dictionaryProperties.k,new E(-1)),t.items.setValue(this.dictionaryProperties.predictor,new E(15)),t.items.setValue(this.dictionaryProperties.bitsPerComponent,new E(this.bitsPerComponent)),t},t.prototype.readExceededJPGImage=function(t){this.mStream=t;var e=!0;while(e){var i=this.getMarker(t);switch(i){case this.sof1Marker:case this.sof2Marker:case this.sof3Marker:case this.sof5Marker:case this.sof6Marker:case this.sof7Marker:case this.sof9Marker:case this.sof10Marker:case this.sof11Marker:case this.sof13Marker:case this.sof14Marker:case this.sof15Marker:t.position+=3,this.mHeight=this.mStream.readNextTwoBytes(t),this.mWidth=this.mStream.readNextTwoBytes(t),e=!1;break;default:this.skipStream(t);break}}},t.prototype.skip=function(t,e){this.mStream=t;var i=new fe(e);this.mStream.read(i,0,i.count)},t.prototype.getMarker=function(t){var e=32;e=t.readByte(this.mStream.position),t.position++;while(255!==e)0,e=t.readByte(this.mStream.position),t.position++;do{e=t.readByte(this.mStream.position),t.position++}while(255===e);return e},t.prototype.skipStream=function(t){var e=this.mStream.readNextTwoBytes(t)-2;e>0&&(t.position+=e)},t.mPngHeader=[137,80,78,71,13,10,26,10],t.mJpegHeader=[255,216],t.GIF_HEADER="G,I,F,8",t.BMP_HEADER="B,M",t}(),Qe=function(){function t(t){this.updateProportionsHelper(t)}return t.prototype.convertUnits=function(t,e,i){return this.convertFromPixels(this.convertToPixels(t,e),i)},t.prototype.convertToPixels=function(t,e){var i=e,r=t*this.proportions[i];return r},t.prototype.convertFromPixels=function(t,e){var i=e,r=t/this.proportions[i];return r},t.prototype.updateProportionsHelper=function(t){this.proportions=[t/2.54,t/6,1,t/72,t,t/300,t/25.4]},t.horizontalResolution=96,t.verticalResolution=96,t}(),Ze=function(){function t(){}return Object.defineProperty(t.prototype,"width",{get:function(){return this.imageWidth},set:function(t){this.imageWidth=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.imageHeight},set:function(t){this.imageHeight=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{set:function(t){this.width=t.width,this.height=t.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"physicalDimension",{get:function(){return this.imagePhysicalDimension=this.getPointSize(this.width,this.height,this.horizontalResolution,this.verticalResolution),new ut(this.width,this.height)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"element",{get:function(){return this.imageStream},enumerable:!0,configurable:!0}),t.prototype.getPointSize=function(t,e,i,r){if("undefined"===typeof i){var n=Qe.horizontalResolution,o=Qe.verticalResolution,s=this.getPointSize(t,e,n,o);return s}var a=new Qe(i),h=new Qe(r),l=a.convertUnits(t,Pt.Pixel,Pt.Point),u=h.convertUnits(e,Pt.Pixel,Pt.Point);s=new ut(l,u);return s},t}(),$e=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},t(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ti=function(t){function e(e){var i=t.call(this)||this;return i.imageStatus=!0,i.dictionaryProperties=new j,i.loadImage(e),i}return $e(e,t),e.prototype.loadImage=function(t){this.initializeAsync(t)},e.prototype.initializeAsync=function(t){var e=new fe(t.length);e.writeFromBase64String(t),this.decoder=new Ye(e),this.height=this.decoder.height,this.width=this.decoder.width,this.bitsPerComponent=this.decoder.bitsPerComponent},e.prototype.save=function(){this.imageStatus=!0,this.imageStream=this.decoder.getImageDictionary()},e}(Ze),ei=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},t(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ii=function(t){function e(e){var i=t.call(this,e)||this;return i.properties=new B,i}return ei(e,t),Object.defineProperty(e.prototype,"names",{get:function(){return this.getNames()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"document",{get:function(){return this.pdfDocument},set:function(t){this.pdfDocument=t},enumerable:!0,configurable:!0}),e.prototype.getName=function(t){var e=t.element,i=null;if(this.names.containsKey(e)&&(i=this.names.getValue(e)),null==i){var r=this.generateName();i=new T(r),this.names.setValue(e,i),t instanceof re?this.add(t,i):t instanceof Xe?this.add(t,i):t instanceof Ke||t instanceof oi?this.add(t,i):t instanceof he?this.add(t,i):(t instanceof Ze||t instanceof ti)&&this.add(t,i)}return i},e.prototype.getNames=function(){null==this.pdfNames&&(this.pdfNames=new ae);var t=this.items.getValue(this.dictionaryProperties.font);if(null!=t){at.dereference(t)}return this.pdfNames},e.prototype.requireProcedureSet=function(t){if(null==t)throw new Error("ArgumentNullException:procedureSetName");var e=this.items.getValue(this.dictionaryProperties.procset);null==e&&(e=new N,this.items.setValue(this.dictionaryProperties.procset,e));var i=new T(t);e.contains(i)||e.add(i)},e.prototype.removeFont=function(t){for(var e=null,i=this.pdfNames.keys(),r=0;r<this.pdfNames.size();r++)if(this.pdfNames.getValue(i[r])===new T(t)){e=i[r];break}null!=e&&this.pdfNames.remove(e)},e.prototype.generateName=function(){var t=ri.getNewGuidString();return t},e.prototype.add=function(t,e){if(t instanceof re){var i=null,r=this.items.getValue(this.dictionaryProperties.font);if(null!=r){var n=r;i=r,i=r}else i=new B,this.items.setValue(this.dictionaryProperties.font,i);i.items.setValue(e.value,new Z(t.element))}else if(t instanceof Xe){var o=void 0;o=this.items.getValue(this.dictionaryProperties.xObject),null==o&&(o=new B,this.items.setValue(this.dictionaryProperties.xObject,o)),o.items.setValue(e.value,new Z(t.element))}else if(t instanceof Ut){if(t instanceof Ke||t instanceof oi){var s=t.element;if(null!=s){var a=this.items.getValue(this.dictionaryProperties.pattern);null==a&&(a=new B,this.items.setValue(this.dictionaryProperties.pattern,a)),a.items.setValue(e.value,new Z(s))}}}else if(t instanceof he){s=t.element;var h=null;h=this.items.getValue(this.dictionaryProperties.extGState),null==h&&(h=new B,this.items.setValue(this.dictionaryProperties.extGState,h)),h.items.setValue(e.value,new Z(s))}else{o=this.Dictionary.items.getValue(this.dictionaryProperties.xObject);var l=void 0;"undefined"!==typeof this.pdfDocument&&(l=this.pdfDocument.sections.element.items.getValue(this.dictionaryProperties.resources).items.getValue(this.dictionaryProperties.xObject));this.Dictionary.items.values();var u=!1,c=void 0;if("undefined"===typeof this.pdfDocument||void 0!==typeof l&&null!=l){if("undefined"!==typeof this.pdfDocument)for(var p=l.items.values(),d=0;d<p.length;d++)"undefined"!==typeof p[d]&&"undefined"!==typeof p[d].element&&p[d].element.data[0]===t.element.data[0]&&(c=p[d],u=!0)}else l=new B,this.pdfDocument.sections.element.items.getValue(this.dictionaryProperties.resources).items.setValue(this.dictionaryProperties.xObject,l);if(null==o&&(o=new B,this.Dictionary.items.setValue(this.dictionaryProperties.xObject,o)),u&&"undefined"!==typeof c)o.items.setValue(e.value,c);else{n=new Z(t.element);o.items.setValue(e.value,n),"undefined"!==typeof this.pdfDocument&&l.items.setValue(e.value,n)}}},e}(B),ri=function(){function t(){}return t.getNewGuidString=function(){return"aaaaaaaa-aaaa-4aaa-baaa-aaaaaaaaaaaa".replace(/[ab]/g,function(t){var e=16*Math.random()|0,i="a"===t?e:3&e|8;return i.toString(16)})},t}(),ni=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},t(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),oi=function(t){function e(e,i){var r=t.call(this)||this;r.mStroking=!1,r.mLocation=new lt(0,0),r.mDictionaryProperties=new j;var n=null;return e instanceof pt?n=e:e instanceof ut&&(n=new pt(0,0,e.width,e.height)),null!==i&&i instanceof yi&&(r.mPage=i),r.brushStream=new q,r.mResources=new ii,r.brushStream.items.setValue(r.mDictionaryProperties.resources,r.mResources),r.setBox(n),r.setObligatoryFields(),null!==i&&i instanceof yi&&(r.mPage=i,r.graphics.colorSpace=i.document.colorSpace),r}return ni(e,t),e.prototype.initialize=function(t,e,i,r){this.mPage=e,this.mLocation=i,this.mTransformationMatrix=r,this.tempBrushStream=this.brushStream,this.brushStream=new q;var n=new ii;return this.brushStream.items.setValue(this.mDictionaryProperties.resources,n),this.setBox(t),this.setObligatoryFields(),this},Object.defineProperty(e.prototype,"location",{get:function(){return this.mLocation},set:function(t){this.mLocation=t},enumerable:!0,configurable:!0}),e.prototype.setObligatoryFields=function(){if(this.brushStream.items.setValue(this.mDictionaryProperties.patternType,new E(1)),this.brushStream.items.setValue(this.mDictionaryProperties.paintType,new E(1)),this.brushStream.items.setValue(this.mDictionaryProperties.tilingType,new E(1)),this.brushStream.items.setValue(this.mDictionaryProperties.xStep,new E(this.mBox.right-this.mBox.left)),this.brushStream.items.setValue(this.mDictionaryProperties.yStep,new E(this.mBox.bottom-this.mBox.top)),null!=this.mPage&&null!=this.mLocation)if(null==this.mTransformationMatrix&&"undefined"===typeof this.mTransformationMatrix){var t=this.mPage.size.height%this.rectangle.size.height-this.mLocation.y;this.brushStream.items.setValue(this.mDictionaryProperties.matrix,new N([1,0,0,1,this.mLocation.x,t]))}else{t=0;var e=this.mTransformationMatrix.matrix.elements;t=this.mPage.size.height>this.rectangle.size.height?this.mTransformationMatrix.matrix.offsetY-this.mPage.size.height%this.rectangle.size.height:this.mPage.size.height%this.rectangle.size.height+this.mTransformationMatrix.matrix.offsetY,this.brushStream.items.setValue(this.mDictionaryProperties.matrix,new N([e[0],e[1],e[2],e[3],e[4],t]))}},e.prototype.setBox=function(t){this.mBox=t;var e=new ct(this.mBox.left,this.mBox.top,this.mBox.right,this.mBox.bottom);this.brushStream.items.setValue(this.mDictionaryProperties.bBox,N.fromRectangle(e))},Object.defineProperty(e.prototype,"rectangle",{get:function(){return this.mBox},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this.mBox.size},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"graphics",{get:function(){if(null==this.mGraphics&&"undefined"===typeof this.mGraphics){var t=new ai(this),e=new si(this.size,t,this.brushStream);this.mGraphics=e,this.mResources=this.getResources(),this.mGraphics.initializeCoordinates()}return this.mGraphics},enumerable:!0,configurable:!0}),e.prototype.getResources=function(){return this.mResources},Object.defineProperty(e.prototype,"stroking",{get:function(){return this.mStroking},set:function(t){this.mStroking=t},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=this.initialize(this.rectangle,this.mPage,this.location,this.mTransformationMatrix);return null!=this.mTransformationMatrix&&null!=this.mTransformationMatrix.matrix&&t.brushStream.items.setValue(this.mDictionaryProperties.matrix,new N(this.mTransformationMatrix.matrix.elements)),t.brushStream.data=this.tempBrushStream.data,t.mResources=new ii(this.mResources),t.brushStream.items.setValue(this.mDictionaryProperties.resources,t.mResources),t},e.prototype.monitorChanges=function(t,i,r,n,o){var s=!1;if(t!==this){i.setColorSpace("Pattern",this.mStroking);var a=r.getResources(),h=a.getName(this);i.setColourWithPattern(null,h,this.mStroking),s=!0}else if(t instanceof e){i.setColorSpace("Pattern",this.mStroking);var l=r.getResources(),u=l.getName(this);i.setColourWithPattern(null,u,this.mStroking),s=!0}return s},e.prototype.resetChanges=function(t){},Object.defineProperty(e.prototype,"element",{get:function(){return this.brushStream},enumerable:!0,configurable:!0}),e}(Ut),si=function(){function t(t,e,i){this.currentColorSpace=Ct.Rgb,this.previousTextRenderingMode=yt.Fill,this.previousCharacterSpacing=0,this.previousWordSpacing=0,this.previousTextScaling=100,this.procedureSets=new se,this.isNormalRender=!0,this.isUseFontSize=!1,this.isItalic=!1,this.isEmfTextScaled=!1,this.isEmf=!1,this.isEmfPlus=!1,this.isBaselineFormat=!0,this.emfScalingFactor=new ut(0,0),this.colorSpaceChanged=!1,this.dictionaryProperties=new j,this.isOverloadWithPosition=!1,this.isPointOverload=!1,this.currentColorSpaces=["RGB","CMYK","GrayScale","Indexed"],this.isImageOptimized=!1,this.graphicsState=[],this.istransparencySet=!1,this.internalAutomaticFields=null,this.startCutIndex=-1,this.getResources=e,this.canvasSize=t,this.pdfStreamWriter=i instanceof Ht?i:new Ht(i),this.initialize()}return Object.defineProperty(t.prototype,"stringLayoutResult",{get:function(){return this.pdfStringLayoutResult},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.canvasSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mediaBoxUpperRightBound",{get:function(){return"undefined"===typeof this.internalMediaBoxUpperRightBound&&(this.internalMediaBoxUpperRightBound=0),this.internalMediaBoxUpperRightBound},set:function(t){this.internalMediaBoxUpperRightBound=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"clientSize",{get:function(){return new ut(this.clipBounds.width,this.clipBounds.height)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"colorSpace",{get:function(){return this.currentColorSpace},set:function(t){this.currentColorSpace=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"streamWriter",{get:function(){return this.pdfStreamWriter},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"matrix",{get:function(){return null==this.transformationMatrix&&(this.transformationMatrix=new ne),this.transformationMatrix},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"layer",{get:function(){return this.pageLayer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"page",{get:function(){return this.pageLayer.page},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"automaticFields",{get:function(){return null!=this.internalAutomaticFields&&"undefined"!==typeof this.internalAutomaticFields||(this.internalAutomaticFields=new le),this.internalAutomaticFields},enumerable:!0,configurable:!0}),t.prototype.initialize=function(){this.bStateSaved=!1,this.currentPen=null,this.currentBrush=null,this.currentFont=null,this.currentColorSpace=Ct.Rgb,this.bCSInitialized=!1,this.transformationMatrix=null,this.previousTextRenderingMode=-1,this.previousCharacterSpacing=-1,this.previousWordSpacing=-1,this.previousTextScaling=-100,this.currentStringFormat=null,this.clipBounds=new ct(new lt(0,0),this.size),this.getResources.getResources().requireProcedureSet(this.procedureSets.pdf)},t.prototype.drawPdfTemplate=function(t,e,i){if("undefined"===typeof i){if(null==t)throw Error("ArgumentNullException-template");this.drawPdfTemplate(t,e,t.size)}else{if(null==t)throw Error("ArgumentNullException-template");var r=t.width>0?i.width/t.width:1,n=t.height>0?i.height/t.height:1,o=!(1===r&&1===n),s=this.save(),a=new ne;null!=this.pageLayer&&this.getTranslateTransform(e.x,e.y+i.height,a),o&&this.getScaleTransform(r,n,a),this.pdfStreamWriter.modifyCtm(a);var h=this.getResources.getResources(),l=h.getName(t);this.pdfStreamWriter.executeObject(l),this.restore(s);var u=t.graphics;if(null!=u)for(var c=0;c<u.automaticFields.automaticFields.length;c++){var p=u.automaticFields.automaticFields[c],d=new lt(p.location.x+e.x,p.location.y+e.y),f=0==t.size.width?0:i.width/t.size.width,g=0==t.size.height?0:i.height/t.size.height;this.automaticFields.add(new de(p.field,d,f,g)),this.page.dictionary.modify()}this.getResources.getResources().requireProcedureSet(this.procedureSets.imageB),this.getResources.getResources().requireProcedureSet(this.procedureSets.imageC),this.getResources.getResources().requireProcedureSet(this.procedureSets.imageI),this.getResources.getResources().requireProcedureSet(this.procedureSets.text)}},t.prototype.drawString=function(t,e,i,r,n,o,s,a,h){if("string"===typeof t&&e instanceof re&&(i instanceof Xt||null===i)&&(r instanceof Ut||null===r)&&"number"===typeof n&&"number"===typeof o&&(s instanceof Jt||null===s)&&"undefined"===typeof a)this.isOverloadWithPosition=!0,this.drawString(t,e,i,r,n,o,this.clientSize.width-n,0,s);else{var l=i,u=r,c=n,p=o,d=s,f=a,g=h,m=new Qt,y=m.layout(t,e,g,new ut(d,f),this.isOverloadWithPosition,this.clientSize);if(!y.empty){var b=this.checkCorrectLayoutRectangle(y.actualSize,c,p,g);d<=0&&(c=b.x,d=b.width),f<=0&&(p=b.y,f=b.height),this.drawStringLayoutResult(y,e,l,u,new ct(c,p,d,f),g),this.isEmfTextScaled=!1,this.emfScalingFactor=new ut(0,0)}this.getResources.getResources().requireProcedureSet(this.procedureSets.text),this.isNormalRender=!0,this.pdfStringLayoutResult=y,this.isUseFontSize=!1}},t.prototype.drawLine=function(t,e,i,r,n){if(e instanceof lt){var o=e,s=i;this.drawLine(t,o.x,o.y,s.x,s.y)}else{o=e,s=i;var a=r,h=n;this.stateControl(t,null,null);var l=this.streamWriter;l.beginPath(o,s),l.appendLineSegment(a,h),l.strokePath(),this.getResources.getResources().requireProcedureSet(this.procedureSets.pdf)}},t.prototype.drawRectangle=function(t,e,i,r,n,o){if(t instanceof Xt&&"number"===typeof e){var s=i;this.drawRectangle(t,null,e,s,r,n)}else if(t instanceof Ut&&"number"===typeof e){s=i;this.drawRectangle(null,t,e,s,r,n)}else{s=i;var a=r,h=n,l=o;if(e instanceof oi){this.bCSInitialized=!1;var u=this.matrix.matrix.offsetX+s,c=void 0;c=null!=this.layer&&null!=this.layer.page?this.layer.page.size.height-this.matrix.matrix.offsetY+a:this.clientSize.height-this.matrix.matrix.offsetY+a,e.location=new lt(u,c),e.graphics.colorSpace=this.colorSpace}else e instanceof Ke&&(e.colorSpace=this.colorSpace);e instanceof Kt&&e.color.isEmpty&&(e=null);var p=t,d=e;this.stateControl(p,d,null),this.streamWriter.appendRectangle(s,a,h,l),this.drawPathHelper(p,d,!1)}},t.prototype.drawPathHelper=function(t,e,i,r){if("boolean"===typeof i){var n=i;this.drawPathHelper(t,e,St.Winding,n)}else{n=i;var o=null!=t,s=null!=e,a=n===St.Alternate;o&&s?this.streamWriter.fillStrokePath(a):o||s?o?this.streamWriter.strokePath():this.streamWriter.fillPath(a):this.streamWriter.endPath()}},t.prototype.drawImage=function(t,e,i,r,n){if("number"===typeof e&&"number"===typeof i&&"undefined"===typeof r){var o=t.physicalDimension;this.drawImage(t,e,i,o.width,o.height)}else{var s=e,a=i,h=n;t.save();var l=new ne;this.getTranslateTransform(s,a+h,l),this.getScaleTransform(r,n,l),this.pdfStreamWriter.write("q"),this.pdfStreamWriter.modifyCtm(l);var u=this.getResources.getResources();"undefined"!==typeof this.pageLayer&&null!=this.page&&(u.document=this.page.document);var c=u.getName(t);"undefined"!==typeof this.pageLayer&&this.page.setResources(u),this.pdfStreamWriter.executeObject(c),this.pdfStreamWriter.write(L.restoreState),this.pdfStreamWriter.write(L.newLine);var p=this.getResources.getResources();p.requireProcedureSet(this.procedureSets.imageB),p.requireProcedureSet(this.procedureSets.imageC),p.requireProcedureSet(this.procedureSets.imageI),p.requireProcedureSet(this.procedureSets.text)}},t.prototype.getLineBounds=function(t,e,i,r,n){var o;if(!e.empty&&t<e.lineCount&&t>=0){var s=e.lines[t],a=this.getTextVerticalAlignShift(e.actualSize.height,r.height,n),h=a+r.y+e.lineHeight*t,l=s.width,u=this.getHorizontalAlignShift(l,r.width,n),c=this.getLineIndent(s,n,r,0===t);u+=this.rightToLeft(n)?0:c;var p=r.x+u,d=this.shouldJustify(s,r.width,n)?r.width-c:l-c,f=e.lineHeight;o=new ct(p,h,d,f)}else o=new ct(0,0,0,0);return o},t.prototype.checkCorrectLayoutRectangle=function(t,e,i,r){var n=new ct(e,i,t.width,t.width);if(null!=r){switch(r.alignment){case mt.Center:n.x-=n.width/2;break;case mt.Right:n.x-=n.width;break}switch(r.lineAlignment){case gt.Middle:n.y-=n.height/2;break;case gt.Bottom:n.y-=n.height;break}}return n},t.prototype.setLayer=function(t){this.pageLayer=t;var e=t.page;null!=e&&"undefined"!==typeof e&&(e.beginSave=this.pageSave)},t.prototype.pageSave=function(t){if(null!=t.graphics.automaticFields)for(var e=0;e<t.graphics.automaticFields.automaticFields.length;e++){var i=t.graphics.automaticFields.automaticFields[e];i.field.performDraw(t.graphics,i.location,i.scalingX,i.scalingY)}},t.prototype.drawStringLayoutResult=function(t,e,i,r,n,o){if(t.empty)throw new Error("ArgumentNullException:result");this.applyStringSettings(e,i,r,o,n);var s=null!=o?o.horizontalScalingFactor:100;s===this.previousTextScaling||this.isEmfTextScaled||(this.pdfStreamWriter.setTextScaling(s),this.previousTextScaling=s);var a=null==o||0===o.lineSpacing?e.height:o.lineSpacing+e.height,h=null!=o&&o.subSuperScript===Rt.SubScript,l=0;l=h?a-(e.height+e.metrics.getDescent(o)):a-e.metrics.getAscent(o),this.shift=l,this.pdfStreamWriter.startNextLine(n.x,n.y-l),this.pdfStreamWriter.setLeading(+a);for(var u=0,c="",p=0;p<t.lines.length;p++)if(u+=t.lineHeight,n.y+u>this.clientSize.height){this.startCutIndex=p;break}for(var d=this.startCutIndex;d<t.lines.length&&d>=0;d++)c+=t.lines[d].text;var f=new ct(n.x,n.y,n.width,n.height);if(this.drawLayoutResult(t,e,o,n),this.underlineStrikeoutText(i,r,t,e,f,o),this.isEmfPlus=!1,this.isUseFontSize=!1,-1!==this.startCutIndex){var g=this.getNextPage();g.graphics.drawString(c,e,i,r,n.x,0,n.width,0,o)}},t.prototype.getNextPage=function(){var t=this.currentPage.section,e=null,i=t.indexOf(this.currentPage);return e=i===t.count-1?t.add():t.getPages()[i+1],e},t.prototype.setClip=function(t,e){"undefined"===typeof e?this.setClip(t,St.Winding):(this.pdfStreamWriter.appendRectangle(t),this.pdfStreamWriter.clipPath(e===St.Alternate))},t.prototype.applyStringSettings=function(t,e,i,r,n){i instanceof oi?(this.bCSInitialized=!1,i.graphics.colorSpace=this.colorSpace):i instanceof Ke&&(this.bCSInitialized=!1,i.colorSpace=this.colorSpace);var o=this.getTextRenderingMode(e,i,r);this.stateControl(e,i,t,r),this.pdfStreamWriter.beginText(),o!==this.previousTextRenderingMode&&(this.pdfStreamWriter.setTextRenderingMode(o),this.previousTextRenderingMode=o);var s=null!=r?r.characterSpacing:0;s===this.previousCharacterSpacing||this.isEmfTextScaled||(this.pdfStreamWriter.setCharacterSpacing(s),this.previousCharacterSpacing=s);var a=null!=r?r.wordSpacing:0;a!==this.previousWordSpacing&&(this.pdfStreamWriter.setWordSpacing(a),this.previousWordSpacing=a)},t.prototype.getTextVerticalAlignShift=function(t,e,i){var r=0;if(e>=0&&null!=i&&i.lineAlignment!==gt.Top)switch(i.lineAlignment){case gt.Middle:r=(e-t)/2;break;case gt.Bottom:r=e-t;break}return r},t.prototype.drawLayoutResult=function(t,e,i,r){var n=this.getTextVerticalAlignShift(t.actualSize.height,r.height,i);0!==n&&this.pdfStreamWriter.startNextLine(0,n);for(var o=e,s=null!=o&&o.isUnicode,a=(null!=o&&o.isEmbedFont,t.lines),h=0,l=a.length;h<l&&h!==this.startCutIndex;h++){var u=a[h],c=(u.text,u.width),p=this.getHorizontalAlignShift(c,r.width,i),d=this.getLineIndent(u,i,r,0===h);p+=this.rightToLeft(i)?0:d,0===p||this.isEmfTextScaled||this.pdfStreamWriter.startNextLine(p,0),s?this.drawUnicodeLine(u,r,e,i):this.drawAsciiLine(u,r,e,i),0===p||this.isEmfTextScaled||this.pdfStreamWriter.startNextLine(-p,0),this.isOverloadWithPosition&&a.length>1&&(this.pdfStreamWriter.startNextLine(-r.x,0),r.x=0,r.width=this.clientSize.width,this.isOverloadWithPosition=!1,this.isPointOverload=!0)}this.getResources.getResources().requireProcedureSet(this.procedureSets.text),0!==n&&this.pdfStreamWriter.startNextLine(0,-(n-t.lineHeight)),this.pdfStreamWriter.endText()},t.prototype.drawAsciiLine=function(t,e,i,r){this.justifyLine(t,e.width,r);var n="";if(-1!==t.text.indexOf("(")||-1!==t.text.indexOf(")"))for(var o=0;o<t.text.length;o++)"("===t.text[o]?n+="\\(":")"===t.text[o]?n+="\\)":n+=t.text[o];""===n&&(n=t.text);var s="("+n+")";this.pdfStreamWriter.showNextLineText(new Y(s))},t.prototype.drawUnicodeLine=function(t,e,i,r){var n=t.text,o=(t.width,null!==r&&"undefined"!==typeof r&&r.rightToLeft),s=null!==r&&"undefined"!==typeof r&&(0!==r.wordSpacing||r.alignment===mt.Justify),a=i,h=this.justifyLine(t,e.width,r),l=new He;if(o||null!==r&&"undefined"!==typeof r&&r.textDirection!==Tt.None){var u=null,c=null!==r&&"undefined"!==typeof r&&r.alignment===mt.Right;u=null!==r&&"undefined"!==typeof r&&r.textDirection!==Tt.None?l.layout(n,a,r.textDirection===Tt.RightToLeft,s,r):l.layout(n,a,c,s,r);var p=null;p=u.length>1?null!==r&&"undefined"!==typeof r&&r.textDirection!==Tt.None?l.splitLayout(n,a,r.textDirection===Tt.RightToLeft,s,r):l.splitLayout(n,a,c,s,r):[n],this.drawUnicodeBlocks(u,p,a,r,h)}else if(s){var d=this.breakUnicodeLine(n,a,null);u=d.tokens,p=d.words;this.drawUnicodeBlocks(u,p,a,r,h)}else{var f=this.convertToUnicode(n,a),g=this.getUnicodeString(f);this.streamWriter.showNextLineText(g)}},t.prototype.drawUnicodeBlocks=function(t,e,i,r,n){if(null==t)throw new Error("Argument Null Exception : blocks");if(null==e)throw new Error("Argument Null Exception : words");if(null==i)throw new Error("Argument Null Exception : font");this.streamWriter.startNextLine();var o=0,s=0,a=0,h=0;try{null!==r&&"undefined"!==typeof r&&(a=r.firstLineIndent,h=r.paragraphIndent,r.firstLineIndent=0,r.paragraphIndent=0);var l=i.getCharWidth(Yt.whiteSpace,r)+n,u=null!=r?r.characterSpacing:0,c=null!==r&&"undefined"!==typeof r&&0===n?r.wordSpacing:0;l+=u+c;for(var p=0;p<t.length;p++){var d=t[p],f=e[p],g=0;if(0!==o&&this.streamWriter.startNextLine(o,0),f.length>0){g+=i.measureString(f,r).width,g+=u;var m=this.getUnicodeString(d);this.streamWriter.showText(m)}p!==t.length-1&&(o=g+l,s+=o)}s>0&&this.streamWriter.startNextLine(-s,0)}finally{null!==r&&"undefined"!==typeof r&&(r.firstLineIndent=a,r.paragraphIndent=h)}},t.prototype.breakUnicodeLine=function(t,e,i){if(null===t)throw new Error("Argument Null Exception : line");i=t.split(null);for(var r=[],n=0;n<i.length;n++){var o=i[n],s=this.convertToUnicode(o,e);r[n]=s}return{tokens:r,words:i}},t.prototype.getUnicodeString=function(t){if(null===t)throw new Error("Argument Null Exception : token");var e=new Y(t);return e.converted=!0,e.encode=C.ForceEncoding.Ascii,e},t.prototype.convertToUnicode=function(t,e){var i=null;if(null==t)throw new Error("Argument Null Exception : text");if(null==e)throw new Error("Argument Null Exception : ttfFont");if(e.fontInternal instanceof De){var r=e.fontInternal.ttfReader;e.setSymbols(t),i=r.convertString(t);var n=Y.toUnicodeArray(i,!1);i=Y.byteToString(n)}return i},t.prototype.justifyLine=function(t,e,i){var r=t.text,n=t.width,o=this.shouldJustify(t,e,i),s=null!=i&&0!==i.wordSpacing,a=Yt.spaces,h=Yt.getCharsCount(r,a),l=0;if(o){s&&(n-=h*i.wordSpacing);var u=e-n;l=u/h,this.pdfStreamWriter.setWordSpacing(l)}else s?this.pdfStreamWriter.setWordSpacing(i.wordSpacing):this.pdfStreamWriter.setWordSpacing(0);return l},t.prototype.reset=function(t){this.canvasSize=t,this.streamWriter.clear(),this.initialize(),this.initializeCoordinates()},t.prototype.shouldJustify=function(t,e,i){var r=t.text,n=t.width,o=null!=i&&i.alignment===mt.Justify,s=e>=0&&n<e,a=Yt.spaces,h=Yt.getCharsCount(r,a),l=h>0&&r[0]!==Yt.whiteSpace,u=(t.lineType&Wt.LayoutBreak)>0,c=o&&s&&l&&(u||i.alignment===mt.Justify);return c},t.prototype.underlineStrikeoutText=function(t,e,i,r,n,o){if(r.underline||r.strikeout){var s=this.createUnderlineStikeoutPen(t,e,r,o);if(null!=s){var a=this.getTextVerticalAlignShift(i.actualSize.height,n.height,o),h=0;h=n.y+a+r.metrics.getAscent(o)+1.5*s.width;for(var l=n.y+a+r.metrics.getHeight(o)/2+1.5*s.width,u=i.lines,c=0,p=i.lineCount;c<p;c++){var d=u[c],f=(d.text,d.width),g=this.getHorizontalAlignShift(f,n.width,o),m=this.getLineIndent(d,o,n,0===c);g+=this.rightToLeft(o)?0:m;var y=n.x+g,b=this.shouldJustify(d,n.width,o)?y+n.width-m:y+f-m;if(r.underline){var w=h;this.drawLine(s,y,w,b,w),h+=i.lineHeight}if(r.strikeout){w=l;this.drawLine(s,y,w,b,w),l+=i.lineHeight}this.isPointOverload&&u.length>1&&(n.x=0,n.width=this.clientSize.width)}this.isPointOverload=!1}}},t.prototype.createUnderlineStikeoutPen=function(t,e,i,r){var n=i.metrics.getSize(r)/20,o=null;return null!=t?o=new Xt(t.color,n):null!=e&&(o=new Xt(e,n)),o},t.prototype.getTextRenderingMode=function(t,e,i){var r=yt.None;return r=null!=t&&null!=e?yt.FillStroke:null!=t?yt.Stroke:yt.Fill,null!=i&&i.clipPath&&(r|=yt.ClipFlag),r},t.prototype.getLineIndent=function(t,e,i,r){var n=0,o=(t.lineType&Wt.FirstParagraphLine)>0;return null!=e&&o&&(n=r?e.firstLineIndent:e.paragraphIndent,n=i.width>0?Math.min(i.width,n):n),n},t.prototype.getHorizontalAlignShift=function(t,e,i){var r=0;if(e>=0&&null!=i&&i.alignment!==mt.Left)switch(i.alignment){case mt.Center:r=(e-t)/2;break;case mt.Right:r=e-t;break}return r},t.prototype.rightToLeft=function(t){var e=null!==t&&"undefined"!==typeof t&&t.rightToLeft;return null!==t&&"undefined"!==typeof t&&t.textDirection!==Tt.None&&"undefined"!==typeof t.textDirection&&(e=!0),e},t.prototype.stateControl=function(t,e,i,r){if("undefined"===typeof r)this.stateControl(t,e,i,null);else{e instanceof Ke&&(this.bCSInitialized=!1,e.colorSpace=this.colorSpace),e instanceof oi&&(this.bCSInitialized=!1,e.graphics.colorSpace=this.colorSpace);var n=!1;if(null!==e){"undefined"!==typeof this.pageLayer&&null!=this.pageLayer&&!1===this.colorSpaceChanged&&(this.lastDocumentCS=this.pageLayer.page.document.colorSpace,this.lastGraphicsCS=this.pageLayer.page.graphics.colorSpace,this.colorSpace=this.pageLayer.page.document.colorSpace,this.currentColorSpace=this.pageLayer.page.document.colorSpace,this.colorSpaceChanged=!0),this.initCurrentColorSpace(this.currentColorSpace)}else if(null!=t){"undefined"!==typeof this.pageLayer&&null!=this.pageLayer&&(this.colorSpace=this.pageLayer.page.document.colorSpace,this.currentColorSpace=this.pageLayer.page.document.colorSpace),this.initCurrentColorSpace(this.currentColorSpace)}this.penControl(t,n),this.brushControl(e,n),this.fontControl(i,r,n)}},t.prototype.initCurrentColorSpace=function(t){this.getResources.getResources();this.bCSInitialized||(this.currentColorSpace!=Ct.GrayScale?(this.pdfStreamWriter.setColorSpace("Device"+this.currentColorSpaces[this.currentColorSpace],!0),this.pdfStreamWriter.setColorSpace("Device"+this.currentColorSpaces[this.currentColorSpace],!1),this.bCSInitialized=!0):(this.pdfStreamWriter.setColorSpace("DeviceGray",!0),this.pdfStreamWriter.setColorSpace("DeviceGray",!1),this.bCSInitialized=!0))},t.prototype.penControl=function(t,e){null!=t&&(this.currentPen=t,t.monitorChanges(this.currentPen,this.pdfStreamWriter,this.getResources,e,this.colorSpace,this.matrix.clone()),this.currentPen=t.clone())},t.prototype.brushControl=function(t,e){if(null!=t&&"undefined"!==typeof t){var i=t.clone(),r=i;if(null!==r&&"undefined"!==typeof r&&!(t instanceof Kt)&&!(t instanceof oi)){var n=r.matrix,o=this.matrix.clone();null!=n&&(n.multiply(o),o=n),r.matrix=o}this.currentBrush=r;i.monitorChanges(this.currentBrush,this.pdfStreamWriter,this.getResources,e,this.colorSpace),this.currentBrush=t,t=null}},t.prototype.fontControl=function(t,e,i){if(null!=t){var r=null!=e?e.subSuperScript:Rt.None,n=null!=this.currentStringFormat?this.currentStringFormat.subSuperScript:Rt.None;if(i||t!==this.currentFont||r!==n){var o=this.getResources.getResources();this.currentFont=t,this.currentStringFormat=e;var s=t.metrics.getSize(e);this.isEmfTextScaled=!1;var a=o.getName(t);this.pdfStreamWriter.setFont(t,a,s)}}},t.prototype.setTransparency=function(t,e,i){if("undefined"===typeof e)this.istransparencySet=!0,this.setTransparency(t,t,xt.Normal);else if("number"===typeof e&&"undefined"===typeof i)this.setTransparency(t,e,xt.Normal);else{null==this.trasparencies&&(this.trasparencies=new ae);var r=null,n=new li(t,e,i);this.trasparencies.containsKey(n)&&(r=this.trasparencies.getValue(n)),null==r&&(r=new he(t,e,i),this.trasparencies.setValue(n,r));var o=this.getResources.getResources(),s=o.getName(r),a=this.streamWriter;a.setGraphicsState(s)}},t.prototype.clipTranslateMargins=function(t,e,i,r,n,o){if(t instanceof ct&&"undefined"===typeof e)this.clipBounds=t,this.pdfStreamWriter.writeComment("Clip margins."),this.pdfStreamWriter.appendRectangle(t),this.pdfStreamWriter.closePath(),this.pdfStreamWriter.clipPath(!1),this.pdfStreamWriter.writeComment("Translate co-ordinate system."),this.translateTransform(t.x,t.y);else if("number"===typeof t){var s=new ct(i,r,this.size.width-i-n,this.size.height-r-o);this.clipBounds=s,this.pdfStreamWriter.writeComment("Clip margins."),this.pdfStreamWriter.appendRectangle(s),this.pdfStreamWriter.closePath(),this.pdfStreamWriter.clipPath(!1),this.pdfStreamWriter.writeComment("Translate co-ordinate system."),this.translateTransform(t,e)}},t.prototype.updateY=function(t){return-t},t.prototype.translateTransform=function(t,e){var i=new ne;this.getTranslateTransform(t,e,i),this.pdfStreamWriter.modifyCtm(i),this.matrix.multiply(i)},t.prototype.getTranslateTransform=function(t,e,i){return i.translate(t,this.updateY(e)),i},t.prototype.scaleTransform=function(t,e){var i=new ne;this.getScaleTransform(t,e,i),this.pdfStreamWriter.modifyCtm(i),this.matrix.multiply(i)},t.prototype.getScaleTransform=function(t,e,i){return null==i&&(i=new ne),i.scale(t,e),i},t.prototype.rotateTransform=function(t){var e=new ne;this.getRotateTransform(t,e),this.pdfStreamWriter.modifyCtm(e),this.matrix.multiply(e)},t.prototype.initializeCoordinates=function(){this.pdfStreamWriter.writeComment("Change co-ordinate system to left/top."),this.mediaBoxUpperRightBound!==-this.size.height&&null==this.cropBox&&(this.mediaBoxUpperRightBound===this.size.height||0===this.mediaBoxUpperRightBound?this.translateTransform(0,this.updateY(this.size.height)):this.translateTransform(0,this.updateY(this.mediaBoxUpperRightBound)))},t.prototype.getRotateTransform=function(t,e){return null!=e&&"undefined"!==typeof e||(e=new ne),e.rotate(this.updateY(t)),e},t.prototype.save=function(){var t=new hi(this,this.matrix.clone());return t.brush=this.currentBrush,t.pen=this.currentPen,t.font=this.currentFont,t.colorSpace=this.currentColorSpace,t.characterSpacing=this.previousCharacterSpacing,t.wordSpacing=this.previousWordSpacing,t.textScaling=this.previousTextScaling,t.textRenderingMode=this.previousTextRenderingMode,this.graphicsState.push(t),this.pdfStreamWriter.saveGraphicsState(),t},t.prototype.restore=function(t){if("undefined"===typeof t)this.graphicsState.length>0&&this.doRestoreState();else if(-1!==this.graphicsState.indexOf(t))for(;;){if(0===this.graphicsState.length)break;var e=this.doRestoreState();if(e===t)break}},t.prototype.doRestoreState=function(){var t=this.graphicsState.pop();return this.transformationMatrix=t.matrix,this.currentBrush=t.brush,this.currentPen=t.pen,this.currentFont=t.font,this.currentColorSpace=t.colorSpace,this.previousCharacterSpacing=t.characterSpacing,this.previousWordSpacing=t.wordSpacing,this.previousTextScaling=t.textScaling,this.previousTextRenderingMode=t.textRenderingMode,this.pdfStreamWriter.restoreGraphicsState(),t},t.prototype.drawPath=function(t,e,i){e instanceof oi?(this.bCSInitialized=!1,e.graphics.colorSpace=this.colorSpace):e instanceof Ke&&(this.bCSInitialized=!1,e.colorSpace=this.colorSpace),this.stateControl(t,e,null),this.buildUpPath(i.pathPoints,i.pathTypes),this.drawPathHelper(t,e,i.fillMode,!1)},t.prototype.drawArc=function(t,e,i,r,n,o,s){e instanceof ct?this.drawArc(t,e.x,e.y,e.width,e.height,i,r):0!==s&&(this.stateControl(t,null,null),this.constructArcPath(e,i,e+r,i+n,o,s),this.drawPathHelper(t,null,!1))},t.prototype.buildUpPath=function(e,i){for(var r=e.length,n=0;n<r;++n){var o=0,s=e[n];switch(i[n]&t.pathTypesValuesMask){case ie.Start:this.pdfStreamWriter.beginPath(s.x,s.y);break;case ie.Bezier3:var a=new lt(0,0),h=new lt(0,0),l=this.getBezierPoints(e,i,n,a,h);this.pdfStreamWriter.appendBezierSegment(s,l.p2,l.p3),n=l.i;break;case ie.Line:this.pdfStreamWriter.appendLineSegment(s);break;default:throw new Error("ArithmeticException - Incorrect path formation.")}o=i[n],this.checkFlags(o)}},t.prototype.getBezierPoints=function(e,i,r,n,o){if(++r,(i[r]&t.pathTypesValuesMask)!==ie.Bezier3)throw new Error("ArgumentException : errorMsg");if(n=e[r],++r,(i[r]&t.pathTypesValuesMask)!==ie.Bezier3)throw new Error("ArgumentException : errorMsg");return o=e[r],{i:r,p2:n,p3:o}},t.prototype.checkFlags=function(t){(t&ie.CloseSubpath)===ie.CloseSubpath&&this.pdfStreamWriter.closePath()},t.prototype.constructArcPath=function(t,e,i,r,n,o){var s=this.getBezierArc(t,e,i,r,n,o);if(0!==s.length){var a=[s[0],s[1],s[2],s[3],s[4],s[5],s[6],s[7]];this.pdfStreamWriter.beginPath(a[0],a[1]);var h=0;for(h=0;h<s.length;h+=8)a=[s[h],s[h+1],s[h+2],s[h+3],s[h+4],s[h+5],s[h+6],s[h+7]],this.pdfStreamWriter.appendBezierSegment(a[2],a[3],a[4],a[5],a[6],a[7])}},t.prototype.getBezierArc=function(t,e,i,r,n,o){if(t>i){var s=void 0;s=t,t=i,i=s}if(r>e){s=void 0;s=e,e=r,r=s}var a,h;Math.abs(o)<=90?(a=o,h=1):(h=Math.ceil(Math.abs(o)/90),a=o/h);for(var l=(t+i)/2,u=(e+r)/2,c=(i-t)/2,p=(r-e)/2,d=a*(Math.PI/360),f=Math.abs(4/3*(1-Math.cos(d))/Math.sin(d)),g=[],m=0;m<h;m++){var y=(n+m*a)*(Math.PI/180),b=(n+(m+1)*a)*(Math.PI/180),w=Math.cos(y),v=Math.cos(b),S=Math.sin(y),C=Math.sin(b);a>0?g.push(l+c*w,u-p*S,l+c*(w-f*S),u-p*(S+f*w),l+c*(v+f*C),u-p*(C-f*v),l+c*v,u-p*C):g.push(l+c*w,u-p*S,l+c*(w+f*S),u-p*(S-f*w),l+c*(v-f*C),u-p*(C+f*v),l+c*v,u-p*C)}return g},t.pathTypesValuesMask=15,t.transparencyObject=!1,t}(),ai=function(){function t(t){this.sender=t}return t.prototype.getResources=function(){return this.sender.getResources()},t}(),hi=function(){function t(t,e){this.internalTextRenderingMode=yt.Fill,this.internalCharacterSpacing=0,this.internalWordSpacing=0,this.internalTextScaling=100,this.pdfColorSpace=Ct.Rgb,"undefined"!==typeof t&&(this.pdfGraphics=t,this.transformationMatrix=e)}return Object.defineProperty(t.prototype,"graphics",{get:function(){return this.pdfGraphics},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"matrix",{get:function(){return this.transformationMatrix},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"characterSpacing",{get:function(){return this.internalCharacterSpacing},set:function(t){this.internalCharacterSpacing=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"wordSpacing",{get:function(){return this.internalWordSpacing},set:function(t){this.internalWordSpacing=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"textScaling",{get:function(){return this.internalTextScaling},set:function(t){this.internalTextScaling=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pen",{get:function(){return this.pdfPen},set:function(t){this.pdfPen=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"brush",{get:function(){return this.pdfBrush},set:function(t){this.pdfBrush=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"font",{get:function(){return this.pdfFont},set:function(t){this.pdfFont=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"colorSpace",{get:function(){return this.pdfColorSpace},set:function(t){this.pdfColorSpace=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"textRenderingMode",{get:function(){return this.internalTextRenderingMode},set:function(t){this.internalTextRenderingMode=t},enumerable:!0,configurable:!0}),t}(),li=function(){function t(t,e,i){this.alphaPen=t,this.alphaBrush=e,this.blendMode=i}return t}(),ui=function(){function t(t,e){if(this.pdfColorSpace=Ct.Rgb,this.isVisible=!0,this.sublayer=!1,this.contentLength=0,this.dictionaryProperties=new j,null===t)throw new Error("ArgumentNullException:page");if(this.pdfPage=t,this.clipPageTemplates=!0,"undefined"===typeof e)this.content=new q;else if(e instanceof q||null===e){if(null===e)throw new Error("ArgumentNullException:stream");this.content=e}else this.content=new q,this.clipPageTemplates=e}return Object.defineProperty(t.prototype,"colorSpace",{get:function(){return this.pdfColorSpace},set:function(t){this.pdfColorSpace=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"page",{get:function(){return this.pdfPage},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"layerId",{get:function(){return this.layerid},set:function(t){this.layerid=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.layerName},set:function(t){this.layerName=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"visible",{get:function(){return this.isVisible},set:function(t){this.isVisible=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"graphics",{get:function(){return null==this.pdfGraphics&&this.initializeGraphics(this.page),this.pdfGraphics},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"layers",{get:function(){return null==this.layer?(this.layer=new di(this.page),this.layer.sublayer=!0,this.layer):this.layer},enumerable:!0,configurable:!0}),t.prototype.add=function(){var e=new t(this.pdfPage);return e.name="",e},t.prototype.sign=function(t){return 0===t?0:t>0?1:-1},t.prototype.initializeGraphics=function(t){var e=t,i=new ai(this.page);if(this.pdfGraphics=new si(t.size,i,this.content),this.pdfGraphics.mediaBoxUpperRightBound=0,null!=e){var r=e.section.parent;null!=r&&(this.pdfGraphics.colorSpace=r.document.colorSpace,this.colorSpace=r.document.colorSpace)}var n=this.sign(t.origin.y)===this.sign(t.origin.x);(t.origin.x>=0&&t.origin.y>=0||!n)&&this.pdfGraphics.initializeCoordinates();var o=e.section.getActualBounds(e,!0),s=e.section.pageSettings.margins;this.clipPageTemplates?t.origin.x>=0&&t.origin.y>=0&&this.pdfGraphics.clipTranslateMargins(o):this.graphics.clipTranslateMargins(o.x,o.y,s.left,s.top,s.right,s.bottom),this.pdfGraphics.setLayer(this)},Object.defineProperty(t.prototype,"element",{get:function(){return this.content},enumerable:!0,configurable:!0}),t}(),ci=function(){function t(){}return Object.defineProperty(t.prototype,"count",{get:function(){return"undefined"===typeof this.collection&&(this.collection=[]),this.collection.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"list",{get:function(){return"undefined"===typeof this.collection&&(this.collection=[]),this.collection},enumerable:!0,configurable:!0}),t}(),pi=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},t(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),di=function(t){function e(e){var i=t.call(this)||this;if(i.parentLayerCount=0,i.sublayer=!1,i.optionalContent=new B,e instanceof fi){i.page=e;var r=e;i.parseLayers(r)}return i}return pi(e,t),e.prototype.items=function(t,e){if("number"===typeof t&&"undefined"===typeof e){var i=this.list[t];return i}if(null==e)throw new Error("ArgumentNullException: layer");if(e.page!==this.page)throw new Error("ArgumentException: The layer belongs to another page")},e.prototype.add=function(t,e){if("undefined"===typeof t){var i=new ui(this.page);return i.name="",this.add(i),i}if(t instanceof ui){var r=this.list.push(t);return this.addLayer(r,t),r}return 0},e.prototype.addLayer=function(t,e){var i=new Z(e);this.page.contents.add(i)},e.prototype.insert=function(t,e){for(var i=[],r=this.list.length,n=t;n<r;n++)i.push(this.list.pop());this.list.push(e);for(n=0;n<i.length;n++)this.list.push(i[n]);this.insertLayer(t,e)},e.prototype.insertLayer=function(t,e){if(null==e)throw new Error("ArgumentNullException:layer");var i=new Z(e);this.page.contents.insert(t,i)},e.prototype.parseLayers=function(t){var e=this.page.contents;this.page.getResources();t.crossTable;var i=new q,r=new q,n="q",o="Q",s=[];s.push(n),i.data=s,e.insert(0,new Z(i)),s=[],s.push(o),r.data=s,e.insert(e.count,new Z(r))},e.prototype.indexOf=function(t){if(null==t)throw new Error("ArgumentNullException: layer");var e=this.list.indexOf(t);return e},e}(ci),fi=function(){function t(t){this.defLayerIndex=-1,this.modified=!1,this.dictionaryProperties=new j,this.pageDictionary=t}return Object.defineProperty(t.prototype,"section",{get:function(){return this.pdfSection},set:function(t){this.pdfSection=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dictionary",{get:function(){return this.pageDictionary},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"element",{get:function(){return this.pageDictionary},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"defaultLayer",{get:function(){var t=this.layers,e=this.defaultLayerIndex,i=t.items(e);return i},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"defaultLayerIndex",{get:function(){if(0===this.layerCollection.count||-1===this.defLayerIndex){var t=this.layerCollection.add();this.defLayerIndex=this.layerCollection.indexOf(t)}return this.defLayerIndex},set:function(t){if(t<0||t>this.layers.count-1)throw new Error("ArgumentOutOfRangeException : value, Index can not be less 0 and greater Layers.Count - 1");this.defLayerIndex=t,this.modified=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"layers",{get:function(){return null!=this.layerCollection&&"undefined"!==typeof this.layerCollection||(this.layerCollection=new di(this)),this.layerCollection},enumerable:!0,configurable:!0}),t.prototype.getResources=function(){return null==this.resources&&(this.resources=new ii,this.dictionary.items.setValue(this.dictionaryProperties.resources,this.resources)),this.resources},Object.defineProperty(t.prototype,"contents",{get:function(){var t=this.pageDictionary.items.getValue(this.dictionaryProperties.contents),e=t;return null==e&&(e=new N,this.pageDictionary.items.setValue(this.dictionaryProperties.contents,e)),e},enumerable:!0,configurable:!0}),t.prototype.setResources=function(t){this.resources=t,this.dictionary.items.setValue(this.dictionaryProperties.resources,this.resources),this.modified=!0},t}(),gi=function(){function t(t){this.alreadyExistsAnnotationError="This annotatation had been already added to page",this.missingAnnotationException="Annotation is not contained in collection.",this.dictionaryProperties=new j,this.internalAnnotations=new N,this.lists=[],"undefined"!==typeof t&&(this.page=t)}return Object.defineProperty(t.prototype,"annotations",{get:function(){return this.internalAnnotations},set:function(t){this.internalAnnotations=t},enumerable:!0,configurable:!0}),t.prototype.add=function(t){this.doAdd(t)},t.prototype.doAdd=function(t){if("undefined"===typeof t.destination)return t.setPage(this.page),this.internalAnnotations.add(new Z(t)),this.lists.push(t);var e=new Qt,i=e.layout(t.text,t.font,t.stringFormat,new ut(t.bounds.width,0),!1,new ut(0,0)),r=t.bounds.y;if(1===i.lines.length){var n=t.font.measureString(i.lines[0].text);t.bounds=new ct(new lt(t.bounds.x,r),n),t.text=i.lines[0].text,this.page.graphics.drawString(t.text,t.font,null,t.brush,t.bounds.x,t.bounds.y,t.bounds.width,t.bounds.height,null),t.setPage(this.page),this.setColor(t),this.internalAnnotations.add(new Z(t)),this.lists.push(t)}else for(var o=0;o<i.lines.length;o++){n=t.font.measureString(i.lines[o].text);if(0===o)t.bounds=new ct(t.bounds.x,r,n.width,n.height),t.text=i.lines[o].text,this.page.graphics.drawString(t.text,t.font,null,t.brush,t.bounds.x,r,n.width,n.height,null),t.setPage(this.page),this.setColor(t),this.internalAnnotations.add(new Z(t)),this.lists.push(t),r+=t.bounds.height;else{var s=t.clone();s.bounds=new ct(new lt(t.bounds.x,r),n),s.text=i.lines[o].text,this.page.graphics.drawString(s.text,s.font,null,s.brush,s.bounds.x,s.bounds.y,s.bounds.width,s.bounds.height,null),s.setPage(this.page),this.setColor(s),this.internalAnnotations.add(new Z(s)),this.lists.push(s),r+=s.bounds.height}}},t.prototype.setColor=function(t){var e=Ct.Rgb,i=t.color.toArray(e);t.dictionary.items.setValue(this.dictionaryProperties.c,i)},Object.defineProperty(t.prototype,"element",{get:function(){return this.internalAnnotations},enumerable:!0,configurable:!0}),t}(),mi=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},t(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),yi=function(t){function e(){var e=t.call(this,new B)||this;return e.annotationCollection=null,e.beginSave=null,e.initialize(),e}return mi(e,t),Object.defineProperty(e.prototype,"document",{get:function(){return null!==this.section&&null!==this.section.parent?this.section.parent.document:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"graphics",{get:function(){var t=this.defaultLayer.graphics;return t.currentPage=this,t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"crossTable",{get:function(){if(null===this.section)throw new Error("PdfDocumentException : Page is not created");return null===this.section.parent?this.section.parentDocument.crossTable:this.section.parent.document.crossTable},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this.section.pageSettings.size},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"origin",{get:function(){return this.section.pageSettings.origin},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"annotations",{get:function(){return null==this.annotationCollection&&(this.annotationCollection=new gi(this),this.dictionary.items.setValue(this.dictionaryProperties.annots,this.annotationCollection.element),this.annotationCollection.annotations=this.dictionary.items.getValue(this.dictionaryProperties.annots)),this.annotationCollection},enumerable:!0,configurable:!0}),e.prototype.initialize=function(){this.dictionary.items.setValue(this.dictionaryProperties.type,new T("Page")),this.dictionary.pageBeginDrawTemplate=new A(this)},e.prototype.setSection=function(t){this.section=t,this.dictionary.items.setValue(this.dictionaryProperties.parent,new Z(t))},e.prototype.resetProgress=function(){this.isProgressOn=!1},e.prototype.getClientSize=function(){var t=this.section.getActualBounds(this,!0);return new ut(t.width,t.height)},e.prototype.pageBeginSave=function(){var t=this.document;void 0!==typeof t&&null!=t&&this.drawPageTemplates(t),null!=this.beginSave&&"undefined"!==typeof this.beginSave&&this.beginSave(this)},e.prototype.drawPageTemplates=function(t){var e=this.section.containsTemplates(t,this,!1);if(e){var i=new ui(this,!1);if(this.layers.insert(0,i),this.section.drawTemplates(this,i,t,!1),null!==i.graphics&&"undefined"!==typeof i.graphics)for(var r=0;r<i.graphics.automaticFields.automaticFields.length;r++){var n=i.graphics.automaticFields.automaticFields[r];n.field.performDraw(i.graphics,n.location,n.scalingX,n.scalingY)}}var o=this.section.containsTemplates(t,this,!0);if(o){var s=new ui(this,!1);this.layers.add(s),this.section.drawTemplates(this,s,t,!0)}},e}(fi),bi=function(){function t(t){this.pdfPage="undefined"!==typeof t?t:null}return Object.defineProperty(t.prototype,"page",{get:function(){return this.pdfPage},enumerable:!0,configurable:!0}),t}(),wi=function(){function t(t){if(this.pdfSection=null,null==t)throw Error('ArgumentNullException("section")');this.section=t}return Object.defineProperty(t.prototype,"section",{get:function(){return this.pdfSection},set:function(t){this.pdfSection=t},enumerable:!0,configurable:!0}),t.prototype.contains=function(t){return this.section.contains(t)},t.prototype.remove=function(t){this.section.remove(t)},t.prototype.add=function(){return this.section.add()},t}(),vi=function(){function t(){}return Object.defineProperty(t.prototype,"left",{get:function(){return this.leftTemplate},set:function(t){this.leftTemplate=this.checkElement(t,nt.Left)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.topTemplate},set:function(t){this.topTemplate=this.checkElement(t,nt.Top)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.rightTemplate},set:function(t){this.rightTemplate=this.checkElement(t,nt.Right)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.bottomTemplate},set:function(t){this.bottomTemplate=this.checkElement(t,nt.Bottom)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"EvenLeft",{get:function(){return this.evenLeft},set:function(t){this.evenLeft=this.checkElement(t,nt.Left)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"EvenTop",{get:function(){return this.evenTop},set:function(t){this.evenTop=this.checkElement(t,nt.Top)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"EvenRight",{get:function(){return this.evenRight},set:function(t){this.evenRight=this.checkElement(t,nt.Right)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"EvenBottom",{get:function(){return this.evenBottom},set:function(t){this.evenBottom=this.checkElement(t,nt.Bottom)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"OddLeft",{get:function(){return this.oddLeft},set:function(t){this.oddLeft=this.checkElement(t,nt.Left)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"OddTop",{get:function(){return this.oddTop},set:function(t){this.oddTop=this.checkElement(t,nt.Top)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"OddRight",{get:function(){return this.oddRight},set:function(t){this.oddRight=this.checkElement(t,nt.Right)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"OddBottom",{get:function(){return this.oddBottom},set:function(t){this.oddBottom=this.checkElement(t,nt.Bottom)},enumerable:!0,configurable:!0}),t.prototype.getLeft=function(t){if(null==t)throw new Error("ArgumentNullException:page");var e=null,i=this.isEven(t);return e=i?null!=this.EvenLeft?this.EvenLeft:this.left:null!=this.OddLeft?this.OddLeft:this.left,e},t.prototype.getTop=function(t){if(null==t)throw new Error("ArgumentNullException:page");var e=null,i=this.isEven(t);return e=i?null!=this.EvenTop?this.EvenTop:this.top:null!=this.OddTop?this.OddTop:this.top,e},t.prototype.getRight=function(t){if(null==t)throw new Error("ArgumentNullException:page");var e=null,i=this.isEven(t);return e=i?null!=this.EvenRight?this.EvenRight:this.right:null!=this.OddRight?this.OddRight:this.right,e},t.prototype.getBottom=function(t){if(null==t)throw new Error("ArgumentNullException:page");var e=null,i=this.isEven(t);return e=i?null!=this.EvenBottom?this.EvenBottom:this.bottom:null!=this.OddBottom?this.OddBottom:this.bottom,e},t.prototype.isEven=function(t){var e=t.section.document.pages,i=0;i=e.pageCollectionIndex.containsKey(t)?e.pageCollectionIndex.getValue(t)+1:e.indexOf(t)+1;var r=i%2===0;return r},t.prototype.checkElement=function(t,e){if(null!=t){if("undefined"!==typeof t.type&&t.type!==nt.None)throw new Error("NotSupportedException:Can not reassign the template element. Please, create new one.");t.type=e}return t},t}(),Si=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},t(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Ci=function(t){function e(){var e=t.call(this)||this;return e.leftValue=e.topValue=e.rightValue=e.bottomValue=e.stampValue=!0,e}return Si(e,t),Object.defineProperty(e.prototype,"applyDocumentLeftTemplate",{get:function(){return this.leftValue},set:function(t){this.leftValue=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"applyDocumentTopTemplate",{get:function(){return this.topValue},set:function(t){this.topValue=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"applyDocumentRightTemplate",{get:function(){return this.rightValue},set:function(t){this.rightValue=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"applyDocumentBottomTemplate",{get:function(){return this.bottomValue},set:function(t){this.bottomValue=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"applyDocumentStamps",{get:function(){return this.stampValue},set:function(t){this.stampValue=t},enumerable:!0,configurable:!0}),e}(vi),xi=function(){function t(t,e){this.pageAdded=new bi,this.pdfPages=[],this.dictionaryProperties=new j,this.pdfDocument=t,"undefined"===typeof e?(this.settings=t.pageSettings.clone(),this.initialSettings=this.settings.clone()):(this.settings=e.clone(),this.initialSettings=this.settings.clone()),this.initialize()}return Object.defineProperty(t.prototype,"parent",{get:function(){return this.sectionCollection},set:function(t){this.sectionCollection=t,this.section.items.setValue(this.dictionaryProperties.parent,new Z(t))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parentDocument",{get:function(){return this.pdfDocument},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pageSettings",{get:function(){return this.settings},set:function(t){if(null==t)throw Error("Value can not be null.");this.settings=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"element",{get:function(){return this.section},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"count",{get:function(){return this.pagesReferences.count},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"template",{get:function(){return null==this.pageTemplate&&(this.pageTemplate=new Ci),this.pageTemplate},set:function(t){this.pageTemplate=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"document",{get:function(){return this.sectionCollection.document},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pages",{get:function(){return null!=this.pagesCollection&&"undefined"!==typeof this.pagesCollection||(this.pagesCollection=new wi(this)),this.pagesCollection},enumerable:!0,configurable:!0}),t.prototype.getPages=function(){return this.pdfPages},t.prototype.pointToNativePdf=function(t,e){var i=this.getActualBounds(t,!0);return e.x+=i.x,e.y=this.pageSettings.height-e.y,e},t.prototype.setPageSettings=function(t){this.settings=t,this.state.orientation=t.orientation,this.state.rotate=t.rotate,this.state.size=t.size,this.state.origin=t.origin},t.prototype.initialize=function(){this.pagesReferences=new N,this.section=new B,this.state=new Pi(this.pdfDocument),this.section.sectionBeginSave=new M(this,this.state),this.pageCount=new E(0),this.section.items.setValue(this.dictionaryProperties.count,this.pageCount),this.section.items.setValue(this.dictionaryProperties.type,new T(this.dictionaryProperties.pages)),this.section.items.setValue(this.dictionaryProperties.kids,this.pagesReferences)},t.prototype.containsTemplates=function(t,e,i){var r=this.getDocumentTemplates(t,e,i),n=this.getSectionTemplates(e,i);return r.length>0||n.length>0},t.prototype.getDocumentTemplates=function(t,e,i){var r=[];return this.template.applyDocumentTopTemplate&&null!=t.template.getTop(e)&&(!t.template.getTop(e).foreground&&!i||t.template.getTop(e).foreground&&i)&&r.push(t.template.getTop(e)),this.template.applyDocumentBottomTemplate&&null!=t.template.getBottom(e)&&(!t.template.getBottom(e).foreground&&!i||t.template.getBottom(e).foreground&&i)&&r.push(t.template.getBottom(e)),this.template.applyDocumentLeftTemplate&&null!=t.template.getLeft(e)&&(!t.template.getLeft(e).foreground&&!i||t.template.getLeft(e).foreground&&i)&&r.push(t.template.getLeft(e)),this.template.applyDocumentRightTemplate&&null!=t.template.getRight(e)&&(!t.template.getRight(e).foreground&&!i||t.template.getRight(e).foreground&&i)&&r.push(t.template.getRight(e)),r},t.prototype.getSectionTemplates=function(t,e){var i=[];if(null!=this.template.getTop(t)){var r=this.template.getTop(t);(!r.foreground&&!e||r.foreground&&e)&&i.push(r)}if(null!=this.template.getBottom(t)){r=this.template.getBottom(t);(!r.foreground&&!e||r.foreground&&e)&&i.push(r)}if(null!=this.template.getLeft(t)){r=this.template.getLeft(t);(!r.foreground&&!e||r.foreground&&e)&&i.push(r)}if(null!=this.template.getRight(t)){r=this.template.getRight(t);(!r.foreground&&!e||r.foreground&&e)&&i.push(r)}return i},t.prototype.add=function(t){if("undefined"===typeof t){var e=new yi;return this.add(e),e}var i=this.checkPresence(t);this.pdfPages.push(t),this.pagesReferences.add(i),t.setSection(this),t.resetProgress(),this.pageAddedMethod(t)},t.prototype.checkPresence=function(t){for(var e=new Z(t),i=!1,r=this.parent,n=0;n<r.section.length;n++){var o=r.section[n];i=i||o.contains(t)}return e},t.prototype.contains=function(t){var e=this.indexOf(t);return 0<=e},t.prototype.indexOf=function(t){for(var e=0;e<this.pdfPages.length;e++)if(this.pdfPages[e]===t)return this.pdfPages.indexOf(t);var i=new Z(t);return this.pagesReferences.indexOf(i)},t.prototype.pageAddedMethod=function(t){var e=new bi(t);this.onPageAdded(e);var i=this.parent;i.document.pages.onPageAdded(e),this.pageCount.intValue=this.count},t.prototype.onPageAdded=function(t){},t.prototype.getActualBounds=function(t,e,i){if(t instanceof yi&&"boolean"===typeof e){var r=void 0,n=this.parent.document;return r=this.getActualBounds(n,t,e),r}t=t,e=e,i=i;var o=new ct(0,0,0,0);o.height=i?this.pageSettings.size.height:this.pageSettings.getActualSize().height,o.width=i?this.pageSettings.size.width:this.pageSettings.getActualSize().width;var s=this.getLeftIndentWidth(t,e,i),a=this.getTopIndentHeight(t,e,i),h=this.getRightIndentWidth(t,e,i),l=this.getBottomIndentHeight(t,e,i);return o.x+=s,o.y+=a,o.width-=s+h,o.height-=a+l,o},t.prototype.getLeftIndentWidth=function(t,e,i){if(null==t)throw new Error("ArgumentNullException:document");if(null==e)throw new Error("ArgumentNullException:page");var r=i?this.pageSettings.margins.left:0,n=null!=this.template.getLeft(e)?this.template.getLeft(e).width:0,o=null!=t.template.getLeft(e)?t.template.getLeft(e).width:0;return r+=this.template.applyDocumentLeftTemplate?Math.max(n,o):n,r},t.prototype.getTopIndentHeight=function(t,e,i){if(null==t)throw new Error("ArgumentNullException:document");if(null==e)throw new Error("ArgumentNullException:page");var r=i?this.pageSettings.margins.top:0,n=null!=this.template.getTop(e)?this.template.getTop(e).height:0,o=null!=t.template.getTop(e)?t.template.getTop(e).height:0;return r+=this.template.applyDocumentTopTemplate?Math.max(n,o):n,r},t.prototype.getRightIndentWidth=function(t,e,i){if(null==t)throw new Error("ArgumentNullException:document");if(null==e)throw new Error("ArgumentNullException:page");var r=i?this.pageSettings.margins.right:0,n=null!=this.template.getRight(e)?this.template.getRight(e).width:0,o=null!=t.template.getRight(e)?t.template.getRight(e).width:0;return r+=this.template.applyDocumentRightTemplate?Math.max(n,o):n,r},t.prototype.getBottomIndentHeight=function(t,e,i){if(null==t)throw new Error("ArgumentNullException:document");if(null==e)throw new Error("ArgumentNullException:page");var r=i?this.pageSettings.margins.bottom:0,n=null!=this.template.getBottom(e)?this.template.getBottom(e).height:0,o=null!=t.template.getBottom(e)?t.template.getBottom(e).height:0;return r+=this.template.applyDocumentBottomTemplate?Math.max(n,o):n,r},t.prototype.remove=function(t){if(null==t)throw Error('ArgumentNullException("page")');var e=this.pdfPages.indexOf(t);this.pagesReferences.removeAt(e);for(var i=[],r=0;r<e;r++)i.push(this.pdfPages[r]);for(r=e+1;r<this.pdfPages.length;r++)i.push(this.pdfPages[r]);this.pdfPages=i},t.prototype.applyPageSettings=function(t,e,i){var r=new ct(i.origin,i.size);t.items.setValue(this.dictionaryProperties.mediaBox,N.fromRectangle(r));var n=0;n=Oi.rotateFactor*i.rotate;var o=new E(n);t.items.setValue(this.dictionaryProperties.rotate,o)},t.prototype.beginSave=function(t,e){var i=e.document;this.applyPageSettings(this.section,i.pageSettings,t)},t.prototype.drawTemplates=function(t,e,i,r){var n=this.getDocumentTemplates(i,t,r),o=this.getSectionTemplates(t,r);this.drawTemplatesHelper(e,i,n),this.drawTemplatesHelper(e,i,o)},t.prototype.drawTemplatesHelper=function(t,e,i){if(null!=i&&i.length>0)for(var r=i.length,n=0;n<r;n++){var o=i[n];o.draw(t,e)}},t}(),Pi=function(){function t(t){this.pageOrientation=t.pageSettings.orientation,this.pageRotate=t.pageSettings.rotate,this.pageSize=t.pageSettings.size,this.pageOrigin=t.pageSettings.origin}return Object.defineProperty(t.prototype,"orientation",{get:function(){return this.pageOrientation},set:function(t){this.pageOrientation=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rotate",{get:function(){return this.pageRotate},set:function(t){this.pageRotate=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.pageSize},set:function(t){this.pageSize=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"origin",{get:function(){return this.pageOrigin},set:function(t){this.pageOrigin=t},enumerable:!0,configurable:!0}),t}(),Oi=function(){function t(t){this.sections=[],this.dictionaryProperties=new j,this.pdfDocument=t.clone(),this.initialize()}return Object.defineProperty(t.prototype,"section",{get:function(){return this.sections},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"document",{get:function(){return this.pdfDocument},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"count",{get:function(){return this.sections.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"element",{get:function(){return this.pages},enumerable:!0,configurable:!0}),t.prototype.initialize=function(){this.sectionCount=new E(0),this.sectionCollection=new N,this.pages=new B,this.pages.beginSave=new I(this),this.pages.items.setValue(this.dictionaryProperties.type,new T("Pages")),this.pages.items.setValue(this.dictionaryProperties.kids,this.sectionCollection),this.pages.items.setValue(this.dictionaryProperties.count,this.sectionCount),this.pages.items.setValue(this.dictionaryProperties.resources,new B),this.setPageSettings(this.pages,this.pdfDocument.pageSettings)},t.prototype.pdfSectionCollection=function(t){if(t<0||t>=this.count)throw new Error("IndexOutOfRangeException()");return this.sections[t]},t.prototype.setPageSettings=function(t,e){var i=new ct(new lt,e.size);t.items.setValue(this.dictionaryProperties.mediaBox,N.fromRectangle(i))},t.prototype.add=function(t){if("undefined"===typeof t){var e=new xi(this.pdfDocument);return this.add(e),e}var i=this.checkSection(t);return this.sections.push(t),t.parent=this,this.sectionCollection.add(i),this.sections.indexOf(t)},t.prototype.checkSection=function(t){var e=new Z(t);this.sectionCollection.contains(e);return e},t.prototype.countPages=function(){var t=0;return this.sections.forEach(function(e){return t+=e.count}),t},t.prototype.beginSave=function(){this.sectionCount.intValue=this.countPages()},t.rotateFactor=90,t}(),Ti=function(){function t(t){this.pdfPageCollectionIndex=new y,this.document=t}return Object.defineProperty(t.prototype,"count",{get:function(){return this.countPages()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pageCollectionIndex",{get:function(){return this.pdfPageCollectionIndex},enumerable:!0,configurable:!0}),t.prototype.add=function(t){if("undefined"===typeof t){var e=new yi;return this.add(e),e}var i=this.getLastSection();i.add(t)},t.prototype.getLastSection=function(){var t=this.document.sections;0===t.section.length&&t.add();var e=t.section[t.section.length-1];return e},t.prototype.onPageAdded=function(t){},t.prototype.countPages=function(){for(var t=this.document.sections,e=0,i=0;i<t.section.length;i++)e+=t.section[i].count;return e},t.prototype.getPageByIndex=function(t){return this.getPage(t)},t.prototype.getPage=function(t){if(t<0||t>=this.count)throw Error('ArgumentOutOfRangeException("index", "Value can not be less 0")');for(var e=null,i=0,r=0,n=0,o=this.document.sections.count,s=0;s<o;s++){var a=this.document.sections.section[s];if(r=a.count,n=t-i,t>=i&&n<r){e=a.getPages()[n];break}i+=r}return e},t.prototype.indexOf=function(t){var e=-1;if(null==t)throw new Error("ArgumentNullException: page");for(var i=0,r=0,n=this.document.sections.count;r<n;r++){var o=this.document.sections.pdfSectionCollection(r);if(e=o.indexOf(t),e>=0){e+=i;break}e=-1,i+=o.count}return e},t.prototype.remove=function(t){if(null==t)throw Error('ArgumentNullException("page")');for(var e=null,i=0,r=this.document.sections.count;i<r;i++)if(e=this.document.sections.pdfSectionCollection(i),e.pages.contains(t)){e.pages.remove(t);break}return e},t}(),Li=function(){function t(){this.referenceObjects=[],this.pdfFontCollection=new y}return t.prototype.search=function(t){var e=null,i=this.getGroup(t);return null==i?i=this.createNewGroup():i.length>0&&(e=i[0]),i.push(t),e},t.prototype.createNewGroup=function(){var t=[];return this.referenceObjects.push(t),t},t.prototype.getGroup=function(t){var e=null;if(null!==t)for(var i=this.referenceObjects.length,r=0;r<i;r++){if(this.referenceObjects.length>0){var n=this.referenceObjects[r];if(n.length>0){var o=n[0];if(t.equalsTo(o)){e=n;break}}else this.removeGroup(n)}i=this.referenceObjects.length}return e},t.prototype.removeGroup=function(t){if(null!==t){var e=this.referenceObjects.indexOf(t);this.referenceObjects.slice(e,e+1)}},t.prototype.destroy=function(){this.pdfFontCollection=void 0,this.referenceObjects=void 0},t}(),ji=function(){function t(){}return t.getMetrics=function(t,e,i){var r=null;switch(t){case jt.Helvetica:r=this.getHelveticaMetrics(t,e,i);break;case jt.Courier:r=this.getCourierMetrics(t,e,i);break;case jt.TimesRoman:r=this.getTimesMetrics(t,e,i);break;case jt.Symbol:r=this.getSymbolMetrics(t,e,i);break;case jt.ZapfDingbats:r=this.getZapfDingbatsMetrics(t,e,i);break;default:r=this.getHelveticaMetrics(jt.Helvetica,e,i);break}return r.name=t.toString(),r.subScriptSizeFactor=this.subSuperScriptFactor,r.superscriptSizeFactor=this.subSuperScriptFactor,r},t.getHelveticaMetrics=function(t,e,i){var r=new Ae;return(e&Lt.Bold)>0&&(e&Lt.Italic)>0?(r.ascent=this.helveticaBoldItalicAscent,r.descent=this.helveticaBoldItalicDescent,r.postScriptName=this.helveticaBoldItalicName,r.size=i,r.widthTable=new Ne(this.arialBoldWidth),r.height=r.ascent-r.descent):(e&Lt.Bold)>0?(r.ascent=this.helveticaBoldAscent,r.descent=this.helveticaBoldDescent,r.postScriptName=this.helveticaBoldName,r.size=i,r.widthTable=new Ne(this.arialBoldWidth),r.height=r.ascent-r.descent):(e&Lt.Italic)>0?(r.ascent=this.helveticaItalicAscent,r.descent=this.helveticaItalicDescent,r.postScriptName=this.helveticaItalicName,r.size=i,r.widthTable=new Ne(this.arialWidth),r.height=r.ascent-r.descent):(r.ascent=this.helveticaAscent,r.descent=this.helveticaDescent,r.postScriptName=this.helveticaName,r.size=i,r.widthTable=new Ne(this.arialWidth),r.height=r.ascent-r.descent),r},t.getCourierMetrics=function(t,e,i){var r=new Ae;return(e&Lt.Bold)>0&&(e&Lt.Italic)>0?(r.ascent=this.courierBoldItalicAscent,r.descent=this.courierBoldItalicDescent,r.postScriptName=this.courierBoldItalicName,r.size=i,r.widthTable=new Ne(this.fixedWidth),r.height=r.ascent-r.descent):(e&Lt.Bold)>0?(r.ascent=this.courierBoldAscent,r.descent=this.courierBoldDescent,r.postScriptName=this.courierBoldName,r.size=i,r.widthTable=new Ne(this.fixedWidth),r.height=r.ascent-r.descent):(e&Lt.Italic)>0?(r.ascent=this.courierItalicAscent,r.descent=this.courierItalicDescent,r.postScriptName=this.courierItalicName,r.size=i,r.widthTable=new Ne(this.fixedWidth),r.height=r.ascent-r.descent):(r.ascent=this.courierAscent,r.descent=this.courierDescent,r.postScriptName=this.courierName,r.size=i,r.widthTable=new Ne(this.fixedWidth),r.height=r.ascent-r.descent),r},t.getTimesMetrics=function(t,e,i){var r=new Ae;return(e&Lt.Bold)>0&&(e&Lt.Italic)>0?(r.ascent=this.timesBoldItalicAscent,r.descent=this.timesBoldItalicDescent,r.postScriptName=this.timesBoldItalicName,r.size=i,r.widthTable=new Ne(this.timesRomanBoldItalicWidths),r.height=r.ascent-r.descent):(e&Lt.Bold)>0?(r.ascent=this.timesBoldAscent,r.descent=this.timesBoldDescent,r.postScriptName=this.timesBoldName,r.size=i,r.widthTable=new Ne(this.timesRomanBoldWidth),r.height=r.ascent-r.descent):(e&Lt.Italic)>0?(r.ascent=this.timesItalicAscent,r.descent=this.timesItalicDescent,r.postScriptName=this.timesItalicName,r.size=i,r.widthTable=new Ne(this.timesRomanItalicWidth),r.height=r.ascent-r.descent):(r.ascent=this.timesAscent,r.descent=this.timesDescent,r.postScriptName=this.timesName,r.size=i,r.widthTable=new Ne(this.timesRomanWidth),r.height=r.ascent-r.descent),r},t.getSymbolMetrics=function(t,e,i){var r=new Ae;return r.ascent=this.symbolAscent,r.descent=this.symbolDescent,r.postScriptName=this.symbolName,r.size=i,r.widthTable=new Ne(this.symbolWidth),r.height=r.ascent-r.descent,r},t.getZapfDingbatsMetrics=function(t,e,i){var r=new Ae;return r.ascent=this.zapfDingbatsAscent,r.descent=this.zapfDingbatsDescent,r.postScriptName=this.zapfDingbatsName,r.size=i,r.widthTable=new Ne(this.zapfDingbatsWidth),r.height=r.ascent-r.descent,r},t.subSuperScriptFactor=1.52,t.helveticaAscent=931,t.helveticaDescent=-225,t.helveticaName="Helvetica",t.helveticaBoldAscent=962,t.helveticaBoldDescent=-228,t.helveticaBoldName="Helvetica-Bold",t.helveticaItalicAscent=931,t.helveticaItalicDescent=-225,t.helveticaItalicName="Helvetica-Oblique",t.helveticaBoldItalicAscent=962,t.helveticaBoldItalicDescent=-228,t.helveticaBoldItalicName="Helvetica-BoldOblique",t.courierAscent=805,t.courierDescent=-250,t.courierName="Courier",t.courierBoldAscent=801,t.courierBoldDescent=-250,t.courierBoldName="Courier-Bold",t.courierItalicAscent=805,t.courierItalicDescent=-250,t.courierItalicName="Courier-Oblique",t.courierBoldItalicAscent=801,t.courierBoldItalicDescent=-250,t.courierBoldItalicName="Courier-BoldOblique",t.timesAscent=898,t.timesDescent=-218,t.timesName="Times-Roman",t.timesBoldAscent=935,t.timesBoldDescent=-218,t.timesBoldName="Times-Bold",t.timesItalicAscent=883,t.timesItalicDescent=-217,t.timesItalicName="Times-Italic",t.timesBoldItalicAscent=921,t.timesBoldItalicDescent=-218,t.timesBoldItalicName="Times-BoldItalic",t.symbolAscent=1010,t.symbolDescent=-293,t.symbolName="Symbol",t.zapfDingbatsAscent=820,t.zapfDingbatsDescent=-143,t.zapfDingbatsName="ZapfDingbats",t.arialWidth=[278,278,355,556,556,889,667,191,333,333,389,584,278,333,278,278,556,556,556,556,556,556,556,556,556,556,278,278,584,584,584,556,1015,667,667,722,722,667,611,778,722,278,500,667,556,833,722,778,667,778,722,667,611,722,667,944,667,667,611,278,278,278,469,556,333,556,556,500,556,556,278,556,556,222,222,500,222,833,556,556,556,556,333,500,278,556,500,722,500,500,500,334,260,334,584,0,556,0,222,556,333,1e3,556,556,333,1e3,667,333,1e3,0,611,0,0,222,222,333,333,350,556,1e3,333,1e3,500,333,944,0,500,667,0,333,556,556,556,556,260,556,333,737,370,556,584,0,737,333,400,584,333,333,333,556,537,278,333,333,365,556,834,834,834,611,667,667,667,667,667,667,1e3,722,667,667,667,667,278,278,278,278,722,722,778,778,778,778,778,584,778,722,722,722,722,667,667,611,556,556,556,556,556,556,889,500,556,556,556,556,278,278,278,278,556,556,556,556,556,556,556,584,611,556,556,556,556,500,556,500],t.arialBoldWidth=[278,333,474,556,556,889,722,238,333,333,389,584,278,333,278,278,556,556,556,556,556,556,556,556,556,556,333,333,584,584,584,611,975,722,722,722,722,667,611,778,722,278,556,722,611,833,722,778,667,778,722,667,611,722,667,944,667,667,611,333,278,333,584,556,333,556,611,556,611,556,333,611,611,278,278,556,278,889,611,611,611,611,389,556,333,611,556,778,556,556,500,389,280,389,584,0,556,0,278,556,500,1e3,556,556,333,1e3,667,333,1e3,0,611,0,0,278,278,500,500,350,556,1e3,333,1e3,556,333,944,0,500,667,0,333,556,556,556,556,280,556,333,737,370,556,584,0,737,333,400,584,333,333,333,611,556,278,333,333,365,556,834,834,834,611,722,722,722,722,722,722,1e3,722,667,667,667,667,278,278,278,278,722,722,778,778,778,778,778,584,778,722,722,722,722,667,667,611,556,556,556,556,556,556,889,556,556,556,556,556,278,278,278,278,611,611,611,611,611,611,611,584,611,611,611,611,611,556,611,556],t.fixedWidth=[600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600],t.timesRomanWidth=[250,333,408,500,500,833,778,180,333,333,500,564,250,333,250,278,500,500,500,500,500,500,500,500,500,500,278,278,564,564,564,444,921,722,667,667,722,611,556,722,722,333,389,722,611,889,722,722,556,722,667,556,611,722,722,944,722,722,611,333,278,333,469,500,333,444,500,444,500,444,333,500,500,278,278,500,278,778,500,500,500,500,333,389,278,500,500,722,500,500,444,480,200,480,541,0,500,0,333,500,444,1e3,500,500,333,1e3,556,333,889,0,611,0,0,333,333,444,444,350,500,1e3,333,980,389,333,722,0,444,722,0,333,500,500,500,500,200,500,333,760,276,500,564,0,760,333,400,564,300,300,333,500,453,250,333,300,310,500,750,750,750,444,722,722,722,722,722,722,889,667,611,611,611,611,333,333,333,333,722,722,722,722,722,722,722,564,722,722,722,722,722,722,556,500,444,444,444,444,444,444,667,444,444,444,444,444,278,278,278,278,500,500,500,500,500,500,500,564,500,500,500,500,500,500,500,500],t.timesRomanBoldWidth=[250,333,555,500,500,1e3,833,278,333,333,500,570,250,333,250,278,500,500,500,500,500,500,500,500,500,500,333,333,570,570,570,500,930,722,667,722,722,667,611,778,778,389,500,778,667,944,722,778,611,778,722,556,667,722,722,1e3,722,722,667,333,278,333,581,500,333,500,556,444,556,444,333,500,556,278,333,556,278,833,556,500,556,556,444,389,333,556,500,722,500,500,444,394,220,394,520,0,500,0,333,500,500,1e3,500,500,333,1e3,556,333,1e3,0,667,0,0,333,333,500,500,350,500,1e3,333,1e3,389,333,722,0,444,722,0,333,500,500,500,500,220,500,333,747,300,500,570,0,747,333,400,570,300,300,333,556,540,250,333,300,330,500,750,750,750,500,722,722,722,722,722,722,1e3,722,667,667,667,667,389,389,389,389,722,722,778,778,778,778,778,570,778,722,722,722,722,722,611,556,500,500,500,500,500,500,722,444,444,444,444,444,278,278,278,278,500,556,500,500,500,500,500,570,500,556,556,556,556,500,556,500],t.timesRomanItalicWidth=[250,333,420,500,500,833,778,214,333,333,500,675,250,333,250,278,500,500,500,500,500,500,500,500,500,500,333,333,675,675,675,500,920,611,611,667,722,611,611,722,722,333,444,667,556,833,667,722,611,722,611,500,556,722,611,833,611,556,556,389,278,389,422,500,333,500,500,444,500,444,278,500,500,278,278,444,278,722,500,500,500,500,389,389,278,500,444,667,444,444,389,400,275,400,541,0,500,0,333,500,556,889,500,500,333,1e3,500,333,944,0,556,0,0,333,333,556,556,350,500,889,333,980,389,333,667,0,389,556,0,389,500,500,500,500,275,500,333,760,276,500,675,0,760,333,400,675,300,300,333,500,523,250,333,300,310,500,750,750,750,500,611,611,611,611,611,611,889,667,611,611,611,611,333,333,333,333,722,667,722,722,722,722,722,675,722,722,722,722,722,556,611,500,500,500,500,500,500,500,667,444,444,444,444,444,278,278,278,278,500,500,500,500,500,500,500,675,500,500,500,500,500,444,500,444],t.timesRomanBoldItalicWidths=[250,389,555,500,500,833,778,278,333,333,500,570,250,333,250,278,500,500,500,500,500,500,500,500,500,500,333,333,570,570,570,500,832,667,667,667,722,667,667,722,778,389,500,667,611,889,722,722,611,722,667,556,611,722,667,889,667,611,611,333,278,333,570,500,333,500,500,444,500,444,333,500,556,278,278,500,278,778,556,500,500,500,389,389,278,556,444,667,500,444,389,348,220,348,570,0,500,0,333,500,500,1e3,500,500,333,1e3,556,333,944,0,611,0,0,333,333,500,500,350,500,1e3,333,1e3,389,333,722,0,389,611,0,389,500,500,500,500,220,500,333,747,266,500,606,0,747,333,400,570,300,300,333,576,500,250,333,300,300,500,750,750,750,500,667,667,667,667,667,667,944,667,667,667,667,667,389,389,389,389,722,722,722,722,722,722,722,570,722,722,722,722,722,611,611,500,500,500,500,500,500,500,722,444,444,444,444,444,278,278,278,278,500,556,500,500,500,500,500,570,500,556,556,556,556,444,500,444],t.symbolWidth=[250,333,713,500,549,833,778,439,333,333,500,549,250,549,250,278,500,500,500,500,500,500,500,500,500,500,278,278,549,549,549,444,549,722,667,722,612,611,763,603,722,333,631,722,686,889,722,722,768,741,556,592,611,690,439,768,645,795,611,333,863,333,658,500,500,631,549,549,494,439,521,411,603,329,603,549,549,576,521,549,549,521,549,603,439,576,713,686,493,686,494,480,200,480,549,750,620,247,549,167,713,500,753,753,753,753,1042,987,603,987,603,400,549,411,549,549,713,494,460,549,549,549,549,1e3,603,1e3,658,823,686,795,987,768,768,823,768,768,713,713,713,713,713,713,713,768,713,790,790,890,823,549,250,713,603,603,1042,987,603,987,603,494,329,790,790,786,713,384,384,384,384,384,384,494,494,494,494,329,274,686,686,686,384,384,384,384,384,384,494,494,494,-1],t.zapfDingbatsWidth=[278,974,961,974,980,719,789,790,791,690,960,939,549,855,911,933,911,945,974,755,846,762,761,571,677,763,760,759,754,494,552,537,577,692,786,788,788,790,793,794,816,823,789,841,823,833,816,831,923,744,723,749,790,792,695,776,768,792,759,707,708,682,701,826,815,789,789,707,687,696,689,786,787,713,791,785,791,873,761,762,762,759,759,892,892,788,784,438,138,277,415,392,392,668,668,390,390,317,317,276,276,509,509,410,410,234,234,334,334,732,544,544,910,667,760,760,776,595,694,626,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,894,838,1016,458,748,924,748,918,927,928,928,834,873,828,924,924,917,930,931,463,883,836,836,867,867,696,696,874,874,760,946,771,865,771,888,967,888,831,873,927,970,918],t}(),Bi=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},t(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Ii=function(t){function e(i,r,n){var o=t.call(this,r,"undefined"===typeof n?i instanceof e?i.style:Lt.Regular:n)||this;return o.dictionaryProperties=new j,o.encodings=["Unknown","StandardEncoding","MacRomanEncoding","MacExpertEncoding","WinAnsiEncoding","PDFDocEncoding","IdentityH"],o.pdfFontFamily="undefined"===typeof i?jt.Helvetica:i instanceof e?i.fontFamily:i,o.checkStyle(),o.initializeInternals(),o}return Bi(e,t),Object.defineProperty(e.prototype,"fontFamily",{get:function(){return this.pdfFontFamily},enumerable:!0,configurable:!0}),e.prototype.checkStyle=function(){if(this.fontFamily===jt.Symbol||this.fontFamily===jt.ZapfDingbats){var t=this.style;t&=~(Lt.Bold|Lt.Italic),this.setStyle(t)}},e.prototype.getLineWidth=function(t,i){if(null==t)throw new Error("ArgumentNullException:line");var r=0;this.name;t=e.convert(t);for(var n=0,o=t.length;n<o;n++){var s=t[n],a=this.getCharWidthInternal(s,i);r+=a}var h=this.metrics.getSize(i);return r*=re.charSizeMultiplier*h,r=this.applyFormatSettings(t,i,r),r},e.prototype.equalsToFont=function(t){var e=!1,i=t;if(null!=i){var r=this.fontFamily===i.fontFamily,n=~(Lt.Underline|Lt.Strikeout),o=(this.style&n)===(i.style&n);e=r&&o}return e},e.prototype.initializeInternals=function(){ki.cache.search(this);var t=null,e=ji.getMetrics(this.pdfFontFamily,this.style,this.size);this.metrics=e,t=this.createInternals(),this.setInternals(t)},e.prototype.createInternals=function(){var t=new B;if(t.items.setValue(this.dictionaryProperties.type,new T(this.dictionaryProperties.font)),t.items.setValue(this.dictionaryProperties.subtype,new T(this.dictionaryProperties.type1)),t.items.setValue(this.dictionaryProperties.baseFont,new T(this.metrics.postScriptName)),this.fontFamily!==jt.Symbol&&this.fontFamily!==jt.ZapfDingbats){var e=this.encodings[kt.WinAnsiEncoding];t.items.setValue(this.dictionaryProperties.encoding,new T(e))}return t},e.prototype.getCharWidthInternal=function(t,i){var r=0,n=0;n=t.charCodeAt(0),"0"!==this.name&&"1"!==this.name&&"2"!==this.name&&"3"!==this.name&&"4"!==this.name||(n-=e.charOffset),n=n>=0&&128!==n?n:0;var o=this.metrics,s=o.widthTable;return r=s.items(n),r},e.convert=function(t){return t},e.charOffset=32,e}(re),Ri=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},t(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ki=function(t){function e(i){var r=t.call(this)||this;r.defaultMargin=40,r.streamWriter=null,r.document=r;var n=!1;"undefined"===typeof i?(e.cacheCollection=new Li,n=!1):n=i;var o=new b;r.setMainObjectCollection(o);var s=new at;s.isMerging=n,s.document=r,r.setCrossTable(s);var a=new st;return r.setCatalog(a),o.add(a),a.position=-1,r.sectionCollection=new Oi(r),r.documentPageCollection=new Ti(r),a.pages=r.sectionCollection,r}return Ri(e,t),Object.defineProperty(e,"defaultFont",{get:function(){return null==this.defaultStandardFont&&(this.defaultStandardFont=new Ii(jt.Helvetica,8)),this.defaultStandardFont},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sections",{get:function(){return this.sectionCollection},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageSettings",{get:function(){return null==this.settings&&(this.settings=new Gt(this.defaultMargin)),this.settings},set:function(t){this.settings=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pages",{get:function(){return this.documentPageCollection},enumerable:!0,configurable:!0}),Object.defineProperty(e,"cache",{get:function(){return"undefined"===typeof e.cacheCollection||null==e.cacheCollection?new Li:e.cacheCollection},set:function(t){this.cacheCollection=t},enumerable:!0,configurable:!0}),Object.defineProperty(e,"enableCache",{get:function(){return this.isCacheEnabled},set:function(t){this.isCacheEnabled=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"colorSpace",{get:function(){return this.pdfColorSpace===Ct.Rgb||this.pdfColorSpace===Ct.Cmyk||this.pdfColorSpace===Ct.GrayScale?this.pdfColorSpace:Ct.Rgb},set:function(t){t===Ct.Rgb||t===Ct.Cmyk||t===Ct.GrayScale?this.pdfColorSpace=t:this.pdfColorSpace=Ct.Rgb},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"template",{get:function(){return null==this.pageTemplate&&(this.pageTemplate=new vi),this.pageTemplate},set:function(t){this.pageTemplate=t},enumerable:!0,configurable:!0}),e.prototype.docSave=function(t,e,i){if(this.checkPagesPresence(),null===t)throw new Error("ArgumentNullException : stream");this.streamWriter=t;var r=new f(t);if(r.document=this,"boolean"===typeof e&&"undefined"===typeof i)return this.crossTable.save(r);this.crossTable.save(r,e)},e.prototype.checkPagesPresence=function(){0===this.pages.count&&this.pages.add()},e.prototype.destroy=function(){this.catalog=void 0,this.colorSpace=void 0,this.currentSavingObj=void 0,this.documentPageCollection=void 0,this.isStreamCopied=void 0,this.pageSettings=void 0,this.pageTemplate=void 0,this.pdfColorSpace=void 0,this.sectionCollection=void 0,e.cache.destroy(),this.crossTable.pdfObjects.destroy(),e.cache=void 0,this.streamWriter.destroy()},e.defaultStandardFont=null,e.isCacheEnabled=!0,e}(O),Fi=function(){function t(){var t=new Xt(new _t(0,0,0));t.dashStyle=vt.Solid;var e=new Xt(new _t(0,0,0));e.dashStyle=vt.Solid;var i=new Xt(new _t(0,0,0));i.dashStyle=vt.Solid;var r=new Xt(new _t(0,0,0));r.dashStyle=vt.Solid,this.leftPen=t,this.rightPen=e,this.topPen=i,this.bottomPen=r}return Object.defineProperty(t.prototype,"left",{get:function(){return this.leftPen},set:function(t){this.leftPen=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.rightPen},set:function(t){this.rightPen=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.topPen},set:function(t){this.topPen=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.bottomPen},set:function(t){this.bottomPen=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"all",{set:function(t){this.leftPen=this.rightPen=this.topPen=this.bottomPen=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isAll",{get:function(){return this.leftPen===this.rightPen&&this.leftPen===this.topPen&&this.leftPen===this.bottomPen},enumerable:!0,configurable:!0}),Object.defineProperty(t,"default",{get:function(){return new t},enumerable:!0,configurable:!0}),t}(),Mi=function(){function t(t,e,i,r){this.hasLeftPad=!1,this.hasRightPad=!1,this.hasTopPad=!1,this.hasBottomPad=!1,"undefined"===typeof t?(this.leftPad=this.rightPad=5.76,this.bottomPad=this.topPad=.5):(this.leftPad=t,this.rightPad=e,this.topPad=i,this.bottomPad=r,this.hasLeftPad=!0,this.hasRightPad=!0,this.hasTopPad=!0,this.hasBottomPad=!0)}return Object.defineProperty(t.prototype,"left",{get:function(){return this.leftPad},set:function(t){this.leftPad=t,this.hasLeftPad=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.rightPad},set:function(t){this.rightPad=t,this.hasRightPad=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.topPad},set:function(t){this.topPad=t,this.hasTopPad=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.bottomPad},set:function(t){this.bottomPad=t,this.hasBottomPad=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"all",{set:function(t){this.leftPad=this.rightPad=this.topPad=this.bottomPad=t,this.hasLeftPad=!0,this.hasRightPad=!0,this.hasTopPad=!0,this.hasBottomPad=!0},enumerable:!0,configurable:!0}),t}();(function(t){t[t["Overlap"]=0]="Overlap",t[t["Inside"]=1]="Inside"})(Je||(Je={}));var Ai,Ei=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},t(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Ni=function(){function t(){}return Object.defineProperty(t.prototype,"backgroundBrush",{get:function(){return this.gridBackgroundBrush},set:function(t){this.gridBackgroundBrush=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"textBrush",{get:function(){return this.gridTextBrush},set:function(t){this.gridTextBrush=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"textPen",{get:function(){return this.gridTextPen},set:function(t){this.gridTextPen=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"font",{get:function(){return this.gridFont},set:function(t){this.gridFont=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"backgroundImage",{get:function(){return this.gridBackgroundImage},set:function(t){this.gridBackgroundImage=t},enumerable:!0,configurable:!0}),t}(),Di=function(t){function e(){var e=t.call(this)||this;return e.gridBorderOverlapStyle=Je.Overlap,e.bAllowHorizontalOverflow=!1,e.gridHorizontalOverflowType=Ai.LastPage,e}return Ei(e,t),Object.defineProperty(e.prototype,"cellSpacing",{get:function(){return"undefined"===typeof this.gridCellSpacing&&(this.gridCellSpacing=0),this.gridCellSpacing},set:function(t){this.gridCellSpacing=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"horizontalOverflowType",{get:function(){return this.gridHorizontalOverflowType},set:function(t){this.gridHorizontalOverflowType=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"allowHorizontalOverflow",{get:function(){return this.bAllowHorizontalOverflow},set:function(t){this.bAllowHorizontalOverflow=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cellPadding",{get:function(){return"undefined"===typeof this.gridCellPadding&&(this.gridCellPadding=new Mi),this.gridCellPadding},set:function(t){"undefined"===typeof this.gridCellPadding?(this.gridCellPadding=new Mi,this.gridCellPadding=t):this.gridCellPadding=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"borderOverlapStyle",{get:function(){return this.gridBorderOverlapStyle},set:function(t){this.gridBorderOverlapStyle=t},enumerable:!0,configurable:!0}),e}(Ni),Vi=function(t){function e(){var e=t.call(this)||this;return e.gridCellBorders=Fi.default,e}return Ei(e,t),Object.defineProperty(e.prototype,"stringFormat",{get:function(){return this.format},set:function(t){this.format=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"borders",{get:function(){return this.gridCellBorders},set:function(t){this.gridCellBorders=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cellPadding",{get:function(){return this.gridCellPadding},set:function(t){null!=this.gridCellPadding&&"undefined"!==typeof this.gridCellPadding||(this.gridCellPadding=new Mi),this.gridCellPadding=t},enumerable:!0,configurable:!0}),e}(Ni),zi=function(){function t(){}return Object.defineProperty(t.prototype,"backgroundBrush",{get:function(){return this.gridRowBackgroundBrush},enumerable:!0,configurable:!0}),t.prototype.setBackgroundBrush=function(t){if(this.gridRowBackgroundBrush=t,"undefined"!==typeof this.parent)for(var e=0;e<this.parent.cells.count;e++)this.parent.cells.getCell(e).style.backgroundBrush=t},Object.defineProperty(t.prototype,"textBrush",{get:function(){return this.gridRowTextBrush},enumerable:!0,configurable:!0}),t.prototype.setTextBrush=function(t){if(this.gridRowTextBrush=t,"undefined"!==typeof this.parent)for(var e=0;e<this.parent.cells.count;e++)this.parent.cells.getCell(e).style.textBrush=t},Object.defineProperty(t.prototype,"textPen",{get:function(){return this.gridRowTextPen},enumerable:!0,configurable:!0}),t.prototype.setTextPen=function(t){if(this.gridRowTextPen=t,"undefined"!==typeof this.parent)for(var e=0;e<this.parent.cells.count;e++)this.parent.cells.getCell(e).style.textPen=t},Object.defineProperty(t.prototype,"font",{get:function(){return this.gridRowFont},enumerable:!0,configurable:!0}),t.prototype.setFont=function(t){if(this.gridRowFont=t,"undefined"!==typeof this.parent)for(var e=0;e<this.parent.cells.count;e++)this.parent.cells.getCell(e).style.font=t},Object.defineProperty(t.prototype,"border",{get:function(){return"undefined"===typeof this.gridRowBorder&&this.setBorder(new Fi),this.gridRowBorder},enumerable:!0,configurable:!0}),t.prototype.setBorder=function(t){if(this.gridRowBorder=t,"undefined"!==typeof this.parent)for(var e=0;e<this.parent.cells.count;e++)this.parent.cells.getCell(e).style.borders=t},t.prototype.setParent=function(t){this.parent=t},Object.defineProperty(t.prototype,"backgroundImage",{get:function(){return this.gridRowBackgroundImage},enumerable:!0,configurable:!0}),t.prototype.setBackgroundImage=function(t){this.gridRowBackgroundImage=t},t}();(function(t){t[t["NextPage"]=0]="NextPage",t[t["LastPage"]=1]="LastPage"})(Ai||(Ai={}));var Gi=function(){function t(t){this.layoutElement=t}return Object.defineProperty(t.prototype,"elements",{get:function(){return this.layoutElement},enumerable:!0,configurable:!0}),t.prototype.getElement=function(){return this.layoutElement},t.prototype.layout=function(t){return this.layoutInternal(t)},t.prototype.Layouter=function(t){return this.layoutInternal(t)},t.prototype.getNextPage=function(t){var e=t.section,i=e.add();return i},t.prototype.getPaginateBounds=function(t){if(null==t)throw new Error("ArgumentNullException : param");var e=t.format.usePaginateBounds?t.format.paginateBounds:new ct(t.bounds.x,0,t.bounds.width,t.bounds.height);return e},t}(),Wi=function(){function t(t){"undefined"===typeof t||(this.break=t.break,this.layout=t.layout,this.paginateBounds=t.paginateBounds,this.boundsSet=t.usePaginateBounds)}return Object.defineProperty(t.prototype,"layout",{get:function(){return this.layoutType},set:function(t){this.layoutType=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"break",{get:function(){return this.breakType},set:function(t){this.breakType=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"paginateBounds",{get:function(){return"undefined"===typeof this.layoutPaginateBounds&&null==this.layoutPaginateBounds&&(this.layoutPaginateBounds=new ct(0,0,0,0)),this.layoutPaginateBounds},set:function(t){this.layoutPaginateBounds=t,this.boundsSet=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"usePaginateBounds",{get:function(){return this.boundsSet},enumerable:!0,configurable:!0}),t}(),Hi=function(){function t(){}return Object.defineProperty(t.prototype,"page",{get:function(){return this.pdfPage},set:function(t){this.pdfPage=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bounds",{get:function(){return new ct(this.layoutBounds.x,this.layoutBounds.y,this.layoutBounds.width,this.layoutBounds.height)},set:function(t){this.layoutBounds=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"format",{get:function(){return this.layoutFormat},set:function(t){this.layoutFormat=t},enumerable:!0,configurable:!0}),t}(),_i=function(){function t(t,e){this.pdfPage=t,this.layoutBounds=e}return Object.defineProperty(t.prototype,"page",{get:function(){return this.pdfPage},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bounds",{get:function(){return this.layoutBounds},enumerable:!0,configurable:!0}),t}(),Ui=function(){function t(){}return Object.defineProperty(t.prototype,"raiseBeginPageLayout",{get:function(){return"undefined"!==typeof this.beginPageLayout},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"raiseEndPageLayout",{get:function(){return"undefined"!==typeof this.endPageLayout},enumerable:!0,configurable:!0}),t.prototype.onBeginPageLayout=function(t){this.beginPageLayout&&this.beginPageLayout(this,t)},t.prototype.onEndPageLayout=function(t){this.endPageLayout&&this.endPageLayout(this,t)},t.prototype.drawHelper=function(t,e,i,r){if(e instanceof lt&&"undefined"===typeof e.width&&"undefined"===typeof i)return this.drawHelper(t,e.x,e.y);if("number"===typeof e&&"number"===typeof i&&"undefined"===typeof r)return this.drawHelper(t,e,i,null);if(e instanceof ct&&"undefined"!==typeof e.width&&"undefined"===typeof i)return this.drawHelper(t,e,null);if(e instanceof lt&&"undefined"===typeof e.width&&i instanceof Wi)return this.drawHelper(t,e.x,e.y,i);if("number"===typeof e&&"number"===typeof i&&(r instanceof Wi||null==r)){var n=t.graphics.clientSize.width-e,o=new ct(e,i,n,0);return this.drawHelper(t,o,r)}if(e instanceof ct&&"undefined"!==typeof e.width&&"boolean"===typeof i)return this.bEmbedFonts=i,this.drawHelper(t,e,null);var s=new Hi,a=e,h=i;if(s.page=t,s.bounds=a,null!=s){var l=s.bounds.x,u=s.bounds.y;0===s.bounds.x&&(l=Fi.default.right.width/2),0===s.bounds.y&&(u=Fi.default.top.width/2);var c=new ct(l,u,s.bounds.width,s.bounds.height);s.bounds=c}s.format=null!=h?h:new Wi;var p=this.layout(s);return p},t}(),qi=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},t(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Ki=function(t){function e(e){return t.call(this,e)||this}return qi(e,t),Object.defineProperty(e.prototype,"element",{get:function(){return t.prototype.getElement.call(this)},enumerable:!0,configurable:!0}),e.prototype.layoutInternal=function(t){this.format=null!==this.element.stringFormat&&"undefined"!==typeof this.element.stringFormat?this.element.stringFormat:null;var e=t.page,i=t.bounds,r=this.element.value,n=null,o=new Xi;for(o.page=e,o.remainder=r;;){o=this.layoutOnPage(r,e,i,t),n=this.getLayoutResult(o);break}return n},e.prototype.getLayoutResult=function(t){var e=new Ji(t.page,t.bounds,t.remainder,t.lastLineBounds);return e},e.prototype.layoutOnPage=function(t,e,i,r){var n=new Xi;n.remainder=t,n.page=e,i=this.checkCorrectBounds(e,i);var o=new Qt,s=o.layout(t,this.element.font,this.format,i,e.getClientSize().height,!1,new ut(0,0)),a=null==s.remainder,h=r.format.break===ee.FitElement,l=(h||s.empty,e.graphics),u=this.element.getBrush();this.element instanceof lr&&(u.color=new _t(0,0,255)),l.drawStringLayoutResult(s,this.element.font,this.element.pen,u,i,this.format);s.lines[s.lineCount-1];return n.lastLineBounds=l.getLineBounds(s.lineCount-1,s,this.element.font,i,this.format),n.bounds=this.getTextPageBounds(e,i,s),n.remainder=s.remainder,n.end=a,n},e.prototype.checkCorrectBounds=function(t,e){var i=t.graphics.clientSize;return e.height=e.height>0?e.height:i.height-e.y,e},e.prototype.getTextPageBounds=function(t,e,i){var r=i.actualSize,n=e.x,o=e.y,s=e.width>0?e.width:r.width,a=r.height,h=t.graphics.checkCorrectLayoutRectangle(r,e.x,e.y,this.format);n=h.x;var l=t.graphics.getTextVerticalAlignShift(r.height,e.height,this.format);o+=l;var u=new ct(n,o,s,a);return u},e}(Gi),Xi=function(){function t(){}return t}(),Ji=function(t){function e(e,i,r,n){var o=t.call(this,e,i)||this;return o.remainderText=r,o.lastLineTextBounds=n,o}return qi(e,t),Object.defineProperty(e.prototype,"remainder",{get:function(){return this.remainderText},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lastLineBounds",{get:function(){return this.lastLineTextBounds},enumerable:!0,configurable:!0}),e}(_i),Yi=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},t(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Qi=function(t){function e(e,i,r,n,o){var s=t.call(this)||this;return s.content="",s.elementValue="",s.hasPointOverload=!1,s.isPdfTextElement=!1,"undefined"===typeof e||("string"===typeof e&&"undefined"===typeof i?(s.content=e,s.elementValue=e):"string"===typeof e&&i instanceof re&&"undefined"===typeof r?(s.content=e,s.elementValue=e,s.pdfFont=i):"string"===typeof e&&i instanceof re&&r instanceof Xt&&"undefined"===typeof n?(s.content=e,s.elementValue=e,s.pdfFont=i,s.pdfPen=r):"string"===typeof e&&i instanceof re&&r instanceof Ut&&"undefined"===typeof n?(s.content=e,s.elementValue=e,s.pdfFont=i,s.pdfBrush=r):(s.content=e,s.elementValue=e,s.pdfFont=i,s.pdfPen=r,s.pdfBrush=n,s.format=o)),s}return Yi(e,t),Object.defineProperty(e.prototype,"text",{get:function(){return this.content},set:function(t){this.elementValue=t,this.content=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this.elementValue},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pen",{get:function(){return this.pdfPen},set:function(t){this.pdfPen=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"brush",{get:function(){return this.pdfBrush},set:function(t){this.pdfBrush=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"font",{get:function(){return this.pdfFont},set:function(t){this.pdfFont=t,this.pdfFont instanceof Ii&&null!=this.content?this.elementValue=Ii.convert(this.content):this.elementValue=this.content},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stringFormat",{get:function(){return this.format},set:function(t){this.format=t},enumerable:!0,configurable:!0}),e.prototype.getBrush=function(){return null==this.pdfBrush||"undefined"===typeof this.pdfBrush?new Kt(new _t(0,0,0)):this.pdfBrush},e.prototype.layout=function(t){var e=new Ki(this),i=e.layout(t);return i},e.prototype.drawText=function(t,e,i,r){if(e instanceof lt&&"undefined"===typeof e.width&&"undefined"===typeof i)return this.hasPointOverload=!0,this.drawText(t,e.x,e.y);if("number"===typeof e&&"number"===typeof i&&"undefined"===typeof r)return this.hasPointOverload=!0,this.drawText(t,e,i,null);if(e instanceof ct&&"undefined"!==typeof e.width&&"undefined"===typeof i)return this.drawText(t,e,null);if(e instanceof lt&&"undefined"===typeof e.width&&i instanceof Wi)return this.hasPointOverload=!0,this.drawText(t,e.x,e.y,i);if("number"===typeof e&&"number"===typeof i&&(r instanceof Wi||null==r)){this.hasPointOverload=!0;var n=t.graphics.clientSize.width-e,o=new ct(e,i,n,0);return this.drawText(t,o,r)}if(e instanceof ct&&"undefined"!==typeof e.width&&"boolean"===typeof i)return this.drawText(t,e,null);var s=new Qt;if(this.hasPointOverload){var a=s.layout(this.value,this.font,this.stringFormat,new ut(t.graphics.clientSize.width-e.x,0),!0,t.graphics.clientSize),h=void 0,l=new Hi,u=e,c=i;l.page=t;if(l.bounds=u,l.format=null!=c?c:new Wi,a.lines.length>1){if(this.text=a.layoutLines[0].text,l.bounds.y<=l.page.graphics.clientSize.height){var p=new lt(l.bounds.x,l.bounds.y);h=this.layout(l);for(var d=new ct(0,h.bounds.y+a.lineHeight,t.graphics.clientSize.width,a.lineHeight),f=1;f<a.lines.length;f++)if(l.page=h.page,l.bounds=new ct(new lt(d.x,d.y),new ut(d.width,d.height)),this.text=a.layoutLines[f].text,d.y+a.lineHeight>h.page.graphics.clientSize.height&&(!0,l.page=l.page.graphics.getNextPage(),d=p.y>h.page.graphics.clientSize.height-h.bounds.height?new ct(0,h.bounds.height,h.page.graphics.clientSize.width,a.lineHeight):new ct(0,0,h.page.graphics.clientSize.width,a.lineHeight),l.bounds=d),h=this.layout(l),f!==a.lines.length-1)d=new ct(0,h.bounds.y+a.lineHeight,h.page.graphics.clientSize.width,a.lineHeight);else{var g=this.font.measureString(this.text,this.format).width;h=this.calculateResultBounds(h,g,h.page.graphics.clientSize.width,0)}}return h}var m=this.font.measureString(this.text,this.format);return l.bounds.y<=l.page.graphics.clientSize.height&&(h=this.layout(l),h=this.calculateResultBounds(h,m.width,h.page.graphics.clientSize.width,0)),h}h=s.layout(this.value,this.font,this.stringFormat,new ut(e.width,0),!1,t.graphics.clientSize);var y=void 0;l=new Hi,u=e,c=i;if(l.page=t,l.bounds=u,l.format=null!=c?c:new Wi,h.lines.length>1){if(this.text=h.layoutLines[0].text,l.bounds.y<=l.page.graphics.clientSize.height){p=new lt(l.bounds.x,l.bounds.y);y=this.layout(l);for(d=new ct(u.x,y.bounds.y+h.lineHeight,u.width,h.lineHeight),f=1;f<h.lines.length;f++)if(l.page=y.page,l.bounds=new ct(d.x,d.y,d.width,d.height),this.text=h.layoutLines[f].text,d.y+h.lineHeight>y.page.graphics.clientSize.height&&(!0,l.page=l.page.graphics.getNextPage(),d=p.y>y.page.graphics.clientSize.height-y.bounds.height?new ct(u.x,h.lineHeight,u.width,h.lineHeight):new ct(u.x,0,u.width,h.lineHeight),l.bounds=d),y=this.layout(l),f!==h.lines.length-1)d=new ct(u.x,y.bounds.y+h.lineHeight,u.width,h.lineHeight);else{g=this.font.measureString(this.text,this.format).width;y=this.calculateResultBounds(y,g,u.width,u.x)}}return y}m=this.font.measureString(this.text,this.format);return l.bounds.y<=l.page.graphics.clientSize.height&&(y=this.layout(l),y=this.calculateResultBounds(y,m.width,u.width,u.x)),y},e.prototype.calculateResultBounds=function(t,e,i,r){return null!=this.stringFormat&&"undefined"!==typeof this.stringFormat&&this.stringFormat.alignment===mt.Center?(t.bounds.x=r+(i-e)/2,t.bounds.width=e):null!=this.stringFormat&&"undefined"!==typeof this.stringFormat&&this.stringFormat.alignment===mt.Right?(t.bounds.x=r+(i-e),t.bounds.width=e):null!=this.stringFormat&&"undefined"!==typeof this.stringFormat&&this.stringFormat.alignment===mt.Justify?(t.bounds.x=r,t.bounds.width=i):(t.bounds.width=r,t.bounds.width=e),t},e}(Ui),Zi=function(){function t(t){this.dictionaryProperties=new j,this.pdfColor=new _t(255,255,255),this.rectangle=new ct(0,0,0,0),this.pdfPage=null,this.textBrush=new Kt(new _t(0,0,0)),this.textFont=new Ii(jt.TimesRoman,10),this.format=new Jt(mt.Left),this.content="",this.pdfDictionary=new B,this.internalColor=new _t,this.darkness=1,"undefined"===typeof t?this.initialize():(this.initialize(),this.bounds=t)}return Object.defineProperty(t.prototype,"color",{get:function(){return this.pdfColor},set:function(t){this.pdfColor=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"innerColor",{get:function(){return this.internalColor},set:function(t){this.internalColor=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bounds",{get:function(){return this.rectangle},set:function(t){this.rectangle=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"page",{get:function(){return this.pdfPage},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"font",{get:function(){return this.textFont},set:function(t){this.textFont=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"stringFormat",{get:function(){return this.format},set:function(t){this.format=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"brush",{get:function(){return this.textBrush},set:function(t){this.textBrush=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this.content},set:function(t){this.content=t,this.dictionary.items.setValue(this.dictionaryProperties.contents,new Y(this.content))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dictionary",{get:function(){return this.pdfDictionary},set:function(t){this.pdfDictionary=t},enumerable:!0,configurable:!0}),t.prototype.initialize=function(){this.pdfDictionary.annotationBeginSave=new F(this),this.pdfDictionary.items.setValue(this.dictionaryProperties.type,new T(this.dictionaryProperties.annot))},t.prototype.setPage=function(t){this.pdfPage=t,this.pdfDictionary.items.setValue(this.dictionaryProperties.p,new Z(this.pdfPage))},t.prototype.beginSave=function(){this.save()},t.prototype.save=function(){var t=new ct(this.rectangle.x,this.rectangle.y,this.rectangle.width,this.rectangle.height),e=this.pdfPage.section,i=t.height,r=e.pointToNativePdf(this.page,new lt(t.x,t.y));t.x=r.x,t.width=r.x+t.width,t.y=r.y-this.page.document.pageSettings.margins.top,t.height=t.y-i,this.pdfDictionary.items.setValue(this.dictionaryProperties.rect,N.fromRectangle(t)),this.dictionary.items.setValue(this.dictionaryProperties.ca,new E(this.darkness))},Object.defineProperty(t.prototype,"element",{get:function(){return this.pdfDictionary},enumerable:!0,configurable:!0}),t}(),$i=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},t(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),tr=function(t){function e(e){return t.call(this,e)||this}return $i(e,t),e.prototype.initialize=function(){t.prototype.initialize.call(this),this.dictionary.items.setValue(this.dictionaryProperties.subtype,new T(this.dictionaryProperties.link))},e}(Zi),er=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},t(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ir=function(t){function e(e){var i=t.call(this,e)||this;return i.pdfAction=null,i}return er(e,t),e.prototype.getSetAction=function(t){if("undefined"===typeof t)return this.pdfAction;this.pdfAction=t},e}(tr),rr=function(){function t(){this.action=null,this.dictionaryProperties=new j,this.initialize()}return Object.defineProperty(t.prototype,"next",{get:function(){return this.action},set:function(t){this.action=t,this.dictionary.items.setValue(this.dictionaryProperties.next,new Z(this.action))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dictionary",{get:function(){return"undefined"===typeof this.pdfDictionary&&(this.pdfDictionary=new B),this.pdfDictionary},enumerable:!0,configurable:!0}),t.prototype.initialize=function(){this.dictionary.items.setValue(this.dictionaryProperties.type,new T(this.dictionaryProperties.action))},Object.defineProperty(t.prototype,"element",{get:function(){return this.dictionary},enumerable:!0,configurable:!0}),t}(),nr=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},t(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),or=function(t){function e(e){var i=t.call(this)||this;return i.uniformResourceIdentifier="",i}return nr(e,t),Object.defineProperty(e.prototype,"uri",{get:function(){return this.uniformResourceIdentifier},set:function(t){this.uniformResourceIdentifier=t,this.dictionary.items.setValue(this.dictionaryProperties.uri,new Y(this.uniformResourceIdentifier))},enumerable:!0,configurable:!0}),e.prototype.initialize=function(){t.prototype.initialize.call(this),this.dictionary.items.setValue(this.dictionaryProperties.s,new T(this.dictionaryProperties.uri))},e}(rr),sr=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},t(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ar=function(t){function e(e,i){var r=t.call(this,e)||this;return"undefined"!==typeof i&&(r.uri=i),r}return sr(e,t),Object.defineProperty(e.prototype,"uriAction",{get:function(){return"undefined"===typeof this.pdfUriAction&&(this.pdfUriAction=new or),this.pdfUriAction},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"uri",{get:function(){return this.uriAction.uri},set:function(t){this.uriAction.uri!==t&&(this.uriAction.uri=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"action",{get:function(){return this.getSetAction()},set:function(t){this.getSetAction(t),this.uriAction.next=t},enumerable:!0,configurable:!0}),e.prototype.initialize=function(){t.prototype.initialize.call(this),this.dictionary.items.setValue(this.dictionaryProperties.subtype,new T(this.dictionaryProperties.link));this.uriAction.element;this.dictionary.items.setValue(this.dictionaryProperties.a,this.uriAction.element)},e}(ir),hr=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},t(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),lr=function(t){function e(){var e=t.call(this)||this;e.uniformResourceLocator="",e.uriAnnotation=null,e.recalculateBounds=!1,e.defaultBorder=new N;for(var i=0;i<3;i++)e.defaultBorder.add(new E(0));return e}return hr(e,t),Object.defineProperty(e.prototype,"url",{get:function(){return this.uniformResourceLocator},set:function(t){if(0===t.length)throw new Error("ArgumentException : Url - string can not be empty");this.uniformResourceLocator=t},enumerable:!0,configurable:!0}),e.prototype.draw=function(t,e){if(t instanceof yi){var i=new Qt,r=this.font.style;if(e instanceof lt){this.recalculateBounds=!0,this.font.style=Lt.Underline;var n=i.layout(this.value,this.font,this.stringFormat,new ut(t.graphics.clientSize.width-e.x,0),!0,t.graphics.clientSize);if(1===n.lines.length){var o=this.font.measureString(this.value),s=new ct(e,o);s=this.calculateBounds(s,o.width,t.graphics.clientSize.width,e.x),this.uriAnnotation=new ar(s,this.url),this.uriAnnotation.dictionary.items.setValue("Border",this.defaultBorder),t.annotations.add(this.uriAnnotation);var a=this.drawText(t,e);return this.font.style=r,a}a=this.drawMultipleLineWithPoint(n,t,e);return this.font.style=r,a}n=i.layout(this.value,this.font,this.stringFormat,new ut(e.width,0),!1,new ut(0,0));if(this.font.style=Lt.Underline,1===n.lines.length){o=this.font.measureString(this.value),s=new ct(new lt(e.x,e.y),o);s=this.calculateBounds(s,o.width,e.width,e.x),this.uriAnnotation=new ar(s,this.url),this.uriAnnotation.dictionary.items.setValue("Border",this.defaultBorder),t.annotations.add(this.uriAnnotation);var h=this.drawText(t,e);return this.font.style=r,h}h=this.drawMultipleLineWithBounds(n,t,e);return this.font.style=r,h}var l=new yi;return l=t.page,this.draw(l,e)},e.prototype.drawMultipleLineWithPoint=function(t,e,i){for(var r,n=0;n<t.layoutLines.length;n++){var o=this.font.measureString(t.lines[n].text),s=new ct(i,o);if(0!==n&&(s.x=0),this.text=t.lines[n].text,s.y+o.height>e.graphics.clientSize.height){if(0===n)break;e=e.graphics.getNextPage(),s=new ct(0,0,e.graphics.clientSize.width,o.height),i.y=0}s=this.calculateBounds(s,o.width,e.graphics.clientSize.width,s.x),this.uriAnnotation=new ar(s,this.url),this.uriAnnotation.dictionary.items.setValue("Border",this.defaultBorder),e.annotations.add(this.uriAnnotation),r=0!==n?this.drawText(e,new lt(0,s.y)):this.drawText(e,s.x,s.y),i.y+=o.height}return r},e.prototype.drawMultipleLineWithBounds=function(t,e,i){for(var r,n=0;n<t.layoutLines.length;n++){var o=this.font.measureString(t.lines[n].text),s=new ct(new lt(i.x,i.y),o);if(s=this.calculateBounds(s,o.width,i.width,i.x),this.text=t.lines[n].text,i.y+o.height>e.graphics.clientSize.height){if(0===n)break;e=e.graphics.getNextPage(),i=new ct(i.x,0,i.width,o.height),s.y=0}this.uriAnnotation=new ar(s,this.url),this.uriAnnotation.dictionary.items.setValue("Border",this.defaultBorder),e.annotations.add(this.uriAnnotation),r=this.drawText(e,i),i.y+=o.height}return r},e.prototype.calculateBounds=function(t,e,i,r){return null!=this.stringFormat&&"undefined"!==typeof this.stringFormat&&this.stringFormat.alignment===mt.Center?(t.x=r+(i-e)/2,t.width=e):null!=this.stringFormat&&"undefined"!==typeof this.stringFormat&&this.stringFormat.alignment===mt.Right?(t.x=r+(i-e),t.width=e):null!=this.stringFormat&&"undefined"!==typeof this.stringFormat&&this.stringFormat.alignment===mt.Justify?(t.x=r,t.width=i):(t.width=r,t.width=e),t},e}(Qi),ur=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},t(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),cr=function(t){function e(e){var i=t.call(this,e)||this;return i.gridInitialWidth=0,i.gridSize=new ut(0,0),i.parentCellIndex=0,i.tempWidth=0,i.childheight=0,i.isChildGrid=!1,i.hasRowSpanSpan=!1,i.isRearranged=!1,i.pageBounds=new ct,i.listOfNavigatePages=[],i.flag=!0,i.columnRanges=[],i.currentLocation=new lt(0,0),i.breakRow=!0,i.slr=null,i.remainderText=null,i.isPaginate=!1,i.isOverloadWithPosition=!1,i}return ur(e,t),Object.defineProperty(e.prototype,"Grid",{get:function(){return this.elements},enumerable:!0,configurable:!0}),e.prototype.getFormat=function(t){var e=t;return e},e.prototype.layoutInternal=function(t){var e=this.getFormat(t.format);if(this.gridLayoutFormat=this.getFormat(t.format),this.currentPage=t.page,null===this.currentPage)throw Error("Can not set page as null");this.currentPage.getClientSize().height,this.currentPage.getClientSize().width;this.currentPageBounds=this.currentPage.getClientSize(),this.currentGraphics=this.currentPage.graphics;var i=0;if(i=this.currentGraphics.page.section.indexOf(this.currentGraphics.page),this.listOfNavigatePages.push(i),null!=e&&e.break===ee.FitColumnsToPage?this.currentBounds=new ct(new lt(t.bounds.x,t.bounds.y),new ut(this.Grid.columns.width,this.currentGraphics.clientSize.height)):this.currentBounds=new ct(new lt(t.bounds.x,t.bounds.y),this.currentGraphics.clientSize),0!==this.Grid.rows.count)this.currentBounds.width=t.bounds.width>0?t.bounds.width:this.currentBounds.width-this.Grid.rows.getRow(0).cells.getCell(0).style.borders.left.width/2;else{if(0===this.Grid.headers.count)throw Error("Please add row or header into grid");this.currentBounds.width=t.bounds.width}if(this.startLocation=new lt(t.bounds.x,t.bounds.y),t.bounds.height>0&&!this.Grid.isChildGrid&&(this.currentBounds.height=t.bounds.height),this.Grid.isChildGrid||(this.hType=this.Grid.style.horizontalOverflowType),this.Grid.style.allowHorizontalOverflow?(this.Grid.measureColumnsWidth(),this.determineColumnDrawRanges()):(this.columnRanges=[],"undefined"!==typeof this.Grid.isChildGrid&&(this.Grid.isChildGrid,1)?this.Grid.measureColumnsWidth(this.currentBounds):this.Grid.measureColumnsWidth(new ct(this.currentBounds.x,this.currentBounds.y,this.currentBounds.x+this.currentBounds.width,this.currentBounds.height)),this.columnRanges.push([0,this.Grid.columns.count-1])),this.Grid.hasRowSpanSpan)for(var r=0;r<this.Grid.rows.count;r++)-1===this.Grid.rows.getRow(r).height||this.Grid.rows.getRow(r).isRowHeightSet||(this.Grid.rows.getRow(r).isRowHeightSet=!0);var n=this.layoutOnPage(t);return n},e.prototype.determineColumnDrawRanges=function(){for(var t=0,e=0,i=0,r=this.currentGraphics.clientSize.width-this.currentBounds.x,n=0;n<this.Grid.columns.count;n++)if(i+=this.Grid.columns.getColumn(n).width,i>=r){for(var o=0,s=t;s<=n;s++){if(o+=this.Grid.columns.getColumn(s).width,o>r)break;e=s}this.columnRanges.push([t,e]),t=e+1,e=t,i=e<=n?this.Grid.columns.getColumn(n).width:0}this.columnRanges.push([t,this.Grid.columns.count-1])},e.prototype.layoutOnPage=function(t){this.pageBounds.x=t.bounds.x,this.pageBounds.y=t.bounds.y,this.pageBounds.height=t.bounds.height;for(var i=this.getFormat(t.format),r=null,n=null,o=new ae,s=t.page,a=[],h=0;h<this.columnRanges.length;h++){var l=this.columnRanges[h];this.cellStartIndex=l[0],this.cellEndIndex=l[1];var u=this.raiseBeforePageLayout(this.currentPage,this.currentBounds,this.currentRowIndex);this.currentBounds=u.currentBounds,this.currentRowIndex=u.currentRowIndex;for(var c=void 0,p=0;p<this.Grid.headers.count;p++){var d=this.Grid.headers.getHeader(p),f=this.currentBounds.y;if(this.isHeader=!0,s!=this.currentPage)for(var g=this.cellStartIndex;g<=this.cellEndIndex;g++)d.cells.getCell(g).isCellMergeContinue&&(d.cells.getCell(g).isCellMergeContinue=!1,d.cells.getCell(g).value="");var m=this.drawRow(d);f===this.currentBounds.y?(c=!0,-1===e.repeatRowIndex&&(e.repeatRowIndex=p)):c=!1,!m.isFinish&&null!==s&&i.layout!==te.OnePage&&c&&(this.startLocation.x=this.currentBounds.x,this.currentPage=this.getNextPageformat(i),this.startLocation.y=this.currentBounds.y,"undefined"!==typeof i.paginateBounds&&0===i.paginateBounds.x&&0===i.paginateBounds.y&&0===i.paginateBounds.width&&0===i.paginateBounds.height&&(this.currentBounds.x+=this.startLocation.x),this.drawRow(d)),this.isHeader=!1}var y=0,b=(this.Grid.rows.count,void 0),w=!0;a=[];for(var v=0;v<this.Grid.rows.count;v++){d=this.Grid.rows.getRow(v);y++,this.currentRowIndex=y-1;var S=this.currentBounds.y;s=this.currentPage,e.repeatRowIndex=-1,w&&d.grid.isChildGrid&&(S,w=!1);var C=null;if(-1==this.Grid.splitChildRowIndex)C=this.drawRow(d),d.isrowFinish=!0;else{if(!(d.grid.ParentCell.row.grid.isGridSplit&&this.Grid.splitChildRowIndex<=d.rowIndex)){if(d.isrowFinish)continue;break}C=this.drawRow(d),d.isrowFinish=!0}a.push(C.bounds.width),S===this.currentBounds.y?(b=!0,e.repeatRowIndex=this.Grid.rows.rowCollection.indexOf(d)):(b=!1,e.repeatRowIndex=-1);while(!C.isFinish&&null!=s){var x=this.getLayoutResult();if(r=this.raisePageLayouted(x),r.cancel||b)break;if(this.Grid.allowRowBreakAcrossPages){this.currentPage=this.getNextPageformat(i),S=this.currentBounds.y;var P=new lt(Fi.default.right.width/2,Fi.default.top.width/2);if(0===i.paginateBounds.x&&0===i.paginateBounds.y&&0===i.paginateBounds.width&&0===i.paginateBounds.height&&this.startLocation.x===P.x&&this.startLocation.y===P.y&&(this.currentBounds.x+=this.startLocation.x,this.currentBounds.y+=this.startLocation.y),this.isPaginate&&(this.startLocation.y=this.currentBounds.y,this.isPaginate=!1),this.Grid.isChildGrid&&null!=d.grid.ParentCell&&null!=this.Grid.ParentCell.row.grid.style.cellPadding&&d.rowBreakHeight+this.Grid.ParentCell.row.grid.style.cellPadding.top<this.currentBounds.height&&(this.currentBounds.y=this.Grid.ParentCell.row.grid.style.cellPadding.top),null!=d.grid.ParentCell){d.grid.ParentCell.row.isRowBreaksNextPage=!0,d.grid.ParentCell.row.rowBreakHeightValue=d.rowBreakHeight+this.Grid.ParentCell.row.grid.style.cellPadding.top+this.Grid.ParentCell.row.grid.style.cellPadding.bottom;for(var O=d.rowIndex+1;O<d.grid.rows.count;O++)d.grid.ParentCell.row.rowBreakHeightValue+=d.grid.rows.getRow(O).height}if(d.grid.isChildGrid){d.isrowFinish=!1,d.grid.splitChildRowIndex=d.rowIndex,d.grid.ParentCell.row.grid.splitChildRowIndex=d.grid.ParentCell.row.rowIndex,d.grid.ParentCell.row.grid.isGridSplit&&(d.grid.ParentCell.row.noOfPageCount+=1,d.grid.ParentCell.row.grid.isGridSplit=!1);break}if(d.noOfPageCount<1){if(-1!=d.grid.splitChildRowIndex&&(d.grid.isGridSplit=!0),null!=d.style.border&&(null!=d.style.border.left&&1!==d.style.border.left.width||null!=d.style.border.top&&1!==d.style.border.top.width)){var T=d.style.border.left.width/2,L=d.style.border.top.width/2;if(this.currentBounds.x===Fi.default.right.width/2&&this.currentBounds.y===Fi.default.right.width/2){var j=new ct(T,L,this.currentBounds.width,this.currentBounds.height);this.currentBounds=j}}if(this.Grid.repeatHeader)for(var B=0;B<this.Grid.headers.count;B++){var I=this.Grid.headers.getHeader(B);this.drawRow(I)}if(C=this.drawRow(d),d.noOfPageCount>=1){d.rowBreakHeightValue;for(var R=0;R<d.noOfPageCount;R++){var k=this.getLayoutResult();if(r=this.raisePageLayouted(k),this.currentPage=this.getNextPageformat(i),S=this.currentBounds.y,-1!=d.grid.splitChildRowIndex&&(d.grid.isGridSplit=!0),this.currentBounds.y=.5,this.Grid.repeatHeader)for(var F=0;F<this.Grid.headers.count;F++){var M=this.Grid.headers.getHeader(F);this.drawRow(M)}this.drawRow(d)}}d.grid.splitChildRowIndex=-1,d.grid.isGridSplit=!1,C.isFinish=this.checkIsFisished(d);for(var A=0;A<d.cells.count;A++)d.cells.getCell(A).value instanceof Rr&&(d.cells.getCell(A).value.splitChildRowIndex=-1)}}}if(!C.isFinish&&null!==s&&i.layout!==te.OnePage&&b){this.startLocation.x=this.currentBounds.x;if(this.currentPage=this.getNextPageformat(i),this.raiseBeforePageLayout(this.currentPage,this.currentBounds,this.currentRowIndex).returnValue)break;if(null!==t.format&&!t.format.usePaginateBounds&&null!==t.bounds&&t.bounds.height>0&&!this.Grid.isChildGrid&&(this.currentBounds.height=t.bounds.height),"undefined"===typeof t.format||null==t.format||"undefined"===typeof t.format.usePaginateBounds||t.format.usePaginateBounds||0===t.format.paginateBounds.x&&0===t.format.paginateBounds.y&&0===t.format.paginateBounds.width&&0===t.format.paginateBounds.height||0!==t.format.paginateBounds.y?(this.currentBounds.y=null==i?0:i.paginateBounds.y,null==i||0===i.paginateBounds.x&&0===i.paginateBounds.y&&0===i.paginateBounds.height&&0===i.paginateBounds.width||(this.currentBounds.x=i.paginateBounds.x,this.currentBounds.width=i.paginateBounds.width,this.currentBounds.height=i.paginateBounds.height)):this.currentBounds.y=Fi.default.top.width/2,"undefined"!==typeof t.format&&null!==t.format&&"undefined"!==typeof t.format.usePaginateBounds&&!t.format.usePaginateBounds&&null!==t.bounds&&t.bounds.y>0&&!this.Grid.isChildGrid&&(this.currentBounds.y=t.bounds.y),this.startLocation.y=this.currentBounds.y,i.paginateBounds.x===i.paginateBounds.y&&i.paginateBounds.y===i.paginateBounds.height&&i.paginateBounds.height===i.paginateBounds.width&&0===i.paginateBounds.width&&(this.currentBounds.x+=this.startLocation.x),this.currentBounds.x===Fi.default.left.width/2&&(this.currentBounds.y+=this.startLocation.x),this.Grid.repeatHeader)for(var E=0;E<this.Grid.headers.count;E++){M=this.Grid.headers.getHeader(E);this.drawRow(M)}this.drawRow(d),null===this.currentPage||o.containsKey(this.currentPage)||o.add(this.currentPage,l)}if(null!=d.NestedGridLayoutResult){this.currentPage=d.NestedGridLayoutResult.page,this.currentGraphics=this.currentPage.graphics,this.startLocation=new lt(d.NestedGridLayoutResult.bounds.x,d.NestedGridLayoutResult.bounds.y);var N=this.ReCalculateHeight(d,d.NestedGridLayoutResult.bounds.height);if(this.currentBounds.y=N,s!=this.currentPage){for(var D=this.currentPage.section,V=D.indexOf(s)+1,z=D.indexOf(this.currentPage),G=V;G<z+1;G++){var W=this.currentPage.graphics,H=new lt(i.paginateBounds.x,i.paginateBounds.y),_=G==z?d.NestedGridLayoutResult.bounds.height-t.bounds.y:this.currentBounds.height-H.y;_<=W.clientSize.height&&(_+=t.bounds.y),H.y=null==i?.5:i.paginateBounds.y;for(var U=0;U<d.cells.count;U++){var q=d.cells.getCell(U),K=0,X=0;if(q.value instanceof Rr)for(var J=0;J<q.value.columns.count;J++)X+=q.value.columns.getColumn(J).columnWidth;else X=q.width;K=Math.max(X,d.grid.columns.getColumn(U).width),q.drawCellBorders(W,new ct(H,new ut(K,_))),H.x+=K,U+=q.columnSpan-1}}s=this.currentPage}}}var Y=!1,Q=0;a.length>0&&(Q=a[0]);var Z=[[1,2]];for(U=0;U<this.Grid.rows.count;U++)if(-1!=this.cellEndIndex&&this.Grid.rows.getRow(U).cells.getCell(this.cellEndIndex).value instanceof Rr){var $=this.Grid.rows.getRow(U).cells.getCell(this.cellEndIndex).value;this.rowLayoutBoundsWidth=$.rowLayoutBoundsWidth,Y=!0}if(!Y&&a.length>0){for(U=0;U<y-1;U++)Q<a[U]&&(Q=a[U]);this.rowLayoutBoundsWidth=Q}else this.rowLayoutBoundsWidth=Z[0][1];if(this.columnRanges.indexOf(l)<this.columnRanges.length-1&&null!=s&&i.layout!=te.OnePage)if(this.Grid.isChildGrid,0!=Z[0][0]){var tt=this.currentPage.section;tt.indexOf(this.currentPage);this.currentGraphics=this.currentPage.graphics,this.currentBounds=new ct(new lt(0,0),this.currentPage.getClientSize());this.currentGraphics.page.section.indexOf(this.currentGraphics.page)}else this.currentPage=this.getNextPageformat(i);this.columnRanges.length-1!==h&&this.columnRanges.length>1&&i.layout!==te.OnePage&&(this.currentPage=this.getNextPageformat(i),i.paginateBounds.x===i.paginateBounds.y&&i.paginateBounds.y===i.paginateBounds.height&&i.paginateBounds.height===i.paginateBounds.width&&0===i.paginateBounds.width&&(this.currentBounds.x+=this.startLocation.x,this.currentBounds.y+=this.startLocation.y))}return n=this.getLayoutResult(),this.Grid.style.allowHorizontalOverflow&&this.Grid.style.horizontalOverflowType==Ai.NextPage&&this.reArrangePages(o),this.raisePageLayouted(n),n},e.prototype.checkIsFisished=function(t){for(var e=!0,i=0;i<t.cells.count;i++)t.cells.getCell(i).FinishedDrawingCell||(e=!1);return e},e.prototype.getNextPageformat=function(t){var e=this.currentPage.section,i=null,r=e.indexOf(this.currentPage);this.flag=!1,i=r===e.count-1?e.add():e.getPages()[r+1],this.currentGraphics=i.graphics;var n=this.currentGraphics.page.section.indexOf(this.currentGraphics.page);return-1===this.listOfNavigatePages.indexOf(n)&&this.listOfNavigatePages.push(n),this.currentBounds=new ct(new lt(0,0),i.getClientSize()),"undefined"!==typeof t&&null!=t&&t.usePaginateBounds&&"undefined"!==typeof t.paginateBounds&&null!=t.paginateBounds&&t.paginateBounds.x!==t.paginateBounds.y&&t.paginateBounds.y!==t.paginateBounds.height&&t.paginateBounds.height!==t.paginateBounds.width&&0!==t.paginateBounds.width&&(this.currentBounds.x=t.paginateBounds.x,this.currentBounds.y=t.paginateBounds.y,this.currentBounds.height=t.paginateBounds.height),i},e.prototype.CheckIfDefaultFormat=function(t){var e=new Jt;return t.alignment===e.alignment&&t.characterSpacing===e.characterSpacing&&t.clipPath===e.clipPath&&t.firstLineIndent===e.firstLineIndent&&t.horizontalScalingFactor===e.horizontalScalingFactor&&t.lineAlignment===e.lineAlignment&&t.lineLimit===e.lineLimit&&t.lineSpacing===e.lineSpacing&&t.measureTrailingSpaces===e.measureTrailingSpaces&&t.noClip===e.noClip&&t.paragraphIndent===e.paragraphIndent&&t.rightToLeft===e.rightToLeft&&t.subSuperScript===e.subSuperScript&&t.wordSpacing===e.wordSpacing&&t.wordWrap===e.wordWrap},e.prototype.RaiseBeforeCellDraw=function(t,e,i,r,n,o){var s=null;return this.Grid.raiseBeginCellDraw&&(s=new gr(t,e,i,r,n,o),this.Grid.onBeginCellDraw(s),o=s.style),o},e.prototype.raiseAfterCellDraw=function(t,e,i,r,n,o){var s=null;this.Grid.raiseEndCellDraw&&(s=new mr(t,e,i,r,n,o),this.Grid.onEndCellDraw(s))},e.prototype.reArrangePages=function(t){for(var e=this.currentPage.document,i=[],r=t.keys(),n=(t.values(),0);n<r.length;n++){var o=r[n];o.section=null,i.push(o),e.pages.remove(o)}for(n=0;n<t.size();n++)for(var s=n,a=t.size()/this.columnRanges.length;s<t.size();s+=a){o=i[s];"undefined"!==typeof o&&-1===e.pages.indexOf(o)&&e.pages.add(o)}},e.prototype.getLayoutResult=function(){if(this.Grid.isChildGrid&&this.Grid.allowRowBreakAcrossPages)for(var t=0;t<this.Grid.rows.count;t++){var e=this.Grid.rows.getRow(t);e.rowBreakHeight>0&&e.repeatFlag&&(this.startLocation.y=this.currentPage.origin.y)}var i;return this.isChanged||(i=new ct(this.startLocation,new ut(this.currentBounds.width,this.currentBounds.y-this.startLocation.y))),new pr(this.currentPage,i)},e.prototype.ReCalculateHeight=function(t,e){for(var i=0,r=this.cellStartIndex;r<=this.cellEndIndex;r++)null!==t.cells.getCell(r).remainingString&&""!==t.cells.getCell(r).remainingString&&"undefined"!==typeof t.cells.getCell(r).remainingString&&(i=Math.max(i,t.cells.getCell(r).measureHeight()));return Math.max(e,i)},e.prototype.raiseBeforePageLayout=function(t,e,i){var r=!1;if(this.Grid.raiseBeginPageLayout){var n=new vr(e,t,i);this.Grid.onBeginPageLayout(n),r="undefined"!==typeof n.cancel&&n.cancel,e=n.bounds,i=n.startRowIndex}return{returnValue:r,currentBounds:e,currentRowIndex:i}},e.prototype.raisePageLayouted=function(t){var e=new Sr(t);return this.Grid.raiseEndPageLayout&&this.Grid.onEndPageLayout(e),e},e.prototype.drawRow=function(t,i,r){if("undefined"===typeof i){var n=new Cr,o=0,s=(new lt(0,0),new ut(0,0)),a=!1;if(t.rowSpanExists){var h=0,l=this.Grid.rows.rowCollection.indexOf(t);-1===l&&(l=this.Grid.headers.indexOf(t),-1!==l&&(a=!0));for(var u=0;u<t.cells.count;u++){var c=t.cells.getCell(u);h=Math.max(h,c.rowSpan)}for(u=l;u<l+h;u++)o+=a?this.Grid.headers.getHeader(u).height:this.Grid.rows.getRow(u).height}var p=t.rowBreakHeight>0?t.rowBreakHeight:t.height;if("undefined"!==typeof this.Grid.isChildGrid&&this.Grid.isChildGrid&&"undefined"!==typeof this.Grid.ParentCell&&null!=this.Grid.ParentCell)this.currentBounds.y+this.Grid.ParentCell.row.grid.style.cellPadding.bottom+p>this.currentPageBounds.height||this.currentBounds.y+this.Grid.ParentCell.row.grid.style.cellPadding.bottom+p>this.currentBounds.height||this.currentBounds.y+this.Grid.ParentCell.row.grid.style.cellPadding.bottom+o>this.currentPageBounds.height?("undefined"!==typeof this.Grid.ParentCell.row.grid.LayoutFormat&&this.Grid.ParentCell.row.grid.LayoutFormat.break===ee.FitPage&&(e.repeatRowIndex=this.Grid.rows.rowCollection.indexOf(t),this.Grid.splitChildRowIndex=this.Grid.rows.rowCollection.indexOf(t)),e.repeatRowIndex>-1&&e.repeatRowIndex===t.rowIndex&&this.Grid.allowRowBreakAcrossPages&&(n.isFinish=!0,n.bounds=this.currentBounds,this.drawRowWithBreak(n,t,p),t.repeatFlag=!0,t.repeatRowNumber=e.repeatRowIndex)):(n.isFinish=!0,t.grid.ParentCell.row.rowBreakHeightValue>0?t.repeatFlag=!0:(t.repeatFlag=!1,p=t.height),this.Grid.isChildGrid&&t.rowBreakHeight>0&&null!=this.Grid.ParentCell.row.grid.style.cellPadding&&(p+=this.Grid.ParentCell.row.grid.style.cellPadding.bottom),this.drawRow(t,n,p));else if(p>this.currentPageBounds.height)this.Grid.allowRowBreakAcrossPages&&(n.isFinish=!0,this.drawRowWithBreak(n,t,p),t.isrowFinish=!0,t.repeatFlag=!0,-1!==t.grid.splitChildRowIndex&&(n.isFinish=!1));else if(this.currentBounds.y+p>this.currentPageBounds.height||this.currentBounds.y+p>this.currentBounds.height+this.startLocation.y||this.currentBounds.y+o>this.currentPageBounds.height){var d=!1;!this.Grid.allowRowBreakAcrossPages||this.Grid.repeatHeader||t.isRowHeightSet||t.rowMergeComplete?this.Grid.allowRowBreakAcrossPages&&null!=this.Grid.LayoutFormat&&this.Grid.LayoutFormat.layout==te.Paginate&&this.Grid.LayoutFormat.break!=ee.FitElement&&t.isRowHeightSet&&this.currentBounds.y+r>this.currentPageBounds.height&&(d=this.isFitToCell(this.currentPageBounds.height-this.currentBounds.y,this.Grid,t),d||(d=!(null!==this.slr&&0==this.slr.actualSize.height&&null!=this.slr.remainder&&this.slr.remainder.length>0&&this.remainderText==this.slr.remainder)),d&&null!=this.slr&&this.slr.lineCount>1&&(d=!1),this.remainderText=null):(d=null!==this.Grid.LayoutFormat&&this.Grid.LayoutFormat.paginateBounds.height>0?this.isFitToCell(this.currentBounds.height+this.startLocation.y-this.currentBounds.y,this.Grid,t):this.isFitToCell(this.currentPageBounds.height-this.currentBounds.y,this.Grid,t),d&&(this.isPaginate=!0)),e.repeatRowIndex>-1&&e.repeatRowIndex===t.rowIndex||d?this.Grid.allowRowBreakAcrossPages?(n.isFinish=!0,this.drawRowWithBreak(n,t,p),t.repeatFlag=!0,t.repeatRowNumber=e.repeatRowIndex,-1!==t.grid.splitChildRowIndex&&(n.isFinish=!1)):(n.isFinish=!1,this.drawRow(t,n,p)):n.isFinish=!1}else n.isFinish=!0,this.drawRow(t,n,p),t.repeatFlag=!1;return n}var f=!1,g=new lt(this.currentBounds.x,this.currentBounds.y);i.bounds=new ct(g,new ut(0,0)),r=this.ReCalculateHeight(t,r);for(u=this.cellStartIndex;u<=this.cellEndIndex;u++){var m=u>this.cellEndIndex+1&&t.cells.getCell(u).columnSpan>1;if(!m)for(var y=1;y<t.cells.getCell(u).columnSpan;y++)t.cells.getCell(u+y).isCellMergeContinue=!0;s=new ut(this.Grid.columns.getColumn(u).width,r);!this.CheckIfDefaultFormat(this.Grid.columns.getColumn(u).format)&&this.CheckIfDefaultFormat(t.cells.getCell(u).stringFormat)&&(t.cells.getCell(u).stringFormat=this.Grid.columns.getColumn(u).format);var b=t.cells.getCell(u).style,w="string"===typeof t.cells.getCell(u).value&&null!==t.cells.getCell(u).value?t.cells.getCell(u).value:"";if(t.cells.getCell(u).style=this.RaiseBeforeCellDraw(this.currentGraphics,this.currentRowIndex,u,new ct(g,s),w,b),!f){if(t.cells.getCell(u).value instanceof Rr){var v=t.cells.getCell(u).value;v.parentCellIndex=u}var S=t.cells.getCell(u).draw(this.currentGraphics,new ct(g,s),m);t.grid.style.allowHorizontalOverflow&&(t.cells.getCell(u).columnSpan>this.cellEndIndex||u+t.cells.getCell(u).columnSpan>this.cellEndIndex+1)&&this.cellEndIndex<t.cells.count-1&&(t.rowOverflowIndex=this.cellEndIndex),t.grid.style.allowHorizontalOverflow&&t.rowOverflowIndex>0&&(t.cells.getCell(u).columnSpan>this.cellEndIndex||u+t.cells.getCell(u).columnSpan>this.cellEndIndex+1)&&t.cells.getCell(u).columnSpan-this.cellEndIndex+u-1>0&&(t.cells.getCell(t.rowOverflowIndex+1).value=null!==S&&void 0!==S.remainder?S.remainder:"",t.cells.getCell(t.rowOverflowIndex+1).stringFormat=t.cells.getCell(u).stringFormat,t.cells.getCell(t.rowOverflowIndex+1).style=t.cells.getCell(u).style,t.cells.getCell(t.rowOverflowIndex+1).columnSpan=t.cells.getCell(u).columnSpan-this.cellEndIndex+u-1)}if(w="string"===typeof t.cells.getCell(u).value&&null!==t.cells.getCell(u).value?t.cells.getCell(u).value:"",m||this.raiseAfterCellDraw(this.currentGraphics,this.currentRowIndex,u,new ct(g,s),w,t.cells.getCell(u).style),t.cells.getCell(u).value instanceof Rr){v=t.cells.getCell(u).value;this.Grid.columns.getColumn(u).width>=this.currentGraphics.clientSize.width?(g.x=v.rowLayoutBoundsWidth,g.x+=v.style.cellSpacing):g.x+=this.Grid.columns.getColumn(u).width}else g.x+=this.Grid.columns.getColumn(u).width}t.rowMergeComplete&&!t.isRowHeightSet||(this.currentBounds.y+=r),i.bounds=new ct(new lt(i.bounds.x,i.bounds.y),new ut(g.x,g.y))},e.prototype.isFitToCell=function(t,e,i){for(var r=!1,n=new Qt,o=0;o<i.cells.count;o++){var s=i.cells.getCell(o);if("undefined"!==typeof s.value&&null!==s.value&&"string"===typeof s.value){var a=null;a="undefined"!==typeof s.style.font&&null!=s.style.font?s.style.font:"undefined"!==typeof s.row.style.font&&null!=s.row.style.font?s.row.style.font:"undefined"!==typeof s.row.grid.style.font&&null!=s.row.grid.style.font?s.row.grid.style.font:ki.defaultFont,this.remainderText=i.cells.getCell(o).value;var h=i.cells.getCell(o).width;e.columns.getColumn(o).isCustomWidth&&i.cells.getCell(o).width>e.columns.getColumn(o).width&&(h=e.columns.getColumn(o).width),this.slr=n.layout(i.cells.getCell(o).value,a,i.cells.getCell(o).stringFormat,new ut(h,t),!1,this.currentPageBounds);var l=this.slr.actualSize.height;if(0==l){r=!1;break}if(null!=i.cells.getCell(o).style&&null!=i.cells.getCell(o).style.borders&&null!=i.cells.getCell(o).style.borders.top&&null!=i.cells.getCell(o).style.borders.bottom&&(l+=2*(i.cells.getCell(o).style.borders.top.width+i.cells.getCell(o).style.borders.bottom.width)),this.slr.lineCount>1&&null!=i.cells.getCell(o).stringFormat&&0!=i.cells.getCell(o).stringFormat.lineSpacing&&(l+=(this.slr.lineCount-1)*i.cells.getCell(o).style.stringFormat.lineSpacing),i.cells.getCell(o).style.cellPadding,l+=e.style.cellPadding.top+e.style.cellPadding.bottom,l+=e.style.cellSpacing,t>l||"undefined"!==typeof this.slr.remainder&&null!==this.slr.remainder){r=!0;break}}}return r},e.prototype.drawRowWithBreak=function(t,e,i){var r=new lt(this.currentBounds.x,this.currentBounds.y);e.grid.isChildGrid&&e.grid.allowRowBreakAcrossPages&&this.startLocation.x!==this.currentBounds.x&&(r.x=this.startLocation.x),t.bounds=new ct(r,new ut(0,0)),this.gridHeight=e.rowBreakHeight>0?this.currentPageBounds.height:0,e.grid.style.cellPadding.top+this.currentBounds.y+e.grid.style.cellPadding.bottom<this.currentPageBounds.height&&(e.rowBreakHeight=this.currentBounds.y+i-this.currentPageBounds.height);for(var n=0;n<e.cells.count;n++){var o=e.cells.getCell(n),s=o.measureHeight();s===i&&o.value instanceof Rr&&(e.rowBreakHeight=0)}for(n=this.cellStartIndex;n<=this.cellEndIndex;n++){var a=e.cells.getCell(n).columnSpan+n>this.cellEndIndex+1&&e.cells.getCell(n).columnSpan>1,h=new ut(this.Grid.columns.getColumn(n).width,this.gridHeight>0?this.gridHeight:this.currentPageBounds.height),l=e.cells.getCell(n).style;e.cells.getCell(n).style=l;var u=!1,c=null;if(u||(c=e.cells.getCell(n).draw(this.currentGraphics,new ct(r,h),a)),e.rowBreakHeight>0&&null!=c&&"undefined"!==typeof c.remainder&&(e.cells.getCell(n).FinishedDrawingCell=!1,e.cells.getCell(n).remainingString=null==c.remainder?" ":c.remainder,e.rowBreakHeight=i-c.actualSize.height),t.isFinish=t.isFinish?e.cells.getCell(n).FinishedDrawingCell:t.isFinish,e.cells.getCell(n).value instanceof Rr){var p=e.cells.getCell(n).value;this.rowBreakPageHeightCellIndex=n,this.Grid.columns.getColumn(n).width>=this.currentGraphics.clientSize.width?(r.x=this.rowLayoutBoundsWidth,r.x+=p.style.cellSpacing):r.x+=this.Grid.columns.getColumn(n).width}else r.x+=this.Grid.columns.getColumn(n).width}this.currentBounds.y+=this.gridHeight>0?this.gridHeight:i,t.bounds=new ct(new lt(t.bounds.x,t.bounds.y),new ut(r.x,r.y))},e.repeatRowIndex=-1,e}(Gi),pr=function(t){function e(e,i){return t.call(this,e,i)||this}return ur(e,t),e}(_i),dr=function(t){function e(e){return t.call(this,e)||this}return ur(e,t),e}(Wi),fr=function(){function t(t,e,i,r,n){this.gridRowIndex=e,this.gridCellIndex=i,this.internalValue=n,this.gridBounds=r,this.pdfGraphics=t}return Object.defineProperty(t.prototype,"rowIndex",{get:function(){return this.gridRowIndex},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cellIndex",{get:function(){return this.gridCellIndex},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this.internalValue},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bounds",{get:function(){return this.gridBounds},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"graphics",{get:function(){return this.pdfGraphics},enumerable:!0,configurable:!0}),t}(),gr=function(t){function e(e,i,r,n,o,s){var a=t.call(this,e,i,r,n,o)||this;return a.style=s,a}return ur(e,t),Object.defineProperty(e.prototype,"skip",{get:function(){return this.bSkip},set:function(t){this.bSkip=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"style",{get:function(){return this.cellStyle},set:function(t){this.cellStyle=t},enumerable:!0,configurable:!0}),e}(fr),mr=function(t){function e(e,i,r,n,o,s){var a=t.call(this,e,i,r,n,o)||this;return a.cellStyle=s,a}return ur(e,t),Object.defineProperty(e.prototype,"style",{get:function(){return this.cellStyle},enumerable:!0,configurable:!0}),e}(fr),yr=function(){function t(){}return Object.defineProperty(t.prototype,"cancel",{get:function(){return this.isCancel},set:function(t){this.isCancel=t},enumerable:!0,configurable:!0}),t}(),br=function(t){function e(e,i){var r=t.call(this)||this;return r.bounds=e,r.pdfPage=i,r}return ur(e,t),Object.defineProperty(e.prototype,"bounds",{get:function(){return this.cellBounds},set:function(t){this.cellBounds=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"page",{get:function(){return this.pdfPage},enumerable:!0,configurable:!0}),e}(yr),wr=function(t){function e(e){var i=t.call(this)||this;return i.layoutResult=e,i}return ur(e,t),Object.defineProperty(e.prototype,"result",{get:function(){return this.layoutResult},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextPage",{get:function(){return this.nextPdfPage},set:function(t){this.nextPdfPage=t},enumerable:!0,configurable:!0}),e}(yr),vr=function(t){function e(e,i,r){var n=t.call(this,e,i)||this;return n.startRow=r,n}return ur(e,t),Object.defineProperty(e.prototype,"startRowIndex",{get:function(){return this.startRow},enumerable:!0,configurable:!0}),e}(br),Sr=function(t){function e(e){return t.call(this,e)||this}return ur(e,t),e}(wr),Cr=function(){function t(){this.layoutedBounds=new ct(0,0,0,0)}return Object.defineProperty(t.prototype,"isFinish",{get:function(){return this.bIsFinished},set:function(t){this.bIsFinished=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bounds",{get:function(){return this.layoutedBounds},set:function(t){this.layoutedBounds=t},enumerable:!0,configurable:!0}),t}(),xr=function(){function t(t){this.cellWidth=0,this.cellHeight=0,this.tempval=0,this.fontSpilt=!1,this.finsh=!0,this.rowSpanRemainingHeight=0,this.hasRowSpan=!1,this.hasColSpan=!1,this.isFinish=!0,this.present=!1,this.gridRowSpan=1,this.colSpan=1,"undefined"!==typeof t&&(this.gridRow=t)}return Object.defineProperty(t.prototype,"isCellMergeContinue",{get:function(){return this.internalIsCellMergeContinue},set:function(t){this.internalIsCellMergeContinue=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isRowMergeContinue",{get:function(){return this.internalIsRowMergeContinue},set:function(t){this.internalIsRowMergeContinue=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isCellMergeStart",{get:function(){return this.internalIsCellMergeStart},set:function(t){this.internalIsCellMergeStart=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isRowMergeStart",{get:function(){return this.internalIsRowMergeStart},set:function(t){this.internalIsRowMergeStart=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"remainingString",{get:function(){return this.remaining},set:function(t){this.remaining=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"FinishedDrawingCell",{get:function(){return this.isFinish},set:function(t){this.isFinish=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"stringFormat",{get:function(){return null==this.format&&(this.format=new Jt),this.format},set:function(t){this.format=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"row",{get:function(){return this.gridRow},set:function(t){this.gridRow=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this.objectValue},set:function(t){if(this.objectValue=t,this.objectValue instanceof Rr){this.row.grid.isSingleGrid=!1;var e=this.objectValue;e.ParentCell=this,this.objectValue.isChildGrid=!0;for(var i=this.row.grid.rows.count,r=0;r<i;r++)for(var n=this.row.grid.rows.getRow(r),o=n.cells.count,s=0;s<o;s++){var a=n.cells.getCell(s);a.parent=this}}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rowSpan",{get:function(){return this.gridRowSpan},set:function(t){if(t<1)throw new Error("ArgumentException : Invalid span specified, must be greater than or equal to 1");this.gridRowSpan=t,this.row.rowSpanExists=!0,this.row.grid.hasRowSpanSpan=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"style",{get:function(){return null==this.cellStyle&&(this.cellStyle=new Vi),this.cellStyle},set:function(t){this.cellStyle=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return 0===this.cellHeight&&(this.cellHeight=this.measureHeight()),this.cellHeight},set:function(t){this.cellHeight=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"columnSpan",{get:function(){return this.colSpan},set:function(t){if(t<1)throw Error("Invalid span specified, must be greater than or equal to 1");this.colSpan=t,this.row.columnSpanExists=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return(0===this.cellWidth||this.row.grid.isComplete)&&(this.cellWidth=this.measureWidth()),Math.round(this.cellWidth)},set:function(t){this.cellWidth=t},enumerable:!0,configurable:!0}),t.prototype.measureWidth=function(){var t=0,e=new Qt;if("string"===typeof this.objectValue){var i=e.layout(this.objectValue,this.getTextFont(),this.stringFormat,new ut(Number.MAX_VALUE,Number.MAX_VALUE),!1,new ut(0,0));t+=i.actualSize.width,t+=2*(this.style.borders.left.width+this.style.borders.right.width)}else if(this.objectValue instanceof Rr)t=this.objectValue.size.width;else if(this.objectValue instanceof Ze||this.objectValue instanceof ti)t+=this.objectValue.width;else if(this.objectValue instanceof lr){var r=this.objectValue,n=e.layout(r.text,r.font,r.stringFormat,new ut(0,0),!1,new ut(0,0));t+=n.actualSize.width,t+=2*(this.style.borders.left.width+this.style.borders.right.width)}return this.objectValue instanceof Rr?null!=this.style.cellPadding||"undefined"!==typeof this.style.cellPadding?("undefined"!==typeof this.style.cellPadding.left&&this.style.cellPadding.hasLeftPad&&(t+=this.style.cellPadding.left),"undefined"!==typeof this.style.cellPadding.right&&this.style.cellPadding.hasRightPad&&(t+=this.style.cellPadding.right)):("undefined"!==typeof this.row.grid.style.cellPadding.left&&this.row.grid.style.cellPadding.hasLeftPad&&(t+=this.row.grid.style.cellPadding.left),"undefined"!==typeof this.row.grid.style.cellPadding.right&&this.row.grid.style.cellPadding.hasRightPad&&(t+=this.row.grid.style.cellPadding.right)):null!=this.style.cellPadding?t+=this.style.cellPadding.left+this.style.cellPadding.right:t+=this.row.grid.style.cellPadding.left+this.row.grid.style.cellPadding.right,t+=this.row.grid.style.cellSpacing,t},t.prototype.drawCellBackground=function(t,e){var i=this.getBackgroundBrush();if(null!=i&&(t.save(),t.drawRectangle(i,e.x,e.y,e.width,e.height),t.restore()),null!=this.style.backgroundImage){this.getBackgroundImage();t.drawImage(this.style.backgroundImage,e.x,e.y,e.width,e.height)}},t.prototype.adjustContentLayoutArea=function(t){var e=new ct(t.x,t.y,t.width,t.height);return this.objectValue instanceof Rr?(null==this.style.cellPadding||"undefined"===typeof this.style.cellPadding?("undefined"!==typeof this.gridRow.grid.style.cellPadding.left&&this.gridRow.grid.style.cellPadding.hasLeftPad&&(e.x+=this.gridRow.grid.style.cellPadding.left+this.cellStyle.borders.left.width,e.width-=this.gridRow.grid.style.cellPadding.left),"undefined"!==typeof this.gridRow.grid.style.cellPadding.top&&this.gridRow.grid.style.cellPadding.hasTopPad&&(e.y+=this.gridRow.grid.style.cellPadding.top+this.cellStyle.borders.top.width,e.height-=this.gridRow.grid.style.cellPadding.top),"undefined"!==typeof this.gridRow.grid.style.cellPadding.right&&this.gridRow.grid.style.cellPadding.hasRightPad&&(e.width-=this.gridRow.grid.style.cellPadding.right),"undefined"!==typeof this.gridRow.grid.style.cellPadding.bottom&&this.gridRow.grid.style.cellPadding.hasBottomPad&&(e.height-=this.gridRow.grid.style.cellPadding.bottom)):("undefined"!==typeof this.style.cellPadding.left&&this.style.cellPadding.hasLeftPad&&(e.x+=this.style.cellPadding.left+this.cellStyle.borders.left.width,e.width-=this.style.cellPadding.left),"undefined"!==typeof this.style.cellPadding.top&&this.style.cellPadding.hasTopPad&&(e.y+=this.style.cellPadding.top+this.cellStyle.borders.top.width,e.height-=this.style.cellPadding.top),"undefined"!==typeof this.style.cellPadding.right&&this.style.cellPadding.hasRightPad&&(e.width-=this.style.cellPadding.right),"undefined"!==typeof this.style.cellPadding.bottom&&this.style.cellPadding.hasBottomPad&&(e.height-=this.style.cellPadding.bottom)),e.width-=this.cellStyle.borders.left.width+this.cellStyle.borders.right.width,e.height-=this.cellStyle.borders.top.width+this.cellStyle.borders.bottom.width):"undefined"===typeof this.style.cellPadding||null==this.style.cellPadding?(e.x+=this.gridRow.grid.style.cellPadding.left+this.cellStyle.borders.left.width,e.y+=this.gridRow.grid.style.cellPadding.top+this.cellStyle.borders.top.width,e.width-=this.gridRow.grid.style.cellPadding.right+this.gridRow.grid.style.cellPadding.left,e.height-=this.gridRow.grid.style.cellPadding.bottom+this.gridRow.grid.style.cellPadding.top,e.height-=this.cellStyle.borders.top.width+this.cellStyle.borders.bottom.width):(e.x+=this.style.cellPadding.left+this.cellStyle.borders.left.width,e.y+=this.style.cellPadding.top+this.cellStyle.borders.top.width,e.width-=this.style.cellPadding.right+this.style.cellPadding.left,e.width-=this.cellStyle.borders.left.width+this.cellStyle.borders.right.width,e.height-=this.style.cellPadding.bottom+this.style.cellPadding.top,e.height-=this.cellStyle.borders.top.width+this.cellStyle.borders.bottom.width,1===this.rowSpan&&(e.width-=this.style.borders.left.width)),e},t.prototype.draw=function(t,e,i){var r=null;if(this.internalIsCellMergeContinue||this.internalIsRowMergeContinue){if(!this.internalIsCellMergeContinue||!this.row.grid.style.allowHorizontalOverflow)return r;if(this.row.rowOverflowIndex>0&&this.row.cells.indexOf(this)!=this.row.rowOverflowIndex+1||0==this.row.rowOverflowIndex&&this.internalIsCellMergeContinue)return r}e=this.adjustOuterLayoutArea(e,t),this.drawCellBackground(t,e);var n=this.getTextPen(),o=this.getTextBrush();"undefined"===typeof n&&"undefined"===typeof o&&(o=new Kt(new _t(0,0,0)));var s=this.getTextFont(),a=this.getStringFormat(),h=e;if(h.height>=t.clientSize.height&&this.row.grid.allowRowBreakAcrossPages&&(h.height-=h.y),h=this.adjustContentLayoutArea(h),"string"===typeof this.objectValue||"string"===typeof this.remaining){var l=void 0,u=void 0;if(u=h.height<s.height?new ct(h.x,h.y,h.width,s.height):h,h.height<s.height&&this.row.grid.isChildGrid&&null!=this.row.grid.ParentCell){var c=u.height-this.row.grid.ParentCell.row.grid.style.cellPadding.bottom-this.row.grid.style.cellPadding.bottom;-1!=this.row.grid.splitChildRowIndex&&(this.fontSpilt=!0,this.row.rowFontSplit=!0),c>0&&c<s.height&&(u.height=c)}0!=this.gridRow.grid.style.cellSpacing&&(u.width-=this.gridRow.grid.style.cellSpacing,e.width-=this.gridRow.grid.style.cellSpacing),this.isFinish?(l=""===this.remaining?this.remaining:this.objectValue,t.drawString(l,s,n,o,u.x,u.y,u.width,u.height,a),-1==this.row.grid.splitChildRowIndex||this.row.grid.isChildGrid||"undefined"!==typeof this.remaining||(this.remaining="")):("undefined"!=typeof this.remaining&&null!==this.remaining||(this.remaining=""),this.row.repeatFlag&&t.drawString(this.remaining,s,n,o,u.x,u.y,u.width,u.height,a),this.isFinish=!0),r=t.stringLayoutResult}else if(this.objectValue instanceof Rr){var p=this.objectValue;p.isChildGrid=!0,p.ParentCell=this;var d=void 0;d=h,0!=this.gridRow.grid.style.cellSpacing&&(e.width-=this.gridRow.grid.style.cellSpacing);var f=new cr(p),g=new dr;null!=this.row.grid.LayoutFormat?g=this.row.grid.LayoutFormat:g.layout=te.Paginate;var m=new Hi;if(null!=t.layer){m.page=t.page,m.bounds=d,m.format=g,p.setSpan(),p.checkSpan();var y=f.Layouter(m);this.value=p,-1!==this.row.grid.splitChildRowIndex&&(this.height=this.row.rowBreakHeightValue),m.page!=y.page&&(y.bounds.height=this.row.rowBreakHeightValue,0==this.row.rowBreakHeight?this.row.NestedGridLayoutResult=y:this.row.rowBreakHeight=this.row.rowBreakHeightValue)}}else if(this.objectValue instanceof Ze||this.objectValue instanceof ti){var b=void 0;b=this.objectValue.width<=h.width?new ct(h.x,h.y,this.objectValue.width,h.height):h,t.drawImage(this.objectValue,b.x,b.y,b.width,b.height)}else this.objectValue instanceof lr?this.objectValue.draw(t.currentPage,h):"undefined"===typeof this.objectValue&&(this.objectValue="",t.drawString(this.objectValue,s,n,o,h.x,h.y,h.width,h.height,a),null!=this.style.cellPadding&&0==this.style.cellPadding.bottom&&0==this.style.cellPadding.left&&0==this.style.cellPadding.right&&0==this.style.cellPadding.top&&(e.width-=this.style.borders.left.width+this.style.borders.right.width),0!=this.gridRow.grid.style.cellSpacing&&(e.width-=this.gridRow.grid.style.cellSpacing));return null!=this.style.borders&&(this.fontSpilt?-1!=this.row.grid.ParentCell.row.grid.splitChildRowIndex&&(this.row.rowFontSplit=!1,this.drawCellBorders(t,e)):this.drawCellBorders(t,e)),r},t.prototype.drawCellBorders=function(t,e){this.row.grid.style.borderOverlapStyle===Je.Inside&&(e.x+=this.style.borders.left.width,e.y+=this.style.borders.top.width,e.width-=this.style.borders.right.width,e.height-=this.style.borders.bottom.width);var i=new lt(e.x,e.y+e.height),r=new lt(e.x,e.y),n=this.cellStyle.borders.left;this.cellStyle.borders.left.dashStyle===vt.Solid&&(n.lineCap=wt.Square),0!==n.width&&t.drawLine(n,i,r),i=new lt(e.x+e.width,e.y),r=new lt(e.x+e.width,e.y+e.height),n=this.cellStyle.borders.right,e.x+e.width>t.clientSize.width-n.width/2&&(i=new lt(t.clientSize.width-n.width/2,e.y),r=new lt(t.clientSize.width-n.width/2,e.y+e.height)),this.cellStyle.borders.right.dashStyle===vt.Solid&&(n.lineCap=wt.Square),0!==n.width&&t.drawLine(n,i,r),i=new lt(e.x,e.y),r=new lt(e.x+e.width,e.y),n=this.cellStyle.borders.top,this.cellStyle.borders.top.dashStyle===vt.Solid&&(n.lineCap=wt.Square),0!==n.width&&t.drawLine(n,i,r),i=new lt(e.x+e.width,e.y+e.height),r=new lt(e.x,e.y+e.height),n=this.cellStyle.borders.bottom,e.y+e.height>t.clientSize.height-n.width/2&&(i=new lt(e.x+e.width,t.clientSize.height-n.width/2),r=new lt(e.x,t.clientSize.height-n.width/2)),this.cellStyle.borders.bottom.dashStyle===vt.Solid&&(n.lineCap=wt.Square),0!==n.width&&t.drawLine(n,i,r)},t.prototype.adjustOuterLayoutArea=function(t,e){var i=!1,r=this.row.grid.style.cellSpacing;r>0&&(t=new ct(t.x+r,t.y+r,t.width-r,t.height-r));var n=this.row.cells.indexOf(this);if(this.columnSpan>1||this.row.rowOverflowIndex>0&&n==this.row.rowOverflowIndex+1&&this.isCellMergeContinue){var o=this.columnSpan;if(1==o&&this.isCellMergeContinue)for(var s=n+1;s<this.row.grid.columns.count;s++){if(!this.row.cells.getCell(s).isCellMergeContinue)break;o++}for(var a=0,h=n;h<n+o;h++){if(this.row.grid.style.allowHorizontalOverflow){var l=void 0,u=this.row.grid.size.width<e.clientSize.width?this.row.grid.size.width:e.clientSize.width;if(l=this.row.grid.size.width>e.clientSize.width?t.x+a+this.row.grid.columns.getColumn(h).width:a+this.row.grid.columns.getColumn(h).width,l>u)break}a+=this.row.grid.columns.getColumn(h).width}a-=this.row.grid.style.cellSpacing,t.width=a}if(this.rowSpan>1||this.row.rowSpanExists){o=this.rowSpan;var c=this.row.grid.rows.rowCollection.indexOf(this.row);-1==c&&(c=this.row.grid.headers.indexOf(this.row),-1!=c&&(i=!0));var p=0;for(h=c;h<c+o;h++){p+=i?this.row.grid.headers.getHeader(h).height:this.row.grid.rows.getRow(h).height;var d=this.row.grid.rows.getRow(h);this.row.grid.rows.rowCollection.indexOf(d)}this.row.cells.indexOf(this);p-=this.row.grid.style.cellSpacing,t.height=p,this.row.rowMergeComplete||(t.height=p)}return t},t.prototype.getTextFont=function(){return"undefined"!==typeof this.style.font&&null!=this.style.font?this.style.font:"undefined"!==typeof this.row.style.font&&null!=this.row.style.font?this.row.style.font:"undefined"!==typeof this.row.grid.style.font&&null!=this.row.grid.style.font?this.row.grid.style.font:ki.defaultFont},t.prototype.getTextBrush=function(){return"undefined"!==typeof this.style.textBrush&&null!=this.style.textBrush?this.style.textBrush:"undefined"!==typeof this.row.style.textBrush&&null!=this.row.style.textBrush?this.row.style.textBrush:this.row.grid.style.textBrush},t.prototype.getTextPen=function(){return"undefined"!==typeof this.style.textPen&&null!=this.style.textPen?this.style.textPen:"undefined"!==typeof this.row.style.textPen&&null!=this.row.style.textPen?this.row.style.textPen:this.row.grid.style.textPen},t.prototype.getBackgroundBrush=function(){return"undefined"!==typeof this.style.backgroundBrush&&null!=this.style.backgroundBrush?this.style.backgroundBrush:"undefined"!==typeof this.row.style.backgroundBrush&&null!=this.row.style.backgroundBrush?this.row.style.backgroundBrush:this.row.grid.style.backgroundBrush},t.prototype.getBackgroundImage=function(){return"undefined"!==typeof this.style.backgroundImage&&null!=this.style.backgroundImage?this.style.backgroundImage:"undefined"!==typeof this.row.style.backgroundImage&&null!=this.row.style.backgroundImage?this.row.style.backgroundImage:this.row.grid.style.backgroundImage},t.prototype.getStringFormat=function(){return"undefined"!==typeof this.style.stringFormat&&null!=this.style.stringFormat?this.style.stringFormat:this.stringFormat},t.prototype.measureHeight=function(){var t=this.calculateWidth();null==this.style.cellPadding||"undefined"===typeof this.style.cellPadding?t-=this.gridRow.grid.style.cellPadding.right+this.gridRow.grid.style.cellPadding.left:(t-=this.style.cellPadding.right+this.style.cellPadding.left,t-=this.style.borders.left.width+this.style.borders.right.width);var e=0,i=new Qt;if("string"===typeof this.objectValue||"string"===typeof this.remaining){var r=this.objectValue;this.isFinish||(r=null!==this.remaining&&""!==this.remaining&&"undefined"!==typeof this.remaining?this.remaining:this.objectValue);var n=null,o=this.row.cells.indexOf(this);0!=this.gridRow.grid.style.cellSpacing&&(t-=2*this.gridRow.grid.style.cellSpacing),this.row.cells.getCell(o).hasColSpan||this.row.cells.getCell(o).hasRowSpan||(this.gridRow.grid.isChildGrid?(t<0?(this.tempval=t,null==this.style.cellPadding||"undefined"===typeof this.style.cellPadding?this.tempval+=this.gridRow.grid.style.cellPadding.right+this.gridRow.grid.style.cellPadding.left:(this.tempval+=this.style.cellPadding.right+this.style.cellPadding.left,this.tempval+=this.style.borders.left.width+this.style.borders.right.width)):this.tempval=t,n=i.layout(r,this.getTextFont(),this.stringFormat,new ut(this.tempval,0),!1,new ut(0,0)),e+=n.actualSize.height):(n=i.layout(r,this.getTextFont(),this.stringFormat,new ut(t,0),!1,new ut(0,0)),e+=n.actualSize.height)),e+=2*(this.style.borders.top.width+this.style.borders.bottom.width)}else if(this.objectValue instanceof Rr){o=this.row.cells.indexOf(this);var s=0;null!=this.style.cellPadding||"undefined"!==typeof this.style.cellPadding?(s=this.calculateWidth(),"undefined"!==typeof this.style.cellPadding.left&&this.style.cellPadding.hasLeftPad&&(s-=this.style.cellPadding.left),"undefined"!==typeof this.style.cellPadding.right&&this.style.cellPadding.hasRightPad&&(s-=this.style.cellPadding.right)):null!=this.row.grid.style.cellPadding||"undefined"!==typeof this.row.grid.style.cellPadding?(s=this.calculateWidth(),"undefined"!==typeof this.row.grid.style.cellPadding.left&&this.row.grid.style.cellPadding.hasLeftPad&&(s-=this.row.grid.style.cellPadding.left),"undefined"!==typeof this.row.grid.style.cellPadding.right&&this.row.grid.style.cellPadding.hasRightPad&&(s-=this.row.grid.style.cellPadding.right)):s=this.calculateWidth(),this.objectValue.tempWidth=s,this.row.cells.getCell(o).hasColSpan||this.row.cells.getCell(o).hasRowSpan?e+=2*(this.style.borders.top.width+this.style.borders.bottom.width):e=this.objectValue.size.height,0!==this.gridRow.grid.style.cellSpacing&&(t-=2*this.gridRow.grid.style.cellSpacing),null==this.style.cellPadding&&"undefined"===typeof this.style.cellPadding||("undefined"!==typeof this.row.grid.style.cellPadding.top&&this.row.grid.style.cellPadding.hasTopPad&&(e+=this.row.grid.style.cellPadding.top),this.row.grid.style.cellPadding.hasBottomPad&&"undefined"!==typeof this.row.grid.style.cellPadding.bottom&&(e+=this.row.grid.style.cellPadding.bottom)),e+=this.objectValue.style.cellSpacing}else if(this.objectValue instanceof Ze||this.objectValue instanceof ti)e+=this.objectValue.height;else if(this.objectValue instanceof lr){var a=this.objectValue;n=i.layout(a.text,a.font,a.stringFormat,new ut(t,0),!1,new ut(0,0));e+=n.actualSize.height,e+=2*(this.style.borders.top.width+this.style.borders.bottom.width)}else"undefined"===typeof this.objectValue&&(null==this.style.cellPadding||"undefined"===typeof this.style.cellPadding?t-=this.gridRow.grid.style.cellPadding.right+this.gridRow.grid.style.cellPadding.left:(t-=this.style.cellPadding.right+this.style.cellPadding.left,t-=this.style.borders.left.width+this.style.borders.right.width),e+=2*(this.style.borders.top.width+this.style.borders.bottom.width));return this.objectValue instanceof Rr?null==this.style.cellPadding||"undefined"===typeof this.style.cellPadding?("undefined"!==typeof this.row.grid.style.cellPadding.top&&this.row.grid.style.cellPadding.hasTopPad&&(e+=this.row.grid.style.cellPadding.top),"undefined"!==typeof this.row.grid.style.cellPadding.bottom&&this.row.grid.style.cellPadding.hasBottomPad&&(e+=this.row.grid.style.cellPadding.bottom)):("undefined"!==typeof this.style.cellPadding.top&&this.style.cellPadding.hasTopPad&&(e+=this.style.cellPadding.top),"undefined"!==typeof this.style.cellPadding.bottom&&this.style.cellPadding.hasBottomPad&&(e+=this.style.cellPadding.bottom)):null==this.style.cellPadding||"undefined"===typeof this.style.cellPadding?e+=this.row.grid.style.cellPadding.top+this.row.grid.style.cellPadding.bottom:e+=this.style.cellPadding.top+this.style.cellPadding.bottom,e+=this.row.grid.style.cellSpacing,e},t.prototype.calculateWidth=function(){var t=this.row.cells.indexOf(this),e=(this.row.grid.rows.rowCollection.indexOf(this.row),this.columnSpan),i=0;if(1===e)for(var r=0;r<e;r++)i+=this.row.grid.columns.getColumn(t+r).width;else if(e>1)for(r=0;r<e;r++)i+=this.row.grid.columns.getColumn(t+r).width,r+1<e&&(this.row.cells.getCell(t+r+1).hasColSpan=!0);if(null!=this.parent&&this.parent.row.width>0&&this.row.grid.isChildGrid&&null!=this.parent&&this.row.width>this.parent.row.width){i=0;for(var n=0;n<this.parent.columnSpan;n++)i+=this.parent.row.grid.columns.getColumn(n).width;i/=this.row.cells.count}return i},t}(),Pr=function(){function t(t){this.cells=[],this.gridRow=t}return t.prototype.getCell=function(t){if(t<0||t>=this.count)throw new Error("IndexOutOfRangeException");return this.cells[t]},Object.defineProperty(t.prototype,"count",{get:function(){return this.cells.length},enumerable:!0,configurable:!0}),t.prototype.add=function(t){if("undefined"===typeof t){var e=new xr;return this.add(e),t}t.row=this.gridRow,this.cells.push(t)},t.prototype.indexOf=function(t){return this.cells.indexOf(t)},t}(),Or=function(){function t(t){this.columnWidth=0,this.grid=t}return Object.defineProperty(t.prototype,"width",{get:function(){return this.columnWidth},set:function(t){this.isCustomWidth=!0,this.columnWidth=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"format",{get:function(){return null==this.stringFormat&&(this.stringFormat=new Jt),this.stringFormat},set:function(t){this.stringFormat=t},enumerable:!0,configurable:!0}),t}(),Tr=function(){function t(t){this.internalColumns=[],this.columnWidth=0,this.grid=t,this.internalColumns=[]}return t.prototype.add=function(t){for(var e=0;e<t;e++){this.internalColumns.push(new Or(this.grid));for(var i=0;i<this.grid.rows.count;i++){var r=this.grid.rows.getRow(i),n=new xr;n.value="",r.cells.add(n)}}},Object.defineProperty(t.prototype,"count",{get:function(){return this.internalColumns.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return 0===this.columnWidth&&(this.columnWidth=this.measureColumnsWidth()),0===this.grid.initialWidth||this.columnWidth===this.grid.initialWidth||this.grid.style.allowHorizontalOverflow||(this.columnWidth=this.grid.initialWidth,this.grid.isPageWidth=!0),this.columnWidth},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"columns",{get:function(){return this.internalColumns},enumerable:!0,configurable:!0}),t.prototype.getColumn=function(t){if(t>=0&&t<=this.columns.length)return this.columns[t];throw Error("can not get the column from the index: "+t)},t.prototype.measureColumnsWidth=function(){var t=0;this.grid.measureColumnsWidth();for(var e=0,i=this.internalColumns.length;e<i;e++)t+=this.internalColumns[e].width;return t},t.prototype.getDefaultWidths=function(t){for(var e=[],i=this.count,r=0;r<this.count;r++)this.grid.isPageWidth&&t>=0&&!this.internalColumns[r].isCustomWidth?this.internalColumns[r].width=0:(e[r]=this.internalColumns[r].width,this.internalColumns[r].width>0&&this.internalColumns[r].isCustomWidth?(t-=this.internalColumns[r].width,i--):e[r]=0);for(r=0;r<this.count;r++){var n=t/i;e[r]<=0&&(e[r]=n)}return e},t}(),Lr=function(){function t(t){this.gridRowOverflowIndex=0,this.rowHeight=0,this.rowWidth=0,this.isrowFinish=!1,this.isRowSpanRowHeightSet=!1,this.noOfPageCount=0,this.isRowHeightSet=!1,this.isPageBreakRowSpanApplied=!1,this.isRowMergeComplete=!0,this.repeatFlag=!1,this.rowFontSplit=!1,this.isHeaderRow=!1,this.pdfGrid=t}return Object.defineProperty(t.prototype,"rowSpanExists",{get:function(){return this.bRowSpanExists},set:function(t){this.bRowSpanExists=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cells",{get:function(){return null==this.gridCells&&(this.gridCells=new Pr(this)),this.gridCells},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"grid",{get:function(){return this.pdfGrid},set:function(t){this.pdfGrid=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"style",{get:function(){return"undefined"===typeof this.rowStyle&&(this.rowStyle=new zi,this.rowStyle.setParent(this)),this.rowStyle},set:function(t){this.rowStyle=t;for(var e=0;e<this.cells.count;e++)this.cells.getCell(e).style.borders=t.border,"undefined"!==typeof t.font&&(this.cells.getCell(e).style.font=t.font),"undefined"!==typeof t.backgroundBrush&&(this.cells.getCell(e).style.backgroundBrush=t.backgroundBrush),"undefined"!==typeof t.backgroundImage&&(this.cells.getCell(e).style.backgroundImage=t.backgroundImage),"undefined"!==typeof t.textBrush&&(this.cells.getCell(e).style.textBrush=t.textBrush),"undefined"!==typeof t.textPen&&(this.cells.getCell(e).style.textPen=t.textPen)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rowBreakHeight",{get:function(){return"undefined"===typeof this.gridRowBreakHeight&&(this.gridRowBreakHeight=0),this.gridRowBreakHeight},set:function(t){this.gridRowBreakHeight=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rowOverflowIndex",{get:function(){return this.gridRowOverflowIndex},set:function(t){this.gridRowOverflowIndex=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.isRowHeightSet||(this.rowHeight=this.measureHeight()),this.rowHeight},set:function(t){this.rowHeight=t,this.isRowHeightSet=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return 0!==this.rowWidth&&"undefined"!==typeof this.rowWidth||(this.rowWidth=this.measureWidth()),this.rowWidth},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"NestedGridLayoutResult",{get:function(){return this.gridResult},set:function(t){this.gridResult=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"columnSpanExists",{get:function(){return this.bColumnSpanExists},set:function(t){this.bColumnSpanExists=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rowMergeComplete",{get:function(){return this.isRowMergeComplete},set:function(t){this.isRowMergeComplete=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rowIndex",{get:function(){return this.grid.rows.rowCollection.indexOf(this)},enumerable:!0,configurable:!0}),t.prototype.measureHeight=function(){var t,e=0,i=0;t=this.cells.getCell(0).rowSpan>1?0:this.cells.getCell(0).height;for(var r=0;r<this.cells.count;r++){var n=this.cells.getCell(r);if(n.rowSpanRemainingHeight>e&&(e=n.rowSpanRemainingHeight),this.rowMergeComplete=!1,n.rowSpan>1){for(var o=r,s=this.isHeaderRow?this.grid.headers.indexOf(this):this.grid.rows.rowCollection.indexOf(this),a=0;a<n.rowSpan;a++)a+1<n.rowSpan&&((this.isHeaderRow?this.grid.headers.getHeader(s+a+1):this.grid.rows.getRow(s+a+1)).cells.getCell(o).hasRowSpan=!0);i<n.height&&(i=n.height)}else t=Math.max(t,n.height)}return i>t&&(t=i),0===t?t=i:e>0&&(t+=e),t},t.prototype.measureWidth=function(){for(var t=0,e=0;e<this.grid.columns.count;e++){var i=this.grid.columns.getColumn(e);t+=i.width}return t},t}(),jr=function(){function t(t){this.rows=[],this.grid=t}return Object.defineProperty(t.prototype,"count",{get:function(){return this.rows.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rowCollection",{get:function(){return this.rows},enumerable:!0,configurable:!0}),t.prototype.addRow=function(t){if("undefined"===typeof t){var e=new Lr(this.grid);return this.addRow(e),e}if(t.style.setBackgroundBrush(this.grid.style.backgroundBrush),t.style.setFont(this.grid.style.font),t.style.setTextBrush(this.grid.style.textBrush),t.style.setTextPen(this.grid.style.textPen),0===t.cells.count)for(var i=0;i<this.grid.columns.count;i++)t.cells.add(new xr);this.rows.push(t)},t.prototype.getRow=function(t){return this.rows[t]},t}(),Br=function(){function t(t){this.rows=[],this.grid=t,this.rows=[]}return t.prototype.getHeader=function(t){return this.rows[t]},Object.defineProperty(t.prototype,"count",{get:function(){return this.rows.length},enumerable:!0,configurable:!0}),t.prototype.add=function(t){if("number"===typeof t){for(var e=void 0,i=0;i<t;i++){e=new Lr(this.grid),e.isHeaderRow=!0;for(var r=0;r<this.grid.columns.count;r++)e.cells.add(new xr);this.rows.push(e)}return this.rows}this.rows.push(t)},t.prototype.indexOf=function(t){return this.rows.indexOf(t)},t}(),Ir=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},t(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Rr=function(t){function e(){var e=t.call(this)||this;return e.gridSize=new ut(0,0),e.isGridSplit=!1,e.isRearranged=!1,e.pageBounds=new ct,e.listOfNavigatePages=[],e.parentCellIndex=0,e.tempWidth=0,e.breakRow=!0,e.splitChildRowIndex=-1,e.hasRowSpanSpan=!1,e.hasColumnSpan=!1,e.isSingleGrid=!0,e}return Ir(e,t),Object.defineProperty(e.prototype,"raiseBeginCellDraw",{get:function(){return"undefined"!==typeof this.beginCellDraw&&null!==typeof this.beginCellDraw},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"raiseEndCellDraw",{get:function(){return"undefined"!==typeof this.endCellDraw&&null!==typeof this.endCellDraw},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"repeatHeader",{get:function(){return null!=this.bRepeatHeader&&"undefined"!==typeof this.bRepeatHeader||(this.bRepeatHeader=!1),this.bRepeatHeader},set:function(t){this.bRepeatHeader=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"allowRowBreakAcrossPages",{get:function(){return this.breakRow},set:function(t){this.breakRow=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"columns",{get:function(){return null!=this.gridColumns&&"undefined"!==typeof this.gridColumns||(this.gridColumns=new Tr(this)),this.gridColumns},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rows",{get:function(){return null==this.gridRows&&(this.gridRows=new jr(this)),this.gridRows},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"headers",{get:function(){return null!=this.gridHeaders&&"undefined"!==typeof this.gridHeaders||(this.gridHeaders=new Br(this)),this.gridHeaders},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"initialWidth",{get:function(){return this.gridInitialWidth},set:function(t){this.gridInitialWidth=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"style",{get:function(){return null==this.gridStyle&&(this.gridStyle=new Di),this.gridStyle},set:function(t){null==this.gridStyle&&(this.gridStyle=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isPageWidth",{get:function(){return this.ispageWidth},set:function(t){this.ispageWidth=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isChildGrid",{get:function(){return this.ischildGrid},set:function(t){this.ischildGrid=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return 0!==this.gridSize.width&&"undefined"!==typeof this.gridSize.width||0!==this.gridSize.height||(this.gridSize=this.measure()),this.gridSize},set:function(t){this.gridSize=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ParentCell",{get:function(){return this.parentCell},set:function(t){this.parentCell=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"LayoutFormat",{get:function(){return this.layoutFormat},enumerable:!0,configurable:!0}),e.prototype.draw=function(t,e,i,r){if(e instanceof lt&&"undefined"===typeof e.width&&"undefined"===typeof i)return this.drawHelper(t,e.x,e.y);if("number"===typeof e&&"number"===typeof i&&"undefined"===typeof r)return this.drawHelper(t,e,i,null);if(e instanceof ct&&"undefined"!==typeof e.width&&"undefined"===typeof i)return this.drawHelper(t,e,null);if(e instanceof lt&&"undefined"===typeof e.width&&i instanceof Wi)return this.drawHelper(t,e.x,e.y,i);if("number"===typeof e&&"number"===typeof i&&(r instanceof Wi||null==r)){var n=t.graphics.clientSize.width-e,o=new ct(e,i,n,0);return this.drawHelper(t,o,r)}return e instanceof ct&&"undefined"!==typeof e.width&&"boolean"===typeof i?this.drawHelper(t,e,null):this.drawHelper(t,e,i)},e.prototype.measure=function(){for(var t=0,e=this.columns.width,i=0;i<this.headers.count;i++){var r=this.headers.getHeader(i);t+=r.height}for(i=0;i<this.rows.count;i++){r=this.rows.getRow(i);t+=r.height}return new ut(e,t)},e.prototype.onBeginCellDraw=function(t){this.raiseBeginCellDraw&&this.beginCellDraw(this,t)},e.prototype.onEndCellDraw=function(t){this.raiseEndCellDraw&&this.endCellDraw(this,t)},e.prototype.layout=function(t){var e=t.bounds.width,i=t.bounds.height,r=!1;if("undefined"!==typeof t.bounds.width&&0!==t.bounds.width||(e=t.page.getClientSize().width-t.bounds.x,r=!0),"undefined"!==typeof t.bounds.height&&0!==t.bounds.height||(i=t.page.getClientSize().height-t.bounds.y,r=!0),r&&(t.bounds=new ct(t.bounds.x,t.bounds.y,e,i)),0!==this.rows.count){var n=this.rows.getRow(0).cells.getCell(0).style;if(null!=n.borders&&(null!=n.borders.left&&1!==n.borders.left.width||null!=n.borders.top&&1!==n.borders.top.width)){var o=n.borders.left.width/2,s=n.borders.top.width/2;if(t.bounds.x===Fi.default.right.width/2&&t.bounds.y===Fi.default.right.width/2){var a=new ct(o,s,this.gridSize.width,this.gridSize.height);t.bounds=a}}}this.setSpan(),this.checkSpan(),this.layoutFormat=t.format,this.gridLocation=t.bounds;var h=new cr(this),l=h.Layouter(t);return l},e.prototype.setSpan=function(){for(var t=1,e=1,i=0,r=0,n=0,o=this.headers.count,s=0;s<o;s++){var a=this.headers.getHeader(s);n=0;for(var h=a.cells.count,l=0;l<h;l++){var u=a.cells.getCell(l);if(n=Math.max(n,u.rowSpan),!u.isCellMergeContinue&&!u.isRowMergeContinue&&(u.columnSpan>1||u.rowSpan>1)){if(u.columnSpan+l>a.cells.count)throw new Error("Invalid span specified at row "+l.toString()+" column "+s.toString());if(u.rowSpan+s>this.headers.count)throw new Error("Invalid span specified at Header "+l.toString()+" column "+s.toString());if(u.columnSpan>1&&u.rowSpan>1){t=u.columnSpan,e=u.rowSpan,i=l,r=s,u.isCellMergeStart=!0,u.isRowMergeStart=!0;while(t>1)i++,a.cells.getCell(i).isCellMergeContinue=!0,a.cells.getCell(i).isRowMergeContinue=!0,a.cells.getCell(i).rowSpan=e,t--;i=l,t=u.columnSpan;while(e>1){r++,this.headers.getHeader(r).cells.getCell(l).isRowMergeContinue=!0,this.headers.getHeader(r).cells.getCell(i).isRowMergeContinue=!0,e--;while(t>1)i++,this.headers.getHeader(r).cells.getCell(i).isCellMergeContinue=!0,this.headers.getHeader(r).cells.getCell(i).isRowMergeContinue=!0,t--;t=u.columnSpan,i=l}}else if(u.columnSpan>1&&1===u.rowSpan){t=u.columnSpan,i=l,u.isCellMergeStart=!0;while(t>1)i++,a.cells.getCell(i).isCellMergeContinue=!0,t--}else if(1===u.columnSpan&&u.rowSpan>1){e=u.rowSpan,r=s;while(e>1)r++,this.headers.getHeader(r).cells.getCell(l).isRowMergeContinue=!0,e--}}}a.maximumRowSpan=n}},e.prototype.checkSpan=function(){var t,e,i=1,r=0,n=0;if(t=i=1,e=n=0,this.hasRowSpanSpan||this.hasColumnSpan)for(var o=this.rows.count,s=0;s<o;s++){var a=this.rows.getRow(s);r=0;for(var h=a.cells.count,l=0;l<h;l++){var u=a.cells.getCell(l);if(r=Math.max(r,u.rowSpan),!u.isCellMergeContinue&&!u.isRowMergeContinue&&(u.columnSpan>1||u.rowSpan>1)){if(u.columnSpan+l>a.cells.count)throw new Error("Invalid span specified at row  "+l.toString()+" column "+s.toString());if(u.rowSpan+s>this.rows.count)throw new Error("Invalid span specified at row  "+l.toString()+" column "+s.toString());if(u.columnSpan>1&&u.rowSpan>1){t=u.columnSpan,i=u.rowSpan,e=l,n=s,u.isCellMergeStart=!0,u.isRowMergeStart=!0;while(t>1)e++,a.cells.getCell(e).isCellMergeContinue=!0,a.cells.getCell(e).isRowMergeContinue=!0,t--;e=l,t=u.columnSpan;while(i>1){n++,this.rows.getRow(n).cells.getCell(l).isRowMergeContinue=!0,this.rows.getRow(n).cells.getCell(e).isRowMergeContinue=!0,i--;while(t>1)e++,this.rows.getRow(n).cells.getCell(e).isCellMergeContinue=!0,this.rows.getRow(n).cells.getCell(e).isRowMergeContinue=!0,t--;t=u.columnSpan,e=l}}else if(u.columnSpan>1&&1===u.rowSpan){t=u.columnSpan,e=l,u.isCellMergeStart=!0;while(t>1)e++,a.cells.getCell(e).isCellMergeContinue=!0,t--}else if(1===u.columnSpan&&u.rowSpan>1){i=u.rowSpan,n=s;while(i>1)n++,this.rows.getRow(n).cells.getCell(l).isRowMergeContinue=!0,i--}}}a.maximumRowSpan=r}},e.prototype.measureColumnsWidth=function(t){if("undefined"!==typeof t){this.isPageWidth=!1;for(var e=this.columns.getDefaultWidths(t.width-t.x),i=0,r=this.columns.count;i<r;i++)this.columns.getColumn(i).columnWidth=e[i],this.tempWidth=e[i];if(null!=this.ParentCell&&0==this.style.allowHorizontalOverflow&&0==this.ParentCell.row.grid.style.allowHorizontalOverflow){var n=0,o=0,s=this.columns.count,a=0;null==this.ParentCell.style.cellPadding&&"undefined"===typeof this.ParentCell.style.cellPadding||("undefined"!=typeof this.ParentCell.style.cellPadding.left&&this.ParentCell.style.cellPadding.hasLeftPad&&(n+=this.ParentCell.style.cellPadding.left),"undefined"!=typeof this.ParentCell.style.cellPadding.right&&this.ParentCell.style.cellPadding.hasRightPad&&(n+=this.ParentCell.style.cellPadding.right));for(i=0;i<this.ParentCell.columnSpan;i++)o+=this.ParentCell.row.grid.columns.getColumn(this.parentCellIndex+i).width;for(var h=0;h<this.columns.count;h++)this.gridColumns.getColumn(h).width>0&&this.gridColumns.getColumn(h).isCustomWidth&&(o-=this.gridColumns.getColumn(h).width,s--);if(null==this.ParentCell.row.grid.style.cellPadding&&"undefined"==typeof this.ParentCell.row.grid.style.cellPadding||("undefined"!=typeof this.ParentCell.row.grid.style.cellPadding.top&&this.ParentCell.row.grid.style.cellPadding.hasTopPad&&(n+=this.ParentCell.row.grid.style.cellPadding.top),"undefined"!=typeof this.ParentCell.row.grid.style.cellPadding.bottom&&this.ParentCell.row.grid.style.cellPadding.hasBottomPad&&(n+=this.ParentCell.row.grid.style.cellPadding.bottom)),0!=this.ParentCell.row.grid.style.cellSpacing&&(o-=2*this.ParentCell.row.grid.style.cellSpacing),o>n&&(a=(o-n)/s,this.tempWidth=a,null!=this.ParentCell))for(h=0;h<this.columns.count;h++)this.columns.getColumn(h).isCustomWidth||(this.columns.getColumn(h).columnWidth=a)}}else{e=[this.columns.count];for(var l=0;l<this.columns.count;l++)e[l]=0;var u=0;if(("undefined"===typeof this.isChildGrid&&"undefined"!==typeof this.gridLocation||null===this.isChildGrid&&"undefined"!==typeof this.gridLocation)&&(this.initialWidth=this.gridLocation.width),this.headers.count>0){var c=this.headers.getHeader(0).cells.count,p=this.headers.count;for(i=0;i<c;i++){u=0;for(h=0;h<p;h++){var d=Math.min(this.initialWidth,this.headers.getHeader(h).cells.getCell(i).width);u=Math.max(u,d)}e[i]=u}}u=0;i=0;for(var f=this.columns.count;i<f;i++){for(h=0,p=this.rows.count;h<p;h++)if(1==this.rows.getRow(h).cells.getCell(i).columnSpan&&!this.rows.getRow(h).cells.getCell(i).isCellMergeContinue||null!=this.rows.getRow(h).cells.getCell(i).value){if(null!=this.rows.getRow(h).cells.getCell(i).value&&!this.rows.getRow(h).grid.style.allowHorizontalOverflow)this.rows.getRow(h).grid.style.cellPadding.right,this.rows.getRow(h).grid.style.cellPadding.left,this.rows.getRow(h).cells.getCell(i).style.borders.left.width;d=0;d=this.initialWidth>0?Math.min(this.initialWidth,this.rows.getRow(h).cells.getCell(i).width):this.rows.getRow(h).cells.getCell(i).width,u=Math.max(e[i],Math.max(u,d)),u=Math.max(this.columns.getColumn(i).width,u)}0!=this.rows.count&&(e[i]=u),u=0}i=0;for(var g=this.rows.count;i<g;i++){h=0;for(var m=this.columns.count;h<m;h++)if(this.rows.getRow(i).cells.getCell(h).columnSpan>1){e[h];for(var y=1;y<this.rows.getRow(i).cells.getCell(h).columnSpan;y++)e[h+y]}}for(i=0,r=this.columns.count;i<r;i++)this.columns.getColumn(i).width<=0?this.columns.getColumn(i).columnWidth=e[i]:this.columns.getColumn(i).width>0&&!this.columns.getColumn(i).isCustomWidth&&(this.columns.getColumn(i).columnWidth=e[i]);n=0;var b=0,w=this.columns.count,v=0;b=this.tempWidth;for(h=0;h<this.columns.count;h++)this.gridColumns.getColumn(h).width>0&&this.gridColumns.getColumn(h).isCustomWidth&&(b-=this.gridColumns.getColumn(h).width,w--);if(b>0&&0!=this.ParentCell.row.grid.style.cellSpacing&&(b-=2*this.ParentCell.row.grid.style.cellSpacing),b>n&&(v=b/w,null!=this.ParentCell))for(h=0;h<this.columns.count;h++)this.columns.getColumn(h).isCustomWidth||(this.columns.getColumn(h).columnWidth=v)}},e}(Ui),kr=function(){function t(t,e,i,r,n){t instanceof ct&&"undefined"===typeof e?this.InitiateBounds(t.x,t.y,t.width,t.height,null):t instanceof ct&&e instanceof yi&&"undefined"===typeof i?this.InitiateBounds(t.x,t.y,t.width,t.height,e):t instanceof lt&&e instanceof ut&&"undefined"===typeof i?this.InitiateBounds(t.x,t.y,e.width,e.height,null):t instanceof lt&&e instanceof ut&&i instanceof yi&&"undefined"===typeof r?this.InitiateBounds(t.x,t.y,e.width,e.height,i):t instanceof ut&&"undefined"===typeof e?this.InitiateBounds(0,0,t.width,t.height,null):"number"===typeof t&&"number"===typeof e&&"undefined"===typeof i?this.InitiateBounds(0,0,t,e,null):"number"===typeof t&&"number"===typeof e&&i instanceof yi&&"undefined"===typeof r?this.InitiateBounds(0,0,t,e,i):this.InitiateBounds(t,e,i,r,null)}return Object.defineProperty(t.prototype,"dock",{get:function(){return this.dockStyle},set:function(t){this.dockStyle=t,this.resetAlignment()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"alignment",{get:function(){return this.alignmentStyle},set:function(t){this.setAlignment(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"foreground",{get:function(){return this.isForeground},set:function(t){this.isForeground=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"background",{get:function(){return!this.isForeground},set:function(t){this.isForeground=!t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"location",{get:function(){return this.currentLocation},set:function(t){this.type===nt.None&&(this.currentLocation=t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"x",{get:function(){var t="undefined"!==typeof this.currentLocation?this.currentLocation.x:0;return t},set:function(t){this.type===nt.None&&(this.currentLocation.x=t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){var t="undefined"!==typeof this.currentLocation?this.currentLocation.y:0;return t},set:function(t){this.type===nt.None&&(this.currentLocation.y=t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.template.size},set:function(t){this.type===nt.None&&this.template.reset(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.template.width},set:function(t){if(this.template.width!==t&&this.type===nt.None){var e=this.template.size;e.width=t,this.template.reset(e)}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.template.height},set:function(t){if(this.template.height!==t&&this.type===nt.None){var e=this.template.size;e.height=t,this.template.reset(e)}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"graphics",{get:function(){return this.template.graphics},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"template",{get:function(){return this.pdfTemplate},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){return this.templateType},set:function(t){this.updateDocking(t),this.templateType=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bounds",{get:function(){return new ct(new lt(this.x,this.y),this.size)},set:function(t){this.type===nt.None&&(this.location=new lt(t.x,t.y),this.size=new ut(t.width,t.height))},enumerable:!0,configurable:!0}),t.prototype.InitiateBounds=function(t,e,i,r,n){this.x=t,this.y=e,this.pdfTemplate=new Xe(i,r)},t.prototype.updateDocking=function(t){if(t!==nt.None){switch(t){case nt.Top:this.dock=it.Top;break;case nt.Bottom:this.dock=it.Bottom;break;case nt.Left:this.dock=it.Left;break;case nt.Right:this.dock=it.Right;break}this.resetAlignment()}},t.prototype.resetAlignment=function(){this.alignment=rt.None},t.prototype.setAlignment=function(t){if(this.dock===it.None)this.alignmentStyle=t;else{var e=!1;switch(this.dock){case it.Left:e=t===rt.TopLeft||t===rt.MiddleLeft||t===rt.BottomLeft||t===rt.None;break;case it.Top:e=t===rt.TopLeft||t===rt.TopCenter||t===rt.TopRight||t===rt.None;break;case it.Right:e=t===rt.TopRight||t===rt.MiddleRight||t===rt.BottomRight||t===rt.None;break;case it.Bottom:e=t===rt.BottomLeft||t===rt.BottomCenter||t===rt.BottomRight||t===rt.None;break;case it.Fill:e=t===rt.MiddleCenter||t===rt.None;break}e&&(this.alignmentStyle=t)}},t.prototype.draw=function(t,e){var i=t.page,r=this.calculateBounds(i,e);-0===r.x&&(r.x=0),t.graphics.drawPdfTemplate(this.template,new lt(r.x,r.y),new ut(r.width,r.height))},t.prototype.calculateBounds=function(t,e){var i=this.bounds;return this.alignmentStyle!==rt.None?i=this.getAlignmentBounds(t,e):this.dockStyle!==it.None&&(i=this.getDockBounds(t,e)),i},t.prototype.getAlignmentBounds=function(t,e){var i=this.bounds;return i=this.type===nt.None?this.getSimpleAlignmentBounds(t,e):this.getTemplateAlignmentBounds(t,e),i},t.prototype.getSimpleAlignmentBounds=function(t,e){var i=this.bounds,r=t.section,n=r.getActualBounds(e,t,!1),o=this.x,s=this.y;switch(this.alignmentStyle){case rt.TopLeft:o=0,s=0;break;case rt.TopCenter:o=(n.width-this.width)/2,s=0;break;case rt.TopRight:o=n.width-this.width,s=0;break;case rt.MiddleLeft:o=0,s=(n.height-this.height)/2;break;case rt.MiddleCenter:o=(n.width-this.width)/2,s=(n.height-this.height)/2;break;case rt.MiddleRight:o=n.width-this.width,s=(n.height-this.height)/2;break;case rt.BottomLeft:o=0,s=n.height-this.height;break;case rt.BottomCenter:o=(n.width-this.width)/2,s=n.height-this.height;break;case rt.BottomRight:o=n.width-this.width,s=n.height-this.height;break}return i.x=o,i.y=s,i},t.prototype.getTemplateAlignmentBounds=function(t,e){var i=this.bounds,r=t.section,n=r.getActualBounds(e,t,!1),o=this.x,s=this.y;switch(this.alignmentStyle){case rt.TopLeft:this.type===nt.Left?(o=-n.x,s=0):this.type===nt.Top&&(o=-n.x,s=-n.y);break;case rt.TopCenter:o=(n.width-this.width)/2,s=-n.y;break;case rt.TopRight:this.type===nt.Right?(o=n.width+r.getRightIndentWidth(e,t,!1)-this.width,s=0):this.type===nt.Top&&(o=n.width+r.getRightIndentWidth(e,t,!1)-this.width,s=-n.y);break;case rt.MiddleLeft:o=-n.x,s=(n.height-this.height)/2;break;case rt.MiddleCenter:o=(n.width-this.width)/2,s=(n.height-this.height)/2;break;case rt.MiddleRight:o=n.width+r.getRightIndentWidth(e,t,!1)-this.width,s=(n.height-this.height)/2;break;case rt.BottomLeft:this.type===nt.Left?(o=-n.x,s=n.height-this.height):this.type===nt.Bottom&&(o=-n.x,s=n.height+r.getBottomIndentHeight(e,t,!1)-this.height);break;case rt.BottomCenter:o=(n.width-this.width)/2,s=n.height+r.getBottomIndentHeight(e,t,!1)-this.height;break;case rt.BottomRight:this.type===nt.Right?(o=n.width+r.getRightIndentWidth(e,t,!1)-this.width,s=n.height-this.height):this.type===nt.Bottom&&(o=n.width+r.getRightIndentWidth(e,t,!1)-this.width,s=n.height+r.getBottomIndentHeight(e,t,!1)-this.height);break}return i.x=o,i.y=s,i},t.prototype.getDockBounds=function(t,e){var i=this.bounds;return i=this.type===nt.None?this.getSimpleDockBounds(t,e):this.getTemplateDockBounds(t,e),i},t.prototype.getSimpleDockBounds=function(t,e){var i=this.bounds,r=t.section,n=r.getActualBounds(e,t,!1),o=this.x,s=this.y,a=this.width,h=this.height;switch(this.dockStyle){case it.Left:o=0,s=0,a=this.width,h=n.height;break;case it.Top:o=0,s=0,a=n.width,h=this.height;break;case it.Right:o=n.width-this.width,s=0,a=this.width,h=n.height;break;case it.Bottom:o=0,s=n.height-this.height,a=n.width,h=this.height;break;case it.Fill:o=0,o=0,a=n.width,h=n.height;break}return i=new ct(o,s,a,h),i},t.prototype.getTemplateDockBounds=function(t,e){var i=this.bounds,r=t.section,n=r.getActualBounds(e,t,!1),o=r.pageSettings.getActualSize(),s=this.x,a=this.y,h=this.width,l=this.height;switch(this.dockStyle){case it.Left:s=-n.x,a=0,h=this.width,l=n.height;break;case it.Top:s=-n.x,a=-n.y,h=o.width,l=this.height,n.height<0&&(a=-n.y+o.height);break;case it.Right:s=n.width+r.getRightIndentWidth(e,t,!1)-this.width,a=0,h=this.width,l=n.height;break;case it.Bottom:s=-n.x,a=n.height+r.getBottomIndentHeight(e,t,!1)-this.height,h=o.width,l=this.height,n.height<0&&(a-=o.height);break;case it.Fill:s=0,s=0,h=n.width,l=n.height;break}return i=new ct(s,a,h,l),i},t}(),Fr=function(){function t(){}return t.convert=function(t,e){var i="";switch(e){case et.None:i="";break;case et.Numeric:i=t.toString();break;case et.LowerLatin:i=this.arabicToLetter(t).toLowerCase();break;case et.LowerRoman:i=this.arabicToRoman(t).toLowerCase();break;case et.UpperLatin:i=this.arabicToLetter(t);break;case et.UpperRoman:i=this.arabicToRoman(t);break}return i},t.arabicToRoman=function(t){var e="",i=this.generateNumber(t,1e3,"M");e+=i.returnValue,t=i.intArabic;var r=this.generateNumber(t,900,"CM");e+=r.returnValue,t=r.intArabic;var n=this.generateNumber(t,500,"D");e+=n.returnValue,t=n.intArabic;var o=this.generateNumber(t,400,"CD");e+=o.returnValue,t=o.intArabic;var s=this.generateNumber(t,100,"C");e+=s.returnValue,t=s.intArabic;var a=this.generateNumber(t,90,"XC");e+=a.returnValue,t=a.intArabic;var h=this.generateNumber(t,50,"L");e+=h.returnValue,t=h.intArabic;var l=this.generateNumber(t,40,"XL");e+=l.returnValue,t=l.intArabic;var u=this.generateNumber(t,10,"X");e+=u.returnValue,t=u.intArabic;var c=this.generateNumber(t,9,"IX");e+=c.returnValue,t=c.intArabic;var p=this.generateNumber(t,5,"V");e+=p.returnValue,t=p.intArabic;var d=this.generateNumber(t,4,"IV");e+=d.returnValue,t=d.intArabic;var f=this.generateNumber(t,1,"I");return e+=f.returnValue,t=f.intArabic,e.toString()},t.arabicToLetter=function(t){var e=this.convertToLetter(t),i="";while(e.length>0){var r=e.pop();i=this.appendChar(i,r)}return i.toString()},t.generateNumber=function(t,e,i){var r="";while(t>=e)t-=e,r+=i;return{returnValue:r.toString(),intArabic:t}},t.convertToLetter=function(t){if(t<=0)throw Error("ArgumentOutOfRangeException-arabic, Value can not be less 0");var e=[];while(t>this.letterLimit){var i=t%this.letterLimit;0===i?(t=t/this.letterLimit-1,i=this.letterLimit):t/=this.letterLimit,e.push(i)}return e.push(t),e},t.appendChar=function(e,i){var r=String.fromCharCode(t.acsiiStartIndex+i);return e+=r,e},t.letterLimit=26,t.acsiiStartIndex=64,t}(),Mr=function(){function t(t,e){this.pdfTemplate=null,this.content="","undefined"===typeof t||(this.template=t,this.value=e)}return Object.defineProperty(t.prototype,"template",{get:function(){return this.pdfTemplate},set:function(t){this.pdfTemplate=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this.content},set:function(t){this.content=t},enumerable:!0,configurable:!0}),t}(),Ar=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},t(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Er=function(t){function e(){var e=t.call(this)||this;return e.list=new ae,e}return Ar(e,t),e.prototype.performDraw=function(e,i,r,n){t.prototype.performDrawHelper.call(this,e,i,r,n);var o=this.getValue(e),s=new Xe(this.getSize());this.list.setValue(e,new Mr(s,o));s.graphics;var a=this.getSize();s.graphics.drawString(o,this.getFont(),this.pen,this.getBrush(),0,0,a.width,a.height,this.stringFormat);var h=new lt(i.x+this.location.x,i.y+this.location.y);e.drawPdfTemplate(s,h,new ut(s.width*r,s.height*n))},e}(pe),Nr=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},t(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Dr=function(t){function e(e,i){var r=t.call(this)||this;return r.internalNumberStyle=et.Numeric,"undefined"===typeof i?r.font=e:i instanceof Ut?(r.font=e,r.brush=i):(r.font=e,r.bounds=i),r}return Nr(e,t),Object.defineProperty(e.prototype,"numberStyle",{get:function(){return this.internalNumberStyle},set:function(t){this.internalNumberStyle=t},enumerable:!0,configurable:!0}),e.prototype.getValue=function(t){var e=null,i=this.getPageFromGraphics(t);return e=this.internalGetValue(i),e},e.prototype.internalGetValue=function(t){var e=t.document,i=e.pages.indexOf(t)+1;return Fr.convert(i,this.numberStyle)},e}(Er),Vr=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},t(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),zr=function(t){function e(e,i,r){for(var n=[],o=3;o<arguments.length;o++)n[o-3]=arguments[o];var s=t.call(this)||this;return s.internalAutomaticFields=null,s.internalText="",s.font=e,s.brush=i,s.text=r,s.automaticFields=n,s}return Vr(e,t),Object.defineProperty(e.prototype,"text",{get:function(){return this.internalText},set:function(t){this.internalText=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"automaticFields",{get:function(){return this.internalAutomaticFields},set:function(t){this.internalAutomaticFields=t},enumerable:!0,configurable:!0}),e.prototype.getValue=function(t){var e=this.text.toString();if("undefined"!==typeof this.automaticFields&&null!=this.automaticFields&&this.automaticFields.length>0)for(var i=0;i<this.automaticFields.length;i++){var r=this.automaticFields[i];e=e.replace("{"+i+"}",r.getValue(t))}return e},e}(Er),Gr=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},t(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Wr=function(t){function e(){var e=t.call(this)||this;return e.list=new ae,e.painterGraphics=[],e}return Gr(e,t),e.prototype.performDraw=function(e,i,r,n){t.prototype.performDrawHelper.call(this,e,i,r,n);var o=this.getPageFromGraphics(e),s=o.document,a=this.getValue(e);if(this.list.containsKey(s)){var h=this.list.getValue(s),l=new lt(i.x+this.location.x,i.y+this.location.y);e.drawPdfTemplate(h.template,l,new ut(h.template.width*r,h.template.height*n)),this.painterGraphics.push(e)}else{var u=this.getSize(),c=new Xe(u);this.list.setValue(s,new Mr(c,a)),c.graphics.drawString(a,this.getFont(),this.pen,this.getBrush(),0,0,u.width,u.height,this.stringFormat);l=new lt(i.x+this.location.x,i.y+this.location.y);e.drawPdfTemplate(c,l,new ut(c.width*r,c.height*n)),this.painterGraphics.push(e)}},e}(pe),Hr=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},t(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),_r=function(t){function e(e,i){var r=t.call(this)||this;return r.internalNumberStyle=et.Numeric,"undefined"===typeof i?r.font=e:i instanceof Ut?(r.font=e,r.brush=i):(r.font=e,r.bounds=i),r}return Hr(e,t),Object.defineProperty(e.prototype,"numberStyle",{get:function(){return this.internalNumberStyle},set:function(t){this.internalNumberStyle=t},enumerable:!0,configurable:!0}),e.prototype.getValue=function(t){var e=null,i=this.getPageFromGraphics(t),r=i.section.parent.document,n=r.pages.count;return e=Fr.convert(n,this.numberStyle),e},e}(Wr),Ur=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},t(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),qr=function(t){function e(e,i,r){var n=t.call(this,i)||this;return n.isEmbedFont=!1,n.isUnicode=!0,void 0!==r?n.createFontInternal(e,r):n.createFontInternal(e,Lt.Regular),n}return Ur(e,t),e.prototype.equalsToFont=function(t){var e=!1;return e},e.prototype.getLineWidth=function(t,e){var i=0;if(null!==e&&"undefined"!==typeof e&&e.textDirection!==Tt.None){var r=this.getUnicodeLineWidth(t,i,e);i=r.width}else i=this.fontInternal.getLineWidth(t);var n=this.metrics.getSize(e);return i*=re.charSizeMultiplier*n,i=this.applyFormatSettings(t,e,i),i},e.prototype.getCharWidth=function(t,e){var i=this.fontInternal.getCharWidth(t),r=this.metrics.getSize(e);return i*=.001*r,i},e.prototype.createFontInternal=function(t,e){this.fontInternal=new De(t,this.size),this.calculateStyle(e),this.initializeInternals()},e.prototype.calculateStyle=function(t){var e=this.fontInternal.ttfMetrics.macStyle;0!==(t&Lt.Underline)&&(e|=Lt.Underline),0!==(t&Lt.Strikeout)&&(e|=Lt.Strikeout),this.setStyle(e)},e.prototype.initializeInternals=function(){var t=null;ki.enableCache&&(t=ki.cache.search(this));var e=null;if(null!==t&&void 0!==t){e=t.getInternals();var i=t.metrics;i=i.clone(),i.size=this.size,this.metrics=i,this.fontInternal=t.fontInternal}else null==t&&(this.fontInternal instanceof De&&(this.fontInternal.isEmbed=this.isEmbedFont),this.fontInternal.createInternals(),e=this.fontInternal.getInternals(),this.metrics=this.fontInternal.metrics);this.metrics.isUnicodeFont=!0,this.setInternals(e)},e.prototype.setSymbols=function(t){var e=this.fontInternal;null!=e&&e.setSymbols(t)},Object.defineProperty(e.prototype,"Unicode",{get:function(){return this.isUnicode},enumerable:!0,configurable:!0}),e.prototype.getUnicodeLineWidth=function(t,e,i){e=0;var r=null,n=new He,o=n.getGlyphIndex(t,this,i.textDirection===Tt.RightToLeft,r,!0),s=o.success;if(r=o.glyphs,s&&null!==r)for(var a=this.fontInternal.ttfReader,h=0,l=r.length;h<l;h++){var u=r[h],c=a.getGlyph(u);null!==c&&"undefined"!==typeof c&&(e+=c.width)}return{success:s,width:e}},e}(re),Kr=i("e9ec"),Xr=i("949c"),Jr=i("ef97"),Yr=i("7c10"),Qr=i("4f3e"),Zr=i("2d85"),$r=function(){function t(t,e){this.hideColumnInclude=!1,this.foreignKeyData={},this.parent=t,!t.parentDetails&&e&&(this.foreignKeyData=e)}return t.getQuery=function(t,e){var i=e.generateQuery(!0).requiresCount();return e.isRemote()&&(t.groupSettings.enableLazyLoading&&t.groupSettings.columns.length?i.lazyLoad=[]:i.take(t.pageSettings.totalRecordsCount)),i},t.prototype.getFData=function(t,e){var i=Object(c["H"])(e,{},t,this.foreignKeyData[e.field])[0];return i},t.prototype.getGridRowModel=function(t,e,i,r){void 0===r&&(r=0);var n=[],o=e.length;if(o){for(var s=0;s<o;s++,r++){var a={isExpand:!1};a.data=e[s],a.index=r,i.childGrid&&("All"===i.hierarchyPrintMode?a.isExpand=!0:"Expanded"===i.hierarchyPrintMode&&this.parent.expandedRows&&this.parent.expandedRows[r]&&(a.isExpand=i.expandedRows[r].isExpand));var h=new Kr["a"](a);h.cells=this.generateCells(t,i),n.push(h)}this.processColumns(n)}return n},t.prototype.generateCells=function(t,e){var i=[];if(e.childGridLevel)for(var r=e.childGridLevel,n=0;r>n;n++)i.push(this.generateCell({},Xr["a"].Indent));for(var o=0,s=t;o<s.length;o++){var a=s[o];i.push(this.generateCell(a,Xr["a"].Data))}return i},t.prototype.getColumnData=function(t){var e,i=this,r=[],n=t.getForeignKeyColumns();if(n.length){for(var o=0;o<n.length;o++){var s="result"in n[o].dataSource?new Qr["a"](n[o].dataSource.result):n[o].dataSource;r.push(s.executeQuery(new Zr["b"]))}e=Promise.all(r).then(function(t){for(var e=0;e<n.length;e++)i.foreignKeyData[n[e].field]=t[e].result})}return e},t.prototype.getHeaders=function(t,e){this.hideColumnInclude=!!e,this.colDepth=Object(c["gb"])(t);for(var i=[],r=0;r<this.colDepth;r++)i[r]=new Kr["a"]({}),i[r].cells=[];return i=this.processColumns(i),i=this.processHeaderCells(i,t),{rows:i,columns:this.generateActualColumns(t)}},t.prototype.getConvertedWidth=function(t){var e=parseFloat(t);return-1!==t.indexOf("%")?this.parent.element.getBoundingClientRect().width*e/100:e},t.prototype.generateActualColumns=function(t,e){void 0===e&&(e=[]);for(var i=0,r=t;i<r.length;i++){var n=r[i];if(!n.commands)if(n.columns){if(n.visible||this.hideColumnInclude){var o=this.getCellCount(n,0);0!==o&&this.generateActualColumns(n.columns,e)}}else(n.visible||this.hideColumnInclude)&&e.push(n)}return e},t.prototype.processHeaderCells=function(t,e){for(var i=e,r=0;r<i.length;r++)i[r].commands||(t=this.appendGridCells(i[r],t,0));return t},t.prototype.appendGridCells=function(t,e,i){if(t.columns||!1===t.visible&&!this.hideColumnInclude||t.commands){if(t.columns){var r=this.getCellCount(t,0);r&&e[i].cells.push(new Jr["a"]({cellType:Xr["a"].StackedHeader,column:t,colSpan:r}));for(var n=void 0,o=0,s=t.columns.length;o<s;o++)t.columns[o].visible&&!n&&(n=!0),e=this.appendGridCells(t.columns[o],e,i+1)}}else e[i].cells.push(this.generateCell(t,Xr["a"].Header,this.colDepth-i,i));return e},t.prototype.generateCell=function(t,e,i,r){var n={visible:t.visible,isDataCell:e===Xr["a"].Data,column:t,cellType:e,rowSpan:i,index:r};return(!n.rowSpan||n.rowSpan<2)&&delete n.rowSpan,new Jr["a"](n)},t.prototype.processColumns=function(t){var e=this.parent,i=[];e.enableColumnVirtualization&&(i=e.getColumnIndexesInView());for(var r=0,n=t.length;r<n;r++)if(e.allowGrouping)for(var o=0,s=e.groupSettings.columns.length-1;o<s;o++)e.enableColumnVirtualization&&-1===i.indexOf(o)||t[r].cells.splice(0,0,this.generateCell({},Xr["a"].HeaderIndent));return t},t.prototype.getCellCount=function(t,e){if(t.columns)for(var i=0;i<t.columns.length;i++)e=this.getCellCount(t.columns[i],e);else(t.visible||this.hideColumnInclude)&&e++;return e},t.prototype.checkAndExport=function(t,e){var i=Object.keys(t).some(function(e){return!t[e]});i||e()},t.prototype.failureHandler=function(t,e,i){var r=this;return function(){t[e.id]=!0,r.checkAndExport(t,i)}},t.prototype.createChildGrid=function(t,e,i,r){var n=new o["a"](this.parent.detailRowModule.getGridModel(t,e,i));t.isPrinting=!1;var a="parentDetails";n[a]={parentID:t.element.id,parentPrimaryKeys:t.getPrimaryKeyFieldNames(),parentKeyField:t.childGrid.queryString,parentKeyFieldValue:Object(s["R"])(n.queryString,e.data),parentRowData:e.data};var h=Object(c["T"])("child-grid"),l=Object(s["C"])("div",{id:h,styles:"display: none"});return document.body.appendChild(l),n.id=h,r[h]=!1,n.isExportGrid=!0,{childGrid:n,element:l}},t.prototype.getGridExportColumns=function(t){for(var e=[],i=0,r=t;i<r.length;i++)"checkbox"!==r[i].type&&e.push(r[i]);return e},t.prototype.getForeignKeyData=function(){return this.foreignKeyData},t}(),tn=function(){function t(t){this.valueFormatter=new Yr["a"](t),this.internationalization=new s["m"](t)}return t.prototype.returnFormattedValue=function(t,e){return!Object(s["T"])(t.value)&&t.value?this.valueFormatter.getFormatFunction(e)(t.value):""},t.prototype.formatCellValue=function(t){if(t.isForeignKey&&(t.value=Object(s["R"])(t.column.foreignKeyValue,Object(c["H"])(t.column,{},t.value)[0])),"number"===t.column.type&&void 0!==t.column.format&&""!==t.column.format)return"string"===typeof t.column.format&&(t.column.format={format:t.column.format}),t.value||0===t.value?this.internationalization.getNumberFormat(t.column.format)(t.value):"";if("boolean"===t.column.type&&""!==t.value)return t.value?"true":"false";if("date"!==t.column.type&&"datetime"!==t.column.type&&"time"!==t.column.type||void 0===t.column.format)return(Object(s["T"])(t.column.type)||Object(s["T"])(t.value))&&Object(s["T"])(t.value)?"":t.value.toString();if("string"===typeof t.value&&(t.value=new Date(t.value)),"string"===typeof t.column.format){var e=void 0,i=t.column.format;return e="date"===t.column.type?{type:"date",skeleton:i}:"time"===t.column.type?{type:"time",skeleton:i}:{type:"dateTime",skeleton:i},this.returnFormattedValue(t,e)}if(t.column.format instanceof Object&&void 0===t.column.format.type)return t.value.toString();var r=void 0;return r="date"===t.column.type?{type:t.column.format.type,format:t.column.format.format,skeleton:t.column.format.skeleton}:"time"===t.column.type?{type:"time",format:t.column.format.format,skeleton:t.column.format.skeleton}:{type:"dateTime",format:t.column.format.format,skeleton:t.column.format.skeleton},this.returnFormattedValue(t,r)},t}(),en=i("2e78"),rn=i("3cf0"),nn=function(){function t(t){this.hideColumnInclude=!1,this.currentViewData=!1,this.customDataSource=!1,this.isGrouping=!1,this.headerOnPages=[],this.drawPosition={xPosition:0,yPosition:0},this.parent=t,this.helper=new $r(t),this.gridPool={}}return t.prototype.getModuleName=function(){return"PdfExport"},t.prototype.init=function(t){this.exportValueFormatter=new tn(t.locale),this.pdfDocument=void 0,this.hideColumnInclude=!1,this.currentViewData=!1,this.parent=t,this.isGrouping=!1,this.isExporting=!0,t.id=Object(c["T"])("main-grid"),this.gridPool[t.id]=!1,this.pdfPageSettings=new Gt},t.prototype.exportWithData=function(t,e,i,r,n,o,a){var l=this;this.init(t),Object(s["T"])(e)?this.pdfDocument=new ki:this.pdfDocument=e,this.processExport(t,r,n,o).then(function(){l.isExporting=!1,t.trigger(h["Vc"],l.isBlob?{promise:l.blobPromise}:{}),l.parent.log("exporting_complete",l.getModuleName()),i(l.pdfDocument)}).catch(function(t){a(l.pdfDocument),l.parent.trigger(h["c"],t)})},t.prototype.Map=function(t,e,i,r,n){var o=this;this.data=new en["a"](this.parent),this.isBlob=n,this.gridPool={};var a=new Zr["b"];t.childGrid&&(Object(s["T"])(e)||"None"!==e.hierarchyExportMode)&&(t.expandedRows=Object(c["P"])(t).expandedRows);var l={requestType:"beforePdfExport",cancel:!1,headerPageNumbers:[],gridDrawPosition:{xPosition:0,yPosition:0},generateQuery:!1},u="gridObject";l[u]=t;var p="cancel",d="generateQuery",f="headerPageNumbers",g="gridDrawPosition";if(t.trigger(h["D"],l),!0===l[p])return new Promise(function(t,e){return t()});if(Object(c["bb"])(e)&&Object(c["Gb"])(e,t),l[d]&&(a=$r.getQuery(t,this.data)),this.headerOnPages=l[f],this.drawPosition=l[g],this.parent.log("exporting_begin",this.getModuleName()),!Object(s["T"])(e)&&!Object(s["T"])(e.dataSource)&&e.dataSource instanceof Qr["a"])return new Promise(function(n,s){e.dataSource.executeQuery(a).then(function(a){o.exportWithData(t,r,n,a,e,i,s)})});if(Object(s["T"])(e)||"CurrentPage"!==e.exportType){var m=[];return m.push(this.data.getData({},$r.getQuery(t,this.data))),m.push(this.helper.getColumnData(t)),new Promise(function(n,a){Promise.all(m).then(function(l){o.init(t),Object(s["T"])(r)?o.pdfDocument=new ki:o.pdfDocument=r,o.processExport(t,l[0],e,i).then(function(){o.isExporting=!1,t.trigger(h["Vc"],o.isBlob?{promise:o.blobPromise}:{}),o.parent.log("exporting_complete",o.getModuleName()),n(o.pdfDocument)}).catch(function(t){a(o.pdfDocument),o.parent.trigger(h["c"],t)})})})}return new Promise(function(n,s){o.exportWithData(t,r,n,o.parent.getCurrentViewRecords(),e,i,s)})},t.prototype.processExport=function(t,e,i,r){var n,o=this,a=this.pdfDocument.sections.add();this.processSectionExportProperties(a,i);var h=a.pages.add();return new Promise(function(r,s){n=o.processGridExport(t,e,i),o.globalResolve=r,o.gridPool[t.id]=!0,o.helper.checkAndExport(o.gridPool,o.globalResolve)}).then(function(){var e="xPosition",a="yPosition";return n.draw(h,o.drawPosition[e],o.drawPosition[a]),o.drawHeader(i),r||(o.isBlob?o.blobPromise=o.pdfDocument.save():!Object(s["T"])(i)&&i.fileName?o.pdfDocument.save(i.fileName):o.pdfDocument.save("Export.pdf"),o.pdfDocument.destroy(),delete t.expandedRows),o.pdfDocument})},t.prototype.processSectionExportProperties=function(t,e){return Object(s["T"])(e)||Object(s["T"])(e.pageOrientation)&&Object(s["T"])(e.pageSize)||(this.pdfPageSettings.orientation="Landscape"===e.pageOrientation?$.Landscape:$.Portrait,this.pdfPageSettings.size=this.getPageSize(e.pageSize),t.setPageSettings(this.pdfPageSettings)),t},t.prototype.processGridExport=function(t,e,i){var r=!0,n=this.parent.isFrozenGrid()&&!this.parent.getFrozenColumns();Object(s["T"])(i)||(this.gridTheme=i.theme,r=!!Object(s["T"])(i.allowHorizontalOverflow)||i.allowHorizontalOverflow);var o=new $r(t,this.helper.getForeignKeyData()),a=this.processExportProperties(i,e.result),h=Object(c["bb"])(i)?Object(c["jb"])(i.columns,t.enableColumnVirtualization):o.getGridExportColumns(n?t.getColumns():t.columns);h=h.filter(function(t){return Object(s["T"])(t.commands)});var l=!1;t.groupSettings.columns.length&&(l=!0),t.childGrid&&!Object(s["T"])(i)&&(t.hierarchyPrintMode=i.hierarchyExportMode||"Expanded");var u=new Rr,p=this.getHeaderThemeStyle(),d=p.border,f=p.font,g=p.brush,m=o.getHeaders(h,this.hideColumnInclude),y=m.columns;u=this.processGridHeaders(t.groupSettings.columns.length,u,m.rows,y,d,f,g,t,r,h),this.setColumnProperties(y,u,o,t,r);var b=this.getSummaryCaptionThemeStyle();if(!Object(s["T"])(a)&&a.length){if(l?(Object(s["T"])(b.border)||(d=b.border),this.processGroupedRecords(u,a,y,t,d,0,b.font,b.brush,b.backgroundBrush,e,i,o,0)):this.processRecord(d,y,t,a,u,0,i,o,0),!Object(s["T"])(e.aggregates)){var w=new rn["c"](t),v=void 0,S=w.getColumns();S=S.filter(function(t){return Object(s["T"])(t.commands)&&"checkbox"!==t.type}),t.aggregates.length&&this.parent!==t&&t.aggregateModule.prepareSummaryInfo(),v=this.customDataSource?w.generateRows(a,e.aggregates):this.currentViewData?w.generateRows(this.parent.getCurrentViewRecords(),e.aggregates):l?w.generateRows(a.records,e.aggregates):w.generateRows(e.result,e.aggregates,null,null,S),this.processAggregates(v,u,d,b.font,b.brush,b.backgroundBrush,!1,null,null,null,!l)}}else{var C=u.rows.addRow();C.style.setBorder(d)}return u},t.prototype.getSummaryCaptionThemeStyle=function(){if(Object(s["T"])(this.gridTheme)||Object(s["T"])(this.gridTheme.caption))return{font:new Ii(jt.Helvetica,9.75),brush:new Kt(new _t(0,0,0)),backgroundBrush:new Kt(new _t(246,246,246))};var t=Object(s["T"])(this.gridTheme.caption.fontSize)?9.75:this.gridTheme.caption.fontSize,e=Object(s["T"])(this.gridTheme.caption.fontName)?jt.Helvetica:this.getFontFamily(this.gridTheme.caption.fontName),i=this.getFontStyle(this.gridTheme.caption),r=new _t(0,0,0);if(!Object(s["T"])(this.gridTheme.caption.fontColor)){var n=this.hexToRgb(this.gridTheme.caption.fontColor);r=new _t(n.r,n.g,n.b)}var o=this.gridTheme.caption.border?this.getBorderStyle(this.gridTheme.caption.border):null,a=new Ii(e,t,i);return Object(s["T"])(this.gridTheme.caption.font)||(a=this.gridTheme.caption.font),{font:a,brush:new Kt(r),backgroundBrush:new Kt(new _t(246,246,246)),border:o}},t.prototype.getGridPdfFont=function(t){var e="fontFamily",i="fontSize",r="fontStyle",n="isTrueType",o=0;if(t.header&&t.header.font){var a=t.header.font[e],h=t.header.font[i],l=t.header.font[r];if(o=Object(s["T"])(Lt[l])?0:Lt[l],t.header.font[n])t.header.font=new qr(a,h,o);else{var u=Object(s["T"])(a)?jt.Helvetica:this.getFontFamily(a);t.header.font=new Ii(u,h,o)}}if(t.caption&&t.caption.font){var c=t.caption.font[e],p=t.caption.font[i],d=t.caption.font[r];if(o=Object(s["T"])(Lt[d])?0:Lt[d],t.caption.font[n])t.caption.font=new qr(c,p,o);else{var f=Object(s["T"])(c)?jt.Helvetica:this.getFontFamily(c);t.caption.font=new Ii(f,p,o)}}if(t.record&&t.record.font){var g=t.record.font[e],m=t.record.font[i],y=t.record.font[r];if(o=Object(s["T"])(Lt[y])?0:Lt[y],t.record.font[n])t.record.font=new qr(g,m,o);else{var b=Object(s["T"])(g)?jt.Helvetica:this.getFontFamily(g);t.record.font=new Ii(b,m,o)}}},t.prototype.getHeaderThemeStyle=function(){var t=new Fi;if(Object(s["T"])(this.gridTheme)||Object(s["T"])(this.gridTheme.header))return t.all=new Xt(new _t(234,234,234)),{border:t,font:new Ii(jt.Helvetica,10.5),brush:new Kt(new _t(102,102,102))};var e=Object(s["T"])(this.gridTheme.header.fontName)?jt.Helvetica:this.getFontFamily(this.gridTheme.header.fontName),i=this.getFontStyle(this.gridTheme.header),r=Object(s["T"])(this.gridTheme.header.fontSize)?10.5:this.gridTheme.header.fontSize,n=new _t;if(!Object(s["T"])(this.gridTheme.header.fontColor)){var o=this.hexToRgb(this.gridTheme.header.fontColor);n=new _t(o.r,o.g,o.b)}var a=new Ii(e,r,i);return Object(s["T"])(this.gridTheme.header.font)||(a=this.gridTheme.header.font),{border:this.getBorderStyle(this.gridTheme.header.border),font:a,brush:new Kt(n)}},t.prototype.processGroupedRecords=function(t,e,i,r,n,o,a,l,u,c,p,d,f){for(var g=this,m=o,y=function(o){var y=t.rows.addRow(),w=r.getColumnByField(o.field),v={value:o.key,column:w,style:void 0,isForeignKey:w.isForeignColumn()},S=b.parent.getColumnByField(o.field).headerText+": "+(w.enableGroupByFormat?o.key:b.exportValueFormatter.formatCellValue(v))+" - "+o.count+(e.count>1?" items":" item"),C={captionText:S,type:"PDF",data:o,style:void 0};b.parent.trigger(h["Yb"],C,function(h){var b;y.cells.getCell(m).value=h.captionText,y.cells.getCell(m).style.stringFormat=new Jt(mt.Left),y.style.setBorder(n),y.style.setFont(a),y.style.setTextBrush(l),y.style.setBackgroundBrush(u),Object(s["T"])(h.style)||g.processCellStyle(y.cells.getCell(m),h);var w=new rn["a"](r);if(b=Object(s["T"])(o.items.records)?w.generateRows(o.items,o):w.generateRows(o.items.records,o),Object(s["T"])(b)||0!==b.length||(y.cells.getCell(m+1).columnSpan=t.columns.count-(m+1)),!Object(s["T"])(e.childLevels)&&e.childLevels>0){g.processAggregates(b,t,n,a,l,u,!0,y,m),g.processGroupedRecords(t,o.items,i,r,n,m+1,a,l,u,c,p,d,f);var v=new rn["b"](r);b=v.generateRows(o.items.records,o),g.processAggregates(b,t,n,a,l,u,!1)}else{g.processAggregates(b,t,n,a,l,u,!0,y,m),f=g.processRecord(n,i,r,o.items,t,m+1,p,d,f);v=new rn["b"](r);b=v.generateRows(o.items,o);var S=!0;g.processAggregates(b,t,n,a,l,u,!1,null,null,S)}})},b=this,w=0,v=e;w<v.length;w++){var S=v[w];y(S)}},t.prototype.processGridHeaders=function(t,e,i,r,n,o,a,l,u,p){for(var d=this,f=r.length+t,g=Object(c["gb"])(p),m=p,y=0,b=[],w=0;w<i.length;w++)b[w]=0;this.parent.groupSettings.columns.length&&(y=this.parent.groupSettings.columns.length-1,f-=1),e.columns.add(f),e.headers.add(i.length);var v=function(t,r,l,u,c){var p=e.headers.getHeader(t),f=p.cells.getCell(r),g=i[t].cells[d.parent.groupSettings.columns.length?r:b[t]];b[t]=b[t]+1,Object(s["T"])(l.headerTextAlign)||(f.style.stringFormat=d.getHorizontalAlignment(l.headerTextAlign)),u>0&&(f.rowSpan=u,f.style.stringFormat=d.getVerticalAlignment("Bottom",f.style.stringFormat,l.textAlign)),c>0&&(f.columnSpan=c),p.style.setBorder(n),p.style.setFont(o),p.style.setTextBrush(a),f.value=l.headerText,Object(s["T"])(g)||g.cellType!==Xr["a"].HeaderIndent&&g.cellType!==Xr["a"].DetailHeader||(f.value="",f.width=20);var m={cell:f,gridCell:g,style:f.style};d.parent.trigger(h["Wc"],m);var y=m,w=m.style.borders,v=m.style.font,S=m.style.textBrush;Object(s["T"])(w)||p.style.setBorder(w),Object(s["T"])(v)||p.style.setFont(v),Object(s["T"])(S)||p.style.setTextBrush(S),Object(s["T"])(y.style.verticalAlignment)||(f.style.stringFormat=d.getVerticalAlignment(y.style.verticalAlignment,f.style.stringFormat)),Object(s["T"])(y.image)||(f.value=new ti(y.image.base64)),Object(s["T"])(y.hyperLink)||(f.value=d.setHyperLink(y))},S=function(t,e,i,r,n,o){for(var s=0,a=0;a<t.length;a++)if(o&&(s=s+i+(0===a?0:-1),r=s,i=0),o||t[a].visible||(r-=1),t[a].columns&&t[a].columns.length){var h=S(t[a].columns,e-1,0,a+r,n+1,!1);v(n,a+r+y,t[a],0,h),i+=h,r=r+h-1}else(t[a].visible||d.hideColumnInclude)&&(i++,v(n,a+r+y,t[a],e,0));return i};return S(m,g,0,0,0,!0),e.columns.count>=6&&u&&(e.style.allowHorizontalOverflow=!0),e},t.prototype.processExportProperties=function(t,e){if(Object(s["T"])(t))this.currentViewData=!1,this.customDataSource=!1;else{Object(s["T"])(t.theme)||(this.gridTheme=t.theme);var i=this.pdfPageSettings.size;if(this.drawHeader(t),!Object(s["T"])(t.footer)){var r=t.footer,n=new lt(0,i.width-80-.75*r.fromBottom),o=new ut(i.width-80,.75*r.height),a=new ct(n,o);this.pdfDocument.template.bottom=this.drawPageTemplate(new kr(a),r)}Object(s["T"])(t.includeHiddenColumn)||this.isGrouping||(this.hideColumnInclude=t.includeHiddenColumn),Object(s["T"])(t.dataSource)?Object(s["T"])(t.exportType)?(this.currentViewData=!1,this.customDataSource=!1):"CurrentPage"===t.exportType?(e=this.parent.currentViewData,this.currentViewData=!0,this.customDataSource=!1):(this.currentViewData=!1,this.customDataSource=!1):(t.dataSource instanceof Qr["a"]||(e=t.dataSource),this.customDataSource=!0,this.currentViewData=!1)}return e},t.prototype.drawHeader=function(t){var e=this,i=this.pdfPageSettings.size;if(!Object(s["T"])(t)&&!Object(s["T"])(t.header)){var r=t.header,n=new lt(0,r.fromTop),o=new ut(i.width-80,.75*r.height),a=new ct(n,o);if(this.headerOnPages.length){var h=this.drawPageTemplate(new kr(a),r);this.headerOnPages.filter(function(t){t-1>=0&&t-1<e.pdfDocument.pages.count-1&&e.pdfDocument.pages.getPageByIndex(t-1).graphics.drawPdfTemplate(h.template,new lt(0,0))})}else this.pdfDocument.template.top=this.drawPageTemplate(new kr(a),r)}},t.prototype.drawPageTemplate=function(t,e){for(var i=0,r=e.contents;i<r.length;i++){var n=r[i];switch(this.processContentValidation(n),n.type){case"Text":if(""===n.value||void 0===n.value||null===n.value||"string"!==typeof n.value)throw new Error("please enter the valid input value in text content...");this.drawText(t,n);break;case"PageNumber":this.drawPageNumber(t,n);break;case"Image":if(void 0===n.src||null===n.src||""===n.src)throw new Error("please enter the valid base64 string in image content...");this.drawImage(t,n);break;case"Line":this.drawLine(t,n);break;default:throw new Error("Please set valid content type...")}}return t},t.prototype.processContentValidation=function(t){if(void 0===t.type||null===t.type)throw new Error("please set valid content type...");if("Line"===t.type){if(void 0===t.points||null===t.points)throw new Error("please enter valid points in "+t.type+" content...");if(void 0===t.points.x1||null===t.points.x1||"number"!==typeof t.points.x1)throw new Error("please enter valid x1 co-ordinate in "+t.type+" points...");if(void 0===t.points.y1||null===t.points.y1||"number"!==typeof t.points.y1)throw new Error("please enter valid y1 co-ordinate in "+t.type+" points...");if(void 0===t.points.x2||null===t.points.x2||"number"!==typeof t.points.x2)throw new Error("please enter valid x2 co-ordinate in "+t.type+" points...");if(void 0===t.points.y2||null===t.points.y2||"number"!==typeof t.points.y2)throw new Error("please enter valid y2 co-ordinate in "+t.type+" points...")}else{if(void 0===t.position||null===t.position)throw new Error("please enter valid position in "+t.type+" content...");if(void 0===t.position.x||null===t.position.x||"number"!==typeof t.position.x)throw new Error("please enter valid x co-ordinate in "+t.type+" position...");if(void 0===t.position.y||null===t.position.y||"number"!==typeof t.position.y)throw new Error("please enter valid y co-ordinate in "+t.type+" position...")}},t.prototype.drawText=function(t,e){var i=this.getFont(e),r=this.getBrushFromContent(e),n=null;if(!Object(s["T"])(e.style.textPenColor)){var o=this.hexToRgb(e.style.textPenColor);n=new Xt(new _t(o.r,o.g,o.b))}null==r&&null==n&&(r=new Kt(new _t(0,0,0)));var a=e.value.toString(),h=.75*e.position.x,l=.75*e.position.y,u=new Jt,c=this.setContentFormat(e,u);null===c||Object(s["T"])(c.format)||Object(s["T"])(c.size)?t.graphics.drawString(a,i,n,r,h,l,u):t.graphics.drawString(a,i,n,r,h,l,c.size.width,c.size.height,c.format)},t.prototype.drawPageNumber=function(t,e){var i=this.getFont(e),r=null;if(Object(s["T"])(e.style.textBrushColor))r=new Kt(new _t(0,0,0));else{var n=this.hexToRgb(e.style.textBrushColor);r=new Kt(new _t(n.r,n.g,n.b))}var o,a,h=new Dr(i,r);if(h.numberStyle=this.getPageNumberStyle(e.pageNumberType),Object(s["T"])(e.format))a="{0}",o=new zr(i,r,a,h);else{var l="$total",u="$current";if(-1!==e.format.indexOf(l)&&-1!==e.format.indexOf(u)){var c=new _r(i);c.numberStyle=this.getPageNumberStyle(e.pageNumberType),e.format.indexOf(l)>e.format.indexOf(u)?(a=e.format.replace(u,"0"),a=a.replace(l,"1")):(a=e.format.replace(u,"1"),a=a.replace(l,"0")),o=new zr(i,r,a,h,c)}else if(-1!==e.format.indexOf(u)&&-1===e.format.indexOf(l))a=e.format.replace(u,"0"),o=new zr(i,r,a,h);else{c=new _r(i);a=e.format.replace(l,"0"),o=new zr(i,r,a,c)}}var p=.75*e.position.x,d=.75*e.position.y,f=this.setContentFormat(e,o.stringFormat);null===f||Object(s["T"])(f.format)||Object(s["T"])(f.size)||(o.stringFormat=f.format,o.bounds=new ct(p,d,f.size.width,f.size.height)),o.draw(t.graphics,p,d)},t.prototype.drawImage=function(t,e){var i=.75*e.position.x,r=.75*e.position.y,n=Object(s["T"])(e.size)?void 0:.75*e.size.width,o=Object(s["T"])(e.size)?void 0:.75*e.size.height,a=new ti(e.src);Object(s["T"])(n)?t.graphics.drawImage(a,i,r):t.graphics.drawImage(a,i,r,n,o)},t.prototype.drawLine=function(t,e){var i=.75*e.points.x1,r=.75*e.points.y1,n=.75*e.points.x2,o=.75*e.points.y2,a=this.getPenFromContent(e);Object(s["T"])(e.style)||null===e.style||(Object(s["T"])(e.style.penSize)||null===e.style.penSize||"number"!==typeof e.style.penSize||(a.width=.75*e.style.penSize),a.dashStyle=this.getDashStyle(e.style.dashStyle)),t.graphics.drawLine(a,i,r,n,o)},t.prototype.processAggregates=function(t,e,i,r,n,o,a,l,u,c,p){for(var d=0,f=t;d<f.length;d++){for(var g=f[d],m=-1,y=0,b=!0,w=[],v=p?0:1,S=0;S<e.columns.count+v;S++){var C=g.cells[y];if(C.cellType!==Xr["a"].DetailFooterIntent){if(!this.hideColumnInclude){while(void 0===C.visible)if(C.cellType!==Xr["a"].DetailFooterIntent){if(Object(s["T"])(l))w.push("");else if(Object(s["T"])(l.cells.getCell(S).value))w.push("");else{var x={row:g,type:"GroupCaption",style:l.cells};this.parent.trigger(h["Uc"],x),w.push(l.cells.getCell(S).value),b=!1,a||(S+=1)}S+=1,y+=1,C=g.cells[y]}while(!Object(s["T"])(C.visible)&&!C.visible)y+=1,C=g.cells[y]}if(C.isDataCell){var P={};if(Object(s["T"])(C.column.footerTemplate)&&Object(s["T"])(C.column.groupCaptionTemplate)&&Object(s["T"])(C.column.groupFooterTemplate)){O=this.getSummaryWithoutTemplate(g.data[C.column.field]);Object(s["T"])(O)||w.push(O)}else{var O=this.getTemplateFunction(P,S,m,C);P=O.templateFunction,m=O.leastCaptionSummaryIndex;var T=void 0,L=g.data[C.column.field?C.column.field:C.column.columnName];this.parent.isReact||this.parent.isVue?(T=P[Object(s["L"])(Xr["a"],C.cellType)](L,this.parent),this.parent.isReact&&this.parent.renderTemplates()):T=P[Object(s["L"])(Xr["a"],C.cellType)](L),w.push(T[0].textContent),b=!1}}else w.push("");b&&""!==w[S]&&!Object(s["T"])(w[S])&&null!==w[S]&&(b=!1),y+=1}else S--,y++}if(!p)if(a)for(S=this.parent.groupSettings.columns.length;S<w.length-1;S++)w[S]=w[S+1],w[S+1]=w[S+2]?w[S+2]:"";else w.splice(0,1);if(!b)if(a)for(S=0;S<e.columns.count;S++)l.cells.getCell(S).value=w[S].toString(),S===u&&-1!==m&&1!==m?l.cells.getCell(S).columnSpan=m-1-u:S===u&&-1===m&&(l.cells.getCell(S).columnSpan=e.columns.count-u);else{var j=e.rows.addRow();j.style.setBorder(i),j.style.setFont(r),j.style.setTextBrush(n),j.style.setBackgroundBrush(o);x={row:g,type:c?"GroupFooter":"Footer",style:j.cells};this.parent.trigger(h["Uc"],x);for(var S=0;S<e.columns.count;S++)j.cells.getCell(S).value=w[S].toString()}}},t.prototype.getTemplateFunction=function(t,e,i,r){return Object(s["T"])(r.column.footerTemplate)||r.cellType!==Xr["a"].Summary?Object(s["T"])(r.column.groupCaptionTemplate)?t[Object(s["L"])(Xr["a"],Xr["a"].GroupSummary)]=Object(s["B"])(r.column.groupFooterTemplate):(-1===i&&(i=e),t[Object(s["L"])(Xr["a"],Xr["a"].CaptionSummary)]=Object(s["B"])(r.column.groupCaptionTemplate)):t[Object(s["L"])(Xr["a"],Xr["a"].Summary)]=Object(s["B"])(r.column.footerTemplate),{templateFunction:t,leastCaptionSummaryIndex:i}},t.prototype.getSummaryWithoutTemplate=function(t){return Object(s["T"])(t.Sum)?Object(s["T"])(t.Average)?Object(s["T"])(t.Max)?Object(s["T"])(t.Min)?Object(s["T"])(t.Count)?Object(s["T"])(t.TrueCount)?Object(s["T"])(t.FalseCount)?Object(s["T"])(t.Custom)?void 0:t.Custom:t.FalseCount:t.TrueCount:t.Count:t.Min:t.Max:t.Average:t.Sum},t.prototype.setColumnProperties=function(t,e,i,r,n){for(var o=r.groupSettings.columns.length?r.groupSettings.columns.length-1:0,a=0;a<o;a++)e.columns.getColumn(a).width=20;for(a=0;a<t.length;a++)Object(s["T"])(t[a].textAlign)||(e.columns.getColumn(a+o).format=this.getHorizontalAlignment(t[a].textAlign)),e.style.allowHorizontalOverflow&&!Object(s["T"])(t[a].width)&&n&&(e.columns.getColumn(a+o).width="number"===typeof t[a].width?.75*t[a].width:.75*i.getConvertedWidth(t[a].width))},t.prototype.setRecordThemeStyle=function(t,e){if(Object(s["T"])(this.gridTheme)||Object(s["T"])(this.gridTheme.record))t.style.setTextBrush(new Kt(new _t(0,0,0)));else{var i=Object(s["T"])(this.gridTheme.record.fontName)?jt.Helvetica:this.getFontFamily(this.gridTheme.record.fontName),r=Object(s["T"])(this.gridTheme.record.fontSize)?9.75:this.gridTheme.record.fontSize,n=this.getFontStyle(this.gridTheme.record),o=new Ii(i,r,n);Object(s["T"])(this.gridTheme.record.font)||(o=this.gridTheme.record.font),t.style.setFont(o);var a=new _t;if(!Object(s["T"])(this.gridTheme.record.fontColor)){var h=this.hexToRgb(this.gridTheme.record.fontColor);a=new _t(h.r,h.g,h.b)}t.style.setTextBrush(new Kt(a))}var l=this.gridTheme&&this.gridTheme.record&&this.gridTheme.record.border?this.getBorderStyle(this.gridTheme.record.border):e;return t.style.setBorder(l),t},t.prototype.processRecord=function(t,e,i,r,n,o,a,l,u){for(var c=l.getGridRowModel(e,r,i,u),p=0,d=c;p<d.length;p++){var f=d[p];u++;for(var g=this.setRecordThemeStyle(n.rows.addRow(),t),m=f.cells.length,y=0;y<m;y++){var b=f.cells[y];if(b.cellType===Xr["a"].Data){var w=b.column,v=w.field,S=Object(s["T"])(v)?"":w.valueAccessor(v,f.data,w),C=Object(s["T"])(S)?"":S,x=void 0;w.isForeignColumn&&w.isForeignColumn()&&(x=l.getFData(C,w),C=Object(s["R"])(w.foreignKeyValue,x));var P=f.data,O=g.cells.getCell(y),T={data:P,value:C,column:w,style:void 0,colSpan:1,cell:O};if(T.value="boolean"===T.column.type&&"string"===typeof T.value?T.value:this.exportValueFormatter.formatCellValue(T),this.parent.trigger(h["Xc"],T),Object(s["T"])(T.image)||(T.value=new ti(T.image.base64),T.value.height=T.image.height||T.value.height,T.value.width=T.image.width||T.value.width),O.value=T.value,Object(s["T"])(T.hyperLink)||(O.value=this.setHyperLink(T)),Object(s["T"])(T.style)||this.processCellStyle(O,T),T.colSpan>1){y+1+T.colSpan>g.cells.count&&(T.colSpan=g.cells.count-(y+1)),O.columnSpan=T.colSpan;for(var L=1;L<O.columnSpan;L++){var j=g.cells.getCell(y+L);j.value=""}y+=T.colSpan-1}}}if(f.isExpand){var B=this.setRecordThemeStyle(n.rows.addRow(),t);O=B.cells.getCell(o);O.columnSpan=B.cells.count-o,O.style.cellPadding=new Mi(10,10,10,10),i.isPrinting=!0;var I=!Object(s["T"])(a)&&a.exportType?a.exportType:"AllPages",R=this.helper.createChildGrid(i,f,I,this.gridPool),k=R.childGrid,F=R.element;k.actionFailure=l.failureHandler(this.gridPool,k,this.globalResolve);T={childGrid:k,row:f,cell:O,exportProperties:a};this.parent.trigger(h["Xb"],T),k.beforeDataBound=this.childGridCell(O,k,a),k.appendTo(F)}this.parent.notify(h["Zb"],{type:"pdf",rowObj:f})}return u},t.prototype.setHyperLink=function(t){var e=new lr;return e.url=t.hyperLink.target,e.text=t.hyperLink.displayText||t.hyperLink.target,e.font=new Ii(jt.Helvetica,9.75),e.brush=new Kt(new _t(51,102,187)),e},t.prototype.childGridCell=function(t,e,i){var r=this;return function(n){return e.beforeDataBound=null,n.cancel=!0,t.value=r.processGridExport(e,n,i),e.destroy(),Object(s["F"])(e.element),r.gridPool[e.id]=!0,r.helper.checkAndExport(r.gridPool,r.globalResolve),t}},t.prototype.processCellStyle=function(t,e){if(!Object(s["T"])(e.style.backgroundColor)){var i=this.hexToRgb(e.style.backgroundColor);t.style.backgroundBrush=new Kt(new _t(i.r,i.g,i.b))}if(Object(s["T"])(e.style.textAlignment)||(t.style.stringFormat=this.getHorizontalAlignment(e.style.textAlignment)),Object(s["T"])(e.style.cellPadding)||(t.style.cellPadding=e.style.cellPadding),Object(s["T"])(e.style.verticalAlignment)||(t.style.stringFormat=this.getVerticalAlignment(e.style.verticalAlignment,t.style.stringFormat)),!Object(s["T"])(e.style.textBrushColor)){var r=this.hexToRgb(e.style.textBrushColor);t.style.textBrush=new Kt(new _t(r.r,r.g,r.b))}if(!Object(s["T"])(e.style.textPenColor)){var n=this.hexToRgb(e.style.textPenColor);t.style.textPen=new Xt(new _t(n.r,n.g,n.b))}if(Object(s["T"])(e.style.fontFamily)&&Object(s["T"])(e.style.fontSize)&&Object(s["T"])(e.style.bold)&&Object(s["T"])(e.style.italic)&&Object(s["T"])(e.style.underline)&&Object(s["T"])(e.style.strikeout)||(t.style.font=this.getFont(e)),!Object(s["T"])(e.style.border)){var o=new Fi,a=e.style.border.width,h=Object(s["T"])(a)||"number"!==typeof a?void 0:.75*a,l=new _t(196,196,196);if(!Object(s["T"])(e.style.border.color)){var u=this.hexToRgb(e.style.border.color);l=new _t(u.r,u.g,u.b)}var c=new Xt(l,h);Object(s["T"])(e.style.border.dashStyle)||(c.dashStyle=this.getDashStyle(e.style.border.dashStyle)),o.all=c,t.style.borders=o}Object(s["T"])(e.style.paragraphIndent)||(t.style.stringFormat=new Jt,t.style.stringFormat.paragraphIndent=e.style.paragraphIndent)},t.prototype.getHorizontalAlignment=function(t,e){switch(void 0===e&&(e=new Jt),t){case"Right":e.alignment=mt.Right;break;case"Center":e.alignment=mt.Center;break;case"Justify":e.alignment=mt.Justify;break;case"Left":e.alignment=mt.Left;break}return e},t.prototype.getVerticalAlignment=function(t,e,i){switch(void 0===e&&(e=new Jt,e=this.getHorizontalAlignment(i,e)),t){case"Bottom":e.lineAlignment=gt.Bottom;break;case"Middle":e.lineAlignment=gt.Middle;break;case"Top":e.lineAlignment=gt.Top;break}return e},t.prototype.getFontFamily=function(t){switch(t){case"TimesRoman":return 2;case"Courier":return 1;case"Symbol":return 3;case"ZapfDingbats":return 4;default:return 0}},t.prototype.getFont=function(t){if(t.font)return t.font;var e=Object(s["T"])(t.style.fontSize)?9.75:.75*t.style.fontSize,i=Object(s["T"])(t.style.fontFamily)?jt.TimesRoman:this.getFontFamily(t.style.fontFamily),r=Lt.Regular;return!Object(s["T"])(t.style.bold)&&t.style.bold&&(r|=Lt.Bold),!Object(s["T"])(t.style.italic)&&t.style.italic&&(r|=Lt.Italic),!Object(s["T"])(t.style.underline)&&t.style.underline&&(r|=Lt.Underline),!Object(s["T"])(t.style.strikeout)&&t.style.strikeout&&(r|=Lt.Strikeout),new Ii(i,e,r)},t.prototype.getPageNumberStyle=function(t){switch(t){case"LowerLatin":return 2;case"LowerRoman":return 3;case"UpperLatin":return 4;case"UpperRoman":return 5;default:return 1}},t.prototype.setContentFormat=function(t,e){if(!Object(s["T"])(t.size)){var i=.75*t.size.width,r=.75*t.size.height;if(e=new Jt(mt.Left,gt.Middle),!Object(s["T"])(t.style.hAlign))switch(t.style.hAlign){case"Right":e.alignment=mt.Right;break;case"Center":e.alignment=mt.Center;break;case"Justify":e.alignment=mt.Justify;break;default:e.alignment=mt.Left}return Object(s["T"])(t.style.vAlign)||(e=this.getVerticalAlignment(t.style.vAlign,e)),{format:e,size:new ut(i,r)}}return null},t.prototype.getPageSize=function(t){switch(t){case"Letter":return new ut(612,792);case"Note":return new ut(540,720);case"Legal":return new ut(612,1008);case"A0":return new ut(2380,3368);case"A1":return new ut(1684,2380);case"A2":return new ut(1190,1684);case"A3":return new ut(842,1190);case"A5":return new ut(421,595);case"A6":return new ut(297,421);case"A7":return new ut(210,297);case"A8":return new ut(148,210);case"A9":return new ut(105,148);case"B0":return new ut(2836,4008);case"B1":return new ut(2004,2836);case"B2":return new ut(1418,2004);case"B3":return new ut(1002,1418);case"B4":return new ut(709,1002);case"B5":return new ut(501,709);case"Archa":return new ut(648,864);case"Archb":return new ut(864,1296);case"Archc":return new ut(1296,1728);case"Archd":return new ut(1728,2592);case"Arche":return new ut(2592,3456);case"Flsa":return new ut(612,936);case"HalfLetter":return new ut(396,612);case"Letter11x17":return new ut(792,1224);case"Ledger":return new ut(1224,792);default:return new ut(595,842)}},t.prototype.getDashStyle=function(t){switch(t){case"Dash":return 1;case"Dot":return 2;case"DashDot":return 3;case"DashDotDot":return 4;default:return 0}},t.prototype.getPenFromContent=function(t){var e=new Xt(new _t(0,0,0));if(!Object(s["T"])(t.style)&&null!==t.style&&!Object(s["T"])(t.style.penColor)){var i=this.hexToRgb(t.style.penColor);e=new Xt(new _t(i.r,i.g,i.b))}return e},t.prototype.getBrushFromContent=function(t){var e=null;if(!Object(s["T"])(t.style.textBrushColor)){var i=this.hexToRgb(t.style.textBrushColor);e=new Kt(new _t(i.r,i.g,i.b))}return e},t.prototype.hexToRgb=function(t){if(null===t||""===t||7!==t.length)throw new Error("please set valid hex value for color...");t=t.substring(1);var e=parseInt(t,16),i=e>>16&255,r=e>>8&255,n=255&e;return{r:i,g:r,b:n}},t.prototype.getFontStyle=function(t){var e=Lt.Regular;return!Object(s["T"])(t)&&t.bold&&(e|=Lt.Bold),!Object(s["T"])(t)&&t.italic&&(e|=Lt.Italic),!Object(s["T"])(t)&&t.underline&&(e|=Lt.Underline),!Object(s["T"])(t)&&t.strikeout&&(e|=Lt.Strikeout),e},t.prototype.getBorderStyle=function(t){var e=new Fi;if(Object(s["T"])(t))e.all=new Xt(new _t(234,234,234));else{var i=t.width,r=Object(s["T"])(i)||"number"!==typeof i?void 0:.75*i,n=new _t(196,196,196);if(!Object(s["T"])(t.color)){var o=this.hexToRgb(t.color);n=new _t(o.r,o.g,o.b)}var a=new Xt(n,r);Object(s["T"])(t.dashStyle)||(a.dashStyle=this.getDashStyle(t.dashStyle)),e.all=a}return e},t.prototype.destroy=function(){},t}(),on=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},t(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),sn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return on(e,t),e}(Array),an=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},t(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),hn=function(){function t(){this.isSummaryRowBelow=!0,this.showGridLines=!0,this.enableRtl=!1}return t}(),ln=function(){function t(){}return t}(),un=function(){function t(){}return t}(),cn=function(){function t(){}return t}(),pn=function(){function t(){}return t}(),dn=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.add=function(t){for(var r=!1,n=0,o=0,s=i;o<s.length;o++){var a=s[o];if(e.isIntersecting(a,t)){var h=new pn;h.x=Math.min(a.x,t.x),h.y=Math.min(a.Y,t.y),h.width=Math.max(a.Width+a.X,t.width+t.x),h.height=Math.max(a.Height+a.Y,t.height+t.y),h.ref=i[n].ref.split(":")[0]+":"+t.ref.split(":")[1],i[n]=h,t=h,r=!0}n++}return r||i.push(t),t},i}return an(e,t),e.isIntersecting=function(t,e){return t.x<=e.x+e.width&&e.x<=t.x+t.width&&t.y<=e.y+e.height&&e.y<=t.y+t.height},e}(Array),fn=function(){function t(){this.numFmtId=0,this.backColor="none",this.fontName="Calibri",this.fontSize=10.5,this.fontColor="#000000",this.italic=!1,this.bold=!1,this.underline=!1,this.strikeThrough=!1,this.wrapText=!1,this.hAlign="general",this.vAlign="bottom",this.indent=0,this.rotation=0,this.numberFormat="GENERAL",this.type="datetime",this.borders=new Cn,this.isGlobalStyle=!1}return t}(),gn=function(){function t(){this.sz=10.5,this.name="Calibri",this.u=!1,this.b=!1,this.i=!1,this.color="FF000000",this.strike=!1}return t}(),mn=function(){function t(){}return t}(),yn=function(){function t(){}return t}(),bn=function(){function t(){}return t}(),wn=function(){function t(){this.name="Normal",this.xfId=0}return t}(),vn=function(){function t(t,e){this.numFmtId=t,this.formatCode=e}return t}(),Sn=function(){function t(t,e){this.lineStyle=t,this.color=e}return t}(),Cn=function(){function t(){this.left=new Sn("none","#FFFFFF"),this.right=new Sn("none","#FFFFFF"),this.top=new Sn("none","#FFFFFF"),this.bottom=new Sn("none","#FFFFFF"),this.all=new Sn("none","#FFFFFF")}return t}(),xn=function(){function t(){}return t}(),Pn=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},t(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),On=function(){function t(){}return t}(),Tn=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.add=function(t){e.push(t)},e}return Pn(e,t),e}(Array),Ln=function(){function t(){}return t}(),jn=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},t(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Bn=function(){function t(){}return t}(),In=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.add=function(t){for(var i=!1,r=0,n=0,o=e;n<o.length;n++){var s=o[n];s.index===t.index&&(e[r]=t,i=!0),r++}i||e.push(t)},e}return jn(e,t),e}(Array),Rn=[],kn=function(){function t(){0===Rn.length&&t.initCrc32Table(),this.files=[],this.level="Normal",x.isMicrosoftBrowser=!!navigator.msSaveBlob}return Object.defineProperty(t.prototype,"compressionLevel",{get:function(){return this.level},set:function(t){this.level=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"length",{get:function(){return void 0===this.files?0:this.files.length},enumerable:!0,configurable:!0}),t.prototype.addItem=function(t){if(null===t||void 0===t)throw new Error("ArgumentException: item cannot be null or undefined");for(var e=0;e<this.files.length;e++){var i=this.files[e];if(i instanceof Fn&&i.name===t.name)throw new Error("item with same name already exist")}this.files.push(t)},t.prototype.addDirectory=function(t){if(null===t||void 0===t)throw new Error("ArgumentException: string cannot be null or undefined");if(0===t.length)throw new Error("ArgumentException: string cannot be empty");if("/"!==t.slice(-1)&&(t+="/"),-1!==this.files.indexOf(t))throw new Error("item with same name already exist");this.files.push(t)},t.prototype.getItem=function(t){if(t>=0&&t<this.files.length)return this.files[t]},t.prototype.contains=function(t){return-1!==this.files.indexOf(t)},t.prototype.save=function(t){if(null===t||void 0===t||0===t.length)throw new Error("ArgumentException: fileName cannot be null or undefined");if(0===this.files.length)throw new Error("InvalidOperation");var e=this;return new Promise(function(i,r){e.saveInternal(t,!1).then(function(){i(e)})})},t.prototype.saveAsBlob=function(){var t=this;return new Promise(function(e,i){t.saveInternal("",!0).then(function(t){e(t)})})},t.prototype.saveInternal=function(t,e){var i=this,r=this;return new Promise(function(n,o){for(var s=[],a=0,h=0;h<r.files.length;h++){var l=i.getCompressedData(i.files[h]);l.then(function(i){if(a=r.constructZippedObject(s,i,a,i.isDirectory),s.length===r.files.length){var o=r.writeZippedContent(t,s,a,e);n(o)}})}})},t.prototype.destroy=function(){if(void 0!==this.files&&this.files.length>0){for(var t=0;t<this.files.length;t++){var e=this.files[t];e instanceof Fn&&e.destroy(),e=void 0}this.files=[]}this.files=void 0,this.level=void 0},t.prototype.getCompressedData=function(t){var e=this,i=new Promise(function(i,r){if(t instanceof Fn){var n=new FileReader;n.onload=function(){var r=new Uint8Array(n.result),o={fileName:t.name,crc32Value:0,compressedData:[],compressedSize:void 0,uncompressedDataSize:r.length,compressionType:void 0,isDirectory:!1};if("Normal"===e.level){e.compressData(r,o,Rn);for(var s=0,a=0;a<o.compressedData.length;a++)s+=o.compressedData[a].length;o.compressedSize=s,o.compressionType="\b\0"}else o.compressedSize=r.length,o.crc32Value=e.calculateCrc32Value(0,r,Rn),o.compressionType="\0\0",o.compressedData.push(r);i(o)},n.readAsArrayBuffer(t.data)}else{var o={fileName:t,crc32Value:0,compressedData:"",compressedSize:0,uncompressedDataSize:0,compressionType:"\0\0",isDirectory:!0};i(o)}});return i},t.prototype.compressData=function(t,e,i){var r=new W(!0),n=0,o=0;do{if(n>=t.length){r.close();break}o=Math.min(t.length,n+16384);var s=t.subarray(n,o);e.crc32Value=this.calculateCrc32Value(e.crc32Value,s,i),r.write(s,0,o-n),n=o}while(n<=t.length);e.compressedData=r.compressedData,r.destroy()},t.prototype.constructZippedObject=function(t,e,i,r){var n=0,o=new Date;r&&(n|=16),n|=0;var s=this.writeHeader(e,o),a="PK"+s+e.fileName,h=this.writeCentralDirectory(e,s,i,n);return t.push({localHeader:a,centralDir:h,compressedData:e}),i+a.length+e.compressedSize},t.prototype.writeHeader=function(t,e){var i="";return i+="\n\0\0\0",i+=t.compressionType,i+=this.getBytes(this.getModifiedTime(e),2),i+=this.getBytes(this.getModifiedDate(e),2),i+=this.getBytes(t.crc32Value,4),i+=this.getBytes(t.compressedSize,4),i+=this.getBytes(t.uncompressedDataSize,4),i+=this.getBytes(t.fileName.length,2),i+=this.getBytes(0,2),i},t.prototype.writeZippedContent=function(t,e,i,r){for(var n=0,o=[],s=0;s<e.length;s++){var a=e[s];n+=a.centralDir.length,o.push(this.getArrayBuffer(a.localHeader));while(a.compressedData.compressedData.length)o.push(a.compressedData.compressedData.shift().buffer)}for(s=0;s<e.length;s++)o.push(this.getArrayBuffer(e[s].centralDir));o.push(this.getArrayBuffer(this.writeFooter(e,n,i)));var h=new Blob(o,{type:"application/zip"});return r||x.save(t,h),h},t.prototype.writeCentralDirectory=function(t,e,i,r){var n="PK"+this.getBytes(20,2)+e+this.getBytes(0,2)+"\0\0\0\0"+this.getBytes(r,4)+this.getBytes(i,4)+t.fileName;return n},t.prototype.writeFooter=function(t,e,i){var r="PK\0\0\0\0"+this.getBytes(t.length,2)+this.getBytes(t.length,2)+this.getBytes(e,4)+this.getBytes(i,4)+this.getBytes(0,2);return r},t.prototype.getArrayBuffer=function(t){for(var e=new Uint8Array(t.length),i=0;i<t.length;++i)e[i]=255&t.charCodeAt(i);return e.buffer},t.prototype.getBytes=function(t,e){for(var i="",r=0;r<e;r++)i+=String.fromCharCode(255&t),t>>>=8;return i},t.prototype.getModifiedTime=function(t){var e=t.getHours();return e<<=6,e|=t.getMinutes(),e<<=5,e|t.getSeconds()/2},t.prototype.getModifiedDate=function(t){var e=t.getFullYear()-1980;return e<<=4,e|=t.getMonth()+1,e<<=5,e|t.getDate()},t.prototype.calculateCrc32Value=function(t,e,i){t^=-1;for(var r=0;r<e.length;r++)t=t>>>8^i[255&(t^e[r])];return-1^t},t.initCrc32Table=function(){for(var t,e=0;e<256;e++){t=e;for(var i=0;i<8;i++)t=1&t?3988292384^t>>>1:t>>>1;Rn[e]=t}},t}(),Fn=function(){function t(t,e){if(null===t||void 0===t)throw new Error("ArgumentException: data cannot be null or undefined");if(null===e||void 0===e)throw new Error("ArgumentException: string cannot be null or undefined");if(0===e.length)throw new Error("string cannot be empty");this.data=t,this.name=e}return Object.defineProperty(t.prototype,"name",{get:function(){return this.fileName},set:function(t){this.fileName=t},enumerable:!0,configurable:!0}),t.prototype.destroy=function(){this.fileName=void 0,this.data=void 0},t}(),Mn=function(){function t(t){this.intl=new s["m"]}return t.prototype.getFormatFunction=function(t,e){return t.type?(e&&(t.isServerRendered=!0),this.intl.getDateFormat(t)):this.intl.getNumberFormat(t)},t.prototype.toView=function(t,e){var i=t;return Object(s["T"])(e)||Object(s["T"])(t)||(i=e(t)),i},t.prototype.displayText=function(t,e,i){return this.toView(t,this.getFormatFunction(e,i))},t}(),An=function(){function t(t,e){if(this.csvStr="",this.separator=null===e||void 0===e?",":e,this.formatter=new Mn,this.isMicrosoftBrowser=!!navigator.msSaveBlob,null!==t.isServerRendered&&void 0!==t.isServerRendered&&(this.isServerRendered=t.isServerRendered),null!==t.styles&&void 0!==t.styles){this.globalStyles=new Map;for(var i=0;i<t.styles.length;i++)void 0!==t.styles[i].name&&void 0!==t.styles[i].numberFormat&&this.globalStyles.set(t.styles[i].name,t.styles[i].numberFormat)}null!==t.worksheets&&void 0!==t.worksheets&&this.parseWorksheet(t.worksheets[0])}return t.prototype.parseWorksheet=function(t){null!==t.rows&&void 0!==t.rows&&this.parseRows(t.rows)},t.prototype.parseRows=function(t){for(var e=1,i=0,r=t;i<r.length;i++){var n=r[i];if(null===n.index||void 0===n.index)throw Error("Row index is missing.");while(e<n.index)this.csvStr+="\n",e++;this.parseRow(n)}},t.prototype.parseRow=function(t){if(null!==t.cells&&void 0!==t.cells)for(var e=1,i=0,r=t.cells;i<r.length;i++){var n=r[i];if(null===n.index||void 0===n.index)throw Error("Cell index is missing.");while(e<n.index)this.csvStr+=this.separator,e++;this.parseCell(n)}},t.prototype.parseCell=function(t){var e=this.csvStr;if(void 0!==t.value)if(t.value instanceof Date)if(void 0!==t.style&&void 0!==t.style.numberFormat)try{e+=this.parseCellValue(this.formatter.displayText(t.value,{type:"dateTime",skeleton:t.style.numberFormat},this.isServerRendered))}catch(i){e+=this.parseCellValue(this.formatter.displayText(t.value,{type:"dateTime",format:t.style.numberFormat},this.isServerRendered))}else if(void 0!==t.style&&void 0!==t.style.name&&this.globalStyles.has(t.style.name))try{e+=this.parseCellValue(this.formatter.displayText(t.value,{type:"dateTime",skeleton:this.globalStyles.get(t.style.name)},this.isServerRendered))}catch(i){e+=this.parseCellValue(this.formatter.displayText(t.value,{type:"dateTime",format:this.globalStyles.get(t.style.name)},this.isServerRendered))}else e+=t.value;else"boolean"===typeof t.value?e+=t.value?"TRUE":"FALSE":"number"===typeof t.value?void 0!==t.style&&void 0!==t.style.numberFormat?e+=this.parseCellValue(this.formatter.displayText(t.value,{format:t.style.numberFormat},this.isServerRendered)):void 0!==t.style&&void 0!==t.style.name&&this.globalStyles.has(t.style.name)?e+=this.parseCellValue(this.formatter.displayText(t.value,{format:this.globalStyles.get(t.style.name)},this.isServerRendered)):e+=t.value:e+=this.parseCellValue(t.value);this.csvStr=e},t.prototype.parseCellValue=function(t){for(var e="",i=t.length,r=0;r<i;r++)'"'===t[r]?e+=t[r].replace('"','""'):e+=t[r];return t=e,-1!==t.indexOf(this.separator)||-1!==t.indexOf("\n")?'"'+t+'"':t},t.prototype.save=function(t){if(this.buffer=new Blob(["\ufeff"+this.csvStr],{type:"text/csv;charset=UTF-8"}),this.isMicrosoftBrowser)navigator.msSaveBlob(this.buffer,t);else{var e=window.URL.createObjectURL(this.buffer),i=document.createElementNS("http://www.w3.org/1999/xhtml","a");i.download=t,i.href=e;var r=document.createEvent("MouseEvent");r.initEvent("click",!0,!0),i.dispatchEvent(r),setTimeout(function(){window.URL.revokeObjectURL(e)})}},t.prototype.saveAsBlob=function(){return new Blob(["\ufeff"+this.csvStr],{type:"text/csv;charset=UTF-8"})},t}(),En=function(){function t(){this.parts=[]}return t.prototype.append=function(t){this.parts.push(t),this.blob=void 0},t.prototype.getBlob=function(){return new Blob(this.parts,{type:"text/plain"})},t}(),Nn=function(){function t(){}return t}(),Dn=function(){function t(t,e,i,r,n){if(this.sharedStringCount=0,this.unitsProportions=[1.28,.32,96,96/25.4,96/2.54,1,96/72,96/72/12700],this.hyperlinkStyle={fontColor:"#0000FF",underline:!0},this.culture=void 0!==i?i:"en-US",this.currency=void 0!==r?r:"USD",this.intl=new s["m"](this.culture),this.mSaveType=e,"xlsx"===e){if(this.mArchive=new kn,this.sharedString=[],this.mFonts=[],this.mBorders=[],this.mStyles=[],this.printTitles=new Map,this.cellStyles=new Map,this.mNumFmt=new Map,this.mFills=new Map,this.mStyles.push(new fn),this.mFonts.push(new gn),this.cellStyles.set("Normal",new wn),this.mCellXfs=[],this.mCellStyleXfs=[],this.drawingCount=0,this.imageCount=0,null!==t.styles&&void 0!==t.styles){this.globalStyles=new Map;for(var o=0;o<t.styles.length;o++)if(void 0!==t.styles[o].name){if(this.cellStyles.has(t.styles[o].name))throw Error("Style name "+t.styles[o].name+" is already existed");var a=new fn;a.isGlobalStyle=!0,this.parserCellStyle(t.styles[o],a,"none");var h=new wn;h.name=a.name,h.xfId=a.index-1,this.cellStyles.set(h.name,h);var l={};void 0!==t.styles[o].numberFormat&&(l.format=t.styles[o].numberFormat),void 0!==t.styles[o].type?l.type=t.styles[o].type:l.type="datetime",void 0!==l.format&&this.globalStyles.set(t.styles[o].name,l)}}if(null===t.worksheets||void 0===t.worksheets)throw Error("Worksheet is expected.");this.parserWorksheets(t.worksheets),null!==t.builtInProperties&&void 0!==t.builtInProperties&&(this.builtInProperties=new Vn,this.parserBuiltInProperties(t.builtInProperties,this.builtInProperties))}else this.csvHelper=new An(t,n)}return t.prototype.parserBuiltInProperties=function(t,e){null!==t.author&&void 0!==t.author&&(e.author=t.author),null!==t.comments&&void 0!==t.comments&&(e.comments=t.comments),null!==t.category&&void 0!==t.category&&(e.category=t.category),null!==t.company&&void 0!==t.company&&(e.company=t.company),null!==t.manager&&void 0!==t.manager&&(e.manager=t.manager),null!==t.subject&&void 0!==t.subject&&(e.subject=t.subject),null!==t.title&&void 0!==t.title&&(e.title=t.title),null!==t.createdDate&&void 0!==t.createdDate&&(e.createdDate=t.createdDate),null!==t.modifiedDate&&void 0!==t.modifiedDate&&(e.modifiedDate=t.modifiedDate),null!==t.tags&&void 0!==t.tags&&(e.tags=t.tags),null!==t.status&&void 0!==t.status&&(e.status=t.status)},t.prototype.parserWorksheets=function(t){this.worksheets=new sn;for(var e=t.length,i=0;i<e;i++){var r=t[i],n=new hn;this.mergeCells=new dn,this.mergedCellsStyle=new Map,this.mHyperLinks=[],null!==r.name&&void 0!==r.name?n.name=r.name:n.name="Sheet"+(i+1).toString(),null!==r.enableRtl&&void 0!==r.enableRtl&&(n.enableRtl=r.enableRtl),n.index=i+1,null!==r.columns&&void 0!==r.columns&&this.parserColumns(r.columns,n),null!==r.rows&&void 0!==r.rows&&this.parserRows(r.rows,n),null!==r.showGridLines&&void 0!==r.showGridLines&&(n.showGridLines=r.showGridLines),null!==r.freeze&&void 0!==r.freeze&&this.parserFreezePanes(r.freeze,n),null!==r.printTitle&&void 0!==r.printTitle&&this.parserPrintTitle(r.printTitle,n),void 0!==r.pageSetup&&void 0!==r.pageSetup.isSummaryRowBelow&&(n.isSummaryRowBelow=r.pageSetup.isSummaryRowBelow),void 0!==r.images&&this.parserImages(r.images,n),null!==r.autoFilters&&void 0!==r.autoFilters&&this.parseFilters(r.autoFilters,n),n.index=i+1,n.mergeCells=this.mergeCells,n.hyperLinks=this.mHyperLinks,this.worksheets.push(n)}},t.prototype.mergeOptions=function(t,e){var i={};return this.applyProperties(t,i),this.applyProperties(e,i),i},t.prototype.applyProperties=function(t,e){for(var i=Object.keys(t),r=0;r<i.length;r++)"name"!==i[r]&&(e[i[r]]=t[i[r]])},t.prototype.getCellName=function(t,e){return this.getColumnName(e)+t.toString()},t.prototype.getColumnName=function(t){t--;var e="";do{var i=t%26;t=t/26-1,e=String.fromCharCode(65+i)+e}while(t>=0);return e},t.prototype.parserPrintTitle=function(t,e){var i,r,n="";if(null!==t.fromRow&&void 0!==t.fromRow){var o=t.fromRow,s=void 0;s=null!==t.toRow&&void 0!==t.toRow?t.toRow:t.fromRow,i="$"+o+":$"+s}if(null!==t.fromColumn&&void 0!==t.fromColumn){var a=t.fromColumn,h=void 0;h=null!==t.toColumn&&void 0!==t.toColumn?t.toColumn:t.fromColumn,r="$"+this.getColumnName(a)+":$"+this.getColumnName(h)}void 0!==i&&(n+=e.name+"!"+i),void 0!==r&&void 0!==i?n+=","+e.name+"!"+r:void 0!==r&&(n+=e.name+"!"+r),""!==n&&this.printTitles.set(e.index-1,n)},t.prototype.parserFreezePanes=function(t,e){e.freezePanes=new cn,null!==t.row&&void 0!==t.row?e.freezePanes.row=t.row:e.freezePanes.row=0,null!==t.column&&void 0!==t.column?e.freezePanes.column=t.column:e.freezePanes.column=0,e.freezePanes.leftCell=this.getCellName(e.freezePanes.row+1,e.freezePanes.column+1)},t.prototype.parserColumns=function(t,e){var i=t.length;e.columns=[];for(var r=0;r<i;r++){var n=new xn;if(null===t[r].index||void 0===t[r].index)throw Error("Column index is missing.");n.index=t[r].index,null!==t[r].width&&void 0!==t[r].width&&(n.width=t[r].width),e.columns.push(n)}},t.prototype.parserRows=function(t,e){var i=t.length;e.rows=new Tn;for(var r=0,n=0;n<i;n++){var o=this.parserRow(t[n],r);r=o.index,e.rows.add(o)}this.insertMergedCellsStyle(e)},t.prototype.insertMergedCellsStyle=function(t){var e=this;this.mergeCells.length>0&&this.mergedCellsStyle.forEach(function(i,r){var n=t.rows.filter(function(t){return t.index===i.y})[0];if(Object(s["T"])(n)){var o=t.rows.filter(function(t){return t.index<=i.y}),a=new On;a.index=i.y,a.cells=new In,a.cells.add(e.createCell(i,r));u=0;o.length>0&&(u=t.rows.indexOf(o[o.length-1])+1),t.rows.splice(u,0,a)}else{var h=n.cells.filter(function(t){return t.index===i.x})[0];if(Object(s["T"])(h)){var l=n.cells.filter(function(t){return t.index<=i.x}),u=0;l.length>0&&(u=n.cells.indexOf(l[l.length-1])+1),n.cells.splice(u,0,e.createCell(i,r))}else h.styleIndex=i.styleIndex}})},t.prototype.createCell=function(t,e){var i=new Bn;return i.refName=e,i.index=t.x,i.cellStyle=new fn,i.styleIndex=t.styleIndex,i},t.prototype.parserRow=function(t,e){var i=new On;if(null!==t.height&&void 0!==t.height&&(i.height=t.height),null===t.index||void 0===t.index)throw Error("Row index is missing.");return i.index=t.index,null!==t.grouping&&void 0!==t.grouping&&this.parseGrouping(t.grouping,i),this.parseCells(t.cells,i),i},t.prototype.parseGrouping=function(t,e){e.grouping=new un,void 0!==t.outlineLevel&&(e.grouping.outlineLevel=t.outlineLevel),void 0!==t.isCollapsed&&(e.grouping.isCollapsed=t.isCollapsed),void 0!==t.isHidden&&(e.grouping.isHidden=t.isHidden)},t.prototype.parseCells=function(t,e){e.cells=new In;for(var i=void 0!==t?t.length:0,r=1,n=1,o=0;o<i;o++){var s=t[o],a=new Bn;if(null===s.index||void 0===s.index)throw Error("Cell index is missing.");if(a.index=s.index,a.index<r?r=a.index:a.index>n&&(n=a.index),a.refName=this.getCellName(e.index,a.index),null!==s.rowSpan&&void 0!==s.rowSpan?a.rowSpan=s.rowSpan-1:a.rowSpan=0,null!==s.colSpan&&void 0!==s.colSpan?a.colSpan=s.colSpan-1:a.colSpan=0,null!==s.hyperlink&&void 0!==s.hyperlink){var h=new ln;void 0!==s.hyperlink.target&&(h.target=s.hyperlink.target,void 0!==s.hyperlink.displayText?a.value=s.hyperlink.displayText:a.value=s.hyperlink.target,a.type=this.getCellValueType(a.value),h.ref=a.refName,h.rId=this.mHyperLinks.length+1,this.mHyperLinks.push(h),a.cellStyle=new fn,this.parserCellStyle(void 0!==s.style?this.mergeOptions(s.style,this.hyperlinkStyle):this.hyperlinkStyle,a.cellStyle,"string"),a.styleIndex=a.cellStyle.index)}null!==s.formula&&void 0!==s.formula&&(a.formula=s.formula,a.type="formula"),null!==s.value&&void 0!==s.value&&(void 0!==a.formula?a.value=0:(a.value=s.value,a.type=this.getCellValueType(a.value))),null!==s.style&&void 0!==s.style&&void 0===a.styleIndex?(a.cellStyle=new fn,a.value instanceof Date?this.parserCellStyle(s.style,a.cellStyle,a.type,14):this.parserCellStyle(s.style,a.cellStyle,a.type),a.styleIndex=a.cellStyle.index):a.value instanceof Date&&(a.cellStyle=new fn,this.parserCellStyle({},a.cellStyle,a.type,14),a.styleIndex=a.cellStyle.index),this.parseCellType(a),this.mergeCells=this.processMergeCells(a,e.index,this.mergeCells),e.cells.add(a),a.index+1}e.spans=r+":"+n},t.prototype.GetColors=function(){var t;return t=new Map,t.set("WHITE","FFFFFFFF"),t.set("SILVER","FFC0C0C0"),t.set("GRAY","FF808080"),t.set("BLACK","FF000000"),t.set("RED","FFFF0000"),t.set("MAROON","FF800000"),t.set("YELLOW","FFFFFF00"),t.set("OLIVE","FF808000"),t.set("LIME","FF00FF00"),t.set("GREEN","FF008000"),t.set("AQUA","FF00FFFF"),t.set("TEAL","FF008080"),t.set("BLUE","FF0000FF"),t.set("NAVY","FF000080"),t.set("FUCHSIA","FFFF00FF"),t.set("PURPLE","FF800080"),t},t.prototype.processColor=function(t){return 0===t.indexOf("#")?t.replace("#","FF"):(t=t.toUpperCase(),this.rgbColors=this.GetColors(),t=this.rgbColors.has(t)?this.rgbColors.get(t):"FF000000",t)},t.prototype.processCellValue=function(t,e){var i=t;if(-1!==t.indexOf("<font")||-1!==t.indexOf("<a")||-1!==t.indexOf("<b>")||-1!==t.indexOf("<i>")||-1!==t.indexOf("<u>")){var r="",n=t.indexOf("<",0),o=t.indexOf(">",n+1);if(n>=0&&o>=0){0!==n&&(r+='<r><t xml:space="preserve">'+this.processString(t.substring(0,n))+"</t></r>");while(n>=0&&o>=0)if(o=t.indexOf(">",n+1),o>=0){var s=t.substring(n+1,o);n=t.indexOf("<",o+1),n<0&&(n=i.length);var a=i.substring(o+1,n);if(0!==a.length){var h=s.split(" ");if(h.length>0&&(r+="<r><rPr>"),h.length>1)for(var l=0,u=h;l<u.length;l++){var c=u[l],p=c.trim().substring(0,5);switch(p){case"size=":r+='<sz val="'+c.substring(6,c.length-1)+'"/>';break;case"face=":r+='<rFont val="'+c.substring(6,c.length-1)+'"/>';break;case"color":r+='<color rgb="'+this.processColor(c.substring(7,c.length-1))+'"/>';break;case"href=":var d=new ln;d.target=c.substring(6,c.length-1).trim(),d.ref=e.refName,d.rId=this.mHyperLinks.length+1,this.mHyperLinks.push(d),r+='<color rgb="FF0000FF"/><u/><b/>';break}}else if(1===h.length){var f=h[0].trim();switch(f){case"b":r+="<b/>";break;case"i":r+="<i/>";break;case"u":r+="<u/>";break}}r+='</rPr><t xml:space="preserve">'+this.processString(a)+"</t></r>"}}return""===r?i:r}return i}return i},t.prototype.applyGlobalStyle=function(t,e){this.cellStyles.has(t.name)&&(e.index=this.mStyles.filter(function(e){return e.name===t.name})[0].index,e.name=t.name)},t.prototype.parserCellStyle=function(t,e,i,r){if(null!==t.name&&void 0!==t.name){if(!e.isGlobalStyle)return void this.applyGlobalStyle(t,e);e.name=t.name}null!==t.backColor&&void 0!==t.backColor&&(e.backColor=t.backColor),e.borders=new Cn,null!==t.borders&&void 0!==t.borders&&this.parserBorder(t.borders,e.borders.all),null!==t.leftBorder&&void 0!==t.leftBorder&&this.parserBorder(t.leftBorder,e.borders.left),null!==t.rightBorder&&void 0!==t.rightBorder&&this.parserBorder(t.rightBorder,e.borders.right),null!==t.topBorder&&void 0!==t.topBorder&&this.parserBorder(t.topBorder,e.borders.top),null!==t.bottomBorder&&void 0!==t.bottomBorder&&this.parserBorder(t.bottomBorder,e.borders.bottom),null!==t.fontName&&void 0!==t.fontName&&(e.fontName=t.fontName),null!==t.fontSize&&void 0!==t.fontSize&&(e.fontSize=t.fontSize),null!==t.fontColor&&void 0!==t.fontColor&&(e.fontColor=t.fontColor),null!==t.italic&&void 0!==t.italic&&(e.italic=t.italic),null!==t.bold&&void 0!==t.bold&&(e.bold=t.bold),null!==t.hAlign&&void 0!==t.hAlign&&(e.hAlign=t.hAlign.toLowerCase()),null!==t.indent&&void 0!==t.indent&&(e.indent=t.indent,"left"!==e.hAlign&&"right"!==e.hAlign&&(e.hAlign="left")),null!==t.rotation&&void 0!==t.rotation&&(e.rotation=t.rotation),null!==t.vAlign&&void 0!==t.vAlign&&(e.vAlign=t.vAlign.toLowerCase()),null!==t.underline&&void 0!==t.underline&&(e.underline=t.underline),null!==t.strikeThrough&&void 0!==t.strikeThrough&&(e.strikeThrough=t.strikeThrough),null!==t.wrapText&&void 0!==t.wrapText&&(e.wrapText=t.wrapText),null!==t.numberFormat&&void 0!==t.numberFormat?null!==t.type&&void 0!==t.type?e.numberFormat=this.getNumberFormat(t.numberFormat,t.type):e.numberFormat=this.getNumberFormat(t.numberFormat,i):void 0!==r?(e.numFmtId=14,e.numberFormat="GENERAL"):e.numberFormat="GENERAL",e.index=this.processCellStyle(e)},t.prototype.switchNumberFormat=function(t,e){var i=this.getNumberFormat(t,e);if(i!==t){var r=this.mNumFmt.get(t);if(void 0!==r&&(r.formatCode=i,this.mNumFmt.has(i))){for(var n=0,o=this.mCellStyleXfs;n<o.length;n++){var s=o[n];s.numFmtId===r.numFmtId&&(s.numFmtId=this.mNumFmt.get(i).numFmtId)}for(var a=0,h=this.mCellXfs;a<h.length;a++){var l=h[a];l.numFmtId===r.numFmtId&&(l.numFmtId=this.mNumFmt.get(i).numFmtId)}}}},t.prototype.getNumberFormat=function(t,e){var i;switch(e){case"number":try{i=this.intl.getNumberPattern({format:t,currency:this.currency,useGrouping:!0},!0)}catch(e){i=t}break;case"datetime":try{i=this.intl.getDatePattern({skeleton:t,type:"dateTime"},!0)}catch(e){try{i=this.intl.getDatePattern({format:t,type:"dateTime"},!0)}catch(e){i=t}}break;case"date":try{i=this.intl.getDatePattern({skeleton:t,type:"date"},!0)}catch(e){try{i=this.intl.getDatePattern({format:t,type:"date"},!0)}catch(e){i=t}}break;case"time":try{i=this.intl.getDatePattern({skeleton:t,type:"time"},!0)}catch(e){try{i=this.intl.getDatePattern({format:t,type:"time"},!0)}catch(e){i=t}}break;default:i=t;break}return i},t.prototype.parserBorder=function(t,e){null!==t.color&&void 0!==t.color?e.color=t.color:e.color="#000000",null!==t.lineStyle&&void 0!==t.lineStyle?e.lineStyle=t.lineStyle:e.lineStyle="thin"},t.prototype.processCellStyle=function(t){if(t.isGlobalStyle)return this.processNumFormatId(t),this.mStyles.push(t),this.mStyles.length;var e=this.compareStyle(t);return e.result?e.index:(this.processNumFormatId(t),this.mStyles.push(t),this.mStyles.length)},t.prototype.processNumFormatId=function(t){if("GENERAL"!==t.numberFormat&&!this.mNumFmt.has(t.numberFormat)){var e=this.mNumFmt.size+164;this.mNumFmt.set(t.numberFormat,new vn(e,t.numberFormat))}},t.prototype.isNewFont=function(t){for(var e=!1,i=0,r=0,n=this.mFonts;r<n.length;r++){var o=n[r];i++;var s=void 0;if(void 0!==t.fontColor&&(s="FF"+t.fontColor.replace("#","")),e=o.color===s&&o.b===t.bold&&o.i===t.italic&&o.u===t.underline&&o.strike===t.strikeThrough&&o.name===t.fontName&&o.sz===t.fontSize,e)break}return i-=1,{index:i,result:e}},t.prototype.isNewBorder=function(t){var e=new fn;return this.isAllBorder(t.borders)?e.borders.all.color===t.borders.all.color&&e.borders.all.lineStyle===t.borders.all.lineStyle:e.borders.left.color===t.borders.left.color&&e.borders.left.lineStyle===t.borders.left.lineStyle&&e.borders.right.color===t.borders.right.color&&e.borders.right.lineStyle===t.borders.right.lineStyle&&e.borders.top.color===t.borders.top.color&&e.borders.top.lineStyle===t.borders.top.lineStyle&&e.borders.bottom.color===t.borders.bottom.color&&e.borders.bottom.lineStyle===t.borders.bottom.lineStyle},t.prototype.isAllBorder=function(t){var e=new fn;return e.borders.all.color!==t.all.color&&e.borders.all.lineStyle!==t.all.lineStyle},t.prototype.compareStyle=function(t){for(var e=!0,i=0,r=0,n=this.mStyles;r<n.length;r++){var o=n[r];if(e=!o.isGlobalStyle&&(o.backColor===t.backColor&&o.bold===t.bold&&o.numFmtId===t.numFmtId&&o.numberFormat===t.numberFormat&&o.type===t.type&&o.fontColor===t.fontColor&&o.fontName===t.fontName&&o.fontSize===t.fontSize&&o.hAlign===t.hAlign&&o.italic===t.italic&&o.underline===t.underline&&o.strikeThrough===t.strikeThrough&&o.vAlign===t.vAlign&&o.indent===t.indent&&o.rotation===t.rotation&&o.wrapText===t.wrapText&&o.borders.all.color===t.borders.all.color&&o.borders.all.lineStyle===t.borders.all.lineStyle&&o.borders.left.color===t.borders.left.color&&o.borders.left.lineStyle===t.borders.left.lineStyle&&o.borders.right.color===t.borders.right.color&&o.borders.right.lineStyle===t.borders.right.lineStyle&&o.borders.top.color===t.borders.top.color&&o.borders.top.lineStyle===t.borders.top.lineStyle&&o.borders.bottom.color===t.borders.bottom.color&&o.borders.bottom.lineStyle===t.borders.bottom.lineStyle),e){i=o.index;break}}return{index:i,result:e}},t.prototype.contains=function(t,e){var i=t.indexOf(e);return i>-1&&i<t.length},t.prototype.getCellValueType=function(t){return t instanceof Date?"datetime":"boolean"===typeof t?"boolean":"number"===typeof t?"number":"string"},t.prototype.parseCellType=function(t){var e,i=t.type,r=t.value;switch(i){case"datetime":if(r=this.toOADate(r),void 0!==t.cellStyle&&void 0!==t.cellStyle.name&&this.globalStyles.has(t.cellStyle.name)){var n=this.globalStyles.get(t.cellStyle.name);this.switchNumberFormat(n.format,n.type)}e="n";break;case"boolean":r=r?1:0,e="b";break;case"number":e="n",void 0!==t.cellStyle&&void 0!==t.cellStyle.name&&this.globalStyles.has(t.cellStyle.name)&&this.switchNumberFormat(this.globalStyles.get(t.cellStyle.name).format,"number");break;case"string":this.sharedStringCount++,e="s";var o=this.processCellValue(r,t);this.contains(this.sharedString,o)||this.sharedString.push(o),r=this.sharedString.indexOf(o);break;default:break}t.saveType=e,t.value=r},t.prototype.parserImages=function(t,e){var i=t.length;e.images=[];for(var r=0;r<i;r++){var n=this.parserImage(t[r]);e.images.push(n)}},t.prototype.parseFilters=function(t,e){if(e.autoFilters=new Nn,null===t.row||void 0===t.row)throw new Error("Argument Null Exception: row null or empty");if(e.autoFilters.row=t.row,null===t.lastRow||void 0===t.lastRow)throw new Error("Argument Null Exception: lastRow cannot be null or empty");if(e.autoFilters.lastRow=t.lastRow,null===t.column||void 0===t.column)throw new Error("Argument Null Exception: column cannot be null or empty");if(e.autoFilters.column=t.column,null===t.lastColumn||void 0===t.row)throw new Error("Argument Null Exception: lastColumn cannot be null or empty");e.autoFilters.lastColumn=t.lastColumn},t.prototype.parserImage=function(t){var e=new Ln;return null!==t.image&&void 0!==t.image&&(e.image=t.image),null!==t.row&&void 0!==t.row&&(e.row=t.row),null!==t.column&&void 0!==t.column&&(e.column=t.column),null!==t.lastRow&&void 0!==t.lastRow&&(e.lastRow=t.lastRow),null!==t.lastColumn&&void 0!==t.lastColumn&&(e.lastColumn=t.lastColumn),null!==t.width&&void 0!==t.width&&(e.width=t.width),null!==t.height&&void 0!==t.height&&(e.height=t.height),null!==t.horizontalFlip&&void 0!==t.horizontalFlip&&(e.horizontalFlip=t.horizontalFlip),null!==t.verticalFlip&&void 0!==t.verticalFlip&&(e.verticalFlip=t.verticalFlip),null!==t.rotation&&void 0!==t.rotation&&(e.rotation=t.rotation),e},t.prototype.saveAsBlob=function(t){var e=this;switch(t){case"text/csv":return new Promise(function(t,i){var r={};r.blobData=e.csvHelper.saveAsBlob(),t(r)});default:return new Promise(function(t,i){e.saveInternal(),e.mArchive.saveAsBlob().then(function(e){var i={};i.blobData=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),t(i)})})}},t.prototype.save=function(t,e){var i=this;if(null===t||void 0===t||""===t)throw new Error("Argument Null Exception: fileName cannot be null or empty");var r=t.match(".xlsx$"),n=t.match(".csv$");if(null!==r&&r[0]==="."+this.mSaveType)this.saveInternal(),this.mArchive.save(t).then(function(){i.mArchive.destroy()});else{if(null===n||n[0]!=="."+this.mSaveType)throw Error("Save type and file extension is different.");this.csvHelper.save(t)}},t.prototype.saveInternal=function(){this.saveWorkbook(),this.saveWorksheets(),this.saveSharedString(),this.saveStyles(),this.saveApp(this.builtInProperties),this.saveCore(this.builtInProperties),this.saveContentType(),this.saveTopLevelRelation(),this.saveWorkbookRelation()},t.prototype.saveWorkbook=function(){for(var t='<?xml version="1.0" encoding="utf-8"?><workbook xmlns:r = "http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns= "http://schemas.openxmlformats.org/spreadsheetml/2006/main"><workbookPr codeName="ThisWorkbook" defaultThemeVersion= "153222"/><bookViews><workbookView activeTab="0"/></bookViews>',e="<sheets>",i=this.worksheets.length,r=0;r<i;r++){var n=this.worksheets[r].name;n=n.replace("&","&amp;"),n=n.replace("<","&lt;"),n=n.replace(">","&gt;"),n=n.replace('"',"&quot;"),e+='<sheet name="'+n+'" sheetId="'+(r+1).toString()+'" r:id ="rId'+(r+1).toString()+'" />'}if(e+="</sheets>",t+=e,this.printTitles.size>0){var o="<definedNames>";this.printTitles.forEach(function(t,e){o+='<definedName name="_xlnm.Print_Titles" localSheetId="'+e+'">'+t+"</definedName>"}),o+="</definedNames>",t+=o}this.addToArchive(t+"</workbook>","xl/workbook.xml")},t.prototype.saveWorksheets=function(){for(var t=this.worksheets.length,e=0;e<t;e++)this.saveWorksheet(this.worksheets[e],e)},t.prototype.saveWorksheet=function(t,e){var i=new En,r='<?xml version="1.0" encoding="utf-8" standalone="yes"?><worksheet xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:x14="http://schemas.microsoft.com/office/spreadsheetml/2009/9/main" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main">';if(t.isSummaryRowBelow?r+="<sheetPr />":r+='<sheetPr><outlinePr summaryBelow="0" ></outlinePr></sheetPr>',r+=this.saveSheetView(t),void 0!==t.columns){for(var n="<cols>",o=0,a=t.columns;o<a.length;o++){var h=a[o];void 0!==h.width?n+='<col min="'+h.index+'" max="'+h.index+'" width="'+this.pixelsToColumnWidth(h.width)+'" customWidth="1" />':n+='<col min="'+h.index+'" max="'+h.index+'" width="8.43" customWidth="1" />'}r+=n+"</cols>"}if(r+="<sheetData>",i.append(r),r="",void 0!==t.rows)for(var l=0,u=t.rows;l<u.length;l++){var c=u[l],p='<row r="'+c.index+'" ';Object(s["T"])(c.spans)||(p+='spans="'+c.spans+'" '),void 0!==c.height&&(p+='ht="'+this.pixelsToRowHeight(c.height)+'" customHeight="1" '),void 0!==c.grouping&&(c.grouping.isHidden&&(p+='hidden="1" '),void 0!==c.grouping.outlineLevel&&(p+='outlineLevel="'+c.grouping.outlineLevel+'" '),c.grouping.isCollapsed&&(p+='collapsed="1" ')),p+=">";for(var d=0,f=c.cells;d<f.length;d++){var g=f[d];void 0===g||void 0===g.value&&void 0===g.cellStyle||(p+='<c r="'+g.refName+'" ',void 0!==g.saveType&&(p+='t="'+g.saveType+'" '),void 0!==g.styleIndex&&(p+='s="'+g.styleIndex+'" '),p+=" >",void 0!==g.formula&&(p+="<f>"+g.formula+"</f>"),void 0!==g.value?p+="<v>"+g.value+"</v></c>":p+="</c>")}p+="</row>",i.append(p)}if(r+="</sheetData>",null!==t.autoFilters&&void 0!==t.autoFilters&&(r+='<autoFilter ref="'+this.getCellName(t.autoFilters.row,t.autoFilters.column)+":"+this.getCellName(t.autoFilters.lastRow,t.autoFilters.lastColumn)+'"/>'),t.mergeCells.length>0){r+='<mergeCells count="'+t.mergeCells.length+'">';for(var m=0,y=t.mergeCells;m<y.length;m++){var b=y[m];r+='<mergeCell ref="'+b.ref+'" />'}r+="</mergeCells>"}if(t.hyperLinks.length>0){r+="<hyperlinks>";for(var w=0,v=t.hyperLinks;w<v.length;w++){var S=v[w];r+='<hyperlink ref="'+S.ref+'" r:id="rId'+S.rId+'" />'}r+="</hyperlinks>"}r+='<pageMargins left="0.75" right="0.75" top="1" bottom="1" header="0.5" footer="0.5" /><headerFooter scaleWithDoc="1" alignWithMargins="0" differentFirst="0" differentOddEven="0" />',void 0!=t.images&&t.images.length>0&&(this.drawingCount++,this.saveDrawings(t,t.index),r+='<drawing r:id="rId'+(t.hyperLinks.length+1)+'"/>'),this.addToArchive(this.saveSheetRelations(t),"xl/worksheets/_rels/sheet"+t.index+".xml.rels"),i.append(r+"</worksheet>"),this.addToArchive(i.getBlob(),"xl/worksheets/sheet"+(e+1)+".xml")},t.prototype.saveDrawings=function(t,e){var i=new En,r='<xdr:wsDr xmlns:xdr="http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing" xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main">';if(void 0!==t.images){for(var n=0,o=0,s=t.images;o<s.length;o++){var a=s[o];void 0!==a.height&&void 0!==a.width?(this.updatelastRowOffset(t,a),this.updatelastColumnOffSet(t,a),a.lastRow-=1,a.lastColumn-=1):void 0!==a.lastRow&&void 0!==a.lastColumn&&(a.lastRowOffset=0,a.lastColOffset=0),n++,r+='<xdr:twoCellAnchor editAs="oneCell">',r+="<xdr:from><xdr:col>",r+=a.column-1,r+="</xdr:col><xdr:colOff>",r+=0,r+="</xdr:colOff><xdr:row>",r+=a.row-1,r+="</xdr:row><xdr:rowOff>",r+=0,r+="</xdr:rowOff></xdr:from>",r+="<xdr:to><xdr:col>",r+=a.lastColumn,r+="</xdr:col><xdr:colOff>",r+=a.lastColOffset,r+="</xdr:colOff><xdr:row>",r+=a.lastRow,r+="</xdr:row><xdr:rowOff>",r+=a.lastRowOffset,r+="</xdr:rowOff></xdr:to>",r+="<xdr:pic>",r+="<xdr:nvPicPr>",r+='<xdr:cNvPr id="'+n+'" name="Picture '+n+'"> </xdr:cNvPr>',r+='<xdr:cNvPicPr><a:picLocks noChangeAspect="1"/></xdr:cNvPicPr> </xdr:nvPicPr>',r+="<xdr:blipFill>",r+='<a:blip xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" r:embed="rId'+n+'" cstate="print">',r+="</a:blip><a:stretch><a:fillRect /></a:stretch></xdr:blipFill>",r+="<xdr:spPr>",r+="<a:xfrm",void 0!=a.rotation&&a.rotation<=3600&&a.rotation>=-3600&&(r+=' rot="'+6e4*a.rotation+'"'),void 0!=a.verticalFlip&&0!=a.verticalFlip&&(r+=' flipV="1"'),void 0!=a.horizontalFlip&&0!=a.horizontalFlip&&(r+=' flipH="1"'),r+="/>",r+='<a:prstGeom prst="rect"><a:avLst /></a:prstGeom></xdr:spPr>',r+="</xdr:pic><xdr:clientData /></xdr:twoCellAnchor>";new En;var h=this.convertBase64toImage(a.image);this.imageCount+=1,this.addToArchive(h,"xl/media/image"+this.imageCount+".png")}i.append(r),i.append("</xdr:wsDr>"),this.saveDrawingRelations(t),this.addToArchive(i.getBlob(),"xl/drawings/drawing"+this.drawingCount+".xml")}},t.prototype.updatelastRowOffset=function(t,e){var i=e.height,r=e.row,n=0;while(i>=0){var o=0;o=void 0!==t.rows&&void 0!==t.rows[r-1]?this.convertToPixels(void 0===t.rows[r-1].height?15:t.rows[r-1].height):this.convertToPixels(15);var s=o-n*o/256;if(s>i){e.lastRow=r,e.lastRowOffset=n+256*i/o;var a=0;a=void 0!==t.rows&&void 0!==t.rows[r-1]?this.convertToPixels(void 0===t.rows[r-1].height?15:t.rows[r-1].height):this.convertToPixels(15),e.lastRowOffset=a*e.lastRowOffset/256,e.lastRowOffset=Math.round(e.lastRowOffset/this.unitsProportions[7]);break}i-=s,r++,n=0}},t.prototype.updatelastColumnOffSet=function(t,e){var i=e.width,r=e.column,n=0;while(i>=0){var o=0;o=void 0!==t.columns&&void 0!==t.columns[r-1]?this.ColumnWidthToPixels(void 0===t.columns[r-1].width?8.43:t.columns[r-1].width):this.ColumnWidthToPixels(8.43);var s=o-n*o/1024;if(s>i){e.lastColumn=r,e.lastColOffset=n+1024*i/o;var a=0;a=void 0!==t.columns&&void 0!==t.columns[r-1]?this.ColumnWidthToPixels(void 0===t.columns[r-1].width?8.43:t.columns[r].width):this.ColumnWidthToPixels(8.43),e.lastColOffset=a*e.lastColOffset/1024,e.lastColOffset=Math.round(e.lastColOffset/this.unitsProportions[7]);break}i-=s,r++,n=0}},t.prototype.convertToPixels=function(t){return t*this.unitsProportions[6]},t.prototype.convertBase64toImage=function(t){for(var e=window.atob(t),i=new ArrayBuffer(e.length),r=new Uint8Array(i),n=0;n<e.length;n++)r[n]=e.charCodeAt(n);var o=new Blob([r],{type:"image/png"});return o},t.prototype.saveDrawingRelations=function(t){for(var e='<?xml version="1.0" encoding="utf-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">',i=t.images.length,r=this.imageCount-t.images.length,n=1;n<=i;n++)r++,e+='<Relationship Id="rId'+n+'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image" Target="../media/image'+r+'.png" />';this.addToArchive(e+"</Relationships>","xl/drawings/_rels/drawing"+this.drawingCount+".xml.rels")},t.prototype.pixelsToColumnWidth=function(t){var e=7,i=t>e+5?this.trunc((t-5)/e*100+.5)/100:t/(e+5);return i>1?(i*e+5)/e*256/256:i*(e+5)/e*256/256},t.prototype.ColumnWidthToPixels=function(t){var e=7,i=t>1?(t*e+5)/e*256/256:t*(e+5)/e*256/256;return this.trunc((256*i+this.trunc(128/e))/256*e)},t.prototype.trunc=function(t){var e=t-t%1;return 0===e&&(t<0||0===t&&1/t!==1/0)?-0:e},t.prototype.pixelsToRowHeight=function(t){return t*this.unitsProportions[5]/this.unitsProportions[6]},t.prototype.saveSheetRelations=function(t){for(var e='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">',i=0,r=t.hyperLinks;i<r.length;i++){var n=r[i];e+='<Relationship Id="rId'+n.rId+'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink" Target="'+this.processString(n.target)+'" TargetMode="External" />'}return void 0!=t.images&&t.images.length>0&&(e+='<Relationship Id="rId'+(t.hyperLinks.length+1)+'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing" Target="../drawings/drawing'+this.drawingCount+'.xml" />'),e+="</Relationships>",e},t.prototype.saveSheetView=function(t){var e='<sheetViews><sheetView workbookViewId="0" ';return!0===t.enableRtl&&(e+='rightToLeft="1"'),!1===t.showGridLines?e+='showGridLines="0" >':e+=">",void 0!==t.freezePanes&&(e+='<pane state="frozen" topLeftCell="'+t.freezePanes.leftCell+'" ',0!==t.freezePanes.row&&(e+='ySplit="'+t.freezePanes.row+'" '),0!==t.freezePanes.column&&(e+='xSplit="'+t.freezePanes.column+'" '),e+="/>"),e+="</sheetView></sheetViews > ",e},t.prototype.saveSharedString=function(){var t=this.sharedString.length;if(t>0){for(var e='<?xml version="1.0" encoding="utf-8"?><sst uniqueCount="'+t+'" count="'+this.sharedStringCount+'" xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main">',i="",r=0;r<t;r++)0!==this.sharedString[r].indexOf("<r>")?(i+="<si><t>",i+=this.processString(this.sharedString[r]),i+="</t></si>"):(i+="<si>",i+=this.sharedString[r],i+="</si>");i+="</sst>",this.addToArchive(e+i,"xl/sharedStrings.xml")}},t.prototype.processString=function(t){return-1!==t.indexOf("&")&&(t=t.replace(/&/g,"&amp;")),-1!==t.indexOf("<")&&(t=t.replace(/</g,"&lt;")),-1!==t.indexOf(">")&&(t=t.replace(/>/g,"&gt;")),t},t.prototype.saveStyles=function(){this.updateCellXfsStyleXfs();var t='<?xml version="1.0" encoding="utf-8"?><styleSheet xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac" xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main">';t+=this.saveNumberFormats(),t+=this.saveFonts(),t+=this.saveFills(),t+=this.saveBorders(),t+=this.saveCellStyleXfs(),t+=this.saveCellXfs(),t+=this.saveCellStyles(),this.addToArchive(t+"</styleSheet>","xl/styles.xml")},t.prototype.updateCellXfsStyleXfs=function(){for(var t=0,e=this.mStyles;t<e.length;t++){var i=e[t],r=void 0;i.isGlobalStyle?(r=new bn,r.xfId=i.index-1):(r=new mn,r.xfId=0);var n=this.isNewFont(i);if(n.result)r.fontId=n.index;else{var o=new gn;o.b=i.bold,o.i=i.italic,o.name=i.fontName,o.sz=i.fontSize,o.u=i.underline,o.strike=i.strikeThrough,o.color="FF"+i.fontColor.replace("#",""),this.mFonts.push(o),r.fontId=this.mFonts.length-1}if("none"!==i.backColor){var s="FF"+i.backColor.replace("#","");if(this.mFills.has(s)){var a=this.mFills.get(s);r.fillId=a}else{a=this.mFills.size+2;this.mFills.set(s,a),r.fillId=a}}else r.fillId=0;if(this.isNewBorder(i)?r.borderId=0:(this.mBorders.push(i.borders),r.borderId=this.mBorders.length),"GENERAL"!==i.numberFormat)if(this.mNumFmt.has(i.numberFormat)){var h=this.mNumFmt.get(i.numberFormat);r.numFmtId=h.numFmtId}else{var l=this.mNumFmt.size+164;this.mNumFmt.set(i.numberFormat,new vn(l,i.numberFormat)),r.numFmtId=l}else"GENERAL"===i.numberFormat&&14===i.numFmtId?r.numFmtId=14:r.numFmtId=0;i.isGlobalStyle||(r.applyAlignment=1),r.alignment=new yn,r.alignment.indent=i.indent,r.alignment.horizontal=i.hAlign,r.alignment.vertical=i.vAlign,r.alignment.wrapText=i.wrapText?1:0,r.alignment.rotation=i.rotation,i.isGlobalStyle?(this.mCellStyleXfs.push(r),this.mCellXfs.push(r)):this.mCellXfs.push(r)}},t.prototype.saveNumberFormats=function(){if(this.mNumFmt.size>=1){var t='<numFmts count="'+this.mNumFmt.size+'">';return this.mNumFmt.forEach(function(e,i){t+='<numFmt numFmtId="'+e.numFmtId+'" formatCode="'+e.formatCode.replace(/"/g,"&quot;")+'" />'}),t+="</numFmts>"}return""},t.prototype.saveFonts=function(){var t='<fonts count="'+this.mFonts.length+'">';if(this.mFonts.length>=1)for(var e=0,i=this.mFonts;e<i.length;e++){var r=i[e];t+="<font>",r.b&&(t+="<b />"),r.i&&(t+="<i />"),r.u&&(t+="<u />"),r.strike&&(t+="<strike />"),t+='<sz val="'+r.sz+'" />',t+='<color rgb="'+r.color+'" />',t+='<name val="'+r.name+'" /></font>'}return t+"</fonts>"},t.prototype.saveFills=function(){var t='<fills count="'+(this.mFills.size+2)+'"><fill><patternFill patternType="none"></patternFill></fill><fill><patternFill patternType="gray125"></patternFill></fill>';return this.mFills.size>=1&&this.mFills.forEach(function(e,i){t+='<fill><patternFill patternType="solid"><fgColor rgb="'+i+'" /><bgColor rgb="FFFFFFFF" /></patternFill></fill>'}),t+"</fills>"},t.prototype.saveBorders=function(){var t='<borders count="'+(this.mBorders.length+1)+'"><border><left /><right /><top /><bottom /><diagonal /></border>';if(this.mBorders.length>=1)for(var e=0,i=this.mBorders;e<i.length;e++){var r=i[e];if(this.isAllBorder(r)){var n=r.all.color.replace("#",""),o=r.all.lineStyle;t+='<border><left style="'+o+'"><color rgb="FF'+n+'" /></left><right style="'+o+'"><color rgb="FF'+n+'" /></right><top style="'+o+'"><color rgb="FF'+n+'" /></top><bottom style="'+o+'"><color rgb="FF'+n+'" /></bottom></border>'}else t+='<border><left style="'+r.left.lineStyle+'"><color rgb="FF'+r.left.color.replace("#","")+'" /></left><right style="'+r.right.lineStyle+'"><color rgb="FF'+r.right.color.replace("#","")+'" /></right><top style="'+r.top.lineStyle+'"><color rgb="FF'+r.top.color.replace("#","")+'" /></top><bottom style="'+r.bottom.lineStyle+'"><color rgb="FF'+r.bottom.color.replace("#","")+'" /></bottom></border>'}return t+"</borders>"},t.prototype.saveCellStyles=function(){var t=this,e='<cellStyles  count="'+this.cellStyles.size+'">';return this.cellStyles.forEach(function(i,r){e+='<cellStyle name="'+r+'" xfId="'+t.cellStyles.get(r).xfId+'"',"Normal"===r&&(e+=' builtinId="0"'),e+=" />"}),e+="</cellStyles>"},t.prototype.saveCellStyleXfs=function(){var t='<cellStyleXfs count="'+(this.mCellStyleXfs.length+1)+'"><xf numFmtId="0" fontId="0" fillId="0" borderId="0" />';if(this.mCellStyleXfs.length>=1)for(var e=0,i=this.mCellStyleXfs;e<i.length;e++){var r=i[e];t+='<xf numFmtId="'+r.numFmtId+'" fontId="'+r.fontId+'" fillId="'+r.fillId+'" borderId="'+r.borderId+'" ',void 0!==r.alignment?t+=">"+this.saveAlignment(r)+"</xf>":t+=" />"}return t+"</cellStyleXfs>"},t.prototype.saveCellXfs=function(){var t='<cellXfs count="'+(this.mCellXfs.length+1)+'"><xf numFmtId="0" fontId="0" fillId="0" borderId="0" xfId="0" />';if(this.mCellXfs.length>=1)for(var e=0,i=this.mCellXfs;e<i.length;e++){var r=i[e];t+='<xf numFmtId="'+r.numFmtId+'" fontId="'+r.fontId+'" fillId="'+r.fillId+'" borderId="'+r.borderId+'" xfId="'+r.xfId+'" ',1===r.applyAlignment&&(t+='applyAlignment="1"'),t+=">"+this.saveAlignment(r)+"</xf>"}return t+"</cellXfs>"},t.prototype.saveAlignment=function(t){var e="<alignment ";return void 0!==t.alignment.horizontal&&(e+='horizontal="'+t.alignment.horizontal+'" '),void 0!==t.alignment.indent&&0!==t.alignment.indent?e+='indent="'+t.alignment.indent+'" ':void 0!==t.alignment.rotation&&0!==t.alignment.rotation&&(e+='textRotation="'+t.alignment.rotation+'" '),void 0!==t.alignment.vertical&&(e+='vertical="'+t.alignment.vertical+'" '),e+='wrapText="'+t.alignment.wrapText+'" />',e},t.prototype.saveApp=function(t){var e='<?xml version="1.0" encoding="utf-8" standalone="yes"?><Properties xmlns="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties"><Application>Essential XlsIO</Application>';void 0!==t&&(void 0!==t.manager&&(e+="<Manager>"+t.manager+"</Manager>"),void 0!==t.company&&(e+="<Company>"+t.company+"</Company>")),this.addToArchive(e+"</Properties>","docProps/app.xml")},t.prototype.saveCore=function(t){var e=new Date,i='<?xml version="1.0" encoding="utf-8" standalone="yes"?><cp:coreProperties xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" xmlns:dcmitype="http://purl.org/dc/dcmitype/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:cp="http://schemas.openxmlformats.org/package/2006/metadata/core-properties">';void 0!==this.builtInProperties?(void 0!==t.author&&(i+="<dc:creator>"+t.author+"</dc:creator>"),void 0!==t.subject&&(i+="<dc:subject>"+t.subject+"</dc:subject>"),void 0!==t.category&&(i+="<cp:category>"+t.category+"</cp:category>"),void 0!==t.comments&&(i+="<dc:description>"+t.comments+"</dc:description>"),void 0!==t.title&&(i+="<dc:title>"+t.title+"</dc:title>"),void 0!==t.tags&&(i+="<cp:keywords>"+t.tags+"</cp:keywords>"),void 0!==t.status&&(i+="<cp:contentStatus>"+t.status+"</cp:contentStatus>"),void 0!==t.createdDate?i+='<dcterms:created xsi:type="dcterms:W3CDTF">'+t.createdDate.toISOString()+"</dcterms:created>":i+='<dcterms:created xsi:type="dcterms:W3CDTF">'+e.toISOString()+"</dcterms:created>",void 0!==t.modifiedDate?i+='<dcterms:modified xsi:type="dcterms:W3CDTF">'+t.modifiedDate.toISOString()+"</dcterms:modified>":i+='<dcterms:modified xsi:type="dcterms:W3CDTF">'+e.toISOString()+"</dcterms:modified>"):(i+='<dcterms:created xsi:type="dcterms:W3CDTF">'+e.toISOString()+"</dcterms:created>",i+='<dcterms:modified xsi:type="dcterms:W3CDTF">'+e.toISOString()+"</dcterms:modified>"),i+="</cp:coreProperties>",this.addToArchive(i,"docProps/core.xml")},t.prototype.saveTopLevelRelation=function(){var t='<?xml version="1.0" encoding="utf-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="xl/workbook.xml" /><Relationship Id="rId2" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties" Target="docProps/app.xml" /><Relationship Id="rId3" Type="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties" Target="docProps/core.xml" /></Relationships>';this.addToArchive(t,"_rels/.rels")},t.prototype.saveWorkbookRelation=function(){for(var t='<?xml version="1.0" encoding="utf-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">',e=this.worksheets.length,i=0,r=0;r<e;r++,i++)t+='<Relationship Id="rId'+(r+1).toString()+'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Target="worksheets/sheet'+(r+1).toString()+'.xml" />';t+='<Relationship Id="rId'+(++i).toString()+'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles" Target="styles.xml" />',this.sharedStringCount>0&&(t+='<Relationship Id="rId'+(++i).toString()+'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings" Target="sharedStrings.xml" />'),this.addToArchive(t+"</Relationships>","xl/_rels/workbook.xml.rels")},t.prototype.saveContentType=function(){for(var t='<?xml version="1.0" encoding="utf-8" standalone="yes"?><Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types"><Default Extension="xml" ContentType="application/xml" /><Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml" /><Override PartName="/xl/styles.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml" /><Override PartName="/xl/workbook.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml" /><Override PartName="/docProps/app.xml" ContentType="application/vnd.openxmlformats-officedocument.extended-properties+xml" /><Override PartName="/docProps/core.xml" ContentType="application/vnd.openxmlformats-package.core-properties+xml" />',e="",i=this.worksheets.length,r=0;r<i;r++)e+='<Override PartName="/xl/worksheets/sheet'+(r+1).toString()+'.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml" />',void 0!=this.worksheets[r].images&&this.worksheets[r].images.length>0&&(e+='<Override PartName="/xl/drawings/drawing'+(r+1).toString()+'.xml" ContentType="application/vnd.openxmlformats-officedocument.drawing+xml" />');this.imageCount>0&&(e+='<Default Extension="png" ContentType="image/png" />'),this.sharedStringCount>0&&(t+='<Override PartName="/xl/sharedStrings.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml" />'),this.addToArchive(t+e+"</Types>","[Content_Types].xml")},t.prototype.addToArchive=function(t,e){if("string"===typeof t){var i=new Blob([t],{type:"text/plain"}),r=new Fn(i,e);this.mArchive.addItem(r)}else{r=new Fn(t,e);this.mArchive.addItem(r)}},t.prototype.processMergeCells=function(t,e,i){if(0!==t.rowSpan||0!==t.colSpan){var r=new pn;r.x=t.index,r.width=t.colSpan,r.y=e,r.height=t.rowSpan;var n=this.getCellName(r.y,r.x),o=this.getCellName(e+r.height,t.index+r.width);r.ref=n+":"+o;i.add(r);var s={x:r.x,y:r.y},a={x:t.index+r.width,y:e+r.height};this.updatedMergedCellStyles(s,a,t)}return i},t.prototype.updatedMergedCellStyles=function(t,e,i){for(var r=t.x;r<=e.x;r++)for(var n=t.y;n<=e.y;n++)this.mergedCellsStyle.set(this.getCellName(n,r),{x:r,y:n,styleIndex:i.styleIndex})},t.prototype.dateToTicks=function(t,e,i){var r=864e9,n=[0,31,59,90,120,151,181,212,243,273,304,334,365],o=[0,31,60,91,121,152,182,213,244,274,305,335,366];if(t>=1&&t<=9999&&e>=1&&e<=12){var s=this.isLeapYear(t)?o:n,a=t-1,h=365*a+(a/4|0)-(a/100|0)+(a/400|0)+s[e-1]+i-1;return h*r}throw new Error("Not a valid date")},t.prototype.timeToTicks=function(t,e,i){if(t>=0&&t<24&&e>=0&&e<60&&i>=0&&i<60){var r=3600*t+60*e+i;return 1e4*r*1e3}throw new Error("Not valid time")},t.prototype.isLeapYear=function(t){return t%4===0&&(t%100!==0||t%400===0)},t.prototype.toOADate=function(t){var e=0;if(e=this.dateToTicks(t.getFullYear(),t.getMonth()+1,t.getDate())+this.timeToTicks(t.getHours(),t.getMinutes(),t.getSeconds()),0===e)return 0;var i=864e9,r=693593,n=r*i,o=36159*i;if(e<o)throw new Error("Arg_OleAutDateInvalid");var s=864e5;return(e-n)/1e4/s},t}(),Vn=function(){function t(){}return t}(),zn=function(){function t(t,e){this.book={},this.workSheet=[],this.rows=[],this.columns=[],this.styles=[],this.rowLength=1,this.expType="AppendToSheet",this.includeHiddenColumn=!1,this.isCsvExport=!1,this.isElementIdChanged=!1,this.gridPool={},this.sheet={},this.parent=t,this.helper=new $r(t),this.locator=e,this.l10n=this.locator.getService("localization")}return t.prototype.getModuleName=function(){return"ExcelExport"},t.prototype.init=function(t){null!==t.element&&""===t.element.id&&(t.element.id=(new Date).toISOString(),this.isElementIdChanged=!0),this.parent=t,this.parent.isDestroyed||(this.isExporting=void 0,this.book={},this.workSheet=[],this.rows=[],this.columns=[],this.styles=[],this.rowLength=1,this.footer=void 0,this.expType="AppendToSheet",this.includeHiddenColumn=!1,this.exportValueFormatter=new tn(t.locale),t.id=Object(c["T"])("main-grid"),this.gridPool[t.id]=!1)},t.prototype.Map=function(t,e,i,r,n,o){var a=t,l="cancel",u="isBlob",p="isCsv",d="workbook",f="isMultipleExport";this.gridPool={},t.childGrid&&(Object(s["T"])(e)||"None"!==e.hierarchyExportMode)&&(t.expandedRows=Object(c["P"])(t).expandedRows);var g={requestType:"beforeExcelExport",gridObject:a,cancel:!1,isMultipleExport:i,workbook:r,isCsv:n,isBlob:o};return a.trigger(h["y"],g),g[l]?new Promise(function(t){return t()}):(this.parent.log("exporting_begin",this.getModuleName()),this.data=new en["a"](a),this.isExporting=!0,this.isBlob=g[u],g[p]?this.isCsvExport=g[p]:this.isCsvExport=!1,Object(c["bb"])(e)&&Object(c["Gb"])(e,a),this.processRecords(a,e,g[f],g[d]))},t.prototype.exportingSuccess=function(t){this.isExporting=!1,this.parent.trigger(h["Sb"],this.isBlob?{promise:this.blobPromise}:{}),this.parent.log("exporting_complete",this.getModuleName()),t(this.book)},t.prototype.processRecords=function(t,e,i,r){var n=this;if(!Object(s["T"])(e)&&!Object(s["T"])(e.dataSource)&&e.dataSource instanceof Qr["a"]){var o=e.query?e.query:new Zr["b"];return(Object(s["T"])(o.isCountRequired)||t.aggregates)&&(o.isCountRequired=!0),new Promise(function(s){var a=e.dataSource.executeQuery(o);a.then(function(o){n.init(t),n.processInnerRecords(t,e,i,r,o).then(function(){n.exportingSuccess(s)})})})}if(Object(s["T"])(e)||"CurrentPage"!==e.exportType){var a=[];return a.push(this.data.getData({},$r.getQuery(t,this.data))),a.push(this.helper.getColumnData(t)),new Promise(function(o,s){Promise.all(a).then(function(s){n.init(t),n.processInnerRecords(t,e,i,r,s[0]).then(function(){n.exportingSuccess(o)})}).catch(function(t){s(n.book),n.parent.trigger(h["c"],t)})})}return new Promise(function(o){n.init(t),n.processInnerRecords(t,e,i,r,n.parent.getCurrentViewRecords()),n.exportingSuccess(o)})},t.prototype.processInnerRecords=function(t,e,i,r,n){var o=this;this.groupedColLength=t.groupSettings.columns.length;var a,h=5,l=[],u=Object(c["gb"])(t.columns),p=!Object(s["T"])(e);return p&&!Object(s["T"])(e.multipleExport)&&(this.expType=Object(s["T"])(e.multipleExport.type)?"AppendToSheet":e.multipleExport.type,Object(s["T"])(e.multipleExport.blankRows)||(h=e.multipleExport.blankRows)),Object(s["T"])(r)?(this.workSheet=[],this.rows=[],this.columns=[],this.styles=[],this.sheet.images=[]):"NewSheet"===this.expType?(this.workSheet=r.worksheets,this.rows=[],this.columns=[],this.sheet.images=[],this.styles=r.styles):(this.workSheet=[],this.rows=r.worksheets[0].rows,this.columns=r.worksheets[0].columns,this.styles=r.styles,this.sheet.images=r.worksheets[0].images,this.rowLength=this.rows[this.rows.length-1].index+h,this.rowLength++),p&&(Object(s["T"])(i)?(Object(s["T"])(e.header)||this.processExcelHeader(JSON.parse(JSON.stringify(e.header))),Object(s["T"])(e.footer)||(this.footer=JSON.parse(JSON.stringify(e.footer)))):(Object(s["T"])(e.header)||!i&&"NewSheet"!==this.expType||this.processExcelHeader(JSON.parse(JSON.stringify(e.header))),Object(s["T"])(e.footer)||"AppendToSheet"===this.expType&&i||(this.footer=JSON.parse(JSON.stringify(e.footer))))),this.includeHiddenColumn=!!p&&e.includeHiddenColumn,new Promise(function(i,r){t.childGridLevel=0,l=o.processGridExport(t,e,n),o.globalResolve=i,o.gridPool[t.id]=!0,o.helper.checkAndExport(o.gridPool,o.globalResolve)}).then(function(){var n=[];if(o.organiseRows(l,l[0].index,n),o.rows=o.rows.concat(n),Object(s["T"])(o.footer)||("AppendToSheet"===o.expType&&!i||"NewSheet"===o.expType)&&o.processExcelFooter(o.footer),o.columns.length>0&&(o.sheet.columns=o.columns),o.sheet.rows=o.rows,o.sheet.enableRtl=o.parent.enableRtl,o.parent.allowFiltering&&t.getVisibleColumns().length&&p&&e.enableFilter){var h=e.header?e.header.headerRows||e.header.rows.length:0,c={row:u+h,column:o.groupedColLength?o.groupedColLength+1:o.sheet.columns[0].index,lastRow:o.sheet.rows.length,lastColumn:o.sheet.columns.length};o.sheet.autoFilters=c}if(o.workSheet.push(o.sheet),o.book.worksheets=o.workSheet,o.book.styles=o.styles,t.notify("finalPageSetup",o.book),!i){if(o.isCsvExport){p&&!Object(s["T"])(e.separator)&&","!==e.separator&&(a=e.separator);var d=new Dn(o.book,"csv",t.locale,t.currencyCode,a);o.isBlob?o.blobPromise=d.saveAsBlob("text/csv"):p&&e.fileName?d.save(e.fileName):d.save("Export.csv")}else{d=new Dn(o.book,"xlsx",t.locale,t.currencyCode);o.isBlob?o.blobPromise=d.saveAsBlob("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"):p&&e.fileName?d.save(e.fileName):d.save("Export.xlsx")}o.isElementIdChanged&&(t.element.id=""),delete t.expandedRows}return r})},t.prototype.organiseRows=function(t,e,i){if(!t.length)return e;for(var r=0;r<t.length;r++){var n=t[r],o=n.childRows;o?(n.index=e++,delete n.childRows,i.push(n),e=this.organiseRows(o,e,i)):(n.index=e++,i.push(n))}return e},t.prototype.processGridExport=function(t,e,i){var r=[],n=this.parent.isFrozenGrid()&&!this.parent.getFrozenColumns();Object(s["T"])(e)||Object(s["T"])(e.theme)||(this.theme=e.theme),t.childGrid&&!Object(s["T"])(e)&&(t.hierarchyPrintMode=e.hierarchyExportMode||"Expanded");var o=new $r(t,this.helper.getForeignKeyData()),a=Object(c["bb"])(e)?Object(c["jb"])(e.columns,t.enableColumnVirtualization):o.getGridExportColumns(n?t.getColumns():t.columns),l=o.getHeaders(a,this.includeHiddenColumn),u=t.groupSettings.columns.length?t.groupSettings.columns.length-1:0;return r=this.processHeaderContent(t,l,u,r),r=Object(s["T"])(e)||Object(s["T"])(e.dataSource)||e.dataSource instanceof Qr["a"]?Object(s["T"])(e)||"CurrentPage"!==e.exportType?this.processRecordContent(t,i,l,e,void 0,r,o):this.processRecordContent(t,i,l,e,t.currentViewData,r,o):this.processRecordContent(t,i,l,e,e.dataSource,r,o),t.notify(h["Wb"],{excelRows:r,type:"excel"}),r},t.prototype.processRecordContent=function(t,e,i,r,n,o,a){var h;if(h=!Object(s["T"])(n)&&n.length?n:e.result,Object(s["T"])(h.level)?this.processRecordRows(t,h,i,0,0,r,o,a):this.processGroupedRows(t,h,i,h.level,0,r,o,a),!Object(s["T"])(e.aggregates))if(Object(s["T"])(n)){var l=e.result.GroupGuid?e.result.records:e.result;this.processAggregates(t,l,o)}else this.processAggregates(t,e.result,o,n);return o},t.prototype.processGroupedRows=function(t,e,i,r,n,o,a,l){for(var u=0,c=e;u<c.length;u++){var p=c[u],d=[],f=1,g={};g.index=f+r-1;var m=t.getColumnByField(p.field),y={value:p.key,column:m,style:void 0,isForeignKey:m.isForeignColumn()},b=t.getColumnByField(p.field).headerText+": "+(m.enableGroupByFormat?p.key:this.exportValueFormatter.formatCellValue(y))+" - ";p.count>1?b+=p.count+" items":b+=p.count+" item";var w={captionText:b,type:this.isCsvExport?"CSV":"Excel",data:p};this.parent.trigger(h["Yb"],w),g.value=w.captionText,g.style=this.getCaptionThemeStyle(this.theme),Object(s["T"])(w.style)||(g.style=this.mergeOptions(g.style,w.style));var v=new rn["a"](t),S=v.generateRows(p);if(this.fillAggregates(t,S,e.level+e.childLevels-1,a,this.rowLength),d.push(g),a[a.length-1].cells.length>0){for(var C=e.level+e.childLevels+S[0].cells.length,x=0,P=0,O=a[a.length-1].cells;P<O.length;P++){var T=O[P];T.index<C&&(C=T.index),T.index>x&&(x=T.index),d[d.length-1].index!==T.index&&d.push(T)}C-g.index>1&&(g.colSpan=C-g.index);while(x<i.columns.length+r+e.childLevels){var L={};L.index=x+1,L.style=this.getCaptionThemeStyle(this.theme),d.push(L),x++}}else{for(var j=0,B=0,I=i.columns;B<I.length;B++){var R=I[B];R.visible&&j++}g.colSpan=e.childLevels+j}if(a[a.length-1].cells=d,this.rowLength++,this.groupedColLength<8&&r>1){var k={outlineLevel:r-1,isCollapsed:!0};a[a.length-1].grouping=k}!Object(s["T"])(e.childLevels)&&e.childLevels>0?(this.processGroupedRows(t,p.items,i,p.items.level,n,o,a,l),this.processAggregates(t,p,a,void 0,r-1+e.childLevels,!0)):(n=this.processRecordRows(t,p.items,i,r-1,n,o,a,l),this.processAggregates(t,p,a,void 0,r-1,!0))}},t.prototype.processRecordRows=function(t,e,i,r,n,o,a,l){for(var u=1,c=[],p=i.columns,d=l.getGridRowModel(p,e,t,n),f=0,g=d;f<g.length;f++){var m=g[f];c=[],n++,u=1;for(var y=void 0,b=0,w=m.cells.length;b<w;b++){var v=m.cells[b];if(v.cellType===Xr["a"].Data){var S=v.column,C=S.field,x=Object(s["T"])(C)?"":S.valueAccessor(C,m.data,S),P=Object(s["T"])(x)?"":x,O=void 0;if(S.isForeignColumn&&S.isForeignColumn()&&(O=l.getFData(P,S),P=Object(s["R"])(S.foreignKeyValue,O)),!Object(s["T"])(P)){var T={},L=u+r+t.childGridLevel,j={data:m.data,column:S,foreignKeyData:O,value:P,style:void 0,colSpan:1,cell:T};if(t.trigger(h["Ub"],j),Object(s["T"])(j.image)||Object(s["T"])(j.image.base64)||(y=this.setImage(j,L),j.image.height&&""!==j.value&&(y+=30)),Object(s["T"])(j.hyperLink)||(j.cell.hyperlink={target:j.hyperLink.target},j.value=j.hyperLink.displayText||j.value),T=j.cell,T.index=L,T.value=j.value,""===j.data&&t.childGridLevel&&1===u){var B={hAlign:"left"};j={style:B},T.colSpan=t.getVisibleColumns().length,T.value=this.l10n.getConstant("EmptyRecord")}if(j.colSpan>1&&(T.colSpan=j.colSpan),Object(s["T"])(j.style))T.style={name:t.element.id+"column"+(u+r)};else{var I=this.getColumnStyle(t,u+r);T.style=this.mergeOptions(this.styles[I],j.style)}c.push(T)}u++}}var R={index:this.rowLength++,cells:c};if(Object(s["T"])(y)||(R.height=y),this.groupedColLength&&this.groupedColLength<8&&r+1>0?(R.grouping={outlineLevel:r+1,isCollapsed:!0},a.push(R)):a.push(R),m.isExpand&&!Object(s["T"])(t.childGrid)){t.isPrinting=!0;var k=!Object(s["T"])(o)&&o.exportType?o.exportType:"AllPages",F=this.helper.createChildGrid(t,m,k,this.gridPool),M=F.childGrid,A=F.element;M.actionFailure=l.failureHandler(this.gridPool,M,this.globalResolve),M.childGridLevel=t.childGridLevel+1;var E={childGrid:M,row:m,exportProperties:o};this.parent.trigger(h["Xb"],E),M.beforeDataBound=this.childGridCell(R,M,o,m),M.appendTo(A)}t.notify(h["Zb"],{rowObj:m,type:"excel",excelRows:a})}return n},t.prototype.setImage=function(t,e){Object(s["T"])(this.sheet.images)&&(this.sheet.images=[]);var i={image:t.image.base64,row:this.rowLength,column:e,lastRow:this.rowLength,lastColumn:e};return t.image.width&&t.image.height&&(i.width=t.image.width,i.height=t.image.height),this.sheet.images.push(i),this.columns[e-1].width=t.image.width||this.columns[e-1].width,t.image.height||50},t.prototype.childGridCell=function(t,e,i,r){var n=this;return function(o){e.beforeDataBound=null,o.cancel=!0,0===o.result.length&&(o.result=[""]),t.childRows=n.processGridExport(e,i,o);for(var a=n.parent.groupSettings.columns.length,h=t.childRows,l=0;l<h.length;l++)h[l].grouping={outlineLevel:a+e.childGridLevel,isCollapsed:!r.isExpand,isHidden:!r.isExpand};return e.destroy(),Object(s["F"])(e.element),n.gridPool[e.id]=!0,n.helper.checkAndExport(n.gridPool,n.globalResolve),t}},t.prototype.processAggregates=function(t,e,i,r,n,o){var a=new rn["c"](t),h=a.getColumns();h=h.filter(function(t){return Object(s["T"])(t.commands)&&"checkbox"!==t.type}),t.aggregates.length&&this.parent!==t&&t.aggregateModule.prepareSummaryInfo();var l=void 0;if(l=Object(s["T"])(r)?e:r,void 0===n&&(n=0),t.groupSettings.columns.length>0&&o){var u=new rn["b"](t),c=u.generateRows(l,{level:l.level});c.length>0&&(i=this.fillAggregates(t,c,n,i))}else{n=t.groupSettings.columns.length>0&&!o?t.groupSettings.columns.length:n;var p=a.generateRows(l,e.aggregates,null,null,h);p.length>0&&!o&&(n=t.groupSettings.columns.length?n-1:n,i=this.fillAggregates(t,p,n,i))}return i},t.prototype.fillAggregates=function(t,e,i,r,n){for(var o=0,a=e;o<a.length;o++){for(var l=a[o],u=[],c=!0,p=0,d=0,f=l.cells;d<f.length;d++){var g=f[d],m={};if(g.cellType!==Xr["a"].DetailFooterIntent&&(g.visible||this.includeHiddenColumn))if(p++,g.isDataCell){c=!1;var y=!Object(s["T"])(g.column.footerTemplate),b=!Object(s["T"])(g.column.groupFooterTemplate),w=!Object(s["T"])(g.column.groupCaptionTemplate);if(m.index=p+i+t.childGridLevel,y)m.value=this.getAggreateValue(Xr["a"].Summary,g.column.footerTemplate,g,l);else if(b)m.value=this.getAggreateValue(Xr["a"].GroupSummary,g.column.groupFooterTemplate,g,l);else if(w)m.value=this.getAggreateValue(Xr["a"].CaptionSummary,g.column.groupCaptionTemplate,g,l);else for(var v=0,S=Object.keys(l.data[g.column.field]);v<S.length;v++){var C=S[v];C===g.column.type&&(Object(s["T"])(l.data[g.column.field].Sum)?Object(s["T"])(l.data[g.column.field].Average)?Object(s["T"])(l.data[g.column.field].Max)?Object(s["T"])(l.data[g.column.field].Min)?Object(s["T"])(l.data[g.column.field].Count)?Object(s["T"])(l.data[g.column.field].TrueCount)?Object(s["T"])(l.data[g.column.field].FalseCount)?Object(s["T"])(l.data[g.column.field].Custom)||(m.value=l.data[g.column.field].Custom):m.value=l.data[g.column.field][g.column.field+" - falsecount"]:m.value=l.data[g.column.field][g.column.field+" - truecount"]:m.value=l.data[g.column.field][g.column.field+" - count"]:m.value=l.data[g.column.field][g.column.field+" - min"]:m.value=l.data[g.column.field][g.column.field+" - max"]:m.value=l.data[g.column.field][g.column.field+" - average"]:m.value=l.data[g.column.field][g.column.field+" - sum"])}m.style=this.getCaptionThemeStyle(this.theme),this.aggregateStyle(g.column,m.style,g.column.field);var x=g.attributes.style;x.textAlign&&(m.style.hAlign=x.textAlign.toLowerCase());var P={row:l,type:y?"Footer":b?"GroupFooter":"GroupCaption",style:m};this.parent.trigger(h["Rb"],P),u.push(m)}else void 0===n&&(m.index=p+i+t.childGridLevel,m.style=this.getCaptionThemeStyle(this.theme),u.push(m))}if(Object(s["T"])(n)){var O={};if(this.groupedColLength<8&&this.groupedColLength>0){var T="outlineLevel",L="grouping",j=r[r.length-1][L][T],B={outlineLevel:j,isCollapsed:!0};O={index:this.rowLength++,cells:u,grouping:B}}else O={index:this.rowLength++,cells:u};c||r.push(O)}else r.push({index:n,cells:u})}return r},t.prototype.aggregateStyle=function(t,e,i){var r=this.parent.getColumnByField(i);if("object"===typeof t.format){var n=t.format;e.numberFormat=Object(s["T"])(n.format)?n.skeleton:n.format,Object(s["T"])(n.type)||(e.type=n.type.toLowerCase())}else e.numberFormat=t.format;!Object(s["T"])(r)&&Object(s["T"])(e.type)&&(e.type=r.type.toLowerCase())},t.prototype.getAggreateValue=function(t,e,i,r){var n,o={};o[Object(s["L"])(Xr["a"],i.cellType)]=Object(s["B"])(e);var a=r.data[i.column.field?i.column.field:i.column.columnName];return this.parent.isReact||this.parent.isVue?(n=o[Object(s["L"])(Xr["a"],i.cellType)](a,this.parent),this.parent.isReact&&this.parent.renderTemplates()):n=o[Object(s["L"])(Xr["a"],i.cellType)](a),n[0].textContent},t.prototype.mergeOptions=function(t,e){for(var i={},r=Object.keys(t),n=0;n<r.length;n++)"name"!==r[n]&&(i[r[n]]=t[r[n]]);r=Object.keys(e);for(n=0;n<r.length;n++)"name"!==r[n]&&(i[r[n]]=e[r[n]]);return i},t.prototype.getColumnStyle=function(t,e){for(var i=0,r=0,n=this.styles;r<n.length;r++){var o=n[r];if(o.name===t.element.id+"column"+e)return i;i++}},t.prototype.headerRotation=function(t){var e=t.style.rotation;e<=90&&e>=0?t.style.hAlign="Left":e>90&&e<=180?t.style.hAlign="Right":(e=180,t.style.hAlign="Right"),t.style.rotation=e},t.prototype.processHeaderContent=function(t,e,i,r){var n,o=1,a=e.rows,l=e.columns,u=[];if(i>0){var c=0;while(c!==i)this.columns.push({index:c+1,width:30}),c++}for(var p=0;p<l.length;p++)this.parseStyles(t,l[p],this.getRecordThemeStyle(this.theme),i+p+1);for(var d=0;d<a.length;d++){for(var f=1+i,g=[],m=0;m<a[d].cells.length;m++){var y={},b={},w=a[d].cells[m];if(w.cellType!==Xr["a"].HeaderIndent&&w.cellType!==Xr["a"].DetailHeader){var v={contains:!0,index:1};while(v.contains)if(v=this.getIndex(u,o,f),f=v.index,!v.contains){b.index=v.index+t.childGridLevel;break}if(!Object(s["T"])(w.rowSpan)&&1!==w.rowSpan){b.rowSpan=w.rowSpan;for(var S=o;S<w.rowSpan+o;S++){var C={rowIndex:0,columnIndex:0};C.rowIndex=S,C.columnIndex=f,u.push(C)}}Object(s["T"])(w.colSpan)||1===w.colSpan||(b.colSpan=w.colSpan,f=f+b.colSpan-1),b.value=w.column.headerText,y=this.getHeaderThemeStyle(this.theme),Object(s["T"])(w.column.textAlign)||(y.hAlign=w.column.textAlign.toLowerCase()),Object(s["T"])(w.column.headerTextAlign)||(y.hAlign=w.column.headerTextAlign.toLowerCase());var x={cell:b,gridCell:w,style:y};t.trigger(h["Tb"],x),x.style.rotation&&this.headerRotation(x),Object(s["T"])(x.image)||Object(s["T"])(x.image.base64)||(n=this.setImage(x,f)),Object(s["T"])(x.hyperLink)||(x.cell.hyperlink={target:x.hyperLink.target},b.value=x.hyperLink.displayText||b.value),b.style=x.style,g.push(b),f++}}var P={index:this.rowLength++,cells:g};Object(s["T"])(n)||(P.height=n),r.push(P)}return r},t.prototype.getHeaderThemeStyle=function(t){var e={fontSize:12,borders:{color:"#E0E0E0"},bold:!0};return Object(s["T"])(t)||Object(s["T"])(t.header)||(e=this.updateThemeStyle(t.header,e)),e},t.prototype.updateThemeStyle=function(t,e){return Object(s["G"])(e,t)},t.prototype.getCaptionThemeStyle=function(t){var e={fontSize:13,backColor:"#F6F6F6"};return Object(s["T"])(t)||Object(s["T"])(t.caption)||(e=this.updateThemeStyle(t.caption,e)),e},t.prototype.getRecordThemeStyle=function(t){var e={fontSize:13,borders:{color:"#E0E0E0"}};return Object(s["T"])(t)||Object(s["T"])(t.record)||(e=this.updateThemeStyle(t.record,e)),e},t.prototype.processExcelHeader=function(t){if(!Object(s["T"])(t.rows)&&("NewSheet"===this.expType||1===this.rowLength)){var e=void 0;void 0===t.headerRows?this.rowLength=t.rows.length:this.rowLength=t.headerRows,e=this.rowLength<t.rows.length?this.rowLength:t.rows.length,this.rowLength++;for(var i=0;i<e;i++){var r=t.rows[i];(null===r.index||Object(s["T"])(r.index))&&(r.index=i+1),this.updatedCellIndex(r)}}},t.prototype.updatedCellIndex=function(t){for(var e=t.cells.length,i=0;i<e;i++){var r=t.cells[i];(null===r.index||Object(s["T"])(r.index))&&(r.index=i+1)}this.rows.push(t)},t.prototype.processExcelFooter=function(t){if(!Object(s["T"])(t.rows)){var e=void 0;void 0===t.footerRows?this.rowLength+=t.rows.length:t.footerRows>t.rows.length?(this.rowLength+=t.footerRows-t.rows.length,e=t.rows.length):e=t.footerRows;for(var i=0;i<e;i++){var r=t.rows[i];null===r.index||void 0===r.index?r.index=this.rowLength++:r.index+=this.rowLength,this.updatedCellIndex(r)}}},t.prototype.getIndex=function(t,e,i){for(var r=0,n=t;r<n.length;r++){var o=n[r];if(o.rowIndex===e&&o.columnIndex===i)return i+=1,{contains:!0,index:i}}return{contains:!1,index:i}},t.prototype.parseStyles=function(t,e,i,r){if(!Object(s["T"])(e.format))if("object"===typeof e.format){var n=e.format;i.numberFormat=Object(s["T"])(n.format)?n.skeleton:n.format,Object(s["T"])(n.type)||(i.type=n.type.toLowerCase())}else i.numberFormat=e.format,i.type=e.type;Object(s["T"])(e.textAlign)||(i.hAlign=e.textAlign.toLowerCase()),Object.keys(i).length>0&&(i.name=t.element.id+"column"+r,this.styles.push(i)),Object(s["T"])(e.width)||"auto"===e.width||this.columns.push({index:r+t.childGridLevel,width:"number"===typeof e.width?e.width:this.helper.getConvertedWidth(e.width)})},t.prototype.destroy=function(){},t}(),Gn=i("3530"),Wn={header:"."+Gn["u"],content:"."+Gn["s"],edit:".e-inline-edit",batchEdit:".e-editedbatchcell",editIcon:"e-edit",pager:".e-gridpager",delete:"e-delete",save:"e-save",cancel:"e-cancel",copy:"e-copy",pdf:"e-pdfexport",group:"e-icon-group",ungroup:"e-icon-ungroup",csv:"e-csvexport",excel:"e-excelexport",fPage:"e-icon-first",nPage:"e-icon-next",lPage:"e-icon-last",pPage:"e-icon-prev",ascending:"e-icon-ascending",descending:"e-icon-descending",groupHeader:"e-groupdroparea",touchPop:"e-gridpopup"},Hn=function(){function t(t,e){this.defaultItems={},this.disableItems=[],this.hiddenItems=[],this.localeText=this.setLocaleKey(),this.parent=t,this.gridID=t.element.id,this.serviceLocator=e,this.addEventListener()}return t.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(h["qe"],this.enableAfterRenderMenu,this),this.parent.on(h["Jc"],this.render,this),this.parent.on(h["Hb"],this.destroy,this))},t.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(h["Jc"],this.render),this.parent.off(h["qe"],this.enableAfterRenderMenu),this.parent.off(h["Hb"],this.destroy),s["l"].remove(this.element,"keydown",this.keyDownHandler.bind(this)))},t.prototype.keyDownHandler=function(t){"Tab"!==t.code&&9!==t.which||this.contextMenu.close(),"Escape"===t.code&&(this.contextMenu.close(),this.parent.notify(h["Gd"],{}))},t.prototype.render=function(){this.parent.element.classList.add("e-noselect"),this.l10n=this.serviceLocator.getService("localization"),this.element=this.parent.createElement("ul",{id:this.gridID+"_cmenu"}),s["l"].add(this.element,"keydown",this.keyDownHandler.bind(this)),this.parent.element.appendChild(this.element);var t="#"+this.gridID;this.contextMenu=new a["a"]({items:this.getMenuItems(),enableRtl:this.parent.enableRtl,enablePersistence:this.parent.enablePersistence,locale:this.parent.locale,target:t,select:this.contextMenuItemClick.bind(this),beforeOpen:this.contextMenuBeforeOpen.bind(this),onOpen:this.contextMenuOpen.bind(this),onClose:this.contextMenuOnClose.bind(this),cssClass:this.parent.cssClass?"e-grid-menu "+this.parent.cssClass:"e-grid-menu"}),this.contextMenu.appendTo(this.element)},t.prototype.enableAfterRenderMenu=function(t){t.module===this.getModuleName()&&t.enable&&(this.contextMenu&&(this.contextMenu.destroy(),Object(s["fb"])(this.element),this.parent.element.classList.remove("e-noselect")),this.render())},t.prototype.getMenuItems=function(){for(var t=[],e=[],i=0,r=this.parent.contextMenuItems;i<r.length;i++){var n=r[i];"string"===typeof n&&-1!==this.getDefaultItems().indexOf(n)?-1!==n.toLocaleLowerCase().indexOf("export")?e.push(this.buildDefaultItems(n)):t.push(this.buildDefaultItems(n)):"string"!==typeof n&&t.push(n)}if(e.length>0){var o=this.buildDefaultItems("export");o.items=e,t.push(o)}return t},t.prototype.getLastPage=function(){var t=Math.floor(this.parent.pageSettings.totalRecordsCount/this.parent.pageSettings.pageSize);return this.parent.pageSettings.totalRecordsCount%this.parent.pageSettings.pageSize&&(t+=1),t},t.prototype.contextMenuOpen=function(){this.isOpen=!0},t.prototype.contextMenuItemClick=function(t){var e=this.getKeyFromId(t.item.id);switch(e){case"AutoFitAll":this.parent.autoFitColumns([]);break;case"AutoFit":this.parent.autoFitColumns(this.targetColumn.field);break;case"Group":this.parent.groupColumn(this.targetColumn.field);break;case"Ungroup":this.parent.ungroupColumn(this.targetColumn.field);break;case"Edit":this.parent.editModule&&("Batch"===this.parent.editSettings.mode?this.row&&this.cell&&!isNaN(parseInt(this.cell.getAttribute(Gn["c"]),10))&&this.parent.editModule.editCell(parseInt(this.row.getAttribute(Gn["d"]),10),this.parent.getColumns()[parseInt(this.cell.getAttribute(Gn["c"]),10)].field):(this.parent.editModule.endEdit(),this.parent.editModule.startEdit(this.row)));break;case"Delete":this.parent.editModule&&("Batch"!==this.parent.editSettings.mode&&this.parent.editModule.endEdit(),1===this.parent.getSelectedRecords().length?this.parent.editModule.deleteRow(this.row):this.parent.deleteRecord());break;case"Save":this.parent.editModule&&this.parent.editModule.endEdit();break;case"Cancel":this.parent.editModule&&this.parent.editModule.closeEdit();break;case"Copy":this.parent.copy();break;case"PdfExport":this.parent.pdfExport();break;case"ExcelExport":this.parent.excelExport();break;case"CsvExport":this.parent.csvExport();break;case"SortAscending":this.isOpen=!1,this.parent.sortColumn(this.targetColumn.field,"Ascending");break;case"SortDescending":this.isOpen=!1,this.parent.sortColumn(this.targetColumn.field,"Descending");break;case"FirstPage":this.parent.goToPage(1);break;case"PrevPage":this.parent.goToPage(this.parent.pageSettings.currentPage-1);break;case"LastPage":this.parent.goToPage(this.getLastPage());break;case"NextPage":this.parent.goToPage(this.parent.pageSettings.currentPage+1);break}t.column=this.targetColumn,t.rowInfo=this.targetRowdata,this.parent.trigger(h["vb"],t)},t.prototype.contextMenuOnClose=function(t){var e="parentObj";t.items.length>0&&t.items[0][e]instanceof a["a"]&&this.updateItemStatus(),this.parent.notify(h["be"],{isOpen:!1})},t.prototype.getLocaleText=function(t){return this.l10n.getConstant(this.localeText[t])},t.prototype.updateItemStatus=function(){this.contextMenu.showItems(this.hiddenItems),this.contextMenu.enableItems(this.disableItems),this.hiddenItems=[],this.disableItems=[],this.isOpen=!1},t.prototype.contextMenuBeforeOpen=function(t){var e=Object(s["A"])(t.event.target,".e-grid");if(t.event&&e&&e!==this.parent.element)t.cancel=!0;else if(t.event&&(Object(s["A"])(t.event.target,"."+Wn.groupHeader)||Object(s["A"])(t.event.target,"."+Wn.touchPop)||Object(s["A"])(t.event.target,".e-summarycell")||Object(s["A"])(t.event.target,".e-groupcaption")||Object(s["A"])(t.event.target,".e-filterbarcell")))t.cancel=!0;else{this.targetColumn=this.getColumn(t.event),Object(c["hb"])(t.event.target,"e-grid")&&(this.targetRowdata=this.parent.getRowInfo(t.event.target)),Object(s["T"])(t.parentItem)&&this.targetColumn&&this.targetRowdata.cell&&(this.parent.notify(h["be"],{isOpen:!0}),this.selectRow(t.event,!this.targetRowdata.cell.classList.contains("e-selectionbackground")||"Multiple"!==this.parent.selectionSettings.type));for(var i=[],r=[],n=0,o=t.items;n<o.length;n++){var a=o[n],l=this.getKeyFromId(a.id),u=this.defaultItems[l];if(-1!==this.getDefaultItems().indexOf(l))if(this.ensureDisabledStatus(l)&&this.disableItems.push(a.text),t.event&&(this.ensureTarget(t.event.target,Wn.edit)||this.ensureTarget(t.event.target,Wn.batchEdit)))"Save"!==l&&"Cancel"!==l&&this.hiddenItems.push(a.text);else{if(this.parent.editModule&&"Batch"===this.parent.editSettings.mode&&(Object(s["A"])(t.event.target,".e-gridform")||this.parent.editModule.getBatchChanges()[Gn["g"]].length||this.parent.editModule.getBatchChanges()[Gn["a"]].length||this.parent.editModule.getBatchChanges()[Gn["k"]].length)&&("Save"===l||"Cancel"===l))continue;Object(s["T"])(t.parentItem)&&t.event&&!this.ensureTarget(t.event.target,u.target)&&this.hiddenItems.push(a.text)}else a.target&&t.event&&!this.ensureTarget(t.event.target,a.target)?a.separator?i.push(a.id):this.hiddenItems.push(a.text):this.ensureTarget(t.event.target,a.target)&&a.separator&&r.push(a.id)}r.length>0&&this.contextMenu.showItems(r,!0),this.contextMenu.enableItems(this.disableItems,!1),this.contextMenu.hideItems(this.hiddenItems),i.length>0&&this.contextMenu.hideItems(i,!0),this.eventArgs=t.event,t.column=this.targetColumn,t.rowInfo=this.targetRowdata,this.parent.trigger(h["wb"],t),(t.cancel||this.hiddenItems.length===t.items.length&&!t.parentItem)&&(this.updateItemStatus(),t.cancel=!0)}Object(c["g"])(this.parent.element,this.contextMenu.element.parentElement)},t.prototype.ensureTarget=function(t,e){var i=t;return i=!this.ensureFrozenHeader(t)||e!==Wn.header&&e!==Wn.content?e===Wn.content||e===Wn.header?Object(c["hb"])(Object(s["A"])(t,"."+Gn["C"]),e.substr(1,e.length)):Object(s["A"])(t,e):Object(s["A"])(t,e===Wn.header?"thead":Gn["D"]),i&&Object(c["hb"])(i,"e-grid")===this.parent.element},t.prototype.ensureFrozenHeader=function(t){return!(!this.parent.isFrozenGrid()&&!this.parent.frozenRows||!Object(s["A"])(t,Wn.header))},t.prototype.ensureDisabledStatus=function(t){var e=!1;switch(t){case"AutoFitAll":case"AutoFit":e=!(this.parent.ensureModuleInjected(l["a"])&&!this.parent.isEdit)||this.targetColumn&&!this.targetColumn.field&&"AutoFit"===t;break;case"Group":(!this.parent.allowGrouping||this.parent.ensureModuleInjected(p["a"])&&this.targetColumn&&this.parent.groupSettings.columns.indexOf(this.targetColumn.field)>=0||this.targetColumn&&!this.targetColumn.field)&&(e=!0);break;case"Ungroup":(!this.parent.allowGrouping||!this.parent.ensureModuleInjected(p["a"])||this.parent.ensureModuleInjected(p["a"])&&this.targetColumn&&this.parent.groupSettings.columns.indexOf(this.targetColumn.field)<0)&&(e=!0);break;case"Edit":case"Delete":case"Save":case"Cancel":this.parent.editModule&&0!==this.parent.getDataRows().length||(e=!0);break;case"Copy":(0===this.parent.getSelectedRowIndexes().length&&0===this.parent.getSelectedRowCellIndexes().length||0===this.parent.getCurrentViewRecords().length)&&(e=!0);break;case"export":this.parent.allowExcelExport&&this.parent.excelExport&&(this.parent.ensureModuleInjected(nn)||this.parent.ensureModuleInjected(zn))||(e=!0);break;case"PdfExport":this.parent.allowPdfExport&&this.parent.ensureModuleInjected(nn)||(e=!0);break;case"ExcelExport":case"CsvExport":this.parent.allowExcelExport&&this.parent.ensureModuleInjected(zn)||(e=!0);break;case"SortAscending":case"SortDescending":if(!this.parent.allowSorting||!this.parent.ensureModuleInjected(d["a"])||this.targetColumn&&!this.targetColumn.field)e=!0;else if(this.parent.ensureModuleInjected(d["a"])&&this.parent.sortSettings.columns.length>0&&this.targetColumn)for(var i=this.parent.sortSettings.columns,r=0;r<i.length;r++)i[r].field===this.targetColumn.field&&i[r].direction.toLowerCase()===t.toLowerCase().replace("sort","").toLocaleLowerCase()&&(e=!0);break;case"FirstPage":case"PrevPage":(!this.parent.allowPaging||!this.parent.ensureModuleInjected(u["a"])||0===this.parent.getCurrentViewRecords().length||this.parent.ensureModuleInjected(u["a"])&&1===this.parent.pageSettings.currentPage)&&(e=!0);break;case"LastPage":case"NextPage":(!this.parent.allowPaging||!this.parent.ensureModuleInjected(u["a"])||0===this.parent.getCurrentViewRecords().length||this.parent.ensureModuleInjected(u["a"])&&this.parent.pageSettings.currentPage===this.getLastPage())&&(e=!0);break}return e},t.prototype.getContextMenu=function(){return this.element},t.prototype.destroy=function(){var t=this.parent.element;t&&(t.querySelector("."+Gn["u"])||t.querySelector("."+Gn["s"]))&&(this.contextMenu.destroy(),this.element.parentNode&&Object(s["fb"])(this.element),this.removeEventListener(),this.parent.element.classList.remove("e-noselect"))},t.prototype.getModuleName=function(){return"contextMenu"},t.prototype.generateID=function(t){return this.gridID+"_cmenu_"+t},t.prototype.getKeyFromId=function(t){return t.replace(this.gridID+"_cmenu_","")},t.prototype.buildDefaultItems=function(t){var e;switch(t){case"AutoFitAll":case"AutoFit":e={target:Wn.header};break;case"Group":e={target:Wn.header,iconCss:Wn.group};break;case"Ungroup":e={target:Wn.header,iconCss:Wn.ungroup};break;case"Edit":e={target:Wn.content,iconCss:Wn.editIcon};break;case"Delete":e={target:Wn.content,iconCss:Wn.delete};break;case"Save":e={target:Wn.edit,iconCss:Wn.save};break;case"Cancel":e={target:Wn.edit,iconCss:Wn.cancel};break;case"Copy":e={target:Wn.content,iconCss:Wn.copy};break;case"export":e={target:Wn.content};break;case"PdfExport":e={target:Wn.content,iconCss:Wn.pdf};break;case"ExcelExport":e={target:Wn.content,iconCss:Wn.excel};break;case"CsvExport":e={target:Wn.content,iconCss:Wn.csv};break;case"SortAscending":e={target:Wn.header,iconCss:Wn.ascending};break;case"SortDescending":e={target:Wn.header,iconCss:Wn.descending};break;case"FirstPage":e={target:Wn.pager,iconCss:Wn.fPage};break;case"PrevPage":e={target:Wn.pager,iconCss:Wn.pPage};break;case"LastPage":e={target:Wn.pager,iconCss:Wn.lPage};break;case"NextPage":e={target:Wn.pager,iconCss:Wn.nPage};break}return this.defaultItems[t]={text:this.getLocaleText(t),id:this.generateID(t),target:e.target,iconCss:e.iconCss?"e-icons "+e.iconCss:""},this.defaultItems[t]},t.prototype.getDefaultItems=function(){return["AutoFitAll","AutoFit","Group","Ungroup","Edit","Delete","Save","Cancel","Copy","export","PdfExport","ExcelExport","CsvExport","SortAscending","SortDescending","FirstPage","PrevPage","LastPage","NextPage"]},t.prototype.setLocaleKey=function(){var t={AutoFitAll:"autoFitAll",AutoFit:"autoFit",Copy:"Copy",Group:"Group",Ungroup:"Ungroup",Edit:"EditRecord",Delete:"DeleteRecord",Save:"Save",Cancel:"CancelButton",PdfExport:"Pdfexport",ExcelExport:"Excelexport",CsvExport:"Csvexport",export:"Export",SortAscending:"SortAscending",SortDescending:"SortDescending",FirstPage:"FirstPage",LastPage:"LastPage",PrevPage:"PreviousPage",NextPage:"NextPage"};return t},t.prototype.getColumn=function(t){var e=Object(s["A"])(t.target,"th.e-headercell");if(e){var i=e.querySelector(".e-headercelldiv, .e-stackedheadercelldiv").getAttribute("e-mappinguid");return this.parent.getColumnByUid(i)}var r=this.parent.getRowInfo(t.target).column;return r||null},t.prototype.selectRow=function(t,e){this.cell=t.target,this.row=Object(s["A"])(t.target,"tr.e-row")||this.row,this.row&&e&&!Object(c["hb"])(t.target,"e-gridpager")&&this.parent.selectRow(parseInt(this.row.getAttribute(Gn["d"]),10))},t}(),_n=function(){function t(t){o["a"].Inject(Hn),this.parent=t,this.addEventListener()}return t.prototype.addEventListener=function(){this.parent.on("contextMenuOpen",this.contextMenuOpen,this),this.parent.on("contextMenuClick",this.contextMenuClick,this)},t.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off("contextMenuOpen",this.contextMenuOpen),this.parent.off("contextMenuClick",this.contextMenuClick))},t.prototype.contextMenuOpen=function(t){var e=Object(s["jb"])("#"+this.parent.element.id+"_gridcontrol_cmenu_AddRow",t.element),i=Object(s["jb"])("#"+this.parent.element.id+"_gridcontrol_cmenu_Edit",t.element),r=Object(s["jb"])("#"+this.parent.element.id+"_gridcontrol_cmenu_Indent",t.element),n=Object(s["jb"])("#"+this.parent.element.id+"_gridcontrol_cmenu_Outdent",t.element);if(e&&(!1===this.parent.grid.editSettings.allowAdding?e.style.display="none":e.style.display="block"),"Cell"!==this.parent.editSettings.mode&&"Batch"!==this.parent.editSettings.mode||Object(s["T"])(i)||i.classList.contains("e-menu-hide")||(i.style.display="none"),r||n){var o=this.parent,a=o.getSelectedRows()[0],h=t.event.target.closest("td");if(Object(s["T"])(h)||!Object(s["T"])(h)&&!h.classList.contains("e-rowcell"))r.style.display=n.style.display="none";else{if(0===a.rowIndex||o.getSelectedRowIndexes().length>1)r.style.display=n.style.display="none";else if("rowDeselected"!==t["name"]||!Object(s["T"])(a)&&o.grid.isCheckBoxSelection){var l=o.getCurrentViewRecords()[a.rowIndex];Object(s["T"])(l)||(l.level>o.getCurrentViewRecords()[a.rowIndex-1].level?r.style.display="none":r.style.display="block",l.level===o.getCurrentViewRecords()[a.rowIndex-1].level&&(r.style.display="block"),0===l.level&&(n.style.display="none"),0!==l.level&&(n.style.display="block"))}"rowDeselected"===t["name"]&&Object(s["T"])(a)&&!o.grid.isCheckBoxSelection&&(this.parent.toolbar["includes"]("Indent")&&(r.style.display="none"),this.parent.toolbar["includes"]("Outdent")&&(n.style.display="none"))}}},t.prototype.contextMenuClick=function(t){if("Above"!==t.item.id&&"Below"!==t.item.id&&"Child"!==t.item.id||(this.parent.notify("savePreviousRowPosition",t),this.parent.setProperties({editSettings:{newRowPosition:t.item.id}},!0),this.parent.addRecord()),(t.item.id===this.parent.element.id+"_gridcontrol_cmenu_Indent"||t.item.id===this.parent.element.id+"_gridcontrol_cmenu_Outdent")&&!Object(s["T"])(this.parent.rowDragAndDropModule)){var e="indentOutdentAction",i=t.item.id===this.parent.element.id+"_gridcontrol_cmenu_Indent"?"indent":"outdent";this.parent.rowDragAndDropModule[e](null,i)}},t.prototype.getModuleName=function(){return"contextMenu"},t.prototype.destroy=function(){this.removeEventListener()},t.prototype.getContextMenu=function(){return this.parent.grid.contextMenuModule.getContextMenu()},t}();i.d(e,"a",function(){return Un});var Un=function(){function t(t){var e=this;this.segmentIndex=-1,this.headerContextMenuClick=function(t){var i=Object(s["A"])(t.event.target,".e-row"),r=Object(s["A"])(t.event.target,".e-chart-row");Object(s["T"])(i)&&Object(s["T"])(r)&&(t.type="Header",e.parent.trigger("contextMenuClick",t))},this.headerContextMenuOpen=function(t){var i=Object(s["A"])(t.event.target,".e-row"),r=Object(s["A"])(t.event.target,".e-chart-row");Object(s["T"])(i)&&Object(s["T"])(r)?(t.type="Header",e.parent.trigger("contextMenuOpen",t)):t.cancel=!0},this.parent=t,this.ganttID=t.element.id,n["a"].Inject(_n),this.parent.treeGrid.contextMenuClick=this.headerContextMenuClick.bind(this),this.parent.treeGrid.contextMenuOpen=this.headerContextMenuOpen.bind(this),this.addEventListener(),this.resetItems()}return t.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on("initiate-contextMenu",this.render,this),this.parent.on("reRender-contextMenu",this.reRenderContextMenu,this),this.parent.on("contextMenuClick",this.contextMenuItemClick,this),this.parent.on("contextMenuOpen",this.contextMenuBeforeOpen,this))},t.prototype.reRenderContextMenu=function(t){t.module===this.getModuleName()&&t.enable&&(this.contextMenu&&(this.contextMenu.destroy(),Object(s["fb"])(this.element)),this.resetItems(),this.render())},t.prototype.render=function(){this.element=this.parent.createElement("ul",{id:this.ganttID+"_contextmenu",className:r["W"]}),this.parent.element.appendChild(this.element);var t="#"+this.ganttID;this.contextMenu=new a["a"]({items:this.getMenuItems(),locale:this.parent.locale,target:t,animationSettings:{effect:"None"},select:this.contextMenuItemClick.bind(this),beforeOpen:this.contextMenuBeforeOpen.bind(this),onOpen:this.contextMenuOpen.bind(this),onClose:this.contextMenuOnClose.bind(this),cssClass:"e-gantt"}),this.contextMenu.appendTo(this.element),this.parent.treeGrid.contextMenuItems=this.headerMenuItems},t.prototype.contextMenuItemClick=function(t){var e,i,r;this.item=this.getKeyFromId(t.item.id);var n=Object(s["R"])("parentObj",t.item),o=-1;switch(n&&!Object(s["T"])(n.id)&&"DeleteDependency"===this.getKeyFromId(n.id)&&(o=n.items.indexOf(t.item)),this.parent.isAdaptive&&("TaskInformation"!==this.item&&"Above"!==this.item&&"Below"!==this.item&&"Child"!==this.item&&"DeleteTask"!==this.item||this.parent.selectionModule&&"Multiple"===this.parent.selectionSettings.type&&(this.parent.selectionModule.hidePopUp(),document.getElementsByClassName("e-gridpopup")[0].style.display="none")),this.item){case"TaskInformation":this.parent.openEditDialog(Number(this.rowData.ganttProperties.rowUniqueID));break;case"Above":case"Below":case"Child":if(e=this.item,i=Object(s["G"])({},{},this.rowData.taskData,!0),r=this.parent.taskFields,i[r.startDate]&&this.parent.setRecordValue(r.startDate,this.rowData.ganttProperties.startDate,i,!0),i[r.endDate]&&this.parent.setRecordValue(r.endDate,this.rowData.ganttProperties.endDate,i,!0),Object(s["T"])(r.dependency)||(i[r.dependency]=null),!Object(s["T"])(r.child)&&i[r.child]&&delete i[r.child],!Object(s["T"])(r.parentID)&&i[r.parentID]&&(i[r.parentID]=null),this.rowData){var a=this.parent.updatedRecords.indexOf(this.rowData);this.parent.addRecord(i,e,a)}break;case"Milestone":case"ToMilestone":this.parent.convertToMilestone(this.rowData.ganttProperties.rowUniqueID);break;case"DeleteTask":this.parent.editModule.deleteRecord(this.rowData);break;case"ToTask":if(i=Object(s["G"])({},{},this.rowData.taskData,!0),r=this.parent.taskFields,Object(s["T"])(r.duration)){i[r.startDate]=new Date(this.rowData.taskData[r.startDate]);var h=new Date(this.rowData.taskData[r.startDate]);h.setDate(h.getDate()+1),i[r.endDate]=h}else{var l=this.rowData.ganttProperties;i[r.duration]="1 "+l.durationUnit}Object(s["T"])(i[r.milestone])||!0===i[r.milestone]&&(i[r.milestone]=!1),this.parent.updateRecordByID(i);break;case"Cancel":this.parent.cancelEdit();break;case"Save":this.parent.editModule.cellEditModule.isCellEdit=!1,this.parent.treeGrid.grid.saveCell();break;case"Dependency"+o:this.parent.connectorLineEditModule.removePredecessorByIndex(this.rowData,o);break;case"Auto":case"Manual":this.parent.changeTaskMode(this.rowData);break;case"Indent":this.parent.indent();break;case"Outdent":this.parent.outdent();break;case"Left":case"Right":this.mergeCall(this.item);break;case"SplitTask":this.splitTaskCall(t);break}t.type="Content",t.rowData=this.rowData,this.parent.trigger("contextMenuClick",t)},t.prototype.splitTaskCall=function(t){var e=this;this.isEdit=!0;var i=this.parent.taskFields,r=this.getClickedDate(t.element);Object(s["T"])(this.parent.timelineSettings.bottomTier)&&"Hour"!==this.parent.timelineSettings.bottomTier.unit&&r.setHours(0,0,0,0);var n={rowData:this.rowData,requestType:"splitTaskbar",splitDate:r,cancel:!1,target:this.targetElement};this.parent.trigger("actionBegin",n,function(t){e.parent.chartRowsModule.splitTask(e.rowData[i.id],r)})},t.prototype.mergeCall=function(t){var e=this;this.isEdit=!0;var i=this.parent.taskFields,r=this.rowData.ganttProperties.segments,n="Right"===t?this.segmentIndex:r[this.segmentIndex-1].segmentIndex,o="Left"===t?this.segmentIndex:r[this.segmentIndex+1].segmentIndex,s=[{firstSegmentIndex:n,secondSegmentIndex:o}],a={rowData:this.rowData,mergeSegmentIndexes:s,requestType:"mergeSegment",cancel:!1,target:this.targetElement};this.parent.trigger("actionBegin",a,function(t){!1===t.cancel&&e.parent.chartRowsModule.mergeTask(e.rowData[i.id],s)})},t.prototype.getClickedDate=function(t){var e=this.parent.getOffsetRect(this.parent.element),i=e.left+this.parent.ganttChartModule.chartElement.offsetLeft+this.rowData.ganttProperties.left-this.parent.ganttChartModule.scrollElement.scrollLeft,r=this.clickedPosition-i,n=Math.ceil(r/this.parent.perDayWidth),o=this.rowData.ganttProperties.startDate;Object(s["T"])(this.parent.timelineSettings.bottomTier)||"Hour"!==this.parent.timelineSettings.bottomTier.unit||(n=Math.ceil(r/this.parent.timelineSettings.timelineUnitSize),n-=1);var a=this.parent.dataOperation.getEndDate(o,n,this.rowData.ganttProperties.durationUnit,this.rowData,!1);return a},t.prototype.contextMenuBeforeOpen=function(t){var e=this,i=t.event?t.event.target:this.parent.focusModule?this.parent.ganttChartModule.targetElement:this.parent.focusModule.getActiveElement();!Object(s["T"])(this.parent.editModule)&&this.parent.editModule.cellEditModule&&this.parent.editModule.cellEditModule.isCellEdit&&i.parentElement.classList.contains("e-row")&&this.parent.treeGrid.closeEdit(),Object(s["T"])(t.element)||t.element.id!==this.parent.element.id+"_contextmenu"||(this.clickedPosition=Object(s["R"])("event",t).clientX);var n=Object(s["A"])(i,".e-gantt-child-taskbar");n&&(this.targetElement=t.target=n),t.gridRow=Object(s["A"])(i,".e-row"),t.chartRow=Object(s["A"])(i,".e-chart-row");var o=Object(s["A"])(i,".e-gantt"),a=Object(s["A"])(i,r["Q"]);if(!a&&this.parent.editModule&&this.parent.editModule.cellEditModule&&this.parent.editModule.cellEditModule.isCellEdit&&this.parent.editModule.dialogModule.dialogObj&&!this.parent.editModule.dialogModule.dialogObj.open&&(this.parent.treeGrid.grid.saveCell(),this.parent.editModule.cellEditModule.isCellEdit=!1),this.parent.readOnly&&this.contextMenu.enableItems(["Add","Save","Convert","Delete Dependency","Delete Task","TaskMode","Indent","Outdent","SplitTask","MergeTask"],!1),(Object(s["T"])(t.gridRow)&&Object(s["T"])(t.chartRow)||0===this.contentMenuItems.length)&&(Object(s["T"])(t.parentItem)||Object(s["T"])(o)?t.cancel=!0:t.cancel=!1),!t.cancel){var h=-1;t.gridRow?h=parseInt(t.gridRow.getAttribute("aria-rowindex"),0):t.chartRow&&(h=parseInt(t.chartRow.getAttribute("aria-rowindex"),0)),this.parent.selectionModule&&this.parent.allowSelection&&!t.parentItem&&!Object(s["T"])(t.chartRow)&&this.parent.selectionModule.selectRow(h),t.parentItem||(this.rowData=this.parent.updatedRecords[h]);for(var l=0,u=t.items;l<u.length;l++){var c=u[l];c.separator||(!i.classList.contains("e-gantt-unscheduled-taskbar")||c.text!==this.getLocale("splitTask")&&c.text!==this.getLocale("mergeTask")?this.updateItemStatus(c,i,h):this.hideItems.push(c.text))}if(t.rowData=this.rowData,t.type="Content",t.disableItems=this.disableItems,t.hideItems=this.hideItems,t.hideChildItems=[],0===t.rowData.level&&"ResourceView"===this.parent.viewType)return void(t.cancel=!0);var p=new Qr["b"];return this.parent.trigger("contextMenuOpen",t,function(i){p.resolve(i),e.hideItems=i.hideItems,e.disableItems=i.disableItems,i.parentItem||i.hideItems.length!==i.items.length||(e.revertItemStatus(),i.cancel=!0),e.hideItems.length>0&&e.contextMenu.hideItems(e.hideItems),e.disableItems.length>0&&e.contextMenu.enableItems(e.disableItems,!1),t.hideChildItems.length>0&&e.contextMenu.hideItems(t.hideChildItems)}),p}},t.prototype.updateItemStatus=function(t,e,i){var n=this.getKeyFromId(t.id),o=Object(s["A"])(e,r["Q"]),a=[],h=Object(s["A"])(e,".e-gantt-child-taskbar");if(o)"Save"!==n&&"Cancel"!==n&&this.hideItems.push(t.text);else switch(n){case"TaskInformation":this.parent.editSettings.allowEditing&&this.parent.editModule||this.updateItemVisibility(t.text);break;case"Add":this.parent.editSettings.allowAdding&&this.parent.editModule||this.updateItemVisibility(t.text);break;case"Save":case"Cancel":this.hideItems.push(t.text);break;case"Convert":this.rowData.hasChildRecords?this.hideItems.push(t.text):this.parent.editSettings.allowEditing&&this.parent.editModule?(this.rowData.ganttProperties.isMilestone?a.push(this.createItemModel(r["K"],"ToTask",this.getLocale("toTask"))):a.push(this.createItemModel(r["K"],"ToMilestone",this.getLocale("toMilestone"))),t.items=a):this.updateItemVisibility(t.text);break;case"DeleteDependency":var l=this.getPredecessorsItems();this.rowData.hasChildRecords?this.hideItems.push(t.text):this.parent.editSettings.allowDeleting&&0!==l.length&&this.parent.editModule?l.length>0&&(t.items=l):this.updateItemVisibility(t.text);break;case"DeleteTask":this.parent.editSettings.allowDeleting&&this.parent.editModule||this.updateItemVisibility(t.text);break;case"TaskMode":"Custom"!==this.parent.taskMode?this.updateItemVisibility(t.text):(this.rowData.ganttProperties.isAutoSchedule?a.push(this.createItemModel(r["K"],"Manual",this.getLocale("manual"))):a.push(this.createItemModel(r["K"],"Auto",this.getLocale("auto"))),t.items=a);break;case"Indent":if(this.parent.allowSelection&&this.parent.editModule&&this.parent.editSettings){var u=this.parent.selectedRowIndex,c=!!this.parent.selectionModule&&(1===this.parent.selectionModule.selectedRowIndexes.length||1===this.parent.selectionModule.getSelectedRowCellIndexes().length),p=this.parent.updatedRecords[this.parent.selectionModule.getSelectedRowIndexes()[0]-1];this.parent.editSettings.allowEditing&&0!==u&&-1!==u&&c&&"ResourceView"!==this.parent.viewType&&this.parent.updatedRecords[u].level-p.level!==1||this.updateItemVisibility(t.text)}else this.hideItems.push(t.text);break;case"Outdent":if(this.parent.allowSelection&&this.parent.editModule&&this.parent.editSettings){var d=this.parent.selectionModule.getSelectedRowIndexes()[0],f=!!this.parent.selectionModule&&(1===this.parent.selectionModule.selectedRowIndexes.length||1===this.parent.selectionModule.getSelectedRowCellIndexes().length);this.parent.editSettings.allowEditing&&-1!==d&&0!==d&&f&&"ResourceView"!==this.parent.viewType&&0!==this.parent.updatedRecords[d].level||this.updateItemVisibility(t.text)}else this.hideItems.push(t.text);break;case"SplitTask":var g=this.parent.taskFields;(this.parent.readOnly||!h||Object(s["T"])(g.segments)||this.parent.currentViewData[i].hasChildRecords)&&this.updateItemVisibility(t.text);break;case"MergeTask":this.parent.readOnly||!h?this.updateItemVisibility(t.text):this.mergeItemVisiblity(e,t);break}},t.prototype.mergeItemVisiblity=function(t,e){var i=[],n=this.parent.taskFields,o=this.getClickedDate(t);this.segmentIndex=this.parent.chartRowsModule.getSegmentIndex(o,this.rowData);var a=this.rowData.ganttProperties.segments;!Object(s["T"])(a)&&a.length>0?Object(s["T"])(n.segments)&&-1===this.segmentIndex?this.updateItemVisibility(e.text):(0===this.segmentIndex?i.push(this.createItemModel(r["K"],"Right",this.getLocale("right"))):this.segmentIndex===a.length-1?i.push(this.createItemModel(r["K"],"Left",this.getLocale("left"))):(i.push(this.createItemModel(r["K"],"Right",this.getLocale("right"))),i.push(this.createItemModel(r["K"],"Left",this.getLocale("left")))),e.items=i):this.hideItems.push(e.text)},t.prototype.updateItemVisibility=function(t){var e=!!Object(s["T"])(this.parent.contextMenuItems);e?this.hideItems.push(t):this.disableItems.push(t)},t.prototype.contextMenuOpen=function(t){this.isOpen=!0;var e=t.element.querySelectorAll("li:not(.e-menu-hide):not(.e-disabled)")[0];Object(s["u"])([e],"e-focused")},t.prototype.getMenuItems=function(){for(var t=Object(s["T"])(this.parent.contextMenuItems)?this.getDefaultItems():this.parent.contextMenuItems,e=0,i=t;e<i.length;e++){var n=i[e];"string"===typeof n&&-1!==this.getDefaultItems().indexOf(n)?this.buildDefaultItems(n):"string"!==typeof n&&(-1!==this.getDefaultItems().indexOf(n.text)?this.buildDefaultItems(n.text,n.iconCss):n.target===r["v"]?this.headerMenuItems.push(n):this.contentMenuItems.push(n))}return this.contentMenuItems},t.prototype.createItemModel=function(t,e,i,r){var n={text:i,id:this.generateID(e),target:t,iconCss:r?"e-icons "+r:null};return n},t.prototype.getLocale=function(t){var e=this.parent.localeObj.getConstant(t);return e},t.prototype.buildDefaultItems=function(t,e){var i;switch(t){case"AutoFitAll":case"AutoFit":case"SortAscending":case"SortDescending":this.headerMenuItems.push(t);break;case"TaskInformation":i=this.createItemModel(r["K"],t,this.getLocale("taskInformation"),this.getIconCSS(r["R"],e));break;case"Indent":i=this.createItemModel(r["K"],t,this.getLocale("indent"),this.getIconCSS(r["eb"],e));break;case"Outdent":i=this.createItemModel(r["K"],t,this.getLocale("outdent"),this.getIconCSS(r["xb"],e));break;case"Save":i=this.createItemModel(r["R"],t,this.getLocale("save"),this.getIconCSS(r["Rb"],e));break;case"Cancel":i=this.createItemModel(r["R"],t,this.getLocale("cancel"),this.getIconCSS(r["m"],e));break;case"Add":i=this.createItemModel(r["K"],t,this.getLocale("add"),this.getIconCSS(r["g"],e)),i.items=[],i.items.push(this.createItemModel(r["K"],"Above",this.getLocale("above"),this.getIconCSS(r["e"],e))),i.items.push(this.createItemModel(r["K"],"Below",this.getLocale("below"),this.getIconCSS(r["f"],e))),"ResourceView"!==this.parent.viewType&&i.items.push(this.createItemModel(r["K"],"Child",this.getLocale("child"))),i.items.push(this.createItemModel(r["K"],"Milestone",this.getLocale("milestone")));break;case"DeleteTask":i=this.createItemModel(r["K"],t,this.getLocale("deleteTask"),this.getIconCSS(r["O"],e));break;case"DeleteDependency":i=this.createItemModel(r["K"],t,this.getLocale("deleteDependency")),i.items=[],i.items.push({});break;case"Convert":i=this.createItemModel(r["K"],t,this.getLocale("convert")),i.items=[],i.items.push({});break;case"TaskMode":i=this.createItemModel(r["K"],t,this.getLocale("changeScheduleMode")),i.items=[],i.items.push({});break;case"SplitTask":i=this.createItemModel(r["K"],t,this.getLocale("splitTask"));break;case"MergeTask":i=this.createItemModel(r["K"],t,this.getLocale("mergeTask")),i.items=[],i.items.push({})}i&&this.contentMenuItems.push(i)},t.prototype.getIconCSS=function(t,e){return Object(s["T"])(e)?t:e},t.prototype.getPredecessorsItems=function(){this.predecessors=this.parent.predecessorModule.getValidPredecessor(this.rowData);for(var t,e=[],i=0,n=0,o=this.predecessors;n<o.length;n++){var s=o[n],a=this.parent.getRecordByID(s.from),h=a.ganttProperties,l=h.rowUniqueID+" - "+h.taskName,u="Dependency"+i++;t=this.createItemModel(r["K"],u,l),e.push(t)}return e},t.prototype.getDefaultItems=function(){return["AutoFitAll","AutoFit","TaskInformation","DeleteTask","Save","Cancel","SortAscending","SortDescending","Add","DeleteDependency","Convert","TaskMode","Indent","Outdent","SplitTask","MergeTask"]},t.prototype.getModuleName=function(){return"contextMenu"},t.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off("initiate-contextMenu",this.render),this.parent.off("reRender-contextMenu",this.reRenderContextMenu),this.parent.off("contextMenuClick",this.contextMenuItemClick),this.parent.off("contextMenuOpen",this.contextMenuOpen))},t.prototype.contextMenuOnClose=function(t){var e="parentObj";t.items.length>0&&t.items[0][e]instanceof a["a"]&&this.revertItemStatus()},t.prototype.revertItemStatus=function(){this.contextMenu.showItems(this.hideItems),this.contextMenu.enableItems(this.disableItems),this.hideItems=[],this.disableItems=[],this.isOpen=!1},t.prototype.resetItems=function(){this.hideItems=[],this.disableItems=[],this.headerMenuItems=[],this.contentMenuItems=[],this.item=null},t.prototype.generateID=function(t){return this.ganttID+"_contextMenu_"+t},t.prototype.getKeyFromId=function(t){var e=this.ganttID+"_contextMenu_";return t.indexOf(e)>-1?t.replace(e,""):"Custom"},t.prototype.destroy=function(){this.contextMenu.destroy(),Object(s["fb"])(this.element),this.removeEventListener(),this.contextMenu=null,this.element=null},t}()},af93:function(t,e,i){"use strict";var r=i("7de8"),n=function(){function t(t){this.pagerModule=t}return t.prototype.render=function(){this.pagerElement=this.pagerModule.element,this.renderNumericContainer(),this.refreshNumericLinks(),this.wireEvents()},t.prototype.refresh=function(){this.pagerModule.updateTotalPages(),this.links.length&&this.updateLinksHtml(),this.refreshAriaAttrLabel(),this.updateStyles()},t.prototype.refreshNumericLinks=function(){var t,e=this.pagerModule,i=e.element.querySelector(".e-numericcontainer"),n=document.createDocumentFragment();i.innerHTML="";for(var o=1;o<=e.pageCount;o++)t=Object(r["C"])("a",{className:"e-link e-numericitem e-spacing e-pager-default",attrs:{role:"link",tabindex:"-1","aria-label":"Page "+o+" of "+e.totalPages+" Pages",href:"javascript:void(0);",name:"Goto page"+o}}),e.currentPage===o&&(Object(r["y"])(t,["e-currentitem","e-active"],["e-pager-default"]),t.setAttribute("aria-selected","true")),n.appendChild(t);i.appendChild(n),this.links=[].slice.call(i.childNodes)},t.prototype.wireEvents=function(){r["l"].add(this.pagerElement,"click",this.clickHandler,this)},t.prototype.unwireEvents=function(){r["l"].remove(this.pagerModule.element,"click",this.clickHandler)},t.prototype.destroy=function(){this.unwireEvents()},t.prototype.refreshAriaAttrLabel=function(){for(var t=this.pagerModule,e=t.element.querySelector(".e-numericcontainer"),i=e.querySelectorAll("a"),r=0;r<i.length;r++)i[r].hasAttribute("aria-label")&&i[r].hasAttribute("index")&&i[r].setAttribute("aria-label","Page "+i[r].getAttribute("index")+" of "+t.totalPages+" Pages")},t.prototype.renderNumericContainer=function(){this.element=Object(r["C"])("div",{className:"e-pagercontainer",attrs:{role:"navigation"}}),this.renderFirstNPrev(this.element),this.renderPrevPagerSet(this.element),this.element.appendChild(Object(r["C"])("div",{className:"e-numericcontainer"})),this.renderNextPagerSet(this.element),this.renderNextNLast(this.element),this.pagerModule.element.appendChild(this.element)},t.prototype.renderFirstNPrev=function(t){this.first=Object(r["C"])("div",{className:"e-first e-icons e-icon-first",attrs:{title:this.pagerModule.getLocalizedLabel("firstPageTooltip"),"aria-label":this.pagerModule.getLocalizedLabel("firstPageTooltip"),tabindex:"-1"}}),this.prev=Object(r["C"])("div",{className:"e-prev e-icons e-icon-prev",attrs:{title:this.pagerModule.getLocalizedLabel("previousPageTooltip"),"aria-label":this.pagerModule.getLocalizedLabel("previousPageTooltip"),tabindex:"-1"}}),Object(r["v"])([this.first,this.prev],t)},t.prototype.renderPrevPagerSet=function(t){var e=Object(r["C"])("div");this.PP=Object(r["C"])("a",{className:"e-link e-pp e-spacing",innerHTML:"...",attrs:{title:this.pagerModule.getLocalizedLabel("previousPagerTooltip"),role:"link","aria-label":this.pagerModule.getLocalizedLabel("previousPagerTooltip"),tabindex:"-1",name:this.pagerModule.getLocalizedLabel("previousPagerTooltip"),href:"javascript:void(0);"}}),e.appendChild(this.PP),t.appendChild(e)},t.prototype.renderNextPagerSet=function(t){var e=Object(r["C"])("div");this.NP=Object(r["C"])("a",{className:"e-link e-np e-spacing",innerHTML:"...",attrs:{title:this.pagerModule.getLocalizedLabel("nextPagerTooltip"),role:"link","aria-label":this.pagerModule.getLocalizedLabel("nextPagerTooltip"),tabindex:"-1",name:this.pagerModule.getLocalizedLabel("nextPagerTooltip"),href:"javascript:void(0);"}}),e.appendChild(this.NP),t.appendChild(e)},t.prototype.renderNextNLast=function(t){this.next=Object(r["C"])("div",{className:"e-next e-icons e-icon-next",attrs:{title:this.pagerModule.getLocalizedLabel("nextPageTooltip"),"aria-label":this.pagerModule.getLocalizedLabel("nextPageTooltip"),tabindex:"-1"}}),this.last=Object(r["C"])("div",{className:"e-last e-icons e-icon-last",attrs:{title:this.pagerModule.getLocalizedLabel("lastPageTooltip"),"aria-label":this.pagerModule.getLocalizedLabel("lastPageTooltip"),tabindex:"-1"}}),Object(r["v"])([this.next,this.last],t)},t.prototype.clickHandler=function(t){var e=this.pagerModule,i=t.target;return e.previousPageNo=e.currentPage,i.classList.contains("e-disable")||Object(r["T"])(i.getAttribute("index"))||(e.currentPage=parseInt(i.getAttribute("index"),10),e.dataBind()),!1},t.prototype.updateLinksHtml=function(){var t,e,i=this.pagerModule;i.currentPage=1===i.totalPages?1:i.currentPage,i.currentPage>i.totalPages&&i.totalPages&&(i.currentPage=i.totalPages),t=parseInt((i.currentPage/i.pageCount).toString(),10),i.currentPage%i.pageCount===0&&t>0&&(t-=1);for(var n=0;n<i.pageCount;n++)e=t*i.pageCount+1+n,e<=i.totalPages?(this.links[n].style.display="",this.links[n].setAttribute("index",e.toString()),this.links[n].innerHTML=i.customText?i.customText+e:e.toString(),i.currentPage!==e?this.links[n].classList.add("e-pager-default"):this.links[n].classList.remove("e-pager-default")):(this.links[n].innerHTML=i.customText?i.customText+e:e.toString(),this.links[n].style.display="none"),Object(r["y"])(this.links[n],[],["e-currentitem","e-active"]),this.links[n].removeAttribute("aria-selected");this.first.setAttribute("index","1"),this.last.setAttribute("index",i.totalPages.toString()),this.prev.setAttribute("index",(i.currentPage-1).toString()),this.next.setAttribute("index",(i.currentPage+1).toString()),this.pagerElement.querySelector(".e-mfirst").setAttribute("index","1"),this.pagerElement.querySelector(".e-mlast").setAttribute("index",i.totalPages.toString()),this.pagerElement.querySelector(".e-mprev").setAttribute("index",(i.currentPage-1).toString()),this.pagerElement.querySelector(".e-mnext").setAttribute("index",(i.currentPage+1).toString()),this.PP.setAttribute("index",(parseInt(this.links[0].getAttribute("index"),10)-i.pageCount).toString()),this.NP.setAttribute("index",(parseInt(this.links[this.links.length-1].getAttribute("index"),10)+1).toString())},t.prototype.updateStyles=function(){this.updateFirstNPrevStyles(),this.updatePrevPagerSetStyles(),this.updateNextPagerSetStyles(),this.updateNextNLastStyles(),this.links.length&&(Object(r["y"])(this.links[(this.pagerModule.currentPage-1)%this.pagerModule.pageCount],["e-currentitem","e-active"],[]),this.links[(this.pagerModule.currentPage-1)%this.pagerModule.pageCount].setAttribute("aria-selected","true"))},t.prototype.updateFirstNPrevStyles=function(){var t=["e-firstpage","e-pager-default"],e=["e-firstpagedisabled","e-disable"],i=["e-prevpage","e-pager-default"],n=["e-prevpagedisabled","e-disable"];this.pagerModule.totalPages>0&&this.pagerModule.currentPage>1?(Object(r["y"])(this.prev,i,n),Object(r["y"])(this.first,t,e),Object(r["y"])(this.pagerElement.querySelector(".e-mfirst"),t,e),Object(r["y"])(this.pagerElement.querySelector(".e-mprev"),i,n)):(Object(r["y"])(this.prev,n,i),Object(r["y"])(this.first,e,t),Object(r["y"])(this.pagerElement.querySelector(".e-mprev"),n,i),Object(r["y"])(this.pagerElement.querySelector(".e-mfirst"),e,t))},t.prototype.updatePrevPagerSetStyles=function(){this.pagerModule.currentPage>this.pagerModule.pageCount?Object(r["y"])(this.PP,["e-numericitem","e-pager-default"],["e-nextprevitemdisabled","e-disable"]):Object(r["y"])(this.PP,["e-nextprevitemdisabled","e-disable"],["e-numericitem","e-pager-default"])},t.prototype.updateNextPagerSetStyles=function(){var t=this.pagerModule,e=this.links[0].innerHTML.replace(t.customText,"");!e.length||!this.links.length||parseInt(e,10)+t.pageCount>t.totalPages?Object(r["y"])(this.NP,["e-nextprevitemdisabled","e-disable"],["e-numericitem","e-pager-default"]):Object(r["y"])(this.NP,["e-numericitem","e-pager-default"],["e-nextprevitemdisabled","e-disable"])},t.prototype.updateNextNLastStyles=function(){var t=["e-lastpage","e-pager-default"],e=["e-lastpagedisabled","e-disable"],i=["e-nextpage","e-pager-default"],n=["e-nextpagedisabled","e-disable"],o=this.pagerModule;o.currentPage===o.totalPages||0===o.totalRecordsCount?(Object(r["y"])(this.last,e,t),Object(r["y"])(this.next,n,i),Object(r["y"])(this.pagerElement.querySelector(".e-mlast"),e,t),Object(r["y"])(this.pagerElement.querySelector(".e-mnext"),n,i)):(Object(r["y"])(this.last,t,e),Object(r["y"])(this.next,i,n),Object(r["y"])(this.pagerElement.querySelector(".e-mlast"),t,e),Object(r["y"])(this.pagerElement.querySelector(".e-mnext"),i,n))},t}(),o=function(){function t(t){this.pagerModule=t}return t.prototype.render=function(){var t=Object(r["C"])("div",{className:"e-parentmsgbar",attrs:{"aria-label":"Pager Information"}});this.pageNoMsgElem=Object(r["C"])("span",{className:"e-pagenomsg",styles:"textalign:right"}),this.pageCountMsgElem=Object(r["C"])("span",{className:"e-pagecountmsg",styles:"textalign:right"}),Object(r["v"])([this.pageNoMsgElem,this.pageCountMsgElem],t),this.pagerModule.element.appendChild(t),this.refresh()},t.prototype.refresh=function(){var t=this.pagerModule;this.pageNoMsgElem.textContent=this.format(t.getLocalizedLabel("currentPageInfo"),[0===t.totalRecordsCount?0:t.currentPage,t.totalPages||0,t.totalRecordsCount||0])+" ",this.pageCountMsgElem.textContent=this.format(t.getLocalizedLabel(t.totalRecordsCount<=1?"totalItemInfo":"totalItemsInfo"),[t.totalRecordsCount||0,t.totalRecordsCount?t.pageSize*(t.currentPage-1)+1:0,t.pageSize*t.currentPage>t.totalRecordsCount?t.totalRecordsCount:t.pageSize*t.currentPage]),this.pageNoMsgElem.parentElement.setAttribute("aria-label",this.pageNoMsgElem.textContent+this.pageCountMsgElem.textContent)},t.prototype.hideMessage=function(){this.pageNoMsgElem&&(this.pageNoMsgElem.style.display="none"),this.pageCountMsgElem&&(this.pageCountMsgElem.style.display="none")},t.prototype.showMessage=function(){this.pageNoMsgElem||this.render(),this.pageNoMsgElem.style.display="",this.pageCountMsgElem.style.display=""},t.prototype.destroy=function(){},t.prototype.format=function(t,e){for(var i,r=0;r<e.length;r++)i=new RegExp("\\{"+r+"\\}","gm"),t=t.replace(i,e[r].toString());return t},t}(),s=i("d769"),a=i("ccf4"),h=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},t(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),l=function(t,e,i,r){var n,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},u=function(t){function e(e,i,r){var n=t.call(this,e,i)||this;return n.hasParent=!1,n.pageRefresh="pager-refresh",n.firstPagerFocus=!1,n.parent=r,n}return h(e,t),e.prototype.requiredModules=function(){var t=[];return this.enableExternalMessage&&t.push({member:"externalMessage",args:[this]}),this.checkpagesizes()&&t.push({member:"pagerdropdown",args:[this]}),t},e.prototype.preRender=function(){this.defaultConstants={currentPageInfo:"{0} of {1} pages",totalItemsInfo:"({0} items)",totalItemInfo:"({0} item)",firstPageTooltip:"Go to first page",lastPageTooltip:"Go to last page",nextPageTooltip:"Go to next page",previousPageTooltip:"Go to previous page",nextPagerTooltip:"Go to next pager items",previousPagerTooltip:"Go to previous pager items",pagerDropDown:"Items per page",pagerAllDropDown:"Items",CurrentPageInfo:"{0} of {1} pages",TotalItemsInfo:"({0} items)",FirstPageTooltip:"Go to first page",LastPageTooltip:"Go to last page",NextPageTooltip:"Go to next page",PreviousPageTooltip:"Go to previous page",NextPagerTooltip:"Go to next pager items",PreviousPagerTooltip:"Go to previous pager items",PagerDropDown:"Items per page",PagerAllDropDown:"Items",All:"All"},this.containerModule=new n(this),this.pagerMessageModule=new o(this)},e.prototype.render=function(){this.element.setAttribute("data-role","pager"),this.element.setAttribute("aria-label","Pager Container"),this.element.setAttribute("tabindex","-1"),this.cssClass&&Object(r["u"])([this.element],[this.cssClass]),this.hasParent||this.element.setAttribute("tabindex","0"),this.template?this.isReactTemplate()?(this.on(this.pageRefresh,this.pagerTemplate,this),this.notify(this.pageRefresh,{})):this.pagerTemplate():(this.initLocalization(),this.updateRTL(),this.totalRecordsCount=this.totalRecordsCount||0,this.renderFirstPrevDivForDevice(),this.containerModule.render(),this.enablePagerMessage&&this.pagerMessageModule.render(),this.renderNextLastDivForDevice(),this.checkpagesizes()&&this.pagerdropdownModule&&this.pagerdropdownModule.render(),this.addAriaLabel(),this.enableExternalMessage&&this.externalMessageModule&&this.externalMessageModule.render(),this.refresh(),this.trigger("created",{currentPage:this.currentPage,totalRecordsCount:this.totalRecordsCount})),this.wireEvents(),this.addListener()},e.prototype.getPersistData=function(){var t=["currentPage","pageSize"];return this.addOnPersist(t)},e.prototype.destroy=function(){this.isDestroyed||(this.isReactTemplate()&&(this.off(this.pageRefresh,this.pagerTemplate),this.hasParent||this.destroyTemplate(["template"])),this.removeListener(),this.unwireEvents(),t.prototype.destroy.call(this),this.containerModule.destroy(),this.pagerMessageModule.destroy(),this.isReactTemplate()||(this.element.innerHTML=""))},e.prototype.destroyTemplate=function(t,e){this.clearTemplate(t,e)},e.prototype.getModuleName=function(){return"pager"},e.prototype.onPropertyChanged=function(t,e){if(!this.isDestroyed){t.pageCount!==e.pageCount&&(this.containerModule.refreshNumericLinks(),this.containerModule.refresh());for(var i=0,r=Object.keys(t);i<r.length;i++){var n=r[i];switch(n){case"currentPage":this.checkGoToPage(t.currentPage,e.currentPage)&&this.currentPageChanged(t,e);break;case"pageSize":case"totalRecordsCount":case"customText":this.checkpagesizes()&&this.pagerdropdownModule&&(e.pageSize!==t.pageSize&&(this.currentPage=1),this.pagerdropdownModule.setDropDownValue("value",this.pageSize)),t.pageSize!==e.pageSize?(this.pageSize=t.pageSize,this.currentPageChanged(t,e)):this.refresh();break;case"pageSizes":this.checkpagesizes()&&this.pagerdropdownModule&&(this.pagerdropdownModule.destroy(),this.pagerdropdownModule.render()),this.refresh();break;case"template":this.templateFn=this.compile(this.template),this.refresh();break;case"locale":this.initLocalization(),this.refresh();break;case"enableExternalMessage":this.enableExternalMessage&&this.externalMessageModule&&this.externalMessageModule.render();break;case"externalMessage":this.externalMessageModule&&this.externalMessageModule.refresh();break;case"enableRtl":this.updateRTL();break;case"enablePagerMessage":this.enablePagerMessage?this.pagerMessageModule.showMessage():this.pagerMessageModule.hideMessage();break}}}},e.prototype.wireEvents=function(){this.hasParent||(r["l"].add(this.element,"keydown",this.keyPressHandler,this),r["l"].add(document.body,"keydown",this.keyDownHandler,this)),r["l"].add(this.element,"focusin",this.onFocusIn,this),r["l"].add(this.element,"focusout",this.onFocusOut,this)},e.prototype.unwireEvents=function(){this.hasParent||(r["l"].remove(this.element,"keydown",this.keyPressHandler),r["l"].remove(document.body,"keydown",this.keyDownHandler)),r["l"].remove(this.element,"focusin",this.onFocusIn),r["l"].remove(this.element,"focusout",this.onFocusOut)},e.prototype.onFocusIn=function(t){var e=this.getFocusedTabindexElement();if(Object(r["T"])(e)){var i=t.target,n=this.getDropDownPage();if(this.hasParent||(this.element.tabIndex=-1),i===this.element&&!this.hasParent){var o=this.getFocusablePagerElements(this.element,[]);return void this.addFocus(o[0],!0)}if(i===this.element)return void(this.element.tabIndex=0);i===n||i.classList.contains("e-disable")||this.addFocus(i,!0)}},e.prototype.onFocusOut=function(t){var e=this.getFocusedElement(),i=this.getDropDownPage();Object(r["T"])(e)||this.removeFocus(e,!0),this.pageSizes&&i&&i.classList.contains("e-input-focus")&&this.removeFocus(i,!0),this.setTabIndexForFocusLastElement(),this.hasParent||(this.element.tabIndex=0),this.hasParent&&(this.element.tabIndex=-1)},e.prototype.keyDownHandler=function(t){if(t.altKey&&74===t.keyCode){var e=this.getFocusablePagerElements(this.element,[]);e.length>0&&e[0].focus()}},e.prototype.keyPressHandler=function(t){var e=Object(r["G"])(t,{cancel:!1});this.notify(a["Kc"],e),!0===e.cancel&&t.stopImmediatePropagation()},e.prototype.addListener=function(){this.isDestroyed||this.hasParent||this.on(a["Kc"],this.onKeyPress,this)},e.prototype.removeListener=function(){this.isDestroyed||this.hasParent||this.off(a["Kc"],this.onKeyPress)},e.prototype.onKeyPress=function(t){this.hasParent||(this.checkPagerHasFocus()?this.changePagerFocus(t):(t.preventDefault(),this.setPagerFocus()))},e.prototype.checkPagerHasFocus=function(){return!!this.getFocusedTabindexElement()},e.prototype.setPagerContainerFocus=function(){this.element.focus()},e.prototype.setPagerFocus=function(){var t=this.getFocusablePagerElements(this.element,[]);t.length>0&&t[0].focus()},e.prototype.setPagerFocusForActiveElement=function(){var t=this.getActiveElement();t&&t.focus()},e.prototype.setTabIndexForFocusLastElement=function(){var t=this.getFocusablePagerElements(this.element,[]),e=this.getDropDownPage();this.pageSizes&&e&&!Object(r["T"])(e.offsetParent)?e.tabIndex=0:t.length>0&&(t[t.length-1].tabIndex=0)},e.prototype.changePagerFocus=function(t){t.shiftKey&&9===t.keyCode?this.changeFocusByShiftTab(t):9===t.keyCode?this.changeFocusByTab(t):13===t.keyCode||32===t.keyCode?this.navigateToPageByEnterOrSpace(t):37!==t.keyCode&&39!==t.keyCode&&35!==t.keyCode&&36!==t.keyCode||this.navigateToPageByKey(t)},e.prototype.getFocusedTabindexElement=function(){for(var t,e=this.element.querySelectorAll('[tabindex]:not([tabindex="-1"])'),i=0;i<e.length;i++){var r=e[i];if(r&&(r.classList.contains("e-focused")||r.classList.contains("e-input-focus"))){t=r;break}}return t},e.prototype.changeFocusByTab=function(t){var e=this.getFocusedTabindexElement(),i=this.getFocusablePagerElements(this.element,[]),r=this.getDropDownPage();if(i.length>0)if(this.pageSizes&&r&&e===i[i.length-1])r.tabIndex=0;else for(var n=0;n<i.length;n++)if(e===i[n]){var o=n+1;o<i.length&&(t.preventDefault(),i[o].focus());break}},e.prototype.changeFocusByShiftTab=function(t){var e=this.getFocusedTabindexElement(),i=this.getFocusablePagerElements(this.element,[]),r=this.getDropDownPage();if(this.pageSizes&&r&&r.classList.contains("e-input-focus"))r.tabIndex=-1,this.addFocus(i[i.length-1],!0);else if(i.length>0)for(var n=0;n<i.length;n++)if(e===i[n]){var o=n-1;if(o>=0)t.preventDefault(),i[o].focus();else if(this.hasParent){var s=this.parent.getRows(),a=s[s.length-1],h=a.lastChild;t.preventDefault(),h.focus(),this.firstPagerFocus=!0}break}},e.prototype.checkFirstPagerFocus=function(){return!!this.firstPagerFocus&&(this.firstPagerFocus=!1,!0)},e.prototype.navigateToPageByEnterOrSpace=function(t){var e=this.getFocusedElement();if(e){this.goToPage(parseInt(e.getAttribute("index"),10));var i=this.getActiveElement(),r=this.getClass(e),n=this.getElementByClass(r);"e-first"!==r&&"e-prev"!==r&&"e-next"!==r&&"e-last"!==r&&"e-pp"!==r&&"e-np"!==r||!n||n.classList.contains("e-disable")?this.checkFocusInAdaptiveMode(e)?this.changeFocusInAdaptiveMode(e):i&&i.focus():n.focus()}},e.prototype.navigateToPageByKey=function(t){var e=37===t.keyCode?".e-prev":39===t.keyCode?".e-next":35===t.keyCode?".e-last":36===t.keyCode?".e-first":"",i=this.element.querySelector(e),n=this.getFocusedElement();if(!Object(r["T"])(i)&&i.hasAttribute("index")&&!isNaN(parseInt(i.getAttribute("index"),10))){this.goToPage(parseInt(i.getAttribute("index"),10));var o=this.getActiveElement();this.checkFocusInAdaptiveMode(n)?this.changeFocusInAdaptiveMode(n):o&&o.focus()}},e.prototype.checkFocusInAdaptiveMode=function(t){var e=this.getClass(t);return"e-mfirst"===e||"e-mprev"===e||"e-mnext"===e||"e-mlast"===e},e.prototype.changeFocusInAdaptiveMode=function(t){var e=this.getClass(t),i=this.getElementByClass(e);if(i&&i.classList.contains("e-disable"))if("e-mnext"===e||"e-mlast"===e){var r=this.element.querySelector(".e-mprev");r.focus()}else this.setPagerFocus()},e.prototype.removeTabindexLastElements=function(){var t=this.element.querySelectorAll('[tabindex]:not([tabindex="-1"])');if(t.length>1)for(var e=1;e<t.length;e++){var i=t[e];i&&(i.tabIndex=-1)}},e.prototype.getActiveElement=function(){return this.element.querySelector(".e-active")},e.prototype.getDropDownPage=function(){var t,e=this.element.querySelector(".e-pagerdropdown");return e&&(t=e.children[0]),t},e.prototype.getFocusedElement=function(){return this.element.querySelector(".e-focused")},e.prototype.getClass=function(t){for(var e,i=["e-mfirst","e-mprev","e-first","e-prev","e-pp","e-np","e-next","e-last","e-mnext","e-mlast"],r=0;r<i.length;r++)if(t&&t.classList.contains(i[r]))return e=i[r],e;return e},e.prototype.getElementByClass=function(t){return this.element.querySelector("."+t)},e.prototype.getFocusablePagerElements=function(t,e){for(var i=t,n=i.children,o=e,s=0;s<n.length;s++){var a=n[s];if(a.children.length>0&&!a.classList.contains("e-pagesizes"))o=this.getFocusablePagerElements(a,o);else{var h=n[s];!h.hasAttribute("tabindex")||a.classList.contains("e-disable")||"none"===a.style.display||Object(r["T"])(a.offsetParent)||o.push(h)}}return o},e.prototype.addFocus=function(t,e){e&&Object(r["u"])([t],["e-focused","e-focus"]),t.tabIndex=0},e.prototype.removeFocus=function(t,e){e&&Object(r["gb"])([t],["e-focused","e-focus"]),t.tabIndex=-1},e.prototype.getLocalizedLabel=function(t){return this.localeObj.getConstant(t)},e.prototype.goToPage=function(t){this.checkGoToPage(t)&&(this.currentPage=t,this.dataBind())},e.prototype.setPageSize=function(t){this.pageSize=t,this.dataBind()},e.prototype.checkpagesizes=function(){return!(!0!==this.pageSizes&&!this.pageSizes.length)},e.prototype.checkGoToPage=function(t,e){return t!==this.currentPage&&(this.previousPageNo=this.currentPage),Object(r["T"])(e)||(this.previousPageNo=e),this.previousPageNo!==t&&t>=1&&t<=this.totalPages},e.prototype.currentPageChanged=function(t,e){if(this.enableQueryString&&this.updateQueryString(this.currentPage),t.currentPage!==e.currentPage||t.pageSize!==e.pageSize){var i={currentPage:this.currentPage,newProp:t,oldProp:e,cancel:!1};this.trigger("click",i),i.cancel||this.refresh()}},e.prototype.pagerTemplate=function(){if(!this.isReactTemplate()||!this.hasParent){var t;this.element.classList.add("e-pagertemplate"),this.compile(this.template);var e={currentPage:this.currentPage,pageSize:this.pageSize,pageCount:this.pageCount,totalRecordsCount:this.totalRecordsCount,totalPages:this.totalPages},i=this.element.parentElement.id+"_template";this.isReactTemplate()&&!this.isVue?(this.getPagerTemplate()(e,this,"template",i,null,null,this.element),this.renderReactTemplates()):(t=this.isVue?this.getPagerTemplate()(e,this,"template"):this.getPagerTemplate()(e),Object(s["f"])(this.element,t))}},e.prototype.updateTotalPages=function(){this.totalPages=this.isAllPage?1:this.totalRecordsCount%this.pageSize===0?this.totalRecordsCount/this.pageSize:parseInt((this.totalRecordsCount/this.pageSize).toString(),10)+1},e.prototype.getPagerTemplate=function(){return this.templateFn},e.prototype.compile=function(t){if(t)try{document.querySelectorAll(t).length&&(this.templateFn=Object(r["B"])(document.querySelector(t).innerHTML.trim()))}catch(e){this.templateFn=Object(r["B"])(t)}},e.prototype.refresh=function(){if(this.template)this.isReactTemplate()?(this.updateTotalPages(),this.notify(this.pageRefresh,{})):(this.element.innerHTML="",this.updateTotalPages(),this.pagerTemplate());else{this.updateRTL();var t=this.getFocusedTabindexElement();this.containerModule.refresh(),this.removeTabindexLastElements(),t&&t.classList.contains("e-disable")&&(this.checkFocusInAdaptiveMode(t)?this.changeFocusInAdaptiveMode(t):this.setPagerFocusForActiveElement()),this.enablePagerMessage&&this.pagerMessageModule.refresh(),this.pagerdropdownModule&&this.pagerdropdownModule.refresh(),this.enableExternalMessage&&this.externalMessageModule&&this.externalMessageModule.refresh(),this.setTabIndexForFocusLastElement()}},e.prototype.updateRTL=function(){this.enableRtl?this.element.classList.add("e-rtl"):this.element.classList.remove("e-rtl")},e.prototype.initLocalization=function(){this.localeObj=new r["o"](this.getModuleName(),this.defaultConstants,this.locale)},e.prototype.updateQueryString=function(t){var e=this.getUpdatedURL(window.location.href,"page",t.toString());window.history.pushState({path:e},"",e)},e.prototype.getUpdatedURL=function(t,e,i){var r=new RegExp("([?|&])"+e+"=.*?(&|#|$)","i");if(t.match(r))return t.replace(r,"$1"+e+"="+i+"$2");var n="";return-1!==t.indexOf("#")&&(n=t.replace(/.*#/,"#"),t=t.replace(/#.*/,"")),t+(-1!==t.indexOf("?")?"&":"?")+e+"="+i+n},e.prototype.renderFirstPrevDivForDevice=function(){this.element.appendChild(Object(r["C"])("div",{className:"e-mfirst e-icons e-icon-first",attrs:{title:this.getLocalizedLabel("firstPageTooltip"),tabindex:"-1"}})),this.element.appendChild(Object(r["C"])("div",{className:"e-mprev e-icons e-icon-prev",attrs:{title:this.getLocalizedLabel("previousPageTooltip"),tabindex:"-1"}}))},e.prototype.renderNextLastDivForDevice=function(){this.element.appendChild(Object(r["C"])("div",{className:"e-mnext e-icons e-icon-next",attrs:{title:this.getLocalizedLabel("nextPageTooltip"),tabindex:"-1"}})),this.element.appendChild(Object(r["C"])("div",{className:"e-mlast e-icons e-icon-last",attrs:{title:this.getLocalizedLabel("lastPageTooltip"),tabindex:"-1"}}))},e.prototype.addAriaLabel=function(){var t=[".e-mfirst",".e-mprev",".e-mnext",".e-mlast"];if(!r["d"].isDevice)for(var e=0;e<t.length;e++){var i=this.element.querySelector(t[e]);i.setAttribute("aria-label",i.getAttribute("title"))}},e.prototype.isReactTemplate=function(){return(this.isReact||this.isVue)&&this.template&&"string"!==typeof this.template},l([Object(r["r"])(!1)],e.prototype,"enableQueryString",void 0),l([Object(r["r"])(!1)],e.prototype,"enableExternalMessage",void 0),l([Object(r["r"])(!0)],e.prototype,"enablePagerMessage",void 0),l([Object(r["r"])(12)],e.prototype,"pageSize",void 0),l([Object(r["r"])(10)],e.prototype,"pageCount",void 0),l([Object(r["r"])(1)],e.prototype,"currentPage",void 0),l([Object(r["r"])()],e.prototype,"totalRecordsCount",void 0),l([Object(r["r"])()],e.prototype,"externalMessage",void 0),l([Object(r["r"])(!1)],e.prototype,"pageSizes",void 0),l([Object(r["r"])()],e.prototype,"template",void 0),l([Object(r["r"])("")],e.prototype,"customText",void 0),l([Object(r["k"])()],e.prototype,"click",void 0),l([Object(r["r"])("")],e.prototype,"cssClass",void 0),l([Object(r["k"])()],e.prototype,"dropDownChanged",void 0),l([Object(r["k"])()],e.prototype,"created",void 0),e=l([r["p"]],e),e}(r["h"]),c=i("4f9e"),p=function(){function t(t){this.pagerModule=t}return t.prototype.getModuleName=function(){return"pagerdropdown"},t.prototype.render=function(){var t=this.pagerModule;this.pagerDropDownDiv=Object(r["C"])("div",{className:"e-pagesizes"});var e=Object(r["C"])("div",{className:"e-pagerdropdown"}),i=Object(r["C"])("div",{className:"e-pagerconstant"}),n=Object(r["C"])("input",{attrs:{type:"text",tabindex:"-1"}});this.pagerCons=Object(r["C"])("span",{className:"e-constant",innerHTML:this.pagerModule.getLocalizedLabel("pagerDropDown")}),e.appendChild(n),i.appendChild(this.pagerCons),this.pagerDropDownDiv.appendChild(e),this.pagerDropDownDiv.appendChild(i),this.pagerModule.element.appendChild(this.pagerDropDownDiv);var o=this.pagerModule.pageSizes,s=o.length?this.convertValue(o):[this.pagerModule.getLocalizedLabel("All"),"5","10","12","20"],a=this.pagerModule.pageSize;this.dropDownListObject=new c["a"]({dataSource:s,value:a.toString(),change:this.onChange.bind(this),cssClass:this.pagerModule.cssClass?"e-alldrop "+this.pagerModule.cssClass:"e-alldrop"}),this.dropDownListObject.appendTo(n),o.length&&(this.dropDownListObject.element.value=this.pagerModule.pageSize.toString()),t.pageSize=a,t.dataBind(),t.trigger("dropDownChanged",{pageSize:a}),this.addEventListener()},t.prototype.onChange=function(t){this.dropDownListObject.value===this.pagerModule.getLocalizedLabel("All")?(this.pagerModule.pageSize=this.pagerModule.totalRecordsCount,this.pagerModule.isAllPage=!0,this.refresh(),t.value=this.pagerModule.pageSize,document.getElementsByClassName("e-popup-open e-alldrop").length&&(document.getElementsByClassName("e-popup-open e-alldrop")[0].style.display="none")):(this.pagerModule.pageSize=parseInt(this.dropDownListObject.value,10),this.pagerModule.isAllPage=!1,this.pagerCons.innerHTML!==this.pagerModule.getLocalizedLabel("pagerDropDown")&&this.refresh()),this.pagerModule.dataBind(),this.pagerModule.trigger("dropDownChanged",{pageSize:this.pagerModule.isAllPage?this.pagerModule.totalRecordsCount:parseInt(this.dropDownListObject.value,10)})},t.prototype.refresh=function(){this.pagerCons&&(this.pagerModule.pageSize===this.pagerModule.totalRecordsCount?this.pagerCons.innerHTML=this.pagerModule.getLocalizedLabel("pagerAllDropDown"):this.pagerCons.innerHTML=this.pagerModule.getLocalizedLabel("pagerDropDown"))},t.prototype.beforeValueChange=function(t){if("number"===typeof t.newProp.value){var e=t.newProp.value.toString();t.newProp.value=e}},t.prototype.convertValue=function(t){for(var e=t,i=0;i<e.length;i++)e[i]=parseInt(e[i],10)?e[i].toString():""!==this.pagerModule.getLocalizedLabel(e[i])?this.pagerModule.getLocalizedLabel(e[i]):e[i];return e},t.prototype.setDropDownValue=function(t,e){this.dropDownListObject&&(this.dropDownListObject[t]=this.pagerModule.isAllPage?this.pagerModule.getLocalizedLabel("All"):e)},t.prototype.addEventListener=function(){this.dropDownListObject.on("beforeValueChange",this.beforeValueChange,this)},t.prototype.removeEventListener=function(){this.dropDownListObject.off("beforeValueChange",this.beforeValueChange)},t.prototype.destroy=function(t){this.dropDownListObject&&!this.dropDownListObject.isDestroyed&&(this.removeEventListener(),this.dropDownListObject.destroy(),Object(r["fb"])(this.pagerDropDownDiv))},t}(),d=function(){function t(t){this.pagerModule=t}return t.prototype.getModuleName=function(){return"externalMessage"},t.prototype.render=function(){this.element=Object(r["C"])("div",{className:"e-pagerexternalmsg",attrs:{"aria-label":"Pager external message"}}),this.pagerModule.element.appendChild(this.element),this.refresh()},t.prototype.refresh=function(){this.pagerModule.externalMessage&&this.pagerModule.externalMessage.toString().length?(this.showMessage(),this.element.innerHTML=this.pagerModule.externalMessage):this.hideMessage()},t.prototype.hideMessage=function(){Object(r["T"])(this.element)||(this.element.style.display="none")},t.prototype.showMessage=function(){this.element.style.display=""},t.prototype.destroy=function(){Object(r["fb"])(this.element)},t}(),f=i("3530");i.d(e,"a",function(){return g});var g=function(){function t(t,e){this.isInitialRender=!0,this.isCancel=!1,u.Inject(d,p),this.parent=t,this.pageSettings=e,this.addEventListener()}return t.prototype.getModuleName=function(){return"pager"},t.prototype.render=function(){var t=this.parent;this.pagerDestroy(),Object(r["T"])(this.parent.pagerTemplate)||(this.pageSettings.template=this.parent.pagerTemplate,this.parent.pageTemplateChange=!0),this.element=this.parent.createElement("div",{className:"e-gridpager"});var e=Object(s["r"])({},Object(r["G"])({},Object(s["v"])(this.pageSettings)),{click:this.clickHandler.bind(this),dropDownChanged:this.onSelect.bind(this),enableRtl:t.enableRtl,locale:t.locale,created:this.addAriaAttr.bind(this)},["parentObj","propName"]);e.cssClass=this.parent.cssClass?this.parent.cssClass:"",this.pagerObj=new u(e,void 0,this.parent),this.pagerObj.hasParent=!0,this.pagerObj.on(a["Sc"],this.renderReactPagerTemplate,this),this.pagerObj.allowServerDataBinding=!1},t.prototype.onSelect=function(t){this.pageSettings.pageSize=t.pageSize,this.isInitialLoad||(this.pageSettings.currentPage=1)},t.prototype.addAriaAttr=function(){if(!this.pageSettings.template){for(var t=this.parent.createElement("div",{className:"e-numericcontainer"}),e=this.element.querySelector(".e-pagercontainer"),i=document.createDocumentFragment(),r=this.element.querySelector(".e-numericcontainer"),n=r.querySelectorAll("a"),o=0;o<n.length;o++){this.parent.getContentTable()?n[o].setAttribute("aria-owns",this.parent.getContentTable().id):n[o].setAttribute("aria-owns",this.parent.element.getAttribute("id")+"_content_table");var s=this.parent.createElement("div");s.appendChild(n[o]),i.appendChild(s)}t.appendChild(i),e.replaceChild(t,r);for(var a=[".e-mfirst",".e-mprev",".e-first",".e-prev",".e-next",".e-last",".e-mnext",".e-mlast"],h=0;h<a.length;h++){var l=this.element.querySelector(a[h]);this.parent.getContentTable()&&l.setAttribute("aria-owns",this.parent.getContentTable().id)}}},t.prototype.dataReady=function(t){this.updateModel(t)},t.prototype.refresh=function(){this.pagerObj.refresh()},t.prototype.goToPage=function(t){this.pagerObj.goToPage(t)},t.prototype.setPageSize=function(t){this.pagerObj.setPageSize(t)},t.prototype.updateModel=function(t){this.parent.pageSettings.totalRecordsCount=t.count,this.parent.dataBind()},t.prototype.onActionComplete=function(t){this.parent.trigger(a["b"],Object(r["G"])(t,{currentPage:this.parent.pageSettings.currentPage,requestType:"paging",type:a["b"]}))},t.prototype.onPropertyChanged=function(t){if(t.module===this.getModuleName()){for(var e=t.properties,i=0,r=Object.keys(e);i<r.length;i++){var n=r[i];this.pagerObj[n]=e[n]}this.pagerObj.dataBind()}},t.prototype.clickHandler=function(t){var e=this.parent;if(this.isForceCancel||Object(s["Y"])(e)&&!e.prevPageMoving&&!this.isCancel)return this.isForceCancel?this.isForceCancel=!1:(Object(r["T"])(t.newProp)||Object(r["T"])(t.newProp.pageSize)?t.currentPage&&(e.notify(a["Yc"],{instance:this,handler:this.goToPage,arg1:t.currentPage}),this.pagerObj.currentPage=e.pageSettings.currentPage===this.pagerObj.currentPage?this.pagerObj.previousPageNo:e.pageSettings.currentPage):(e.notify(a["Yc"],{instance:this,handler:this.setPageSize,arg1:t.newProp.pageSize}),this.pagerObj.pageSize=t.oldProp.pageSize,e.pageSettings.pageSize=t.newProp.pageSize),this.isForceCancel=!0,this.pagerObj.dataBind()),void(t.cancel=!0);e.pageSettings.pageSize=this.pagerObj.pageSize,e.prevPageMoving=!1;var i=this.pageSettings.currentPage;this.pageSettings.currentPage=t.currentPage;var n={cancel:!1,requestType:"paging",previousPage:i,currentPage:t.currentPage,type:a["a"]};if(this.isCancel||this.parent.notify(a["Nc"],n),n.cancel)return t.cancel=!0,this.pagerObj.currentPage=i,void(this.isCancel=!0);this.isCancel=!1,this.parent.requestTypeAction="paging",this.parent.notify(a["tb"],{type:"paging"})},t.prototype.keyPressHandler=function(t){t.action in m&&(t.preventDefault(),this.element.querySelector(m[t.action]).click())},t.prototype.updateExternalMessage=function(t){this.pagerObj.enableExternalMessage||(this.pagerObj.enableExternalMessage=!0,this.pagerObj.dataBind()),this.pagerObj.externalMessage=t,this.pagerObj.dataBind()},t.prototype.appendToElement=function(){this.isInitialLoad=!0,this.parent.element.appendChild(this.element),this.parent.setGridPager(this.element),this.pagerObj.isReact=this.parent.isReact,this.pagerObj.isVue=this.parent.isVue,this.pagerObj.appendTo(this.element),this.isInitialLoad=!1},t.prototype.enableAfterRender=function(t){t.module===this.getModuleName()&&t.enable&&(this.render(),this.appendToElement(),this.isReactTemplate()&&(this.pagerObj.updateTotalPages(),this.created()))},t.prototype.addEventListener=function(){this.handlers={load:this.render,end:this.appendToElement,ready:this.dataReady,complete:this.onActionComplete,updateLayout:this.enableAfterRender,inboundChange:this.onPropertyChanged,keyPress:this.keyPressHandler,created:this.created},this.parent.isDestroyed||((this.parent.isReact||this.parent.isVue)&&this.parent.addEventListener(f["j"],this.handlers.created.bind(this)),this.evtHandlers=[{event:a["Jc"],handler:this.handlers.load},{event:a["Ic"],handler:this.handlers.end},{event:a["Bb"],handler:this.handlers.ready},{event:a["Rc"],handler:this.handlers.complete},{event:a["qe"],handler:this.handlers.updateLayout},{event:a["Bc"],handler:this.handlers.inboundChange},{event:a["Kc"],handler:this.handlers.keyPress},{event:a["Hb"],handler:this.destroy}],Object(s["d"])(this.parent,this.evtHandlers,!0,this))},t.prototype.created=function(){this.isInitialRender&&this.isReactTemplate()&&(this.isInitialRender=!1,this.renderReactPagerTemplate())},t.prototype.isReactTemplate=function(){return(this.parent.isReact||this.parent.isVue)&&this.pagerObj.template&&"string"!==typeof this.pagerObj.template},t.prototype.renderReactPagerTemplate=function(){if(!this.isInitialRender&&this.isReactTemplate()){var t=void 0;this.parent.destroyTemplate(["pagerTemplate"]),this.element.classList.add("e-pagertemplate"),this.pagerObj.compile(this.pagerObj.template);var e=this.parent.pageSettings,i={currentPage:e.currentPage,pageSize:e.pageSize,pageCount:e.pageCount,totalRecordsCount:e.totalRecordsCount,totalPages:this.pagerObj.totalPages},r=this.parent.id+"_pagertemplate";this.parent.isReact?(this.pagerObj.templateFn(i,this.parent,"pagerTemplate",r,null,null,this.pagerObj.element),this.parent.renderTemplates()):(t=this.pagerObj.templateFn(i,this.parent,"pagerTemplate"),Object(s["f"])(this.pagerObj.element,t))}},t.prototype.removeEventListener=function(){this.parent.isDestroyed||((this.parent.isReact||this.parent.isVue)&&this.parent.removeEventListener(f["j"],this.handlers.created),this.parent.off(a["Sc"],this.renderReactPagerTemplate),Object(s["d"])(this.parent,this.evtHandlers,!1))},t.prototype.destroy=function(){this.removeEventListener(),this.isReactTemplate()&&this.parent.destroyTemplate(["pagerTemplate"]),this.pagerObj.destroy()},t.prototype.pagerDestroy=function(){this.pagerObj&&!this.pagerObj.isDestroyed&&(this.pagerObj.destroy(),Object(r["fb"])(this.element))},t}(),m={pageUp:".e-prev",pageDown:".e-next",ctrlAltPageDown:".e-last",ctrlAltPageUp:".e-first",altPageUp:".e-pp",altPageDown:".e-np"}},f576:function(t,e,i){"use strict";var r=i("5ca1"),n=i("2e08"),o=i("a25f");r(r.P+r.F*/Version\/10\.\d+(\.\d+)? Safari\//.test(o),"String",{padStart:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0,!0)}})}}]);